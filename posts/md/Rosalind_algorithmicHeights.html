<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Taeyoon Kim">
<meta name="dcterms.date" content="2024-09-28">

<title>Rosalind Algorithmic Heights 문제풀이 – tomorrow-lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-6f3cfe11cb26bc240b58e2acdf4e1116.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-9cefeb0a19e8ecfc116a62522df46e3c.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-465480b5e10f2de2c01251f55c0ce8db.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-3dbe2fc42f578100a4b9b0dc90dc91cf.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-31EWCYNR0V"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-31EWCYNR0V', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<meta name="google-site-verification" content="z2S1Xqj9hfJiC31aNGCnOA1gYpL_8MoZpPI2avrWMvg">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Rosalind Algorithmic Heights 문제풀이 – tomorrow-lab">
<meta property="og:description" content="The future of scientific discovery lies at the convergence of computational power and biological complexity. Our mission is to provide a platform where enthusiasts, researchers, and professionals can learn about and contribute to the rapidly evolving fields of bioinformatics, computational biology, and systems biology.">
<meta property="og:image" content="https://tomorrow-lab.github.io/posts/md/Rosalind_algorithmicHeights.png">
<meta property="og:site_name" content="tomorrow-lab">
<meta property="og:image:height" content="320">
<meta property="og:image:width" content="640">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">tomorrow-lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://partrita.github.io"> <i class="bi bi-exclamation-triangle" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/partrita"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div style="margin-top: 30px; margin-bottom: 20px;">
    <a href="https://substack.com/@tomorrowlab">
        <img alt="Static Badge" src="https://img.shields.io/badge/EHOTTL%40substack_-FF6719?link=https%3A%2F%2Fsubstack.com%2F%40tomorrowlab">
    </a>
    <a href="https://pixi.sh">
        <img src="https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/prefix-dev/pixi/main/assets/badge/v0.json" alt="Pixi Badge">
    </a>
    <!-- <script async src="https://eocampaign1.com/form/2616a818-1ef8-11ef-b372-4587d096212f.js" data-form="2616a818-1ef8-11ef-b372-4587d096212f"></script> -->
</div>

</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#fibonacci-numbers" id="toc-fibonacci-numbers" class="nav-link active" data-scroll-target="#fibonacci-numbers"><span class="header-section-number">1</span> Fibonacci Numbers</a>
  <ul class="collapse">
  <li><a href="#problem" id="toc-problem" class="nav-link" data-scroll-target="#problem"><span class="header-section-number">1.1</span> Problem</a></li>
  <li><a href="#sample-dataset" id="toc-sample-dataset" class="nav-link" data-scroll-target="#sample-dataset"><span class="header-section-number">1.2</span> Sample Dataset</a></li>
  <li><a href="#sample-output" id="toc-sample-output" class="nav-link" data-scroll-target="#sample-output"><span class="header-section-number">1.3</span> Sample Output</a></li>
  <li><a href="#solution" id="toc-solution" class="nav-link" data-scroll-target="#solution"><span class="header-section-number">1.4</span> Solution</a></li>
  </ul></li>
  <li><a href="#binary-search" id="toc-binary-search" class="nav-link" data-scroll-target="#binary-search"><span class="header-section-number">2</span> Binary Search</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-1" id="toc-sample-dataset-1" class="nav-link" data-scroll-target="#sample-dataset-1"><span class="header-section-number">2.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-1" id="toc-sample-output-1" class="nav-link" data-scroll-target="#sample-output-1"><span class="header-section-number">2.2</span> Sample Output</a></li>
  <li><a href="#solution-1" id="toc-solution-1" class="nav-link" data-scroll-target="#solution-1"><span class="header-section-number">2.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#insertion-sort" id="toc-insertion-sort" class="nav-link" data-scroll-target="#insertion-sort"><span class="header-section-number">3</span> Insertion Sort</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-2" id="toc-sample-dataset-2" class="nav-link" data-scroll-target="#sample-dataset-2"><span class="header-section-number">3.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-2" id="toc-sample-output-2" class="nav-link" data-scroll-target="#sample-output-2"><span class="header-section-number">3.2</span> Sample Output</a></li>
  <li><a href="#solution-2" id="toc-solution-2" class="nav-link" data-scroll-target="#solution-2"><span class="header-section-number">3.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#degree-array" id="toc-degree-array" class="nav-link" data-scroll-target="#degree-array"><span class="header-section-number">4</span> Degree Array</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-3" id="toc-sample-dataset-3" class="nav-link" data-scroll-target="#sample-dataset-3"><span class="header-section-number">4.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-3" id="toc-sample-output-3" class="nav-link" data-scroll-target="#sample-output-3"><span class="header-section-number">4.2</span> Sample Output</a></li>
  <li><a href="#solution-3" id="toc-solution-3" class="nav-link" data-scroll-target="#solution-3"><span class="header-section-number">4.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#double-degree-array" id="toc-double-degree-array" class="nav-link" data-scroll-target="#double-degree-array"><span class="header-section-number">5</span> Double-Degree Array</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-4" id="toc-sample-dataset-4" class="nav-link" data-scroll-target="#sample-dataset-4"><span class="header-section-number">5.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-4" id="toc-sample-output-4" class="nav-link" data-scroll-target="#sample-output-4"><span class="header-section-number">5.2</span> Sample Output</a></li>
  <li><a href="#solution-4" id="toc-solution-4" class="nav-link" data-scroll-target="#solution-4"><span class="header-section-number">5.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#majority-element" id="toc-majority-element" class="nav-link" data-scroll-target="#majority-element"><span class="header-section-number">6</span> Majority Element</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-5" id="toc-sample-dataset-5" class="nav-link" data-scroll-target="#sample-dataset-5"><span class="header-section-number">6.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-5" id="toc-sample-output-5" class="nav-link" data-scroll-target="#sample-output-5"><span class="header-section-number">6.2</span> Sample Output</a></li>
  <li><a href="#solution-5" id="toc-solution-5" class="nav-link" data-scroll-target="#solution-5"><span class="header-section-number">6.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#merge-two-sorted-arrays" id="toc-merge-two-sorted-arrays" class="nav-link" data-scroll-target="#merge-two-sorted-arrays"><span class="header-section-number">7</span> Merge Two Sorted Arrays</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-6" id="toc-sample-dataset-6" class="nav-link" data-scroll-target="#sample-dataset-6"><span class="header-section-number">7.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-6" id="toc-sample-output-6" class="nav-link" data-scroll-target="#sample-output-6"><span class="header-section-number">7.2</span> Sample Output</a></li>
  <li><a href="#solution-6" id="toc-solution-6" class="nav-link" data-scroll-target="#solution-6"><span class="header-section-number">7.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#sum" id="toc-sum" class="nav-link" data-scroll-target="#sum"><span class="header-section-number">8</span> 2SUM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-7" id="toc-sample-dataset-7" class="nav-link" data-scroll-target="#sample-dataset-7"><span class="header-section-number">8.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-7" id="toc-sample-output-7" class="nav-link" data-scroll-target="#sample-output-7"><span class="header-section-number">8.2</span> Sample Output</a></li>
  <li><a href="#solution-7" id="toc-solution-7" class="nav-link" data-scroll-target="#solution-7"><span class="header-section-number">8.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#sum-1" id="toc-sum-1" class="nav-link" data-scroll-target="#sum-1"><span class="header-section-number">9</span> 3SUM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-8" id="toc-sample-dataset-8" class="nav-link" data-scroll-target="#sample-dataset-8"><span class="header-section-number">9.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-8" id="toc-sample-output-8" class="nav-link" data-scroll-target="#sample-output-8"><span class="header-section-number">9.2</span> Sample Output</a></li>
  <li><a href="#solution-8" id="toc-solution-8" class="nav-link" data-scroll-target="#solution-8"><span class="header-section-number">9.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#breadth-first-search" id="toc-breadth-first-search" class="nav-link" data-scroll-target="#breadth-first-search"><span class="header-section-number">10</span> Breadth-First Search</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-9" id="toc-sample-dataset-9" class="nav-link" data-scroll-target="#sample-dataset-9"><span class="header-section-number">10.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-9" id="toc-sample-output-9" class="nav-link" data-scroll-target="#sample-output-9"><span class="header-section-number">10.2</span> Sample Output</a></li>
  <li><a href="#solution-9" id="toc-solution-9" class="nav-link" data-scroll-target="#solution-9"><span class="header-section-number">10.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#connected-components" id="toc-connected-components" class="nav-link" data-scroll-target="#connected-components"><span class="header-section-number">11</span> Connected Components</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-10" id="toc-sample-dataset-10" class="nav-link" data-scroll-target="#sample-dataset-10"><span class="header-section-number">11.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-10" id="toc-sample-output-10" class="nav-link" data-scroll-target="#sample-output-10"><span class="header-section-number">11.2</span> Sample Output</a></li>
  <li><a href="#solution-10" id="toc-solution-10" class="nav-link" data-scroll-target="#solution-10"><span class="header-section-number">11.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#building-a-heap" id="toc-building-a-heap" class="nav-link" data-scroll-target="#building-a-heap"><span class="header-section-number">12</span> Building a Heap</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-11" id="toc-sample-dataset-11" class="nav-link" data-scroll-target="#sample-dataset-11"><span class="header-section-number">12.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-11" id="toc-sample-output-11" class="nav-link" data-scroll-target="#sample-output-11"><span class="header-section-number">12.2</span> Sample Output</a></li>
  </ul></li>
  <li><a href="#merge-sort" id="toc-merge-sort" class="nav-link" data-scroll-target="#merge-sort"><span class="header-section-number">13</span> Merge Sort</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-12" id="toc-sample-dataset-12" class="nav-link" data-scroll-target="#sample-dataset-12"><span class="header-section-number">13.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-12" id="toc-sample-output-12" class="nav-link" data-scroll-target="#sample-output-12"><span class="header-section-number">13.2</span> Sample Output</a></li>
  <li><a href="#solution-11" id="toc-solution-11" class="nav-link" data-scroll-target="#solution-11"><span class="header-section-number">13.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#way-partition" id="toc-way-partition" class="nav-link" data-scroll-target="#way-partition"><span class="header-section-number">14</span> 2-Way Partition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-13" id="toc-sample-dataset-13" class="nav-link" data-scroll-target="#sample-dataset-13"><span class="header-section-number">14.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-13" id="toc-sample-output-13" class="nav-link" data-scroll-target="#sample-output-13"><span class="header-section-number">14.2</span> Sample Output</a></li>
  <li><a href="#solution-12" id="toc-solution-12" class="nav-link" data-scroll-target="#solution-12"><span class="header-section-number">14.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#way-partition-1" id="toc-way-partition-1" class="nav-link" data-scroll-target="#way-partition-1"><span class="header-section-number">15</span> 3-Way Partition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-14" id="toc-sample-dataset-14" class="nav-link" data-scroll-target="#sample-dataset-14"><span class="header-section-number">15.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-14" id="toc-sample-output-14" class="nav-link" data-scroll-target="#sample-output-14"><span class="header-section-number">15.2</span> Sample Output</a></li>
  <li><a href="#solution-13" id="toc-solution-13" class="nav-link" data-scroll-target="#solution-13"><span class="header-section-number">15.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#square-in-a-graph" id="toc-square-in-a-graph" class="nav-link" data-scroll-target="#square-in-a-graph"><span class="header-section-number">16</span> Square in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-15" id="toc-sample-dataset-15" class="nav-link" data-scroll-target="#sample-dataset-15"><span class="header-section-number">16.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-15" id="toc-sample-output-15" class="nav-link" data-scroll-target="#sample-output-15"><span class="header-section-number">16.2</span> Sample Output</a></li>
  <li><a href="#solution-14" id="toc-solution-14" class="nav-link" data-scroll-target="#solution-14"><span class="header-section-number">16.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#testing-bipartiteness" id="toc-testing-bipartiteness" class="nav-link" data-scroll-target="#testing-bipartiteness"><span class="header-section-number">17</span> Testing Bipartiteness</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-16" id="toc-sample-dataset-16" class="nav-link" data-scroll-target="#sample-dataset-16"><span class="header-section-number">17.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-16" id="toc-sample-output-16" class="nav-link" data-scroll-target="#sample-output-16"><span class="header-section-number">17.2</span> Sample Output</a></li>
  <li><a href="#solution-15" id="toc-solution-15" class="nav-link" data-scroll-target="#solution-15"><span class="header-section-number">17.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#testing-acyclicity" id="toc-testing-acyclicity" class="nav-link" data-scroll-target="#testing-acyclicity"><span class="header-section-number">18</span> Testing Acyclicity</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-17" id="toc-sample-dataset-17" class="nav-link" data-scroll-target="#sample-dataset-17"><span class="header-section-number">18.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-17" id="toc-sample-output-17" class="nav-link" data-scroll-target="#sample-output-17"><span class="header-section-number">18.2</span> Sample Output</a></li>
  <li><a href="#solution-16" id="toc-solution-16" class="nav-link" data-scroll-target="#solution-16"><span class="header-section-number">18.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#dijkstras-algorithm" id="toc-dijkstras-algorithm" class="nav-link" data-scroll-target="#dijkstras-algorithm"><span class="header-section-number">19</span> Dijkstra’s Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-18" id="toc-sample-dataset-18" class="nav-link" data-scroll-target="#sample-dataset-18"><span class="header-section-number">19.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-18" id="toc-sample-output-18" class="nav-link" data-scroll-target="#sample-output-18"><span class="header-section-number">19.2</span> Sample Output</a></li>
  <li><a href="#solution-17" id="toc-solution-17" class="nav-link" data-scroll-target="#solution-17"><span class="header-section-number">19.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#heap-sort" id="toc-heap-sort" class="nav-link" data-scroll-target="#heap-sort"><span class="header-section-number">20</span> Heap Sort</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-19" id="toc-sample-dataset-19" class="nav-link" data-scroll-target="#sample-dataset-19"><span class="header-section-number">20.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-19" id="toc-sample-output-19" class="nav-link" data-scroll-target="#sample-output-19"><span class="header-section-number">20.2</span> Sample Output</a></li>
  <li><a href="#solution-18" id="toc-solution-18" class="nav-link" data-scroll-target="#solution-18"><span class="header-section-number">20.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#counting-inversions" id="toc-counting-inversions" class="nav-link" data-scroll-target="#counting-inversions"><span class="header-section-number">21</span> Counting Inversions</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-20" id="toc-sample-dataset-20" class="nav-link" data-scroll-target="#sample-dataset-20"><span class="header-section-number">21.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-20" id="toc-sample-output-20" class="nav-link" data-scroll-target="#sample-output-20"><span class="header-section-number">21.2</span> Sample Output</a></li>
  <li><a href="#solution-19" id="toc-solution-19" class="nav-link" data-scroll-target="#solution-19"><span class="header-section-number">21.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#bellman-ford-algorithm" id="toc-bellman-ford-algorithm" class="nav-link" data-scroll-target="#bellman-ford-algorithm"><span class="header-section-number">22</span> Bellman-Ford Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-21" id="toc-sample-dataset-21" class="nav-link" data-scroll-target="#sample-dataset-21"><span class="header-section-number">22.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-21" id="toc-sample-output-21" class="nav-link" data-scroll-target="#sample-output-21"><span class="header-section-number">22.2</span> Sample Output</a></li>
  <li><a href="#solution-20" id="toc-solution-20" class="nav-link" data-scroll-target="#solution-20"><span class="header-section-number">22.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#shortest-cycle-through-a-given-edge" id="toc-shortest-cycle-through-a-given-edge" class="nav-link" data-scroll-target="#shortest-cycle-through-a-given-edge"><span class="header-section-number">23</span> Shortest Cycle Through a Given Edge</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-22" id="toc-sample-dataset-22" class="nav-link" data-scroll-target="#sample-dataset-22"><span class="header-section-number">23.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-22" id="toc-sample-output-22" class="nav-link" data-scroll-target="#sample-output-22"><span class="header-section-number">23.2</span> Sample Output</a></li>
  <li><a href="#solution-21" id="toc-solution-21" class="nav-link" data-scroll-target="#solution-21"><span class="header-section-number">23.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#median" id="toc-median" class="nav-link" data-scroll-target="#median"><span class="header-section-number">24</span> Median</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-23" id="toc-sample-dataset-23" class="nav-link" data-scroll-target="#sample-dataset-23"><span class="header-section-number">24.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-23" id="toc-sample-output-23" class="nav-link" data-scroll-target="#sample-output-23"><span class="header-section-number">24.2</span> Sample Output</a></li>
  <li><a href="#solution-22" id="toc-solution-22" class="nav-link" data-scroll-target="#solution-22"><span class="header-section-number">24.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#partial-sort" id="toc-partial-sort" class="nav-link" data-scroll-target="#partial-sort"><span class="header-section-number">25</span> Partial Sort</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-24" id="toc-sample-dataset-24" class="nav-link" data-scroll-target="#sample-dataset-24"><span class="header-section-number">25.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-24" id="toc-sample-output-24" class="nav-link" data-scroll-target="#sample-output-24"><span class="header-section-number">25.2</span> Sample Output</a></li>
  <li><a href="#solution-23" id="toc-solution-23" class="nav-link" data-scroll-target="#solution-23"><span class="header-section-number">25.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#topological-sorting" id="toc-topological-sorting" class="nav-link" data-scroll-target="#topological-sorting"><span class="header-section-number">26</span> Topological Sorting</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-25" id="toc-sample-dataset-25" class="nav-link" data-scroll-target="#sample-dataset-25"><span class="header-section-number">26.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-25" id="toc-sample-output-25" class="nav-link" data-scroll-target="#sample-output-25"><span class="header-section-number">26.2</span> Sample Output</a></li>
  <li><a href="#solution-24" id="toc-solution-24" class="nav-link" data-scroll-target="#solution-24"><span class="header-section-number">26.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#hamiltonian-path-in-dag" id="toc-hamiltonian-path-in-dag" class="nav-link" data-scroll-target="#hamiltonian-path-in-dag"><span class="header-section-number">27</span> Hamiltonian Path in DAG</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-26" id="toc-sample-dataset-26" class="nav-link" data-scroll-target="#sample-dataset-26"><span class="header-section-number">27.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-26" id="toc-sample-output-26" class="nav-link" data-scroll-target="#sample-output-26"><span class="header-section-number">27.2</span> Sample Output</a></li>
  <li><a href="#solution-25" id="toc-solution-25" class="nav-link" data-scroll-target="#solution-25"><span class="header-section-number">27.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#negative-weight-cycle" id="toc-negative-weight-cycle" class="nav-link" data-scroll-target="#negative-weight-cycle"><span class="header-section-number">28</span> Negative Weight Cycle</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-27" id="toc-sample-dataset-27" class="nav-link" data-scroll-target="#sample-dataset-27"><span class="header-section-number">28.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-27" id="toc-sample-output-27" class="nav-link" data-scroll-target="#sample-output-27"><span class="header-section-number">28.2</span> Sample Output</a></li>
  <li><a href="#solution-26" id="toc-solution-26" class="nav-link" data-scroll-target="#solution-26"><span class="header-section-number">28.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#quick-sort" id="toc-quick-sort" class="nav-link" data-scroll-target="#quick-sort"><span class="header-section-number">29</span> Quick Sort</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-28" id="toc-sample-dataset-28" class="nav-link" data-scroll-target="#sample-dataset-28"><span class="header-section-number">29.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-28" id="toc-sample-output-28" class="nav-link" data-scroll-target="#sample-output-28"><span class="header-section-number">29.2</span> Sample Output</a></li>
  <li><a href="#solution-27" id="toc-solution-27" class="nav-link" data-scroll-target="#solution-27"><span class="header-section-number">29.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#strongly-connected-components" id="toc-strongly-connected-components" class="nav-link" data-scroll-target="#strongly-connected-components"><span class="header-section-number">30</span> Strongly Connected Components</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-29" id="toc-sample-dataset-29" class="nav-link" data-scroll-target="#sample-dataset-29"><span class="header-section-number">30.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-29" id="toc-sample-output-29" class="nav-link" data-scroll-target="#sample-output-29"><span class="header-section-number">30.2</span> Sample Output</a></li>
  <li><a href="#solution-28" id="toc-solution-28" class="nav-link" data-scroll-target="#solution-28"><span class="header-section-number">30.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#satisfiability" id="toc-satisfiability" class="nav-link" data-scroll-target="#satisfiability"><span class="header-section-number">31</span> 2-Satisfiability</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-30" id="toc-sample-dataset-30" class="nav-link" data-scroll-target="#sample-dataset-30"><span class="header-section-number">31.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-30" id="toc-sample-output-30" class="nav-link" data-scroll-target="#sample-output-30"><span class="header-section-number">31.2</span> Sample Output</a></li>
  <li><a href="#solution-29" id="toc-solution-29" class="nav-link" data-scroll-target="#solution-29"><span class="header-section-number">31.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#general-sink" id="toc-general-sink" class="nav-link" data-scroll-target="#general-sink"><span class="header-section-number">32</span> General Sink</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-31" id="toc-sample-dataset-31" class="nav-link" data-scroll-target="#sample-dataset-31"><span class="header-section-number">32.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-31" id="toc-sample-output-31" class="nav-link" data-scroll-target="#sample-output-31"><span class="header-section-number">32.2</span> Sample Output</a></li>
  <li><a href="#solution-30" id="toc-solution-30" class="nav-link" data-scroll-target="#solution-30"><span class="header-section-number">32.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#semi-connected-graph" id="toc-semi-connected-graph" class="nav-link" data-scroll-target="#semi-connected-graph"><span class="header-section-number">33</span> Semi-Connected Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-32" id="toc-sample-dataset-32" class="nav-link" data-scroll-target="#sample-dataset-32"><span class="header-section-number">33.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-32" id="toc-sample-output-32" class="nav-link" data-scroll-target="#sample-output-32"><span class="header-section-number">33.2</span> Sample Output</a></li>
  <li><a href="#solution-31" id="toc-solution-31" class="nav-link" data-scroll-target="#solution-31"><span class="header-section-number">33.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#shortest-paths-in-dag" id="toc-shortest-paths-in-dag" class="nav-link" data-scroll-target="#shortest-paths-in-dag"><span class="header-section-number">34</span> Shortest Paths in DAG</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-33" id="toc-sample-dataset-33" class="nav-link" data-scroll-target="#sample-dataset-33"><span class="header-section-number">34.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-33" id="toc-sample-output-33" class="nav-link" data-scroll-target="#sample-output-33"><span class="header-section-number">34.2</span> Sample Output</a></li>
  <li><a href="#solution-32" id="toc-solution-32" class="nav-link" data-scroll-target="#solution-32"><span class="header-section-number">34.3</span> Solution</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Rosalind Algorithmic Heights 문제풀이</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Rosalind</div>
    <div class="quarto-category">Bioinformatics</div>
    <div class="quarto-category">Tip</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Taeyoon Kim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 28, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 28, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Rosalind_algorithmicHeights.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="Rosalind_algorithmicHeights.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
<p>Dasgupta, Papadimitriou, Vazirani 의 책 “<a href="https://github.com/eherbold/berkeleytextbooks/blob/master/Algorithms%20-%20Sanjoy%20Dasgupta%2C%20Christos%20H.%20Papadimitriou%2C%20and%20Umesh%20V.%20Vazirani.pdf">알고리즘</a>” 에 포함된 연습문제의 모음입니다.</p>
<p><a href="https://rosalind.info/">Rosalind</a> 는 <a href="http://projecteuler.net/">프로젝트 오일러</a>, <a href="http://code.google.com/codejam">구글 코드 잼</a> 에서 영감을 얻었습니다. 이 프로젝트의 이름은 DNA 이중나선을 발견하는 데 기여한 <a href="http://en.wikipedia.org/wiki/Rosalind_Franklin">로잘린드 프랭클린</a> 에서 따왔습니다. Rosalind 는 프로그래밍 실력을 키우고자 하는 생물학자와 분자생물학의 계산 문제를 접해본 적이 없는 프로그래머들에게 도움이 될 것입니다.</p>
<section id="fibonacci-numbers" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Fibonacci Numbers</h1>
<section id="problem" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="problem"><span class="header-section-number">1.1</span> Problem</h2>
<p>The Fibonacci numbers&nbsp;<span class="math inline">\(0,1,1,2,3,5,8,13,21,34,…\)</span>&nbsp;are generated by the simple rule.</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤25\)</span>.</p>
<p>Return:&nbsp;The value of&nbsp;Fn.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
</section>
<section id="sample-dataset" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sample-dataset"><span class="header-section-number">1.2</span> Sample Dataset</h2>
<pre><code>6</code></pre>
</section>
<section id="sample-output" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="sample-output"><span class="header-section-number">1.3</span> Sample Output</h2>
<pre><code>8</code></pre>
</section>
<section id="solution" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="solution"><span class="header-section-number">1.4</span> Solution</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci(n: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    fib: <span class="bu">list</span>[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    fib[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        fib[i] <span class="op">=</span> fib[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> fib[i <span class="op">-</span> <span class="dv">2</span>]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> fib[n]</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="dv">6</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"피보나치 수열의 </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">번째 항: </span><span class="sc">{</span>fibonacci(n)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>아주 큰수의 피보나치 수열을 계산하는 경우에는 다음 코드.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> gmpy2</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> gmpy2 <span class="im">import</span> mpz</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> fibonacci_gmpy2(n: <span class="bu">int</span>) <span class="op">-&gt;</span> mpz:</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    a: mpz <span class="op">=</span> gmpy2.mpz(<span class="dv">0</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    b: mpz <span class="op">=</span> gmpy2.mpz(<span class="dv">1</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> b, a <span class="op">+</span> b</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> a</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 예제 사용</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="dv">60000</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>result: mpz <span class="op">=</span> fibonacci_gmpy2(n)</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"피보나치 수열의 </span><span class="sc">{</span>n<span class="sc">}</span><span class="ss">번째 항:"</span>)</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"자릿수: </span><span class="sc">{</span><span class="bu">len</span>(<span class="bu">str</span>(result))<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="binary-search" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Binary Search</h1>
<p>Binary search is the ultimate&nbsp;<a href="https://rosalind.info/glossary/algo-divide-and-conquer/">divide-and-conquer</a>&nbsp;algorithm. To find a key&nbsp;k&nbsp;in a large file containing keys&nbsp;A[1..n]&nbsp;in sorted order, we first compare&nbsp;k&nbsp;with&nbsp;A[n/2], and depending on the result we recurse either on the first half of the file,&nbsp;A[1..n/2], or on the second half,&nbsp;A[n/2+1..n]. The recurrence now is&nbsp;<span class="math inline">\(T(n)=T(n/2)+O(1)\)</span>. Plugging into the&nbsp;<a href="https://rosalind.info/glossary/algo-master-theorem/">master theorem</a> with&nbsp;<span class="math inline">\((a=1,b=2,d=0)\)</span> we get the familiar solution: a running time of just&nbsp;<span class="math inline">\(O(logn)\)</span>.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<p>The problem is to find a given set of keys in a given array.</p>
<p>Given:&nbsp;Two positive integers&nbsp;<span class="math inline">\(n≤10^5\)</span>&nbsp;and&nbsp;<span class="math inline">\(m≤10^5\)</span>, a sorted&nbsp;<a href="https://rosalind.info/glossary/algo-array/">array</a>&nbsp;A[1..n]&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>&nbsp;and a list of&nbsp;mm&nbsp;integers&nbsp;<span class="math inline">\(−10^5≤k1,k2,…,km≤10^5\)</span>.</p>
<p>Return:&nbsp;For each&nbsp;<span class="math inline">\(k_i\)</span>, output an index&nbsp;<span class="math inline">\(1≤j≤n\)</span>&nbsp;s.t.&nbsp;<span class="math inline">\(A[j]=k_i\)</span>&nbsp;or”-1”if there is no such index.</p>
<section id="sample-dataset-1" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sample-dataset-1"><span class="header-section-number">2.1</span> Sample Dataset</h2>
<pre><code>5
6
10 20 30 40 50
40 10 35 15 40 20</code></pre>
</section>
<section id="sample-output-1" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sample-output-1"><span class="header-section-number">2.2</span> Sample Output</h2>
<pre><code>4 1 -1 -1 4 2</code></pre>
</section>
<section id="solution-1" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="solution-1"><span class="header-section-number">2.3</span> Solution</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> binary_search(arr: List[<span class="bu">int</span>], target: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    low, high <span class="op">=</span> <span class="dv">0</span>, <span class="bu">len</span>(arr) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> low <span class="op">&lt;=</span> high:</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        mid <span class="op">=</span> (low <span class="op">+</span> high) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> arr[mid] <span class="op">==</span> target:</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> mid <span class="op">+</span> <span class="dv">1</span>  <span class="co"># Adding 1 to convert from 0-based to 1-based indexing</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> arr[mid] <span class="op">&lt;</span> target:</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>            low <span class="op">=</span> mid <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>            high <span class="op">=</span> mid <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span>  <span class="co"># Target not found</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_str: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_str.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">0</span>])</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    m <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">1</span>])</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    array <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">2</span>].split()))</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    items <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">3</span>].split()))</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> n, m, array, items</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a><span class="st">6</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a><span class="st">10 20 30 40 50</span></span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="st">40 10 35 15 40 20</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>n, m, array, items <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>results: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="bu">str</span>(binary_search(array, item)) <span class="cf">for</span> item <span class="kw">in</span> items]</span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>.join(results))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="insertion-sort" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Insertion Sort</h1>
<p>Insertion sort is a simple sorting algorithm that builds the final sorted array one item at a time. It is much less efficient on large lists than more advanced algorithms such as&nbsp;<a href="https://rosalind.info/problems/qs/">“Quick Sort”</a>,&nbsp;<a href="https://rosalind.info/problems/hs/">“Heap Sort”</a>, or&nbsp;<a href="https://rosalind.info/problems/ms/">“Merge Sort”</a>. However, insertion sort provides several advantages: simple implementation, efficient for (quite) small data sets,&nbsp;O(1)O(1)&nbsp;extra space.</p>
<p>When humans manually sort something (for example, a deck of playing cards), most use a method that is similar to insertion sort.</p>
<p>Source:&nbsp;<a href="http://en.wikipedia.org/wiki/Insertion_sort">Wikipedia</a></p>
<p>Although it is one of the elementary sorting algorithms with&nbsp;<span class="math inline">\(O(n^2)\)</span>&nbsp;worst-case time, insertion sort is the algorithm of choice either when the data is nearly sorted (because it is adaptive) or when the problem size is small (because it has low overhead).</p>
<p>For these reasons, and because it is also stable, insertion sort is often used as the recursive base case (when the problem size is small) for higher overhead&nbsp;<a href="https://rosalind.info/glossary/algo-divide-and-conquer/">divide-and-conquer</a>&nbsp;sorting algorithms, such as&nbsp;<a href="https://rosalind.info/problems/ms/">“Merge Sort”</a>&nbsp;or&nbsp;<a href="https://rosalind.info/problems/qs/">“Quick Sort”</a>.</p>
<p>Insertion sort is a simple algorithm with quadratic running time that builds the final sorted array one item at a time.</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;and an array&nbsp;A[1..n]&nbsp;of integers.</p>
<p>Return:&nbsp;The number of swaps performed by insertion sort algorithm on&nbsp;A[1..n].</p>
<section id="sample-dataset-2" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sample-dataset-2"><span class="header-section-number">3.1</span> Sample Dataset</h2>
<pre><code>6
6 10 4 5 1 2</code></pre>
</section>
<section id="sample-output-2" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sample-output-2"><span class="header-section-number">3.2</span> Sample Output</h2>
<pre><code>12</code></pre>
</section>
<section id="solution-2" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="solution-2"><span class="header-section-number">3.3</span> Solution</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_str: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_str.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">0</span>])  <span class="co"># Get the number of elements</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    array <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">1</span>].split()))</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> array</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insertion_sort(array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    swaps <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(array)):</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>        key <span class="op">=</span> array[i]</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> j <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> array[j] <span class="op">&gt;</span> key:</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>            array[j <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> array[j]</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>            swaps <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>        array[j <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> key</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> swaps</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a><span class="st">6</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a><span class="st">6 10 4 5 1 2</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>array: List[<span class="bu">int</span>] <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>swap_count: <span class="bu">int</span> <span class="op">=</span> insertion_sort(array)</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>swap_count<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="degree-array" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Degree Array</h1>
<p>In an undirected graph, the&nbsp;degree&nbsp;<span class="math inline">\(d(u)\)</span>&nbsp;of a vertex&nbsp;u&nbsp;is the number of neighbors&nbsp;u&nbsp;has, or equivalently, the number of edges incident upon it.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/algo-simple-graph/">simple graph</a>&nbsp;with&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;An array&nbsp;<span class="math inline">\(D[1..n]\)</span>&nbsp;where&nbsp;<span class="math inline">\(D[i]\)</span>&nbsp;is the degree of vertex&nbsp;i.</p>
<section id="sample-dataset-3" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sample-dataset-3"><span class="header-section-number">4.1</span> Sample Dataset</h2>
<pre><code>6 7
1 2
2 3
6 3
5 6
2 5
2 4
4 1</code></pre>
</section>
<section id="sample-output-3" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sample-output-3"><span class="header-section-number">4.2</span> Sample Output</h2>
<pre><code>2 4 2 2 2 2</code></pre>
</section>
<section id="solution-3" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="solution-3"><span class="header-section-number">4.3</span> Solution</h2>
<div class="sourceCode" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_str: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_str.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    nodes, edges <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">0</span>].split())</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    edge_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> lines[<span class="dv">1</span>:]:</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>        edge_list.extend(<span class="bu">map</span>(<span class="bu">int</span>, line.split()))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes, edge_list</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_degrees(nodes: <span class="bu">int</span>, edge_list: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    degrees: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> nodes</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> edge_list:</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>        degrees[node <span class="op">-</span> <span class="dv">1</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> degrees</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="st">6 7</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="st">2 3</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="st">6 3</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a><span class="st">5 6</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="st">2 5</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a><span class="st">2 4</span></span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a>nodes: <span class="bu">int</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a>edge_list: List[<span class="bu">int</span>]</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a>nodes, edge_list <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>degrees: List[<span class="bu">int</span>] <span class="op">=</span> calculate_degrees(nodes, edge_list)</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, degrees)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="double-degree-array" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Double-Degree Array</h1>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/algo-simple-graph/">simple graph</a>&nbsp;with&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;An array&nbsp;D[1..n]&nbsp;where&nbsp;D[i]&nbsp;is the sum of the degrees of&nbsp;<span class="math inline">\(i\)</span>’s neighbors.</p>
<section id="sample-dataset-4" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sample-dataset-4"><span class="header-section-number">5.1</span> Sample Dataset</h2>
<pre><code>5 4
1 2
2 3
4 3
2 4</code></pre>
</section>
<section id="sample-output-4" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sample-output-4"><span class="header-section-number">5.2</span> Sample Output</h2>
<pre><code>3 5 5 5 0</code></pre>
</section>
<section id="solution-4" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="solution-4"><span class="header-section-number">5.3</span> Solution</h2>
<div class="sourceCode" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_str: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[List[<span class="bu">int</span>]]]:</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_str.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    nodes, edges <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">0</span>].split())</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    edge_list: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> lines[<span class="dv">1</span>:]:</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>        edge_list.append(<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, line.split())))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes, edge_list</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="st">5 4</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="st">2 3</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a><span class="st">4 3</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="st">2 4</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>nodes: <span class="bu">int</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>edges_list: List[List[<span class="bu">int</span>]]</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>nodes, edges_list <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an adjacency list</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>nodes_neighbours: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {<span class="bu">str</span>(i<span class="op">+</span><span class="dv">1</span>): [] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(nodes)}</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> edges_list:</span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>    nodes_neighbours[<span class="bu">str</span>(edge[<span class="dv">0</span>])].append(<span class="bu">str</span>(edge[<span class="dv">1</span>]))</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>    nodes_neighbours[<span class="bu">str</span>(edge[<span class="dv">1</span>])].append(<span class="bu">str</span>(edge[<span class="dv">0</span>]))</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the sum of neighbors' degrees</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, nodes <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    sum_of_neighbors_degrees: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(<span class="bu">len</span>(nodes_neighbours[<span class="bu">str</span>(neighbor)]) <span class="cf">for</span> neighbor <span class="kw">in</span> nodes_neighbours[<span class="bu">str</span>(i)])</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(sum_of_neighbors_degrees, end<span class="op">=</span><span class="st">" "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="majority-element" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Majority Element</h1>
<p>An array&nbsp;A[1..n]&nbsp;is said to have a&nbsp;majority element&nbsp;if more than half of its entries are the same.</p>
<p>Given:&nbsp;A positive integer&nbsp;k≤20, a positive integer&nbsp;<span class="math inline">\(n≤10^4\)</span>, and&nbsp;k&nbsp;arrays of size&nbsp;<span class="math inline">\(n\)</span>&nbsp;containing positive integers not exceeding&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;For each array, output an element of this array occurring strictly more than&nbsp;<span class="math inline">\(\frac{n}{2}\)</span>&nbsp;times if such element exists, and”-1”otherwise.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<section id="sample-dataset-5" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sample-dataset-5"><span class="header-section-number">6.1</span> Sample Dataset</h2>
<pre><code>4 8
5 5 5 5 5 5 5 5
8 7 7 7 1 7 3 7
7 1 6 5 10 100 1000 1
5 1 6 7 1 1 10 1</code></pre>
</section>
<section id="sample-output-5" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sample-output-5"><span class="header-section-number">6.2</span> Sample Output</h2>
<pre><code>5 7 -1 -1</code></pre>
</section>
<section id="solution-5" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="solution-5"><span class="header-section-number">6.3</span> Solution</h2>
<div class="sourceCode" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> string_to_int_list(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split()))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_possible_majority(numbers: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>    leader_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>    leader_count <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(numbers)):</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> numbers[leader_index] <span class="op">==</span> numbers[i]:</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>            leader_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>            leader_count <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> leader_count <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>            leader_index <span class="op">=</span> i</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>            leader_count <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> numbers[leader_index]</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_majority(numbers: List[<span class="bu">int</span>], candidate: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> num <span class="kw">in</span> numbers <span class="cf">if</span> num <span class="op">==</span> candidate)</span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count <span class="op">&gt;</span> <span class="bu">len</span>(numbers) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Using Moore's voting algorithm</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_majority(numbers: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>    candidate <span class="op">=</span> find_possible_majority(numbers)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> candidate <span class="cf">if</span> is_majority(numbers, candidate) <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="st">4 8</span></span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a><span class="st">5 5 5 5 5 5 5 5</span></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a><span class="st">8 7 7 7 1 7 3 7</span></span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a><span class="st">7 1 6 5 10 100 1000 1</span></span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a><span class="st">5 1 6 7 1 1 10 1</span></span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>_, <span class="op">*</span>number_lists <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>number_lists: List[List[<span class="bu">int</span>]] <span class="op">=</span> [string_to_int_list(line) <span class="cf">for</span> line <span class="kw">in</span> number_lists]</span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[find_majority(numbers) <span class="cf">for</span> numbers <span class="kw">in</span> number_lists])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="merge-two-sorted-arrays" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Merge Two Sorted Arrays</h1>
<p>The merging procedure is an essential part of&nbsp;<a href="https://rosalind.info/problems/ms/">Merge Sort</a>&nbsp;(which is considered in one of the next problems).</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^5\)</span>&nbsp;and a sorted array&nbsp;A[1..n]&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>, a positive integer&nbsp;<span class="math inline">\(m≤10^5\)</span>&nbsp;and a sorted array&nbsp;<span class="math inline">\(B[1..m]\)</span>&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;A sorted array&nbsp;<span class="math inline">\(C[1..n+m]\)</span> containing all the elements of&nbsp;A&nbsp;and&nbsp;B.</p>
<section id="sample-dataset-6" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="sample-dataset-6"><span class="header-section-number">7.1</span> Sample Dataset</h2>
<pre><code>4
2 4 10 18
3
-5 11 12</code></pre>
</section>
<section id="sample-output-6" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sample-output-6"><span class="header-section-number">7.2</span> Sample Output</h2>
<pre><code>-5 2 4 10 11 12 18</code></pre>
</section>
<section id="solution-6" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="solution-6"><span class="header-section-number">7.3</span> Solution</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_ints(x: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> x.split()]</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_sorted_lists(list1: List[<span class="bu">int</span>], list2: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    merged <span class="op">=</span> []</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&lt;</span> <span class="bu">len</span>(list1) <span class="kw">and</span> j <span class="op">&lt;</span> <span class="bu">len</span>(list2):</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> list1[i] <span class="op">&lt;</span> list2[j]:</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>            merged.append(list1[i])</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>            merged.append(list2[j])</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    merged.extend(list1[i:])</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>    merged.extend(list2[j:])</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> merged</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="st">2 4 10 18</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="st">-5 11 12</span></span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>_, list1_str, _, list2_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>list1 <span class="op">=</span> parse_ints(list1_str)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a>list2 <span class="op">=</span> parse_ints(list2_str)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> merge_sorted_lists(list1, list2)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="sum" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> 2SUM</h1>
<p>Given:&nbsp;A positive integer&nbsp;k≤20, a positive integer&nbsp;<span class="math inline">\(n≤10^4\)</span>, and&nbsp;k&nbsp;arrays of size&nbsp;n&nbsp;containing integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;For each array&nbsp;<span class="math inline">\(A[1..n]\)</span>, output two different indices&nbsp;<span class="math inline">\(1≤p&lt;q≤n\)</span>&nbsp;such that&nbsp;<span class="math inline">\(A[p]=−A[q]\)</span>&nbsp;if exist, and “-1” otherwise.</p>
<section id="sample-dataset-7" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sample-dataset-7"><span class="header-section-number">8.1</span> Sample Dataset</h2>
<pre><code>4 5
2 -3 4 10 5
8 2 4 -2 -8
-5 2 3 2 -4
5 4 -5 6 8</code></pre>
</section>
<section id="sample-output-7" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="sample-output-7"><span class="header-section-number">8.2</span> Sample Output</h2>
<pre><code>-1
2 4
-1
1 3</code></pre>
</section>
<section id="solution-7" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="solution-7"><span class="header-section-number">8.3</span> Solution</h2>
<div class="sourceCode" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Optional</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_ints(x: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> x.split()]</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_sum(target: <span class="bu">int</span>, numbers: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Optional[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>    complement_indices <span class="op">=</span> {}</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, num <span class="kw">in</span> <span class="bu">enumerate</span>(numbers, start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> num <span class="kw">in</span> complement_indices:</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> complement_indices[num], i</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>        complement_indices[target <span class="op">-</span> num] <span class="op">=</span> i</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_input(input_str: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, List[List[<span class="bu">int</span>]]]:</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_str.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    k, n <span class="op">=</span> parse_ints(lines[<span class="dv">0</span>])</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    arrays <span class="op">=</span> [parse_ints(line) <span class="cf">for</span> line <span class="kw">in</span> lines[<span class="dv">1</span>:]]</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> k, n, arrays</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a><span class="st">4 5</span></span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a><span class="st">2 -3 4 10 5</span></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="st">8 2 4 -2 -8</span></span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a><span class="st">-5 2 3 2 -4</span></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a><span class="st">5 4 -5 6 8</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>k, n, arrays <span class="op">=</span> process_input(sample_input)</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> arr <span class="kw">in</span> arrays:</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> two_sum(<span class="dv">0</span>, arr)</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> result:</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>result)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">-</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="sum-1" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> 3SUM</h1>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(k≤20\)</span>, a positive integer&nbsp;<span class="math inline">\(n≤10^4\)</span>, and&nbsp;<span class="math inline">\(k\)</span>&nbsp;arrays of size&nbsp;<span class="math inline">\(n\)</span>&nbsp;containing integers from&nbsp;<span class="math inline">\(−10^5\)</span> to&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;For each array&nbsp;<span class="math inline">\(A[1..n]\)</span>, output three different indices&nbsp;<span class="math inline">\(1≤p&lt;q&lt;r≤n\)</span>&nbsp;such that&nbsp;<span class="math inline">\(A[p]+A[q]+A[r]=0\)</span>&nbsp;if exist, and”-1”otherwise.</p>
<section id="sample-dataset-8" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="sample-dataset-8"><span class="header-section-number">9.1</span> Sample Dataset</h2>
<pre><code>4 5
2 -3 4 10 5
8 -6 4 -2 -8
-5 2 3 2 -4
2 4 -5 6 8</code></pre>
</section>
<section id="sample-output-8" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sample-output-8"><span class="header-section-number">9.2</span> Sample Output</h2>
<pre><code>-1
1 2 4
1 2 3
-1</code></pre>
</section>
<section id="solution-8" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="solution-8"><span class="header-section-number">9.3</span> Solution</h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Optional</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_ints(x: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> x.split()]</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_input(input_str: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, List[List[<span class="bu">int</span>]]]:</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_str.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    k, n <span class="op">=</span> parse_ints(lines[<span class="dv">0</span>])</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>    arrays <span class="op">=</span> [parse_ints(line) <span class="cf">for</span> line <span class="kw">in</span> lines[<span class="dv">1</span>:]]</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> k, n, arrays</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> three_sum(n: <span class="bu">int</span>, a: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>    h <span class="op">=</span> {}</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, n):</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>            s <span class="op">=</span> a[i] <span class="op">+</span> a[j]</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> s <span class="kw">in</span> h:</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> [h[s] <span class="op">+</span> <span class="dv">1</span>, i <span class="op">+</span> <span class="dv">1</span>, j <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>        h[<span class="op">-</span>a[i]] <span class="op">=</span> i</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a><span class="st">4 5</span></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a><span class="st">2 -3 4 10 5</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a><span class="st">8 -6 4 -2 -8</span></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a><span class="st">-5 2 3 2 -4</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="st">2 4 -5 6 8</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>k, n, arrays <span class="op">=</span> process_input(sample_input)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> arr <span class="kw">in</span> arrays:</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>three_sum(n, arr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="breadth-first-search" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Breadth-First Search</h1>
<p>The task is to use&nbsp;<a href="https://rosalind.info/glossary/algo-breadth-first-search/">breadth-first search</a>&nbsp;to compute single-source shortest distances in an unweighted directed graph.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-graph/">simple directed graph</a>&nbsp;with&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;An array&nbsp;D[1..n]&nbsp;where&nbsp;D[i]&nbsp;is the length of a shortest path from the vertex&nbsp;1&nbsp;to the vertex&nbsp;<span class="math inline">\(i\)</span>&nbsp;(D[1]=0). If&nbsp;i&nbsp;is not reachable from&nbsp;1&nbsp;set&nbsp;D[i]&nbsp;to&nbsp;−1.</p>
<section id="sample-dataset-9" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="sample-dataset-9"><span class="header-section-number">10.1</span> Sample Dataset</h2>
<pre><code>6 6
4 6
6 5
4 3
3 5
2 1
1 4</code></pre>
</section>
<section id="sample-output-9" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="sample-output-9"><span class="header-section-number">10.2</span> Sample Output</h2>
<pre><code>0 -1 2 1 3 2</code></pre>
</section>
<section id="solution-9" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="solution-9"><span class="header-section-number">10.3</span> Solution</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union, Iterator</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> deque</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_ints(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>    line <span class="op">=</span> <span class="bu">next</span>(handle).strip()</span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> line:</span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">next</span>(handle).strip()</span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line</span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(handle: Iterator[<span class="bu">str</span>], directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]:</span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>    nodes, n_edges <span class="op">=</span> parse_ints(read_non_empty_line(handle))</span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> {n: [] <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, nodes <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(n_edges):</span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> parse_ints(read_non_empty_line(handle))</span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> weighted:</span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a>            f, t, w <span class="op">=</span> edge</span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>            graph[f].append({<span class="st">"n"</span>: t, <span class="st">"w"</span>: w})</span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> directed:</span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>                graph[t].append({<span class="st">"n"</span>: f, <span class="st">"w"</span>: w})</span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>            f, t <span class="op">=</span> edge</span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a>            graph[f].append(t)</span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> directed:</span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a>                graph[t].append(f)</span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bfs(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], start: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">max</span>(graph.keys())</span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span>] <span class="op">*</span> (n <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>    distances[start] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>    queue <span class="op">=</span> deque([start])</span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> queue.popleft()</span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[node]:</span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> distances[neighbor] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>                distances[neighbor] <span class="op">=</span> distances[node] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances[<span class="dv">1</span>:]</span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a><span class="st">6 6</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a><span class="st">4 6</span></span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a><span class="st">6 5</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a><span class="st">4 3</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a><span class="st">2 1</span></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a><span class="st">1 4</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> parse_graph(StringIO(sample_input), directed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>bfs(graph))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="connected-components" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Connected Components</h1>
<p>The task is to use&nbsp;<a href="https://rosalind.info/glossary/algo-depth-first-search/">depth-first search</a>&nbsp;to compute the number of&nbsp;<a href="https://rosalind.info/glossary/algo-connected-graph/">connected components</a>&nbsp;in a given undirected graph.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/algo-simple-graph/">simple graph</a>&nbsp;with&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;The number of connected components in the graph.</p>
<section id="sample-dataset-10" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sample-dataset-10"><span class="header-section-number">11.1</span> Sample Dataset</h2>
<pre><code>12 13
1 2
1 5
5 9
5 10
9 10
3 4
3 7
3 8
4 8
7 11
8 11
11 12
8 12</code></pre>
</section>
<section id="sample-output-10" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sample-output-10"><span class="header-section-number">11.2</span> Sample Output</h2>
<pre><code>3</code></pre>
</section>
<section id="solution-10" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="solution-10"><span class="header-section-number">11.3</span> Solution</h2>
<div class="sourceCode" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Union</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, input_string.split()))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_lines: List[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]:</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>    graph_info <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> graph_info <span class="op">==</span> <span class="st">""</span>:</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>        graph_info <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>    num_nodes, num_edges <span class="op">=</span> parse_integers(graph_info)</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>    edge_list <span class="op">=</span> input_lines[<span class="dv">1</span>:num_edges<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]] <span class="op">=</span> {}</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_nodes <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>        adjacency_list[node] <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edge_list:</span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>            from_node, to_node, weight <span class="op">=</span> parse_integers(edge)</span>
<span id="cb34-20"><a href="#cb34-20" aria-hidden="true" tabindex="-1"></a>            adjacency_list[from_node].append({<span class="st">"node"</span>: to_node, <span class="st">"weight"</span>: weight})</span>
<span id="cb34-21"><a href="#cb34-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb34-22"><a href="#cb34-22" aria-hidden="true" tabindex="-1"></a>                adjacency_list[to_node].append({<span class="st">"node"</span>: from_node, <span class="st">"weight"</span>: weight})</span>
<span id="cb34-23"><a href="#cb34-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb34-24"><a href="#cb34-24" aria-hidden="true" tabindex="-1"></a>            from_node, to_node <span class="op">=</span> parse_integers(edge)</span>
<span id="cb34-25"><a href="#cb34-25" aria-hidden="true" tabindex="-1"></a>            adjacency_list[from_node].append(to_node)</span>
<span id="cb34-26"><a href="#cb34-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb34-27"><a href="#cb34-27" aria-hidden="true" tabindex="-1"></a>                adjacency_list[to_node].append(from_node)</span>
<span id="cb34-28"><a href="#cb34-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-29"><a href="#cb34-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb34-30"><a href="#cb34-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-31"><a href="#cb34-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_connected_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb34-32"><a href="#cb34-32" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> depth_first_search(current_node: <span class="bu">int</span>, visited_nodes: Set[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb34-33"><a href="#cb34-33" aria-hidden="true" tabindex="-1"></a>        visited_nodes.add(current_node)</span>
<span id="cb34-34"><a href="#cb34-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb34-35"><a href="#cb34-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited_nodes:</span>
<span id="cb34-36"><a href="#cb34-36" aria-hidden="true" tabindex="-1"></a>                depth_first_search(neighbor, visited_nodes)</span>
<span id="cb34-37"><a href="#cb34-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> visited_nodes</span>
<span id="cb34-38"><a href="#cb34-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-39"><a href="#cb34-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> depth_first_search(start_node, <span class="bu">set</span>())</span>
<span id="cb34-40"><a href="#cb34-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-41"><a href="#cb34-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_all_components(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[Set[<span class="bu">int</span>]]:</span>
<span id="cb34-42"><a href="#cb34-42" aria-hidden="true" tabindex="-1"></a>    unvisited_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb34-43"><a href="#cb34-43" aria-hidden="true" tabindex="-1"></a>    all_components: List[Set[<span class="bu">int</span>]] <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb34-44"><a href="#cb34-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> unvisited_nodes:</span>
<span id="cb34-45"><a href="#cb34-45" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_connected_component(<span class="bu">next</span>(<span class="bu">iter</span>(unvisited_nodes)), graph)</span>
<span id="cb34-46"><a href="#cb34-46" aria-hidden="true" tabindex="-1"></a>        unvisited_nodes <span class="op">-=</span> component</span>
<span id="cb34-47"><a href="#cb34-47" aria-hidden="true" tabindex="-1"></a>        all_components.append(component)</span>
<span id="cb34-48"><a href="#cb34-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_components</span>
<span id="cb34-49"><a href="#cb34-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-50"><a href="#cb34-50" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb34-51"><a href="#cb34-51" aria-hidden="true" tabindex="-1"></a><span class="st">12 13</span></span>
<span id="cb34-52"><a href="#cb34-52" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb34-53"><a href="#cb34-53" aria-hidden="true" tabindex="-1"></a><span class="st">1 5</span></span>
<span id="cb34-54"><a href="#cb34-54" aria-hidden="true" tabindex="-1"></a><span class="st">5 9</span></span>
<span id="cb34-55"><a href="#cb34-55" aria-hidden="true" tabindex="-1"></a><span class="st">5 10</span></span>
<span id="cb34-56"><a href="#cb34-56" aria-hidden="true" tabindex="-1"></a><span class="st">9 10</span></span>
<span id="cb34-57"><a href="#cb34-57" aria-hidden="true" tabindex="-1"></a><span class="st">3 4</span></span>
<span id="cb34-58"><a href="#cb34-58" aria-hidden="true" tabindex="-1"></a><span class="st">3 7</span></span>
<span id="cb34-59"><a href="#cb34-59" aria-hidden="true" tabindex="-1"></a><span class="st">3 8</span></span>
<span id="cb34-60"><a href="#cb34-60" aria-hidden="true" tabindex="-1"></a><span class="st">4 8</span></span>
<span id="cb34-61"><a href="#cb34-61" aria-hidden="true" tabindex="-1"></a><span class="st">7 11</span></span>
<span id="cb34-62"><a href="#cb34-62" aria-hidden="true" tabindex="-1"></a><span class="st">8 11</span></span>
<span id="cb34-63"><a href="#cb34-63" aria-hidden="true" tabindex="-1"></a><span class="st">11 12</span></span>
<span id="cb34-64"><a href="#cb34-64" aria-hidden="true" tabindex="-1"></a><span class="st">8 12</span></span>
<span id="cb34-65"><a href="#cb34-65" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb34-66"><a href="#cb34-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-67"><a href="#cb34-67" aria-hidden="true" tabindex="-1"></a>graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> parse_graph(sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb34-68"><a href="#cb34-68" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(find_all_components(graph)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="building-a-heap" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Building a Heap</h1>
<p>A&nbsp;<a href="https://rosalind.info/glossary/algo-binary-heap/">binary heap</a>&nbsp;is a&nbsp;<a href="https://rosalind.info/glossary/algo-binary-tree/">binary tree</a>&nbsp;based data structure that is often used to implement&nbsp;<a href="https://rosalind.info/glossary/algo-priority-queue/">priority queues</a>. Binary heaps, in turn, can be easily implemented using an array if the underlying tree is a complete binary tree. The tree nodes have a natural ordering: row by row, starting at the root and moving left to right within each row. If there are&nbsp;nn&nbsp;nodes, this ordering specifies their positions&nbsp;1,2,…,n&nbsp;within the array. Moving up and down the tree is easily simulated on the array, using the fact that node number&nbsp;j&nbsp;has parent&nbsp;<span class="math inline">\(⌈j/2⌉\)</span>&nbsp;and children&nbsp;2j&nbsp;and&nbsp;2j+1.</p>
<p>The goal of this problem is to build a heap from the given array. For this, go from the end to the beginning of a given array and let each element”bubble up”.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^5\)</span>&nbsp;and array&nbsp;A[1..n] of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;A permuted array&nbsp;A&nbsp;satisfying the binary&nbsp;<a href="https://rosalind.info/glossary/algo-heap/">max heap</a>&nbsp;property: for any&nbsp;<span class="math inline">\(2≤i≤n\)</span>,&nbsp;<span class="math inline">\(A[⌊i/2⌋]≥A[i]\)</span>.</p>
<section id="sample-dataset-11" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="sample-dataset-11"><span class="header-section-number">12.1</span> Sample Dataset</h2>
<pre><code>5
1 3 5 7 2</code></pre>
</section>
<section id="sample-output-11" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="sample-output-11"><span class="header-section-number">12.2</span> Sample Output</h2>
<pre><code>7 5 1 3 2</code></pre>
</section>
</section>
<section id="merge-sort" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Merge Sort</h1>
<p>The problem of&nbsp;<a href="https://rosalind.info/glossary/algo-sorting-algorithm/">sorting</a>&nbsp;a list of numbers lends itself immediately to a&nbsp;<a href="https://rosalind.info/glossary/algo-divide-and-conquer/">divide-and-conquer</a>&nbsp;strategy: split the list into two halves, recursively sort each half, and then merge the two sorted sublists (recall the problem&nbsp;<a href="https://rosalind.info/problems/mer/">“Merge Two Sorted Arrays”</a>).</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^5\)</span> and an array&nbsp;<span class="math inline">\(A[1..n]\)</span>&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;A sorted array&nbsp;<span class="math inline">\(A[1..n]\)</span>.</p>
<section id="sample-dataset-12" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="sample-dataset-12"><span class="header-section-number">13.1</span> Sample Dataset</h2>
<pre><code>10
20 19 35 -18 17 -20 20 1 4 4</code></pre>
</section>
<section id="sample-output-12" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sample-output-12"><span class="header-section-number">13.2</span> Sample Output</h2>
<pre><code>-20 -18 1 4 4 17 19 20 20 35</code></pre>
</section>
<section id="solution-11" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="solution-11"><span class="header-section-number">13.3</span> Solution</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge(left: List[<span class="bu">int</span>], right: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>    merged <span class="op">=</span> []</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    left_index, right_index <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> left_index <span class="op">&lt;</span> <span class="bu">len</span>(left) <span class="kw">and</span> right_index <span class="op">&lt;</span> <span class="bu">len</span>(right):</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left[left_index] <span class="op">&lt;</span> right[right_index]:</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>            merged.append(left[left_index])</span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a>            left_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>            merged.append(right[right_index])</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a>            right_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Append any remaining elements from both halves</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a>    merged.extend(left[left_index:])</span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a>    merged.extend(right[right_index:])</span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> merged</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_sort(array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(array) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a>        mid_index <span class="op">=</span> <span class="bu">len</span>(array) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a>        left_half <span class="op">=</span> merge_sort(array[:mid_index])</span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a>        right_half <span class="op">=</span> merge_sort(array[mid_index:])</span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> merge(left_half, right_half)</span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> array</span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="st">20 19 35 -18 17 -20 20 1 4 4</span></span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a>_, numbers <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>merge_sort(parse_integers(numbers)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="way-partition" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> 2-Way Partition</h1>
<p>A partition procedure is an essential part of the Quick Sort algorithm, the subject of one of the following problems. Its main goal is to put the first element of a given array to its proper place in a sorted array. It can be implemented in&nbsp;<a href="https://rosalind.info/glossary/algo-linear/">linear</a>&nbsp;time, by a single scan of a given array. Moreover, it is not hard to come up with an&nbsp;<a href="https://rosalind.info/glossary/algo-in-place-algorithm/">in-place</a>&nbsp;algorithm.</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^5\)</span>&nbsp;and an array&nbsp;<span class="math inline">\(A[1..n]\)</span>&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;A permuted array&nbsp;<span class="math inline">\(B[1..n]\)</span>&nbsp;such that it is a permutation of&nbsp;A&nbsp;and there is an index&nbsp;<span class="math inline">\(1≤q≤n\)</span>&nbsp;such that&nbsp;<span class="math inline">\(B[i]≤A[1]\)</span>&nbsp;for all&nbsp;<span class="math inline">\(1≤i≤q−1\)</span>,&nbsp;<span class="math inline">\(B[q]=A[1]\)</span>, and&nbsp;<span class="math inline">\(B[i]&gt;A[1]\)</span>&nbsp;for all&nbsp;<span class="math inline">\(q+1≤i≤n\)</span>.</p>
<section id="sample-dataset-13" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="sample-dataset-13"><span class="header-section-number">14.1</span> Sample Dataset</h2>
<pre><code>9
7 2 5 6 1 3 9 4 8</code></pre>
</section>
<section id="sample-output-13" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="sample-output-13"><span class="header-section-number">14.2</span> Sample Output</h2>
<pre><code>4 2 5 6 1 3 7 9 8</code></pre>
</section>
<section id="solution-12" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="solution-12"><span class="header-section-number">14.3</span> Solution</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(number) <span class="cf">for</span> number <span class="kw">in</span> line.split()]</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partition(array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(array) <span class="op">&lt;=</span> <span class="dv">1</span>:</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> array</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    pivot <span class="op">=</span> array[<span class="dv">0</span>]</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    swap_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_index <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(array)):</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> array[current_index] <span class="op">&lt;=</span> pivot:</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>            swap_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>            array[current_index], array[swap_index] <span class="op">=</span> array[swap_index], array[current_index]</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>    array[<span class="dv">0</span>], array[swap_index] <span class="op">=</span> array[swap_index], array[<span class="dv">0</span>]</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> array</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a><span class="st">9</span></span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a><span class="st">7 2 5 6 1 3 9 4 8</span></span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>_, input_numbers <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> partition(parse_integers(input_numbers))</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="way-partition-1" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> 3-Way Partition</h1>
<p>This problem is very similar to&nbsp;<a href="https://rosalind.info/problems/par/">“2-Way Partition”</a>, but now the goal is to partition an input array more carefully.</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^5\)</span> and an array&nbsp;<span class="math inline">\(A[1..n]\)</span>&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to <span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;An array&nbsp;B[1..n]&nbsp;such that it is a permutation of&nbsp;A&nbsp;and there are indices&nbsp;<span class="math inline">\(1≤q≤r≤n\)</span>&nbsp;such that&nbsp;<span class="math inline">\(B[i]&lt;A[1]\)</span>&nbsp;for all&nbsp;<span class="math inline">\(1≤i≤q−1\)</span>,&nbsp;<span class="math inline">\(B[i]=A[1]\)</span> for all&nbsp;<span class="math inline">\(q≤i≤r\)</span>, and&nbsp;<span class="math inline">\(B[i]&gt;A[1]\)</span>&nbsp;for all&nbsp;<span class="math inline">\(r+1≤i≤n\)</span>.</p>
<section id="sample-dataset-14" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="sample-dataset-14"><span class="header-section-number">15.1</span> Sample Dataset</h2>
<pre><code>9
4 5 6 4 1 2 5 7 4</code></pre>
</section>
<section id="sample-output-14" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="sample-output-14"><span class="header-section-number">15.2</span> Sample Output</h2>
<pre><code>2 1 4 4 4 5 7 6 5</code></pre>
</section>
<section id="solution-13" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="solution-13"><span class="header-section-number">15.3</span> Solution</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(number) <span class="cf">for</span> number <span class="kw">in</span> line.split()]</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> three_way_partition(array: List[<span class="bu">int</span>], start: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>, end: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>        start <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> end <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>        end <span class="op">=</span> <span class="bu">len</span>(array) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    pivot <span class="op">=</span> array[start]</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    low <span class="op">=</span> start</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> start</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>    high <span class="op">=</span> end</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current <span class="op">&lt;=</span> high:</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> array[current] <span class="op">&lt;</span> pivot:</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>            array[current], array[low] <span class="op">=</span> array[low], array[current]</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>            current <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>            low <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> array[current] <span class="op">&gt;</span> pivot:</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>            array[current], array[high] <span class="op">=</span> array[high], array[current]</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>            high <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>            current <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> low, high</span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="st">9</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="st">4 5 6 4 1 2 5 7 4</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>_, input_line <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> parse_integers(input_line)</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>three_way_partition(numbers)</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>numbers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="square-in-a-graph" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Square in a Graph</h1>
<p>Given:&nbsp;A positive integer&nbsp;k≤20&nbsp;and&nbsp;k&nbsp;<a href="https://rosalind.info/glossary/algo-simple-graph/">simple undirected graphs</a>&nbsp;with&nbsp;<span class="math inline">\(n≤400\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;For each graph, output”1”if it contains a simple cycle (that is, a cycle which doesn’t intersect itself) of length&nbsp;<span class="math inline">\(4\)</span>&nbsp;and”-1”otherwise.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<section id="sample-dataset-15" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="sample-dataset-15"><span class="header-section-number">16.1</span> Sample Dataset</h2>
<pre><code>2

4 5
3 4
4 2
3 2
3 1
1 2

4 4
1 2
3 4
2 4
4 1</code></pre>
</section>
<section id="sample-output-15" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="sample-output-15"><span class="header-section-number">16.2</span> Sample Output</h2>
<pre><code>1 -1</code></pre>
</section>
<section id="solution-14" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="solution-14"><span class="header-section-number">16.3</span> Solution</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union, Iterator</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> line:</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_graph(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]:</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    num_nodes, num_edges <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> {node: [] <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_nodes <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_edges):</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>        edge_data <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>            from_node, to_node, weight <span class="op">=</span> edge_data</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>            graph[from_node].append({<span class="st">"node"</span>: to_node, <span class="st">"weight"</span>: weight})</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>                graph[to_node].append({<span class="st">"node"</span>: from_node, <span class="st">"weight"</span>: weight})</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>            from_node, to_node <span class="op">=</span> edge_data</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>            graph[from_node].append(to_node)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>                graph[to_node].append(from_node)</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> depth_first_search(graph: Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]], start: <span class="bu">int</span>, max_depth: <span class="bu">int</span>):</span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dfs_recursive(current_node: <span class="bu">int</span>, current_depth: <span class="bu">int</span>, visited: <span class="bu">set</span>):</span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_depth <span class="op">==</span> max_depth:</span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> current_node</span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_depth <span class="op">&lt;</span> max_depth:</span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a>                neighbor_node <span class="op">=</span> neighbor <span class="cf">if</span> <span class="bu">isinstance</span>(neighbor, <span class="bu">int</span>) <span class="cf">else</span> neighbor[<span class="st">'node'</span>]</span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> neighbor_node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">yield</span> <span class="cf">from</span> dfs_recursive(neighbor_node, current_depth <span class="op">+</span> <span class="dv">1</span>, visited <span class="op">|</span> {current_node})</span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dfs_recursive(start, <span class="dv">0</span>, <span class="bu">set</span>())</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_square_cycle(graph: Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]], cycle_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb48-46"><a href="#cb48-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> end_node <span class="kw">in</span> depth_first_search(graph, start_node, cycle_length <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb48-47"><a href="#cb48-47" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> end_node <span class="kw">in</span> graph[start_node]:</span>
<span id="cb48-48"><a href="#cb48-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb48-49"><a href="#cb48-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb48-50"><a href="#cb48-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-51"><a href="#cb48-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_multiple_graphs(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> List[Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]]:</span>
<span id="cb48-52"><a href="#cb48-52" aria-hidden="true" tabindex="-1"></a>    num_graphs <span class="op">=</span> <span class="bu">int</span>(read_non_empty_line(input_iterator))</span>
<span id="cb48-53"><a href="#cb48-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [create_graph(input_iterator, is_directed, is_weighted) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_graphs)]</span>
<span id="cb48-54"><a href="#cb48-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-55"><a href="#cb48-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb48-56"><a href="#cb48-56" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb48-57"><a href="#cb48-57" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb48-58"><a href="#cb48-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-59"><a href="#cb48-59" aria-hidden="true" tabindex="-1"></a><span class="st">4 5</span></span>
<span id="cb48-60"><a href="#cb48-60" aria-hidden="true" tabindex="-1"></a><span class="st">3 4</span></span>
<span id="cb48-61"><a href="#cb48-61" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb48-62"><a href="#cb48-62" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb48-63"><a href="#cb48-63" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb48-64"><a href="#cb48-64" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb48-65"><a href="#cb48-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-66"><a href="#cb48-66" aria-hidden="true" tabindex="-1"></a><span class="st">4 4</span></span>
<span id="cb48-67"><a href="#cb48-67" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb48-68"><a href="#cb48-68" aria-hidden="true" tabindex="-1"></a><span class="st">3 4</span></span>
<span id="cb48-69"><a href="#cb48-69" aria-hidden="true" tabindex="-1"></a><span class="st">2 4</span></span>
<span id="cb48-70"><a href="#cb48-70" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb48-71"><a href="#cb48-71" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb48-72"><a href="#cb48-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-73"><a href="#cb48-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print results</span></span>
<span id="cb48-74"><a href="#cb48-74" aria-hidden="true" tabindex="-1"></a>graphs <span class="op">=</span> parse_multiple_graphs(<span class="bu">iter</span>(sample_input), is_directed<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb48-75"><a href="#cb48-75" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> [has_square_cycle(graph, <span class="dv">4</span>) <span class="cf">for</span> graph <span class="kw">in</span> graphs]</span>
<span id="cb48-76"><a href="#cb48-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="testing-bipartiteness" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Testing Bipartiteness</h1>
<p>A&nbsp;<em>bipartite</em>&nbsp;graph is a graph&nbsp;<span class="math inline">\(G=(V,E)\)</span>&nbsp;whose vertices can be partitioned into two sets (<span class="math inline">\(V=V_1∪V_2\)</span>&nbsp;and&nbsp;<span class="math inline">\(V_1∩V_2=∅\)</span>) such that there are no edges between vertices in the same set (for instance, if&nbsp;<span class="math inline">\(u,v∈V1\)</span>, then there is no edge between&nbsp;u&nbsp;and&nbsp;v).</p>
<p>There are many other ways to formulate this property. For instance, an undirected graph is bipartite if and only if it can be colored with just two colors. Another one: an undirected graph is bipartite if and only if it contains no cycles of odd length.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<p>Given:&nbsp;A positive integer&nbsp;k≤20&nbsp;and&nbsp;k&nbsp;<a href="https://rosalind.info/glossary/algo-simple-graph/">simple graphs</a>&nbsp;in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>&nbsp;with at most&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;vertices each.</p>
<p>Return:&nbsp;For each graph, output”1”if it is bipartite and”-1”otherwise.</p>
<section id="sample-dataset-16" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="sample-dataset-16"><span class="header-section-number">17.1</span> Sample Dataset</h2>
<pre><code>2

3 3
1 2
3 2
3 1

4 3
1 4
3 1
1 2</code></pre>
</section>
<section id="sample-output-16" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="sample-output-16"><span class="header-section-number">17.2</span> Sample Output</h2>
<pre><code>-1 1</code></pre>
</section>
<section id="solution-15" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="solution-15"><span class="header-section-number">17.3</span> Solution</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union, Iterator</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> line:</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iterator: Iterator[<span class="bu">str</span>], directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]:</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    num_nodes, num_edges <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> {node: [] <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_nodes <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_edges):</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> weighted:</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>            from_node, to_node, weight <span class="op">=</span> edge</span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>            graph[from_node].append({<span class="st">"node"</span>: to_node, <span class="st">"weight"</span>: weight})</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> directed:</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>                graph[to_node].append({<span class="st">"node"</span>: from_node, <span class="st">"weight"</span>: weight})</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>            from_node, to_node <span class="op">=</span> edge</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>            graph[from_node].append(to_node)</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> directed:</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>                graph[to_node].append(from_node)</span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_bipartite(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    color <span class="op">=</span> {<span class="dv">1</span>: <span class="dv">0</span>}</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    queue <span class="op">=</span> [<span class="dv">1</span>]</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>            neighbor_color <span class="op">=</span> (color[current_node] <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="dv">2</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> color:</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>                color[neighbor] <span class="op">=</span> neighbor_color</span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> color[neighbor] <span class="op">!=</span> neighbor_color:</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_multiple_graphs(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>    num_cases <span class="op">=</span> <span class="bu">int</span>(read_non_empty_line(input_iterator))</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>    results <span class="op">=</span> []</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_cases):</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> parse_graph(input_iterator)</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>        results.append(is_bipartite(graph))</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> results</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a><span class="st">3 3</span></span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a><span class="st">4 3</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a><span class="st">1 4</span></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list to an iterator</span></span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a>sample_input_iterator <span class="op">=</span> <span class="bu">iter</span>(sample_input)</span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Process multiple graphs</span></span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> process_multiple_graphs(sample_input_iterator)</span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="testing-acyclicity" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Testing Acyclicity</h1>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(k≤20\)</span>&nbsp;and&nbsp;k&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-graph/">simple directed graphs</a>&nbsp;in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>&nbsp;with at most&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;vertices and&nbsp;<span class="math inline">\(3⋅10^3\)</span>&nbsp;edges each.</p>
<p>Return:&nbsp;For each graph, output”1”if the graph is&nbsp;<a href="https://rosalind.info/glossary/algo-directed-acyclic-graph/">acyclic</a>&nbsp;and”-1”otherwise.</p>
<section id="sample-dataset-17" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="sample-dataset-17"><span class="header-section-number">18.1</span> Sample Dataset</h2>
<pre><code>3

2 1
1 2

4 4
4 1
1 2
2 3
3 1

4 3
4 3
3 2
2 1</code></pre>
</section>
<section id="sample-output-17" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="sample-output-17"><span class="header-section-number">18.2</span> Sample Output</h2>
<pre><code>1 -1 1</code></pre>
</section>
<section id="solution-16" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="solution-16"><span class="header-section-number">18.3</span> Solution</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union, Iterator</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iter: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    line <span class="op">=</span> <span class="bu">next</span>(input_iter).strip()</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> line:</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">next</span>(input_iter).strip()</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iter: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]:</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    node_count, edge_count <span class="op">=</span> parse_integers(read_non_empty_line(input_iter))</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> {node: [] <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, node_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> parse_integers(read_non_empty_line(input_iter))</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>            source, target, weight <span class="op">=</span> edge</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>            graph[source].append({<span class="st">"node"</span>: target, <span class="st">"weight"</span>: weight})</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>                graph[target].append({<span class="st">"node"</span>: source, <span class="st">"weight"</span>: weight})</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>            source, target <span class="op">=</span> edge</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>            graph[source].append(target)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>                graph[target].append(source)</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graph_nodes(graph):</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>        nodes.add(node)</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes.union(neighbors)</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_leaves(graph):</span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> graph_nodes(graph)</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>    leaves <span class="op">=</span> nodes <span class="op">-</span> graph.keys()</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {n: <span class="bu">set</span>(v) <span class="op">-</span> leaves <span class="cf">for</span> n, v <span class="kw">in</span> graph.items() <span class="cf">if</span> <span class="bu">len</span>(<span class="bu">set</span>(v) <span class="op">-</span> leaves)}</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_dag(graph):</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>        new_graph <span class="op">=</span> remove_leaves(graph)</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(graph) <span class="op">==</span> <span class="bu">len</span>(new_graph):</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> new_graph</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_multiple_graphs(input_iter: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> List[Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]]:</span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>    case_count <span class="op">=</span> <span class="bu">int</span>(read_non_empty_line(input_iter))</span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a>    graphs <span class="op">=</span> []</span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(case_count):</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a>        graphs.append(parse_graph(input_iter, is_directed, is_weighted))</span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graphs</span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a><span class="st">2 1</span></span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a><span class="st">4 4</span></span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a><span class="st">2 3</span></span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a><span class="st">4 3</span></span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a><span class="st">4 3</span></span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a><span class="st">2 1</span></span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list to an iterator</span></span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a>input_iterator <span class="op">=</span> <span class="bu">iter</span>(sample_input)</span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse multiple graphs</span></span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a>graphs <span class="op">=</span> parse_multiple_graphs(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a><span class="co"># Process each graph</span></span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> [is_dag(graph) <span class="cf">for</span> graph <span class="kw">in</span> graphs]</span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="dijkstras-algorithm" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Dijkstra’s Algorithm</h1>
<p>The task is to use&nbsp;<a href="https://rosalind.info/glossary/algo-dijkstras-algorithm/">Dijkstra’s algorithm</a>&nbsp;to compute single-source shortest distances in a directed graph with positive edge weights.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-graph/">simple directed graph</a>&nbsp;with positive edge weights from&nbsp;1&nbsp;to&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;and&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;An array&nbsp;<span class="math inline">\(D[1..n]\)</span>&nbsp;where&nbsp;<span class="math inline">\(D[i]\)</span>&nbsp;is the length of a shortest path from the vertex&nbsp;1&nbsp;to the vertex&nbsp;i&nbsp;(<span class="math inline">\(D[1]=0\)</span>). If&nbsp;ii&nbsp;is not reachable from&nbsp;1&nbsp;set D[i]&nbsp;to&nbsp;−1.</p>
<section id="sample-dataset-18" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="sample-dataset-18"><span class="header-section-number">19.1</span> Sample Dataset</h2>
<pre><code>6 10
3 4 4
1 2 4
1 3 2
2 3 3
6 3 2
3 5 5
5 4 1
3 2 1
2 4 2
2 5 3</code></pre>
</section>
<section id="sample-output-18" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="sample-output-18"><span class="header-section-number">19.2</span> Sample Output</h2>
<pre><code>0 3 2 5 6 -1</code></pre>
</section>
<section id="solution-17" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="solution-17"><span class="header-section-number">19.3</span> Solution</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> heapq <span class="im">import</span> heappush, heappop</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union, Iterator</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iter: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    line <span class="op">=</span> <span class="bu">next</span>(input_iter).strip()</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> line:</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">next</span>(input_iter).strip()</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iter: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]:</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    vertex_count, edge_count <span class="op">=</span> parse_integers(read_non_empty_line(input_iter))</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> {vertex: [] <span class="cf">for</span> vertex <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vertex_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> parse_integers(read_non_empty_line(input_iter))</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>            source, destination, weight <span class="op">=</span> edge</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append({<span class="st">"vertex"</span>: destination, <span class="st">"weight"</span>: weight})</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>                adjacency_list[destination].append({<span class="st">"vertex"</span>: source, <span class="st">"weight"</span>: weight})</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a>            source, destination <span class="op">=</span> edge</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append(destination)</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>                adjacency_list[destination].append(source)</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dijkstra(graph, start_vertex<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [inf <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(graph) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>    distances[start_vertex] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>    priority_queue <span class="op">=</span> []</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>    heappush(priority_queue, (<span class="dv">0</span>, start_vertex))</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> priority_queue:</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>        current_vertex <span class="op">=</span> heappop(priority_queue)[<span class="dv">1</span>]</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>        visited.add(current_vertex)</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_vertex]:</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(neighbor, <span class="bu">dict</span>):</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>                next_vertex <span class="op">=</span> neighbor[<span class="st">"vertex"</span>]</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>                edge_weight <span class="op">=</span> neighbor[<span class="st">"weight"</span>]</span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>                next_vertex <span class="op">=</span> neighbor</span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a>                edge_weight <span class="op">=</span> <span class="dv">1</span>  <span class="co"># Assume unit weight for unweighted graphs</span></span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> next_vertex <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a>                new_distance <span class="op">=</span> distances[current_vertex] <span class="op">+</span> edge_weight</span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> new_distance <span class="op">&lt;</span> distances[next_vertex]:</span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>                    distances[next_vertex] <span class="op">=</span> new_distance</span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a>                    heappush(priority_queue, (distances[next_vertex], next_vertex))</span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="op">-</span><span class="dv">1</span> <span class="cf">if</span> distance <span class="op">==</span> inf <span class="cf">else</span> distance <span class="cf">for</span> distance <span class="kw">in</span> distances[<span class="dv">1</span>:]]</span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a><span class="st">6 10</span></span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a><span class="st">3 4 4</span></span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a><span class="st">1 2 4</span></span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a><span class="st">1 3 2</span></span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a><span class="st">2 3 3</span></span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a><span class="st">6 3 2</span></span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a><span class="st">3 5 5</span></span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a><span class="st">5 4 1</span></span>
<span id="cb57-69"><a href="#cb57-69" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 1</span></span>
<span id="cb57-70"><a href="#cb57-70" aria-hidden="true" tabindex="-1"></a><span class="st">2 4 2</span></span>
<span id="cb57-71"><a href="#cb57-71" aria-hidden="true" tabindex="-1"></a><span class="st">2 5 3</span></span>
<span id="cb57-72"><a href="#cb57-72" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb57-73"><a href="#cb57-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-74"><a href="#cb57-74" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list to an iterator</span></span>
<span id="cb57-75"><a href="#cb57-75" aria-hidden="true" tabindex="-1"></a>input_iterator <span class="op">=</span> <span class="bu">iter</span>(sample_input)</span>
<span id="cb57-76"><a href="#cb57-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-77"><a href="#cb57-77" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> parse_graph(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>, is_weighted<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb57-78"><a href="#cb57-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>dijkstra(graph))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="heap-sort" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Heap Sort</h1>
<p>The heap sort algorithm first transforms a given array into a&nbsp;<a href="https://rosalind.info/glossary/algo-heap/">max heap</a>&nbsp;(recall the problem&nbsp;<a href="https://rosalind.info/problems/hea/">“Building a Heap”</a>). It then repeats the following two simple steps&nbsp;<span class="math inline">\(n−1\)</span>&nbsp;times:</p>
<ul>
<li>Swap the last element of the heap with its root and decrease the size of the heap by&nbsp;1.</li>
<li>“Sift-down”the new root element to its proper place.</li>
</ul>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^5\)</span>&nbsp;and an array&nbsp;A[1..n]&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;A sorted array&nbsp;A.</p>
<section id="sample-dataset-19" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="sample-dataset-19"><span class="header-section-number">20.1</span> Sample Dataset</h2>
<pre><code>9
2 6 7 1 3 5 4 8 9</code></pre>
</section>
<section id="sample-output-19" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="sample-output-19"><span class="header-section-number">20.2</span> Sample Output</h2>
<pre><code>1 2 3 4 5 6 7 8 9</code></pre>
</section>
<section id="solution-18" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="solution-18"><span class="header-section-number">20.3</span> Solution</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Any</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bubble_up(heap: List[<span class="bu">int</span>], index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> index <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    parent_index: <span class="bu">int</span> <span class="op">=</span> (index <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    current_index: <span class="bu">int</span> <span class="op">=</span> index</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> heap[parent_index] <span class="op">&gt;</span> heap[current_index]:</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        bubble_up(heap, parent_index)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>        heap[parent_index], heap[current_index] <span class="op">=</span> heap[current_index], heap[parent_index]</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a>        bubble_up(heap, parent_index)</span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_heap(array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    heap: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, element <span class="kw">in</span> <span class="bu">enumerate</span>(array):</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>        heap.append(element)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>        bubble_up(heap, i)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> heap</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sift_down(heap: List[<span class="bu">int</span>], start_index: <span class="bu">int</span>, end_index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a>    root_index: <span class="bu">int</span> <span class="op">=</span> start_index</span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> root_index <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">&lt;=</span> end_index:</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>        left_child_index: <span class="bu">int</span> <span class="op">=</span> root_index <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>        right_child_index: <span class="bu">int</span> <span class="op">=</span> left_child_index <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>        swap_index: <span class="bu">int</span> <span class="op">=</span> root_index</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> heap[swap_index] <span class="op">&lt;</span> heap[left_child_index]:</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>            swap_index <span class="op">=</span> left_child_index</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> right_child_index <span class="op">&lt;=</span> end_index <span class="kw">and</span> heap[swap_index] <span class="op">&lt;</span> heap[right_child_index]:</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>            swap_index <span class="op">=</span> right_child_index</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> swap_index <span class="op">!=</span> root_index:</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>            heap[root_index], heap[swap_index] <span class="op">=</span> heap[swap_index], heap[root_index]</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a>            root_index <span class="op">=</span> swap_index</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> heap_sort(array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>    heap: List[<span class="bu">int</span>] <span class="op">=</span> build_heap(array)</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>    last_index: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(heap) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> last_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>        heap[<span class="dv">0</span>], heap[last_index] <span class="op">=</span> heap[last_index], heap[<span class="dv">0</span>]</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>        last_index <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>        sift_down(heap, <span class="dv">0</span>, last_index)</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> heap</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a><span class="st">9</span></span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a><span class="st">2 6 7 1 3 5 4 8 9</span></span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>_, input_array_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>input_array: List[<span class="bu">int</span>] <span class="op">=</span> parse_integers(input_array_str)</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>sorted_array: List[<span class="bu">int</span>] <span class="op">=</span> heap_sort(input_array)</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>sorted_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="counting-inversions" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Counting Inversions</h1>
<p>An inversion of an array&nbsp;A[1..n]&nbsp;is a pair of indices&nbsp;<span class="math inline">\((i,j)\)</span>&nbsp;such that&nbsp;<span class="math inline">\(1≤i&lt;j≤n\)</span>&nbsp;and&nbsp;A[i]&gt;A[j]. The number of inversions shows how far the array is from being sorted: if it is already sorted then there are no inversions, whereas if it is sorted in reverse order then the number of inversions is maximal.</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^5\)</span>&nbsp;and an array&nbsp;<span class="math inline">\(A[1..n]\)</span>&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span> to&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;The number of inversions in&nbsp;A.</p>
<section id="sample-dataset-20" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="sample-dataset-20"><span class="header-section-number">21.1</span> Sample Dataset</h2>
<pre><code>5
-6 1 15 8 10</code></pre>
</section>
<section id="sample-output-20" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="sample-output-20"><span class="header-section-number">21.2</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution-19" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="solution-19"><span class="header-section-number">21.3</span> Solution</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_and_count_inversions(left: List[<span class="bu">int</span>], right: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], <span class="bu">int</span>]:</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    merged: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    inversion_count: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    left_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(left)</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>    left_index: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> left <span class="kw">and</span> right:</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left[<span class="dv">0</span>] <span class="op">&lt;=</span> right[<span class="dv">0</span>]:</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>            left_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>            merged.append(left.pop(<span class="dv">0</span>))</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>            inversion_count <span class="op">+=</span> left_length <span class="op">-</span> left_index</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>            merged.append(right.pop(<span class="dv">0</span>))</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>    merged.extend(left)</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>    merged.extend(right)</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> merged, inversion_count</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> merge_sort_and_count_inversions(arr: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], <span class="bu">int</span>]:</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(arr) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>        mid: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(arr) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>        left_half, left_inversions <span class="op">=</span> merge_sort_and_count_inversions(arr[:mid])</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>        right_half, right_inversions <span class="op">=</span> merge_sort_and_count_inversions(arr[mid:])</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>        merged, merge_inversions <span class="op">=</span> merge_and_count_inversions(left_half, right_half)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a>        total_inversions: <span class="bu">int</span> <span class="op">=</span> left_inversions <span class="op">+</span> right_inversions <span class="op">+</span> merge_inversions</span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> merged, total_inversions</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> arr, <span class="dv">0</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a><span class="st">-6 1 15 8 10</span></span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>_, input_array_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>input_array: List[<span class="bu">int</span>] <span class="op">=</span> parse_integers(input_array_str)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>_, inversion_count <span class="op">=</span> merge_sort_and_count_inversions(input_array)</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(inversion_count)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="bellman-ford-algorithm" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> Bellman-Ford Algorithm</h1>
<p>The task is to use&nbsp;<a href="https://rosalind.info/glossary/algo-bellman-ford-algorithm/">Bellman-Ford algorithm</a>&nbsp;to compute single-source shortest distances in a directed graph with possibly negative edge weights (but without negative cycles).</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-graph/">simple directed graph</a>&nbsp;with integer edge weights from&nbsp;<span class="math inline">\(−10^3\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;and&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;An array&nbsp;D[1..n]&nbsp;where&nbsp;D[i]&nbsp;is the length of a shortest path from the vertex&nbsp;1&nbsp;to the vertex&nbsp;ii&nbsp;(D[1]=0). If&nbsp;ii&nbsp;is not reachable from&nbsp;1&nbsp;set&nbsp;D[i]&nbsp;to&nbsp;<code>x</code>.</p>
<section id="sample-dataset-21" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="sample-dataset-21"><span class="header-section-number">22.1</span> Sample Dataset</h2>
<pre><code>9 13
1 2 10
3 2 1
3 4 1
4 5 3
5 6 -1
7 6 -1
8 7 1
1 8 8
7 2 -4
2 6 2
6 3 -2
9 5 -10
9 4 7</code></pre>
</section>
<section id="sample-output-21" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="sample-output-21"><span class="header-section-number">22.2</span> Sample Output</h2>
<pre><code>0 5 5 6 9 7 9 8 x</code></pre>
</section>
<section id="solution-20" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="solution-20"><span class="header-section-number">22.3</span> Solution</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf, isinf</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union, Iterator, Set, Tuple</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>    line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> line:</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a>EdgeInfo <span class="op">=</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]</span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, EdgeInfo]]]</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a>    vertex_count, edge_count <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Graph <span class="op">=</span> {vertex: [] <span class="cf">for</span> vertex <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vertex_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a>        edge_data <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>            source_vertex, target_vertex, edge_weight <span class="op">=</span> edge_data</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source_vertex].append({<span class="st">"node"</span>: target_vertex, <span class="st">"weight"</span>: edge_weight})</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>                adjacency_list[target_vertex].append({<span class="st">"node"</span>: source_vertex, <span class="st">"weight"</span>: edge_weight})</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>            source_vertex, target_vertex <span class="op">=</span> edge_data</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source_vertex].append(target_vertex)</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a>                adjacency_list[target_vertex].append(source_vertex)</span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_edges(graph: Graph) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(<span class="bu">len</span>(neighbors) <span class="cf">for</span> neighbors <span class="kw">in</span> graph.values())</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_vertices(graph: Graph) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a>    all_vertices: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbors <span class="kw">in</span> graph.values():</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(neighbor, <span class="bu">dict</span>):</span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>                all_vertices.add(neighbor[<span class="st">"node"</span>])</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>                all_vertices.add(neighbor)</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_vertices</span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bellman_ford(graph: Graph, start_vertex: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1</span>) <span class="op">-&gt;</span> List[Union[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a>    distances: Dict[<span class="bu">int</span>, <span class="bu">float</span>] <span class="op">=</span> {vertex: inf <span class="cf">for</span> vertex <span class="kw">in</span> get_all_vertices(graph)}</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>    distances[start_vertex] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(count_edges(graph) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> current_vertex, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">isinstance</span>(neighbor, <span class="bu">dict</span>):</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>                    target_vertex <span class="op">=</span> neighbor[<span class="st">"node"</span>]</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>                    edge_weight <span class="op">=</span> neighbor[<span class="st">"weight"</span>]</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> distances[current_vertex] <span class="op">+</span> edge_weight <span class="op">&lt;</span> distances[target_vertex]:</span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a>                        distances[target_vertex] <span class="op">=</span> distances[current_vertex] <span class="op">+</span> edge_weight</span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="st">"x"</span> <span class="cf">if</span> isinf(distance) <span class="cf">else</span> distance <span class="cf">for</span> distance <span class="kw">in</span> distances.values()]</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a><span class="st">9 13</span></span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a><span class="st">1 2 10</span></span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 1</span></span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a><span class="st">3 4 1</span></span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a><span class="st">4 5 3</span></span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a><span class="st">5 6 -1</span></span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a><span class="st">7 6 -1</span></span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a><span class="st">8 7 1</span></span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true" tabindex="-1"></a><span class="st">1 8 8</span></span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true" tabindex="-1"></a><span class="st">7 2 -4</span></span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true" tabindex="-1"></a><span class="st">2 6 2</span></span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true" tabindex="-1"></a><span class="st">6 3 -2</span></span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true" tabindex="-1"></a><span class="st">9 5 -10</span></span>
<span id="cb66-76"><a href="#cb66-76" aria-hidden="true" tabindex="-1"></a><span class="st">9 4 7</span></span>
<span id="cb66-77"><a href="#cb66-77" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span>.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb66-78"><a href="#cb66-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-79"><a href="#cb66-79" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the list to an iterator</span></span>
<span id="cb66-80"><a href="#cb66-80" aria-hidden="true" tabindex="-1"></a>input_iterator <span class="op">=</span> <span class="bu">iter</span>(sample_input)</span>
<span id="cb66-81"><a href="#cb66-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-82"><a href="#cb66-82" aria-hidden="true" tabindex="-1"></a><span class="co"># Parse the graph with correct parameters</span></span>
<span id="cb66-83"><a href="#cb66-83" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> parse_graph(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>, is_weighted<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb66-84"><a href="#cb66-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-85"><a href="#cb66-85" aria-hidden="true" tabindex="-1"></a><span class="co"># Run Bellman-Ford algorithm</span></span>
<span id="cb66-86"><a href="#cb66-86" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> bellman_ford(graph)</span>
<span id="cb66-87"><a href="#cb66-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="shortest-cycle-through-a-given-edge" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> Shortest Cycle Through a Given Edge</h1>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(k≤20\)</span>&nbsp;and&nbsp;k&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-graph/">simple directed graphs</a>&nbsp;with positive integer edge weights and at most&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;For each graph, output the length of a shortest cycle going through the first specified edge if there is a cycle and”-1”otherwise.</p>
<section id="sample-dataset-22" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="sample-dataset-22"><span class="header-section-number">23.1</span> Sample Dataset</h2>
<pre><code>2

4 5
2 4 2
3 2 1
1 4 3
2 1 10
1 3 4

4 5
3 2 1
2 4 2
4 1 3
2 1 10
1 3 4</code></pre>
</section>
<section id="sample-output-22" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="sample-output-22"><span class="header-section-number">23.2</span> Sample Output</h2>
<pre><code>-1 10</code></pre>
</section>
<section id="solution-21" class="level2" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="solution-21"><span class="header-section-number">23.3</span> Solution</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union, Iterator, Tuple</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> heapq <span class="im">import</span> heappush, heappop</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>GraphNode <span class="op">=</span> Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[<span class="bu">int</span>, List[GraphNode]]</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iter: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    line <span class="op">=</span> <span class="bu">next</span>(input_iter).strip()</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> line:</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">next</span>(input_iter).strip()</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iter: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>    vertex_count, edge_count <span class="op">=</span> parse_integers(read_non_empty_line(input_iter))</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>    adj_list: Graph <span class="op">=</span> {vertex: [] <span class="cf">for</span> vertex <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vertex_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>        edge_data <span class="op">=</span> parse_integers(read_non_empty_line(input_iter))</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>            src, dest, weight <span class="op">=</span> edge_data</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>            adj_list[src].append({<span class="st">"node"</span>: dest, <span class="st">"weight"</span>: weight})</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>                adj_list[dest].append({<span class="st">"node"</span>: src, <span class="st">"weight"</span>: weight})</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a>            src, dest <span class="op">=</span> edge_data</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>            adj_list[src].append(dest)</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>                adj_list[dest].append(src)</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adj_list</span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dijkstra(graph: Graph, start: <span class="bu">int</span> <span class="op">=</span> <span class="dv">1</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [inf <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(graph) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>    distances[start] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>    priority_queue <span class="op">=</span> []</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a>    heappush(priority_queue, (<span class="dv">0</span>, start))</span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> priority_queue:</span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>        _, current_node <span class="op">=</span> heappop(priority_queue)</span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_node <span class="kw">in</span> visited:</span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(neighbor, <span class="bu">dict</span>):</span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a>                neighbor_node, edge_weight <span class="op">=</span> neighbor[<span class="st">"node"</span>], neighbor[<span class="st">"weight"</span>]</span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a>                neighbor_node, edge_weight <span class="op">=</span> neighbor, <span class="dv">1</span></span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor_node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a>                new_distance <span class="op">=</span> distances[current_node] <span class="op">+</span> edge_weight</span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> new_distance <span class="op">&lt;</span> distances[neighbor_node]:</span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a>                    distances[neighbor_node] <span class="op">=</span> new_distance</span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a>                    heappush(priority_queue, (new_distance, neighbor_node))</span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="op">-</span><span class="dv">1</span> <span class="cf">if</span> d <span class="op">==</span> inf <span class="cf">else</span> d <span class="cf">for</span> d <span class="kw">in</span> distances[<span class="dv">1</span>:]]</span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_first_edges(input_handle: StringIO) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_handle.read().splitlines()</span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>    graph_count <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">0</span>])</span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a>    current_line <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a>    first_edges <span class="op">=</span> []</span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(graph_count):</span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="kw">not</span> lines[current_line]:</span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a>            current_line <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a>        _, edge_count <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, lines[current_line].split())</span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a>        first_edges.append(<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[current_line <span class="op">+</span> <span class="dv">1</span>].split())))</span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a>        current_line <span class="op">+=</span> <span class="bu">int</span>(edge_count) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> first_edges</span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cycle_length(graph: Graph, edge: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a>    distance <span class="op">=</span> dijkstra(graph, start<span class="op">=</span>edge[<span class="dv">1</span>])[edge[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance <span class="cf">if</span> distance <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="cf">else</span> distance <span class="op">+</span> edge[<span class="dv">2</span>]</span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_multiple_graphs(input_str: <span class="bu">str</span>, directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> List[Graph]:</span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a>    input_iter <span class="op">=</span> <span class="bu">iter</span>(input_str.splitlines())</span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a>    graph_count <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(input_iter))</span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a>    graphs <span class="op">=</span> []</span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(graph_count):</span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a>        graphs.append(parse_graph(input_iter, is_directed<span class="op">=</span>directed, is_weighted<span class="op">=</span>weighted))</span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graphs</span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a><span class="st">4 5</span></span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true" tabindex="-1"></a><span class="st">2 4 2</span></span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 1</span></span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true" tabindex="-1"></a><span class="st">1 4 3</span></span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true" tabindex="-1"></a><span class="st">2 1 10</span></span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true" tabindex="-1"></a><span class="st">1 3 4</span></span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true" tabindex="-1"></a><span class="st">4 5</span></span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 1</span></span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true" tabindex="-1"></a><span class="st">2 4 2</span></span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true" tabindex="-1"></a><span class="st">4 1 3</span></span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true" tabindex="-1"></a><span class="st">2 1 10</span></span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true" tabindex="-1"></a><span class="st">1 3 4</span></span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true" tabindex="-1"></a><span class="co"># Main execution</span></span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true" tabindex="-1"></a>input_handle <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true" tabindex="-1"></a>first_edges <span class="op">=</span> extract_first_edges(input_handle)</span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true" tabindex="-1"></a>input_handle.seek(<span class="dv">0</span>)  <span class="co"># Reset the StringIO object to the beginning</span></span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true" tabindex="-1"></a>graphs <span class="op">=</span> parse_multiple_graphs(input_handle.read(), directed<span class="op">=</span><span class="va">True</span>, weighted<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true" tabindex="-1"></a>results <span class="op">=</span> [calculate_cycle_length(graphs[i], first_edges[i]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(graphs))]</span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="median" class="level1" data-number="24">
<h1 data-number="24"><span class="header-section-number">24</span> Median</h1>
<p>The task is to implement a linear time randomized algorithm for the&nbsp;<a href="https://rosalind.info/glossary/algo-selection-algorithm/">selection</a>&nbsp;problem.</p>
<p>Given:&nbsp;A positive integer&nbsp;n≤105n≤105&nbsp;and an array&nbsp;<span class="math inline">\(A[1..n]\)</span>&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>, a positive number&nbsp;<span class="math inline">\(k≤n\)</span>.</p>
<p>Return:&nbsp;The&nbsp;k-th smallest element of&nbsp;A.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<section id="sample-dataset-23" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="sample-dataset-23"><span class="header-section-number">24.1</span> Sample Dataset</h2>
<pre><code>11
2 36 5 21 8 13 11 20 5 4 1
8</code></pre>
</section>
<section id="sample-output-23" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="sample-output-23"><span class="header-section-number">24.2</span> Sample Output</h2>
<pre><code>13</code></pre>
</section>
<section id="solution-22" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="solution-22"><span class="header-section-number">24.3</span> Solution</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Parse a line of space-separated integers into a list of integers."""</span></span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> three_way_partition(arr: List[<span class="bu">int</span>], low: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>, high: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Partition the array into three parts based on a pivot."""</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> high <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>        high <span class="op">=</span> <span class="bu">len</span>(arr) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    pivot <span class="op">=</span> arr[low]</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>    mid <span class="op">=</span> low</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> mid <span class="op">&lt;=</span> high:</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> arr[mid] <span class="op">&lt;</span> pivot:</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>            arr[low], arr[mid] <span class="op">=</span> arr[mid], arr[low]</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>            low <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>            mid <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> arr[mid] <span class="op">&gt;</span> pivot:</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>            arr[mid], arr[high] <span class="op">=</span> arr[high], arr[mid]</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>            high <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>            mid <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> low, high</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_kth_element(arr: List[<span class="bu">int</span>], k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find the k-th element in the array using a three-way partitioning method."""</span></span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> find_kth_recursive(arr: List[<span class="bu">int</span>], k: <span class="bu">int</span>, low: <span class="bu">int</span>, high: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>        left, right <span class="op">=</span> three_way_partition(arr, low, high)</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> k <span class="op">&lt;</span> left:</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> find_kth_recursive(arr, k, low, left <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> k <span class="op">&gt;</span> right:</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> find_kth_recursive(arr, k, right <span class="op">+</span> <span class="dv">1</span>, high)</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> arr[k]</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> find_kth_recursive(arr, k, <span class="dv">0</span>, <span class="bu">len</span>(arr) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> process_input(input_str: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], <span class="bu">int</span>]:</span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Process the input string and return the list of integers and the index k."""</span></span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_str.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>    arr <span class="op">=</span> parse_integers(lines[<span class="dv">1</span>])</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>    k <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">2</span>])</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> arr, k</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a><span class="st">11</span></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a><span class="st">2 36 5 21 8 13 11 20 5 4 1</span></span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a><span class="st">8</span></span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>arr, k <span class="op">=</span> process_input(sample_input)</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_kth_element(arr, k <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="partial-sort" class="level1" data-number="25">
<h1 data-number="25"><span class="header-section-number">25</span> Partial Sort</h1>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^5\)</span>&nbsp;and an array&nbsp;A[1..n]&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>, a positive integer&nbsp;k≤1000.</p>
<p>Return:&nbsp;The&nbsp;k&nbsp;smallest elements of a sorted array&nbsp;A.</p>
<section id="sample-dataset-24" class="level2" data-number="25.1">
<h2 data-number="25.1" class="anchored" data-anchor-id="sample-dataset-24"><span class="header-section-number">25.1</span> Sample Dataset</h2>
<pre><code>10
4 -6 7 8 -9 100 12 13 56 17
3</code></pre>
</section>
<section id="sample-output-24" class="level2" data-number="25.2">
<h2 data-number="25.2" class="anchored" data-anchor-id="sample-output-24"><span class="header-section-number">25.2</span> Sample Output</h2>
<pre><code>-9 -6 4</code></pre>
</section>
<section id="solution-23" class="level2" data-number="25.3">
<h2 data-number="25.3" class="anchored" data-anchor-id="solution-23"><span class="header-section-number">25.3</span> Solution</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Parse a line of space-separated integers into a list of integers."""</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> heapify_up(heap: List[<span class="bu">int</span>], i: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Maintain heap property by moving an element up the heap."""</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>        parent <span class="op">=</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> heap[parent] <span class="op">&lt;</span> heap[i]:</span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>            heap[parent], heap[i] <span class="op">=</span> heap[i], heap[parent]</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>            i <span class="op">=</span> parent</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_max_heap(arr: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Build a max heap from an array."""</span></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>    heap <span class="op">=</span> []</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> arr:</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>        heap.append(x)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>        heapify_up(heap, <span class="bu">len</span>(heap) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> heap</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sift_down(heap: List[<span class="bu">int</span>], start: <span class="bu">int</span>, end: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Maintain heap property by moving an element down the heap."""</span></span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> start</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> root <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span> <span class="op">&lt;=</span> end:</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>        left <span class="op">=</span> root <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>        right <span class="op">=</span> left <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>        swap <span class="op">=</span> root</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> heap[swap] <span class="op">&lt;</span> heap[left]:</span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>            swap <span class="op">=</span> left</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> right <span class="op">&lt;=</span> end <span class="kw">and</span> heap[swap] <span class="op">&lt;</span> heap[right]:</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>            swap <span class="op">=</span> right</span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> swap <span class="op">!=</span> root:</span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>            heap[root], heap[swap] <span class="op">=</span> heap[swap], heap[root]</span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>            root <span class="op">=</span> swap</span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> heap_sort(arr: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Sort an array using heap sort algorithm."""</span></span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a>    heap <span class="op">=</span> build_max_heap(arr)</span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(heap) <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a>        heap[<span class="dv">0</span>], heap[i] <span class="op">=</span> heap[i], heap[<span class="dv">0</span>]</span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a>        sift_down(heap, <span class="dv">0</span>, i <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> heap</span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partial_sort(arr: List[<span class="bu">int</span>], k: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find and sort the k smallest elements in the array."""</span></span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a>    heap <span class="op">=</span> build_max_heap(arr[:k])</span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> arr[k:]:</span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> x <span class="op">&lt;</span> heap[<span class="dv">0</span>]:</span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true" tabindex="-1"></a>            heap[<span class="dv">0</span>] <span class="op">=</span> x</span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true" tabindex="-1"></a>            sift_down(heap, <span class="dv">0</span>, k <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> heap_sort(heap)</span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true" tabindex="-1"></a><span class="st">4 -6 7 8 -9 100 12 13 56 17</span></span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true" tabindex="-1"></a>_, arr_str, k_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true" tabindex="-1"></a>arr <span class="op">=</span> parse_integers(arr_str)</span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="bu">int</span>(k_str)</span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-70"><a href="#cb75-70" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform partial sort and print result</span></span>
<span id="cb75-71"><a href="#cb75-71" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> partial_sort(arr, k)</span>
<span id="cb75-72"><a href="#cb75-72" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="topological-sorting" class="level1" data-number="26">
<h1 data-number="26"><span class="header-section-number">26</span> Topological Sorting</h1>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-acyclic-graph/">simple directed acyclic graph</a>&nbsp;with&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/algo-topological-sorting/">topological sorting</a>&nbsp;(i.e., a permutation of vertices) of the graph.</p>
<section id="sample-dataset-25" class="level2" data-number="26.1">
<h2 data-number="26.1" class="anchored" data-anchor-id="sample-dataset-25"><span class="header-section-number">26.1</span> Sample Dataset</h2>
<pre><code>4 5
1 2
3 1
3 2
4 3
4 2</code></pre>
</section>
<section id="sample-output-25" class="level2" data-number="26.2">
<h2 data-number="26.2" class="anchored" data-anchor-id="sample-output-25"><span class="header-section-number">26.2</span> Sample Output</h2>
<pre><code>4 3 1 2</code></pre>
</section>
<section id="solution-24" class="level2" data-number="26.3">
<h2 data-number="26.3" class="anchored" data-anchor-id="solution-24"><span class="header-section-number">26.3</span> Solution</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, Dict, Union, Set</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>GraphNode <span class="op">=</span> Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[<span class="bu">int</span>, List[GraphNode]]</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> line:</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    vertex_count, edge_count <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Graph <span class="op">=</span> {vertex: [] <span class="cf">for</span> vertex <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vertex_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>        edge_data <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a>            source, destination, weight <span class="op">=</span> edge_data</span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append({<span class="st">"node"</span>: destination, <span class="st">"weight"</span>: weight})</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>                adjacency_list[destination].append({<span class="st">"node"</span>: source, <span class="st">"weight"</span>: weight})</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a>            source, destination <span class="op">=</span> edge_data</span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append(destination)</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>                adjacency_list[destination].append(source)</span>
<span id="cb78-34"><a href="#cb78-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-35"><a href="#cb78-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb78-36"><a href="#cb78-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-37"><a href="#cb78-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_graph_nodes(graph: Graph) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb78-38"><a href="#cb78-38" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb78-39"><a href="#cb78-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb78-40"><a href="#cb78-40" aria-hidden="true" tabindex="-1"></a>        nodes.add(node)</span>
<span id="cb78-41"><a href="#cb78-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb78-42"><a href="#cb78-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">isinstance</span>(neighbor, <span class="bu">dict</span>):</span>
<span id="cb78-43"><a href="#cb78-43" aria-hidden="true" tabindex="-1"></a>                nodes.add(neighbor[<span class="st">"node"</span>])</span>
<span id="cb78-44"><a href="#cb78-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb78-45"><a href="#cb78-45" aria-hidden="true" tabindex="-1"></a>                nodes.add(neighbor)</span>
<span id="cb78-46"><a href="#cb78-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb78-47"><a href="#cb78-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-48"><a href="#cb78-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph: Graph) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb78-49"><a href="#cb78-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dfs_topological(vertex: <span class="bu">int</span>, visited: Dict[<span class="bu">int</span>, <span class="bu">bool</span>], stack: List[<span class="bu">int</span>]):</span>
<span id="cb78-50"><a href="#cb78-50" aria-hidden="true" tabindex="-1"></a>        visited[vertex] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb78-51"><a href="#cb78-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[vertex]:</span>
<span id="cb78-52"><a href="#cb78-52" aria-hidden="true" tabindex="-1"></a>            neighbor_node <span class="op">=</span> neighbor[<span class="st">"node"</span>] <span class="cf">if</span> <span class="bu">isinstance</span>(neighbor, <span class="bu">dict</span>) <span class="cf">else</span> neighbor</span>
<span id="cb78-53"><a href="#cb78-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> visited[neighbor_node]:</span>
<span id="cb78-54"><a href="#cb78-54" aria-hidden="true" tabindex="-1"></a>                dfs_topological(neighbor_node, visited, stack)</span>
<span id="cb78-55"><a href="#cb78-55" aria-hidden="true" tabindex="-1"></a>        stack.append(vertex)</span>
<span id="cb78-56"><a href="#cb78-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-57"><a href="#cb78-57" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> defaultdict(<span class="bu">bool</span>)</span>
<span id="cb78-58"><a href="#cb78-58" aria-hidden="true" tabindex="-1"></a>    stack <span class="op">=</span> []</span>
<span id="cb78-59"><a href="#cb78-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> get_all_graph_nodes(graph):</span>
<span id="cb78-60"><a href="#cb78-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> visited[node]:</span>
<span id="cb78-61"><a href="#cb78-61" aria-hidden="true" tabindex="-1"></a>            dfs_topological(node, visited, stack)</span>
<span id="cb78-62"><a href="#cb78-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-63"><a href="#cb78-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb78-64"><a href="#cb78-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-65"><a href="#cb78-65" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb78-66"><a href="#cb78-66" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb78-67"><a href="#cb78-67" aria-hidden="true" tabindex="-1"></a><span class="st">4 5</span></span>
<span id="cb78-68"><a href="#cb78-68" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb78-69"><a href="#cb78-69" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb78-70"><a href="#cb78-70" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb78-71"><a href="#cb78-71" aria-hidden="true" tabindex="-1"></a><span class="st">4 3</span></span>
<span id="cb78-72"><a href="#cb78-72" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb78-73"><a href="#cb78-73" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb78-74"><a href="#cb78-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-75"><a href="#cb78-75" aria-hidden="true" tabindex="-1"></a>input_iterator <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb78-76"><a href="#cb78-76" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> parse_graph(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb78-77"><a href="#cb78-77" aria-hidden="true" tabindex="-1"></a>sorted_nodes <span class="op">=</span> topological_sort(graph)</span>
<span id="cb78-78"><a href="#cb78-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>sorted_nodes)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="hamiltonian-path-in-dag" class="level1" data-number="27">
<h1 data-number="27"><span class="header-section-number">27</span> Hamiltonian Path in DAG</h1>
<p>A Hamiltonian path is a path in a graph that visits each vertex exactly once. Checking whether a graph contains a Hamiltonian path is a well-known hard problem. At the same time it is easy to perform such a check if a given graph is a&nbsp;<a href="https://rosalind.info/glossary/algo-directed-acyclic-graph/">DAG</a>.</p>
<p>Given:&nbsp;A positive integer&nbsp;k≤20&nbsp;and&nbsp;k&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-acyclic-graph/">simple directed acyclic graphs</a>&nbsp;in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>&nbsp;with at most&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;vertices each.</p>
<p>Return:&nbsp;For each graph, if it contains a Hamiltonian path output”1”followed by a Hamiltonian path (i.e., a list of vertices), otherwise output”-1”.</p>
<section id="sample-dataset-26" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="sample-dataset-26"><span class="header-section-number">27.1</span> Sample Dataset</h2>
<pre><code>2

3 3
1 2
2 3
1 3

4 3
4 3
3 2
4 1</code></pre>
</section>
<section id="sample-output-26" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="sample-output-26"><span class="header-section-number">27.2</span> Sample Output</h2>
<pre><code>1 1 2 3
-1</code></pre>
</section>
<section id="solution-25" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="solution-25"><span class="header-section-number">27.3</span> Solution</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, Dict, Set</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, line.split()))</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">next</span>(line <span class="cf">for</span> line <span class="kw">in</span> input_iterator <span class="cf">if</span> line.strip())</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    vertex_count, edge_count <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>        source, destination <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>        adjacency_list[source].append(destination)</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a>            adjacency_list[destination].append(source)</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_multiple_graphs(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> List[Graph]:</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>    num_cases <span class="op">=</span> <span class="bu">int</span>(read_non_empty_line(input_iterator))</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [parse_graph(input_iterator, is_directed) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_cases)]</span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graph_nodes(graph: Graph) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(graph.keys()) <span class="op">|</span> <span class="bu">set</span>.union(<span class="op">*</span>(<span class="bu">set</span>(val) <span class="cf">for</span> val <span class="kw">in</span> graph.values()))</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph: Graph) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dfs(node: <span class="bu">int</span>, visited: Set[<span class="bu">int</span>], stack: List[<span class="bu">int</span>]):</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>        visited.add(node)</span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[node]:</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>                dfs(neighbor, visited, stack)</span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>        stack.append(node)</span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>    stack: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph_nodes(graph):</span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a>            dfs(node, visited, stack)</span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hdag(graph: Graph) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a>    sorted_nodes <span class="op">=</span> topological_sort(graph)</span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(sorted_nodes, sorted_nodes[<span class="dv">1</span>:]):</span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> b <span class="kw">not</span> <span class="kw">in</span> graph[a]:</span>
<span id="cb81-53"><a href="#cb81-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb81-54"><a href="#cb81-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="dv">1</span>] <span class="op">+</span> sorted_nodes</span>
<span id="cb81-55"><a href="#cb81-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-56"><a href="#cb81-56" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb81-57"><a href="#cb81-57" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb81-58"><a href="#cb81-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-59"><a href="#cb81-59" aria-hidden="true" tabindex="-1"></a><span class="st">3 3</span></span>
<span id="cb81-60"><a href="#cb81-60" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb81-61"><a href="#cb81-61" aria-hidden="true" tabindex="-1"></a><span class="st">2 3</span></span>
<span id="cb81-62"><a href="#cb81-62" aria-hidden="true" tabindex="-1"></a><span class="st">1 3</span></span>
<span id="cb81-63"><a href="#cb81-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-64"><a href="#cb81-64" aria-hidden="true" tabindex="-1"></a><span class="st">4 3</span></span>
<span id="cb81-65"><a href="#cb81-65" aria-hidden="true" tabindex="-1"></a><span class="st">4 3</span></span>
<span id="cb81-66"><a href="#cb81-66" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb81-67"><a href="#cb81-67" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb81-68"><a href="#cb81-68" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb81-69"><a href="#cb81-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-70"><a href="#cb81-70" aria-hidden="true" tabindex="-1"></a>input_iterator <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb81-71"><a href="#cb81-71" aria-hidden="true" tabindex="-1"></a>graphs <span class="op">=</span> parse_multiple_graphs(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb81-72"><a href="#cb81-72" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> graph <span class="kw">in</span> graphs:</span>
<span id="cb81-73"><a href="#cb81-73" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>hdag(graph))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="negative-weight-cycle" class="level1" data-number="28">
<h1 data-number="28"><span class="header-section-number">28</span> Negative Weight Cycle</h1>
<p>The task is to use&nbsp;<a href="https://rosalind.info/glossary/algo-bellman-ford-algorithm/">Bellman-Ford algorithm</a>&nbsp;to check whether a given graph contains a cycle of negative weight.</p>
<p>Given:&nbsp;A positive integer&nbsp;k≤20&nbsp;and&nbsp;k&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-graph/">simple directed graphs</a>&nbsp;with integer edge weights from&nbsp;<span class="math inline">\(−10^3\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;and&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;For each graph, output”1”if it contains a negative weight cycle and”-1”otherwise.</p>
<section id="sample-dataset-27" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="sample-dataset-27"><span class="header-section-number">28.1</span> Sample Dataset</h2>
<pre><code>2

4 5
1 4 4
4 2 3
2 3 1
3 1 6
2 1 -7

3 4
1 2 -8
2 3 20
3 1 -1
3 2 -30</code></pre>
</section>
<section id="sample-output-27" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="sample-output-27"><span class="header-section-number">28.2</span> Sample Output</h2>
<pre><code>-1 1</code></pre>
</section>
<section id="solution-26" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="solution-26"><span class="header-section-number">28.3</span> Solution</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union, Iterator</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> deque</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>    line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="kw">not</span> line:</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">next</span>(input_iterator).strip()</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> line</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]:</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>    node_count, edge_count <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> {node: [] <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, node_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>        edge_data <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>            source, target, weight <span class="op">=</span> edge_data</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append({<span class="st">"node"</span>: target, <span class="st">"weight"</span>: weight})</span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>                adjacency_list[target].append({<span class="st">"node"</span>: source, <span class="st">"weight"</span>: weight})</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>            source, target <span class="op">=</span> edge_data</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append(target)</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>                adjacency_list[target].append(source)</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_multiple_graphs(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> List[Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]]:</span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>    test_case_count <span class="op">=</span> <span class="bu">int</span>(read_non_empty_line(input_iterator))</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [parse_graph(input_iterator, is_directed, is_weighted) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(test_case_count)]</span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_edges(graph):</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>    edge_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> _ <span class="kw">in</span> neighbors:</span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>            edge_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> edge_count</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph):</span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">list</span>(graph.keys())</span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>    target_nodes <span class="op">=</span> [neighbor[<span class="st">"node"</span>] <span class="cf">for</span> neighbors <span class="kw">in</span> graph.values() <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors]</span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(source_nodes) <span class="op">|</span> <span class="bu">set</span>(target_nodes)</span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> detect_negative_weight_cycle(graph):</span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> {node: <span class="dv">10</span><span class="op">**</span><span class="dv">20</span> <span class="cf">for</span> node <span class="kw">in</span> get_all_nodes(graph)}</span>
<span id="cb84-52"><a href="#cb84-52" aria-hidden="true" tabindex="-1"></a>    distances[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb84-53"><a href="#cb84-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(count_edges(graph) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb84-54"><a href="#cb84-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb84-55"><a href="#cb84-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb84-56"><a href="#cb84-56" aria-hidden="true" tabindex="-1"></a>                distances[neighbor[<span class="st">"node"</span>]] <span class="op">=</span> <span class="bu">min</span>(distances[source] <span class="op">+</span> neighbor[<span class="st">"weight"</span>], distances[neighbor[<span class="st">"node"</span>]])</span>
<span id="cb84-57"><a href="#cb84-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb84-58"><a href="#cb84-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb84-59"><a href="#cb84-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> distances[source] <span class="op">+</span> neighbor[<span class="st">"weight"</span>] <span class="op">&lt;</span> distances[neighbor[<span class="st">"node"</span>]]:</span>
<span id="cb84-60"><a href="#cb84-60" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="dv">1</span></span>
<span id="cb84-61"><a href="#cb84-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb84-62"><a href="#cb84-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-63"><a href="#cb84-63" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb84-64"><a href="#cb84-64" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb84-65"><a href="#cb84-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-66"><a href="#cb84-66" aria-hidden="true" tabindex="-1"></a><span class="st">4 5</span></span>
<span id="cb84-67"><a href="#cb84-67" aria-hidden="true" tabindex="-1"></a><span class="st">1 4 4</span></span>
<span id="cb84-68"><a href="#cb84-68" aria-hidden="true" tabindex="-1"></a><span class="st">4 2 3</span></span>
<span id="cb84-69"><a href="#cb84-69" aria-hidden="true" tabindex="-1"></a><span class="st">2 3 1</span></span>
<span id="cb84-70"><a href="#cb84-70" aria-hidden="true" tabindex="-1"></a><span class="st">3 1 6</span></span>
<span id="cb84-71"><a href="#cb84-71" aria-hidden="true" tabindex="-1"></a><span class="st">2 1 -7</span></span>
<span id="cb84-72"><a href="#cb84-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-73"><a href="#cb84-73" aria-hidden="true" tabindex="-1"></a><span class="st">3 4</span></span>
<span id="cb84-74"><a href="#cb84-74" aria-hidden="true" tabindex="-1"></a><span class="st">1 2 -8</span></span>
<span id="cb84-75"><a href="#cb84-75" aria-hidden="true" tabindex="-1"></a><span class="st">2 3 20</span></span>
<span id="cb84-76"><a href="#cb84-76" aria-hidden="true" tabindex="-1"></a><span class="st">3 1 -1</span></span>
<span id="cb84-77"><a href="#cb84-77" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 -30</span></span>
<span id="cb84-78"><a href="#cb84-78" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb84-79"><a href="#cb84-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-80"><a href="#cb84-80" aria-hidden="true" tabindex="-1"></a>input_iterator <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb84-81"><a href="#cb84-81" aria-hidden="true" tabindex="-1"></a>graphs <span class="op">=</span> parse_multiple_graphs(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>, is_weighted<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb84-82"><a href="#cb84-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[detect_negative_weight_cycle(graph) <span class="cf">for</span> graph <span class="kw">in</span> graphs])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="quick-sort" class="level1" data-number="29">
<h1 data-number="29"><span class="header-section-number">29</span> Quick Sort</h1>
<p>Comparing the algorithms for&nbsp;<a href="https://rosalind.info/glossary/algo-sorting-algorithm/">sorting</a>&nbsp;and&nbsp;<a href="https://rosalind.info/problems/med/">“Median”</a>&nbsp;finding we notice that, beyond the common&nbsp;<a href="https://rosalind.info/glossary/algo-divide-and-conquer/">divide-and-conquer</a>&nbsp;philosophy and structure, they are exact opposites.&nbsp;<a href="https://rosalind.info/problems/ms/">“Merge Sort”</a>&nbsp;splits the array in two in the most convenient way (first half, second half), without any regard to the magnitudes of the elements in each half; but then it works hard to put the sorted subarrays together. In contrast, the median algorithm is careful about its splitting (smaller numbers first, then the larger ones), but its work ends with the recursive call.</p>
<p><em>Quick sort</em>&nbsp;is a sorting algorithm that splits the array in exactly the same way as the median algorithm; and once the subarrays are sorted, by two recursive calls, there is nothing more to do. Its worst-case performance is&nbsp;<span class="math inline">\(Θ(n2)\)</span>, like that of median-finding. But it can be proved that its average case is&nbsp;<span class="math inline">\(O(n \log ⁡n)\)</span>; furthermore, empirically it outperforms other sorting algorithms. This has made quicksort a favorite in many applications— for instance, it is the basis of the code by which really enormous files are sorted.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(n≤10^5\)</span>&nbsp;and an array&nbsp;A[1..n]&nbsp;of integers from&nbsp;<span class="math inline">\(−10^5\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^5\)</span>.</p>
<p>Return:&nbsp;A sorted array A[1..n].</p>
<section id="sample-dataset-28" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="sample-dataset-28"><span class="header-section-number">29.1</span> Sample Dataset</h2>
<pre><code>7
5 -2 4 7 8 -10 11</code></pre>
</section>
<section id="sample-output-28" class="level2" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="sample-output-28"><span class="header-section-number">29.2</span> Sample Output</h2>
<pre><code>-10 -2 4 5 7 8 11</code></pre>
</section>
<section id="solution-27" class="level2" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="solution-27"><span class="header-section-number">29.3</span> Solution</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(input_line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(number) <span class="cf">for</span> number <span class="kw">in</span> input_line.split()]</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> three_way_partition(array: List[<span class="bu">int</span>], start: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>, end: <span class="bu">int</span> <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>:</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>        start <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> end <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>        end <span class="op">=</span> <span class="bu">len</span>(array) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    pivot <span class="op">=</span> array[start]</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> start</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current <span class="op">&lt;=</span> end:</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> array[current] <span class="op">&lt;</span> pivot:</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>            array[current], array[start] <span class="op">=</span> array[start], array[current]</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>            current <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>            start <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> array[current] <span class="op">&gt;</span> pivot:</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>            array[current], array[end] <span class="op">=</span> array[end], array[current]</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>            end <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>            current <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> start, end</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> quick_sort(array: List[<span class="bu">int</span>]):</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> quick_sort_recursive(array: List[<span class="bu">int</span>], start: <span class="bu">int</span>, end: <span class="bu">int</span>):</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> start <span class="op">&lt;</span> end:</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>            partition_start, partition_end <span class="op">=</span> three_way_partition(array, start, end)</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> start <span class="op">&lt;</span> partition_start:</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>                quick_sort_recursive(array, start, partition_start <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> end <span class="op">&gt;</span> partition_end:</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>                quick_sort_recursive(array, partition_end <span class="op">+</span> <span class="dv">1</span>, end)</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>    quick_sort_recursive(array, <span class="dv">0</span>, <span class="bu">len</span>(array) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a><span class="st">7</span></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a><span class="st">5 -2 4 7 8 -10 11</span></span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>_, input_numbers <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>numbers <span class="op">=</span> parse_integers(input_numbers)  <span class="co"># Convert the input string to a list of integers</span></span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>quick_sort(numbers)</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>numbers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="strongly-connected-components" class="level1" data-number="30">
<h1 data-number="30"><span class="header-section-number">30</span> Strongly Connected Components</h1>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-graph/">simple directed graph</a>&nbsp;with&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;The number of&nbsp;<a href="https://rosalind.info/glossary/algo-strongly-connected-component/">strongly connected components</a>&nbsp;in the graph.</p>
<section id="sample-dataset-29" class="level2" data-number="30.1">
<h2 data-number="30.1" class="anchored" data-anchor-id="sample-dataset-29"><span class="header-section-number">30.1</span> Sample Dataset</h2>
<pre><code>6 7
4 1
1 2
2 4
5 6
3 2
5 3
3 5</code></pre>
</section>
<section id="sample-output-29" class="level2" data-number="30.2">
<h2 data-number="30.2" class="anchored" data-anchor-id="sample-output-29"><span class="header-section-number">30.2</span> Sample Output</h2>
<pre><code>3</code></pre>
</section>
<section id="solution-28" class="level2" data-number="30.3">
<h2 data-number="30.3" class="anchored" data-anchor-id="solution-28"><span class="header-section-number">30.3</span> Solution</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Union, Iterator</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">next</span>(line.strip() <span class="cf">for</span> line <span class="kw">in</span> input_iterator <span class="cf">if</span> line.strip())</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    node_count, edge_count <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> {n: [] <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, node_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a>            source, target, weight <span class="op">=</span> edge</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>            graph[source].append({<span class="st">"n"</span>: target, <span class="st">"w"</span>: weight})</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>                graph[target].append({<span class="st">"n"</span>: source, <span class="st">"w"</span>: weight})</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>            source, target <span class="op">=</span> edge</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>            graph[source].append(target)</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>                graph[target].append(source)</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_graph_nodes(graph: Graph) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph: Graph) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dfs(node: <span class="bu">int</span>, visited: Set[<span class="bu">int</span>], stack: List[<span class="bu">int</span>]):</span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a>        visited.add(node)</span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[node]:</span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a>                dfs(neighbor, visited, stack)</span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a>        stack.append(node)</span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>    stack: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> get_graph_nodes(graph):</span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a>            dfs(node, visited, stack)</span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Graph) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> visit(node: <span class="bu">int</span>, visited: Set[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a>        visited.add(node)</span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> <span class="bu">set</span>(graph[node]) <span class="op">-</span> visited:</span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a>            visit(neighbor, visited)</span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> visited</span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visit(start_node, <span class="bu">set</span>())</span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph(graph: Graph) <span class="op">-&gt;</span> Graph:</span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb90-65"><a href="#cb90-65" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child].append(node)</span>
<span id="cb90-66"><a href="#cb90-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb90-67"><a href="#cb90-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-68"><a href="#cb90-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> strongly_connected_components(graph: Graph) <span class="op">-&gt;</span> Iterator[Set[<span class="bu">int</span>]]:</span>
<span id="cb90-69"><a href="#cb90-69" aria-hidden="true" tabindex="-1"></a>    order <span class="op">=</span> topological_sort(graph)</span>
<span id="cb90-70"><a href="#cb90-70" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb90-71"><a href="#cb90-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> order:</span>
<span id="cb90-72"><a href="#cb90-72" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> order.pop(<span class="dv">0</span>)</span>
<span id="cb90-73"><a href="#cb90-73" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(node, reversed_graph)</span>
<span id="cb90-74"><a href="#cb90-74" aria-hidden="true" tabindex="-1"></a>        order <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> order <span class="cf">if</span> x <span class="kw">not</span> <span class="kw">in</span> component]</span>
<span id="cb90-75"><a href="#cb90-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> key <span class="kw">in</span> reversed_graph.keys():</span>
<span id="cb90-76"><a href="#cb90-76" aria-hidden="true" tabindex="-1"></a>            reversed_graph[key] <span class="op">=</span> [n <span class="cf">for</span> n <span class="kw">in</span> reversed_graph[key] <span class="cf">if</span> n <span class="kw">not</span> <span class="kw">in</span> component]</span>
<span id="cb90-77"><a href="#cb90-77" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> component</span>
<span id="cb90-78"><a href="#cb90-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-79"><a href="#cb90-79" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb90-80"><a href="#cb90-80" aria-hidden="true" tabindex="-1"></a><span class="st">6 7</span></span>
<span id="cb90-81"><a href="#cb90-81" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb90-82"><a href="#cb90-82" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb90-83"><a href="#cb90-83" aria-hidden="true" tabindex="-1"></a><span class="st">2 4</span></span>
<span id="cb90-84"><a href="#cb90-84" aria-hidden="true" tabindex="-1"></a><span class="st">5 6</span></span>
<span id="cb90-85"><a href="#cb90-85" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb90-86"><a href="#cb90-86" aria-hidden="true" tabindex="-1"></a><span class="st">5 3</span></span>
<span id="cb90-87"><a href="#cb90-87" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb90-88"><a href="#cb90-88" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb90-89"><a href="#cb90-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-90"><a href="#cb90-90" aria-hidden="true" tabindex="-1"></a>input_iterator <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb90-91"><a href="#cb90-91" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> parse_graph(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb90-92"><a href="#cb90-92" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">len</span>(<span class="bu">list</span>(strongly_connected_components(graph))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="satisfiability" class="level1" data-number="31">
<h1 data-number="31"><span class="header-section-number">31</span> 2-Satisfiability</h1>
<p>In the 2SAT problem, you are given a set of&nbsp;<em>clauses</em>, where each clause is the dis-junction (OR) of two literals (a literal is a Boolean variable or the negation of a Boolean variable). You are looking for a way to assign a value&nbsp;true&nbsp;or&nbsp;false&nbsp;to each of the variables so that all clauses are satisfied&nbsp;— that is, there is at least one true literal in each clause. For example, here’s an instance of 2SAT:</p>
<p><span class="math display">\[(x1 \lor \bar x2 \land (\bar x1 \lor \bar x3) \land (x1 \lor x2) \land (\bar x3 \lor x4)\land(\bar x1 \lor x4).\]</span></p>
<p>This instance has a satisfying assignment: set&nbsp;x1,&nbsp;x2,&nbsp;x3, and&nbsp;x4&nbsp;to&nbsp;true,&nbsp;false,&nbsp;false, and&nbsp;true, respectively.</p>
<ol type="1">
<li>Are there other satisfying truth assignments of this 2SAT formula? If so, find them all.</li>
<li>Give an instance of 2SAT with four variables, and with no satisfying assignment.</li>
</ol>
<p>The purpose of this problem is to lead you to a way of solving 2SAT efficiently by reducing it to the problem of finding the&nbsp;<a href="https://rosalind.info/glossary/algo-strongly-connected-component/">strongly connected components</a>&nbsp;of a directed graph. Given an instance&nbsp;I&nbsp;of 2SAT with&nbsp;nn&nbsp;variables and&nbsp;mm&nbsp;clauses, construct a directed graph&nbsp;<span class="math inline">\(GI=(V,E)\)</span>&nbsp;as follows.</p>
<ul>
<li><span class="math inline">\(GI\)</span>&nbsp;has&nbsp;<span class="math inline">\(2n\)</span>&nbsp;nodes, one for each variable and its negation.</li>
<li><span class="math inline">\(GI\)</span>&nbsp;has&nbsp;<span class="math inline">\(2m\)</span>&nbsp;edges: for each clause&nbsp;(<span class="math inline">\(α∨β)\)</span>&nbsp;of&nbsp;I&nbsp;(where&nbsp;<span class="math inline">\(α,β\)</span>&nbsp;are literals),&nbsp;<span class="math inline">\(GI\)</span>&nbsp;has an edge from the negation of&nbsp;<span class="math inline">\(α\)</span>&nbsp;to&nbsp;<span class="math inline">\(β\)</span>, and one from the negation of&nbsp;<span class="math inline">\(β\)</span>&nbsp;to&nbsp;<span class="math inline">\(α\)</span>.</li>
</ul>
<p>Note that the clause&nbsp;<span class="math inline">\((α∨β)\)</span>&nbsp;is equivalent to either of the implications&nbsp; <span class="math inline">\(\bar α⇒β\)</span>&nbsp;or&nbsp;<span class="math inline">\(\bar β⇒α\)</span>. In this sense,&nbsp;<span class="math inline">\(GI\)</span>&nbsp;records all implications in&nbsp;I.</p>
<ol start="4" type="1">
<li>Carry out this construction for the instance of 2SAT given above, and for the instance you constructed in 2.</li>
<li>Show that if&nbsp;<span class="math inline">\(GI\)</span>&nbsp;has a strongly connected component containing both&nbsp;<span class="math inline">\(x\)</span>&nbsp;and&nbsp;<span class="math inline">\(\bar x\)</span>&nbsp;for some variable&nbsp;<span class="math inline">\(x\)</span>, then&nbsp;I&nbsp;has no satisfying assignment.</li>
<li>Now show the converse of 4: namely, that if none of&nbsp;<span class="math inline">\(GI\)</span>’s strongly connected components contain both a literal and its negation, then the instance&nbsp;I&nbsp;must be satisfiable. (Hint: Assign values to the variables as follows: repeatedly pick a sink strongly connected component of&nbsp;<span class="math inline">\(GI\)</span>. Assign value&nbsp;true&nbsp;to all literals in the sink, assign&nbsp;false&nbsp;to their negations, and delete all of these. Show that this ends up discovering a satisfying assignment.)</li>
<li>Conclude that there is a&nbsp;<a href="https://rosalind.info/glossary/algo-linear/">linear-time</a>&nbsp;algorithm for solving 2SAT.</li>
</ol>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<p>Given:&nbsp;A positive integer&nbsp;<span class="math inline">\(k≤20\)</span>&nbsp;and&nbsp;k&nbsp;2SAT formulas represented as follows. The first line gives the number of variables&nbsp;<span class="math inline">\(n≤10^3\)</span>&nbsp;and the number of clauses&nbsp;<span class="math inline">\(m≤10^4\)</span>, each of the following&nbsp;mm&nbsp;lines gives a clause of length&nbsp;2&nbsp;by specifying two different literals: e.g., a clause&nbsp;<span class="math inline">\((x3 ∨ \bar x5)\)</span> is given by&nbsp;<code>3 -5</code>.</p>
<p>Return:&nbsp;For each formula, output&nbsp;0&nbsp;if it cannot be satisfied or&nbsp;11&nbsp;followed by a satisfying assignment otherwise.</p>
<section id="sample-dataset-30" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="sample-dataset-30"><span class="header-section-number">31.1</span> Sample Dataset</h2>
<pre><code>2

2 4
1 2
-1 2
1 -2
-1 -2

3 4
1 2
2 3
-1 -2
-2 -3</code></pre>
</section>
<section id="sample-output-30" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="sample-output-30"><span class="header-section-number">31.2</span> Sample Output</h2>
<pre><code>0
1 1 -2 3</code></pre>
</section>
<section id="solution-29" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="solution-29"><span class="header-section-number">31.3</span> Solution</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line):</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, line.split()))</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> RecursionLimitManager:</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, new_limit):</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.new_limit <span class="op">=</span> new_limit</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__enter__</span>(<span class="va">self</span>):</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.old_limit <span class="op">=</span> sys.getrecursionlimit()</span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>        sys.setrecursionlimit(<span class="va">self</span>.new_limit)</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__exit__</span>(<span class="va">self</span>, exc_type, exc_value, traceback):</span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a>        sys.setrecursionlimit(<span class="va">self</span>.old_limit)</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph(original_graph):</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> original_graph:</span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> original_graph[node]:</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>            reversed_graph[neighbor].append(node)</span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_strongly_connected_components(graph):</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a>    node_order <span class="op">=</span> topological_sort(graph)</span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node_order:</span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> node_order.pop(<span class="dv">0</span>)</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(start_node, reversed_graph)</span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>        node_order <span class="op">=</span> [node <span class="cf">for</span> node <span class="kw">in</span> node_order <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> component]</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> key <span class="kw">in</span> reversed_graph.keys():</span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a>            reversed_graph[key] <span class="op">=</span> [node <span class="cf">for</span> node <span class="kw">in</span> reversed_graph[key] <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> component]</span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> component</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component_index(node, components):</span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, component <span class="kw">in</span> <span class="bu">enumerate</span>(components):</span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">in</span> component:</span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> index</span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> condense_graph(original_graph, components):</span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>    condensed_graph <span class="op">=</span> {}</span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, component <span class="kw">in</span> <span class="bu">enumerate</span>(components):</span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>        condensed_graph[index] <span class="op">=</span> <span class="bu">set</span>(</span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a>            [</span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a>                find_component_index(neighbor, components)</span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> node <span class="kw">in</span> component</span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> neighbor <span class="kw">in</span> original_graph[node]</span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> component</span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> condensed_graph</span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph):</span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> depth_first_search(node, visited_nodes, node_stack):</span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a>        visited_nodes[node] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[node]:</span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> visited_nodes[neighbor]:</span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a>                depth_first_search(neighbor, visited_nodes, node_stack)</span>
<span id="cb93-61"><a href="#cb93-61" aria-hidden="true" tabindex="-1"></a>        node_stack.append(node)</span>
<span id="cb93-62"><a href="#cb93-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-63"><a href="#cb93-63" aria-hidden="true" tabindex="-1"></a>    visited_nodes <span class="op">=</span> defaultdict(<span class="bu">bool</span>)</span>
<span id="cb93-64"><a href="#cb93-64" aria-hidden="true" tabindex="-1"></a>    node_stack <span class="op">=</span> []</span>
<span id="cb93-65"><a href="#cb93-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> get_graph_nodes(graph):</span>
<span id="cb93-66"><a href="#cb93-66" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> visited_nodes[node]:</span>
<span id="cb93-67"><a href="#cb93-67" aria-hidden="true" tabindex="-1"></a>            depth_first_search(node, visited_nodes, node_stack)</span>
<span id="cb93-68"><a href="#cb93-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-69"><a href="#cb93-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node_stack[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb93-70"><a href="#cb93-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-71"><a href="#cb93-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_2sat_instances(input_handle):</span>
<span id="cb93-72"><a href="#cb93-72" aria-hidden="true" tabindex="-1"></a>    instance_count <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(input_handle))</span>
<span id="cb93-73"><a href="#cb93-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(instance_count):</span>
<span id="cb93-74"><a href="#cb93-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> parse_2sat_instance(input_handle)</span>
<span id="cb93-75"><a href="#cb93-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-76"><a href="#cb93-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_2sat_instance(input_handle):</span>
<span id="cb93-77"><a href="#cb93-77" aria-hidden="true" tabindex="-1"></a>    info <span class="op">=</span> <span class="bu">next</span>(input_handle)</span>
<span id="cb93-78"><a href="#cb93-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> info <span class="op">==</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>:</span>
<span id="cb93-79"><a href="#cb93-79" aria-hidden="true" tabindex="-1"></a>        info <span class="op">=</span> <span class="bu">next</span>(input_handle)</span>
<span id="cb93-80"><a href="#cb93-80" aria-hidden="true" tabindex="-1"></a>    variable_count, clause_count <span class="op">=</span> parse_integers(info)</span>
<span id="cb93-81"><a href="#cb93-81" aria-hidden="true" tabindex="-1"></a>    clauses <span class="op">=</span> [<span class="bu">next</span>(input_handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(clause_count)]</span>
<span id="cb93-82"><a href="#cb93-82" aria-hidden="true" tabindex="-1"></a>    implication_graph <span class="op">=</span> {}</span>
<span id="cb93-83"><a href="#cb93-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-84"><a href="#cb93-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> variable <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, variable_count <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb93-85"><a href="#cb93-85" aria-hidden="true" tabindex="-1"></a>        implication_graph[variable] <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb93-86"><a href="#cb93-86" aria-hidden="true" tabindex="-1"></a>        implication_graph[<span class="op">-</span>variable] <span class="op">=</span> <span class="bu">list</span>()</span>
<span id="cb93-87"><a href="#cb93-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-88"><a href="#cb93-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> clause <span class="kw">in</span> clauses:</span>
<span id="cb93-89"><a href="#cb93-89" aria-hidden="true" tabindex="-1"></a>        literal1, literal2 <span class="op">=</span> parse_integers(clause)</span>
<span id="cb93-90"><a href="#cb93-90" aria-hidden="true" tabindex="-1"></a>        implication_graph[<span class="op">-</span>literal1].append(literal2)</span>
<span id="cb93-91"><a href="#cb93-91" aria-hidden="true" tabindex="-1"></a>        implication_graph[<span class="op">-</span>literal2].append(literal1)</span>
<span id="cb93-92"><a href="#cb93-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-93"><a href="#cb93-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> implication_graph</span>
<span id="cb93-94"><a href="#cb93-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-95"><a href="#cb93-95" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> solve_2sat(implication_graph):</span>
<span id="cb93-96"><a href="#cb93-96" aria-hidden="true" tabindex="-1"></a>    components <span class="op">=</span> <span class="bu">list</span>(find_strongly_connected_components(implication_graph))</span>
<span id="cb93-97"><a href="#cb93-97" aria-hidden="true" tabindex="-1"></a>    condensed_graph <span class="op">=</span> condense_graph(implication_graph, components)</span>
<span id="cb93-98"><a href="#cb93-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-99"><a href="#cb93-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component_index <span class="kw">in</span> topological_sort(condensed_graph):</span>
<span id="cb93-100"><a href="#cb93-100" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> literal <span class="kw">in</span> components[component_index]:</span>
<span id="cb93-101"><a href="#cb93-101" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">-</span>literal <span class="kw">in</span> components[component_index]:</span>
<span id="cb93-102"><a href="#cb93-102" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="dv">0</span>, []</span>
<span id="cb93-103"><a href="#cb93-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-104"><a href="#cb93-104" aria-hidden="true" tabindex="-1"></a>    assignment <span class="op">=</span> []</span>
<span id="cb93-105"><a href="#cb93-105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component_index <span class="kw">in</span> <span class="bu">reversed</span>(topological_sort(condensed_graph)):</span>
<span id="cb93-106"><a href="#cb93-106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> literal <span class="kw">in</span> components[component_index]:</span>
<span id="cb93-107"><a href="#cb93-107" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> literal <span class="kw">not</span> <span class="kw">in</span> assignment <span class="kw">and</span> <span class="op">-</span>literal <span class="kw">not</span> <span class="kw">in</span> assignment:</span>
<span id="cb93-108"><a href="#cb93-108" aria-hidden="true" tabindex="-1"></a>                assignment.append(literal)</span>
<span id="cb93-109"><a href="#cb93-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-110"><a href="#cb93-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">1</span>, <span class="bu">sorted</span>(assignment, key<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">abs</span>(x))</span>
<span id="cb93-111"><a href="#cb93-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-112"><a href="#cb93-112" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb93-113"><a href="#cb93-113" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb93-114"><a href="#cb93-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-115"><a href="#cb93-115" aria-hidden="true" tabindex="-1"></a><span class="st">2 4</span></span>
<span id="cb93-116"><a href="#cb93-116" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb93-117"><a href="#cb93-117" aria-hidden="true" tabindex="-1"></a><span class="st">-1 2</span></span>
<span id="cb93-118"><a href="#cb93-118" aria-hidden="true" tabindex="-1"></a><span class="st">1 -2</span></span>
<span id="cb93-119"><a href="#cb93-119" aria-hidden="true" tabindex="-1"></a><span class="st">-1 -2</span></span>
<span id="cb93-120"><a href="#cb93-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-121"><a href="#cb93-121" aria-hidden="true" tabindex="-1"></a><span class="st">3 4</span></span>
<span id="cb93-122"><a href="#cb93-122" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb93-123"><a href="#cb93-123" aria-hidden="true" tabindex="-1"></a><span class="st">2 3</span></span>
<span id="cb93-124"><a href="#cb93-124" aria-hidden="true" tabindex="-1"></a><span class="st">-1 -2</span></span>
<span id="cb93-125"><a href="#cb93-125" aria-hidden="true" tabindex="-1"></a><span class="st">-2 -3</span></span>
<span id="cb93-126"><a href="#cb93-126" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb93-127"><a href="#cb93-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-128"><a href="#cb93-128" aria-hidden="true" tabindex="-1"></a><span class="cf">with</span> RecursionLimitManager(<span class="dv">5000</span>):</span>
<span id="cb93-129"><a href="#cb93-129" aria-hidden="true" tabindex="-1"></a>    input_iterator <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb93-130"><a href="#cb93-130" aria-hidden="true" tabindex="-1"></a>    implication_graphs <span class="op">=</span> parse_2sat_instances(input_iterator)</span>
<span id="cb93-131"><a href="#cb93-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> implication_graph <span class="kw">in</span> implication_graphs:</span>
<span id="cb93-132"><a href="#cb93-132" aria-hidden="true" tabindex="-1"></a>        is_satisfiable, satisfying_assignment <span class="op">=</span> solve_2sat(implication_graph)</span>
<span id="cb93-133"><a href="#cb93-133" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(is_satisfiable, <span class="op">*</span>satisfying_assignment)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="general-sink" class="level1" data-number="32">
<h1 data-number="32"><span class="header-section-number">32</span> General Sink</h1>
<p>Given:&nbsp;A positive integer&nbsp;k≤20&nbsp;and&nbsp;k&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-graph/">simple directed graphs</a>&nbsp;with at most&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;vertices and&nbsp;<span class="math inline">\(2⋅10^3\)</span>&nbsp;edges each in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;For each graph, output a vertex from which all other vertices are reachable (if such a vertex exists) and”-1”otherwise.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<section id="sample-dataset-31" class="level2" data-number="32.1">
<h2 data-number="32.1" class="anchored" data-anchor-id="sample-dataset-31"><span class="header-section-number">32.1</span> Sample Dataset</h2>
<pre><code>2

3 2
3 2
2 1

3 2
3 2
1 2</code></pre>
</section>
<section id="sample-output-31" class="level2" data-number="32.2">
<h2 data-number="32.2" class="anchored" data-anchor-id="sample-output-31"><span class="header-section-number">32.2</span> Sample Output</h2>
<pre><code>3 -1</code></pre>
</section>
<section id="solution-30" class="level2" data-number="32.3">
<h2 data-number="32.3" class="anchored" data-anchor-id="solution-30"><span class="header-section-number">32.3</span> Solution</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union, Iterator</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]</span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(num) <span class="cf">for</span> num <span class="kw">in</span> line.split()]</span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_non_empty_line(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">next</span>(line.strip() <span class="cf">for</span> line <span class="kw">in</span> input_iterator <span class="cf">if</span> line.strip())</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_graph(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    node_count, edge_count <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> {node: [] <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, node_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> parse_integers(read_non_empty_line(input_iterator))</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>            source, target, weight <span class="op">=</span> edge</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>            graph[source].append({<span class="st">"n"</span>: target, <span class="st">"w"</span>: weight})</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>                graph[target].append({<span class="st">"n"</span>: source, <span class="st">"w"</span>: weight})</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a>            source, target <span class="op">=</span> edge</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>            graph[source].append(target)</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>                graph[target].append(source)</span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_multiple_graphs(input_iterator: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> List[Graph]:</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>    test_case_count <span class="op">=</span> <span class="bu">int</span>(read_non_empty_line(input_iterator))</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [parse_graph(input_iterator, is_directed, is_weighted) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(test_case_count)]</span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bfs(graph: Graph, start_node<span class="op">=</span><span class="dv">1</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>    node_count <span class="op">=</span> <span class="bu">len</span>(graph)</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [<span class="op">-</span><span class="dv">1</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(node_count <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a>    distances[start_node] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a>    queue <span class="op">=</span> [start_node]</span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> distances[neighbor] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a>                distances[neighbor] <span class="op">=</span> distances[current_node] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances[<span class="dv">1</span>:]</span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_good_start_node(graph: Graph) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a>        distances <span class="op">=</span> bfs(graph, node)</span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a>        all_nodes_reachable <span class="op">=</span> [distance <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">for</span> distance <span class="kw">in</span> distances]</span>
<span id="cb96-55"><a href="#cb96-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">all</span>(all_nodes_reachable):</span>
<span id="cb96-56"><a href="#cb96-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> node</span>
<span id="cb96-57"><a href="#cb96-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb96-58"><a href="#cb96-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-59"><a href="#cb96-59" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb96-60"><a href="#cb96-60" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb96-61"><a href="#cb96-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-62"><a href="#cb96-62" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb96-63"><a href="#cb96-63" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb96-64"><a href="#cb96-64" aria-hidden="true" tabindex="-1"></a><span class="st">2 1</span></span>
<span id="cb96-65"><a href="#cb96-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-66"><a href="#cb96-66" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb96-67"><a href="#cb96-67" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb96-68"><a href="#cb96-68" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb96-69"><a href="#cb96-69" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb96-70"><a href="#cb96-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-71"><a href="#cb96-71" aria-hidden="true" tabindex="-1"></a>input_iterator <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb96-72"><a href="#cb96-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-73"><a href="#cb96-73" aria-hidden="true" tabindex="-1"></a>graphs <span class="op">=</span> parse_multiple_graphs(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb96-74"><a href="#cb96-74" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[find_good_start_node(g) <span class="cf">for</span> g <span class="kw">in</span> graphs])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="semi-connected-graph" class="level1" data-number="33">
<h1 data-number="33"><span class="header-section-number">33</span> Semi-Connected Graph</h1>
<p>A directed graph is&nbsp;<em>semi-connected</em>&nbsp;if for all pairs of vertices&nbsp;i,j&nbsp;there is either a path from&nbsp;i&nbsp;to&nbsp;j&nbsp;or a path from j&nbsp;to&nbsp;i.</p>
<p>Given:&nbsp;A positive integer&nbsp;k≤20&nbsp;and&nbsp;k&nbsp;<a href="https://rosalind.info/glossary/algo-simple-directed-graph/">simple directed graphs</a>&nbsp;with at most&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;vertices each in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;For each graph, output”1”if the graph is semi-connected and”-1”otherwise.</p>
<section id="sample-dataset-32" class="level2" data-number="33.1">
<h2 data-number="33.1" class="anchored" data-anchor-id="sample-dataset-32"><span class="header-section-number">33.1</span> Sample Dataset</h2>
<pre><code>2

3 2
3 2
2 1

3 2
3 2
1 2</code></pre>
</section>
<section id="sample-output-32" class="level2" data-number="33.2">
<h2 data-number="33.2" class="anchored" data-anchor-id="sample-output-32"><span class="header-section-number">33.2</span> Sample Output</h2>
<pre><code>1 -1</code></pre>
</section>
<section id="solution-31" class="level2" data-number="33.3">
<h2 data-number="33.3" class="anchored" data-anchor-id="solution-31"><span class="header-section-number">33.3</span> Solution</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string):</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split()))</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_graph(input_stream, is_directed<span class="op">=</span><span class="va">False</span>, is_weighted<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a>            graph_info <span class="op">=</span> <span class="bu">next</span>(input_stream).strip()</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> graph_info:</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">StopIteration</span>:</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>        vertex_count, edge_count <span class="op">=</span> parse_integers(graph_info)</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a>    edge_list <span class="op">=</span> []</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count):</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span>:</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>            edge <span class="op">=</span> <span class="bu">next</span>(input_stream).strip()</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> edge:</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a>                edge_list.append(edge)</span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">except</span> <span class="pp">StopIteration</span>:</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> {v: [] <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vertex_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edge_list:</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>            source, target, weight <span class="op">=</span> parse_integers(edge)</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append({<span class="st">"vertex"</span>: target, <span class="st">"weight"</span>: weight})</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>                adjacency_list[target].append({<span class="st">"vertex"</span>: source, <span class="st">"weight"</span>: weight})</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a>            source, target <span class="op">=</span> parse_integers(edge)</span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append(target)</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>                adjacency_list[target].append(source)</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_multiple_graphs(input_stream, is_directed<span class="op">=</span><span class="va">False</span>, is_weighted<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>        graph_count <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(input_stream).strip())</span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> (<span class="pp">StopIteration</span>, <span class="pp">ValueError</span>):</span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>    graph_list <span class="op">=</span> []</span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(graph_count):</span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> create_graph(input_stream, is_directed<span class="op">=</span>is_directed, is_weighted<span class="op">=</span>is_weighted)</span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> graph <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a>            graph_list.append(graph)</span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb99-58"><a href="#cb99-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb99-59"><a href="#cb99-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph_list</span>
<span id="cb99-60"><a href="#cb99-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-61"><a href="#cb99-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph(graph):</span>
<span id="cb99-62"><a href="#cb99-62" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb99-63"><a href="#cb99-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vertex <span class="kw">in</span> graph:</span>
<span id="cb99-64"><a href="#cb99-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[vertex]:</span>
<span id="cb99-65"><a href="#cb99-65" aria-hidden="true" tabindex="-1"></a>            reversed_graph[neighbor].append(vertex)</span>
<span id="cb99-66"><a href="#cb99-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb99-67"><a href="#cb99-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-68"><a href="#cb99-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_vertices(graph):</span>
<span id="cb99-69"><a href="#cb99-69" aria-hidden="true" tabindex="-1"></a>    vertex_set <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb99-70"><a href="#cb99-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vertex, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb99-71"><a href="#cb99-71" aria-hidden="true" tabindex="-1"></a>        vertex_set.add(vertex)</span>
<span id="cb99-72"><a href="#cb99-72" aria-hidden="true" tabindex="-1"></a>        vertex_set.update(neighbors)</span>
<span id="cb99-73"><a href="#cb99-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vertex_set</span>
<span id="cb99-74"><a href="#cb99-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-75"><a href="#cb99-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph):</span>
<span id="cb99-76"><a href="#cb99-76" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dfs(vertex, visited, stack):</span>
<span id="cb99-77"><a href="#cb99-77" aria-hidden="true" tabindex="-1"></a>        visited[vertex] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb99-78"><a href="#cb99-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[vertex]:</span>
<span id="cb99-79"><a href="#cb99-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> visited[neighbor]:</span>
<span id="cb99-80"><a href="#cb99-80" aria-hidden="true" tabindex="-1"></a>                dfs(neighbor, visited, stack)</span>
<span id="cb99-81"><a href="#cb99-81" aria-hidden="true" tabindex="-1"></a>        stack.append(vertex)</span>
<span id="cb99-82"><a href="#cb99-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-83"><a href="#cb99-83" aria-hidden="true" tabindex="-1"></a>    visited <span class="op">=</span> defaultdict(<span class="bu">bool</span>)</span>
<span id="cb99-84"><a href="#cb99-84" aria-hidden="true" tabindex="-1"></a>    stack <span class="op">=</span> []</span>
<span id="cb99-85"><a href="#cb99-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vertex <span class="kw">in</span> get_all_vertices(graph):</span>
<span id="cb99-86"><a href="#cb99-86" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> visited[vertex]:</span>
<span id="cb99-87"><a href="#cb99-87" aria-hidden="true" tabindex="-1"></a>            dfs(vertex, visited, stack)</span>
<span id="cb99-88"><a href="#cb99-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-89"><a href="#cb99-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb99-90"><a href="#cb99-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-91"><a href="#cb99-91" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_connected_component(start_vertex, graph):</span>
<span id="cb99-92"><a href="#cb99-92" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> dfs(vertex, visited):</span>
<span id="cb99-93"><a href="#cb99-93" aria-hidden="true" tabindex="-1"></a>        visited.add(vertex)</span>
<span id="cb99-94"><a href="#cb99-94" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> <span class="bu">set</span>(graph[vertex]) <span class="op">-</span> visited:</span>
<span id="cb99-95"><a href="#cb99-95" aria-hidden="true" tabindex="-1"></a>            dfs(neighbor, visited)</span>
<span id="cb99-96"><a href="#cb99-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> visited</span>
<span id="cb99-97"><a href="#cb99-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-98"><a href="#cb99-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dfs(start_vertex, <span class="bu">set</span>())</span>
<span id="cb99-99"><a href="#cb99-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-100"><a href="#cb99-100" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> strongly_connected_components(graph):</span>
<span id="cb99-101"><a href="#cb99-101" aria-hidden="true" tabindex="-1"></a>    vertex_order <span class="op">=</span> topological_sort(graph)</span>
<span id="cb99-102"><a href="#cb99-102" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb99-103"><a href="#cb99-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> vertex_order:</span>
<span id="cb99-104"><a href="#cb99-104" aria-hidden="true" tabindex="-1"></a>        start_vertex <span class="op">=</span> vertex_order.pop(<span class="dv">0</span>)</span>
<span id="cb99-105"><a href="#cb99-105" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_connected_component(start_vertex, reversed_graph)</span>
<span id="cb99-106"><a href="#cb99-106" aria-hidden="true" tabindex="-1"></a>        vertex_order <span class="op">=</span> [v <span class="cf">for</span> v <span class="kw">in</span> vertex_order <span class="cf">if</span> v <span class="kw">not</span> <span class="kw">in</span> component]</span>
<span id="cb99-107"><a href="#cb99-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> vertex <span class="kw">in</span> reversed_graph.keys():</span>
<span id="cb99-108"><a href="#cb99-108" aria-hidden="true" tabindex="-1"></a>            reversed_graph[vertex] <span class="op">=</span> [v <span class="cf">for</span> v <span class="kw">in</span> reversed_graph[vertex] <span class="cf">if</span> v <span class="kw">not</span> <span class="kw">in</span> component]</span>
<span id="cb99-109"><a href="#cb99-109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> component</span>
<span id="cb99-110"><a href="#cb99-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-111"><a href="#cb99-111" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamiltonian_dag(graph):</span>
<span id="cb99-112"><a href="#cb99-112" aria-hidden="true" tabindex="-1"></a>    sorted_vertices <span class="op">=</span> topological_sort(graph)</span>
<span id="cb99-113"><a href="#cb99-113" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> v1, v2 <span class="kw">in</span> <span class="bu">zip</span>(sorted_vertices, sorted_vertices[<span class="dv">1</span>:]):</span>
<span id="cb99-114"><a href="#cb99-114" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> v2 <span class="kw">not</span> <span class="kw">in</span> graph[v1]:</span>
<span id="cb99-115"><a href="#cb99-115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb99-116"><a href="#cb99-116" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="dv">1</span>] <span class="op">+</span> sorted_vertices</span>
<span id="cb99-117"><a href="#cb99-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-118"><a href="#cb99-118" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component_index(vertex, components):</span>
<span id="cb99-119"><a href="#cb99-119" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index, component <span class="kw">in</span> <span class="bu">enumerate</span>(components):</span>
<span id="cb99-120"><a href="#cb99-120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> vertex <span class="kw">in</span> component:</span>
<span id="cb99-121"><a href="#cb99-121" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> index</span>
<span id="cb99-122"><a href="#cb99-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-123"><a href="#cb99-123" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> condense_graph(graph, components):</span>
<span id="cb99-124"><a href="#cb99-124" aria-hidden="true" tabindex="-1"></a>    condensed_graph <span class="op">=</span> {}</span>
<span id="cb99-125"><a href="#cb99-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, component <span class="kw">in</span> <span class="bu">enumerate</span>(components):</span>
<span id="cb99-126"><a href="#cb99-126" aria-hidden="true" tabindex="-1"></a>        condensed_graph[i] <span class="op">=</span> <span class="bu">set</span>(</span>
<span id="cb99-127"><a href="#cb99-127" aria-hidden="true" tabindex="-1"></a>            find_component_index(neighbor, components)</span>
<span id="cb99-128"><a href="#cb99-128" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> vertex <span class="kw">in</span> component</span>
<span id="cb99-129"><a href="#cb99-129" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> neighbor <span class="kw">in</span> graph[vertex]</span>
<span id="cb99-130"><a href="#cb99-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> component</span>
<span id="cb99-131"><a href="#cb99-131" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb99-132"><a href="#cb99-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> condensed_graph</span>
<span id="cb99-133"><a href="#cb99-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-134"><a href="#cb99-134" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_semi_connected(graph):</span>
<span id="cb99-135"><a href="#cb99-135" aria-hidden="true" tabindex="-1"></a>    components <span class="op">=</span> <span class="bu">list</span>(strongly_connected_components(graph))</span>
<span id="cb99-136"><a href="#cb99-136" aria-hidden="true" tabindex="-1"></a>    condensed_graph <span class="op">=</span> condense_graph(graph, components)</span>
<span id="cb99-137"><a href="#cb99-137" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span> <span class="cf">if</span> hamiltonian_dag(condensed_graph) <span class="op">==</span> [<span class="op">-</span><span class="dv">1</span>] <span class="cf">else</span> <span class="dv">1</span></span>
<span id="cb99-138"><a href="#cb99-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-139"><a href="#cb99-139" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb99-140"><a href="#cb99-140" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb99-141"><a href="#cb99-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-142"><a href="#cb99-142" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb99-143"><a href="#cb99-143" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb99-144"><a href="#cb99-144" aria-hidden="true" tabindex="-1"></a><span class="st">2 1</span></span>
<span id="cb99-145"><a href="#cb99-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-146"><a href="#cb99-146" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb99-147"><a href="#cb99-147" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb99-148"><a href="#cb99-148" aria-hidden="true" tabindex="-1"></a><span class="st">1 2</span></span>
<span id="cb99-149"><a href="#cb99-149" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb99-150"><a href="#cb99-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-151"><a href="#cb99-151" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb99-152"><a href="#cb99-152" aria-hidden="true" tabindex="-1"></a>input_iterator <span class="op">=</span> <span class="bu">iter</span>(input_lines)</span>
<span id="cb99-153"><a href="#cb99-153" aria-hidden="true" tabindex="-1"></a>graphs <span class="op">=</span> parse_multiple_graphs(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb99-154"><a href="#cb99-154" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[is_semi_connected(g) <span class="cf">for</span> g <span class="kw">in</span> graphs])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="shortest-paths-in-dag" class="level1" data-number="34">
<h1 data-number="34"><span class="header-section-number">34</span> Shortest Paths in DAG</h1>
<p>There are two subclasses of graphs that automatically exclude the possibility of negative cycles: graphs without negative edges, and graphs without cycles. We already know how to efficiently handle the former (see the problem&nbsp;<a href="https://rosalind.info/problems/nwc/">“Negative Weight Cycle”</a>). We will now see how the single-source shortest-path problem can be solved in just&nbsp;<a href="https://rosalind.info/glossary/algo-linear/">linear</a>&nbsp;time on&nbsp;<a href="https://rosalind.info/glossary/algo-directed-acyclic-graph/">directed acyclic graphs</a>.</p>
<p>As before, we need to perform a sequence of updates (recall&nbsp;<a href="https://rosalind.info/glossary/algo-bellman-ford-algorithm/">Bellman-Ford algorithm</a>) that includes every shortest path as a subsequence. The key source of efficiency is that</p>
<blockquote class="blockquote">
<p>In any path of a DAG, the vertices appear in increasing linearized order.</p>
</blockquote>
<p>Therefore, it is enough to&nbsp;<a href="https://rosalind.info/glossary/algo-topological-sorting/">linearize</a>&nbsp;(that is, topologically sort) the DAG by&nbsp;<a href="https://rosalind.info/glossary/algo-depth-first-search/">depth-first search</a>, and then visit the vertices in sorted order, updating the edges out of each. The algorithm is given below.</p>
<p>Notice that our scheme doesn’t require edges to be positive. In particular, we can find&nbsp;<em>longest paths</em>&nbsp;in a DAG by the same algorithm: just negate all edge lengths.</p>
<p>Source:&nbsp;<a href="https://rosalind.info/glossary/algo-algorithms-by-dasgupta-papadimitriou-vazirani-mcgraw-hill-2006/">Algorithms by Dasgupta, Papadimitriou, Vazirani. McGraw-Hill. 2006</a>.</p>
<p>Given:&nbsp;A weighted&nbsp;<a href="https://rosalind.info/glossary/algo-directed-acyclic-graph/">DAG</a>&nbsp;with integer edge weights from&nbsp;<span class="math inline">\(−10^3\)</span>&nbsp;to&nbsp;<span class="math inline">\(10^3\)</span>&nbsp;and&nbsp;<span class="math inline">\(n≤10^5\)</span>&nbsp;vertices in the&nbsp;<a href="https://rosalind.info/glossary/algo-edge-list-format/">edge list format</a>.</p>
<p>Return:&nbsp;An array&nbsp;D[1..n]&nbsp;where&nbsp;D[i]&nbsp;is the length of a shortest path from the vertex&nbsp;1&nbsp;to the vertex&nbsp;i&nbsp;(D[1]=0. If&nbsp;i&nbsp;is not reachable from&nbsp;1&nbsp;set&nbsp;D[i]&nbsp;to&nbsp;<code>x</code>.</p>
<section id="sample-dataset-33" class="level2" data-number="34.1">
<h2 data-number="34.1" class="anchored" data-anchor-id="sample-dataset-33"><span class="header-section-number">34.1</span> Sample Dataset</h2>
<pre><code>5 6
2 3 4
4 3 -2
1 4 1
1 5 -3
2 4 -2
5 4 1</code></pre>
</section>
<section id="sample-output-33" class="level2" data-number="34.2">
<h2 data-number="34.2" class="anchored" data-anchor-id="sample-output-33"><span class="header-section-number">34.2</span> Sample Output</h2>
<pre><code>0 x -4 -2 -3</code></pre>
</section>
<section id="solution-32" class="level2" data-number="34.3">
<h2 data-number="34.3" class="anchored" data-anchor-id="solution-32"><span class="header-section-number">34.3</span> Solution</h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Iterator, Union, Optional</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(line: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, line.split()))</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_graph(input_stream: Iterator[<span class="bu">str</span>], is_directed: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, is_weighted: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]:</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    graph_info <span class="op">=</span> <span class="bu">next</span>(input_stream)</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> graph_info <span class="op">==</span> <span class="st">"</span><span class="ch">\n</span><span class="st">"</span>:</span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a>        graph_info <span class="op">=</span> <span class="bu">next</span>(input_stream)</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a>    vertex_count, edge_count <span class="op">=</span> parse_integers(graph_info)</span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a>    edge_list <span class="op">=</span> [<span class="bu">next</span>(input_stream) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(edge_count)]</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]] <span class="op">=</span> {v: [] <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vertex_count <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edge_list:</span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> is_weighted:</span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a>            source, target, weight <span class="op">=</span> parse_integers(edge)</span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append({<span class="st">"vertex"</span>: target, <span class="st">"weight"</span>: weight})</span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a>                adjacency_list[target].append({<span class="st">"vertex"</span>: source, <span class="st">"weight"</span>: weight})</span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>            source, target <span class="op">=</span> parse_integers(edge)</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a>            adjacency_list[source].append(target)</span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> is_directed:</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a>                adjacency_list[target].append(source)</span>
<span id="cb102-28"><a href="#cb102-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-29"><a href="#cb102-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb102-30"><a href="#cb102-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-31"><a href="#cb102-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_vertices(graph: Dict[<span class="bu">int</span>, List[Union[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb102-32"><a href="#cb102-32" aria-hidden="true" tabindex="-1"></a>    vertex_set: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb102-33"><a href="#cb102-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vertex, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb102-34"><a href="#cb102-34" aria-hidden="true" tabindex="-1"></a>        vertex_set.add(vertex)</span>
<span id="cb102-35"><a href="#cb102-35" aria-hidden="true" tabindex="-1"></a>        vertex_set.update([n <span class="cf">if</span> <span class="bu">isinstance</span>(n, <span class="bu">int</span>) <span class="cf">else</span> n[<span class="st">"vertex"</span>] <span class="cf">for</span> n <span class="kw">in</span> neighbors])</span>
<span id="cb102-36"><a href="#cb102-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vertex_set</span>
<span id="cb102-37"><a href="#cb102-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-38"><a href="#cb102-38" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb102-39"><a href="#cb102-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> depth_first_search(vertex: <span class="bu">int</span>, visited: Dict[<span class="bu">int</span>, <span class="bu">bool</span>], stack: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb102-40"><a href="#cb102-40" aria-hidden="true" tabindex="-1"></a>        visited[vertex] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb102-41"><a href="#cb102-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[vertex]:</span>
<span id="cb102-42"><a href="#cb102-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> visited[neighbor]:</span>
<span id="cb102-43"><a href="#cb102-43" aria-hidden="true" tabindex="-1"></a>                depth_first_search(neighbor, visited, stack)</span>
<span id="cb102-44"><a href="#cb102-44" aria-hidden="true" tabindex="-1"></a>        stack.append(vertex)</span>
<span id="cb102-45"><a href="#cb102-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-46"><a href="#cb102-46" aria-hidden="true" tabindex="-1"></a>    visited: Dict[<span class="bu">int</span>, <span class="bu">bool</span>] <span class="op">=</span> defaultdict(<span class="bu">bool</span>)</span>
<span id="cb102-47"><a href="#cb102-47" aria-hidden="true" tabindex="-1"></a>    stack: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb102-48"><a href="#cb102-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vertex <span class="kw">in</span> get_all_vertices(graph):</span>
<span id="cb102-49"><a href="#cb102-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> visited[vertex]:</span>
<span id="cb102-50"><a href="#cb102-50" aria-hidden="true" tabindex="-1"></a>            depth_first_search(vertex, visited, stack)</span>
<span id="cb102-51"><a href="#cb102-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-52"><a href="#cb102-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb102-53"><a href="#cb102-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-54"><a href="#cb102-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplify_graph(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb102-55"><a href="#cb102-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {k: [x[<span class="st">"vertex"</span>] <span class="cf">for</span> x <span class="kw">in</span> v] <span class="cf">for</span> k, v <span class="kw">in</span> graph.items()}</span>
<span id="cb102-56"><a href="#cb102-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-57"><a href="#cb102-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> shortest_distances_acyclic_graph(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> List[Union[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb102-58"><a href="#cb102-58" aria-hidden="true" tabindex="-1"></a>    vertex_count <span class="op">=</span> <span class="bu">len</span>(graph)</span>
<span id="cb102-59"><a href="#cb102-59" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [inf <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(vertex_count <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb102-60"><a href="#cb102-60" aria-hidden="true" tabindex="-1"></a>    distances[<span class="dv">1</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb102-61"><a href="#cb102-61" aria-hidden="true" tabindex="-1"></a>    topological_order <span class="op">=</span> topological_sort(simplify_graph(graph))</span>
<span id="cb102-62"><a href="#cb102-62" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-63"><a href="#cb102-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_vertex <span class="kw">in</span> topological_order:</span>
<span id="cb102-64"><a href="#cb102-64" aria-hidden="true" tabindex="-1"></a>        seen_vertices <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb102-65"><a href="#cb102-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> <span class="bu">reversed</span>(graph[current_vertex]):</span>
<span id="cb102-66"><a href="#cb102-66" aria-hidden="true" tabindex="-1"></a>            neighbor <span class="op">=</span> edge[<span class="st">"vertex"</span>]</span>
<span id="cb102-67"><a href="#cb102-67" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> seen_vertices:</span>
<span id="cb102-68"><a href="#cb102-68" aria-hidden="true" tabindex="-1"></a>                seen_vertices.add(neighbor)</span>
<span id="cb102-69"><a href="#cb102-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> distances[current_vertex] <span class="op">+</span> edge[<span class="st">"weight"</span>] <span class="op">&lt;</span> distances[neighbor]:</span>
<span id="cb102-70"><a href="#cb102-70" aria-hidden="true" tabindex="-1"></a>                    distances[neighbor] <span class="op">=</span> distances[current_vertex] <span class="op">+</span> edge[<span class="st">"weight"</span>]</span>
<span id="cb102-71"><a href="#cb102-71" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb102-72"><a href="#cb102-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="st">"x"</span> <span class="cf">if</span> d <span class="op">==</span> inf <span class="cf">else</span> d <span class="cf">for</span> d <span class="kw">in</span> distances[<span class="dv">1</span>:]]</span>
<span id="cb102-73"><a href="#cb102-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-74"><a href="#cb102-74" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb102-75"><a href="#cb102-75" aria-hidden="true" tabindex="-1"></a><span class="st">5 6</span></span>
<span id="cb102-76"><a href="#cb102-76" aria-hidden="true" tabindex="-1"></a><span class="st">2 3 4</span></span>
<span id="cb102-77"><a href="#cb102-77" aria-hidden="true" tabindex="-1"></a><span class="st">4 3 -2</span></span>
<span id="cb102-78"><a href="#cb102-78" aria-hidden="true" tabindex="-1"></a><span class="st">1 4 1</span></span>
<span id="cb102-79"><a href="#cb102-79" aria-hidden="true" tabindex="-1"></a><span class="st">1 5 -3</span></span>
<span id="cb102-80"><a href="#cb102-80" aria-hidden="true" tabindex="-1"></a><span class="st">2 4 -2</span></span>
<span id="cb102-81"><a href="#cb102-81" aria-hidden="true" tabindex="-1"></a><span class="st">5 4 1</span></span>
<span id="cb102-82"><a href="#cb102-82" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb102-83"><a href="#cb102-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-84"><a href="#cb102-84" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb102-85"><a href="#cb102-85" aria-hidden="true" tabindex="-1"></a>input_iterator: Iterator[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">iter</span>(input_lines)</span>
<span id="cb102-86"><a href="#cb102-86" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> shortest_distances_acyclic_graph(create_graph(input_iterator, is_directed<span class="op">=</span><span class="va">True</span>, is_weighted<span class="op">=</span><span class="va">True</span>))</span>
<span id="cb102-87"><a href="#cb102-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tomorrow-lab\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
          // target, if specified
          link.setAttribute("target", "_blank");
          if (link.getAttribute("rel") === null) {
            link.setAttribute("rel", "noopener");
          }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="partrita/giscus" data-repo-id="R_kgDONvsa2g" data-category="General" data-category-id="DIC_kwDONvsa2s4CmWd7" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Proudly served by <a href="https://pages.github.com/">github pages</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This blog is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>