<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Taeyoon Kim">
<meta name="dcterms.date" content="2024-09-28">

<title>Rosalind Textbook track 문제풀이 – tomorrow-lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-31EWCYNR0V"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-31EWCYNR0V', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<meta name="google-site-verification" content="z2S1Xqj9hfJiC31aNGCnOA1gYpL_8MoZpPI2avrWMvg">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Rosalind Textbook track 문제풀이 – tomorrow-lab">
<meta property="og:description" content="The future of scientific discovery lies at the convergence of computational power and biological complexity. Our mission is to provide a platform where enthusiasts, researchers, and professionals can learn about and contribute to the rapidly evolving fields of bioinformatics, computational biology, and systems biology.">
<meta property="og:site_name" content="tomorrow-lab">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">tomorrow-lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../book.html"> 
<span class="menu-text">Book</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://partrita.github.io"> <i class="bi bi-sign-do-not-enter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/partrita"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/partrita"> <i class="bi bi-twitter-x" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div style="padding-bottom: 30px;">
    <script async="" src="https://eocampaign1.com/form/2616a818-1ef8-11ef-b372-4587d096212f.js" data-form="2616a818-1ef8-11ef-b372-4587d096212f"></script>
</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#compute-the-number-of-times-a-pattern-appears-in-a-text" id="toc-compute-the-number-of-times-a-pattern-appears-in-a-text" class="nav-link active" data-scroll-target="#compute-the-number-of-times-a-pattern-appears-in-a-text"><span class="header-section-number">0.1</span> Compute the Number of Times a Pattern Appears in a Text</a></li>
  <li><a href="#sample-dataset" id="toc-sample-dataset" class="nav-link" data-scroll-target="#sample-dataset"><span class="header-section-number">0.2</span> Sample Dataset</a></li>
  <li><a href="#sample-output" id="toc-sample-output" class="nav-link" data-scroll-target="#sample-output"><span class="header-section-number">0.3</span> Sample Output</a></li>
  <li><a href="#solution" id="toc-solution" class="nav-link" data-scroll-target="#solution"><span class="header-section-number">0.4</span> Solution</a></li>
  <li><a href="#find-the-most-frequent-words-in-a-string" id="toc-find-the-most-frequent-words-in-a-string" class="nav-link" data-scroll-target="#find-the-most-frequent-words-in-a-string"><span class="header-section-number">1</span> Find the Most Frequent Words in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-1" id="toc-sample-dataset-1" class="nav-link" data-scroll-target="#sample-dataset-1"><span class="header-section-number">1.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-1" id="toc-sample-output-1" class="nav-link" data-scroll-target="#sample-output-1"><span class="header-section-number">1.2</span> Sample Output</a></li>
  <li><a href="#solution-1" id="toc-solution-1" class="nav-link" data-scroll-target="#solution-1"><span class="header-section-number">1.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-reverse-complement-of-a-string" id="toc-find-the-reverse-complement-of-a-string" class="nav-link" data-scroll-target="#find-the-reverse-complement-of-a-string"><span class="header-section-number">2</span> Find the Reverse Complement of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-2" id="toc-sample-dataset-2" class="nav-link" data-scroll-target="#sample-dataset-2"><span class="header-section-number">2.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-2" id="toc-sample-output-2" class="nav-link" data-scroll-target="#sample-output-2"><span class="header-section-number">2.2</span> Sample Output</a></li>
  <li><a href="#solution-2" id="toc-solution-2" class="nav-link" data-scroll-target="#solution-2"><span class="header-section-number">2.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-occurrences-of-a-pattern-in-a-string" id="toc-find-all-occurrences-of-a-pattern-in-a-string" class="nav-link" data-scroll-target="#find-all-occurrences-of-a-pattern-in-a-string"><span class="header-section-number">3</span> Find All Occurrences of a Pattern in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-3" id="toc-sample-dataset-3" class="nav-link" data-scroll-target="#sample-dataset-3"><span class="header-section-number">3.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-3" id="toc-sample-output-3" class="nav-link" data-scroll-target="#sample-output-3"><span class="header-section-number">3.2</span> Sample Output</a></li>
  <li><a href="#solution-3" id="toc-solution-3" class="nav-link" data-scroll-target="#solution-3"><span class="header-section-number">3.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-patterns-forming-clumps-in-a-string" id="toc-find-patterns-forming-clumps-in-a-string" class="nav-link" data-scroll-target="#find-patterns-forming-clumps-in-a-string"><span class="header-section-number">4</span> Find Patterns Forming Clumps in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-4" id="toc-sample-dataset-4" class="nav-link" data-scroll-target="#sample-dataset-4"><span class="header-section-number">4.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-4" id="toc-sample-output-4" class="nav-link" data-scroll-target="#sample-output-4"><span class="header-section-number">4.2</span> Sample Output</a></li>
  <li><a href="#solution-4" id="toc-solution-4" class="nav-link" data-scroll-target="#solution-4"><span class="header-section-number">4.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-position-in-a-genome-minimizing-the-skew" id="toc-find-a-position-in-a-genome-minimizing-the-skew" class="nav-link" data-scroll-target="#find-a-position-in-a-genome-minimizing-the-skew"><span class="header-section-number">5</span> Find a Position in a Genome Minimizing the Skew</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-5" id="toc-sample-dataset-5" class="nav-link" data-scroll-target="#sample-dataset-5"><span class="header-section-number">5.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-5" id="toc-sample-output-5" class="nav-link" data-scroll-target="#sample-output-5"><span class="header-section-number">5.2</span> Sample Output</a></li>
  <li><a href="#solution-5" id="toc-solution-5" class="nav-link" data-scroll-target="#solution-5"><span class="header-section-number">5.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-hamming-distance-between-two-strings" id="toc-compute-the-hamming-distance-between-two-strings" class="nav-link" data-scroll-target="#compute-the-hamming-distance-between-two-strings"><span class="header-section-number">6</span> Compute the Hamming Distance Between Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-6" id="toc-sample-dataset-6" class="nav-link" data-scroll-target="#sample-dataset-6"><span class="header-section-number">6.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-6" id="toc-sample-output-6" class="nav-link" data-scroll-target="#sample-output-6"><span class="header-section-number">6.2</span> Sample Output</a></li>
  <li><a href="#solution-6" id="toc-solution-6" class="nav-link" data-scroll-target="#solution-6"><span class="header-section-number">6.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-approximate-occurrences-of-a-pattern-in-a-string" id="toc-find-all-approximate-occurrences-of-a-pattern-in-a-string" class="nav-link" data-scroll-target="#find-all-approximate-occurrences-of-a-pattern-in-a-string"><span class="header-section-number">7</span> Find All Approximate Occurrences of a Pattern in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-7" id="toc-sample-dataset-7" class="nav-link" data-scroll-target="#sample-dataset-7"><span class="header-section-number">7.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-7" id="toc-sample-output-7" class="nav-link" data-scroll-target="#sample-output-7"><span class="header-section-number">7.2</span> Sample Output</a></li>
  <li><a href="#solution-7" id="toc-solution-7" class="nav-link" data-scroll-target="#solution-7"><span class="header-section-number">7.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-most-frequent-words-with-mismatches-in-a-string" id="toc-find-the-most-frequent-words-with-mismatches-in-a-string" class="nav-link" data-scroll-target="#find-the-most-frequent-words-with-mismatches-in-a-string"><span class="header-section-number">8</span> Find the Most Frequent Words with Mismatches in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-8" id="toc-sample-dataset-8" class="nav-link" data-scroll-target="#sample-dataset-8"><span class="header-section-number">8.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-8" id="toc-sample-output-8" class="nav-link" data-scroll-target="#sample-output-8"><span class="header-section-number">8.2</span> Sample Output</a></li>
  <li><a href="#solution-8" id="toc-solution-8" class="nav-link" data-scroll-target="#solution-8"><span class="header-section-number">8.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-frequent-words-with-mismatches-and-reverse-complements" id="toc-find-frequent-words-with-mismatches-and-reverse-complements" class="nav-link" data-scroll-target="#find-frequent-words-with-mismatches-and-reverse-complements"><span class="header-section-number">9</span> Find Frequent Words with Mismatches and Reverse Complements</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-9" id="toc-sample-dataset-9" class="nav-link" data-scroll-target="#sample-dataset-9"><span class="header-section-number">9.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-9" id="toc-sample-output-9" class="nav-link" data-scroll-target="#sample-output-9"><span class="header-section-number">9.2</span> Sample Output</a></li>
  <li><a href="#solution-9" id="toc-solution-9" class="nav-link" data-scroll-target="#solution-9"><span class="header-section-number">9.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-frequency-array-of-a-string" id="toc-generate-the-frequency-array-of-a-string" class="nav-link" data-scroll-target="#generate-the-frequency-array-of-a-string"><span class="header-section-number">10</span> Generate the Frequency Array of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-10" id="toc-sample-dataset-10" class="nav-link" data-scroll-target="#sample-dataset-10"><span class="header-section-number">10.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-10" id="toc-sample-output-10" class="nav-link" data-scroll-target="#sample-output-10"><span class="header-section-number">10.2</span> Sample Output</a></li>
  <li><a href="#solution-10" id="toc-solution-10" class="nav-link" data-scroll-target="#solution-10"><span class="header-section-number">10.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-patterntonumber" id="toc-implement-patterntonumber" class="nav-link" data-scroll-target="#implement-patterntonumber"><span class="header-section-number">11</span> Implement PatternToNumber</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-11" id="toc-sample-dataset-11" class="nav-link" data-scroll-target="#sample-dataset-11"><span class="header-section-number">11.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-11" id="toc-sample-output-11" class="nav-link" data-scroll-target="#sample-output-11"><span class="header-section-number">11.2</span> Sample Output</a></li>
  <li><a href="#solution-11" id="toc-solution-11" class="nav-link" data-scroll-target="#solution-11"><span class="header-section-number">11.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-numbertopattern" id="toc-implement-numbertopattern" class="nav-link" data-scroll-target="#implement-numbertopattern"><span class="header-section-number">12</span> Implement NumberToPattern</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-12" id="toc-sample-dataset-12" class="nav-link" data-scroll-target="#sample-dataset-12"><span class="header-section-number">12.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-12" id="toc-sample-output-12" class="nav-link" data-scroll-target="#sample-output-12"><span class="header-section-number">12.2</span> Sample Output</a></li>
  <li><a href="#solution-12" id="toc-solution-12" class="nav-link" data-scroll-target="#solution-12"><span class="header-section-number">12.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-d-neighborhood-of-a-string" id="toc-generate-the-d-neighborhood-of-a-string" class="nav-link" data-scroll-target="#generate-the-d-neighborhood-of-a-string"><span class="header-section-number">13</span> Generate the d-Neighborhood of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-13" id="toc-sample-dataset-13" class="nav-link" data-scroll-target="#sample-dataset-13"><span class="header-section-number">13.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-13" id="toc-sample-output-13" class="nav-link" data-scroll-target="#sample-output-13"><span class="header-section-number">13.2</span> Sample Output</a></li>
  <li><a href="#solution-13" id="toc-solution-13" class="nav-link" data-scroll-target="#solution-13"><span class="header-section-number">13.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-hidden-path" id="toc-compute-the-probability-of-a-hidden-path" class="nav-link" data-scroll-target="#compute-the-probability-of-a-hidden-path"><span class="header-section-number">14</span> Compute the Probability of a Hidden Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-14" id="toc-sample-dataset-14" class="nav-link" data-scroll-target="#sample-dataset-14"><span class="header-section-number">14.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-14" id="toc-sample-output-14" class="nav-link" data-scroll-target="#sample-output-14"><span class="header-section-number">14.2</span> Sample Output</a></li>
  <li><a href="#solution-14" id="toc-solution-14" class="nav-link" data-scroll-target="#solution-14"><span class="header-section-number">14.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-an-outcome-given-a-hidden-path" id="toc-compute-the-probability-of-an-outcome-given-a-hidden-path" class="nav-link" data-scroll-target="#compute-the-probability-of-an-outcome-given-a-hidden-path"><span class="header-section-number">15</span> Compute the Probability of an Outcome Given a Hidden Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-15" id="toc-sample-dataset-15" class="nav-link" data-scroll-target="#sample-dataset-15"><span class="header-section-number">15.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-15" id="toc-sample-output-15" class="nav-link" data-scroll-target="#sample-output-15"><span class="header-section-number">15.2</span> Sample Output</a></li>
  <li><a href="#solution-15" id="toc-solution-15" class="nav-link" data-scroll-target="#solution-15"><span class="header-section-number">15.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-viterbi-algorithm" id="toc-implement-the-viterbi-algorithm" class="nav-link" data-scroll-target="#implement-the-viterbi-algorithm"><span class="header-section-number">16</span> Implement the Viterbi Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-16" id="toc-sample-dataset-16" class="nav-link" data-scroll-target="#sample-dataset-16"><span class="header-section-number">16.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-16" id="toc-sample-output-16" class="nav-link" data-scroll-target="#sample-output-16"><span class="header-section-number">16.2</span> Sample Output</a></li>
  <li><a href="#solution-16" id="toc-solution-16" class="nav-link" data-scroll-target="#solution-16"><span class="header-section-number">16.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-string-emitted-by-an-hmm" id="toc-compute-the-probability-of-a-string-emitted-by-an-hmm" class="nav-link" data-scroll-target="#compute-the-probability-of-a-string-emitted-by-an-hmm"><span class="header-section-number">17</span> Compute the Probability of a String Emitted by an HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-17" id="toc-sample-dataset-17" class="nav-link" data-scroll-target="#sample-dataset-17"><span class="header-section-number">17.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-17" id="toc-sample-output-17" class="nav-link" data-scroll-target="#sample-output-17"><span class="header-section-number">17.2</span> Sample Output</a></li>
  <li><a href="#solution-17" id="toc-solution-17" class="nav-link" data-scroll-target="#solution-17"><span class="header-section-number">17.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-profile-hmm" id="toc-construct-a-profile-hmm" class="nav-link" data-scroll-target="#construct-a-profile-hmm"><span class="header-section-number">18</span> Construct a Profile HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-18" id="toc-sample-dataset-18" class="nav-link" data-scroll-target="#sample-dataset-18"><span class="header-section-number">18.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-18" id="toc-sample-output-18" class="nav-link" data-scroll-target="#sample-output-18"><span class="header-section-number">18.2</span> Sample Output</a></li>
  <li><a href="#solution-18" id="toc-solution-18" class="nav-link" data-scroll-target="#solution-18"><span class="header-section-number">18.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-profile-hmm-with-pseudocounts" id="toc-construct-a-profile-hmm-with-pseudocounts" class="nav-link" data-scroll-target="#construct-a-profile-hmm-with-pseudocounts"><span class="header-section-number">19</span> Construct a Profile HMM with Pseudocounts</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-19" id="toc-sample-dataset-19" class="nav-link" data-scroll-target="#sample-dataset-19"><span class="header-section-number">19.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-19" id="toc-sample-output-19" class="nav-link" data-scroll-target="#sample-output-19"><span class="header-section-number">19.2</span> Sample Output</a></li>
  <li><a href="#solution-19" id="toc-solution-19" class="nav-link" data-scroll-target="#solution-19"><span class="header-section-number">19.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#perform-a-multiple-sequence-alignment-with-a-profile-hmm" id="toc-perform-a-multiple-sequence-alignment-with-a-profile-hmm" class="nav-link" data-scroll-target="#perform-a-multiple-sequence-alignment-with-a-profile-hmm"><span class="header-section-number">20</span> Perform a Multiple Sequence Alignment with a Profile HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-20" id="toc-sample-dataset-20" class="nav-link" data-scroll-target="#sample-dataset-20"><span class="header-section-number">20.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-20" id="toc-sample-output-20" class="nav-link" data-scroll-target="#sample-output-20"><span class="header-section-number">20.2</span> Sample Output</a></li>
  <li><a href="#solution-20" id="toc-solution-20" class="nav-link" data-scroll-target="#solution-20"><span class="header-section-number">20.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#estimate-the-parameters-of-an-hmm" id="toc-estimate-the-parameters-of-an-hmm" class="nav-link" data-scroll-target="#estimate-the-parameters-of-an-hmm"><span class="header-section-number">21</span> Estimate the Parameters of an HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-21" id="toc-sample-dataset-21" class="nav-link" data-scroll-target="#sample-dataset-21"><span class="header-section-number">21.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-21" id="toc-sample-output-21" class="nav-link" data-scroll-target="#sample-output-21"><span class="header-section-number">21.2</span> Sample Output</a></li>
  <li><a href="#solution-21" id="toc-solution-21" class="nav-link" data-scroll-target="#solution-21"><span class="header-section-number">21.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-viterbi-learning" id="toc-implement-viterbi-learning" class="nav-link" data-scroll-target="#implement-viterbi-learning"><span class="header-section-number">22</span> Implement Viterbi Learning</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-22" id="toc-sample-dataset-22" class="nav-link" data-scroll-target="#sample-dataset-22"><span class="header-section-number">22.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-22" id="toc-sample-output-22" class="nav-link" data-scroll-target="#sample-output-22"><span class="header-section-number">22.2</span> Sample Output</a></li>
  <li><a href="#solution-22" id="toc-solution-22" class="nav-link" data-scroll-target="#solution-22"><span class="header-section-number">22.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#solve-the-soft-decoding-problem" id="toc-solve-the-soft-decoding-problem" class="nav-link" data-scroll-target="#solve-the-soft-decoding-problem"><span class="header-section-number">23</span> Solve the Soft Decoding Problem</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-23" id="toc-sample-dataset-23" class="nav-link" data-scroll-target="#sample-dataset-23"><span class="header-section-number">23.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-23" id="toc-sample-output-23" class="nav-link" data-scroll-target="#sample-output-23"><span class="header-section-number">23.2</span> Sample Output</a></li>
  <li><a href="#solution-23" id="toc-solution-23" class="nav-link" data-scroll-target="#solution-23"><span class="header-section-number">23.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-baum-welch-learning" id="toc-implement-baum-welch-learning" class="nav-link" data-scroll-target="#implement-baum-welch-learning"><span class="header-section-number">24</span> Implement Baum-Welch Learning</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-24" id="toc-sample-dataset-24" class="nav-link" data-scroll-target="#sample-dataset-24"><span class="header-section-number">24.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-24" id="toc-sample-output-24" class="nav-link" data-scroll-target="#sample-output-24"><span class="header-section-number">24.2</span> Sample Output</a></li>
  <li><a href="#solution-24" id="toc-solution-24" class="nav-link" data-scroll-target="#solution-24"><span class="header-section-number">24.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-graph-of-a-spectrum" id="toc-construct-the-graph-of-a-spectrum" class="nav-link" data-scroll-target="#construct-the-graph-of-a-spectrum"><span class="header-section-number">25</span> Construct the Graph of a Spectrum</a>
  <ul class="collapse">
  <li><a href="#spectrum-graph-construction" id="toc-spectrum-graph-construction" class="nav-link" data-scroll-target="#spectrum-graph-construction"><span class="header-section-number">25.1</span> Spectrum Graph Construction</a></li>
  <li><a href="#sample-dataset-25" id="toc-sample-dataset-25" class="nav-link" data-scroll-target="#sample-dataset-25"><span class="header-section-number">25.2</span> Sample Dataset</a></li>
  <li><a href="#sample-output-25" id="toc-sample-output-25" class="nav-link" data-scroll-target="#sample-output-25"><span class="header-section-number">25.3</span> Sample Output</a></li>
  <li><a href="#solution-25" id="toc-solution-25" class="nav-link" data-scroll-target="#solution-25"><span class="header-section-number">25.4</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-motifenumeration" id="toc-implement-motifenumeration" class="nav-link" data-scroll-target="#implement-motifenumeration"><span class="header-section-number">26</span> Implement MotifEnumeration</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-26" id="toc-sample-dataset-26" class="nav-link" data-scroll-target="#sample-dataset-26"><span class="header-section-number">26.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-26" id="toc-sample-output-26" class="nav-link" data-scroll-target="#sample-output-26"><span class="header-section-number">26.2</span> Sample Output</a></li>
  <li><a href="#solution-26" id="toc-solution-26" class="nav-link" data-scroll-target="#solution-26"><span class="header-section-number">26.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-median-string" id="toc-find-a-median-string" class="nav-link" data-scroll-target="#find-a-median-string"><span class="header-section-number">27</span> Find a Median String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-27" id="toc-sample-dataset-27" class="nav-link" data-scroll-target="#sample-dataset-27"><span class="header-section-number">27.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-27" id="toc-sample-output-27" class="nav-link" data-scroll-target="#sample-output-27"><span class="header-section-number">27.2</span> Sample Output</a></li>
  <li><a href="#solution-27" id="toc-solution-27" class="nav-link" data-scroll-target="#solution-27"><span class="header-section-number">27.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-profile-most-probable-k-mer-in-a-string" id="toc-find-a-profile-most-probable-k-mer-in-a-string" class="nav-link" data-scroll-target="#find-a-profile-most-probable-k-mer-in-a-string"><span class="header-section-number">28</span> Find a Profile-most Probable k-mer in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-28" id="toc-sample-dataset-28" class="nav-link" data-scroll-target="#sample-dataset-28"><span class="header-section-number">28.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-28" id="toc-sample-output-28" class="nav-link" data-scroll-target="#sample-output-28"><span class="header-section-number">28.2</span> Sample Output</a></li>
  <li><a href="#solution-28" id="toc-solution-28" class="nav-link" data-scroll-target="#solution-28"><span class="header-section-number">28.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedymotifsearch" id="toc-implement-greedymotifsearch" class="nav-link" data-scroll-target="#implement-greedymotifsearch"><span class="header-section-number">29</span> Implement GreedyMotifSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-29" id="toc-sample-dataset-29" class="nav-link" data-scroll-target="#sample-dataset-29"><span class="header-section-number">29.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-29" id="toc-sample-output-29" class="nav-link" data-scroll-target="#sample-output-29"><span class="header-section-number">29.2</span> Sample Output</a></li>
  <li><a href="#solution-29" id="toc-solution-29" class="nav-link" data-scroll-target="#solution-29"><span class="header-section-number">29.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedymotifsearch-with-pseudocounts" id="toc-implement-greedymotifsearch-with-pseudocounts" class="nav-link" data-scroll-target="#implement-greedymotifsearch-with-pseudocounts"><span class="header-section-number">30</span> Implement GreedyMotifSearch with Pseudocounts</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-30" id="toc-sample-dataset-30" class="nav-link" data-scroll-target="#sample-dataset-30"><span class="header-section-number">30.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-30" id="toc-sample-output-30" class="nav-link" data-scroll-target="#sample-output-30"><span class="header-section-number">30.2</span> Sample Output</a></li>
  <li><a href="#solution-30" id="toc-solution-30" class="nav-link" data-scroll-target="#solution-30"><span class="header-section-number">30.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-randomizedmotifsearch" id="toc-implement-randomizedmotifsearch" class="nav-link" data-scroll-target="#implement-randomizedmotifsearch"><span class="header-section-number">31</span> Implement RandomizedMotifSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-31" id="toc-sample-dataset-31" class="nav-link" data-scroll-target="#sample-dataset-31"><span class="header-section-number">31.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-31" id="toc-sample-output-31" class="nav-link" data-scroll-target="#sample-output-31"><span class="header-section-number">31.2</span> Sample Output</a></li>
  <li><a href="#solution-31" id="toc-solution-31" class="nav-link" data-scroll-target="#solution-31"><span class="header-section-number">31.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-gibbssampler" id="toc-implement-gibbssampler" class="nav-link" data-scroll-target="#implement-gibbssampler"><span class="header-section-number">32</span> Implement GibbsSampler</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-32" id="toc-sample-dataset-32" class="nav-link" data-scroll-target="#sample-dataset-32"><span class="header-section-number">32.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-32" id="toc-sample-output-32" class="nav-link" data-scroll-target="#sample-output-32"><span class="header-section-number">32.2</span> Sample Output</a></li>
  <li><a href="#solution-32" id="toc-solution-32" class="nav-link" data-scroll-target="#solution-32"><span class="header-section-number">32.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-distancebetweenpatternandstrings" id="toc-implement-distancebetweenpatternandstrings" class="nav-link" data-scroll-target="#implement-distancebetweenpatternandstrings"><span class="header-section-number">33</span> Implement DistanceBetweenPatternAndStrings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-33" id="toc-sample-dataset-33" class="nav-link" data-scroll-target="#sample-dataset-33"><span class="header-section-number">33.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-33" id="toc-sample-output-33" class="nav-link" data-scroll-target="#sample-output-33"><span class="header-section-number">33.2</span> Sample Output</a></li>
  <li><a href="#solution-33" id="toc-solution-33" class="nav-link" data-scroll-target="#solution-33"><span class="header-section-number">33.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-k-mer-composition-of-a-string" id="toc-generate-the-k-mer-composition-of-a-string" class="nav-link" data-scroll-target="#generate-the-k-mer-composition-of-a-string"><span class="header-section-number">34</span> Generate the k-mer Composition of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-34" id="toc-sample-dataset-34" class="nav-link" data-scroll-target="#sample-dataset-34"><span class="header-section-number">34.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-34" id="toc-sample-output-34" class="nav-link" data-scroll-target="#sample-output-34"><span class="header-section-number">34.2</span> Sample Output</a></li>
  <li><a href="#solution-34" id="toc-solution-34" class="nav-link" data-scroll-target="#solution-34"><span class="header-section-number">34.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-genome-path" id="toc-reconstruct-a-string-from-its-genome-path" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-genome-path"><span class="header-section-number">35</span> Reconstruct a String from its Genome Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-35" id="toc-sample-dataset-35" class="nav-link" data-scroll-target="#sample-dataset-35"><span class="header-section-number">35.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-35" id="toc-sample-output-35" class="nav-link" data-scroll-target="#sample-output-35"><span class="header-section-number">35.2</span> Sample Output</a></li>
  <li><a href="#solution-35" id="toc-solution-35" class="nav-link" data-scroll-target="#solution-35"><span class="header-section-number">35.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-overlap-graph-of-a-collection-of-k-mers" id="toc-construct-the-overlap-graph-of-a-collection-of-k-mers" class="nav-link" data-scroll-target="#construct-the-overlap-graph-of-a-collection-of-k-mers"><span class="header-section-number">36</span> Construct the Overlap Graph of a Collection of k-mers</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-36" id="toc-sample-dataset-36" class="nav-link" data-scroll-target="#sample-dataset-36"><span class="header-section-number">36.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-36" id="toc-sample-output-36" class="nav-link" data-scroll-target="#sample-output-36"><span class="header-section-number">36.2</span> Sample Output</a></li>
  <li><a href="#solution-36" id="toc-solution-36" class="nav-link" data-scroll-target="#solution-36"><span class="header-section-number">36.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-de-bruijn-graph-of-a-string" id="toc-construct-the-de-bruijn-graph-of-a-string" class="nav-link" data-scroll-target="#construct-the-de-bruijn-graph-of-a-string"><span class="header-section-number">37</span> Construct the De Bruijn Graph of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-37" id="toc-sample-dataset-37" class="nav-link" data-scroll-target="#sample-dataset-37"><span class="header-section-number">37.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-37" id="toc-sample-output-37" class="nav-link" data-scroll-target="#sample-output-37"><span class="header-section-number">37.2</span> Sample Output</a></li>
  <li><a href="#solution-37" id="toc-solution-37" class="nav-link" data-scroll-target="#solution-37"><span class="header-section-number">37.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-de-bruijn-graph-of-a-collection-of-k-mers" id="toc-construct-the-de-bruijn-graph-of-a-collection-of-k-mers" class="nav-link" data-scroll-target="#construct-the-de-bruijn-graph-of-a-collection-of-k-mers"><span class="header-section-number">38</span> Construct the De Bruijn Graph of a Collection of k-mers</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-38" id="toc-sample-dataset-38" class="nav-link" data-scroll-target="#sample-dataset-38"><span class="header-section-number">38.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-38" id="toc-sample-output-38" class="nav-link" data-scroll-target="#sample-output-38"><span class="header-section-number">38.2</span> Sample Output</a></li>
  <li><a href="#solution-38" id="toc-solution-38" class="nav-link" data-scroll-target="#solution-38"><span class="header-section-number">38.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-an-eulerian-cycle-in-a-graph" id="toc-find-an-eulerian-cycle-in-a-graph" class="nav-link" data-scroll-target="#find-an-eulerian-cycle-in-a-graph"><span class="header-section-number">39</span> Find an Eulerian Cycle in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-39" id="toc-sample-dataset-39" class="nav-link" data-scroll-target="#sample-dataset-39"><span class="header-section-number">39.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-39" id="toc-sample-output-39" class="nav-link" data-scroll-target="#sample-output-39"><span class="header-section-number">39.2</span> Sample Output</a></li>
  <li><a href="#solution-39" id="toc-solution-39" class="nav-link" data-scroll-target="#solution-39"><span class="header-section-number">39.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-an-eulerian-path-in-a-graph" id="toc-find-an-eulerian-path-in-a-graph" class="nav-link" data-scroll-target="#find-an-eulerian-path-in-a-graph"><span class="header-section-number">40</span> Find an Eulerian Path in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-40" id="toc-sample-dataset-40" class="nav-link" data-scroll-target="#sample-dataset-40"><span class="header-section-number">40.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-40" id="toc-sample-output-40" class="nav-link" data-scroll-target="#sample-output-40"><span class="header-section-number">40.2</span> Sample Output</a></li>
  <li><a href="#solution-40" id="toc-solution-40" class="nav-link" data-scroll-target="#solution-40"><span class="header-section-number">40.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-k-mer-composition" id="toc-reconstruct-a-string-from-its-k-mer-composition" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-k-mer-composition"><span class="header-section-number">41</span> Reconstruct a String from its k-mer Composition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-41" id="toc-sample-dataset-41" class="nav-link" data-scroll-target="#sample-dataset-41"><span class="header-section-number">41.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-41" id="toc-sample-output-41" class="nav-link" data-scroll-target="#sample-output-41"><span class="header-section-number">41.2</span> Sample Output</a></li>
  <li><a href="#solution-41" id="toc-solution-41" class="nav-link" data-scroll-target="#solution-41"><span class="header-section-number">41.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-k-universal-circular-string" id="toc-find-a-k-universal-circular-string" class="nav-link" data-scroll-target="#find-a-k-universal-circular-string"><span class="header-section-number">42</span> Find a k-Universal Circular String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-42" id="toc-sample-dataset-42" class="nav-link" data-scroll-target="#sample-dataset-42"><span class="header-section-number">42.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-42" id="toc-sample-output-42" class="nav-link" data-scroll-target="#sample-output-42"><span class="header-section-number">42.2</span> Sample Output</a></li>
  <li><a href="#solution-42" id="toc-solution-42" class="nav-link" data-scroll-target="#solution-42"><span class="header-section-number">42.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-paired-composition" id="toc-reconstruct-a-string-from-its-paired-composition" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-paired-composition"><span class="header-section-number">43</span> Reconstruct a String from its Paired Composition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-43" id="toc-sample-dataset-43" class="nav-link" data-scroll-target="#sample-dataset-43"><span class="header-section-number">43.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-43" id="toc-sample-output-43" class="nav-link" data-scroll-target="#sample-output-43"><span class="header-section-number">43.2</span> Sample Output</a></li>
  <li><a href="#solution-43" id="toc-solution-43" class="nav-link" data-scroll-target="#solution-43"><span class="header-section-number">43.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-contigs-from-a-collection-of-reads" id="toc-generate-contigs-from-a-collection-of-reads" class="nav-link" data-scroll-target="#generate-contigs-from-a-collection-of-reads"><span class="header-section-number">44</span> Generate Contigs from a Collection of Reads</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-44" id="toc-sample-dataset-44" class="nav-link" data-scroll-target="#sample-dataset-44"><span class="header-section-number">44.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-44" id="toc-sample-output-44" class="nav-link" data-scroll-target="#sample-output-44"><span class="header-section-number">44.2</span> Sample Output</a></li>
  <li><a href="#solution-44" id="toc-solution-44" class="nav-link" data-scroll-target="#solution-44"><span class="header-section-number">44.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-string-spelled-by-a-gapped-genome-path" id="toc-construct-a-string-spelled-by-a-gapped-genome-path" class="nav-link" data-scroll-target="#construct-a-string-spelled-by-a-gapped-genome-path"><span class="header-section-number">45</span> Construct a String Spelled by a Gapped Genome Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-45" id="toc-sample-dataset-45" class="nav-link" data-scroll-target="#sample-dataset-45"><span class="header-section-number">45.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-45" id="toc-sample-output-45" class="nav-link" data-scroll-target="#sample-output-45"><span class="header-section-number">45.2</span> Sample Output</a></li>
  <li><a href="#solution-45" id="toc-solution-45" class="nav-link" data-scroll-target="#solution-45"><span class="header-section-number">45.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-all-maximal-non-branching-paths-in-a-graph" id="toc-generate-all-maximal-non-branching-paths-in-a-graph" class="nav-link" data-scroll-target="#generate-all-maximal-non-branching-paths-in-a-graph"><span class="header-section-number">46</span> Generate All Maximal Non-Branching Paths in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-46" id="toc-sample-dataset-46" class="nav-link" data-scroll-target="#sample-dataset-46"><span class="header-section-number">46.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-46" id="toc-sample-output-46" class="nav-link" data-scroll-target="#sample-output-46"><span class="header-section-number">46.2</span> Sample Output</a></li>
  <li><a href="#solution-46" id="toc-solution-46" class="nav-link" data-scroll-target="#solution-46"><span class="header-section-number">46.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#translate-an-rna-string-into-an-amino-acid-string" id="toc-translate-an-rna-string-into-an-amino-acid-string" class="nav-link" data-scroll-target="#translate-an-rna-string-into-an-amino-acid-string"><span class="header-section-number">47</span> Translate an RNA String into an Amino Acid String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-47" id="toc-sample-dataset-47" class="nav-link" data-scroll-target="#sample-dataset-47"><span class="header-section-number">47.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-47" id="toc-sample-output-47" class="nav-link" data-scroll-target="#sample-output-47"><span class="header-section-number">47.2</span> Sample Output</a></li>
  <li><a href="#solution-47" id="toc-solution-47" class="nav-link" data-scroll-target="#solution-47"><span class="header-section-number">47.3</span> Solution</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Rosalind Textbook track 문제풀이</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Rosalind</div>
    <div class="quarto-category">Bioinformatics</div>
    <div class="quarto-category">Tip</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Taeyoon Kim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 28, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">October 7, 2024</p>
    </div>
  </div>
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Rosalind_textbookTrack.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<p>Phillip Compeau 와 Pavel Pevzner 가 쓴 책 “<a href="https://www.bioinformaticsalgorithms.org/">능동적 접근 방식의 생물정보학 알고리즘</a>” 에서 제공되는 연습 문제 모음입니다.</p>
<p><a href="https://rosalind.info/">Rosalind</a> 는 <a href="http://projecteuler.net/">프로젝트 오일러</a>, <a href="http://code.google.com/codejam">구글 코드 잼</a> 에서 영감을 얻었습니다. 이 프로젝트의 이름은 DNA 이중나선을 발견하는 데 기여한 <a href="http://en.wikipedia.org/wiki/Rosalind_Franklin">로잘린드 프랭클린</a> 에서 따왔습니다. Rosalind 는 프로그래밍 실력을 키우고자 하는 생물학자와 분자생물학의 계산 문제를 접해본 적이 없는 프로그래머들에게 도움이 될 것입니다.</p>
<section id="compute-the-number-of-times-a-pattern-appears-in-a-text" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="compute-the-number-of-times-a-pattern-appears-in-a-text"><span class="header-section-number">0.1</span> Compute the Number of Times a Pattern Appears in a Text</h2>
<p>This is the first problem in a collection of “code challenges” to accompany&nbsp;<a href="http://bioinformaticsalgorithms.org/">Bioinformatics Algorithms: An Active-Learning Approach</a>&nbsp;by Phillip Compeau &amp; Pavel Pevzner.</p>
<p>A&nbsp;<a href="https://rosalind.info/glossary/k-mer/">k-mer</a>&nbsp;is a&nbsp;<a href="https://rosalind.info/glossary/string/">string</a>&nbsp;of length&nbsp;<em>k</em>. We define&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>) as the number of times that a&nbsp;<em>k</em>-mer&nbsp;<em>Pattern</em>&nbsp;appears as a&nbsp;<a href="https://rosalind.info/glossary/substring/">substring</a>&nbsp;of&nbsp;<em>Text</em>.</p>
<p>For example, We note that&nbsp;<span class="math inline">\(Count(CGATATATCCATAGCGATATATCCATAG,ATAATA)\)</span> is equal to 3 (not 2) since we should account for overlapping occurrences of&nbsp;<em>Pattern</em>&nbsp;in&nbsp;<em>Text</em>.</p>
<p>Given:&nbsp;{DNA strings}}&nbsp;<em>Text</em>&nbsp;and&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>).</p>
</section>
<section id="sample-dataset" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="sample-dataset"><span class="header-section-number">0.2</span> Sample Dataset</h2>
<pre><code>GCGCG
GCG</code></pre>
</section>
<section id="sample-output" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="sample-output"><span class="header-section-number">0.3</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="solution"><span class="header-section-number">0.4</span> Solution</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i:i <span class="op">+</span> size]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count how many times the pattern occurs in the text."""</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">GCGCG</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">GCG</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>text, pattern <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the count of pattern occurrences in text</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_pattern_occurrences(text, pattern))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="find-the-most-frequent-words-in-a-string" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Find the Most Frequent Words in a String</h1>
<p>We say that&nbsp;<em>Pattern</em>&nbsp;is a&nbsp;<strong>most frequent&nbsp;k-mer</strong>&nbsp;in&nbsp;<em>Text</em>&nbsp;if it maximizes&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>) among all&nbsp;<a href="https://rosalind.info/glossary/k-mer/">k-mers</a>. For example, “ACTAT” is a most frequent 5-mer in “ACAACTATGCATCACTATCGGGAACTATCCT”, and “ATA” is a most frequent 3-mer of “CGATATATCCATAG”.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;All most frequent&nbsp;<em>k</em>-mers in&nbsp;<em>Text</em>&nbsp;(in any order).</p>
<section id="sample-dataset-1" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sample-dataset-1"><span class="header-section-number">1.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4</code></pre>
</section>
<section id="sample-output-1" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sample-output-1"><span class="header-section-number">1.2</span> Sample Output</h2>
<pre><code>CATG GCAT</code></pre>
</section>
<section id="solution-1" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="solution-1"><span class="header-section-number">1.3</span> Solution</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count occurrences of each k-mer in the text."""</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(text, k):</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> most_frequent_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find the most frequent k-mers."""</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern size</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>text, k <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="bu">int</span>(k)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Find and print the most frequent k-mers</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> most_frequent_kmers(count_kmers(text, k))</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-reverse-complement-of-a-string" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Find the Reverse Complement of a String</h1>
<p>Find the reverse complement of a DNA string.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<span class="math inline">\(\overline{Pattern}\)</span>, the reverse complement of&nbsp;<em>Pattern</em>.</p>
<section id="sample-dataset-2" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sample-dataset-2"><span class="header-section-number">2.1</span> Sample Dataset</h2>
<pre><code>AAAACCCGGT</code></pre>
</section>
<section id="sample-output-2" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sample-output-2"><span class="header-section-number">2.2</span> Sample Output</h2>
<pre><code>ACCGGGTTTT</code></pre>
</section>
<section id="solution-2" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="solution-2"><span class="header-section-number">2.3</span> Solution</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Return the reverse complement of a DNA sequence."""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">AAAACCCGGT</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the reverse complement</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip().split()[<span class="dv">0</span>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reverse_complement(sequence))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-occurrences-of-a-pattern-in-a-string" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Find All Occurrences of a Pattern in a String</h1>
<p>Pattern Matching Problem, Find all occurrences of a pattern in a string.</p>
<p>Given:&nbsp;Strings&nbsp;<em>Pattern</em>&nbsp;and&nbsp;<em>Genome</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Genome</em>&nbsp;where&nbsp;<em>Pattern</em>&nbsp;appears as a substring. Use&nbsp;<a href="https://rosalind.info/glossary/0-based-numbering/">0-based indexing</a>.</p>
<section id="sample-dataset-3" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sample-dataset-3"><span class="header-section-number">3.1</span> Sample Dataset</h2>
<pre><code>ATAT
GATATATGCATATACTT</code></pre>
</section>
<section id="sample-output-3" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sample-output-3"><span class="header-section-number">3.2</span> Sample Output</h2>
<pre><code>1 3 9</code></pre>
</section>
<section id="solution-3" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="solution-3"><span class="header-section-number">3.3</span> Solution</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Generator</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_indices(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Yield starting indices where the pattern is found in the text."""</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, <span class="bu">len</span>(pattern))):</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> substring <span class="op">==</span> pattern:</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> i</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="st">ATAT</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="st">GATATATGCATATACTT</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into pattern and text</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>pattern, text <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print indices where the pattern is found</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_pattern_indices(text, pattern))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-patterns-forming-clumps-in-a-string" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Find Patterns Forming Clumps in a String</h1>
<p>Clump Finding Problem, Find patterns forming clumps in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Genome</em>, and integers&nbsp;<em>k</em>,&nbsp;<em>L</em>, and&nbsp;<em>t</em>.</p>
<p>Return:&nbsp;All distinct&nbsp;<em>k</em>-mers forming (<em>L</em>,&nbsp;<em>t</em>)-clumps in&nbsp;<em>Genome</em>.</p>
<section id="sample-dataset-4" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sample-dataset-4"><span class="header-section-number">4.1</span> Sample Dataset</h2>
<pre><code>CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC
5 75 4</code></pre>
</section>
<section id="sample-output-4" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sample-output-4"><span class="header-section-number">4.2</span> Sample Output</h2>
<pre><code>CGACA GAAGA AATGT</code></pre>
</section>
<section id="solution-4" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="solution-4"><span class="header-section-number">4.3</span> Solution</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions of k-length kmers within the text."""</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    kmer_positions <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, k)):</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        kmer_positions[substring].append(i)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_positions</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_clump(positions: List[<span class="bu">int</span>], L: <span class="bu">int</span>, t: <span class="bu">int</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if a given array of kmers at positions forms a clump of t within L."""</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(positions) <span class="op">-</span> t <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (positions[i <span class="op">+</span> t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> k <span class="op">-</span> positions[i]) <span class="op">&lt;=</span> L:</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="st">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="st">5 75 4</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into sequence and parameters</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>seq, params <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>k, L, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Find kmers and print those forming clumps</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>kmers <span class="op">=</span> find_kmers(seq, k)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>clumps <span class="op">=</span> [kmer <span class="cf">for</span> kmer <span class="kw">in</span> kmers <span class="cf">if</span> has_clump(kmers[kmer], L, t, k)]</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>clumps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-position-in-a-genome-minimizing-the-skew" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Find a Position in a Genome Minimizing the Skew</h1>
<p>Minimum Skew Problem, Find a position in a genome minimizing the skew.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Genome</em>.</p>
<p>Return:&nbsp;All integer(s)&nbsp;<em>i</em>&nbsp;minimizing&nbsp;<em>Skew</em>(_Prefix__i_&nbsp;(<em>Text</em>)) over all values of&nbsp;<em>i</em>&nbsp;(from 0 to |<em>Genome</em>|).</p>
<section id="sample-dataset-5" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sample-dataset-5"><span class="header-section-number">5.1</span> Sample Dataset</h2>
<pre><code>CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</code></pre>
</section>
<section id="sample-output-5" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sample-output-5"><span class="header-section-number">5.2</span> Sample Output</h2>
<pre><code>53 97</code></pre>
</section>
<section id="solution-5" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="solution-5"><span class="header-section-number">5.3</span> Solution</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minima(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions with the minimum skew in a DNA sequence."""</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> {<span class="st">"G"</span>: <span class="dv">1</span>, <span class="st">"C"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"T"</span>: <span class="dv">0</span>}</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(seq):</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        skew.append(skew[i] <span class="op">+</span> delta[nucleotide])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    min_skew <span class="op">=</span> <span class="bu">min</span>(skew)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (i <span class="cf">for</span> i, value <span class="kw">in</span> <span class="bu">enumerate</span>(skew) <span class="cf">if</span> value <span class="op">==</span> min_skew)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the positions with minimum skew</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_minima(sequence))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-hamming-distance-between-two-strings" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Compute the Hamming Distance Between Two Strings</h1>
<p>Hamming Distance Problem, Compute the Hamming distance between two DNA strings.</p>
<p>Given:&nbsp;Two DNA strings.</p>
<p>Return:&nbsp;An integer value representing the Hamming distance.</p>
<section id="sample-dataset-6" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sample-dataset-6"><span class="header-section-number">6.1</span> Sample Dataset</h2>
<pre><code>GGGCCGTTGGT
GGACCGTTGAC</code></pre>
</section>
<section id="sample-output-6" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sample-output-6"><span class="header-section-number">6.2</span> Sample Output</h2>
<pre><code>3</code></pre>
</section>
<section id="solution-6" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="solution-6"><span class="header-section-number">6.3</span> Solution</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> zip_longest</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> zip_longest(sequence1, sequence2, fillvalue<span class="op">=</span><span class="va">None</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_dna_sequences(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(input_string.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>Sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCCGTTGGT</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="st">GGACCGTTGAC</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>dna_sequence1, dna_sequence2 <span class="op">=</span> parse_dna_sequences(Sample_input)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>hamming_distance <span class="op">=</span> calculate_hamming_distance(dna_sequence1, dna_sequence2)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hamming_distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-approximate-occurrences-of-a-pattern-in-a-string" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Find All Approximate Occurrences of a Pattern in a String</h1>
<p>Approximate Pattern Matching Problem, Find all approximate occurrences of a pattern in a string.</p>
<p>Given:&nbsp;Strings&nbsp;<em>Pattern</em>&nbsp;and&nbsp;<em>Text</em>&nbsp;along with an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All starting positions where&nbsp;<em>Pattern</em>&nbsp;appears as a substring of&nbsp;<em>Text</em>&nbsp;with at most&nbsp;<em>d</em>&nbsp;mismatches.</p>
<section id="sample-dataset-7" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="sample-dataset-7"><span class="header-section-number">7.1</span> Sample Dataset</h2>
<pre><code>ATTCTGGA
CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC
3</code></pre>
</section>
<section id="sample-output-7" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sample-output-7"><span class="header-section-number">7.2</span> Sample Output</h2>
<pre><code>6 7 26 27 78</code></pre>
</section>
<section id="solution-7" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="solution-7"><span class="header-section-number">7.3</span> Solution</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_approximate_matches(pattern: <span class="bu">str</span>, genome: <span class="bu">str</span>, max_mismatch: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    pattern_length <span class="op">=</span> <span class="bu">len</span>(pattern)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (position <span class="cf">for</span> position, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(genome, pattern_length))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_mismatch)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    pattern, genome, max_mismatch_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pattern, genome, <span class="bu">int</span>(max_mismatch_str)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">ATTCTGGA</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>pattern, genome, max_mismatch <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>match_positions <span class="op">=</span> <span class="bu">list</span>(find_approximate_matches(pattern, genome, max_mismatch))</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>match_positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-most-frequent-words-with-mismatches-in-a-string" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Find the Most Frequent Words with Mismatches in a String</h1>
<p>Frequent Words with Mismatches Problem, Find the most frequent k-mers with mismatches in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;as well as integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All most frequent&nbsp;<em>k</em>-mers with up to&nbsp;<em>d</em>&nbsp;mismatches in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-8" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sample-dataset-8"><span class="header-section-number">8.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4 1</code></pre>
</section>
<section id="sample-output-8" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="sample-output-8"><span class="header-section-number">8.2</span> Sample Output</h2>
<pre><code>ATGC ATGT GATG</code></pre>
</section>
<section id="solution-8" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="solution-8"><span class="header-section-number">8.3</span> Solution</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna_sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna_sequence, kmer_length):</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(observed_kmers: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(observed_kmers[observed_kmer] </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> observed_kmer <span class="kw">in</span> observed_kmers </span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>observed_kmers <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(observed_kmers, max_mismatches, kmer_length))</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>most_frequent_kmers <span class="op">=</span> find_most_frequent(approximate_kmer_counts)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent_kmers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-frequent-words-with-mismatches-and-reverse-complements" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Find Frequent Words with Mismatches and Reverse Complements</h1>
<p>Frequent Words with Mismatches and Reverse Complements Problem. Find the most frequent k-mers (with mismatches and reverse complements) in a DNA string.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Text</em>&nbsp;as well as integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All&nbsp;<em>k</em>-mers&nbsp;<em>Pattern</em>&nbsp;maximizing the sum&nbsp;_Count__d_(<em>Text</em>,&nbsp;<span class="math inline">\(Pattern\)</span>) +&nbsp;_Count__d_(<em>Text</em>,&nbsp;<span class="math inline">\(\overline{Pattern}\)</span>}) over all possible&nbsp;<em>k</em>-mers.</p>
<section id="sample-dataset-9" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="sample-dataset-9"><span class="header-section-number">9.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4 1</code></pre>
</section>
<section id="sample-output-9" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sample-output-9"><span class="header-section-number">9.2</span> Sample Output</h2>
<pre><code>ATGT ACAT</code></pre>
</section>
<section id="solution-9" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="solution-9"><span class="header-section-number">9.3</span> Solution</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna: <span class="bu">str</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna[i:i <span class="op">+</span> length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna) <span class="op">-</span> length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna, kmer_length):</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> hamming_distance(reverse_complement(potential_kmer), observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>kmer_counts <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(kmer_counts, max_mismatches, kmer_length))</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_most_frequent(approximate_kmer_counts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-frequency-array-of-a-string" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Generate the Frequency Array of a String</h1>
<p>Computing a Frequency Array, Generate the frequency array of a DNA string.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;The frequency array of&nbsp;<em>k</em>-mers in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-10" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="sample-dataset-10"><span class="header-section-number">10.1</span> Sample Dataset</h2>
<pre><code>ACGCGGCTCTGAAA
2</code></pre>
</section>
<section id="sample-output-10" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="sample-output-10"><span class="header-section-number">10.2</span> Sample Output</h2>
<pre><code>2 1 0 0 0 0 2 2 1 2 1 0 0 1 1 0</code></pre>
</section>
<section id="solution-10" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="solution-10"><span class="header-section-number">10.3</span> Solution</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict, Tuple</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (text[i : i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(s1: <span class="bu">str</span>, s2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(s1, s2))</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(k: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>k))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_frequencies(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_pattern_occurrences(sequence, kmer) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length)]</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    sequence, kmer_length <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(kmer_length)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="st">ACGCGGCTCTGAAA</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>sequence, kmer_length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>kmer_frequencies <span class="op">=</span> calculate_kmer_frequencies(sequence, kmer_length)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>kmer_frequencies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-patterntonumber" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Implement PatternToNumber</h1>
<p>Implement PatternToNumber, Convert a DNA string to a number.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<em>PatternToNumber</em>(<em>Pattern</em>).</p>
<section id="sample-dataset-11" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sample-dataset-11"><span class="header-section-number">11.1</span> Sample Dataset</h2>
<pre><code>AGT</code></pre>
</section>
<section id="sample-output-11" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sample-output-11"><span class="header-section-number">11.2</span> Sample Output</h2>
<pre><code>11</code></pre>
</section>
<section id="solution-11" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="solution-11"><span class="header-section-number">11.3</span> Solution</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_nucleotide_to_number_map() <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_nucleotide_to_number(nucleotide: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotide_map[nucleotide]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_dna_pattern_to_number(dna_pattern: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> dna_pattern:</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> convert_dna_pattern_to_number(dna_pattern[:<span class="op">-</span><span class="dv">1</span>], nucleotide_map) <span class="op">+</span> convert_nucleotide_to_number(dna_pattern[<span class="op">-</span><span class="dv">1</span>], nucleotide_map)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_data.strip()</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="st">AGT</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>nucleotide_map <span class="op">=</span> create_nucleotide_to_number_map()</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> convert_dna_pattern_to_number(dna_pattern, nucleotide_map)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-numbertopattern" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Implement NumberToPattern</h1>
<p>Implement NumberToPattern, Convert an integer to its corresponding DNA string.</p>
<p>Given:&nbsp;Integers&nbsp;<em>index</em>&nbsp;and&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;<em>NumberToPattern</em>(<em>index</em>,&nbsp;<em>k</em>).</p>
<section id="sample-dataset-12" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="sample-dataset-12"><span class="header-section-number">12.1</span> Sample Dataset</h2>
<pre><code>45
4</code></pre>
</section>
<section id="sample-output-12" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="sample-output-12"><span class="header-section-number">12.2</span> Sample Output</h2>
<pre><code>AGTC</code></pre>
</section>
<section id="solution-12" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="solution-12"><span class="header-section-number">12.3</span> Solution</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_nucleotide(index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotides[index]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_dna_pattern(index: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> length <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> number_to_nucleotide(index)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    quotient, remainder <span class="op">=</span> <span class="bu">divmod</span>(index, <span class="dv">4</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> number_to_dna_pattern(quotient, length <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> number_to_nucleotide(remainder)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    index_str, length_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(index_str), <span class="bu">int</span>(length_str)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="st">45</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>index, length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> number_to_dna_pattern(index, length)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dna_pattern)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-d-neighborhood-of-a-string" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Generate the d-Neighborhood of a String</h1>
<p>Generate the d-Neighborhood of a String Find all the neighbors of a pattern.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>&nbsp;and an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;The collection of strings&nbsp;<em>Neighbors</em>(<em>Pattern</em>,&nbsp;<em>d</em>).</p>
<section id="sample-dataset-13" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="sample-dataset-13"><span class="header-section-number">13.1</span> Sample Dataset</h2>
<pre><code>ACG
1</code></pre>
</section>
<section id="sample-output-13" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sample-output-13"><span class="header-section-number">13.2</span> Sample Output</h2>
<pre><code>CCG
TCG
GCG
AAG
ATG
AGG
ACA
ACC
ACT
ACG</code></pre>
</section>
<section id="solution-13" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="solution-13"><span class="header-section-number">13.3</span> Solution</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Set, List, Tuple, Iterator</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_immediate_neighbors(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, current_base <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> new_base <span class="kw">in</span> nucleotides:</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> new_base <span class="op">!=</span> current_base:</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence[:i] <span class="op">+</span> new_base <span class="op">+</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:]</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    suffix_neighbors <span class="op">=</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> suffix <span class="kw">in</span> suffix_neighbors:</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], suffix) <span class="op">&lt;</span> max_distance:</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>            neighbors.update(base <span class="op">+</span> suffix <span class="cf">for</span> base <span class="kw">in</span> nucleotides)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>            neighbors.add(sequence[<span class="dv">0</span>] <span class="op">+</span> suffix)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbors</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    sequence, distance <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(distance)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="st">ACG</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>sequence, max_distance <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>neighbor_sequences <span class="op">=</span> generate_neighbors(sequence, max_distance)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(neighbor_sequences), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<hr>
</section>
</section>
<section id="compute-the-probability-of-a-hidden-path" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Compute the Probability of a Hidden Path</h1>
<p>Given:&nbsp;A hidden path <span class="math inline">\(π\)</span> followed by the states&nbsp;<em>States</em>&nbsp;and transition matrix&nbsp;<em>Transition</em>&nbsp;of an HMM (<span class="math inline">\(Σ\)</span>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability of this path, <span class="math inline">\(Pr(π)\)</span>. You may assume that initial probabilities are equal.</p>
<section id="sample-dataset-14" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="sample-dataset-14"><span class="header-section-number">14.1</span> Sample Dataset</h2>
<pre><code>AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB
--------
A   B
--------
    A   B
A   0.194   0.806
B   0.273   0.727</code></pre>
</section>
<section id="sample-output-14" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="sample-output-14"><span class="header-section-number">14.2</span> Sample Output</h2>
<pre><code>5.01732865318e-19</code></pre>
</section>
<section id="solution-14" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="solution-14"><span class="header-section-number">14.3</span> Solution</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hidden_path_data(input_lines):</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>    transition_probabilities <span class="op">=</span> {}</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>            current_state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> next_state, probability <span class="kw">in</span> <span class="bu">zip</span>(states, row_data[<span class="dv">1</span>:]):</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                transition_probabilities[(current_state, next_state)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hidden_path, transition_probabilities</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hidden_path_probability(hidden_path, transition_probabilities):</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    initial_probability <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    path_probability <span class="op">=</span> initial_probability <span class="op">*</span> prod(</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        transition_probabilities[state_pair] </span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> state_pair <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, hidden_path[<span class="dv">1</span>:])</span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_probability</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.194   0.806</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.273   0.727</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a>hidden_path, transition_probabilities <span class="op">=</span> parse_hidden_path_data(input_lines)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_hidden_path_probability(hidden_path, transition_probabilities)</span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-an-outcome-given-a-hidden-path" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Compute the Probability of an Outcome Given a Hidden Path</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by a hidden path&nbsp;<em>π</em>, followed by the states&nbsp;<em>States</em>&nbsp;and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The conditional probability <span class="math inline">\(Pr(x|π)\)</span> that string&nbsp;<em>x</em>&nbsp;will be emitted by the HMM given the hidden path&nbsp;<em>π</em>.</p>
<section id="sample-dataset-15" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="sample-dataset-15"><span class="header-section-number">15.1</span> Sample Dataset</h2>
<pre><code>xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx
--------
x   y   z
--------
BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB
--------
A   B
--------
    x   y   z
A   0.612   0.314   0.074 
B   0.346   0.317   0.336</code></pre>
</section>
<section id="sample-output-15" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="sample-output-15"><span class="header-section-number">15.2</span> Sample Output</h2>
<pre><code>1.93157070893e-28</code></pre>
</section>
<section id="solution-15" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="solution-15"><span class="header-section-number">15.3</span> Solution</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_emission_data(input_lines):</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    emission_sequence <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a>    emission_probabilities <span class="op">=</span> {}</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> symbol, probability <span class="kw">in</span> <span class="bu">zip</span>(symbols, row_data[<span class="dv">1</span>:]):</span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a>                emission_probabilities[(state, symbol)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emission_sequence, hidden_path, emission_probabilities</span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities):</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prod(emission_probabilities[state_symbol] <span class="cf">for</span> state_symbol <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, emission_sequence))</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a><span class="st">xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span></span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a><span class="st">x y z</span></span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="st">BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.612   0.314   0.074 </span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.346   0.317   0.336</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>emission_sequence, hidden_path, emission_probabilities <span class="op">=</span> parse_emission_data(input_lines)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities)</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-viterbi-algorithm" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Implement the Viterbi Algorithm</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;A path that maximizes the (unconditional) probability Pr(<em>x</em>,&nbsp;<em>π</em>) over all possible paths&nbsp;<em>π</em>.</p>
<section id="sample-dataset-16" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="sample-dataset-16"><span class="header-section-number">16.1</span> Sample Dataset</h2>
<pre><code>xyxzzxyxyy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.641   0.359
B   0.729   0.271
--------
    x   y   z
A   0.117   0.691   0.192   
B   0.097   0.42    0.483</code></pre>
</section>
<section id="sample-output-16" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="sample-output-16"><span class="header-section-number">16.2</span> Sample Output</h2>
<pre><code>AAABBAAAAA</code></pre>
</section>
<section id="solution-16" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="solution-16"><span class="header-section-number">16.3</span> Solution</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> <span class="bu">len</span>(states)</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>    sequence_length <span class="op">=</span> <span class="bu">len</span>(sequence)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a>    viterbi_matrix <span class="op">=</span> np.zeros((sequence_length, num_states))</span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a>    backpointer <span class="op">=</span> np.zeros((sequence_length, num_states), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the first column of the viterbi matrix</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a>        viterbi_matrix[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> num_states)</span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill in the rest of the viterbi matrix</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, sequence_length):</span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> [</span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[previous_state, current_state]) <span class="op">+</span> </span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a>                log(emission_matrix[current_state, sequence[t]]) <span class="op">+</span> </span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a>                viterbi_matrix[t<span class="op">-</span><span class="dv">1</span>, k]</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a>            max_prob_index <span class="op">=</span> probabilities.index(<span class="bu">max</span>(probabilities))</span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a>            backpointer[t, j] <span class="op">=</span> max_prob_index</span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a>            viterbi_matrix[t, j] <span class="op">=</span> <span class="bu">max</span>(probabilities)</span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a>    best_path_index <span class="op">=</span> np.argmax(viterbi_matrix[<span class="op">-</span><span class="dv">1</span>, :])</span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a>    best_path <span class="op">=</span> states[best_path_index]</span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(sequence_length <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a>        best_path_index <span class="op">=</span> backpointer[t, best_path_index]</span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a>        best_path <span class="op">=</span> states[best_path_index] <span class="op">+</span> best_path</span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_path</span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="st">xyxzzxyxyy</span></span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.641   0.359</span></span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.729   0.271</span></span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.117   0.691   0.192   </span></span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.097   0.42    0.483</span></span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb51-81"><a href="#cb51-81" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb51-82"><a href="#cb51-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-a-string-emitted-by-an-hmm" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Compute the Probability of a String Emitted by an HMM</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability Pr(<em>x</em>) that the HMM emits&nbsp;<em>x</em>.</p>
<section id="sample-dataset-17" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="sample-dataset-17"><span class="header-section-number">17.1</span> Sample Dataset</h2>
<pre><code>xzyyzzyzyy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.303   0.697 
B   0.831   0.169 
--------
    x   y   z
A   0.533   0.065   0.402 
B   0.342   0.334   0.324</code></pre>
</section>
<section id="sample-output-17" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="sample-output-17"><span class="header-section-number">17.2</span> Sample Output</h2>
<pre><code>1.1005510319694847e-06</code></pre>
</section>
<section id="solution-17" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="solution-17"><span class="header-section-number">17.3</span> Solution</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator):</span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix):</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>    probability_matrix <span class="op">=</span> np.ones((<span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(states)))</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>, i] <span class="op">=</span> emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states)</span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>                transition_matrix[previous_state, current_state] <span class="op">*</span> </span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a>                emission_matrix[current_state, emission] <span class="op">*</span> </span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>                probability_matrix[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(probability_matrix[i, :])</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzzyzyy</span></span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.303   0.697 </span></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.831   0.169 </span></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.533   0.065   0.402 </span></span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.342   0.334   0.324</span></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-profile-hmm" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Construct a Profile HMM</h1>
<p>Given:&nbsp;A threshold&nbsp;<em>θ</em>, followed by an alphabet&nbsp;<em>Σ</em>, followed by a multiple alignment&nbsp;<em>Alignment</em>&nbsp;whose strings are formed from&nbsp;<em>Σ</em>.</p>
<p>Return:&nbsp;The transition and emission probabilities of the profile HMM&nbsp;<em>HMM</em>(<em>Alignment</em>,&nbsp;<em>θ</em>).</p>
<section id="sample-dataset-18" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="sample-dataset-18"><span class="header-section-number">18.1</span> Sample Dataset</h2>
<pre><code>0.289
--------
A   B   C   D   E
--------
EBA
EBD
EB-
EED
EBD
EBE
E-D
EBD</code></pre>
</section>
<section id="sample-output-18" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="sample-output-18"><span class="header-section-number">18.2</span> Sample Output</h2>
<pre><code>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E
S   0   0   1.0 0   0   0   0   0   0   0   0   0
I0  0   0   0   0   0   0   0   0   0   0   0   0
M1  0   0   0   0   0   0.875   0.125   0   0   0   0   0
D1  0   0   0   0   0   0   0   0   0   0   0   0
I1  0   0   0   0   0   0   0   0   0   0   0   0
M2  0   0   0   0   0   0   0   0   0.857   0.143   0   0
D2  0   0   0   0   0   0   0   0   1.0 0   0   0
I2  0   0   0   0   0   0   0   0   0   0   0   0
M3  0   0   0   0   0   0   0   0   0   0   0   1.0
D3  0   0   0   0   0   0   0   0   0   0   0   1.0
I3  0   0   0   0   0   0   0   0   0   0   0   0
E   0   0   0   0   0   0   0   0   0   0   0   0
--------
    A   B   C   D   E
S   0   0   0   0   0
I0  0   0   0   0   0
M1  0   0   0   0   1.0
D1  0   0   0   0   0
I1  0   0   0   0   0
M2  0   0.857   0   0   0.143
D2  0   0   0   0   0
I2  0   0   0   0   0
M3  0.143   0   0   0.714   0.143
D3  0   0   0   0   0
I3  0   0   0   0   0
E   0   0   0   0   0</code></pre>
</section>
<section id="solution-18" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="solution-18"><span class="header-section-number">18.3</span> Solution</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    threshold <span class="op">=</span> <span class="bu">float</span>(<span class="bu">next</span>(input_iterator).rstrip())</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_iterator])</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, alphabet, alignment</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probabilities(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probabilities(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb57-62"><a href="#cb57-62" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb57-63"><a href="#cb57-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-64"><a href="#cb57-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb57-65"><a href="#cb57-65" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb57-66"><a href="#cb57-66" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb57-67"><a href="#cb57-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb57-68"><a href="#cb57-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb57-69"><a href="#cb57-69" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-70"><a href="#cb57-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb57-71"><a href="#cb57-71" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb57-72"><a href="#cb57-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb57-73"><a href="#cb57-73" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb57-74"><a href="#cb57-74" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-75"><a href="#cb57-75" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb57-76"><a href="#cb57-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb57-77"><a href="#cb57-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb57-78"><a href="#cb57-78" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb57-79"><a href="#cb57-79" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-80"><a href="#cb57-80" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb57-81"><a href="#cb57-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb57-82"><a href="#cb57-82" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-83"><a href="#cb57-83" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb57-84"><a href="#cb57-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-85"><a href="#cb57-85" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb57-86"><a href="#cb57-86" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb57-87"><a href="#cb57-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-88"><a href="#cb57-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb57-89"><a href="#cb57-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-90"><a href="#cb57-90" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb57-91"><a href="#cb57-91" aria-hidden="true" tabindex="-1"></a><span class="st">0.289</span></span>
<span id="cb57-92"><a href="#cb57-92" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb57-93"><a href="#cb57-93" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb57-94"><a href="#cb57-94" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb57-95"><a href="#cb57-95" aria-hidden="true" tabindex="-1"></a><span class="st">EBA</span></span>
<span id="cb57-96"><a href="#cb57-96" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb57-97"><a href="#cb57-97" aria-hidden="true" tabindex="-1"></a><span class="st">EB-</span></span>
<span id="cb57-98"><a href="#cb57-98" aria-hidden="true" tabindex="-1"></a><span class="st">EED</span></span>
<span id="cb57-99"><a href="#cb57-99" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb57-100"><a href="#cb57-100" aria-hidden="true" tabindex="-1"></a><span class="st">EBE</span></span>
<span id="cb57-101"><a href="#cb57-101" aria-hidden="true" tabindex="-1"></a><span class="st">E-D</span></span>
<span id="cb57-102"><a href="#cb57-102" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb57-103"><a href="#cb57-103" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb57-104"><a href="#cb57-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-105"><a href="#cb57-105" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb57-106"><a href="#cb57-106" aria-hidden="true" tabindex="-1"></a>threshold, alphabet, alignment <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb57-107"><a href="#cb57-107" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb57-108"><a href="#cb57-108" aria-hidden="true" tabindex="-1"></a>print_transition_probabilities(transition_probs)</span>
<span id="cb57-109"><a href="#cb57-109" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb57-110"><a href="#cb57-110" aria-hidden="true" tabindex="-1"></a>print_emission_probabilities(emission_probs, alphabet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-profile-hmm-with-pseudocounts" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Construct a Profile HMM with Pseudocounts</h1>
<p>Given:&nbsp;A threshold&nbsp;<em>θ</em>&nbsp;and a pseudocount&nbsp;<em>σ</em>, followed by an alphabet&nbsp;<em>Σ</em>, followed by a multiple alignment&nbsp;<em>Alignment</em>&nbsp;whose strings are formed from&nbsp;<em>Σ</em>.</p>
<p>Return:&nbsp;The transition and emission probabilities of the profile HMM&nbsp;<em>HMM</em>(<em>Alignment</em>,&nbsp;<em>θ</em>,&nbsp;<em>σ</em>).</p>
<section id="sample-dataset-19" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="sample-dataset-19"><span class="header-section-number">19.1</span> Sample Dataset</h2>
<pre><code>0.358   0.01
--------
A   B   C   D   E
--------
ADA
ADA
AAA
ADC
-DA
D-A</code></pre>
</section>
<section id="sample-output-19" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="sample-output-19"><span class="header-section-number">19.2</span> Sample Output</h2>
<pre><code>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E
S   0   0.01    0.819   0.172   0   0   0   0   0   0   0   0
I0  0   0.333   0.333   0.333   0   0   0   0   0   0   0   0
M1  0   0   0   0   0.01    0.786   0.204   0   0   0   0   0
D1  0   0   0   0   0.01    0.981   0.01    0   0   0   0   0
I1  0   0   0   0   0.333   0.333   0.333   0   0   0   0   0
M2  0   0   0   0   0   0   0   0.01    0.981   0.01    0   0
D2  0   0   0   0   0   0   0   0.01    0.981   0.01    0   0
I2  0   0   0   0   0   0   0   0.333   0.333   0.333   0   0
M3  0   0   0   0   0   0   0   0   0   0   0.01    0.99
D3  0   0   0   0   0   0   0   0   0   0   0.5 0.5
I3  0   0   0   0   0   0   0   0   0   0   0.5 0.5
E   0   0   0   0   0   0   0   0   0   0   0   0
--------
    A   B   C   D   E
S   0   0   0   0   0
I0  0.2 0.2 0.2 0.2 0.2
M1  0.771   0.01    0.01    0.2 0.01
D1  0   0   0   0   0
I1  0.2 0.2 0.2 0.2 0.2
M2  0.2 0.01    0.01    0.771   0.01
D2  0   0   0   0   0
I2  0.2 0.2 0.2 0.2 0.2
M3  0.803   0.01    0.168   0.01    0.01
D3  0   0   0   0   0
I3  0.2 0.2 0.2 0.2 0.2
E   0   0   0   0   0</code></pre>
</section>
<section id="solution-19" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="solution-19"><span class="header-section-number">19.3</span> Solution</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probs(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probs(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb60-79"><a href="#cb60-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-80"><a href="#cb60-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb60-81"><a href="#cb60-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-82"><a href="#cb60-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb60-83"><a href="#cb60-83" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_handle).rstrip().split())</span>
<span id="cb60-84"><a href="#cb60-84" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb60-85"><a href="#cb60-85" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_handle).split()</span>
<span id="cb60-86"><a href="#cb60-86" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb60-87"><a href="#cb60-87" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_handle])</span>
<span id="cb60-88"><a href="#cb60-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, pseudocount, alphabet, alignment</span>
<span id="cb60-89"><a href="#cb60-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-90"><a href="#cb60-90" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_transition_pseudocounts(transition_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-91"><a href="#cb60-91" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb60-92"><a href="#cb60-92" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb60-93"><a href="#cb60-93" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb60-94"><a href="#cb60-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb60-95"><a href="#cb60-95" aria-hidden="true" tabindex="-1"></a>        transition_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span> : i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">5</span>, (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span> : (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb60-96"><a href="#cb60-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(transition_matrix)</span>
<span id="cb60-97"><a href="#cb60-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-98"><a href="#cb60-98" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_emission_pseudocounts(emission_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb60-99"><a href="#cb60-99" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb60-100"><a href="#cb60-100" aria-hidden="true" tabindex="-1"></a>    emission_matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb60-101"><a href="#cb60-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb60-102"><a href="#cb60-102" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb60-103"><a href="#cb60-103" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb60-104"><a href="#cb60-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(emission_matrix)</span>
<span id="cb60-105"><a href="#cb60-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-106"><a href="#cb60-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_pseudocount_profile_hmm(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb60-107"><a href="#cb60-107" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb60-108"><a href="#cb60-108" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_transition_pseudocounts(transition_probs, pseudocount)</span>
<span id="cb60-109"><a href="#cb60-109" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_emission_pseudocounts(emission_probs, pseudocount)</span>
<span id="cb60-110"><a href="#cb60-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb60-111"><a href="#cb60-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-112"><a href="#cb60-112" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb60-113"><a href="#cb60-113" aria-hidden="true" tabindex="-1"></a><span class="st">0.358   0.01</span></span>
<span id="cb60-114"><a href="#cb60-114" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb60-115"><a href="#cb60-115" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb60-116"><a href="#cb60-116" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb60-117"><a href="#cb60-117" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb60-118"><a href="#cb60-118" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb60-119"><a href="#cb60-119" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb60-120"><a href="#cb60-120" aria-hidden="true" tabindex="-1"></a><span class="st">ADC</span></span>
<span id="cb60-121"><a href="#cb60-121" aria-hidden="true" tabindex="-1"></a><span class="st">-DA</span></span>
<span id="cb60-122"><a href="#cb60-122" aria-hidden="true" tabindex="-1"></a><span class="st">D-A</span></span>
<span id="cb60-123"><a href="#cb60-123" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb60-124"><a href="#cb60-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-125"><a href="#cb60-125" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb60-126"><a href="#cb60-126" aria-hidden="true" tabindex="-1"></a>threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb60-127"><a href="#cb60-127" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_pseudocount_profile_hmm(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb60-128"><a href="#cb60-128" aria-hidden="true" tabindex="-1"></a>print_transition_probs(transition_probs)</span>
<span id="cb60-129"><a href="#cb60-129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb60-130"><a href="#cb60-130" aria-hidden="true" tabindex="-1"></a>print_emission_probs(emission_probs, alphabet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="perform-a-multiple-sequence-alignment-with-a-profile-hmm" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Perform a Multiple Sequence Alignment with a Profile HMM</h1>
<p>Given:&nbsp;A string Text, a multiple alignment Alignment, a threshold θ, and a pseudocount σ.</p>
<p>Return:&nbsp;An optimal hidden path emitting Text in HMM(Alignment,θ,σ).</p>
<section id="sample-dataset-20" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="sample-dataset-20"><span class="header-section-number">20.1</span> Sample Dataset</h2>
<pre><code>AEFDFDC
--------
0.4 0.01
--------
A   B   C   D   E   F
--------
ACDEFACADF
AFDA---CCF
A--EFD-FDC
ACAEF--A-C
ADDEFAAADF</code></pre>
</section>
<section id="sample-output-20" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="sample-output-20"><span class="header-section-number">20.2</span> Sample Output</h2>
<pre><code>M1 D2 D3 M4 M5 I5 M6 M7 M8</code></pre>
</section>
<section id="solution-20" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="solution-20"><span class="header-section-number">20.3</span> Solution</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf, log</span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>        labels.extend([<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>])</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(num_states: <span class="bu">int</span>, num_symbols: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_symbols), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_index(state_num: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (state_num <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> state_num <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a>    valid_length <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_length <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_length)</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_length, <span class="bu">len</span>(alphabet))</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a>        valid_col_count <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[col]:</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>                valid_col_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"del"</span>)</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"match"</span>)</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"ins"</span>)</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_transitions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>:i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">5</span>, (i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>:(i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb63-77"><a href="#cb63-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-78"><a href="#cb63-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_emissions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb63-79"><a href="#cb63-79" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-80"><a href="#cb63-80" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb63-81"><a href="#cb63-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-82"><a href="#cb63-82" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb63-83"><a href="#cb63-83" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb63-84"><a href="#cb63-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb63-85"><a href="#cb63-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-86"><a href="#cb63-86" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm_with_pseudocounts(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb63-87"><a href="#cb63-87" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb63-88"><a href="#cb63-88" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_pseudocounts_to_transitions(transition_probs, pseudocount)</span>
<span id="cb63-89"><a href="#cb63-89" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_pseudocounts_to_emissions(emission_probs, pseudocount)</span>
<span id="cb63-90"><a href="#cb63-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb63-91"><a href="#cb63-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-92"><a href="#cb63-92" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input_data(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb63-93"><a href="#cb63-93" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb63-94"><a href="#cb63-94" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb63-95"><a href="#cb63-95" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_iterator).rstrip().split())</span>
<span id="cb63-96"><a href="#cb63-96" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb63-97"><a href="#cb63-97" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb63-98"><a href="#cb63-98" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb63-99"><a href="#cb63-99" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(x.strip()) <span class="cf">for</span> x <span class="kw">in</span> input_iterator])</span>
<span id="cb63-100"><a href="#cb63-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, threshold, pseudocount, alphabet, alignment</span>
<span id="cb63-101"><a href="#cb63-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-102"><a href="#cb63-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_transition_probs_to_dict(matrix: np.ndarray) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb63-103"><a href="#cb63-103" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb63-104"><a href="#cb63-104" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-105"><a href="#cb63-105" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb63-106"><a href="#cb63-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb63-107"><a href="#cb63-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb63-108"><a href="#cb63-108" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb63-109"><a href="#cb63-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb63-110"><a href="#cb63-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-111"><a href="#cb63-111" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_emission_probs_to_dict(matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb63-112"><a href="#cb63-112" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb63-113"><a href="#cb63-113" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-114"><a href="#cb63-114" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb63-115"><a href="#cb63-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb63-116"><a href="#cb63-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(alphabet):</span>
<span id="cb63-117"><a href="#cb63-117" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], symbol] <span class="op">=</span> matrix[i][j]</span>
<span id="cb63-118"><a href="#cb63-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb63-119"><a href="#cb63-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-120"><a href="#cb63-120" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_hmm_graph(transition_probs: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb63-121"><a href="#cb63-121" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb63-122"><a href="#cb63-122" aria-hidden="true" tabindex="-1"></a>        graph[source].append({<span class="st">"node"</span>: target, <span class="st">"weight"</span>: transition_probs[source, target]})</span>
<span id="cb63-123"><a href="#cb63-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-124"><a href="#cb63-124" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb63-125"><a href="#cb63-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target <span class="kw">in</span> [<span class="st">"I0"</span>, <span class="st">"M1"</span>, <span class="st">"D1"</span>]:</span>
<span id="cb63-126"><a href="#cb63-126" aria-hidden="true" tabindex="-1"></a>        add_edge(<span class="st">"S"</span>, target)</span>
<span id="cb63-127"><a href="#cb63-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-128"><a href="#cb63-128" aria-hidden="true" tabindex="-1"></a>        source <span class="op">=</span> <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb63-129"><a href="#cb63-129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [source, <span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb63-130"><a href="#cb63-130" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb63-131"><a href="#cb63-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states):</span>
<span id="cb63-132"><a href="#cb63-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb63-133"><a href="#cb63-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb63-134"><a href="#cb63-134" aria-hidden="true" tabindex="-1"></a>                add_edge(source, target)</span>
<span id="cb63-135"><a href="#cb63-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb63-136"><a href="#cb63-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="st">"E"</span>]:</span>
<span id="cb63-137"><a href="#cb63-137" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb63-138"><a href="#cb63-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-139"><a href="#cb63-139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb63-140"><a href="#cb63-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-141"><a href="#cb63-141" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_topological_order(num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb63-142"><a href="#cb63-142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"S"</span>, <span class="dv">0</span>)</span>
<span id="cb63-143"><a href="#cb63-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-144"><a href="#cb63-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="ss">f"D</span><span class="sc">{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)</span>
<span id="cb63-145"><a href="#cb63-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(seq_length):</span>
<span id="cb63-146"><a href="#cb63-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="st">"I0"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb63-147"><a href="#cb63-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb63-148"><a href="#cb63-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> state_type <span class="kw">in</span> [<span class="st">"M"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>]:</span>
<span id="cb63-149"><a href="#cb63-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (<span class="ss">f"</span><span class="sc">{</span>state_type<span class="sc">}{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb63-150"><a href="#cb63-150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"E"</span>, seq_length <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb63-151"><a href="#cb63-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-152"><a href="#cb63-152" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_nodes(current_node: <span class="bu">str</span>, current_col: <span class="bu">int</span>, num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb63-153"><a href="#cb63-153" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"E"</span>:</span>
<span id="cb63-154"><a href="#cb63-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length)]</span>
<span id="cb63-155"><a href="#cb63-155" aria-hidden="true" tabindex="-1"></a>    state_num <span class="op">=</span> <span class="bu">int</span>(current_node[<span class="dv">1</span>:])</span>
<span id="cb63-156"><a href="#cb63-156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb63-157"><a href="#cb63-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)]</span>
<span id="cb63-158"><a href="#cb63-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"I0"</span>:</span>
<span id="cb63-159"><a href="#cb63-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb63-160"><a href="#cb63-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"M1"</span>:</span>
<span id="cb63-161"><a href="#cb63-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb63-162"><a href="#cb63-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"I"</span>:</span>
<span id="cb63-163"><a href="#cb63-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb63-164"><a href="#cb63-164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"M"</span>:</span>
<span id="cb63-165"><a href="#cb63-165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb63-166"><a href="#cb63-166" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"D"</span>:</span>
<span id="cb63-167"><a href="#cb63-167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"I0"</span>, current_col)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col)]</span>
<span id="cb63-168"><a href="#cb63-168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb63-169"><a href="#cb63-169" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Unhandled node: </span><span class="sc">{</span>current_node<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb63-170"><a href="#cb63-170" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb63-171"><a href="#cb63-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-172"><a href="#cb63-172" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplify_graph(graph: Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">float</span>]]:</span>
<span id="cb63-173"><a href="#cb63-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {k: {x[<span class="st">"node"</span>]: x[<span class="st">"weight"</span>] <span class="cf">for</span> x <span class="kw">in</span> v} <span class="cf">for</span> k, v <span class="kw">in</span> graph.items()}</span>
<span id="cb63-174"><a href="#cb63-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-175"><a href="#cb63-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Main execution</span></span>
<span id="cb63-176"><a href="#cb63-176" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input):</span>
<span id="cb63-177"><a href="#cb63-177" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb63-178"><a href="#cb63-178" aria-hidden="true" tabindex="-1"></a>    sequence, threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input_data(input_lines)</span>
<span id="cb63-179"><a href="#cb63-179" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm_with_pseudocounts(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb63-180"><a href="#cb63-180" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (transition_probs.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb63-181"><a href="#cb63-181" aria-hidden="true" tabindex="-1"></a>    transition_probs_dict <span class="op">=</span> convert_transition_probs_to_dict(transition_probs)</span>
<span id="cb63-182"><a href="#cb63-182" aria-hidden="true" tabindex="-1"></a>    emission_probs_dict <span class="op">=</span> convert_emission_probs_to_dict(emission_probs, alphabet)</span>
<span id="cb63-183"><a href="#cb63-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-184"><a href="#cb63-184" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> build_hmm_graph(transition_probs_dict, num_states)</span>
<span id="cb63-185"><a href="#cb63-185" aria-hidden="true" tabindex="-1"></a>    topological_order <span class="op">=</span> generate_topological_order(num_states, <span class="bu">len</span>(sequence))</span>
<span id="cb63-186"><a href="#cb63-186" aria-hidden="true" tabindex="-1"></a>    simplified_graph <span class="op">=</span> simplify_graph(graph)</span>
<span id="cb63-187"><a href="#cb63-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-188"><a href="#cb63-188" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dynamic programming to find the most probable path</span></span>
<span id="cb63-189"><a href="#cb63-189" aria-hidden="true" tabindex="-1"></a>    previous_node <span class="op">=</span> <span class="bu">next</span>(topological_order)</span>
<span id="cb63-190"><a href="#cb63-190" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {previous_node: <span class="dv">0</span>}</span>
<span id="cb63-191"><a href="#cb63-191" aria-hidden="true" tabindex="-1"></a>    backpointers <span class="op">=</span> {previous_node: (<span class="va">None</span>, <span class="va">None</span>)}</span>
<span id="cb63-192"><a href="#cb63-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-193"><a href="#cb63-193" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_node, current_col <span class="kw">in</span> topological_order:</span>
<span id="cb63-194"><a href="#cb63-194" aria-hidden="true" tabindex="-1"></a>        backpointers[(current_node, current_col)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb63-195"><a href="#cb63-195" aria-hidden="true" tabindex="-1"></a>        scores[(current_node, current_col)] <span class="op">=</span> <span class="op">-</span>inf</span>
<span id="cb63-196"><a href="#cb63-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> prev_node, prev_col <span class="kw">in</span> get_previous_nodes(current_node, current_col, num_states, <span class="bu">len</span>(sequence)):</span>
<span id="cb63-197"><a href="#cb63-197" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_col <span class="op">&lt;</span> current_col <span class="kw">and</span> current_node <span class="op">!=</span> <span class="st">"E"</span>:</span>
<span id="cb63-198"><a href="#cb63-198" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> emission_probs_dict[current_node, sequence[current_col <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb63-199"><a href="#cb63-199" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb63-200"><a href="#cb63-200" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb63-201"><a href="#cb63-201" aria-hidden="true" tabindex="-1"></a>            log_prob <span class="op">=</span> log(simplified_graph[prev_node][current_node]) <span class="op">+</span> log(emission_prob) <span class="op">+</span> scores[(prev_node, prev_col)]</span>
<span id="cb63-202"><a href="#cb63-202" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> log_prob <span class="op">&gt;</span> scores[(current_node, current_col)]:</span>
<span id="cb63-203"><a href="#cb63-203" aria-hidden="true" tabindex="-1"></a>                scores[(current_node, current_col)] <span class="op">=</span> log_prob</span>
<span id="cb63-204"><a href="#cb63-204" aria-hidden="true" tabindex="-1"></a>                backpointers[(current_node, current_col)] <span class="op">=</span> (prev_node, prev_col)</span>
<span id="cb63-205"><a href="#cb63-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-206"><a href="#cb63-206" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to find the path</span></span>
<span id="cb63-207"><a href="#cb63-207" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> []</span>
<span id="cb63-208"><a href="#cb63-208" aria-hidden="true" tabindex="-1"></a>    position <span class="op">=</span> (<span class="st">"E"</span>, <span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb63-209"><a href="#cb63-209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> position[<span class="dv">0</span>]:</span>
<span id="cb63-210"><a href="#cb63-210" aria-hidden="true" tabindex="-1"></a>        path.append(backpointers[position][<span class="dv">0</span>])</span>
<span id="cb63-211"><a href="#cb63-211" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> backpointers[position]</span>
<span id="cb63-212"><a href="#cb63-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-213"><a href="#cb63-213" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>path[::<span class="op">-</span><span class="dv">1</span>][<span class="dv">2</span>:])</span>
<span id="cb63-214"><a href="#cb63-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-215"><a href="#cb63-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-216"><a href="#cb63-216" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb63-217"><a href="#cb63-217" aria-hidden="true" tabindex="-1"></a><span class="st">AEFDFDC</span></span>
<span id="cb63-218"><a href="#cb63-218" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb63-219"><a href="#cb63-219" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.01</span></span>
<span id="cb63-220"><a href="#cb63-220" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb63-221"><a href="#cb63-221" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E   F</span></span>
<span id="cb63-222"><a href="#cb63-222" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb63-223"><a href="#cb63-223" aria-hidden="true" tabindex="-1"></a><span class="st">ACDEFACADF</span></span>
<span id="cb63-224"><a href="#cb63-224" aria-hidden="true" tabindex="-1"></a><span class="st">AFDA---CCF</span></span>
<span id="cb63-225"><a href="#cb63-225" aria-hidden="true" tabindex="-1"></a><span class="st">A--EFD-FDC</span></span>
<span id="cb63-226"><a href="#cb63-226" aria-hidden="true" tabindex="-1"></a><span class="st">ACAEF--A-C</span></span>
<span id="cb63-227"><a href="#cb63-227" aria-hidden="true" tabindex="-1"></a><span class="st">ADDEFAAADF</span></span>
<span id="cb63-228"><a href="#cb63-228" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb63-229"><a href="#cb63-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-230"><a href="#cb63-230" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="estimate-the-parameters-of-an-hmm" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Estimate the Parameters of an HMM</h1>
<p>Given:&nbsp;A sequence of emitted symbols x = x1 . . . xn in an alphabet ∑ and a path <span class="math inline">\(π = π_1 . . . π_n\)</span> generated by a k-state HMM with unknown transition and emission probabilities.</p>
<p>Return:&nbsp;A matrix of transition probabilities Transition and a matrix of emission probabilities Emission that maximize <span class="math inline">\(Pr(x,π)\)</span> over all possible matrices of transition and emission probabilities.</p>
<section id="sample-dataset-21" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="sample-dataset-21"><span class="header-section-number">21.1</span> Sample Dataset</h2>
<pre><code>yzzzyxzxxx
--------
x   y   z
--------
BBABABABAB
--------
A   B   C</code></pre>
</section>
<section id="sample-output-21" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="sample-output-21"><span class="header-section-number">21.2</span> Sample Output</h2>
<pre><code>A   B   C
A   0.0 1.0 0.0
B   0.8 0.2 0.0
C   0.333   0.333   0.333
--------
    x   y   z
A   0.25    0.25    0.5
B   0.5 0.167   0.333
C   0.333   0.333   0.333</code></pre>
</section>
<section id="solution-21" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="solution-21"><span class="header-section-number">21.3</span> Solution</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator, Union</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], <span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb66-28"><a href="#cb66-28" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb66-29"><a href="#cb66-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb66-30"><a href="#cb66-30" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb66-31"><a href="#cb66-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, alphabet, path, states</span>
<span id="cb66-32"><a href="#cb66-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-33"><a href="#cb66-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_dict(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb66-34"><a href="#cb66-34" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb66-35"><a href="#cb66-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb66-36"><a href="#cb66-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">1</span>]):</span>
<span id="cb66-37"><a href="#cb66-37" aria-hidden="true" tabindex="-1"></a>            result[row_labels[i], column_labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb66-38"><a href="#cb66-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb66-39"><a href="#cb66-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-40"><a href="#cb66-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb66-41"><a href="#cb66-41" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb66-42"><a href="#cb66-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_state, next_state <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb66-43"><a href="#cb66-43" aria-hidden="true" tabindex="-1"></a>        transition_matrix[states.index(current_state)][states.index(next_state)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb66-44"><a href="#cb66-44" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> normalize_matrix(transition_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb66-45"><a href="#cb66-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb66-46"><a href="#cb66-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(transition_matrix, states, states)</span>
<span id="cb66-47"><a href="#cb66-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb66-48"><a href="#cb66-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> transition_matrix</span>
<span id="cb66-49"><a href="#cb66-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-50"><a href="#cb66-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb66-51"><a href="#cb66-51" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb66-52"><a href="#cb66-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> state, symbol <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb66-53"><a href="#cb66-53" aria-hidden="true" tabindex="-1"></a>        emission_matrix[states.index(state)][alphabet.index(symbol)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb66-54"><a href="#cb66-54" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> normalize_matrix(emission_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb66-55"><a href="#cb66-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb66-56"><a href="#cb66-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(emission_matrix, states, alphabet)</span>
<span id="cb66-57"><a href="#cb66-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb66-58"><a href="#cb66-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> emission_matrix</span>
<span id="cb66-59"><a href="#cb66-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-60"><a href="#cb66-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb66-61"><a href="#cb66-61" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb66-62"><a href="#cb66-62" aria-hidden="true" tabindex="-1"></a>    sequence, alphabet, path, states <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb66-63"><a href="#cb66-63" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states)</span>
<span id="cb66-64"><a href="#cb66-64" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states)</span>
<span id="cb66-65"><a href="#cb66-65" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, states, states)</span>
<span id="cb66-66"><a href="#cb66-66" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb66-67"><a href="#cb66-67" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, states, alphabet)</span>
<span id="cb66-68"><a href="#cb66-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-69"><a href="#cb66-69" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb66-70"><a href="#cb66-70" aria-hidden="true" tabindex="-1"></a><span class="st">yzzzyxzxxx</span></span>
<span id="cb66-71"><a href="#cb66-71" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb66-72"><a href="#cb66-72" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb66-73"><a href="#cb66-73" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb66-74"><a href="#cb66-74" aria-hidden="true" tabindex="-1"></a><span class="st">BBABABABAB</span></span>
<span id="cb66-75"><a href="#cb66-75" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb66-76"><a href="#cb66-76" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C</span></span>
<span id="cb66-77"><a href="#cb66-77" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb66-78"><a href="#cb66-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-79"><a href="#cb66-79" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-viterbi-learning" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> Implement Viterbi Learning</h1>
<p>Given:&nbsp;A sequence of emitted symbols&nbsp;<span class="math inline">\(x=x_1 ... x_n\)</span>&nbsp;in an alphabet&nbsp;<em>A</em>, generated by a&nbsp;<em>k</em>-state HMM with unknown transition and emission probabilities, initial&nbsp;<em>Transition</em>&nbsp;and&nbsp;<em>Emission</em>&nbsp;matrices and a number of iterations&nbsp;<em>i</em>.</p>
<p>Return:&nbsp;A matrix of transition probabilities&nbsp;<em>Transition</em>&nbsp;and a matrix of emission probabilities&nbsp;<em>Emission</em>&nbsp;that maximizes <span class="math inline">\(Pr(x,π)\)</span> over all possible transition and emission matrices and over all hidden paths&nbsp;<em>π</em>.</p>
<section id="sample-dataset-22" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="sample-dataset-22"><span class="header-section-number">22.1</span> Sample Dataset</h2>
<pre><code>100
--------
xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz
--------
x   y   z
--------
A   B
--------
    A   B
A   0.582   0.418
B   0.272   0.728
--------
    x   y   z
A   0.129   0.35    0.52
B   0.422   0.151   0.426</code></pre>
</section>
<section id="sample-output-22" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="sample-output-22"><span class="header-section-number">22.2</span> Sample Output</h2>
<pre><code>A   B
A   0.875   0.125
B   0.011   0.989
--------
    x   y   z
A   0.0 0.75    0.25
B   0.402   0.174   0.424</code></pre>
</section>
<section id="solution-22" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="solution-22"><span class="header-section-number">22.3</span> Solution</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)))</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states))</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a>            opt <span class="op">=</span> [</span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[prev, state]) <span class="op">+</span> log(emission_matrix[state, emission]) <span class="op">+</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb69-18"><a href="#cb69-18" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb69-19"><a href="#cb69-19" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> opt.index(<span class="bu">max</span>(opt))</span>
<span id="cb69-20"><a href="#cb69-20" aria-hidden="true" tabindex="-1"></a>            ptr[i, j] <span class="op">=</span> p</span>
<span id="cb69-21"><a href="#cb69-21" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">max</span>(opt)</span>
<span id="cb69-22"><a href="#cb69-22" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> np.argmax(mat[i, :])</span>
<span id="cb69-23"><a href="#cb69-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-24"><a href="#cb69-24" aria-hidden="true" tabindex="-1"></a>    state_sequence <span class="op">=</span> states[ind]</span>
<span id="cb69-25"><a href="#cb69-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb69-26"><a href="#cb69-26" aria-hidden="true" tabindex="-1"></a>        state_sequence <span class="op">=</span> states[ptr[i, ind]] <span class="op">+</span> state_sequence</span>
<span id="cb69-27"><a href="#cb69-27" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> ptr[i, ind]</span>
<span id="cb69-28"><a href="#cb69-28" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb69-29"><a href="#cb69-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> state_sequence</span>
<span id="cb69-30"><a href="#cb69-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-31"><a href="#cb69-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb69-32"><a href="#cb69-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb69-33"><a href="#cb69-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb69-34"><a href="#cb69-34" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb69-35"><a href="#cb69-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb69-36"><a href="#cb69-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-37"><a href="#cb69-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, min_val: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1e-16</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb69-38"><a href="#cb69-38" aria-hidden="true" tabindex="-1"></a>    normalized <span class="op">=</span> matrix <span class="op">/</span> matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-39"><a href="#cb69-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros:</span>
<span id="cb69-40"><a href="#cb69-40" aria-hidden="true" tabindex="-1"></a>        normalized[normalized <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> min_val</span>
<span id="cb69-41"><a href="#cb69-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalized</span>
<span id="cb69-42"><a href="#cb69-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-43"><a href="#cb69-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb69-44"><a href="#cb69-44" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb69-45"><a href="#cb69-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb69-46"><a href="#cb69-46" aria-hidden="true" tabindex="-1"></a>        tmat[states.index(a)][states.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb69-47"><a href="#cb69-47" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> normalize_matrix(tmat)</span>
<span id="cb69-48"><a href="#cb69-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb69-49"><a href="#cb69-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], states[j]): tmat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states))}</span>
<span id="cb69-50"><a href="#cb69-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tmat</span>
<span id="cb69-51"><a href="#cb69-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-52"><a href="#cb69-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb69-53"><a href="#cb69-53" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb69-54"><a href="#cb69-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb69-55"><a href="#cb69-55" aria-hidden="true" tabindex="-1"></a>        emat[states.index(a)][alphabet.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb69-56"><a href="#cb69-56" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> normalize_matrix(emat)</span>
<span id="cb69-57"><a href="#cb69-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb69-58"><a href="#cb69-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], alphabet[j]): emat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(alphabet))}</span>
<span id="cb69-59"><a href="#cb69-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emat</span>
<span id="cb69-60"><a href="#cb69-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-61"><a href="#cb69-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb69-62"><a href="#cb69-62" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(column_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb69-63"><a href="#cb69-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb69-64"><a href="#cb69-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(column_labels):</span>
<span id="cb69-65"><a href="#cb69-65" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb69-66"><a href="#cb69-66" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, column_labels)</span>
<span id="cb69-67"><a href="#cb69-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-68"><a href="#cb69-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: StringIO) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb69-69"><a href="#cb69-69" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb69-70"><a href="#cb69-70" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-71"><a href="#cb69-71" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb69-72"><a href="#cb69-72" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-73"><a href="#cb69-73" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb69-74"><a href="#cb69-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-75"><a href="#cb69-75" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb69-76"><a href="#cb69-76" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-77"><a href="#cb69-77" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb69-78"><a href="#cb69-78" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb69-79"><a href="#cb69-79" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb69-80"><a href="#cb69-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb69-81"><a href="#cb69-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb69-82"><a href="#cb69-82" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-83"><a href="#cb69-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb69-84"><a href="#cb69-84" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb69-85"><a href="#cb69-85" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb69-86"><a href="#cb69-86" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb69-87"><a href="#cb69-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb69-88"><a href="#cb69-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb69-89"><a href="#cb69-89" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb69-90"><a href="#cb69-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, sequence, states, alphabet, transition_matrix, emission_matrix</span>
<span id="cb69-91"><a href="#cb69-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-92"><a href="#cb69-92" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb69-93"><a href="#cb69-93" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb69-94"><a href="#cb69-94" aria-hidden="true" tabindex="-1"></a>    niter, sequence, states, alphabet, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb69-95"><a href="#cb69-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb69-96"><a href="#cb69-96" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb69-97"><a href="#cb69-97" aria-hidden="true" tabindex="-1"></a>        transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-98"><a href="#cb69-98" aria-hidden="true" tabindex="-1"></a>        emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb69-99"><a href="#cb69-99" aria-hidden="true" tabindex="-1"></a>    print_dict(transition_matrix, states, states)</span>
<span id="cb69-100"><a href="#cb69-100" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb69-101"><a href="#cb69-101" aria-hidden="true" tabindex="-1"></a>    print_dict(emission_matrix, states, alphabet)</span>
<span id="cb69-102"><a href="#cb69-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-103"><a href="#cb69-103" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb69-104"><a href="#cb69-104" aria-hidden="true" tabindex="-1"></a><span class="st">100</span></span>
<span id="cb69-105"><a href="#cb69-105" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-106"><a href="#cb69-106" aria-hidden="true" tabindex="-1"></a><span class="st">xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span></span>
<span id="cb69-107"><a href="#cb69-107" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-108"><a href="#cb69-108" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb69-109"><a href="#cb69-109" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-110"><a href="#cb69-110" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb69-111"><a href="#cb69-111" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-112"><a href="#cb69-112" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb69-113"><a href="#cb69-113" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.582   0.418</span></span>
<span id="cb69-114"><a href="#cb69-114" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.272   0.728</span></span>
<span id="cb69-115"><a href="#cb69-115" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb69-116"><a href="#cb69-116" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb69-117"><a href="#cb69-117" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.129   0.35    0.52</span></span>
<span id="cb69-118"><a href="#cb69-118" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.422   0.151   0.426</span></span>
<span id="cb69-119"><a href="#cb69-119" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb69-120"><a href="#cb69-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-121"><a href="#cb69-121" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="solve-the-soft-decoding-problem" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> Solve the Soft Decoding Problem</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability <span class="math inline">\(Pr(π_i=k|x)\)</span> that the HMM was in state k at step i (for each state k and each step i).</p>
<section id="sample-dataset-23" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="sample-dataset-23"><span class="header-section-number">23.1</span> Sample Dataset</h2>
<pre><code>zyxxxxyxzz
--------
x   y   z
--------
A   B
--------
    A   B
A   0.911   0.089
B   0.228   0.772
--------
    x   y   z
A   0.356   0.191   0.453 
B   0.04    0.467   0.493</code></pre>
</section>
<section id="sample-output-23" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="sample-output-23"><span class="header-section-number">23.2</span> Sample Output</h2>
<pre><code>A   B 
0.5438  0.4562 
0.6492  0.3508 
0.9647  0.0353 
0.9936  0.0064 
0.9957  0.0043 
0.9891  0.0109 
0.9154  0.0846 
0.964   0.036 
0.8737  0.1263 
0.8167  0.1833</code></pre>
</section>
<section id="solution-23" class="level2" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="solution-23"><span class="header-section-number">23.3</span> Solution</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>    seq: <span class="bu">str</span> <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>    alphabet: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>    states: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a>    lines: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a>    tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb72-19"><a href="#cb72-19" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb72-20"><a href="#cb72-20" aria-hidden="true" tabindex="-1"></a>    emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb72-21"><a href="#cb72-21" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb72-22"><a href="#cb72-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb72-23"><a href="#cb72-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb72-24"><a href="#cb72-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb72-25"><a href="#cb72-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq, states, tmat, emat</span>
<span id="cb72-26"><a href="#cb72-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-27"><a href="#cb72-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb72-28"><a href="#cb72-28" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb72-29"><a href="#cb72-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-30"><a href="#cb72-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb72-31"><a href="#cb72-31" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb72-32"><a href="#cb72-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb72-33"><a href="#cb72-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb72-34"><a href="#cb72-34" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb72-35"><a href="#cb72-35" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb72-36"><a href="#cb72-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb72-37"><a href="#cb72-37" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb72-38"><a href="#cb72-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-39"><a href="#cb72-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb72-40"><a href="#cb72-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-41"><a href="#cb72-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb72-42"><a href="#cb72-42" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb72-43"><a href="#cb72-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-44"><a href="#cb72-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb72-45"><a href="#cb72-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb72-46"><a href="#cb72-46" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb72-47"><a href="#cb72-47" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb72-48"><a href="#cb72-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb72-49"><a href="#cb72-49" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb72-50"><a href="#cb72-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb72-51"><a href="#cb72-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-52"><a href="#cb72-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb72-53"><a href="#cb72-53" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb72-54"><a href="#cb72-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb72-55"><a href="#cb72-55" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb72-56"><a href="#cb72-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb72-57"><a href="#cb72-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-58"><a href="#cb72-58" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb72-59"><a href="#cb72-59" aria-hidden="true" tabindex="-1"></a>    input_lines: Iterator[<span class="bu">str</span>] <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb72-60"><a href="#cb72-60" aria-hidden="true" tabindex="-1"></a>    seq, states, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb72-61"><a href="#cb72-61" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> soft_decode(seq, states, tmat, emat)</span>
<span id="cb72-62"><a href="#cb72-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>states, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb72-63"><a href="#cb72-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> r <span class="kw">in</span> np.<span class="bu">round</span>(tot, <span class="dv">4</span>):</span>
<span id="cb72-64"><a href="#cb72-64" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb72-65"><a href="#cb72-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-66"><a href="#cb72-66" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb72-67"><a href="#cb72-67" aria-hidden="true" tabindex="-1"></a><span class="st">zyxxxxyxzz</span></span>
<span id="cb72-68"><a href="#cb72-68" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb72-69"><a href="#cb72-69" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb72-70"><a href="#cb72-70" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb72-71"><a href="#cb72-71" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb72-72"><a href="#cb72-72" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb72-73"><a href="#cb72-73" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb72-74"><a href="#cb72-74" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.911   0.089</span></span>
<span id="cb72-75"><a href="#cb72-75" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.228   0.772</span></span>
<span id="cb72-76"><a href="#cb72-76" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb72-77"><a href="#cb72-77" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb72-78"><a href="#cb72-78" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.356   0.191   0.453 </span></span>
<span id="cb72-79"><a href="#cb72-79" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.04    0.467   0.493</span></span>
<span id="cb72-80"><a href="#cb72-80" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb72-81"><a href="#cb72-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-82"><a href="#cb72-82" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-baum-welch-learning" class="level1" data-number="24">
<h1 data-number="24"><span class="header-section-number">24</span> Implement Baum-Welch Learning</h1>
<p>Given:&nbsp;A sequence of emitted symbols <span class="math inline">\(x=x_1...x_n\)</span> in an alphabet A, generated by a k-state HMM with unknown transition and emission probabilities, initial Transition and Emission matrices and a number of iterations I.</p>
<p>Return:&nbsp;A matrix of transition probabilities Transition and a matrix of emission probabilities Emission that maximizes <span class="math inline">\(Pr(x,π)\)</span> over all possible transition and emission matrices and over all hidden paths π.</p>
<section id="sample-dataset-24" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="sample-dataset-24"><span class="header-section-number">24.1</span> Sample Dataset</h2>
<pre><code>10
--------
xzyyzyzyxy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.019   0.981 
B   0.668   0.332 
--------
x   y   z
A   0.175   0.003   0.821 
B   0.196   0.512   0.293</code></pre>
</section>
<section id="sample-output-24" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="sample-output-24"><span class="header-section-number">24.2</span> Sample Output</h2>
<pre><code>A   B
A   0.000   1.000   
B   0.786   0.214   
--------
    x   y   z
A   0.242   0.000   0.758   
B   0.172   0.828   0.000</code></pre>
</section>
<section id="solution-24" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="solution-24"><span class="header-section-number">24.3</span> Solution</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(col_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(col_labels):</span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, col_labels)</span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a>    seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-24"><a href="#cb75-24" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb75-25"><a href="#cb75-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-26"><a href="#cb75-26" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb75-27"><a href="#cb75-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-28"><a href="#cb75-28" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb75-29"><a href="#cb75-29" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> {</span>
<span id="cb75-30"><a href="#cb75-30" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb75-31"><a href="#cb75-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb75-32"><a href="#cb75-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb75-33"><a href="#cb75-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb75-34"><a href="#cb75-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb75-35"><a href="#cb75-35" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb75-36"><a href="#cb75-36" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> {</span>
<span id="cb75-37"><a href="#cb75-37" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb75-38"><a href="#cb75-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb75-39"><a href="#cb75-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb75-40"><a href="#cb75-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb75-41"><a href="#cb75-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, seq, states, alphabet, tmat, emat</span>
<span id="cb75-42"><a href="#cb75-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-43"><a href="#cb75-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb75-44"><a href="#cb75-44" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb75-45"><a href="#cb75-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-46"><a href="#cb75-46" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb75-47"><a href="#cb75-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb75-48"><a href="#cb75-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-49"><a href="#cb75-49" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb75-50"><a href="#cb75-50" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb75-51"><a href="#cb75-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb75-52"><a href="#cb75-52" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb75-53"><a href="#cb75-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb75-54"><a href="#cb75-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-55"><a href="#cb75-55" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb75-56"><a href="#cb75-56" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb75-57"><a href="#cb75-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb75-58"><a href="#cb75-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-59"><a href="#cb75-59" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb75-60"><a href="#cb75-60" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb75-61"><a href="#cb75-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb75-62"><a href="#cb75-62" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb75-63"><a href="#cb75-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb75-64"><a href="#cb75-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-65"><a href="#cb75-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb75-66"><a href="#cb75-66" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb75-67"><a href="#cb75-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb75-68"><a href="#cb75-68" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-69"><a href="#cb75-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb75-70"><a href="#cb75-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-71"><a href="#cb75-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_dict(x: np.ndarray, r: List[<span class="bu">str</span>], c: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb75-72"><a href="#cb75-72" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb75-73"><a href="#cb75-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">0</span>]):</span>
<span id="cb75-74"><a href="#cb75-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">1</span>]):</span>
<span id="cb75-75"><a href="#cb75-75" aria-hidden="true" tabindex="-1"></a>            g[r[i], c[j]] <span class="op">=</span> x[i][j]</span>
<span id="cb75-76"><a href="#cb75-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g</span>
<span id="cb75-77"><a href="#cb75-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-78"><a href="#cb75-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_pi2(seq: <span class="bu">str</span>, fwd: np.ndarray, bak: np.ndarray, tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], states: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb75-79"><a href="#cb75-79" aria-hidden="true" tabindex="-1"></a>    rep_mat <span class="op">=</span> np.zeros((fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb75-80"><a href="#cb75-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb75-81"><a href="#cb75-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, s1 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-82"><a href="#cb75-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k, s2 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb75-83"><a href="#cb75-83" aria-hidden="true" tabindex="-1"></a>                weight <span class="op">=</span> tmat[s1, s2] <span class="op">*</span> emat[s2, seq[i <span class="op">+</span> <span class="dv">1</span>]]</span>
<span id="cb75-84"><a href="#cb75-84" aria-hidden="true" tabindex="-1"></a>                rep_mat[i, j, k] <span class="op">=</span> (</span>
<span id="cb75-85"><a href="#cb75-85" aria-hidden="true" tabindex="-1"></a>                    fwd[i, j] <span class="op">*</span> bak[i <span class="op">+</span> <span class="dv">1</span>, k] <span class="op">*</span> weight <span class="op">/</span> <span class="bu">sum</span>(fwd[i, :] <span class="op">*</span> bak[i, :])</span>
<span id="cb75-86"><a href="#cb75-86" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb75-87"><a href="#cb75-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rep_mat</span>
<span id="cb75-88"><a href="#cb75-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-89"><a href="#cb75-89" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_tmat(seq: <span class="bu">str</span>, st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb75-90"><a href="#cb75-90" aria-hidden="true" tabindex="-1"></a>    fwd <span class="op">=</span> forward(seq, st, tmat, emat)</span>
<span id="cb75-91"><a href="#cb75-91" aria-hidden="true" tabindex="-1"></a>    bak <span class="op">=</span> backward(seq, st, tmat, emat)</span>
<span id="cb75-92"><a href="#cb75-92" aria-hidden="true" tabindex="-1"></a>    pi2 <span class="op">=</span> estimate_pi2(seq, fwd, bak, tmat, emat, st)</span>
<span id="cb75-93"><a href="#cb75-93" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> np.<span class="bu">sum</span>(pi2, <span class="dv">0</span>)</span>
<span id="cb75-94"><a href="#cb75-94" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> tmat_new <span class="op">/</span> np.<span class="bu">sum</span>(tmat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-95"><a href="#cb75-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(tmat_new, st, st)</span>
<span id="cb75-96"><a href="#cb75-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-97"><a href="#cb75-97" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emat(seq: <span class="bu">str</span>, al: List[<span class="bu">str</span>], st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb75-98"><a href="#cb75-98" aria-hidden="true" tabindex="-1"></a>    pi1 <span class="op">=</span> soft_decode(seq, st, tmat, emat)</span>
<span id="cb75-99"><a href="#cb75-99" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> np.zeros((<span class="bu">len</span>(st), <span class="bu">len</span>(al)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb75-100"><a href="#cb75-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(al):</span>
<span id="cb75-101"><a href="#cb75-101" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> np.array(<span class="bu">list</span>(seq)) <span class="op">==</span> emission</span>
<span id="cb75-102"><a href="#cb75-102" aria-hidden="true" tabindex="-1"></a>        emat_new[:, i] <span class="op">=</span> np.<span class="bu">sum</span>(pi1[ind, :], <span class="dv">0</span>)</span>
<span id="cb75-103"><a href="#cb75-103" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> emat_new <span class="op">/</span> np.<span class="bu">sum</span>(emat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb75-104"><a href="#cb75-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(emat_new, st, al)</span>
<span id="cb75-105"><a href="#cb75-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-106"><a href="#cb75-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb75-107"><a href="#cb75-107" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb75-108"><a href="#cb75-108" aria-hidden="true" tabindex="-1"></a>    niter, seq, st, al, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb75-109"><a href="#cb75-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb75-110"><a href="#cb75-110" aria-hidden="true" tabindex="-1"></a>        tmat2 <span class="op">=</span> estimate_tmat(seq, st, tmat, emat)</span>
<span id="cb75-111"><a href="#cb75-111" aria-hidden="true" tabindex="-1"></a>        emat2 <span class="op">=</span> estimate_emat(seq, al, st, tmat, emat)</span>
<span id="cb75-112"><a href="#cb75-112" aria-hidden="true" tabindex="-1"></a>        emat, tmat <span class="op">=</span> emat2, tmat2</span>
<span id="cb75-113"><a href="#cb75-113" aria-hidden="true" tabindex="-1"></a>    print_dict(tmat, st, st)</span>
<span id="cb75-114"><a href="#cb75-114" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb75-115"><a href="#cb75-115" aria-hidden="true" tabindex="-1"></a>    print_dict(emat, st, al)</span>
<span id="cb75-116"><a href="#cb75-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-117"><a href="#cb75-117" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb75-118"><a href="#cb75-118" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb75-119"><a href="#cb75-119" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-120"><a href="#cb75-120" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzyzyxy</span></span>
<span id="cb75-121"><a href="#cb75-121" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-122"><a href="#cb75-122" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb75-123"><a href="#cb75-123" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-124"><a href="#cb75-124" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb75-125"><a href="#cb75-125" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-126"><a href="#cb75-126" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb75-127"><a href="#cb75-127" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.019   0.981 </span></span>
<span id="cb75-128"><a href="#cb75-128" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.668   0.332 </span></span>
<span id="cb75-129"><a href="#cb75-129" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb75-130"><a href="#cb75-130" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb75-131"><a href="#cb75-131" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.175   0.003   0.821 </span></span>
<span id="cb75-132"><a href="#cb75-132" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.196   0.512   0.293</span></span>
<span id="cb75-133"><a href="#cb75-133" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb75-134"><a href="#cb75-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-135"><a href="#cb75-135" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-graph-of-a-spectrum" class="level1" data-number="25">
<h1 data-number="25"><span class="header-section-number">25</span> Construct the Graph of a Spectrum</h1>
<section id="spectrum-graph-construction" class="level2" data-number="25.1">
<h2 data-number="25.1" class="anchored" data-anchor-id="spectrum-graph-construction"><span class="header-section-number">25.1</span> Spectrum Graph Construction</h2>
<p>Construct the graph of a spectrum.</p>
<p>Given:&nbsp;A space-delimited list of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;<em>Graph(Spectrum)</em>.</p>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</section>
<section id="sample-dataset-25" class="level2" data-number="25.2">
<h2 data-number="25.2" class="anchored" data-anchor-id="sample-dataset-25"><span class="header-section-number">25.2</span> Sample Dataset</h2>
<pre><code>57 71 154 185 301 332 415 429 486</code></pre>
</section>
<section id="sample-output-25" class="level2" data-number="25.3">
<h2 data-number="25.3" class="anchored" data-anchor-id="sample-output-25"><span class="header-section-number">25.3</span> Sample Output</h2>
<pre><code>0-&gt;57:G
0-&gt;71:A
57-&gt;154:P
57-&gt;185:K
71-&gt;185:N
154-&gt;301:F
185-&gt;332:F
301-&gt;415:N
301-&gt;429:K
332-&gt;429:P
415-&gt;486:A
429-&gt;486:G</code></pre>
</section>
<section id="solution-25" class="level2" data-number="25.4">
<h2 data-number="25.4" class="anchored" data-anchor-id="solution-25"><span class="header-section-number">25.4</span> Solution</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Amino acid weights dictionary</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>amino_acid_weights <span class="op">=</span> {</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'V'</span>: <span class="dv">99</span>,</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>,</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'W'</span>: <span class="dv">186</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectrum_graph(masses):</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reverse mapping of weights to amino acids</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>    weight_to_amino_acid <span class="op">=</span> {weight: aa <span class="cf">for</span> aa, weight <span class="kw">in</span> amino_acid_weights.items()}</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create graph based on mass differences</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(masses)):</span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(masses)):</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a>            difference <span class="op">=</span> masses[j] <span class="op">-</span> masses[i]</span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> difference <span class="kw">in</span> weight_to_amino_acid:</span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>                graph[masses[i]].append({<span class="st">"n"</span>: masses[j], <span class="st">"l"</span>: weight_to_amino_acid[difference]})</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"57 71 154 185 301 332 415 429 486"</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>masses <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, sample_input.split()))</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the spectrum graph</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_mass, edges <span class="kw">in</span> spectrum_graph(masses).items():</span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>start_mass<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>edge[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>edge[<span class="st">'l'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-motifenumeration" class="level1" data-number="26">
<h1 data-number="26"><span class="header-section-number">26</span> Implement MotifEnumeration</h1>
<p>Implanted Motif Problem. Implement MotifEnumeration (shown above) to find all (k, d)-motifs in a collection of strings.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;All (<em>k</em>,&nbsp;<em>d</em>)-motifs in&nbsp;<em>Dna</em>.</p>
<section id="sample-dataset-26" class="level2" data-number="26.1">
<h2 data-number="26.1" class="anchored" data-anchor-id="sample-dataset-26"><span class="header-section-number">26.1</span> Sample Dataset</h2>
<pre><code>3 1
ATTTGGC
TGCCTTA
CGGTATC
GAAAATT</code></pre>
</section>
<section id="sample-output-26" class="level2" data-number="26.2">
<h2 data-number="26.2" class="anchored" data-anchor-id="sample-output-26"><span class="header-section-number">26.2</span> Sample Output</h2>
<pre><code>ATA ATT GTT TTT</code></pre>
</section>
<section id="solution-26" class="level2" data-number="26.3">
<h2 data-number="26.3" class="anchored" data-anchor-id="solution-26"><span class="header-section-number">26.3</span> Solution</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Iterator</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>    neighbor_set <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance):</span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], neighbor) <span class="op">&lt;</span> max_distance:</span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a>                neighbor_set.add(nucleotide <span class="op">+</span> neighbor)</span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a>            neighbor_set.add(sequence[<span class="dv">0</span>] <span class="op">+</span> neighbor)</span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbor_set</span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_kmers(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(kmer <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length))</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> contains_approximate_match(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_distance </span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb81-32"><a href="#cb81-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-33"><a href="#cb81-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enumerate_motifs(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb81-34"><a href="#cb81-34" aria-hidden="true" tabindex="-1"></a>    motif_patterns <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb81-35"><a href="#cb81-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> get_all_kmers(dna_sequences, kmer_length):</span>
<span id="cb81-36"><a href="#cb81-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor_kmer <span class="kw">in</span> generate_neighbors(kmer, max_distance):</span>
<span id="cb81-37"><a href="#cb81-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(contains_approximate_match(neighbor_kmer, sequence, max_distance) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences):</span>
<span id="cb81-38"><a href="#cb81-38" aria-hidden="true" tabindex="-1"></a>                motif_patterns.add(neighbor_kmer)</span>
<span id="cb81-39"><a href="#cb81-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> motif_patterns</span>
<span id="cb81-40"><a href="#cb81-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-41"><a href="#cb81-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb81-42"><a href="#cb81-42" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb81-43"><a href="#cb81-43" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb81-44"><a href="#cb81-44" aria-hidden="true" tabindex="-1"></a><span class="st">ATTTGGC</span></span>
<span id="cb81-45"><a href="#cb81-45" aria-hidden="true" tabindex="-1"></a><span class="st">TGCCTTA</span></span>
<span id="cb81-46"><a href="#cb81-46" aria-hidden="true" tabindex="-1"></a><span class="st">CGGTATC</span></span>
<span id="cb81-47"><a href="#cb81-47" aria-hidden="true" tabindex="-1"></a><span class="st">GAAAATT</span></span>
<span id="cb81-48"><a href="#cb81-48" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb81-49"><a href="#cb81-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-50"><a href="#cb81-50" aria-hidden="true" tabindex="-1"></a>input_params, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb81-51"><a href="#cb81-51" aria-hidden="true" tabindex="-1"></a>kmer_length, max_distance <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_params.split())</span>
<span id="cb81-52"><a href="#cb81-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(enumerate_motifs(dna_sequences, kmer_length, max_distance)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-median-string" class="level1" data-number="27">
<h1 data-number="27"><span class="header-section-number">27</span> Find a Median String</h1>
<p>Median String Problem, Find a median string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>k</em>-mer&nbsp;<em>Pattern</em>&nbsp;that minimizes&nbsp;<em>d</em>(<em>Pattern</em>,&nbsp;<em>Dna</em>) over all&nbsp;<em>k</em>-mers&nbsp;<em>Pattern</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-27" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="sample-dataset-27"><span class="header-section-number">27.1</span> Sample Dataset</h2>
<pre><code>3
AAATTGACGCAT
GACGACCACGTT
CGTCAGCGCCTG
GCTGAGCACCGG
AGTACGGGACAG</code></pre>
</section>
<section id="sample-output-27" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="sample-output-27"><span class="header-section-number">27.2</span> Sample Output</h2>
<pre><code>ACG</code></pre>
</section>
<section id="solution-27" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="solution-27"><span class="header-section-number">27.3</span> Solution</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(nucleotides) <span class="cf">for</span> nucleotides <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(nucleotide1 <span class="op">!=</span> nucleotide2 <span class="cf">for</span> nucleotide1, nucleotide2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(substring, pattern) <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_total_distance(pattern: <span class="bu">str</span>, dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, sequence) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences)</span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_median_string(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>    min_distance <span class="op">=</span> math.inf</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a>    median_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>        current_distance <span class="op">=</span> calculate_total_distance(kmer, dna_sequences)</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_distance <span class="op">&lt;</span> min_distance:</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>            min_distance <span class="op">=</span> current_distance</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>            median_kmer <span class="op">=</span> kmer</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> median_kmer</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a><span class="st">AAATTGACGCAT</span></span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a><span class="st">GACGACCACGTT</span></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a><span class="st">CGTCAGCGCCTG</span></span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a><span class="st">GCTGAGCACCGG</span></span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a><span class="st">AGTACGGGACAG</span></span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>kmer_length, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_median_string(dna_sequences, <span class="bu">int</span>(kmer_length))</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-profile-most-probable-k-mer-in-a-string" class="level1" data-number="28">
<h1 data-number="28"><span class="header-section-number">28</span> Find a Profile-most Probable k-mer in a String</h1>
<p>Profile-most Probable&nbsp;<em>k</em>-mer Problem, Find a Profile-most probable k-mer in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>, an integer&nbsp;<em>k</em>, and a 4 ×&nbsp;<em>k</em>&nbsp;matrix&nbsp;<em>Profile</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-28" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="sample-dataset-28"><span class="header-section-number">28.1</span> Sample Dataset</h2>
<pre><code>ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT
5
0.2 0.2 0.3 0.2 0.3
0.4 0.3 0.1 0.5 0.1
0.3 0.3 0.5 0.2 0.4
0.1 0.2 0.1 0.1 0.2</code></pre>
</section>
<section id="sample-output-28" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="sample-output-28"><span class="header-section-number">28.2</span> Sample Output</h2>
<pre><code>CCGAG</code></pre>
</section>
<section id="solution-28" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="solution-28"><span class="header-section-number">28.3</span> Solution</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_profile_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile_matrix: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    nucleotide_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    max_probability <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length):</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>        kmer_probability <span class="op">=</span> math.prod(profile_matrix[nucleotide_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="st">ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a><span class="st">0.2 0.2 0.3 0.2 0.3</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.3 0.1 0.5 0.1</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="st">0.3 0.3 0.5 0.2 0.4</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a><span class="st">0.1 0.2 0.1 0.1 0.2</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, <span class="op">*</span>profile_rows <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>profile_matrix <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> profile_rows]</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_profile_most_probable_kmer(dna_sequence, <span class="bu">int</span>(kmer_length), profile_matrix)</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedymotifsearch" class="level1" data-number="29">
<h1 data-number="29"><span class="header-section-number">29</span> Implement GreedyMotifSearch</h1>
<p>Implement, GreedyMotifSearch.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection of strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GreedyMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>). If at any step you find more than one&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in a given string, use the one occurring first.</p>
<section id="sample-dataset-29" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="sample-dataset-29"><span class="header-section-number">29.1</span> Sample Dataset</h2>
<pre><code>3 5
GGCGTTCAGGCA
AAGAATCAGTCA
CAAGGAGTTCGC
CACGTCAATCAC
CAATAATATTCG</code></pre>
</section>
<section id="sample-output-29" class="level2" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="sample-output-29"><span class="header-section-number">29.2</span> Sample Output</h2>
<pre><code>CAG
CAG
CAA
CAA
CAA</code></pre>
</section>
<section id="solution-29" class="level2" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="solution-29"><span class="header-section-number">29.3</span> Solution</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>    max_probability: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length):</span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a>        kmer_probability: <span class="bu">float</span> <span class="op">=</span> math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(sequences: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>    profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> [[] <span class="cf">for</span> _ <span class="kw">in</span> nucleotides]</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(nucleotides):</span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>        profile[i] <span class="op">=</span> [</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> sequences) <span class="op">+</span> pseudocount) <span class="op">/</span> <span class="bu">len</span>(sequences)</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequences[<span class="dv">0</span>]))</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>])):</span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a>        column: List[<span class="bu">str</span>] <span class="op">=</span> [motif[i] <span class="cf">for</span> motif <span class="kw">in</span> motifs]</span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a>        most_common: <span class="bu">str</span> <span class="op">=</span> Counter(column).most_common()[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">sum</span>(nucleotide <span class="op">!=</span> most_common <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [seq[:kmer_length] <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(dna_sequences)):</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>            current_profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount<span class="op">=</span>pseudocount)</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(dna_sequences[i], kmer_length, current_profile))</span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a>ints, <span class="op">*</span>dna <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a>k, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, ints.split())</span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna, k)</span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedymotifsearch-with-pseudocounts" class="level1" data-number="30">
<h1 data-number="30"><span class="header-section-number">30</span> Implement GreedyMotifSearch with Pseudocounts</h1>
<p>Implement.&nbsp;<em>GreedyMotifSearch</em>&nbsp;with Pseudocounts.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection of strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GreedyMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>) with pseudocounts. If at any step you find more than one&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in a given string, use the one occurring first.</p>
<section id="sample-dataset-30" class="level2" data-number="30.1">
<h2 data-number="30.1" class="anchored" data-anchor-id="sample-dataset-30"><span class="header-section-number">30.1</span> Sample Dataset</h2>
<pre><code>3 5
GGCGTTCAGGCA
AAGAATCAGTCA
CAAGGAGTTCGC
CACGTCAATCAC
CAATAATATTCG</code></pre>
</section>
<section id="sample-output-30" class="level2" data-number="30.2">
<h2 data-number="30.2" class="anchored" data-anchor-id="sample-output-30"><span class="header-section-number">30.2</span> Sample Output</h2>
<pre><code>TTC
ATC
TTC
ATC
TTC</code></pre>
</section>
<section id="solution-30" class="level2" data-number="30.3">
<h2 data-number="30.3" class="anchored" data-anchor-id="solution-30"><span class="header-section-number">30.3</span> Solution</h2>
<div class="sourceCode" id="cb93"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][position] </span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">for</span> position, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-17"><a href="#cb93-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb93-18"><a href="#cb93-18" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb93-19"><a href="#cb93-19" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb93-20"><a href="#cb93-20" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb93-21"><a href="#cb93-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-22"><a href="#cb93-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb93-23"><a href="#cb93-23" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> motif_count </span>
<span id="cb93-24"><a href="#cb93-24" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb93-25"><a href="#cb93-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb93-26"><a href="#cb93-26" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb93-27"><a href="#cb93-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-28"><a href="#cb93-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb93-29"><a href="#cb93-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb93-30"><a href="#cb93-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb93-31"><a href="#cb93-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb93-32"><a href="#cb93-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb93-33"><a href="#cb93-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-34"><a href="#cb93-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb93-35"><a href="#cb93-35" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [sequence[:kmer_length] <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences]</span>
<span id="cb93-36"><a href="#cb93-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-37"><a href="#cb93-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb93-38"><a href="#cb93-38" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb93-39"><a href="#cb93-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences[<span class="dv">1</span>:]:</span>
<span id="cb93-40"><a href="#cb93-40" aria-hidden="true" tabindex="-1"></a>            profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount)</span>
<span id="cb93-41"><a href="#cb93-41" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(sequence, kmer_length, profile))</span>
<span id="cb93-42"><a href="#cb93-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb93-43"><a href="#cb93-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb93-44"><a href="#cb93-44" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb93-45"><a href="#cb93-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb93-46"><a href="#cb93-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb93-47"><a href="#cb93-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-48"><a href="#cb93-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb93-49"><a href="#cb93-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb93-50"><a href="#cb93-50" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb93-51"><a href="#cb93-51" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb93-52"><a href="#cb93-52" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb93-53"><a href="#cb93-53" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb93-54"><a href="#cb93-54" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb93-55"><a href="#cb93-55" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb93-56"><a href="#cb93-56" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb93-57"><a href="#cb93-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-58"><a href="#cb93-58" aria-hidden="true" tabindex="-1"></a>k_value, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb93-59"><a href="#cb93-59" aria-hidden="true" tabindex="-1"></a>k_value <span class="op">=</span> <span class="bu">int</span>(k_value)</span>
<span id="cb93-60"><a href="#cb93-60" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna_sequences, k_value, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb93-61"><a href="#cb93-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-randomizedmotifsearch" class="level1" data-number="31">
<h1 data-number="31"><span class="header-section-number">31</span> Implement RandomizedMotifSearch</h1>
<p>Implement&nbsp;<em>RandomizedMotifSearch</em>.</p>
<p>Given:&nbsp;Positive integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>RandomizedMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>) 1000 times. Remember to use pseudocounts!</p>
<section id="sample-dataset-31" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="sample-dataset-31"><span class="header-section-number">31.1</span> Sample Dataset</h2>
<pre><code>8 5
CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA
GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG
TAGTACCGAGACCGAAAGAAGTATACAGGCGT
TAGATCAAGTTTCAGGTGCACGTCGGTGAACC
AATCCACCAGCTCCACGTGCAATGTTGGCCTA</code></pre>
</section>
<section id="sample-output-31" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="sample-output-31"><span class="header-section-number">31.2</span> Sample Output</h2>
<pre><code>AACGGCCA
AAGTGCCA
TAGTACCG
AAGTTTCA
ACGTGCAA</code></pre>
</section>
<section id="solution-31" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="solution-31"><span class="header-section-number">31.3</span> Solution</h2>
<div class="sourceCode" id="cb96"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Callable</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> randint</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [sequence[i:i<span class="op">+</span>kmer_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][j] <span class="cf">for</span> j, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>    profile <span class="op">=</span> []</span>
<span id="cb96-19"><a href="#cb96-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb96-20"><a href="#cb96-20" aria-hidden="true" tabindex="-1"></a>        profile.append([</span>
<span id="cb96-21"><a href="#cb96-21" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (<span class="bu">len</span>(motifs) <span class="op">+</span> <span class="dv">4</span> <span class="op">*</span> pseudocount)</span>
<span id="cb96-22"><a href="#cb96-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>]))</span>
<span id="cb96-23"><a href="#cb96-23" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb96-24"><a href="#cb96-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb96-25"><a href="#cb96-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-26"><a href="#cb96-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb96-27"><a href="#cb96-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb96-28"><a href="#cb96-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb96-29"><a href="#cb96-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb96-30"><a href="#cb96-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb96-31"><a href="#cb96-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-32"><a href="#cb96-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb96-33"><a href="#cb96-33" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb96-34"><a href="#cb96-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start : start <span class="op">+</span> kmer_length]</span>
<span id="cb96-35"><a href="#cb96-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-36"><a href="#cb96-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_motifs(profile: List[List[<span class="bu">float</span>]], dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb96-37"><a href="#cb96-37" aria-hidden="true" tabindex="-1"></a>    kmer_length <span class="op">=</span> <span class="bu">len</span>(profile[<span class="dv">0</span>])</span>
<span id="cb96-38"><a href="#cb96-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [find_most_probable_kmer(seq, kmer_length, profile) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb96-39"><a href="#cb96-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-40"><a href="#cb96-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> randomized_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb96-41"><a href="#cb96-41" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb96-42"><a href="#cb96-42" aria-hidden="true" tabindex="-1"></a>    best_score <span class="op">=</span> math.inf</span>
<span id="cb96-43"><a href="#cb96-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-44"><a href="#cb96-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb96-45"><a href="#cb96-45" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb96-46"><a href="#cb96-46" aria-hidden="true" tabindex="-1"></a>        motifs <span class="op">=</span> find_motifs(profile, dna_sequences)</span>
<span id="cb96-47"><a href="#cb96-47" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> calculate_score(motifs)</span>
<span id="cb96-48"><a href="#cb96-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb96-49"><a href="#cb96-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;=</span> best_score:</span>
<span id="cb96-50"><a href="#cb96-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> best_score, motifs</span>
<span id="cb96-51"><a href="#cb96-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb96-52"><a href="#cb96-52" aria-hidden="true" tabindex="-1"></a>        best_score <span class="op">=</span> current_score</span>
<span id="cb96-53"><a href="#cb96-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-54"><a href="#cb96-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb96-55"><a href="#cb96-55" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb96-56"><a href="#cb96-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-57"><a href="#cb96-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb96-58"><a href="#cb96-58" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb96-59"><a href="#cb96-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb96-60"><a href="#cb96-60" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb96-61"><a href="#cb96-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb96-62"><a href="#cb96-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb96-63"><a href="#cb96-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-64"><a href="#cb96-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb96-65"><a href="#cb96-65" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb96-66"><a href="#cb96-66" aria-hidden="true" tabindex="-1"></a><span class="st">8 5</span></span>
<span id="cb96-67"><a href="#cb96-67" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span></span>
<span id="cb96-68"><a href="#cb96-68" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span></span>
<span id="cb96-69"><a href="#cb96-69" aria-hidden="true" tabindex="-1"></a><span class="st">TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span></span>
<span id="cb96-70"><a href="#cb96-70" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span></span>
<span id="cb96-71"><a href="#cb96-71" aria-hidden="true" tabindex="-1"></a><span class="st">AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span></span>
<span id="cb96-72"><a href="#cb96-72" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb96-73"><a href="#cb96-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-74"><a href="#cb96-74" aria-hidden="true" tabindex="-1"></a>kmer_length, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb96-75"><a href="#cb96-75" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb96-76"><a href="#cb96-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-77"><a href="#cb96-77" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(randomized_motif_search, <span class="dv">1000</span>, dna_sequences, kmer_length)</span>
<span id="cb96-78"><a href="#cb96-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-gibbssampler" class="level1" data-number="32">
<h1 data-number="32"><span class="header-section-number">32</span> Implement GibbsSampler</h1>
<p>Implement,&nbsp;<em>GibbsSampler</em>.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>,&nbsp;<em>t</em>, and&nbsp;<em>N</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;The strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GibbsSampler</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>,&nbsp;<em>N</em>) with 20 random starts. Remember to use pseudocounts!</p>
<section id="sample-dataset-32" class="level2" data-number="32.1">
<h2 data-number="32.1" class="anchored" data-anchor-id="sample-dataset-32"><span class="header-section-number">32.1</span> Sample Dataset</h2>
<pre><code>8 5 100
CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA
GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG
TAGTACCGAGACCGAAAGAAGTATACAGGCGT
TAGATCAAGTTTCAGGTGCACGTCGGTGAACC
AATCCACCAGCTCCACGTGCAATGTTGGCCTA</code></pre>
</section>
<section id="sample-output-32" class="level2" data-number="32.2">
<h2 data-number="32.2" class="anchored" data-anchor-id="sample-output-32"><span class="header-section-number">32.2</span> Sample Output</h2>
<pre><code>TCTCGGGG
CCAAGGTG
TACAGGCG
TTCAGGTG
TCCACGTG</code></pre>
</section>
<section id="solution-32" class="level2" data-number="32.3">
<h2 data-number="32.3" class="anchored" data-anchor-id="solution-32"><span class="header-section-number">32.3</span> Solution</h2>
<div class="sourceCode" id="cb99"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, Tuple, Callable</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-10"><a href="#cb99-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb99-11"><a href="#cb99-11" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb99-12"><a href="#cb99-12" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb99-13"><a href="#cb99-13" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb99-14"><a href="#cb99-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb99-15"><a href="#cb99-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb99-16"><a href="#cb99-16" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (motif_count <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>pseudocount)</span>
<span id="cb99-17"><a href="#cb99-17" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb99-18"><a href="#cb99-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb99-19"><a href="#cb99-19" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb99-20"><a href="#cb99-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-21"><a href="#cb99-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb99-22"><a href="#cb99-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb99-23"><a href="#cb99-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb99-24"><a href="#cb99-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb99-25"><a href="#cb99-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb99-26"><a href="#cb99-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-27"><a href="#cb99-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb99-28"><a href="#cb99-28" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb99-29"><a href="#cb99-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb99-30"><a href="#cb99-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-31"><a href="#cb99-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb99-32"><a href="#cb99-32" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb99-33"><a href="#cb99-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb99-34"><a href="#cb99-34" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb99-35"><a href="#cb99-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb99-36"><a href="#cb99-36" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb99-37"><a href="#cb99-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb99-38"><a href="#cb99-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-39"><a href="#cb99-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_probabilities(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb99-40"><a href="#cb99-40" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb99-41"><a href="#cb99-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb99-42"><a href="#cb99-42" aria-hidden="true" tabindex="-1"></a>        math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb99-43"><a href="#cb99-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length)</span>
<span id="cb99-44"><a href="#cb99-44" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb99-45"><a href="#cb99-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-46"><a href="#cb99-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb99-47"><a href="#cb99-47" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> calculate_kmer_probabilities(sequence, kmer_length, profile)</span>
<span id="cb99-48"><a href="#cb99-48" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.choices(<span class="bu">range</span>(<span class="bu">len</span>(probabilities)), probabilities)[<span class="dv">0</span>]</span>
<span id="cb99-49"><a href="#cb99-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb99-50"><a href="#cb99-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-51"><a href="#cb99-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gibbs_sampler(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, num_iterations: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb99-52"><a href="#cb99-52" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb99-53"><a href="#cb99-53" aria-hidden="true" tabindex="-1"></a>    best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb99-54"><a href="#cb99-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_iterations):</span>
<span id="cb99-55"><a href="#cb99-55" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(dna_sequences) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb99-56"><a href="#cb99-56" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs[:i] <span class="op">+</span> motifs[i <span class="op">+</span> <span class="dv">1</span> :], pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb99-57"><a href="#cb99-57" aria-hidden="true" tabindex="-1"></a>        motifs[i] <span class="op">=</span> select_random_kmer(dna_sequences[i], kmer_length, profile)</span>
<span id="cb99-58"><a href="#cb99-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb99-59"><a href="#cb99-59" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb99-60"><a href="#cb99-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> calculate_score(best_motifs), best_motifs</span>
<span id="cb99-61"><a href="#cb99-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-62"><a href="#cb99-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb99-63"><a href="#cb99-63" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb99-64"><a href="#cb99-64" aria-hidden="true" tabindex="-1"></a><span class="st">8 5 100</span></span>
<span id="cb99-65"><a href="#cb99-65" aria-hidden="true" tabindex="-1"></a><span class="st">TCTCGGGG</span></span>
<span id="cb99-66"><a href="#cb99-66" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGGTG</span></span>
<span id="cb99-67"><a href="#cb99-67" aria-hidden="true" tabindex="-1"></a><span class="st">TACAGGCG</span></span>
<span id="cb99-68"><a href="#cb99-68" aria-hidden="true" tabindex="-1"></a><span class="st">TTCAGGTG</span></span>
<span id="cb99-69"><a href="#cb99-69" aria-hidden="true" tabindex="-1"></a><span class="st">TCCACGTG</span></span>
<span id="cb99-70"><a href="#cb99-70" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb99-71"><a href="#cb99-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-72"><a href="#cb99-72" aria-hidden="true" tabindex="-1"></a>kmer_length, num_sequences, num_iterations, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb99-73"><a href="#cb99-73" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb99-74"><a href="#cb99-74" aria-hidden="true" tabindex="-1"></a>num_iterations <span class="op">=</span> <span class="bu">int</span>(num_iterations)</span>
<span id="cb99-75"><a href="#cb99-75" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(gibbs_sampler, <span class="dv">20</span>, dna_sequences, kmer_length, num_iterations)</span>
<span id="cb99-76"><a href="#cb99-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-distancebetweenpatternandstrings" class="level1" data-number="33">
<h1 data-number="33"><span class="header-section-number">33</span> Implement DistanceBetweenPatternAndStrings</h1>
<p>Compute DistanceBetweenPatternAndStrings. <em>Find the distance between a pattern and a set of strings.</em>.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>&nbsp;and a collection of DNA strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;<em>DistanceBetweenPatternAndStrings</em>(<em>Pattern</em>,&nbsp;<em>Dna</em>).</p>
<section id="sample-dataset-33" class="level2" data-number="33.1">
<h2 data-number="33.1" class="anchored" data-anchor-id="sample-dataset-33"><span class="header-section-number">33.1</span> Sample Dataset</h2>
<pre><code>AAA
TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</code></pre>
</section>
<section id="sample-output-33" class="level2" data-number="33.2">
<h2 data-number="33.2" class="anchored" data-anchor-id="sample-output-33"><span class="header-section-number">33.2</span> Sample Output</h2>
<pre><code>5</code></pre>
</section>
<section id="solution-33" class="level2" data-number="33.3">
<h2 data-number="33.3" class="anchored" data-anchor-id="solution-33"><span class="header-section-number">33.3</span> Solution</h2>
<div class="sourceCode" id="cb102"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb102-9"><a href="#cb102-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb102-10"><a href="#cb102-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-11"><a href="#cb102-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb102-12"><a href="#cb102-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(kmer, pattern) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb102-13"><a href="#cb102-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-14"><a href="#cb102-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_pattern_distance_to_strings(pattern: <span class="bu">str</span>, dna_strings: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb102-15"><a href="#cb102-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, dna_string) <span class="cf">for</span> dna_string <span class="kw">in</span> dna_strings)</span>
<span id="cb102-16"><a href="#cb102-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-17"><a href="#cb102-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb102-18"><a href="#cb102-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb102-19"><a href="#cb102-19" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb102-20"><a href="#cb102-20" aria-hidden="true" tabindex="-1"></a><span class="st">TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span></span>
<span id="cb102-21"><a href="#cb102-21" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb102-22"><a href="#cb102-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-23"><a href="#cb102-23" aria-hidden="true" tabindex="-1"></a>pattern, dna_strings_raw <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb102-24"><a href="#cb102-24" aria-hidden="true" tabindex="-1"></a>dna_strings <span class="op">=</span> dna_strings_raw.split()</span>
<span id="cb102-25"><a href="#cb102-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-26"><a href="#cb102-26" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_pattern_distance_to_strings(pattern, dna_strings)</span>
<span id="cb102-27"><a href="#cb102-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-k-mer-composition-of-a-string" class="level1" data-number="34">
<h1 data-number="34"><span class="header-section-number">34</span> Generate the k-mer Composition of a String</h1>
<p>String Composition Problem, Generate the k-mer composition of a string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;_Composition__k_(<em>Text</em>) (the&nbsp;<em>k</em>-mers can be provided in any order).</p>
<section id="sample-dataset-34" class="level2" data-number="34.1">
<h2 data-number="34.1" class="anchored" data-anchor-id="sample-dataset-34"><span class="header-section-number">34.1</span> Sample Dataset</h2>
<pre><code>5
CAATCCAAC</code></pre>
</section>
<section id="sample-output-34" class="level2" data-number="34.2">
<h2 data-number="34.2" class="anchored" data-anchor-id="sample-output-34"><span class="header-section-number">34.2</span> Sample Output</h2>
<pre><code>CAATC
AATCC
ATCCA
TCCAA
CCAAC</code></pre>
</section>
<section id="solution-34" class="level2" data-number="34.3">
<h2 data-number="34.3" class="anchored" data-anchor-id="solution-34"><span class="header-section-number">34.3</span> Solution</h2>
<div class="sourceCode" id="cb105"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i:i <span class="op">+</span> kmer_length]</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a><span class="st">CAATCCAAC</span></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>input_lines: <span class="bu">list</span>[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb105-15"><a href="#cb105-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-16"><a href="#cb105-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequence, kmer_length):</span>
<span id="cb105-17"><a href="#cb105-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-genome-path" class="level1" data-number="35">
<h1 data-number="35"><span class="header-section-number">35</span> Reconstruct a String from its Genome Path</h1>
<p>String Spelled by a Genome Path Problem, Find the string spelled by a genome path.</p>
<p>Given:&nbsp;A sequence of&nbsp;<em>k</em>-mers&nbsp;<em>Pattern1, … , Patternn</em>&nbsp;such that the last&nbsp;<em>k - 1</em>&nbsp;symbols of&nbsp;<em>Patterni</em>&nbsp;are equal to the first&nbsp;<em>k - 1</em>&nbsp;symbols of&nbsp;<em>Patterni+1</em>&nbsp;for&nbsp;<em>i</em>&nbsp;from 1 to n-1.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;of length&nbsp;<em>k+n-1</em>&nbsp;where the&nbsp;<em>i</em>-th&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>&nbsp;is equal to&nbsp;<em>Patterni</em>&nbsp;for all&nbsp;<em>i</em>.</p>
<section id="sample-dataset-35" class="level2" data-number="35.1">
<h2 data-number="35.1" class="anchored" data-anchor-id="sample-dataset-35"><span class="header-section-number">35.1</span> Sample Dataset</h2>
<pre><code>ACCGA
CCGAA
CGAAG
GAAGC
AAGCT</code></pre>
</section>
<section id="sample-output-35" class="level2" data-number="35.2">
<h2 data-number="35.2" class="anchored" data-anchor-id="sample-output-35"><span class="header-section-number">35.2</span> Sample Output</h2>
<pre><code>ACCGAAGCT</code></pre>
</section>
<section id="solution-35" class="level2" data-number="35.3">
<h2 data-number="35.3" class="anchored" data-anchor-id="solution-35"><span class="header-section-number">35.3</span> Solution</h2>
<div class="sourceCode" id="cb108"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_dna_sequence(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>    reconstructed_sequence: <span class="bu">str</span> <span class="op">=</span> kmers[<span class="dv">0</span>]</span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(kmers)):</span>
<span id="cb108-6"><a href="#cb108-6" aria-hidden="true" tabindex="-1"></a>        reconstructed_sequence <span class="op">+=</span> kmers[i][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb108-7"><a href="#cb108-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_sequence</span>
<span id="cb108-8"><a href="#cb108-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-9"><a href="#cb108-9" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb108-10"><a href="#cb108-10" aria-hidden="true" tabindex="-1"></a><span class="st">ACCGA</span></span>
<span id="cb108-11"><a href="#cb108-11" aria-hidden="true" tabindex="-1"></a><span class="st">CCGAA</span></span>
<span id="cb108-12"><a href="#cb108-12" aria-hidden="true" tabindex="-1"></a><span class="st">CGAAG</span></span>
<span id="cb108-13"><a href="#cb108-13" aria-hidden="true" tabindex="-1"></a><span class="st">GAAGC</span></span>
<span id="cb108-14"><a href="#cb108-14" aria-hidden="true" tabindex="-1"></a><span class="st">AAGCT</span></span>
<span id="cb108-15"><a href="#cb108-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb108-16"><a href="#cb108-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-17"><a href="#cb108-17" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb108-18"><a href="#cb108-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_dna_sequence(kmer_list))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-overlap-graph-of-a-collection-of-k-mers" class="level1" data-number="36">
<h1 data-number="36"><span class="header-section-number">36</span> Construct the Overlap Graph of a Collection of k-mers</h1>
<p>Overlap Graph Problem, Construct the overlap graph of a collection of k-mers.</p>
<p>Given:&nbsp;A collection&nbsp;<em>Patterns</em>&nbsp;of&nbsp;<em>k</em>-mers.</p>
<p>Return:&nbsp;The overlap graph&nbsp;<em>Overlap</em>(<em>Patterns</em>), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-36" class="level2" data-number="36.1">
<h2 data-number="36.1" class="anchored" data-anchor-id="sample-dataset-36"><span class="header-section-number">36.1</span> Sample Dataset</h2>
<pre><code>ATGCG
GCATG
CATGC
AGGCA
GGCAT</code></pre>
</section>
<section id="sample-output-36" class="level2" data-number="36.2">
<h2 data-number="36.2" class="anchored" data-anchor-id="sample-output-36"><span class="header-section-number">36.2</span> Sample Output</h2>
<pre><code>GCATG -&gt; CATGC
CATGC -&gt; ATGCG
AGGCA -&gt; GGCAT
GGCAT -&gt; GCATG</code></pre>
</section>
<section id="solution-36" class="level2" data-number="36.3">
<h2 data-number="36.3" class="anchored" data-anchor-id="solution-36"><span class="header-section-number">36.3</span> Solution</h2>
<div class="sourceCode" id="cb111"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> overlap_graph(patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>]]:</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>    adj_list <span class="op">=</span> []</span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb111-6"><a href="#cb111-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb111-7"><a href="#cb111-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j <span class="kw">and</span> patterns[i][<span class="dv">1</span>:] <span class="op">==</span> patterns[j][:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb111-8"><a href="#cb111-8" aria-hidden="true" tabindex="-1"></a>                adj_list.append((patterns[i], patterns[j]))</span>
<span id="cb111-9"><a href="#cb111-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adj_list</span>
<span id="cb111-10"><a href="#cb111-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-11"><a href="#cb111-11" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb111-12"><a href="#cb111-12" aria-hidden="true" tabindex="-1"></a><span class="st">ATGCG</span></span>
<span id="cb111-13"><a href="#cb111-13" aria-hidden="true" tabindex="-1"></a><span class="st">GCATG</span></span>
<span id="cb111-14"><a href="#cb111-14" aria-hidden="true" tabindex="-1"></a><span class="st">CATGC</span></span>
<span id="cb111-15"><a href="#cb111-15" aria-hidden="true" tabindex="-1"></a><span class="st">AGGCA</span></span>
<span id="cb111-16"><a href="#cb111-16" aria-hidden="true" tabindex="-1"></a><span class="st">GGCAT</span></span>
<span id="cb111-17"><a href="#cb111-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb111-18"><a href="#cb111-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-19"><a href="#cb111-19" aria-hidden="true" tabindex="-1"></a>Patterns: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb111-20"><a href="#cb111-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-21"><a href="#cb111-21" aria-hidden="true" tabindex="-1"></a>adj_list <span class="op">=</span> overlap_graph(Patterns)</span>
<span id="cb111-22"><a href="#cb111-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> adj_list:</span>
<span id="cb111-23"><a href="#cb111-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>edge[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>edge[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-de-bruijn-graph-of-a-string" class="level1" data-number="37">
<h1 data-number="37"><span class="header-section-number">37</span> Construct the De Bruijn Graph of a String</h1>
<p>De Bruijn Graph from a String Problem. Construct the de Bruijn graph of a string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a string&nbsp;<em>Text</em>.</p>
<p>Return:_DeBruijn__k_(<em>Text</em>), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-37" class="level2" data-number="37.1">
<h2 data-number="37.1" class="anchored" data-anchor-id="sample-dataset-37"><span class="header-section-number">37.1</span> Sample Dataset</h2>
<pre><code>4
AAGATTCTCTAC</code></pre>
</section>
<section id="sample-output-37" class="level2" data-number="37.2">
<h2 data-number="37.2" class="anchored" data-anchor-id="sample-output-37"><span class="header-section-number">37.2</span> Sample Output</h2>
<pre><code>AAG -&gt; AGA
AGA -&gt; GAT
ATT -&gt; TTC
CTA -&gt; TAC
CTC -&gt; TCT
GAT -&gt; ATT
TCT -&gt; CTA,CTC
TTC -&gt; TCT</code></pre>
</section>
<section id="solution-37" class="level2" data-number="37.3">
<h2 data-number="37.3" class="anchored" data-anchor-id="solution-37"><span class="header-section-number">37.3</span> Solution</h2>
<div class="sourceCode" id="cb114"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, OrderedDict <span class="im">as</span> OrderedDictType</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]]:</span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>    adjacency_list: OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]] <span class="op">=</span> OrderedDict()</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">2</span>):</span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>        adjacency_list[sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb114-9"><a href="#cb114-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-10"><a href="#cb114-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb114-11"><a href="#cb114-11" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb114-12"><a href="#cb114-12" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:i <span class="op">+</span> kmer_length]</span>
<span id="cb114-13"><a href="#cb114-13" aria-hidden="true" tabindex="-1"></a>        adjacency_list[prefix].add(suffix)</span>
<span id="cb114-14"><a href="#cb114-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-15"><a href="#cb114-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb114-16"><a href="#cb114-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-17"><a href="#cb114-17" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb114-18"><a href="#cb114-18" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb114-19"><a href="#cb114-19" aria-hidden="true" tabindex="-1"></a><span class="st">AAGATTCTCTAC</span></span>
<span id="cb114-20"><a href="#cb114-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb114-21"><a href="#cb114-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-22"><a href="#cb114-22" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb114-23"><a href="#cb114-23" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb114-24"><a href="#cb114-24" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb114-25"><a href="#cb114-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-26"><a href="#cb114-26" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(dna_sequence, kmer_length)</span>
<span id="cb114-27"><a href="#cb114-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb114-28"><a href="#cb114-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> neighbors:</span>
<span id="cb114-29"><a href="#cb114-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-de-bruijn-graph-of-a-collection-of-k-mers" class="level1" data-number="38">
<h1 data-number="38"><span class="header-section-number">38</span> Construct the De Bruijn Graph of a Collection of k-mers</h1>
<p>De Bruijn Graph from&nbsp;<em>k</em>-mers Problem. Construct the de Bruijn graph from a collection of k-mers.</p>
<p>Given:&nbsp;A collection of&nbsp;<em>k</em>-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;The de Bruijn graph&nbsp;<em>DeBruijn</em>(<em>Patterns</em>), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-38" class="level2" data-number="38.1">
<h2 data-number="38.1" class="anchored" data-anchor-id="sample-dataset-38"><span class="header-section-number">38.1</span> Sample Dataset</h2>
<pre><code>GAGG
CAGG
GGGG
GGGA
CAGG
AGGG
GGAG</code></pre>
</section>
<section id="sample-output-38" class="level2" data-number="38.2">
<h2 data-number="38.2" class="anchored" data-anchor-id="sample-output-38"><span class="header-section-number">38.2</span> Sample Output</h2>
<pre><code>GAG -&gt; AGG
CAG -&gt; AGG,AGG
GGG -&gt; GGG,GGA
AGG -&gt; GGG
GGA -&gt; GAG</code></pre>
</section>
<section id="solution-38" class="level2" data-number="38.3">
<h2 data-number="38.3" class="anchored" data-anchor-id="solution-38"><span class="header-section-number">38.3</span> Solution</h2>
<div class="sourceCode" id="cb117"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_list:</span>
<span id="cb117-9"><a href="#cb117-9" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb117-10"><a href="#cb117-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb117-11"><a href="#cb117-11" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix].append(suffix)</span>
<span id="cb117-12"><a href="#cb117-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb117-13"><a href="#cb117-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-14"><a href="#cb117-14" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb117-15"><a href="#cb117-15" aria-hidden="true" tabindex="-1"></a><span class="st">GAGG</span></span>
<span id="cb117-16"><a href="#cb117-16" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb117-17"><a href="#cb117-17" aria-hidden="true" tabindex="-1"></a><span class="st">GGGG</span></span>
<span id="cb117-18"><a href="#cb117-18" aria-hidden="true" tabindex="-1"></a><span class="st">GGGA</span></span>
<span id="cb117-19"><a href="#cb117-19" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb117-20"><a href="#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="st">AGGG</span></span>
<span id="cb117-21"><a href="#cb117-21" aria-hidden="true" tabindex="-1"></a><span class="st">GGAG</span></span>
<span id="cb117-22"><a href="#cb117-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb117-23"><a href="#cb117-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-24"><a href="#cb117-24" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb117-25"><a href="#cb117-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-26"><a href="#cb117-26" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmer_list)</span>
<span id="cb117-27"><a href="#cb117-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb117-28"><a href="#cb117-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-an-eulerian-cycle-in-a-graph" class="level1" data-number="39">
<h1 data-number="39"><span class="header-section-number">39</span> Find an Eulerian Cycle in a Graph</h1>
<p>Eulerian Cycle Problem, Find an Eulerian cycle in a graph.</p>
<p>Given:&nbsp;An Eulerian directed graph, in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<p>Return:&nbsp;An&nbsp;<a href="https://rosalind.info/glossary/eulerian-cycle/">Eulerian cycle</a>&nbsp;in this graph.</p>
<section id="sample-dataset-39" class="level2" data-number="39.1">
<h2 data-number="39.1" class="anchored" data-anchor-id="sample-dataset-39"><span class="header-section-number">39.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; 3
1 -&gt; 0
2 -&gt; 1,6
3 -&gt; 2
4 -&gt; 2
5 -&gt; 4
6 -&gt; 5,8
7 -&gt; 9
8 -&gt; 7
9 -&gt; 6</code></pre>
</section>
<section id="sample-output-39" class="level2" data-number="39.2">
<h2 data-number="39.2" class="anchored" data-anchor-id="sample-output-39"><span class="header-section-number">39.2</span> Sample Output</h2>
<pre><code>6-&gt;8-&gt;7-&gt;9-&gt;6-&gt;5-&gt;4-&gt;2-&gt;1-&gt;0-&gt;3-&gt;2-&gt;6</code></pre>
</section>
<section id="solution-39" class="level2" data-number="39.3">
<h2 data-number="39.3" class="anchored" data-anchor-id="solution-39"><span class="header-section-number">39.3</span> Solution</h2>
<div class="sourceCode" id="cb120"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_list_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb120-6"><a href="#cb120-6" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb120-7"><a href="#cb120-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> element <span class="kw">in</span> adjacency_list_text:</span>
<span id="cb120-8"><a href="#cb120-8" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, element)</span>
<span id="cb120-9"><a href="#cb120-9" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb120-10"><a href="#cb120-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb120-11"><a href="#cb120-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-12"><a href="#cb120-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb120-13"><a href="#cb120-13" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb120-14"><a href="#cb120-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb120-15"><a href="#cb120-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb120-16"><a href="#cb120-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb120-17"><a href="#cb120-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-18"><a href="#cb120-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb120-19"><a href="#cb120-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Form a cycle by randomly walking in the graph</span></span>
<span id="cb120-20"><a href="#cb120-20" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb120-21"><a href="#cb120-21" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb120-22"><a href="#cb120-22" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb120-23"><a href="#cb120-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-24"><a href="#cb120-24" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb120-25"><a href="#cb120-25" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb120-26"><a href="#cb120-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb120-27"><a href="#cb120-27" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb120-28"><a href="#cb120-28" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb120-29"><a href="#cb120-29" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb120-30"><a href="#cb120-30" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb120-31"><a href="#cb120-31" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb120-32"><a href="#cb120-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-33"><a href="#cb120-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb120-34"><a href="#cb120-34" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb120-35"><a href="#cb120-35" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb120-36"><a href="#cb120-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-37"><a href="#cb120-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Form new_cycle by traversing cycle (starting at new_start) and then randomly walking</span></span>
<span id="cb120-38"><a href="#cb120-38" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb120-39"><a href="#cb120-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-40"><a href="#cb120-40" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb120-41"><a href="#cb120-41" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb120-42"><a href="#cb120-42" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb120-43"><a href="#cb120-43" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb120-44"><a href="#cb120-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb120-45"><a href="#cb120-45" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb120-46"><a href="#cb120-46" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb120-47"><a href="#cb120-47" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb120-48"><a href="#cb120-48" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb120-49"><a href="#cb120-49" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb120-50"><a href="#cb120-50" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb120-51"><a href="#cb120-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb120-52"><a href="#cb120-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-53"><a href="#cb120-53" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb120-54"><a href="#cb120-54" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 3</span></span>
<span id="cb120-55"><a href="#cb120-55" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 0</span></span>
<span id="cb120-56"><a href="#cb120-56" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1,6</span></span>
<span id="cb120-57"><a href="#cb120-57" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 2</span></span>
<span id="cb120-58"><a href="#cb120-58" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb120-59"><a href="#cb120-59" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 4</span></span>
<span id="cb120-60"><a href="#cb120-60" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 5,8</span></span>
<span id="cb120-61"><a href="#cb120-61" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 9</span></span>
<span id="cb120-62"><a href="#cb120-62" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 7</span></span>
<span id="cb120-63"><a href="#cb120-63" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb120-64"><a href="#cb120-64" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb120-65"><a href="#cb120-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-66"><a href="#cb120-66" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb120-67"><a href="#cb120-67" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb120-68"><a href="#cb120-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-69"><a href="#cb120-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_cycle(adjacency_list)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-an-eulerian-path-in-a-graph" class="level1" data-number="40">
<h1 data-number="40"><span class="header-section-number">40</span> Find an Eulerian Path in a Graph</h1>
<p>Eulerian Path Problem, Find an Eulerian path in a graph.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/directed-graph/">directed graph</a>&nbsp;that contains an Eulerian path, where the graph is given in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<p>Return:&nbsp;An Eulerian path in this graph.</p>
<section id="sample-dataset-40" class="level2" data-number="40.1">
<h2 data-number="40.1" class="anchored" data-anchor-id="sample-dataset-40"><span class="header-section-number">40.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; 2
1 -&gt; 3
2 -&gt; 1
3 -&gt; 0,4
6 -&gt; 3,7
7 -&gt; 8
8 -&gt; 9
9 -&gt; 6</code></pre>
</section>
<section id="sample-output-40" class="level2" data-number="40.2">
<h2 data-number="40.2" class="anchored" data-anchor-id="sample-output-40"><span class="header-section-number">40.2</span> Sample Output</h2>
<pre><code>6-&gt;7-&gt;8-&gt;9-&gt;6-&gt;3-&gt;0-&gt;2-&gt;1-&gt;3-&gt;4</code></pre>
</section>
<section id="solution-40" class="level2" data-number="40.3">
<h2 data-number="40.3" class="anchored" data-anchor-id="solution-40"><span class="header-section-number">40.3</span> Solution</h2>
<div class="sourceCode" id="cb123"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb123-15"><a href="#cb123-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb123-16"><a href="#cb123-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb123-17"><a href="#cb123-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-18"><a href="#cb123-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb123-19"><a href="#cb123-19" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb123-20"><a href="#cb123-20" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb123-21"><a href="#cb123-21" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb123-22"><a href="#cb123-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-23"><a href="#cb123-23" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb123-24"><a href="#cb123-24" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb123-25"><a href="#cb123-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb123-26"><a href="#cb123-26" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb123-27"><a href="#cb123-27" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb123-28"><a href="#cb123-28" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb123-29"><a href="#cb123-29" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb123-30"><a href="#cb123-30" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb123-31"><a href="#cb123-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-32"><a href="#cb123-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb123-33"><a href="#cb123-33" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb123-34"><a href="#cb123-34" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb123-35"><a href="#cb123-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-36"><a href="#cb123-36" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb123-37"><a href="#cb123-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-38"><a href="#cb123-38" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb123-39"><a href="#cb123-39" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb123-40"><a href="#cb123-40" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb123-41"><a href="#cb123-41" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb123-42"><a href="#cb123-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb123-43"><a href="#cb123-43" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb123-44"><a href="#cb123-44" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb123-45"><a href="#cb123-45" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb123-46"><a href="#cb123-46" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb123-47"><a href="#cb123-47" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb123-48"><a href="#cb123-48" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb123-49"><a href="#cb123-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb123-50"><a href="#cb123-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-51"><a href="#cb123-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb123-52"><a href="#cb123-52" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb123-53"><a href="#cb123-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb123-54"><a href="#cb123-54" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb123-55"><a href="#cb123-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb123-56"><a href="#cb123-56" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb123-57"><a href="#cb123-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-58"><a href="#cb123-58" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb123-59"><a href="#cb123-59" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb123-60"><a href="#cb123-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb123-61"><a href="#cb123-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb123-62"><a href="#cb123-62" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb123-63"><a href="#cb123-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb123-64"><a href="#cb123-64" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb123-65"><a href="#cb123-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-66"><a href="#cb123-66" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb123-67"><a href="#cb123-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb123-68"><a href="#cb123-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb123-69"><a href="#cb123-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb123-70"><a href="#cb123-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-71"><a href="#cb123-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb123-72"><a href="#cb123-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-73"><a href="#cb123-73" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb123-74"><a href="#cb123-74" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 2</span></span>
<span id="cb123-75"><a href="#cb123-75" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 3</span></span>
<span id="cb123-76"><a href="#cb123-76" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1</span></span>
<span id="cb123-77"><a href="#cb123-77" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 0,4</span></span>
<span id="cb123-78"><a href="#cb123-78" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 3,7</span></span>
<span id="cb123-79"><a href="#cb123-79" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 8</span></span>
<span id="cb123-80"><a href="#cb123-80" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 9</span></span>
<span id="cb123-81"><a href="#cb123-81" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb123-82"><a href="#cb123-82" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb123-83"><a href="#cb123-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-84"><a href="#cb123-84" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb123-85"><a href="#cb123-85" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb123-86"><a href="#cb123-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-87"><a href="#cb123-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_path(adjacency_list)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-k-mer-composition" class="level1" data-number="41">
<h1 data-number="41"><span class="header-section-number">41</span> Reconstruct a String from its k-mer Composition</h1>
<p>String Reconstruction Problem. Reconstruct a string from its k-mer composition.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;followed by a list of&nbsp;<em>k</em>-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;with&nbsp;<em>k</em>-mer composition equal to&nbsp;<em>Patterns</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-41" class="level2" data-number="41.1">
<h2 data-number="41.1" class="anchored" data-anchor-id="sample-dataset-41"><span class="header-section-number">41.1</span> Sample Dataset</h2>
<pre><code>4
CTTA
ACCA
TACC
GGCT
GCTT
TTAC</code></pre>
</section>
<section id="sample-output-41" class="level2" data-number="41.2">
<h2 data-number="41.2" class="anchored" data-anchor-id="sample-output-41"><span class="header-section-number">41.2</span> Sample Output</h2>
<pre><code>GGCTTACCA</code></pre>
</section>
<section id="solution-41" class="level2" data-number="41.3">
<h2 data-number="41.3" class="anchored" data-anchor-id="solution-41"><span class="header-section-number">41.3</span> Solution</h2>
<div class="sourceCode" id="cb126"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb126-6"><a href="#cb126-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb126-7"><a href="#cb126-7" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb126-8"><a href="#cb126-8" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb126-9"><a href="#cb126-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb126-10"><a href="#cb126-10" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb126-11"><a href="#cb126-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb126-12"><a href="#cb126-12" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb126-13"><a href="#cb126-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb126-14"><a href="#cb126-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-15"><a href="#cb126-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb126-16"><a href="#cb126-16" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb126-17"><a href="#cb126-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb126-18"><a href="#cb126-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb126-19"><a href="#cb126-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb126-20"><a href="#cb126-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-21"><a href="#cb126-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb126-22"><a href="#cb126-22" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb126-23"><a href="#cb126-23" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb126-24"><a href="#cb126-24" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb126-25"><a href="#cb126-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-26"><a href="#cb126-26" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb126-27"><a href="#cb126-27" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb126-28"><a href="#cb126-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb126-29"><a href="#cb126-29" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb126-30"><a href="#cb126-30" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb126-31"><a href="#cb126-31" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb126-32"><a href="#cb126-32" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb126-33"><a href="#cb126-33" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb126-34"><a href="#cb126-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-35"><a href="#cb126-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb126-36"><a href="#cb126-36" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb126-37"><a href="#cb126-37" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb126-38"><a href="#cb126-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-39"><a href="#cb126-39" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb126-40"><a href="#cb126-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-41"><a href="#cb126-41" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb126-42"><a href="#cb126-42" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb126-43"><a href="#cb126-43" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb126-44"><a href="#cb126-44" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb126-45"><a href="#cb126-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb126-46"><a href="#cb126-46" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb126-47"><a href="#cb126-47" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb126-48"><a href="#cb126-48" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb126-49"><a href="#cb126-49" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb126-50"><a href="#cb126-50" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb126-51"><a href="#cb126-51" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb126-52"><a href="#cb126-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb126-53"><a href="#cb126-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-54"><a href="#cb126-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb126-55"><a href="#cb126-55" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb126-56"><a href="#cb126-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb126-57"><a href="#cb126-57" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb126-58"><a href="#cb126-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb126-59"><a href="#cb126-59" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb126-60"><a href="#cb126-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-61"><a href="#cb126-61" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb126-62"><a href="#cb126-62" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb126-63"><a href="#cb126-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb126-64"><a href="#cb126-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb126-65"><a href="#cb126-65" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb126-66"><a href="#cb126-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb126-67"><a href="#cb126-67" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb126-68"><a href="#cb126-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-69"><a href="#cb126-69" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb126-70"><a href="#cb126-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb126-71"><a href="#cb126-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb126-72"><a href="#cb126-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb126-73"><a href="#cb126-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-74"><a href="#cb126-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb126-75"><a href="#cb126-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-76"><a href="#cb126-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb126-77"><a href="#cb126-77" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb126-78"><a href="#cb126-78" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(adjacency_list)</span>
<span id="cb126-79"><a href="#cb126-79" aria-hidden="true" tabindex="-1"></a>    reconstructed_string <span class="op">=</span> path[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb126-80"><a href="#cb126-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> path:</span>
<span id="cb126-81"><a href="#cb126-81" aria-hidden="true" tabindex="-1"></a>        reconstructed_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb126-82"><a href="#cb126-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_string</span>
<span id="cb126-83"><a href="#cb126-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-84"><a href="#cb126-84" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb126-85"><a href="#cb126-85" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb126-86"><a href="#cb126-86" aria-hidden="true" tabindex="-1"></a><span class="st">CTTA</span></span>
<span id="cb126-87"><a href="#cb126-87" aria-hidden="true" tabindex="-1"></a><span class="st">ACCA</span></span>
<span id="cb126-88"><a href="#cb126-88" aria-hidden="true" tabindex="-1"></a><span class="st">TACC</span></span>
<span id="cb126-89"><a href="#cb126-89" aria-hidden="true" tabindex="-1"></a><span class="st">GGCT</span></span>
<span id="cb126-90"><a href="#cb126-90" aria-hidden="true" tabindex="-1"></a><span class="st">GCTT</span></span>
<span id="cb126-91"><a href="#cb126-91" aria-hidden="true" tabindex="-1"></a><span class="st">TTAC</span></span>
<span id="cb126-92"><a href="#cb126-92" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb126-93"><a href="#cb126-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-94"><a href="#cb126-94" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb126-95"><a href="#cb126-95" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb126-96"><a href="#cb126-96" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb126-97"><a href="#cb126-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb126-98"><a href="#cb126-98" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string(kmers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-k-universal-circular-string" class="level1" data-number="42">
<h1 data-number="42"><span class="header-section-number">42</span> Find a k-Universal Circular String</h1>
<p><em>k</em>-Universal Circular String Problem. Find a k-universal circular binary string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>k</em>-universal circular string. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-42" class="level2" data-number="42.1">
<h2 data-number="42.1" class="anchored" data-anchor-id="sample-dataset-42"><span class="header-section-number">42.1</span> Sample Dataset</h2>
<p><code>4</code></p>
</section>
<section id="sample-output-42" class="level2" data-number="42.2">
<h2 data-number="42.2" class="anchored" data-anchor-id="sample-output-42"><span class="header-section-number">42.2</span> Sample Output</h2>
<pre><code>1111010010110000</code></pre>
</section>
<section id="solution-42" class="level2" data-number="42.3">
<h2 data-number="42.3" class="anchored" data-anchor-id="solution-42"><span class="header-section-number">42.3</span> Solution</h2>
<div class="sourceCode" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb128-33"><a href="#cb128-33" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb128-34"><a href="#cb128-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-35"><a href="#cb128-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb128-36"><a href="#cb128-36" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb128-37"><a href="#cb128-37" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb128-38"><a href="#cb128-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-39"><a href="#cb128-39" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb128-40"><a href="#cb128-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-41"><a href="#cb128-41" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb128-42"><a href="#cb128-42" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb128-43"><a href="#cb128-43" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb128-44"><a href="#cb128-44" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb128-45"><a href="#cb128-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb128-46"><a href="#cb128-46" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb128-47"><a href="#cb128-47" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb128-48"><a href="#cb128-48" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb128-49"><a href="#cb128-49" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb128-50"><a href="#cb128-50" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb128-51"><a href="#cb128-51" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb128-52"><a href="#cb128-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb128-53"><a href="#cb128-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-54"><a href="#cb128-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_k_universal_circular_string(k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb128-55"><a href="#cb128-55" aria-hidden="true" tabindex="-1"></a>    kmers: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb128-56"><a href="#cb128-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span> <span class="op">**</span> k):</span>
<span id="cb128-57"><a href="#cb128-57" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> <span class="bu">format</span>(i, <span class="ss">f'0</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">b'</span>)</span>
<span id="cb128-58"><a href="#cb128-58" aria-hidden="true" tabindex="-1"></a>        kmers.append(kmer)</span>
<span id="cb128-59"><a href="#cb128-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-60"><a href="#cb128-60" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb128-61"><a href="#cb128-61" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(adjacency_list)</span>
<span id="cb128-62"><a href="#cb128-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-63"><a href="#cb128-63" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> cycle[:<span class="bu">len</span>(cycle) <span class="op">-</span> k <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb128-64"><a href="#cb128-64" aria-hidden="true" tabindex="-1"></a>    circular_string <span class="op">=</span> cycle[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb128-65"><a href="#cb128-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> cycle:</span>
<span id="cb128-66"><a href="#cb128-66" aria-hidden="true" tabindex="-1"></a>        circular_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb128-67"><a href="#cb128-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> circular_string</span>
<span id="cb128-68"><a href="#cb128-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-69"><a href="#cb128-69" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb128-70"><a href="#cb128-70" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb128-71"><a href="#cb128-71" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb128-72"><a href="#cb128-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-73"><a href="#cb128-73" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb128-74"><a href="#cb128-74" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb128-75"><a href="#cb128-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-76"><a href="#cb128-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generate_k_universal_circular_string(k))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-paired-composition" class="level1" data-number="43">
<h1 data-number="43"><span class="header-section-number">43</span> Reconstruct a String from its Paired Composition</h1>
<p>String Reconstruction from Read-Pairs Problem. Reconstruct a string from its paired composition.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>&nbsp;followed by a collection of paired&nbsp;<em>k</em>-mers&nbsp;<em>PairedReads</em>.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;with (<em>k</em>,&nbsp;<em>d</em>)-mer composition equal to&nbsp;<em>PairedReads</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-43" class="level2" data-number="43.1">
<h2 data-number="43.1" class="anchored" data-anchor-id="sample-dataset-43"><span class="header-section-number">43.1</span> Sample Dataset</h2>
<pre><code>4 2
GAGA|TTGA
TCGT|GATG
CGTG|ATGT
TGGT|TGAG
GTGA|TGTT
GTGG|GTGA
TGAG|GTTG
GGTC|GAGA
GTCG|AGAT</code></pre>
</section>
<section id="sample-output-43" class="level2" data-number="43.2">
<h2 data-number="43.2" class="anchored" data-anchor-id="sample-output-43"><span class="header-section-number">43.2</span> Sample Output</h2>
<pre><code>GTGGTCGTGAGATGTTGA</code></pre>
</section>
<section id="solution-43" class="level2" data-number="43.3">
<h2 data-number="43.3" class="anchored" data-anchor-id="solution-43"><span class="header-section-number">43.3</span> Solution</h2>
<div class="sourceCode" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph_paired_reads(paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]]:</span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pair <span class="kw">in</span> paired_reads:</span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a>        graph[(pair[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>], pair[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>])].append((pair[<span class="dv">0</span>][<span class="dv">1</span>:], pair[<span class="dv">1</span>][<span class="dv">1</span>:]))</span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> string_spelled_by_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb131-74"><a href="#cb131-74" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb131-75"><a href="#cb131-75" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">1</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>]</span>
<span id="cb131-76"><a href="#cb131-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb131-77"><a href="#cb131-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb131-78"><a href="#cb131-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb131-79"><a href="#cb131-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb131-80"><a href="#cb131-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb131-81"><a href="#cb131-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-82"><a href="#cb131-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_read_pairs(k: <span class="bu">int</span>, d: <span class="bu">int</span>, paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb131-83"><a href="#cb131-83" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph_paired_reads(paired_reads)</span>
<span id="cb131-84"><a href="#cb131-84" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(graph)</span>
<span id="cb131-85"><a href="#cb131-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> string_spelled_by_gapped_patterns(path, k <span class="op">-</span> <span class="dv">1</span>, d)</span>
<span id="cb131-86"><a href="#cb131-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-87"><a href="#cb131-87" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb131-88"><a href="#cb131-88" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb131-89"><a href="#cb131-89" aria-hidden="true" tabindex="-1"></a><span class="st">GAGA|TTGA</span></span>
<span id="cb131-90"><a href="#cb131-90" aria-hidden="true" tabindex="-1"></a><span class="st">TCGT|GATG</span></span>
<span id="cb131-91"><a href="#cb131-91" aria-hidden="true" tabindex="-1"></a><span class="st">CGTG|ATGT</span></span>
<span id="cb131-92"><a href="#cb131-92" aria-hidden="true" tabindex="-1"></a><span class="st">TGGT|TGAG</span></span>
<span id="cb131-93"><a href="#cb131-93" aria-hidden="true" tabindex="-1"></a><span class="st">GTGA|TGTT</span></span>
<span id="cb131-94"><a href="#cb131-94" aria-hidden="true" tabindex="-1"></a><span class="st">GTGG|GTGA</span></span>
<span id="cb131-95"><a href="#cb131-95" aria-hidden="true" tabindex="-1"></a><span class="st">TGAG|GTTG</span></span>
<span id="cb131-96"><a href="#cb131-96" aria-hidden="true" tabindex="-1"></a><span class="st">GGTC|GAGA</span></span>
<span id="cb131-97"><a href="#cb131-97" aria-hidden="true" tabindex="-1"></a><span class="st">GTCG|AGAT</span></span>
<span id="cb131-98"><a href="#cb131-98" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb131-99"><a href="#cb131-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-100"><a href="#cb131-100" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb131-101"><a href="#cb131-101" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb131-102"><a href="#cb131-102" aria-hidden="true" tabindex="-1"></a>paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb131-103"><a href="#cb131-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-104"><a href="#cb131-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_read_pairs(k, d, paired_reads))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-contigs-from-a-collection-of-reads" class="level1" data-number="44">
<h1 data-number="44"><span class="header-section-number">44</span> Generate Contigs from a Collection of Reads</h1>
<p>Contig Generation Problem. Generate the contigs from a collection of reads (with imperfect coverage).</p>
<p>Given:&nbsp;A collection of k-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All contigs in&nbsp;<em>DeBruijn(Patterns)</em>. (You may return the strings in any order.)</p>
<section id="sample-dataset-44" class="level2" data-number="44.1">
<h2 data-number="44.1" class="anchored" data-anchor-id="sample-dataset-44"><span class="header-section-number">44.1</span> Sample Dataset</h2>
<pre><code>ATG
ATG
TGT
TGG
CAT
GGA
GAT
AGA</code></pre>
</section>
<section id="sample-output-44" class="level2" data-number="44.2">
<h2 data-number="44.2" class="anchored" data-anchor-id="sample-output-44"><span class="header-section-number">44.2</span> Sample Output</h2>
<pre><code>AGA ATG ATG CAT GAT TGGA TGT</code></pre>
</section>
<section id="solution-44" class="level2" data-number="44.3">
<h2 data-number="44.3" class="anchored" data-anchor-id="solution-44"><span class="header-section-number">44.3</span> Solution</h2>
<div class="sourceCode" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>        prefix, suffix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>], kmer[<span class="dv">1</span>:]</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[prefix].append(suffix)</span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(targets)]</span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb134-26"><a href="#cb134-26" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(targets)</span>
<span id="cb134-27"><a href="#cb134-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-28"><a href="#cb134-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb134-29"><a href="#cb134-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb134-30"><a href="#cb134-30" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb134-31"><a href="#cb134-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb134-32"><a href="#cb134-32" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb134-33"><a href="#cb134-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-34"><a href="#cb134-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb134-35"><a href="#cb134-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb134-36"><a href="#cb134-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb134-37"><a href="#cb134-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb134-38"><a href="#cb134-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb134-39"><a href="#cb134-39" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb134-40"><a href="#cb134-40" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb134-41"><a href="#cb134-41" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb134-42"><a href="#cb134-42" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb134-43"><a href="#cb134-43" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb134-44"><a href="#cb134-44" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb134-45"><a href="#cb134-45" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb134-46"><a href="#cb134-46" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb134-47"><a href="#cb134-47" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb134-48"><a href="#cb134-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-49"><a href="#cb134-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb134-50"><a href="#cb134-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb134-51"><a href="#cb134-51" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb134-52"><a href="#cb134-52" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb134-53"><a href="#cb134-53" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb134-54"><a href="#cb134-54" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb134-55"><a href="#cb134-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb134-56"><a href="#cb134-56" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb134-57"><a href="#cb134-57" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb134-58"><a href="#cb134-58" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb134-59"><a href="#cb134-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb134-60"><a href="#cb134-60" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb134-61"><a href="#cb134-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-62"><a href="#cb134-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb134-63"><a href="#cb134-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-64"><a href="#cb134-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_contigs(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb134-65"><a href="#cb134-65" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb134-66"><a href="#cb134-66" aria-hidden="true" tabindex="-1"></a>    paths <span class="op">=</span> find_maximal_non_branching_paths(graph)</span>
<span id="cb134-67"><a href="#cb134-67" aria-hidden="true" tabindex="-1"></a>    contigs: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb134-68"><a href="#cb134-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> path <span class="kw">in</span> paths:</span>
<span id="cb134-69"><a href="#cb134-69" aria-hidden="true" tabindex="-1"></a>        contig <span class="op">=</span> path[<span class="dv">0</span>]</span>
<span id="cb134-70"><a href="#cb134-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> path[<span class="dv">1</span>:]:</span>
<span id="cb134-71"><a href="#cb134-71" aria-hidden="true" tabindex="-1"></a>            contig <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb134-72"><a href="#cb134-72" aria-hidden="true" tabindex="-1"></a>        contigs.append(contig)</span>
<span id="cb134-73"><a href="#cb134-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> contigs</span>
<span id="cb134-74"><a href="#cb134-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-75"><a href="#cb134-75" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb134-76"><a href="#cb134-76" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb134-77"><a href="#cb134-77" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb134-78"><a href="#cb134-78" aria-hidden="true" tabindex="-1"></a><span class="st">TGT</span></span>
<span id="cb134-79"><a href="#cb134-79" aria-hidden="true" tabindex="-1"></a><span class="st">TGG</span></span>
<span id="cb134-80"><a href="#cb134-80" aria-hidden="true" tabindex="-1"></a><span class="st">CAT</span></span>
<span id="cb134-81"><a href="#cb134-81" aria-hidden="true" tabindex="-1"></a><span class="st">GGA</span></span>
<span id="cb134-82"><a href="#cb134-82" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb134-83"><a href="#cb134-83" aria-hidden="true" tabindex="-1"></a><span class="st">AGA</span></span>
<span id="cb134-84"><a href="#cb134-84" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb134-85"><a href="#cb134-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-86"><a href="#cb134-86" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb134-87"><a href="#cb134-87" aria-hidden="true" tabindex="-1"></a>contigs <span class="op">=</span> generate_contigs(kmers)</span>
<span id="cb134-88"><a href="#cb134-88" aria-hidden="true" tabindex="-1"></a>contigs.sort()</span>
<span id="cb134-89"><a href="#cb134-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(contigs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-string-spelled-by-a-gapped-genome-path" class="level1" data-number="45">
<h1 data-number="45"><span class="header-section-number">45</span> Construct a String Spelled by a Gapped Genome Path</h1>
<p>Gapped Genome Path String Problem. Reconstruct a string from a sequence of (k,d)-mers corresponding to a path in a paired de Bruijn graph.</p>
<p>Given:&nbsp;A sequence of&nbsp;<em>(k, d)</em>-mers (<em>a1|b1</em>), … , (<em>an|bn</em>) such that&nbsp;<em>Suffix(ai|bi) = Prefix(ai+1|bi+1)</em>&nbsp;for all&nbsp;<em>i</em>&nbsp;from 1 to n-1.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;where the&nbsp;<em>i</em>-th&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>&nbsp;is equal to&nbsp;<em>Suffix(ai|bi)</em>&nbsp;for all&nbsp;<em>i</em>&nbsp;from 1 to n, if such a string exists.</p>
<section id="sample-dataset-45" class="level2" data-number="45.1">
<h2 data-number="45.1" class="anchored" data-anchor-id="sample-dataset-45"><span class="header-section-number">45.1</span> Sample Dataset</h2>
<pre><code>4 2
GACC|GCGC
ACCG|CGCC
CCGA|GCCG
CGAG|CCGG
GAGC|CGGA</code></pre>
</section>
<section id="sample-output-45" class="level2" data-number="45.2">
<h2 data-number="45.2" class="anchored" data-anchor-id="sample-output-45"><span class="header-section-number">45.2</span> Sample Output</h2>
<pre><code>GACCGAGCGCCGGA</code></pre>
</section>
<section id="solution-45" class="level2" data-number="45.3">
<h2 data-number="45.3" class="anchored" data-anchor-id="solution-45"><span class="header-section-number">45.3</span> Solution</h2>
<div class="sourceCode" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (prefix, suffix) <span class="kw">in</span> <span class="bu">enumerate</span>(gapped_patterns):</span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">!=</span> <span class="bu">len</span>(gapped_patterns) <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix[<span class="dv">0</span>]</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix[<span class="dv">0</span>]</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a><span class="st">GACC|GCGC</span></span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a><span class="st">ACCG|CGCC</span></span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a><span class="st">CCGA|GCCG</span></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a><span class="st">CGAG|CCGG</span></span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a><span class="st">GAGC|CGGA</span></span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a>gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_gapped_patterns(gapped_patterns, k <span class="op">-</span> <span class="dv">1</span>, d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-all-maximal-non-branching-paths-in-a-graph" class="level1" data-number="46">
<h1 data-number="46"><span class="header-section-number">46</span> Generate All Maximal Non-Branching Paths in a Graph</h1>
<p>Maximal Non-Branching Path Problem. Find all maximal non-branching paths in a graph.</p>
<p>Given:&nbsp;The adjacency list of a graph whose nodes are integers.</p>
<p>Return:&nbsp;The collection of all maximal non-branching paths in the graph.</p>
<section id="sample-dataset-46" class="level2" data-number="46.1">
<h2 data-number="46.1" class="anchored" data-anchor-id="sample-dataset-46"><span class="header-section-number">46.1</span> Sample Dataset</h2>
<pre><code>1 -&gt; 2
2 -&gt; 3
3 -&gt; 4,5
6 -&gt; 7
7 -&gt; 6</code></pre>
</section>
<section id="sample-output-46" class="level2" data-number="46.2">
<h2 data-number="46.2" class="anchored" data-anchor-id="sample-output-46"><span class="header-section-number">46.2</span> Sample Output</h2>
<pre><code>1 -&gt; 2 -&gt; 3
3 -&gt; 4
3 -&gt; 5
6 -&gt; 7 -&gt; 6</code></pre>
</section>
<section id="solution-46" class="level2" data-number="46.3">
<h2 data-number="46.3" class="anchored" data-anchor-id="solution-46"><span class="header-section-number">46.3</span> Solution</h2>
<div class="sourceCode" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[source] <span class="op">=</span> targets.split(<span class="st">','</span>)</span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(neighbors)]</span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(neighbors)</span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb140-37"><a href="#cb140-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb140-38"><a href="#cb140-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb140-39"><a href="#cb140-39" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb140-40"><a href="#cb140-40" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb140-41"><a href="#cb140-41" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb140-42"><a href="#cb140-42" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb140-43"><a href="#cb140-43" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb140-44"><a href="#cb140-44" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb140-45"><a href="#cb140-45" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb140-46"><a href="#cb140-46" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb140-47"><a href="#cb140-47" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb140-48"><a href="#cb140-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-49"><a href="#cb140-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb140-50"><a href="#cb140-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb140-51"><a href="#cb140-51" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb140-52"><a href="#cb140-52" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb140-53"><a href="#cb140-53" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb140-54"><a href="#cb140-54" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb140-55"><a href="#cb140-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb140-56"><a href="#cb140-56" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb140-57"><a href="#cb140-57" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb140-58"><a href="#cb140-58" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb140-59"><a href="#cb140-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb140-60"><a href="#cb140-60" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb140-61"><a href="#cb140-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-62"><a href="#cb140-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb140-63"><a href="#cb140-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-64"><a href="#cb140-64" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb140-65"><a href="#cb140-65" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb140-66"><a href="#cb140-66" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb140-67"><a href="#cb140-67" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 4,5</span></span>
<span id="cb140-68"><a href="#cb140-68" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 7</span></span>
<span id="cb140-69"><a href="#cb140-69" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 6</span></span>
<span id="cb140-70"><a href="#cb140-70" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb140-71"><a href="#cb140-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-72"><a href="#cb140-72" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb140-73"><a href="#cb140-73" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb140-74"><a href="#cb140-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-75"><a href="#cb140-75" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_maximal_non_branching_paths(adjacency_list)</span>
<span id="cb140-76"><a href="#cb140-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> result:</span>
<span id="cb140-77"><a href="#cb140-77" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">" -&gt; "</span>.join(path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="translate-an-rna-string-into-an-amino-acid-string" class="level1" data-number="47">
<h1 data-number="47"><span class="header-section-number">47</span> Translate an RNA String into an Amino Acid String</h1>
<p>Protein Translation Problem. Translate an&nbsp;<a href="https://rosalind.info/glossary/rna-string/">RNA string</a>&nbsp;into an&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>.</p>
<p>Given:&nbsp;An RNA string&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;The translation of&nbsp;<em>Pattern</em>&nbsp;into an amino acid string&nbsp;<em>Peptide</em>.</p>
<section id="sample-dataset-47" class="level2" data-number="47.1">
<h2 data-number="47.1" class="anchored" data-anchor-id="sample-dataset-47"><span class="header-section-number">47.1</span> Sample Dataset</h2>
<pre><code>AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</code></pre>
</section>
<section id="sample-output-47" class="level2" data-number="47.2">
<h2 data-number="47.2" class="anchored" data-anchor-id="sample-output-47"><span class="header-section-number">47.2</span> Sample Output</h2>
<pre><code>MAMAPRTEINSTRING</code></pre>
</section>
<section id="solution-47" class="level2" data-number="47.3">
<h2 data-number="47.3" class="anchored" data-anchor-id="solution-47"><span class="header-section-number">47.3</span> Solution</h2>
<div class="sourceCode" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tomorrow-lab\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb144" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Rosalind Textbook track 문제풀이"</span></span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Taeyoon Kim"</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Python, Rosalind, Bioinformatics, Tip]</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-09-28"</span></span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb144-8"><a href="#cb144-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb144-9"><a href="#cb144-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-10"><a href="#cb144-10" aria-hidden="true" tabindex="-1"></a><span class="al">![](Rosalind_textbookTrack.png)</span>{width=100% fig-align="center"}</span>
<span id="cb144-11"><a href="#cb144-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-12"><a href="#cb144-12" aria-hidden="true" tabindex="-1"></a>Phillip Compeau 와 Pavel Pevzner 가 쓴 책 "<span class="co">[</span><span class="ot">능동적 접근 방식의 생물정보학 알고리즘</span><span class="co">](https://www.bioinformaticsalgorithms.org/)</span>" 에서 제공되는 연습 문제 모음입니다.</span>
<span id="cb144-13"><a href="#cb144-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-14"><a href="#cb144-14" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Rosalind</span><span class="co">](https://rosalind.info/)</span> 는 <span class="co">[</span><span class="ot">프로젝트 오일러</span><span class="co">](http://projecteuler.net/)</span>, <span class="co">[</span><span class="ot">구글 코드 잼</span><span class="co">](http://code.google.com/codejam)</span> 에서 영감을 얻었습니다. 이 프로젝트의 이름은 DNA 이중나선을 발견하는 데 기여한 <span class="co">[</span><span class="ot">로잘린드 프랭클린</span><span class="co">](http://en.wikipedia.org/wiki/Rosalind_Franklin)</span> 에서 따왔습니다. Rosalind 는 프로그래밍 실력을 키우고자 하는 생물학자와 분자생물학의 계산 문제를 접해본 적이 없는 프로그래머들에게 도움이 될 것입니다.</span>
<span id="cb144-15"><a href="#cb144-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-16"><a href="#cb144-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compute the Number of Times a Pattern Appears in a Text</span></span>
<span id="cb144-17"><a href="#cb144-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-18"><a href="#cb144-18" aria-hidden="true" tabindex="-1"></a>This is the first problem in a collection of "code challenges" to accompany&nbsp;<span class="co">[</span><span class="ot">Bioinformatics Algorithms: An Active-Learning Approach</span><span class="co">](http://bioinformaticsalgorithms.org/)</span>&nbsp;by Phillip Compeau &amp; Pavel Pevzner.</span>
<span id="cb144-19"><a href="#cb144-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-20"><a href="#cb144-20" aria-hidden="true" tabindex="-1"></a>A&nbsp;<span class="co">[</span><span class="ot">k-mer</span><span class="co">](https://rosalind.info/glossary/k-mer/)</span>&nbsp;is a&nbsp;<span class="co">[</span><span class="ot">string</span><span class="co">](https://rosalind.info/glossary/string/)</span>&nbsp;of length&nbsp;_k_. We define&nbsp;_Count_(_Text_,&nbsp;_Pattern_) as the number of times that a&nbsp;_k_-mer&nbsp;_Pattern_&nbsp;appears as a&nbsp;[substring](https://rosalind.info/glossary/substring/)&nbsp;of&nbsp;_Text_.</span>
<span id="cb144-21"><a href="#cb144-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-22"><a href="#cb144-22" aria-hidden="true" tabindex="-1"></a>For example, We note that&nbsp;$Count(CGATATATCCATAGCGATATATCCATAG,ATAATA)$ is equal to 3 (not 2) since we should account for overlapping occurrences of&nbsp;_Pattern_&nbsp;in&nbsp;_Text_.</span>
<span id="cb144-23"><a href="#cb144-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-24"><a href="#cb144-24" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;{DNA strings}}&nbsp;_Text_&nbsp;and&nbsp;_Pattern_.</span>
<span id="cb144-25"><a href="#cb144-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-26"><a href="#cb144-26" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;_Count_(_Text_,&nbsp;_Pattern_).</span>
<span id="cb144-27"><a href="#cb144-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-28"><a href="#cb144-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-29"><a href="#cb144-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-30"><a href="#cb144-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-31"><a href="#cb144-31" aria-hidden="true" tabindex="-1"></a><span class="in">GCGCG</span></span>
<span id="cb144-32"><a href="#cb144-32" aria-hidden="true" tabindex="-1"></a><span class="in">GCG</span></span>
<span id="cb144-33"><a href="#cb144-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-34"><a href="#cb144-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-35"><a href="#cb144-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-36"><a href="#cb144-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-37"><a href="#cb144-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-38"><a href="#cb144-38" aria-hidden="true" tabindex="-1"></a><span class="in">2</span></span>
<span id="cb144-39"><a href="#cb144-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-40"><a href="#cb144-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-41"><a href="#cb144-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-42"><a href="#cb144-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-43"><a href="#cb144-43" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-44"><a href="#cb144-44" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb144-45"><a href="#cb144-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-46"><a href="#cb144-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb144-47"><a href="#cb144-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb144-48"><a href="#cb144-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-49"><a href="#cb144-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i:i <span class="op">+</span> size]</span>
<span id="cb144-50"><a href="#cb144-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-51"><a href="#cb144-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-52"><a href="#cb144-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count how many times the pattern occurs in the text."""</span></span>
<span id="cb144-53"><a href="#cb144-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb144-54"><a href="#cb144-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-55"><a href="#cb144-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-56"><a href="#cb144-56" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-57"><a href="#cb144-57" aria-hidden="true" tabindex="-1"></a><span class="st">GCGCG</span></span>
<span id="cb144-58"><a href="#cb144-58" aria-hidden="true" tabindex="-1"></a><span class="st">GCG</span></span>
<span id="cb144-59"><a href="#cb144-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-60"><a href="#cb144-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-61"><a href="#cb144-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern</span></span>
<span id="cb144-62"><a href="#cb144-62" aria-hidden="true" tabindex="-1"></a>text, pattern <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-63"><a href="#cb144-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-64"><a href="#cb144-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the count of pattern occurrences in text</span></span>
<span id="cb144-65"><a href="#cb144-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_pattern_occurrences(text, pattern))</span>
<span id="cb144-66"><a href="#cb144-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-67"><a href="#cb144-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-68"><a href="#cb144-68" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find the Most Frequent Words in a String</span></span>
<span id="cb144-69"><a href="#cb144-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-70"><a href="#cb144-70" aria-hidden="true" tabindex="-1"></a>We say that&nbsp;_Pattern_&nbsp;is a&nbsp;**most frequent&nbsp;k-mer**&nbsp;in&nbsp;_Text_&nbsp;if it maximizes&nbsp;_Count_(_Text_,&nbsp;_Pattern_) among all&nbsp;<span class="co">[</span><span class="ot">k-mers</span><span class="co">](https://rosalind.info/glossary/k-mer/)</span>. For example, "ACTAT" is a most frequent 5-mer in "ACAACTATGCATCACTATCGGGAACTATCCT", and "ATA" is a most frequent 3-mer of "CGATATATCCATAG".</span>
<span id="cb144-71"><a href="#cb144-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-72"><a href="#cb144-72" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;<span class="co">[</span><span class="ot">DNA string</span><span class="co">](https://rosalind.info/glossary/dna-string/)</span>&nbsp;_Text_&nbsp;and an integer&nbsp;_k_.</span>
<span id="cb144-73"><a href="#cb144-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-74"><a href="#cb144-74" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All most frequent&nbsp;_k_-mers in&nbsp;_Text_&nbsp;(in any order).</span>
<span id="cb144-75"><a href="#cb144-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-76"><a href="#cb144-76" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-77"><a href="#cb144-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-78"><a href="#cb144-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-79"><a href="#cb144-79" aria-hidden="true" tabindex="-1"></a><span class="in">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb144-80"><a href="#cb144-80" aria-hidden="true" tabindex="-1"></a><span class="in">4</span></span>
<span id="cb144-81"><a href="#cb144-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-82"><a href="#cb144-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-83"><a href="#cb144-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-84"><a href="#cb144-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-85"><a href="#cb144-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-86"><a href="#cb144-86" aria-hidden="true" tabindex="-1"></a><span class="in">CATG GCAT</span></span>
<span id="cb144-87"><a href="#cb144-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-88"><a href="#cb144-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-89"><a href="#cb144-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-90"><a href="#cb144-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-91"><a href="#cb144-91" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-92"><a href="#cb144-92" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb144-93"><a href="#cb144-93" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-94"><a href="#cb144-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-95"><a href="#cb144-95" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-96"><a href="#cb144-96" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb144-97"><a href="#cb144-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-98"><a href="#cb144-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-99"><a href="#cb144-99" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb144-100"><a href="#cb144-100" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count occurrences of each k-mer in the text."""</span></span>
<span id="cb144-101"><a href="#cb144-101" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb144-102"><a href="#cb144-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(text, k):</span>
<span id="cb144-103"><a href="#cb144-103" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-104"><a href="#cb144-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb144-105"><a href="#cb144-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-106"><a href="#cb144-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> most_frequent_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-107"><a href="#cb144-107" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find the most frequent k-mers."""</span></span>
<span id="cb144-108"><a href="#cb144-108" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb144-109"><a href="#cb144-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb144-110"><a href="#cb144-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-111"><a href="#cb144-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-112"><a href="#cb144-112" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-113"><a href="#cb144-113" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb144-114"><a href="#cb144-114" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb144-115"><a href="#cb144-115" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-116"><a href="#cb144-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-117"><a href="#cb144-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern size</span></span>
<span id="cb144-118"><a href="#cb144-118" aria-hidden="true" tabindex="-1"></a>text, k <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-119"><a href="#cb144-119" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="bu">int</span>(k)</span>
<span id="cb144-120"><a href="#cb144-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-121"><a href="#cb144-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Find and print the most frequent k-mers</span></span>
<span id="cb144-122"><a href="#cb144-122" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> most_frequent_kmers(count_kmers(text, k))</span>
<span id="cb144-123"><a href="#cb144-123" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent)</span>
<span id="cb144-124"><a href="#cb144-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-125"><a href="#cb144-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-126"><a href="#cb144-126" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find the Reverse Complement of a String</span></span>
<span id="cb144-127"><a href="#cb144-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-128"><a href="#cb144-128" aria-hidden="true" tabindex="-1"></a>Find the reverse complement of a DNA string.</span>
<span id="cb144-129"><a href="#cb144-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-130"><a href="#cb144-130" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A DNA string&nbsp;_Pattern_.</span>
<span id="cb144-131"><a href="#cb144-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-132"><a href="#cb144-132" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;$\overline{Pattern}$, the reverse complement of&nbsp;_Pattern_.</span>
<span id="cb144-133"><a href="#cb144-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-134"><a href="#cb144-134" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-135"><a href="#cb144-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-136"><a href="#cb144-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-137"><a href="#cb144-137" aria-hidden="true" tabindex="-1"></a><span class="in">AAAACCCGGT</span></span>
<span id="cb144-138"><a href="#cb144-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-139"><a href="#cb144-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-140"><a href="#cb144-140" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-141"><a href="#cb144-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-142"><a href="#cb144-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-143"><a href="#cb144-143" aria-hidden="true" tabindex="-1"></a><span class="in">ACCGGGTTTT</span></span>
<span id="cb144-144"><a href="#cb144-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-145"><a href="#cb144-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-146"><a href="#cb144-146" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-147"><a href="#cb144-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-148"><a href="#cb144-148" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-149"><a href="#cb144-149" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-150"><a href="#cb144-150" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Return the reverse complement of a DNA sequence."""</span></span>
<span id="cb144-151"><a href="#cb144-151" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb144-152"><a href="#cb144-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-153"><a href="#cb144-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-154"><a href="#cb144-154" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-155"><a href="#cb144-155" aria-hidden="true" tabindex="-1"></a><span class="st">AAAACCCGGT</span></span>
<span id="cb144-156"><a href="#cb144-156" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-157"><a href="#cb144-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-158"><a href="#cb144-158" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the reverse complement</span></span>
<span id="cb144-159"><a href="#cb144-159" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip().split()[<span class="dv">0</span>]</span>
<span id="cb144-160"><a href="#cb144-160" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reverse_complement(sequence))</span>
<span id="cb144-161"><a href="#cb144-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-162"><a href="#cb144-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-163"><a href="#cb144-163" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find All Occurrences of a Pattern in a String</span></span>
<span id="cb144-164"><a href="#cb144-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-165"><a href="#cb144-165" aria-hidden="true" tabindex="-1"></a>Pattern Matching Problem, Find all occurrences of a pattern in a string.</span>
<span id="cb144-166"><a href="#cb144-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-167"><a href="#cb144-167" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Strings&nbsp;_Pattern_&nbsp;and&nbsp;_Genome_.</span>
<span id="cb144-168"><a href="#cb144-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-169"><a href="#cb144-169" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All starting positions in&nbsp;_Genome_&nbsp;where&nbsp;_Pattern_&nbsp;appears as a substring. Use&nbsp;<span class="co">[</span><span class="ot">0-based indexing</span><span class="co">](https://rosalind.info/glossary/0-based-numbering/)</span>.</span>
<span id="cb144-170"><a href="#cb144-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-171"><a href="#cb144-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-172"><a href="#cb144-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-173"><a href="#cb144-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-174"><a href="#cb144-174" aria-hidden="true" tabindex="-1"></a><span class="in">ATAT</span></span>
<span id="cb144-175"><a href="#cb144-175" aria-hidden="true" tabindex="-1"></a><span class="in">GATATATGCATATACTT</span></span>
<span id="cb144-176"><a href="#cb144-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-177"><a href="#cb144-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-178"><a href="#cb144-178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-179"><a href="#cb144-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-180"><a href="#cb144-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-181"><a href="#cb144-181" aria-hidden="true" tabindex="-1"></a><span class="in">1 3 9</span></span>
<span id="cb144-182"><a href="#cb144-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-183"><a href="#cb144-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-184"><a href="#cb144-184" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-185"><a href="#cb144-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-186"><a href="#cb144-186" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-187"><a href="#cb144-187" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Generator</span>
<span id="cb144-188"><a href="#cb144-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-189"><a href="#cb144-189" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-190"><a href="#cb144-190" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb144-191"><a href="#cb144-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-192"><a href="#cb144-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-193"><a href="#cb144-193" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_indices(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb144-194"><a href="#cb144-194" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Yield starting indices where the pattern is found in the text."""</span></span>
<span id="cb144-195"><a href="#cb144-195" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, <span class="bu">len</span>(pattern))):</span>
<span id="cb144-196"><a href="#cb144-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> substring <span class="op">==</span> pattern:</span>
<span id="cb144-197"><a href="#cb144-197" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> i</span>
<span id="cb144-198"><a href="#cb144-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-199"><a href="#cb144-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-200"><a href="#cb144-200" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-201"><a href="#cb144-201" aria-hidden="true" tabindex="-1"></a><span class="st">ATAT</span></span>
<span id="cb144-202"><a href="#cb144-202" aria-hidden="true" tabindex="-1"></a><span class="st">GATATATGCATATACTT</span></span>
<span id="cb144-203"><a href="#cb144-203" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-204"><a href="#cb144-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-205"><a href="#cb144-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into pattern and text</span></span>
<span id="cb144-206"><a href="#cb144-206" aria-hidden="true" tabindex="-1"></a>pattern, text <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-207"><a href="#cb144-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-208"><a href="#cb144-208" aria-hidden="true" tabindex="-1"></a><span class="co"># Print indices where the pattern is found</span></span>
<span id="cb144-209"><a href="#cb144-209" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_pattern_indices(text, pattern))</span>
<span id="cb144-210"><a href="#cb144-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-211"><a href="#cb144-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-212"><a href="#cb144-212" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find Patterns Forming Clumps in a String</span></span>
<span id="cb144-213"><a href="#cb144-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-214"><a href="#cb144-214" aria-hidden="true" tabindex="-1"></a>Clump Finding Problem, Find patterns forming clumps in a string.</span>
<span id="cb144-215"><a href="#cb144-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-216"><a href="#cb144-216" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;_Genome_, and integers&nbsp;_k_,&nbsp;_L_, and&nbsp;_t_.</span>
<span id="cb144-217"><a href="#cb144-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-218"><a href="#cb144-218" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All distinct&nbsp;_k_-mers forming (_L_,&nbsp;_t_)-clumps in&nbsp;_Genome_.</span>
<span id="cb144-219"><a href="#cb144-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-220"><a href="#cb144-220" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-221"><a href="#cb144-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-222"><a href="#cb144-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-223"><a href="#cb144-223" aria-hidden="true" tabindex="-1"></a><span class="in">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb144-224"><a href="#cb144-224" aria-hidden="true" tabindex="-1"></a><span class="in">5 75 4</span></span>
<span id="cb144-225"><a href="#cb144-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-226"><a href="#cb144-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-227"><a href="#cb144-227" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-228"><a href="#cb144-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-229"><a href="#cb144-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-230"><a href="#cb144-230" aria-hidden="true" tabindex="-1"></a><span class="in">CGACA GAAGA AATGT</span></span>
<span id="cb144-231"><a href="#cb144-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-232"><a href="#cb144-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-233"><a href="#cb144-233" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-234"><a href="#cb144-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-235"><a href="#cb144-235" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-236"><a href="#cb144-236" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-237"><a href="#cb144-237" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb144-238"><a href="#cb144-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-239"><a href="#cb144-239" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-240"><a href="#cb144-240" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb144-241"><a href="#cb144-241" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-242"><a href="#cb144-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-243"><a href="#cb144-243" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb144-244"><a href="#cb144-244" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions of k-length kmers within the text."""</span></span>
<span id="cb144-245"><a href="#cb144-245" aria-hidden="true" tabindex="-1"></a>    kmer_positions <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb144-246"><a href="#cb144-246" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, k)):</span>
<span id="cb144-247"><a href="#cb144-247" aria-hidden="true" tabindex="-1"></a>        kmer_positions[substring].append(i)</span>
<span id="cb144-248"><a href="#cb144-248" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_positions</span>
<span id="cb144-249"><a href="#cb144-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-250"><a href="#cb144-250" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_clump(positions: List[<span class="bu">int</span>], L: <span class="bu">int</span>, t: <span class="bu">int</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb144-251"><a href="#cb144-251" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if a given array of kmers at positions forms a clump of t within L."""</span></span>
<span id="cb144-252"><a href="#cb144-252" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(positions) <span class="op">-</span> t <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-253"><a href="#cb144-253" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (positions[i <span class="op">+</span> t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> k <span class="op">-</span> positions[i]) <span class="op">&lt;=</span> L:</span>
<span id="cb144-254"><a href="#cb144-254" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb144-255"><a href="#cb144-255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb144-256"><a href="#cb144-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-257"><a href="#cb144-257" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-258"><a href="#cb144-258" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-259"><a href="#cb144-259" aria-hidden="true" tabindex="-1"></a><span class="st">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb144-260"><a href="#cb144-260" aria-hidden="true" tabindex="-1"></a><span class="st">5 75 4</span></span>
<span id="cb144-261"><a href="#cb144-261" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-262"><a href="#cb144-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-263"><a href="#cb144-263" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into sequence and parameters</span></span>
<span id="cb144-264"><a href="#cb144-264" aria-hidden="true" tabindex="-1"></a>seq, params <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-265"><a href="#cb144-265" aria-hidden="true" tabindex="-1"></a>k, L, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb144-266"><a href="#cb144-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-267"><a href="#cb144-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Find kmers and print those forming clumps</span></span>
<span id="cb144-268"><a href="#cb144-268" aria-hidden="true" tabindex="-1"></a>kmers <span class="op">=</span> find_kmers(seq, k)</span>
<span id="cb144-269"><a href="#cb144-269" aria-hidden="true" tabindex="-1"></a>clumps <span class="op">=</span> [kmer <span class="cf">for</span> kmer <span class="kw">in</span> kmers <span class="cf">if</span> has_clump(kmers[kmer], L, t, k)]</span>
<span id="cb144-270"><a href="#cb144-270" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>clumps)</span>
<span id="cb144-271"><a href="#cb144-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-272"><a href="#cb144-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-273"><a href="#cb144-273" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find a Position in a Genome Minimizing the Skew</span></span>
<span id="cb144-274"><a href="#cb144-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-275"><a href="#cb144-275" aria-hidden="true" tabindex="-1"></a>Minimum Skew Problem, Find a position in a genome minimizing the skew.</span>
<span id="cb144-276"><a href="#cb144-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-277"><a href="#cb144-277" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A DNA string&nbsp;_Genome_.</span>
<span id="cb144-278"><a href="#cb144-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-279"><a href="#cb144-279" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All integer(s)&nbsp;_i_&nbsp;minimizing&nbsp;_Skew_(_Prefix__i_&nbsp;(_Text_)) over all values of&nbsp;_i_&nbsp;(from 0 to |_Genome_|).</span>
<span id="cb144-280"><a href="#cb144-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-281"><a href="#cb144-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-282"><a href="#cb144-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-283"><a href="#cb144-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-284"><a href="#cb144-284" aria-hidden="true" tabindex="-1"></a><span class="in">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb144-285"><a href="#cb144-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-286"><a href="#cb144-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-287"><a href="#cb144-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-288"><a href="#cb144-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-289"><a href="#cb144-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-290"><a href="#cb144-290" aria-hidden="true" tabindex="-1"></a><span class="in">53 97</span></span>
<span id="cb144-291"><a href="#cb144-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-292"><a href="#cb144-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-293"><a href="#cb144-293" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-294"><a href="#cb144-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-295"><a href="#cb144-295" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-296"><a href="#cb144-296" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb144-297"><a href="#cb144-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-298"><a href="#cb144-298" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minima(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb144-299"><a href="#cb144-299" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions with the minimum skew in a DNA sequence."""</span></span>
<span id="cb144-300"><a href="#cb144-300" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb144-301"><a href="#cb144-301" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> {<span class="st">"G"</span>: <span class="dv">1</span>, <span class="st">"C"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"T"</span>: <span class="dv">0</span>}</span>
<span id="cb144-302"><a href="#cb144-302" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-303"><a href="#cb144-303" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(seq):</span>
<span id="cb144-304"><a href="#cb144-304" aria-hidden="true" tabindex="-1"></a>        skew.append(skew[i] <span class="op">+</span> delta[nucleotide])</span>
<span id="cb144-305"><a href="#cb144-305" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-306"><a href="#cb144-306" aria-hidden="true" tabindex="-1"></a>    min_skew <span class="op">=</span> <span class="bu">min</span>(skew)</span>
<span id="cb144-307"><a href="#cb144-307" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (i <span class="cf">for</span> i, value <span class="kw">in</span> <span class="bu">enumerate</span>(skew) <span class="cf">if</span> value <span class="op">==</span> min_skew)</span>
<span id="cb144-308"><a href="#cb144-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-309"><a href="#cb144-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-310"><a href="#cb144-310" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-311"><a href="#cb144-311" aria-hidden="true" tabindex="-1"></a><span class="st">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb144-312"><a href="#cb144-312" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-313"><a href="#cb144-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-314"><a href="#cb144-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the positions with minimum skew</span></span>
<span id="cb144-315"><a href="#cb144-315" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb144-316"><a href="#cb144-316" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_minima(sequence))</span>
<span id="cb144-317"><a href="#cb144-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-318"><a href="#cb144-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-319"><a href="#cb144-319" aria-hidden="true" tabindex="-1"></a><span class="fu"># Compute the Hamming Distance Between Two Strings</span></span>
<span id="cb144-320"><a href="#cb144-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-321"><a href="#cb144-321" aria-hidden="true" tabindex="-1"></a>Hamming Distance Problem, Compute the Hamming distance between two DNA strings.</span>
<span id="cb144-322"><a href="#cb144-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-323"><a href="#cb144-323" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two DNA strings.</span>
<span id="cb144-324"><a href="#cb144-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-325"><a href="#cb144-325" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An integer value representing the Hamming distance.</span>
<span id="cb144-326"><a href="#cb144-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-327"><a href="#cb144-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-328"><a href="#cb144-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-329"><a href="#cb144-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-330"><a href="#cb144-330" aria-hidden="true" tabindex="-1"></a><span class="in">GGGCCGTTGGT</span></span>
<span id="cb144-331"><a href="#cb144-331" aria-hidden="true" tabindex="-1"></a><span class="in">GGACCGTTGAC</span></span>
<span id="cb144-332"><a href="#cb144-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-333"><a href="#cb144-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-334"><a href="#cb144-334" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-335"><a href="#cb144-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-336"><a href="#cb144-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-337"><a href="#cb144-337" aria-hidden="true" tabindex="-1"></a><span class="in">3</span></span>
<span id="cb144-338"><a href="#cb144-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-339"><a href="#cb144-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-340"><a href="#cb144-340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-341"><a href="#cb144-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-342"><a href="#cb144-342" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-343"><a href="#cb144-343" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> zip_longest</span>
<span id="cb144-344"><a href="#cb144-344" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb144-345"><a href="#cb144-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-346"><a href="#cb144-346" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-347"><a href="#cb144-347" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> zip_longest(sequence1, sequence2, fillvalue<span class="op">=</span><span class="va">None</span>))</span>
<span id="cb144-348"><a href="#cb144-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-349"><a href="#cb144-349" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_dna_sequences(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb144-350"><a href="#cb144-350" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(input_string.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb144-351"><a href="#cb144-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-352"><a href="#cb144-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-353"><a href="#cb144-353" aria-hidden="true" tabindex="-1"></a>Sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-354"><a href="#cb144-354" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCCGTTGGT</span></span>
<span id="cb144-355"><a href="#cb144-355" aria-hidden="true" tabindex="-1"></a><span class="st">GGACCGTTGAC</span></span>
<span id="cb144-356"><a href="#cb144-356" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-357"><a href="#cb144-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-358"><a href="#cb144-358" aria-hidden="true" tabindex="-1"></a>dna_sequence1, dna_sequence2 <span class="op">=</span> parse_dna_sequences(Sample_input)</span>
<span id="cb144-359"><a href="#cb144-359" aria-hidden="true" tabindex="-1"></a>hamming_distance <span class="op">=</span> calculate_hamming_distance(dna_sequence1, dna_sequence2)</span>
<span id="cb144-360"><a href="#cb144-360" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hamming_distance)</span>
<span id="cb144-361"><a href="#cb144-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-362"><a href="#cb144-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-363"><a href="#cb144-363" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find All Approximate Occurrences of a Pattern in a String</span></span>
<span id="cb144-364"><a href="#cb144-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-365"><a href="#cb144-365" aria-hidden="true" tabindex="-1"></a>Approximate Pattern Matching Problem, Find all approximate occurrences of a pattern in a string.</span>
<span id="cb144-366"><a href="#cb144-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-367"><a href="#cb144-367" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Strings&nbsp;_Pattern_&nbsp;and&nbsp;_Text_&nbsp;along with an integer&nbsp;_d_.</span>
<span id="cb144-368"><a href="#cb144-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-369"><a href="#cb144-369" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All starting positions where&nbsp;_Pattern_&nbsp;appears as a substring of&nbsp;_Text_&nbsp;with at most&nbsp;_d_&nbsp;mismatches.</span>
<span id="cb144-370"><a href="#cb144-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-371"><a href="#cb144-371" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-372"><a href="#cb144-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-373"><a href="#cb144-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-374"><a href="#cb144-374" aria-hidden="true" tabindex="-1"></a><span class="in">ATTCTGGA</span></span>
<span id="cb144-375"><a href="#cb144-375" aria-hidden="true" tabindex="-1"></a><span class="in">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb144-376"><a href="#cb144-376" aria-hidden="true" tabindex="-1"></a><span class="in">3</span></span>
<span id="cb144-377"><a href="#cb144-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-378"><a href="#cb144-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-379"><a href="#cb144-379" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-380"><a href="#cb144-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-381"><a href="#cb144-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-382"><a href="#cb144-382" aria-hidden="true" tabindex="-1"></a><span class="in">6 7 26 27 78</span></span>
<span id="cb144-383"><a href="#cb144-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-384"><a href="#cb144-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-385"><a href="#cb144-385" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-386"><a href="#cb144-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-387"><a href="#cb144-387" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-388"><a href="#cb144-388" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb144-389"><a href="#cb144-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-390"><a href="#cb144-390" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-391"><a href="#cb144-391" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb144-392"><a href="#cb144-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-393"><a href="#cb144-393" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-394"><a href="#cb144-394" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb144-395"><a href="#cb144-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-396"><a href="#cb144-396" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_approximate_matches(pattern: <span class="bu">str</span>, genome: <span class="bu">str</span>, max_mismatch: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb144-397"><a href="#cb144-397" aria-hidden="true" tabindex="-1"></a>    pattern_length <span class="op">=</span> <span class="bu">len</span>(pattern)</span>
<span id="cb144-398"><a href="#cb144-398" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (position <span class="cf">for</span> position, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(genome, pattern_length))</span>
<span id="cb144-399"><a href="#cb144-399" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_mismatch)</span>
<span id="cb144-400"><a href="#cb144-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-401"><a href="#cb144-401" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb144-402"><a href="#cb144-402" aria-hidden="true" tabindex="-1"></a>    pattern, genome, max_mismatch_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-403"><a href="#cb144-403" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pattern, genome, <span class="bu">int</span>(max_mismatch_str)</span>
<span id="cb144-404"><a href="#cb144-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-405"><a href="#cb144-405" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-406"><a href="#cb144-406" aria-hidden="true" tabindex="-1"></a><span class="st">ATTCTGGA</span></span>
<span id="cb144-407"><a href="#cb144-407" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb144-408"><a href="#cb144-408" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb144-409"><a href="#cb144-409" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-410"><a href="#cb144-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-411"><a href="#cb144-411" aria-hidden="true" tabindex="-1"></a>pattern, genome, max_mismatch <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb144-412"><a href="#cb144-412" aria-hidden="true" tabindex="-1"></a>match_positions <span class="op">=</span> <span class="bu">list</span>(find_approximate_matches(pattern, genome, max_mismatch))</span>
<span id="cb144-413"><a href="#cb144-413" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>match_positions)</span>
<span id="cb144-414"><a href="#cb144-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-415"><a href="#cb144-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-416"><a href="#cb144-416" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find the Most Frequent Words with Mismatches in a String</span></span>
<span id="cb144-417"><a href="#cb144-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-418"><a href="#cb144-418" aria-hidden="true" tabindex="-1"></a>Frequent Words with Mismatches Problem, Find the most frequent k-mers with mismatches in a string.</span>
<span id="cb144-419"><a href="#cb144-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-420"><a href="#cb144-420" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;_Text_&nbsp;as well as integers&nbsp;_k_&nbsp;and&nbsp;_d_.</span>
<span id="cb144-421"><a href="#cb144-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-422"><a href="#cb144-422" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All most frequent&nbsp;_k_-mers with up to&nbsp;_d_&nbsp;mismatches in&nbsp;_Text_.</span>
<span id="cb144-423"><a href="#cb144-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-424"><a href="#cb144-424" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-425"><a href="#cb144-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-426"><a href="#cb144-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-427"><a href="#cb144-427" aria-hidden="true" tabindex="-1"></a><span class="in">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb144-428"><a href="#cb144-428" aria-hidden="true" tabindex="-1"></a><span class="in">4 1</span></span>
<span id="cb144-429"><a href="#cb144-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-430"><a href="#cb144-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-431"><a href="#cb144-431" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-432"><a href="#cb144-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-433"><a href="#cb144-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-434"><a href="#cb144-434" aria-hidden="true" tabindex="-1"></a><span class="in">ATGC ATGT GATG</span></span>
<span id="cb144-435"><a href="#cb144-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-436"><a href="#cb144-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-437"><a href="#cb144-437" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-438"><a href="#cb144-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-439"><a href="#cb144-439" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-440"><a href="#cb144-440" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-441"><a href="#cb144-441" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb144-442"><a href="#cb144-442" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb144-443"><a href="#cb144-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-444"><a href="#cb144-444" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-445"><a href="#cb144-445" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb144-446"><a href="#cb144-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-447"><a href="#cb144-447" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-448"><a href="#cb144-448" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb144-449"><a href="#cb144-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-450"><a href="#cb144-450" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna_sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb144-451"><a href="#cb144-451" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb144-452"><a href="#cb144-452" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna_sequence, kmer_length):</span>
<span id="cb144-453"><a href="#cb144-453" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-454"><a href="#cb144-454" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb144-455"><a href="#cb144-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-456"><a href="#cb144-456" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-457"><a href="#cb144-457" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb144-458"><a href="#cb144-458" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb144-459"><a href="#cb144-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-460"><a href="#cb144-460" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-461"><a href="#cb144-461" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb144-462"><a href="#cb144-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-463"><a href="#cb144-463" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(observed_kmers: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb144-464"><a href="#cb144-464" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb144-465"><a href="#cb144-465" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(observed_kmers[observed_kmer] </span>
<span id="cb144-466"><a href="#cb144-466" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> observed_kmer <span class="kw">in</span> observed_kmers </span>
<span id="cb144-467"><a href="#cb144-467" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb144-468"><a href="#cb144-468" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb144-469"><a href="#cb144-469" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb144-470"><a href="#cb144-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-471"><a href="#cb144-471" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb144-472"><a href="#cb144-472" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-473"><a href="#cb144-473" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb144-474"><a href="#cb144-474" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb144-475"><a href="#cb144-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-476"><a href="#cb144-476" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-477"><a href="#cb144-477" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb144-478"><a href="#cb144-478" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb144-479"><a href="#cb144-479" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-480"><a href="#cb144-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-481"><a href="#cb144-481" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb144-482"><a href="#cb144-482" aria-hidden="true" tabindex="-1"></a>observed_kmers <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb144-483"><a href="#cb144-483" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(observed_kmers, max_mismatches, kmer_length))</span>
<span id="cb144-484"><a href="#cb144-484" aria-hidden="true" tabindex="-1"></a>most_frequent_kmers <span class="op">=</span> find_most_frequent(approximate_kmer_counts)</span>
<span id="cb144-485"><a href="#cb144-485" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent_kmers)</span>
<span id="cb144-486"><a href="#cb144-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-487"><a href="#cb144-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-488"><a href="#cb144-488" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find Frequent Words with Mismatches and Reverse Complements</span></span>
<span id="cb144-489"><a href="#cb144-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-490"><a href="#cb144-490" aria-hidden="true" tabindex="-1"></a>Frequent Words with Mismatches and Reverse Complements Problem. Find the most frequent k-mers (with mismatches and reverse complements) in a DNA string.</span>
<span id="cb144-491"><a href="#cb144-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-492"><a href="#cb144-492" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A DNA string&nbsp;_Text_&nbsp;as well as integers&nbsp;_k_&nbsp;and&nbsp;_d_.</span>
<span id="cb144-493"><a href="#cb144-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-494"><a href="#cb144-494" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All&nbsp;_k_-mers&nbsp;_Pattern_&nbsp;maximizing the sum&nbsp;_Count__d_(_Text_,&nbsp;$Pattern$) +&nbsp;_Count__d_(_Text_,&nbsp;$\overline{Pattern}$}) over all possible&nbsp;_k_-mers.</span>
<span id="cb144-495"><a href="#cb144-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-496"><a href="#cb144-496" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-497"><a href="#cb144-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-498"><a href="#cb144-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-499"><a href="#cb144-499" aria-hidden="true" tabindex="-1"></a><span class="in">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb144-500"><a href="#cb144-500" aria-hidden="true" tabindex="-1"></a><span class="in">4 1</span></span>
<span id="cb144-501"><a href="#cb144-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-502"><a href="#cb144-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-503"><a href="#cb144-503" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-504"><a href="#cb144-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-505"><a href="#cb144-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-506"><a href="#cb144-506" aria-hidden="true" tabindex="-1"></a><span class="in">ATGT ACAT</span></span>
<span id="cb144-507"><a href="#cb144-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-508"><a href="#cb144-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-509"><a href="#cb144-509" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-510"><a href="#cb144-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-511"><a href="#cb144-511" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-512"><a href="#cb144-512" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-513"><a href="#cb144-513" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb144-514"><a href="#cb144-514" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb144-515"><a href="#cb144-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-516"><a href="#cb144-516" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-517"><a href="#cb144-517" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb144-518"><a href="#cb144-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-519"><a href="#cb144-519" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-520"><a href="#cb144-520" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb144-521"><a href="#cb144-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-522"><a href="#cb144-522" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna: <span class="bu">str</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-523"><a href="#cb144-523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna[i:i <span class="op">+</span> length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna) <span class="op">-</span> length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb144-524"><a href="#cb144-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-525"><a href="#cb144-525" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb144-526"><a href="#cb144-526" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb144-527"><a href="#cb144-527" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna, kmer_length):</span>
<span id="cb144-528"><a href="#cb144-528" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-529"><a href="#cb144-529" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb144-530"><a href="#cb144-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-531"><a href="#cb144-531" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-532"><a href="#cb144-532" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb144-533"><a href="#cb144-533" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb144-534"><a href="#cb144-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-535"><a href="#cb144-535" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-536"><a href="#cb144-536" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb144-537"><a href="#cb144-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-538"><a href="#cb144-538" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb144-539"><a href="#cb144-539" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb144-540"><a href="#cb144-540" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb144-541"><a href="#cb144-541" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb144-542"><a href="#cb144-542" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb144-543"><a href="#cb144-543" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> hamming_distance(reverse_complement(potential_kmer), observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb144-544"><a href="#cb144-544" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb144-545"><a href="#cb144-545" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb144-546"><a href="#cb144-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-547"><a href="#cb144-547" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb144-548"><a href="#cb144-548" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-549"><a href="#cb144-549" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb144-550"><a href="#cb144-550" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb144-551"><a href="#cb144-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-552"><a href="#cb144-552" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-553"><a href="#cb144-553" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb144-554"><a href="#cb144-554" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb144-555"><a href="#cb144-555" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-556"><a href="#cb144-556" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb144-557"><a href="#cb144-557" aria-hidden="true" tabindex="-1"></a>kmer_counts <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb144-558"><a href="#cb144-558" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(kmer_counts, max_mismatches, kmer_length))</span>
<span id="cb144-559"><a href="#cb144-559" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_most_frequent(approximate_kmer_counts))</span>
<span id="cb144-560"><a href="#cb144-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-561"><a href="#cb144-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-562"><a href="#cb144-562" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generate the Frequency Array of a String</span></span>
<span id="cb144-563"><a href="#cb144-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-564"><a href="#cb144-564" aria-hidden="true" tabindex="-1"></a>Computing a Frequency Array, Generate the frequency array of a DNA string.</span>
<span id="cb144-565"><a href="#cb144-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-566"><a href="#cb144-566" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;<span class="co">[</span><span class="ot">DNA string</span><span class="co">](https://rosalind.info/glossary/dna-string/)</span>&nbsp;_Text_&nbsp;and an integer&nbsp;_k_.</span>
<span id="cb144-567"><a href="#cb144-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-568"><a href="#cb144-568" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The frequency array of&nbsp;_k_-mers in&nbsp;_Text_.</span>
<span id="cb144-569"><a href="#cb144-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-570"><a href="#cb144-570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb144-571"><a href="#cb144-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-572"><a href="#cb144-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-573"><a href="#cb144-573" aria-hidden="true" tabindex="-1"></a><span class="in">ACGCGGCTCTGAAA</span></span>
<span id="cb144-574"><a href="#cb144-574" aria-hidden="true" tabindex="-1"></a><span class="in">2</span></span>
<span id="cb144-575"><a href="#cb144-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-576"><a href="#cb144-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-577"><a href="#cb144-577" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb144-578"><a href="#cb144-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-579"><a href="#cb144-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-580"><a href="#cb144-580" aria-hidden="true" tabindex="-1"></a><span class="in">2 1 0 0 0 0 2 2 1 2 1 0 0 1 1 0</span></span>
<span id="cb144-581"><a href="#cb144-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb144-582"><a href="#cb144-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-583"><a href="#cb144-583" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb144-584"><a href="#cb144-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-585"><a href="#cb144-585" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb144-586"><a href="#cb144-586" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict, Tuple</span>
<span id="cb144-587"><a href="#cb144-587" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb144-588"><a href="#cb144-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-589"><a href="#cb144-589" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-590"><a href="#cb144-590" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (text[i : i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb144-591"><a href="#cb144-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-592"><a href="#cb144-592" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-593"><a href="#cb144-593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb144-594"><a href="#cb144-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-595"><a href="#cb144-595" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(s1: <span class="bu">str</span>, s2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-596"><a href="#cb144-596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(s1, s2))</span>
<span id="cb144-597"><a href="#cb144-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-598"><a href="#cb144-598" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(k: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-599"><a href="#cb144-599" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>k))</span>
<span id="cb144-600"><a href="#cb144-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-601"><a href="#cb144-601" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb144-602"><a href="#cb144-602" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb144-603"><a href="#cb144-603" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb144-604"><a href="#cb144-604" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb144-605"><a href="#cb144-605" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb144-606"><a href="#cb144-606" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb144-607"><a href="#cb144-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-608"><a href="#cb144-608" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_frequencies(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb144-609"><a href="#cb144-609" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_pattern_occurrences(sequence, kmer) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length)]</span>
<span id="cb144-610"><a href="#cb144-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-611"><a href="#cb144-611" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb144-612"><a href="#cb144-612" aria-hidden="true" tabindex="-1"></a>    sequence, kmer_length <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-613"><a href="#cb144-613" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(kmer_length)</span>
<span id="cb144-614"><a href="#cb144-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-615"><a href="#cb144-615" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-616"><a href="#cb144-616" aria-hidden="true" tabindex="-1"></a><span class="st">ACGCGGCTCTGAAA</span></span>
<span id="cb144-617"><a href="#cb144-617" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb144-618"><a href="#cb144-618" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-619"><a href="#cb144-619" aria-hidden="true" tabindex="-1"></a>sequence, kmer_length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb144-620"><a href="#cb144-620" aria-hidden="true" tabindex="-1"></a>kmer_frequencies <span class="op">=</span> calculate_kmer_frequencies(sequence, kmer_length)</span>
<span id="cb144-621"><a href="#cb144-621" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>kmer_frequencies</span>
<span id="cb144-622"><a href="#cb144-622" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-623"><a href="#cb144-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-624"><a href="#cb144-624" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement PatternToNumber</span></span>
<span id="cb144-625"><a href="#cb144-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-626"><a href="#cb144-626" aria-hidden="true" tabindex="-1"></a>Implement PatternToNumber, Convert a DNA string to a number.</span>
<span id="cb144-627"><a href="#cb144-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-628"><a href="#cb144-628" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;_Pattern_.</span>
<span id="cb144-629"><a href="#cb144-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-630"><a href="#cb144-630" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;_PatternToNumber_(_Pattern_).</span>
<span id="cb144-631"><a href="#cb144-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-632"><a href="#cb144-632" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-633"><a href="#cb144-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-634"><a href="#cb144-634" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-635"><a href="#cb144-635" aria-hidden="true" tabindex="-1"></a>AGT</span>
<span id="cb144-636"><a href="#cb144-636" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-637"><a href="#cb144-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-638"><a href="#cb144-638" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-639"><a href="#cb144-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-640"><a href="#cb144-640" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-641"><a href="#cb144-641" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span></span>
<span id="cb144-642"><a href="#cb144-642" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-643"><a href="#cb144-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-644"><a href="#cb144-644" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-645"><a href="#cb144-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-646"><a href="#cb144-646" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-647"><a href="#cb144-647" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple</span>
<span id="cb144-648"><a href="#cb144-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-649"><a href="#cb144-649" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_nucleotide_to_number_map() <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb144-650"><a href="#cb144-650" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb144-651"><a href="#cb144-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-652"><a href="#cb144-652" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_nucleotide_to_number(nucleotide: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-653"><a href="#cb144-653" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotide_map[nucleotide]</span>
<span id="cb144-654"><a href="#cb144-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-655"><a href="#cb144-655" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_dna_pattern_to_number(dna_pattern: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-656"><a href="#cb144-656" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> dna_pattern:</span>
<span id="cb144-657"><a href="#cb144-657" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb144-658"><a href="#cb144-658" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> convert_dna_pattern_to_number(dna_pattern[:<span class="op">-</span><span class="dv">1</span>], nucleotide_map) <span class="op">+</span> convert_nucleotide_to_number(dna_pattern[<span class="op">-</span><span class="dv">1</span>], nucleotide_map)</span>
<span id="cb144-659"><a href="#cb144-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-660"><a href="#cb144-660" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-661"><a href="#cb144-661" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_data.strip()</span>
<span id="cb144-662"><a href="#cb144-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-663"><a href="#cb144-663" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-664"><a href="#cb144-664" aria-hidden="true" tabindex="-1"></a><span class="st">AGT</span></span>
<span id="cb144-665"><a href="#cb144-665" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-666"><a href="#cb144-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-667"><a href="#cb144-667" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb144-668"><a href="#cb144-668" aria-hidden="true" tabindex="-1"></a>nucleotide_map <span class="op">=</span> create_nucleotide_to_number_map()</span>
<span id="cb144-669"><a href="#cb144-669" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> convert_dna_pattern_to_number(dna_pattern, nucleotide_map)</span>
<span id="cb144-670"><a href="#cb144-670" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb144-671"><a href="#cb144-671" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-672"><a href="#cb144-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-673"><a href="#cb144-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement NumberToPattern</span></span>
<span id="cb144-674"><a href="#cb144-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-675"><a href="#cb144-675" aria-hidden="true" tabindex="-1"></a>Implement NumberToPattern, Convert an integer to its corresponding DNA string.</span>
<span id="cb144-676"><a href="#cb144-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-677"><a href="#cb144-677" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;_index_&nbsp;and&nbsp;_k_.</span>
<span id="cb144-678"><a href="#cb144-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-679"><a href="#cb144-679" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;_NumberToPattern_(_index_,&nbsp;_k_).</span>
<span id="cb144-680"><a href="#cb144-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-681"><a href="#cb144-681" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-682"><a href="#cb144-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-683"><a href="#cb144-683" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-684"><a href="#cb144-684" aria-hidden="true" tabindex="-1"></a><span class="dv">45</span></span>
<span id="cb144-685"><a href="#cb144-685" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb144-686"><a href="#cb144-686" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-687"><a href="#cb144-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-688"><a href="#cb144-688" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-689"><a href="#cb144-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-690"><a href="#cb144-690" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-691"><a href="#cb144-691" aria-hidden="true" tabindex="-1"></a>AGTC</span>
<span id="cb144-692"><a href="#cb144-692" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-693"><a href="#cb144-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-694"><a href="#cb144-694" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-695"><a href="#cb144-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-696"><a href="#cb144-696" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-697"><a href="#cb144-697" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb144-698"><a href="#cb144-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-699"><a href="#cb144-699" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_nucleotide(index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-700"><a href="#cb144-700" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb144-701"><a href="#cb144-701" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotides[index]</span>
<span id="cb144-702"><a href="#cb144-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-703"><a href="#cb144-703" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_dna_pattern(index: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-704"><a href="#cb144-704" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> length <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb144-705"><a href="#cb144-705" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> number_to_nucleotide(index)</span>
<span id="cb144-706"><a href="#cb144-706" aria-hidden="true" tabindex="-1"></a>    quotient, remainder <span class="op">=</span> <span class="bu">divmod</span>(index, <span class="dv">4</span>)</span>
<span id="cb144-707"><a href="#cb144-707" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> number_to_dna_pattern(quotient, length <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> number_to_nucleotide(remainder)</span>
<span id="cb144-708"><a href="#cb144-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-709"><a href="#cb144-709" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb144-710"><a href="#cb144-710" aria-hidden="true" tabindex="-1"></a>    index_str, length_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-711"><a href="#cb144-711" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(index_str), <span class="bu">int</span>(length_str)</span>
<span id="cb144-712"><a href="#cb144-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-713"><a href="#cb144-713" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-714"><a href="#cb144-714" aria-hidden="true" tabindex="-1"></a><span class="st">45</span></span>
<span id="cb144-715"><a href="#cb144-715" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb144-716"><a href="#cb144-716" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-717"><a href="#cb144-717" aria-hidden="true" tabindex="-1"></a>index, length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb144-718"><a href="#cb144-718" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> number_to_dna_pattern(index, length)</span>
<span id="cb144-719"><a href="#cb144-719" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dna_pattern)</span>
<span id="cb144-720"><a href="#cb144-720" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-721"><a href="#cb144-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-722"><a href="#cb144-722" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the d-Neighborhood of a String</span></span>
<span id="cb144-723"><a href="#cb144-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-724"><a href="#cb144-724" aria-hidden="true" tabindex="-1"></a>Generate the d<span class="op">-</span>Neighborhood of a String Find <span class="bu">all</span> the neighbors of a pattern.</span>
<span id="cb144-725"><a href="#cb144-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-726"><a href="#cb144-726" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;_Pattern_&nbsp;and an integer&nbsp;_d_.</span>
<span id="cb144-727"><a href="#cb144-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-728"><a href="#cb144-728" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The collection of strings&nbsp;_Neighbors_(_Pattern_,&nbsp;_d_).</span>
<span id="cb144-729"><a href="#cb144-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-730"><a href="#cb144-730" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-731"><a href="#cb144-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-732"><a href="#cb144-732" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-733"><a href="#cb144-733" aria-hidden="true" tabindex="-1"></a>ACG</span>
<span id="cb144-734"><a href="#cb144-734" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb144-735"><a href="#cb144-735" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-736"><a href="#cb144-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-737"><a href="#cb144-737" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-738"><a href="#cb144-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-739"><a href="#cb144-739" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-740"><a href="#cb144-740" aria-hidden="true" tabindex="-1"></a>CCG</span>
<span id="cb144-741"><a href="#cb144-741" aria-hidden="true" tabindex="-1"></a>TCG</span>
<span id="cb144-742"><a href="#cb144-742" aria-hidden="true" tabindex="-1"></a>GCG</span>
<span id="cb144-743"><a href="#cb144-743" aria-hidden="true" tabindex="-1"></a>AAG</span>
<span id="cb144-744"><a href="#cb144-744" aria-hidden="true" tabindex="-1"></a>ATG</span>
<span id="cb144-745"><a href="#cb144-745" aria-hidden="true" tabindex="-1"></a>AGG</span>
<span id="cb144-746"><a href="#cb144-746" aria-hidden="true" tabindex="-1"></a>ACA</span>
<span id="cb144-747"><a href="#cb144-747" aria-hidden="true" tabindex="-1"></a>ACC</span>
<span id="cb144-748"><a href="#cb144-748" aria-hidden="true" tabindex="-1"></a>ACT</span>
<span id="cb144-749"><a href="#cb144-749" aria-hidden="true" tabindex="-1"></a>ACG</span>
<span id="cb144-750"><a href="#cb144-750" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-751"><a href="#cb144-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-752"><a href="#cb144-752" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-753"><a href="#cb144-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-754"><a href="#cb144-754" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-755"><a href="#cb144-755" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Set, List, Tuple, Iterator</span>
<span id="cb144-756"><a href="#cb144-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-757"><a href="#cb144-757" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-758"><a href="#cb144-758" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb144-759"><a href="#cb144-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-760"><a href="#cb144-760" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_immediate_neighbors(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-761"><a href="#cb144-761" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb144-762"><a href="#cb144-762" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, current_base <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb144-763"><a href="#cb144-763" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> new_base <span class="kw">in</span> nucleotides:</span>
<span id="cb144-764"><a href="#cb144-764" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> new_base <span class="op">!=</span> current_base:</span>
<span id="cb144-765"><a href="#cb144-765" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence[:i] <span class="op">+</span> new_base <span class="op">+</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:]</span>
<span id="cb144-766"><a href="#cb144-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-767"><a href="#cb144-767" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb144-768"><a href="#cb144-768" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb144-769"><a href="#cb144-769" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb144-770"><a href="#cb144-770" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb144-771"><a href="#cb144-771" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb144-772"><a href="#cb144-772" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb144-773"><a href="#cb144-773" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-774"><a href="#cb144-774" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb144-775"><a href="#cb144-775" aria-hidden="true" tabindex="-1"></a>    suffix_neighbors <span class="op">=</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance)</span>
<span id="cb144-776"><a href="#cb144-776" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> suffix <span class="kw">in</span> suffix_neighbors:</span>
<span id="cb144-777"><a href="#cb144-777" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], suffix) <span class="op">&lt;</span> max_distance:</span>
<span id="cb144-778"><a href="#cb144-778" aria-hidden="true" tabindex="-1"></a>            neighbors.update(base <span class="op">+</span> suffix <span class="cf">for</span> base <span class="kw">in</span> nucleotides)</span>
<span id="cb144-779"><a href="#cb144-779" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb144-780"><a href="#cb144-780" aria-hidden="true" tabindex="-1"></a>            neighbors.add(sequence[<span class="dv">0</span>] <span class="op">+</span> suffix)</span>
<span id="cb144-781"><a href="#cb144-781" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbors</span>
<span id="cb144-782"><a href="#cb144-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-783"><a href="#cb144-783" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb144-784"><a href="#cb144-784" aria-hidden="true" tabindex="-1"></a>    sequence, distance <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-785"><a href="#cb144-785" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(distance)</span>
<span id="cb144-786"><a href="#cb144-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-787"><a href="#cb144-787" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-788"><a href="#cb144-788" aria-hidden="true" tabindex="-1"></a><span class="st">ACG</span></span>
<span id="cb144-789"><a href="#cb144-789" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb144-790"><a href="#cb144-790" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-791"><a href="#cb144-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-792"><a href="#cb144-792" aria-hidden="true" tabindex="-1"></a>sequence, max_distance <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb144-793"><a href="#cb144-793" aria-hidden="true" tabindex="-1"></a>neighbor_sequences <span class="op">=</span> generate_neighbors(sequence, max_distance)</span>
<span id="cb144-794"><a href="#cb144-794" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(neighbor_sequences), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-795"><a href="#cb144-795" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-796"><a href="#cb144-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-797"><a href="#cb144-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-798"><a href="#cb144-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-799"><a href="#cb144-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-800"><a href="#cb144-800" aria-hidden="true" tabindex="-1"></a><span class="op">----</span></span>
<span id="cb144-801"><a href="#cb144-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-802"><a href="#cb144-802" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of a Hidden Path</span></span>
<span id="cb144-803"><a href="#cb144-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-804"><a href="#cb144-804" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A hidden path $π$ followed by the states&nbsp;_States_&nbsp;and transition matrix&nbsp;_Transition_&nbsp;of an HMM ($Σ$,&nbsp;_States_,&nbsp;_Transition_,&nbsp;_Emission_).</span>
<span id="cb144-805"><a href="#cb144-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-806"><a href="#cb144-806" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The probability of this path, $Pr(π)$. You may assume that initial probabilities are equal.</span>
<span id="cb144-807"><a href="#cb144-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-808"><a href="#cb144-808" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-809"><a href="#cb144-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-810"><a href="#cb144-810" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-811"><a href="#cb144-811" aria-hidden="true" tabindex="-1"></a>AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span>
<span id="cb144-812"><a href="#cb144-812" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-813"><a href="#cb144-813" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb144-814"><a href="#cb144-814" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-815"><a href="#cb144-815" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb144-816"><a href="#cb144-816" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.194</span>   <span class="fl">0.806</span></span>
<span id="cb144-817"><a href="#cb144-817" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.273</span>   <span class="fl">0.727</span></span>
<span id="cb144-818"><a href="#cb144-818" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-819"><a href="#cb144-819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-820"><a href="#cb144-820" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-821"><a href="#cb144-821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-822"><a href="#cb144-822" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-823"><a href="#cb144-823" aria-hidden="true" tabindex="-1"></a><span class="fl">5.01732865318e-19</span></span>
<span id="cb144-824"><a href="#cb144-824" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-825"><a href="#cb144-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-826"><a href="#cb144-826" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-827"><a href="#cb144-827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-828"><a href="#cb144-828" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-829"><a href="#cb144-829" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb144-830"><a href="#cb144-830" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-831"><a href="#cb144-831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-832"><a href="#cb144-832" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hidden_path_data(input_lines):</span>
<span id="cb144-833"><a href="#cb144-833" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb144-834"><a href="#cb144-834" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb144-835"><a href="#cb144-835" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb144-836"><a href="#cb144-836" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb144-837"><a href="#cb144-837" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb144-838"><a href="#cb144-838" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-839"><a href="#cb144-839" aria-hidden="true" tabindex="-1"></a>    transition_probabilities <span class="op">=</span> {}</span>
<span id="cb144-840"><a href="#cb144-840" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb144-841"><a href="#cb144-841" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb144-842"><a href="#cb144-842" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb144-843"><a href="#cb144-843" aria-hidden="true" tabindex="-1"></a>            current_state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb144-844"><a href="#cb144-844" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> next_state, probability <span class="kw">in</span> <span class="bu">zip</span>(states, row_data[<span class="dv">1</span>:]):</span>
<span id="cb144-845"><a href="#cb144-845" aria-hidden="true" tabindex="-1"></a>                transition_probabilities[(current_state, next_state)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb144-846"><a href="#cb144-846" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-847"><a href="#cb144-847" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hidden_path, transition_probabilities</span>
<span id="cb144-848"><a href="#cb144-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-849"><a href="#cb144-849" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hidden_path_probability(hidden_path, transition_probabilities):</span>
<span id="cb144-850"><a href="#cb144-850" aria-hidden="true" tabindex="-1"></a>    initial_probability <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb144-851"><a href="#cb144-851" aria-hidden="true" tabindex="-1"></a>    path_probability <span class="op">=</span> initial_probability <span class="op">*</span> prod(</span>
<span id="cb144-852"><a href="#cb144-852" aria-hidden="true" tabindex="-1"></a>        transition_probabilities[state_pair] </span>
<span id="cb144-853"><a href="#cb144-853" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> state_pair <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, hidden_path[<span class="dv">1</span>:])</span>
<span id="cb144-854"><a href="#cb144-854" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb144-855"><a href="#cb144-855" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_probability</span>
<span id="cb144-856"><a href="#cb144-856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-857"><a href="#cb144-857" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-858"><a href="#cb144-858" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span></span>
<span id="cb144-859"><a href="#cb144-859" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-860"><a href="#cb144-860" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb144-861"><a href="#cb144-861" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-862"><a href="#cb144-862" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb144-863"><a href="#cb144-863" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.194   0.806</span></span>
<span id="cb144-864"><a href="#cb144-864" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.273   0.727</span></span>
<span id="cb144-865"><a href="#cb144-865" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-866"><a href="#cb144-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-867"><a href="#cb144-867" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb144-868"><a href="#cb144-868" aria-hidden="true" tabindex="-1"></a>hidden_path, transition_probabilities <span class="op">=</span> parse_hidden_path_data(input_lines)</span>
<span id="cb144-869"><a href="#cb144-869" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_hidden_path_probability(hidden_path, transition_probabilities)</span>
<span id="cb144-870"><a href="#cb144-870" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span>
<span id="cb144-871"><a href="#cb144-871" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-872"><a href="#cb144-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-873"><a href="#cb144-873" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of an Outcome Given a Hidden Path</span></span>
<span id="cb144-874"><a href="#cb144-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-875"><a href="#cb144-875" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;_x_, followed by the alphabet&nbsp;_Σ_&nbsp;from which&nbsp;_x_&nbsp;was constructed, followed by a hidden path&nbsp;_π_, followed by the states&nbsp;_States_&nbsp;and emission matrix&nbsp;_Emission_&nbsp;of an HMM (_Σ_,&nbsp;_States_,&nbsp;_Transition_,&nbsp;_Emission_).</span>
<span id="cb144-876"><a href="#cb144-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-877"><a href="#cb144-877" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The conditional probability $Pr(x<span class="op">|</span>π)$ that string&nbsp;_x_&nbsp;will be emitted by the HMM given the hidden path&nbsp;_π_.</span>
<span id="cb144-878"><a href="#cb144-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-879"><a href="#cb144-879" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-880"><a href="#cb144-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-881"><a href="#cb144-881" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-882"><a href="#cb144-882" aria-hidden="true" tabindex="-1"></a>xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span>
<span id="cb144-883"><a href="#cb144-883" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-884"><a href="#cb144-884" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb144-885"><a href="#cb144-885" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-886"><a href="#cb144-886" aria-hidden="true" tabindex="-1"></a>BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span>
<span id="cb144-887"><a href="#cb144-887" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-888"><a href="#cb144-888" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb144-889"><a href="#cb144-889" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-890"><a href="#cb144-890" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb144-891"><a href="#cb144-891" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.612</span>   <span class="fl">0.314</span>   <span class="fl">0.074</span> </span>
<span id="cb144-892"><a href="#cb144-892" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.346</span>   <span class="fl">0.317</span>   <span class="fl">0.336</span></span>
<span id="cb144-893"><a href="#cb144-893" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-894"><a href="#cb144-894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-895"><a href="#cb144-895" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-896"><a href="#cb144-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-897"><a href="#cb144-897" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-898"><a href="#cb144-898" aria-hidden="true" tabindex="-1"></a><span class="fl">1.93157070893e-28</span></span>
<span id="cb144-899"><a href="#cb144-899" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-900"><a href="#cb144-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-901"><a href="#cb144-901" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-902"><a href="#cb144-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-903"><a href="#cb144-903" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-904"><a href="#cb144-904" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb144-905"><a href="#cb144-905" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-906"><a href="#cb144-906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-907"><a href="#cb144-907" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_emission_data(input_lines):</span>
<span id="cb144-908"><a href="#cb144-908" aria-hidden="true" tabindex="-1"></a>    emission_sequence <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb144-909"><a href="#cb144-909" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb144-910"><a href="#cb144-910" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb144-911"><a href="#cb144-911" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb144-912"><a href="#cb144-912" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb144-913"><a href="#cb144-913" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb144-914"><a href="#cb144-914" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb144-915"><a href="#cb144-915" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb144-916"><a href="#cb144-916" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb144-917"><a href="#cb144-917" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-918"><a href="#cb144-918" aria-hidden="true" tabindex="-1"></a>    emission_probabilities <span class="op">=</span> {}</span>
<span id="cb144-919"><a href="#cb144-919" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb144-920"><a href="#cb144-920" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb144-921"><a href="#cb144-921" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb144-922"><a href="#cb144-922" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb144-923"><a href="#cb144-923" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> symbol, probability <span class="kw">in</span> <span class="bu">zip</span>(symbols, row_data[<span class="dv">1</span>:]):</span>
<span id="cb144-924"><a href="#cb144-924" aria-hidden="true" tabindex="-1"></a>                emission_probabilities[(state, symbol)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb144-925"><a href="#cb144-925" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-926"><a href="#cb144-926" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emission_sequence, hidden_path, emission_probabilities</span>
<span id="cb144-927"><a href="#cb144-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-928"><a href="#cb144-928" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities):</span>
<span id="cb144-929"><a href="#cb144-929" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prod(emission_probabilities[state_symbol] <span class="cf">for</span> state_symbol <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, emission_sequence))</span>
<span id="cb144-930"><a href="#cb144-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-931"><a href="#cb144-931" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-932"><a href="#cb144-932" aria-hidden="true" tabindex="-1"></a><span class="st">xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span></span>
<span id="cb144-933"><a href="#cb144-933" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-934"><a href="#cb144-934" aria-hidden="true" tabindex="-1"></a><span class="st">x y z</span></span>
<span id="cb144-935"><a href="#cb144-935" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-936"><a href="#cb144-936" aria-hidden="true" tabindex="-1"></a><span class="st">BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span></span>
<span id="cb144-937"><a href="#cb144-937" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-938"><a href="#cb144-938" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb144-939"><a href="#cb144-939" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-940"><a href="#cb144-940" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb144-941"><a href="#cb144-941" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.612   0.314   0.074 </span></span>
<span id="cb144-942"><a href="#cb144-942" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.346   0.317   0.336</span></span>
<span id="cb144-943"><a href="#cb144-943" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-944"><a href="#cb144-944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-945"><a href="#cb144-945" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb144-946"><a href="#cb144-946" aria-hidden="true" tabindex="-1"></a>emission_sequence, hidden_path, emission_probabilities <span class="op">=</span> parse_emission_data(input_lines)</span>
<span id="cb144-947"><a href="#cb144-947" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities)</span>
<span id="cb144-948"><a href="#cb144-948" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span>
<span id="cb144-949"><a href="#cb144-949" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-950"><a href="#cb144-950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-951"><a href="#cb144-951" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement the Viterbi Algorithm</span></span>
<span id="cb144-952"><a href="#cb144-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-953"><a href="#cb144-953" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;_x_, followed by the alphabet&nbsp;_Σ_&nbsp;from which&nbsp;_x_&nbsp;was constructed, followed by the states&nbsp;_States_, transition matrix&nbsp;_Transition_, <span class="kw">and</span> emission matrix&nbsp;_Emission_&nbsp;of an HMM (_Σ_,&nbsp;_States_,&nbsp;_Transition_,&nbsp;_Emission_).</span>
<span id="cb144-954"><a href="#cb144-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-955"><a href="#cb144-955" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A path that maximizes the (unconditional) probability Pr(_x_,&nbsp;_π_) over <span class="bu">all</span> possible paths&nbsp;_π_.</span>
<span id="cb144-956"><a href="#cb144-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-957"><a href="#cb144-957" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-958"><a href="#cb144-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-959"><a href="#cb144-959" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-960"><a href="#cb144-960" aria-hidden="true" tabindex="-1"></a>xyxzzxyxyy</span>
<span id="cb144-961"><a href="#cb144-961" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-962"><a href="#cb144-962" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb144-963"><a href="#cb144-963" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-964"><a href="#cb144-964" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb144-965"><a href="#cb144-965" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-966"><a href="#cb144-966" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb144-967"><a href="#cb144-967" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.641</span>   <span class="fl">0.359</span></span>
<span id="cb144-968"><a href="#cb144-968" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.729</span>   <span class="fl">0.271</span></span>
<span id="cb144-969"><a href="#cb144-969" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-970"><a href="#cb144-970" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb144-971"><a href="#cb144-971" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.117</span>   <span class="fl">0.691</span>   <span class="fl">0.192</span>   </span>
<span id="cb144-972"><a href="#cb144-972" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.097</span>   <span class="fl">0.42</span>    <span class="fl">0.483</span></span>
<span id="cb144-973"><a href="#cb144-973" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-974"><a href="#cb144-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-975"><a href="#cb144-975" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-976"><a href="#cb144-976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-977"><a href="#cb144-977" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-978"><a href="#cb144-978" aria-hidden="true" tabindex="-1"></a>AAABBAAAAA</span>
<span id="cb144-979"><a href="#cb144-979" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-980"><a href="#cb144-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-981"><a href="#cb144-981" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-982"><a href="#cb144-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-983"><a href="#cb144-983" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-984"><a href="#cb144-984" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-985"><a href="#cb144-985" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb144-986"><a href="#cb144-986" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb144-987"><a href="#cb144-987" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb144-988"><a href="#cb144-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-989"><a href="#cb144-989" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb144-990"><a href="#cb144-990" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb144-991"><a href="#cb144-991" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-992"><a href="#cb144-992" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb144-993"><a href="#cb144-993" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-994"><a href="#cb144-994" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb144-995"><a href="#cb144-995" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-996"><a href="#cb144-996" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-997"><a href="#cb144-997" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-998"><a href="#cb144-998" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb144-999"><a href="#cb144-999" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb144-1000"><a href="#cb144-1000" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb144-1001"><a href="#cb144-1001" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb144-1002"><a href="#cb144-1002" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-1003"><a href="#cb144-1003" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-1004"><a href="#cb144-1004" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1005"><a href="#cb144-1005" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-1006"><a href="#cb144-1006" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb144-1007"><a href="#cb144-1007" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb144-1008"><a href="#cb144-1008" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb144-1009"><a href="#cb144-1009" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb144-1010"><a href="#cb144-1010" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-1011"><a href="#cb144-1011" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-1012"><a href="#cb144-1012" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb144-1013"><a href="#cb144-1013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1014"><a href="#cb144-1014" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-1015"><a href="#cb144-1015" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> <span class="bu">len</span>(states)</span>
<span id="cb144-1016"><a href="#cb144-1016" aria-hidden="true" tabindex="-1"></a>    sequence_length <span class="op">=</span> <span class="bu">len</span>(sequence)</span>
<span id="cb144-1017"><a href="#cb144-1017" aria-hidden="true" tabindex="-1"></a>    viterbi_matrix <span class="op">=</span> np.zeros((sequence_length, num_states))</span>
<span id="cb144-1018"><a href="#cb144-1018" aria-hidden="true" tabindex="-1"></a>    backpointer <span class="op">=</span> np.zeros((sequence_length, num_states), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb144-1019"><a href="#cb144-1019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1020"><a href="#cb144-1020" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the first column of the viterbi matrix</span></span>
<span id="cb144-1021"><a href="#cb144-1021" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-1022"><a href="#cb144-1022" aria-hidden="true" tabindex="-1"></a>        viterbi_matrix[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> num_states)</span>
<span id="cb144-1023"><a href="#cb144-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1024"><a href="#cb144-1024" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill in the rest of the viterbi matrix</span></span>
<span id="cb144-1025"><a href="#cb144-1025" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, sequence_length):</span>
<span id="cb144-1026"><a href="#cb144-1026" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-1027"><a href="#cb144-1027" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> [</span>
<span id="cb144-1028"><a href="#cb144-1028" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[previous_state, current_state]) <span class="op">+</span> </span>
<span id="cb144-1029"><a href="#cb144-1029" aria-hidden="true" tabindex="-1"></a>                log(emission_matrix[current_state, sequence[t]]) <span class="op">+</span> </span>
<span id="cb144-1030"><a href="#cb144-1030" aria-hidden="true" tabindex="-1"></a>                viterbi_matrix[t<span class="op">-</span><span class="dv">1</span>, k]</span>
<span id="cb144-1031"><a href="#cb144-1031" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb144-1032"><a href="#cb144-1032" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb144-1033"><a href="#cb144-1033" aria-hidden="true" tabindex="-1"></a>            max_prob_index <span class="op">=</span> probabilities.index(<span class="bu">max</span>(probabilities))</span>
<span id="cb144-1034"><a href="#cb144-1034" aria-hidden="true" tabindex="-1"></a>            backpointer[t, j] <span class="op">=</span> max_prob_index</span>
<span id="cb144-1035"><a href="#cb144-1035" aria-hidden="true" tabindex="-1"></a>            viterbi_matrix[t, j] <span class="op">=</span> <span class="bu">max</span>(probabilities)</span>
<span id="cb144-1036"><a href="#cb144-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1037"><a href="#cb144-1037" aria-hidden="true" tabindex="-1"></a>    best_path_index <span class="op">=</span> np.argmax(viterbi_matrix[<span class="op">-</span><span class="dv">1</span>, :])</span>
<span id="cb144-1038"><a href="#cb144-1038" aria-hidden="true" tabindex="-1"></a>    best_path <span class="op">=</span> states[best_path_index]</span>
<span id="cb144-1039"><a href="#cb144-1039" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(sequence_length <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb144-1040"><a href="#cb144-1040" aria-hidden="true" tabindex="-1"></a>        best_path_index <span class="op">=</span> backpointer[t, best_path_index]</span>
<span id="cb144-1041"><a href="#cb144-1041" aria-hidden="true" tabindex="-1"></a>        best_path <span class="op">=</span> states[best_path_index] <span class="op">+</span> best_path</span>
<span id="cb144-1042"><a href="#cb144-1042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1043"><a href="#cb144-1043" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_path</span>
<span id="cb144-1044"><a href="#cb144-1044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1045"><a href="#cb144-1045" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb144-1046"><a href="#cb144-1046" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-1047"><a href="#cb144-1047" aria-hidden="true" tabindex="-1"></a><span class="st">xyxzzxyxyy</span></span>
<span id="cb144-1048"><a href="#cb144-1048" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1049"><a href="#cb144-1049" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb144-1050"><a href="#cb144-1050" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1051"><a href="#cb144-1051" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb144-1052"><a href="#cb144-1052" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1053"><a href="#cb144-1053" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb144-1054"><a href="#cb144-1054" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.641   0.359</span></span>
<span id="cb144-1055"><a href="#cb144-1055" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.729   0.271</span></span>
<span id="cb144-1056"><a href="#cb144-1056" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1057"><a href="#cb144-1057" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb144-1058"><a href="#cb144-1058" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.117   0.691   0.192   </span></span>
<span id="cb144-1059"><a href="#cb144-1059" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.097   0.42    0.483</span></span>
<span id="cb144-1060"><a href="#cb144-1060" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-1061"><a href="#cb144-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1062"><a href="#cb144-1062" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb144-1063"><a href="#cb144-1063" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb144-1064"><a href="#cb144-1064" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb144-1065"><a href="#cb144-1065" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb144-1066"><a href="#cb144-1066" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1067"><a href="#cb144-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1068"><a href="#cb144-1068" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of a String Emitted by an HMM</span></span>
<span id="cb144-1069"><a href="#cb144-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1070"><a href="#cb144-1070" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;_x_, followed by the alphabet&nbsp;_Σ_&nbsp;from which&nbsp;_x_&nbsp;was constructed, followed by the states&nbsp;_States_, transition matrix&nbsp;_Transition_, <span class="kw">and</span> emission matrix&nbsp;_Emission_&nbsp;of an HMM (_Σ_,&nbsp;_States_,&nbsp;_Transition_,&nbsp;_Emission_).</span>
<span id="cb144-1071"><a href="#cb144-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1072"><a href="#cb144-1072" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The probability Pr(_x_) that the HMM emits&nbsp;_x_.</span>
<span id="cb144-1073"><a href="#cb144-1073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1074"><a href="#cb144-1074" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-1075"><a href="#cb144-1075" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1076"><a href="#cb144-1076" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1077"><a href="#cb144-1077" aria-hidden="true" tabindex="-1"></a>xzyyzzyzyy</span>
<span id="cb144-1078"><a href="#cb144-1078" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1079"><a href="#cb144-1079" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb144-1080"><a href="#cb144-1080" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1081"><a href="#cb144-1081" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb144-1082"><a href="#cb144-1082" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1083"><a href="#cb144-1083" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb144-1084"><a href="#cb144-1084" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.303</span>   <span class="fl">0.697</span> </span>
<span id="cb144-1085"><a href="#cb144-1085" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.831</span>   <span class="fl">0.169</span> </span>
<span id="cb144-1086"><a href="#cb144-1086" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1087"><a href="#cb144-1087" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb144-1088"><a href="#cb144-1088" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.533</span>   <span class="fl">0.065</span>   <span class="fl">0.402</span> </span>
<span id="cb144-1089"><a href="#cb144-1089" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.342</span>   <span class="fl">0.334</span>   <span class="fl">0.324</span></span>
<span id="cb144-1090"><a href="#cb144-1090" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1091"><a href="#cb144-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1092"><a href="#cb144-1092" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-1093"><a href="#cb144-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1094"><a href="#cb144-1094" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1095"><a href="#cb144-1095" aria-hidden="true" tabindex="-1"></a><span class="fl">1.1005510319694847e-06</span></span>
<span id="cb144-1096"><a href="#cb144-1096" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1097"><a href="#cb144-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1098"><a href="#cb144-1098" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-1099"><a href="#cb144-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1100"><a href="#cb144-1100" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-1101"><a href="#cb144-1101" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-1102"><a href="#cb144-1102" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb144-1103"><a href="#cb144-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1104"><a href="#cb144-1104" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator):</span>
<span id="cb144-1105"><a href="#cb144-1105" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb144-1106"><a href="#cb144-1106" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1107"><a href="#cb144-1107" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb144-1108"><a href="#cb144-1108" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1109"><a href="#cb144-1109" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb144-1110"><a href="#cb144-1110" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1111"><a href="#cb144-1111" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-1112"><a href="#cb144-1112" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-1113"><a href="#cb144-1113" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb144-1114"><a href="#cb144-1114" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb144-1115"><a href="#cb144-1115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb144-1116"><a href="#cb144-1116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb144-1117"><a href="#cb144-1117" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-1118"><a href="#cb144-1118" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-1119"><a href="#cb144-1119" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1120"><a href="#cb144-1120" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-1121"><a href="#cb144-1121" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb144-1122"><a href="#cb144-1122" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb144-1123"><a href="#cb144-1123" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb144-1124"><a href="#cb144-1124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb144-1125"><a href="#cb144-1125" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-1126"><a href="#cb144-1126" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-1127"><a href="#cb144-1127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb144-1128"><a href="#cb144-1128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1129"><a href="#cb144-1129" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix):</span>
<span id="cb144-1130"><a href="#cb144-1130" aria-hidden="true" tabindex="-1"></a>    probability_matrix <span class="op">=</span> np.ones((<span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(states)))</span>
<span id="cb144-1131"><a href="#cb144-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1132"><a href="#cb144-1132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-1133"><a href="#cb144-1133" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>, i] <span class="op">=</span> emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states)</span>
<span id="cb144-1134"><a href="#cb144-1134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1135"><a href="#cb144-1135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb144-1136"><a href="#cb144-1136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-1137"><a href="#cb144-1137" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb144-1138"><a href="#cb144-1138" aria-hidden="true" tabindex="-1"></a>                transition_matrix[previous_state, current_state] <span class="op">*</span> </span>
<span id="cb144-1139"><a href="#cb144-1139" aria-hidden="true" tabindex="-1"></a>                emission_matrix[current_state, emission] <span class="op">*</span> </span>
<span id="cb144-1140"><a href="#cb144-1140" aria-hidden="true" tabindex="-1"></a>                probability_matrix[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb144-1141"><a href="#cb144-1141" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb144-1142"><a href="#cb144-1142" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb144-1143"><a href="#cb144-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1144"><a href="#cb144-1144" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(probability_matrix[i, :])</span>
<span id="cb144-1145"><a href="#cb144-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1146"><a href="#cb144-1146" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-1147"><a href="#cb144-1147" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzzyzyy</span></span>
<span id="cb144-1148"><a href="#cb144-1148" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1149"><a href="#cb144-1149" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb144-1150"><a href="#cb144-1150" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1151"><a href="#cb144-1151" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb144-1152"><a href="#cb144-1152" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1153"><a href="#cb144-1153" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb144-1154"><a href="#cb144-1154" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.303   0.697 </span></span>
<span id="cb144-1155"><a href="#cb144-1155" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.831   0.169 </span></span>
<span id="cb144-1156"><a href="#cb144-1156" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1157"><a href="#cb144-1157" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb144-1158"><a href="#cb144-1158" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.533   0.065   0.402 </span></span>
<span id="cb144-1159"><a href="#cb144-1159" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.342   0.334   0.324</span></span>
<span id="cb144-1160"><a href="#cb144-1160" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-1161"><a href="#cb144-1161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1162"><a href="#cb144-1162" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb144-1163"><a href="#cb144-1163" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb144-1164"><a href="#cb144-1164" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb144-1165"><a href="#cb144-1165" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb144-1166"><a href="#cb144-1166" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1167"><a href="#cb144-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1168"><a href="#cb144-1168" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a Profile HMM</span></span>
<span id="cb144-1169"><a href="#cb144-1169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1170"><a href="#cb144-1170" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A threshold&nbsp;_θ_, followed by an alphabet&nbsp;_Σ_, followed by a multiple alignment&nbsp;_Alignment_&nbsp;whose strings are formed from&nbsp;_Σ_.</span>
<span id="cb144-1171"><a href="#cb144-1171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1172"><a href="#cb144-1172" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The transition <span class="kw">and</span> emission probabilities of the profile HMM&nbsp;_HMM_(_Alignment_,&nbsp;_θ_).</span>
<span id="cb144-1173"><a href="#cb144-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1174"><a href="#cb144-1174" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-1175"><a href="#cb144-1175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1176"><a href="#cb144-1176" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1177"><a href="#cb144-1177" aria-hidden="true" tabindex="-1"></a><span class="fl">0.289</span></span>
<span id="cb144-1178"><a href="#cb144-1178" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1179"><a href="#cb144-1179" aria-hidden="true" tabindex="-1"></a>A   B   C   D   E</span>
<span id="cb144-1180"><a href="#cb144-1180" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1181"><a href="#cb144-1181" aria-hidden="true" tabindex="-1"></a>EBA</span>
<span id="cb144-1182"><a href="#cb144-1182" aria-hidden="true" tabindex="-1"></a>EBD</span>
<span id="cb144-1183"><a href="#cb144-1183" aria-hidden="true" tabindex="-1"></a>EB<span class="op">-</span></span>
<span id="cb144-1184"><a href="#cb144-1184" aria-hidden="true" tabindex="-1"></a>EED</span>
<span id="cb144-1185"><a href="#cb144-1185" aria-hidden="true" tabindex="-1"></a>EBD</span>
<span id="cb144-1186"><a href="#cb144-1186" aria-hidden="true" tabindex="-1"></a>EBE</span>
<span id="cb144-1187"><a href="#cb144-1187" aria-hidden="true" tabindex="-1"></a>E<span class="op">-</span>D</span>
<span id="cb144-1188"><a href="#cb144-1188" aria-hidden="true" tabindex="-1"></a>EBD</span>
<span id="cb144-1189"><a href="#cb144-1189" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1190"><a href="#cb144-1190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1191"><a href="#cb144-1191" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-1192"><a href="#cb144-1192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1193"><a href="#cb144-1193" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1194"><a href="#cb144-1194" aria-hidden="true" tabindex="-1"></a>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E</span>
<span id="cb144-1195"><a href="#cb144-1195" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span> <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1196"><a href="#cb144-1196" aria-hidden="true" tabindex="-1"></a>I0  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1197"><a href="#cb144-1197" aria-hidden="true" tabindex="-1"></a>M1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.875</span>   <span class="fl">0.125</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1198"><a href="#cb144-1198" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1199"><a href="#cb144-1199" aria-hidden="true" tabindex="-1"></a>I1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1200"><a href="#cb144-1200" aria-hidden="true" tabindex="-1"></a>M2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.857</span>   <span class="fl">0.143</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1201"><a href="#cb144-1201" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span> <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1202"><a href="#cb144-1202" aria-hidden="true" tabindex="-1"></a>I2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1203"><a href="#cb144-1203" aria-hidden="true" tabindex="-1"></a>M3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span></span>
<span id="cb144-1204"><a href="#cb144-1204" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span></span>
<span id="cb144-1205"><a href="#cb144-1205" aria-hidden="true" tabindex="-1"></a>I3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1206"><a href="#cb144-1206" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1207"><a href="#cb144-1207" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1208"><a href="#cb144-1208" aria-hidden="true" tabindex="-1"></a>    A   B   C   D   E</span>
<span id="cb144-1209"><a href="#cb144-1209" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1210"><a href="#cb144-1210" aria-hidden="true" tabindex="-1"></a>I0  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1211"><a href="#cb144-1211" aria-hidden="true" tabindex="-1"></a>M1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span></span>
<span id="cb144-1212"><a href="#cb144-1212" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1213"><a href="#cb144-1213" aria-hidden="true" tabindex="-1"></a>I1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1214"><a href="#cb144-1214" aria-hidden="true" tabindex="-1"></a>M2  <span class="dv">0</span>   <span class="fl">0.857</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.143</span></span>
<span id="cb144-1215"><a href="#cb144-1215" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1216"><a href="#cb144-1216" aria-hidden="true" tabindex="-1"></a>I2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1217"><a href="#cb144-1217" aria-hidden="true" tabindex="-1"></a>M3  <span class="fl">0.143</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.714</span>   <span class="fl">0.143</span></span>
<span id="cb144-1218"><a href="#cb144-1218" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1219"><a href="#cb144-1219" aria-hidden="true" tabindex="-1"></a>I3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1220"><a href="#cb144-1220" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1221"><a href="#cb144-1221" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1222"><a href="#cb144-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1223"><a href="#cb144-1223" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-1224"><a href="#cb144-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1225"><a href="#cb144-1225" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-1226"><a href="#cb144-1226" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb144-1227"><a href="#cb144-1227" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-1228"><a href="#cb144-1228" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb144-1229"><a href="#cb144-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1230"><a href="#cb144-1230" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb144-1231"><a href="#cb144-1231" aria-hidden="true" tabindex="-1"></a>    threshold <span class="op">=</span> <span class="bu">float</span>(<span class="bu">next</span>(input_iterator).rstrip())</span>
<span id="cb144-1232"><a href="#cb144-1232" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1233"><a href="#cb144-1233" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb144-1234"><a href="#cb144-1234" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1235"><a href="#cb144-1235" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_iterator])</span>
<span id="cb144-1236"><a href="#cb144-1236" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, alphabet, alignment</span>
<span id="cb144-1237"><a href="#cb144-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1238"><a href="#cb144-1238" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-1239"><a href="#cb144-1239" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb144-1240"><a href="#cb144-1240" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb144-1241"><a href="#cb144-1241" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-1242"><a href="#cb144-1242" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb144-1243"><a href="#cb144-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1244"><a href="#cb144-1244" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1245"><a href="#cb144-1245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb144-1246"><a href="#cb144-1246" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb144-1247"><a href="#cb144-1247" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb144-1248"><a href="#cb144-1248" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb144-1249"><a href="#cb144-1249" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb144-1250"><a href="#cb144-1250" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb144-1251"><a href="#cb144-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1252"><a href="#cb144-1252" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1253"><a href="#cb144-1253" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb144-1254"><a href="#cb144-1254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1255"><a href="#cb144-1255" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1256"><a href="#cb144-1256" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-1257"><a href="#cb144-1257" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb144-1258"><a href="#cb144-1258" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb144-1259"><a href="#cb144-1259" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-1260"><a href="#cb144-1260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1261"><a href="#cb144-1261" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probabilities(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1262"><a href="#cb144-1262" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1263"><a href="#cb144-1263" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb144-1264"><a href="#cb144-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1265"><a href="#cb144-1265" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probabilities(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1266"><a href="#cb144-1266" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1267"><a href="#cb144-1267" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb144-1268"><a href="#cb144-1268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1269"><a href="#cb144-1269" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-1270"><a href="#cb144-1270" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb144-1271"><a href="#cb144-1271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-1272"><a href="#cb144-1272" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb144-1273"><a href="#cb144-1273" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb144-1274"><a href="#cb144-1274" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb144-1275"><a href="#cb144-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1276"><a href="#cb144-1276" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1277"><a href="#cb144-1277" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1278"><a href="#cb144-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1279"><a href="#cb144-1279" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1280"><a href="#cb144-1280" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1281"><a href="#cb144-1281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1282"><a href="#cb144-1282" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb144-1283"><a href="#cb144-1283" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb144-1284"><a href="#cb144-1284" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb144-1285"><a href="#cb144-1285" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb144-1286"><a href="#cb144-1286" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb144-1287"><a href="#cb144-1287" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb144-1288"><a href="#cb144-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1289"><a href="#cb144-1289" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb144-1290"><a href="#cb144-1290" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb144-1291"><a href="#cb144-1291" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb144-1292"><a href="#cb144-1292" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb144-1293"><a href="#cb144-1293" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb144-1294"><a href="#cb144-1294" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1295"><a href="#cb144-1295" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb144-1296"><a href="#cb144-1296" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb144-1297"><a href="#cb144-1297" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb144-1298"><a href="#cb144-1298" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb144-1299"><a href="#cb144-1299" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1300"><a href="#cb144-1300" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb144-1301"><a href="#cb144-1301" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb144-1302"><a href="#cb144-1302" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb144-1303"><a href="#cb144-1303" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb144-1304"><a href="#cb144-1304" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1305"><a href="#cb144-1305" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb144-1306"><a href="#cb144-1306" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb144-1307"><a href="#cb144-1307" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1308"><a href="#cb144-1308" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1309"><a href="#cb144-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1310"><a href="#cb144-1310" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb144-1311"><a href="#cb144-1311" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb144-1312"><a href="#cb144-1312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1313"><a href="#cb144-1313" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb144-1314"><a href="#cb144-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1315"><a href="#cb144-1315" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-1316"><a href="#cb144-1316" aria-hidden="true" tabindex="-1"></a><span class="st">0.289</span></span>
<span id="cb144-1317"><a href="#cb144-1317" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1318"><a href="#cb144-1318" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb144-1319"><a href="#cb144-1319" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1320"><a href="#cb144-1320" aria-hidden="true" tabindex="-1"></a><span class="st">EBA</span></span>
<span id="cb144-1321"><a href="#cb144-1321" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb144-1322"><a href="#cb144-1322" aria-hidden="true" tabindex="-1"></a><span class="st">EB-</span></span>
<span id="cb144-1323"><a href="#cb144-1323" aria-hidden="true" tabindex="-1"></a><span class="st">EED</span></span>
<span id="cb144-1324"><a href="#cb144-1324" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb144-1325"><a href="#cb144-1325" aria-hidden="true" tabindex="-1"></a><span class="st">EBE</span></span>
<span id="cb144-1326"><a href="#cb144-1326" aria-hidden="true" tabindex="-1"></a><span class="st">E-D</span></span>
<span id="cb144-1327"><a href="#cb144-1327" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb144-1328"><a href="#cb144-1328" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-1329"><a href="#cb144-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1330"><a href="#cb144-1330" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb144-1331"><a href="#cb144-1331" aria-hidden="true" tabindex="-1"></a>threshold, alphabet, alignment <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb144-1332"><a href="#cb144-1332" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb144-1333"><a href="#cb144-1333" aria-hidden="true" tabindex="-1"></a>print_transition_probabilities(transition_probs)</span>
<span id="cb144-1334"><a href="#cb144-1334" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb144-1335"><a href="#cb144-1335" aria-hidden="true" tabindex="-1"></a>print_emission_probabilities(emission_probs, alphabet)</span>
<span id="cb144-1336"><a href="#cb144-1336" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1337"><a href="#cb144-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1338"><a href="#cb144-1338" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a Profile HMM with Pseudocounts</span></span>
<span id="cb144-1339"><a href="#cb144-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1340"><a href="#cb144-1340" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A threshold&nbsp;_θ_&nbsp;and a pseudocount&nbsp;_σ_, followed by an alphabet&nbsp;_Σ_, followed by a multiple alignment&nbsp;_Alignment_&nbsp;whose strings are formed from&nbsp;_Σ_.</span>
<span id="cb144-1341"><a href="#cb144-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1342"><a href="#cb144-1342" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The transition <span class="kw">and</span> emission probabilities of the profile HMM&nbsp;_HMM_(_Alignment_,&nbsp;_θ_,&nbsp;_σ_).</span>
<span id="cb144-1343"><a href="#cb144-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1344"><a href="#cb144-1344" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-1345"><a href="#cb144-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1346"><a href="#cb144-1346" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1347"><a href="#cb144-1347" aria-hidden="true" tabindex="-1"></a><span class="fl">0.358</span>   <span class="fl">0.01</span></span>
<span id="cb144-1348"><a href="#cb144-1348" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1349"><a href="#cb144-1349" aria-hidden="true" tabindex="-1"></a>A   B   C   D   E</span>
<span id="cb144-1350"><a href="#cb144-1350" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1351"><a href="#cb144-1351" aria-hidden="true" tabindex="-1"></a>ADA</span>
<span id="cb144-1352"><a href="#cb144-1352" aria-hidden="true" tabindex="-1"></a>ADA</span>
<span id="cb144-1353"><a href="#cb144-1353" aria-hidden="true" tabindex="-1"></a>AAA</span>
<span id="cb144-1354"><a href="#cb144-1354" aria-hidden="true" tabindex="-1"></a>ADC</span>
<span id="cb144-1355"><a href="#cb144-1355" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>DA</span>
<span id="cb144-1356"><a href="#cb144-1356" aria-hidden="true" tabindex="-1"></a>D<span class="op">-</span>A</span>
<span id="cb144-1357"><a href="#cb144-1357" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1358"><a href="#cb144-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1359"><a href="#cb144-1359" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-1360"><a href="#cb144-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1361"><a href="#cb144-1361" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1362"><a href="#cb144-1362" aria-hidden="true" tabindex="-1"></a>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E</span>
<span id="cb144-1363"><a href="#cb144-1363" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.819</span>   <span class="fl">0.172</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1364"><a href="#cb144-1364" aria-hidden="true" tabindex="-1"></a>I0  <span class="dv">0</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1365"><a href="#cb144-1365" aria-hidden="true" tabindex="-1"></a>M1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.786</span>   <span class="fl">0.204</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1366"><a href="#cb144-1366" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.981</span>   <span class="fl">0.01</span>    <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1367"><a href="#cb144-1367" aria-hidden="true" tabindex="-1"></a>I1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1368"><a href="#cb144-1368" aria-hidden="true" tabindex="-1"></a>M2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.981</span>   <span class="fl">0.01</span>    <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1369"><a href="#cb144-1369" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.981</span>   <span class="fl">0.01</span>    <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1370"><a href="#cb144-1370" aria-hidden="true" tabindex="-1"></a>I2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1371"><a href="#cb144-1371" aria-hidden="true" tabindex="-1"></a>M3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.99</span></span>
<span id="cb144-1372"><a href="#cb144-1372" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.5</span> <span class="fl">0.5</span></span>
<span id="cb144-1373"><a href="#cb144-1373" aria-hidden="true" tabindex="-1"></a>I3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.5</span> <span class="fl">0.5</span></span>
<span id="cb144-1374"><a href="#cb144-1374" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1375"><a href="#cb144-1375" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1376"><a href="#cb144-1376" aria-hidden="true" tabindex="-1"></a>    A   B   C   D   E</span>
<span id="cb144-1377"><a href="#cb144-1377" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1378"><a href="#cb144-1378" aria-hidden="true" tabindex="-1"></a>I0  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb144-1379"><a href="#cb144-1379" aria-hidden="true" tabindex="-1"></a>M1  <span class="fl">0.771</span>   <span class="fl">0.01</span>    <span class="fl">0.01</span>    <span class="fl">0.2</span> <span class="fl">0.01</span></span>
<span id="cb144-1380"><a href="#cb144-1380" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1381"><a href="#cb144-1381" aria-hidden="true" tabindex="-1"></a>I1  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb144-1382"><a href="#cb144-1382" aria-hidden="true" tabindex="-1"></a>M2  <span class="fl">0.2</span> <span class="fl">0.01</span>    <span class="fl">0.01</span>    <span class="fl">0.771</span>   <span class="fl">0.01</span></span>
<span id="cb144-1383"><a href="#cb144-1383" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1384"><a href="#cb144-1384" aria-hidden="true" tabindex="-1"></a>I2  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb144-1385"><a href="#cb144-1385" aria-hidden="true" tabindex="-1"></a>M3  <span class="fl">0.803</span>   <span class="fl">0.01</span>    <span class="fl">0.168</span>   <span class="fl">0.01</span>    <span class="fl">0.01</span></span>
<span id="cb144-1386"><a href="#cb144-1386" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1387"><a href="#cb144-1387" aria-hidden="true" tabindex="-1"></a>I3  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb144-1388"><a href="#cb144-1388" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb144-1389"><a href="#cb144-1389" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1390"><a href="#cb144-1390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1391"><a href="#cb144-1391" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-1392"><a href="#cb144-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1393"><a href="#cb144-1393" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-1394"><a href="#cb144-1394" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb144-1395"><a href="#cb144-1395" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-1396"><a href="#cb144-1396" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb144-1397"><a href="#cb144-1397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1398"><a href="#cb144-1398" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1399"><a href="#cb144-1399" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb144-1400"><a href="#cb144-1400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1401"><a href="#cb144-1401" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1402"><a href="#cb144-1402" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb144-1403"><a href="#cb144-1403" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb144-1404"><a href="#cb144-1404" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb144-1405"><a href="#cb144-1405" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb144-1406"><a href="#cb144-1406" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb144-1407"><a href="#cb144-1407" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb144-1408"><a href="#cb144-1408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1409"><a href="#cb144-1409" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1410"><a href="#cb144-1410" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-1411"><a href="#cb144-1411" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb144-1412"><a href="#cb144-1412" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb144-1413"><a href="#cb144-1413" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-1414"><a href="#cb144-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1415"><a href="#cb144-1415" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probs(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1416"><a href="#cb144-1416" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1417"><a href="#cb144-1417" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb144-1418"><a href="#cb144-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1419"><a href="#cb144-1419" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probs(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1420"><a href="#cb144-1420" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1421"><a href="#cb144-1421" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb144-1422"><a href="#cb144-1422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1423"><a href="#cb144-1423" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-1424"><a href="#cb144-1424" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb144-1425"><a href="#cb144-1425" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-1426"><a href="#cb144-1426" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb144-1427"><a href="#cb144-1427" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb144-1428"><a href="#cb144-1428" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb144-1429"><a href="#cb144-1429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1430"><a href="#cb144-1430" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1431"><a href="#cb144-1431" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1432"><a href="#cb144-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1433"><a href="#cb144-1433" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1434"><a href="#cb144-1434" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1435"><a href="#cb144-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1436"><a href="#cb144-1436" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-1437"><a href="#cb144-1437" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb144-1438"><a href="#cb144-1438" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb144-1439"><a href="#cb144-1439" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-1440"><a href="#cb144-1440" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb144-1441"><a href="#cb144-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1442"><a href="#cb144-1442" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb144-1443"><a href="#cb144-1443" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb144-1444"><a href="#cb144-1444" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb144-1445"><a href="#cb144-1445" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb144-1446"><a href="#cb144-1446" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb144-1447"><a href="#cb144-1447" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb144-1448"><a href="#cb144-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1449"><a href="#cb144-1449" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb144-1450"><a href="#cb144-1450" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb144-1451"><a href="#cb144-1451" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb144-1452"><a href="#cb144-1452" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb144-1453"><a href="#cb144-1453" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb144-1454"><a href="#cb144-1454" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1455"><a href="#cb144-1455" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb144-1456"><a href="#cb144-1456" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb144-1457"><a href="#cb144-1457" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb144-1458"><a href="#cb144-1458" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb144-1459"><a href="#cb144-1459" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1460"><a href="#cb144-1460" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb144-1461"><a href="#cb144-1461" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb144-1462"><a href="#cb144-1462" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb144-1463"><a href="#cb144-1463" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb144-1464"><a href="#cb144-1464" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1465"><a href="#cb144-1465" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb144-1466"><a href="#cb144-1466" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb144-1467"><a href="#cb144-1467" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1468"><a href="#cb144-1468" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1469"><a href="#cb144-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1470"><a href="#cb144-1470" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb144-1471"><a href="#cb144-1471" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb144-1472"><a href="#cb144-1472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1473"><a href="#cb144-1473" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb144-1474"><a href="#cb144-1474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1475"><a href="#cb144-1475" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb144-1476"><a href="#cb144-1476" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_handle).rstrip().split())</span>
<span id="cb144-1477"><a href="#cb144-1477" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb144-1478"><a href="#cb144-1478" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_handle).split()</span>
<span id="cb144-1479"><a href="#cb144-1479" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb144-1480"><a href="#cb144-1480" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_handle])</span>
<span id="cb144-1481"><a href="#cb144-1481" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, pseudocount, alphabet, alignment</span>
<span id="cb144-1482"><a href="#cb144-1482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1483"><a href="#cb144-1483" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_transition_pseudocounts(transition_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1484"><a href="#cb144-1484" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1485"><a href="#cb144-1485" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1486"><a href="#cb144-1486" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1487"><a href="#cb144-1487" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb144-1488"><a href="#cb144-1488" aria-hidden="true" tabindex="-1"></a>        transition_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span> : i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">5</span>, (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span> : (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1489"><a href="#cb144-1489" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(transition_matrix)</span>
<span id="cb144-1490"><a href="#cb144-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1491"><a href="#cb144-1491" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_emission_pseudocounts(emission_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1492"><a href="#cb144-1492" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1493"><a href="#cb144-1493" aria-hidden="true" tabindex="-1"></a>    emission_matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1494"><a href="#cb144-1494" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb144-1495"><a href="#cb144-1495" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1496"><a href="#cb144-1496" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1497"><a href="#cb144-1497" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(emission_matrix)</span>
<span id="cb144-1498"><a href="#cb144-1498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1499"><a href="#cb144-1499" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_pseudocount_profile_hmm(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb144-1500"><a href="#cb144-1500" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb144-1501"><a href="#cb144-1501" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_transition_pseudocounts(transition_probs, pseudocount)</span>
<span id="cb144-1502"><a href="#cb144-1502" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_emission_pseudocounts(emission_probs, pseudocount)</span>
<span id="cb144-1503"><a href="#cb144-1503" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb144-1504"><a href="#cb144-1504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1505"><a href="#cb144-1505" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-1506"><a href="#cb144-1506" aria-hidden="true" tabindex="-1"></a><span class="st">0.358   0.01</span></span>
<span id="cb144-1507"><a href="#cb144-1507" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1508"><a href="#cb144-1508" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb144-1509"><a href="#cb144-1509" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1510"><a href="#cb144-1510" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb144-1511"><a href="#cb144-1511" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb144-1512"><a href="#cb144-1512" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb144-1513"><a href="#cb144-1513" aria-hidden="true" tabindex="-1"></a><span class="st">ADC</span></span>
<span id="cb144-1514"><a href="#cb144-1514" aria-hidden="true" tabindex="-1"></a><span class="st">-DA</span></span>
<span id="cb144-1515"><a href="#cb144-1515" aria-hidden="true" tabindex="-1"></a><span class="st">D-A</span></span>
<span id="cb144-1516"><a href="#cb144-1516" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-1517"><a href="#cb144-1517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1518"><a href="#cb144-1518" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb144-1519"><a href="#cb144-1519" aria-hidden="true" tabindex="-1"></a>threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb144-1520"><a href="#cb144-1520" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_pseudocount_profile_hmm(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb144-1521"><a href="#cb144-1521" aria-hidden="true" tabindex="-1"></a>print_transition_probs(transition_probs)</span>
<span id="cb144-1522"><a href="#cb144-1522" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb144-1523"><a href="#cb144-1523" aria-hidden="true" tabindex="-1"></a>print_emission_probs(emission_probs, alphabet)</span>
<span id="cb144-1524"><a href="#cb144-1524" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1525"><a href="#cb144-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1526"><a href="#cb144-1526" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a Multiple Sequence Alignment with a Profile HMM</span></span>
<span id="cb144-1527"><a href="#cb144-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1528"><a href="#cb144-1528" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string Text, a multiple alignment Alignment, a threshold θ, <span class="kw">and</span> a pseudocount σ.</span>
<span id="cb144-1529"><a href="#cb144-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1530"><a href="#cb144-1530" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An optimal hidden path emitting Text <span class="kw">in</span> HMM(Alignment,θ,σ).</span>
<span id="cb144-1531"><a href="#cb144-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1532"><a href="#cb144-1532" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-1533"><a href="#cb144-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1534"><a href="#cb144-1534" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1535"><a href="#cb144-1535" aria-hidden="true" tabindex="-1"></a>AEFDFDC</span>
<span id="cb144-1536"><a href="#cb144-1536" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1537"><a href="#cb144-1537" aria-hidden="true" tabindex="-1"></a><span class="fl">0.4</span> <span class="fl">0.01</span></span>
<span id="cb144-1538"><a href="#cb144-1538" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1539"><a href="#cb144-1539" aria-hidden="true" tabindex="-1"></a>A   B   C   D   E   F</span>
<span id="cb144-1540"><a href="#cb144-1540" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1541"><a href="#cb144-1541" aria-hidden="true" tabindex="-1"></a>ACDEFACADF</span>
<span id="cb144-1542"><a href="#cb144-1542" aria-hidden="true" tabindex="-1"></a>AFDA<span class="op">---</span>CCF</span>
<span id="cb144-1543"><a href="#cb144-1543" aria-hidden="true" tabindex="-1"></a>A<span class="op">--</span>EFD<span class="op">-</span>FDC</span>
<span id="cb144-1544"><a href="#cb144-1544" aria-hidden="true" tabindex="-1"></a>ACAEF<span class="op">--</span>A<span class="op">-</span>C</span>
<span id="cb144-1545"><a href="#cb144-1545" aria-hidden="true" tabindex="-1"></a>ADDEFAAADF</span>
<span id="cb144-1546"><a href="#cb144-1546" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1547"><a href="#cb144-1547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1548"><a href="#cb144-1548" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-1549"><a href="#cb144-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1550"><a href="#cb144-1550" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1551"><a href="#cb144-1551" aria-hidden="true" tabindex="-1"></a>M1 D2 D3 M4 M5 I5 M6 M7 M8</span>
<span id="cb144-1552"><a href="#cb144-1552" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1553"><a href="#cb144-1553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1554"><a href="#cb144-1554" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-1555"><a href="#cb144-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1556"><a href="#cb144-1556" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-1557"><a href="#cb144-1557" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-1558"><a href="#cb144-1558" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-1559"><a href="#cb144-1559" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator</span>
<span id="cb144-1560"><a href="#cb144-1560" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb144-1561"><a href="#cb144-1561" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf, log</span>
<span id="cb144-1562"><a href="#cb144-1562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1563"><a href="#cb144-1563" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-1564"><a href="#cb144-1564" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb144-1565"><a href="#cb144-1565" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-1566"><a href="#cb144-1566" aria-hidden="true" tabindex="-1"></a>        labels.extend([<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>])</span>
<span id="cb144-1567"><a href="#cb144-1567" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb144-1568"><a href="#cb144-1568" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb144-1569"><a href="#cb144-1569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1570"><a href="#cb144-1570" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1571"><a href="#cb144-1571" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb144-1572"><a href="#cb144-1572" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb144-1573"><a href="#cb144-1573" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb144-1574"><a href="#cb144-1574" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb144-1575"><a href="#cb144-1575" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb144-1576"><a href="#cb144-1576" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb144-1577"><a href="#cb144-1577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1578"><a href="#cb144-1578" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1579"><a href="#cb144-1579" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb144-1580"><a href="#cb144-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1581"><a href="#cb144-1581" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1582"><a href="#cb144-1582" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1583"><a href="#cb144-1583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1584"><a href="#cb144-1584" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(num_states: <span class="bu">int</span>, num_symbols: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1585"><a href="#cb144-1585" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_symbols), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1586"><a href="#cb144-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1587"><a href="#cb144-1587" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_index(state_num: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-1588"><a href="#cb144-1588" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb144-1589"><a href="#cb144-1589" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (state_num <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb144-1590"><a href="#cb144-1590" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-1591"><a href="#cb144-1591" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> state_num <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb144-1592"><a href="#cb144-1592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1593"><a href="#cb144-1593" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb144-1594"><a href="#cb144-1594" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb144-1595"><a href="#cb144-1595" aria-hidden="true" tabindex="-1"></a>    valid_length <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb144-1596"><a href="#cb144-1596" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_length <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb144-1597"><a href="#cb144-1597" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_length)</span>
<span id="cb144-1598"><a href="#cb144-1598" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_length, <span class="bu">len</span>(alphabet))</span>
<span id="cb144-1599"><a href="#cb144-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1600"><a href="#cb144-1600" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb144-1601"><a href="#cb144-1601" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb144-1602"><a href="#cb144-1602" aria-hidden="true" tabindex="-1"></a>        valid_col_count <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb144-1603"><a href="#cb144-1603" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb144-1604"><a href="#cb144-1604" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[col]:</span>
<span id="cb144-1605"><a href="#cb144-1605" aria-hidden="true" tabindex="-1"></a>                valid_col_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1606"><a href="#cb144-1606" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb144-1607"><a href="#cb144-1607" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"del"</span>)</span>
<span id="cb144-1608"><a href="#cb144-1608" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb144-1609"><a href="#cb144-1609" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"match"</span>)</span>
<span id="cb144-1610"><a href="#cb144-1610" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1611"><a href="#cb144-1611" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb144-1612"><a href="#cb144-1612" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb144-1613"><a href="#cb144-1613" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb144-1614"><a href="#cb144-1614" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"ins"</span>)</span>
<span id="cb144-1615"><a href="#cb144-1615" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1616"><a href="#cb144-1616" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb144-1617"><a href="#cb144-1617" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb144-1618"><a href="#cb144-1618" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1619"><a href="#cb144-1619" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1620"><a href="#cb144-1620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1621"><a href="#cb144-1621" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb144-1622"><a href="#cb144-1622" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb144-1623"><a href="#cb144-1623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1624"><a href="#cb144-1624" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb144-1625"><a href="#cb144-1625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1626"><a href="#cb144-1626" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_transitions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1627"><a href="#cb144-1627" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1628"><a href="#cb144-1628" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1629"><a href="#cb144-1629" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1630"><a href="#cb144-1630" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb144-1631"><a href="#cb144-1631" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>:i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">5</span>, (i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>:(i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1632"><a href="#cb144-1632" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb144-1633"><a href="#cb144-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1634"><a href="#cb144-1634" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_emissions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1635"><a href="#cb144-1635" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1636"><a href="#cb144-1636" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1637"><a href="#cb144-1637" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb144-1638"><a href="#cb144-1638" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1639"><a href="#cb144-1639" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb144-1640"><a href="#cb144-1640" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb144-1641"><a href="#cb144-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1642"><a href="#cb144-1642" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm_with_pseudocounts(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb144-1643"><a href="#cb144-1643" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb144-1644"><a href="#cb144-1644" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_pseudocounts_to_transitions(transition_probs, pseudocount)</span>
<span id="cb144-1645"><a href="#cb144-1645" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_pseudocounts_to_emissions(emission_probs, pseudocount)</span>
<span id="cb144-1646"><a href="#cb144-1646" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb144-1647"><a href="#cb144-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1648"><a href="#cb144-1648" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input_data(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb144-1649"><a href="#cb144-1649" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb144-1650"><a href="#cb144-1650" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1651"><a href="#cb144-1651" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_iterator).rstrip().split())</span>
<span id="cb144-1652"><a href="#cb144-1652" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1653"><a href="#cb144-1653" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb144-1654"><a href="#cb144-1654" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb144-1655"><a href="#cb144-1655" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(x.strip()) <span class="cf">for</span> x <span class="kw">in</span> input_iterator])</span>
<span id="cb144-1656"><a href="#cb144-1656" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, threshold, pseudocount, alphabet, alignment</span>
<span id="cb144-1657"><a href="#cb144-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1658"><a href="#cb144-1658" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_transition_probs_to_dict(matrix: np.ndarray) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb144-1659"><a href="#cb144-1659" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb144-1660"><a href="#cb144-1660" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1661"><a href="#cb144-1661" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb144-1662"><a href="#cb144-1662" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb144-1663"><a href="#cb144-1663" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb144-1664"><a href="#cb144-1664" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb144-1665"><a href="#cb144-1665" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb144-1666"><a href="#cb144-1666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1667"><a href="#cb144-1667" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_emission_probs_to_dict(matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb144-1668"><a href="#cb144-1668" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb144-1669"><a href="#cb144-1669" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1670"><a href="#cb144-1670" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb144-1671"><a href="#cb144-1671" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb144-1672"><a href="#cb144-1672" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(alphabet):</span>
<span id="cb144-1673"><a href="#cb144-1673" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], symbol] <span class="op">=</span> matrix[i][j]</span>
<span id="cb144-1674"><a href="#cb144-1674" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb144-1675"><a href="#cb144-1675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1676"><a href="#cb144-1676" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_hmm_graph(transition_probs: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb144-1677"><a href="#cb144-1677" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1678"><a href="#cb144-1678" aria-hidden="true" tabindex="-1"></a>        graph[source].append({<span class="st">"node"</span>: target, <span class="st">"weight"</span>: transition_probs[source, target]})</span>
<span id="cb144-1679"><a href="#cb144-1679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1680"><a href="#cb144-1680" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb144-1681"><a href="#cb144-1681" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target <span class="kw">in</span> [<span class="st">"I0"</span>, <span class="st">"M1"</span>, <span class="st">"D1"</span>]:</span>
<span id="cb144-1682"><a href="#cb144-1682" aria-hidden="true" tabindex="-1"></a>        add_edge(<span class="st">"S"</span>, target)</span>
<span id="cb144-1683"><a href="#cb144-1683" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb144-1684"><a href="#cb144-1684" aria-hidden="true" tabindex="-1"></a>        source <span class="op">=</span> <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb144-1685"><a href="#cb144-1685" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [source, <span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb144-1686"><a href="#cb144-1686" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb144-1687"><a href="#cb144-1687" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states):</span>
<span id="cb144-1688"><a href="#cb144-1688" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb144-1689"><a href="#cb144-1689" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb144-1690"><a href="#cb144-1690" aria-hidden="true" tabindex="-1"></a>                add_edge(source, target)</span>
<span id="cb144-1691"><a href="#cb144-1691" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb144-1692"><a href="#cb144-1692" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="st">"E"</span>]:</span>
<span id="cb144-1693"><a href="#cb144-1693" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb144-1694"><a href="#cb144-1694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1695"><a href="#cb144-1695" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-1696"><a href="#cb144-1696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1697"><a href="#cb144-1697" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_topological_order(num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb144-1698"><a href="#cb144-1698" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"S"</span>, <span class="dv">0</span>)</span>
<span id="cb144-1699"><a href="#cb144-1699" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb144-1700"><a href="#cb144-1700" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="ss">f"D</span><span class="sc">{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)</span>
<span id="cb144-1701"><a href="#cb144-1701" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(seq_length):</span>
<span id="cb144-1702"><a href="#cb144-1702" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="st">"I0"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb144-1703"><a href="#cb144-1703" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb144-1704"><a href="#cb144-1704" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> state_type <span class="kw">in</span> [<span class="st">"M"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>]:</span>
<span id="cb144-1705"><a href="#cb144-1705" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (<span class="ss">f"</span><span class="sc">{</span>state_type<span class="sc">}{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb144-1706"><a href="#cb144-1706" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"E"</span>, seq_length <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb144-1707"><a href="#cb144-1707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1708"><a href="#cb144-1708" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_nodes(current_node: <span class="bu">str</span>, current_col: <span class="bu">int</span>, num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb144-1709"><a href="#cb144-1709" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"E"</span>:</span>
<span id="cb144-1710"><a href="#cb144-1710" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length)]</span>
<span id="cb144-1711"><a href="#cb144-1711" aria-hidden="true" tabindex="-1"></a>    state_num <span class="op">=</span> <span class="bu">int</span>(current_node[<span class="dv">1</span>:])</span>
<span id="cb144-1712"><a href="#cb144-1712" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb144-1713"><a href="#cb144-1713" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)]</span>
<span id="cb144-1714"><a href="#cb144-1714" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"I0"</span>:</span>
<span id="cb144-1715"><a href="#cb144-1715" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb144-1716"><a href="#cb144-1716" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"M1"</span>:</span>
<span id="cb144-1717"><a href="#cb144-1717" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb144-1718"><a href="#cb144-1718" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"I"</span>:</span>
<span id="cb144-1719"><a href="#cb144-1719" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb144-1720"><a href="#cb144-1720" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"M"</span>:</span>
<span id="cb144-1721"><a href="#cb144-1721" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb144-1722"><a href="#cb144-1722" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"D"</span>:</span>
<span id="cb144-1723"><a href="#cb144-1723" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"I0"</span>, current_col)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col)]</span>
<span id="cb144-1724"><a href="#cb144-1724" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-1725"><a href="#cb144-1725" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Unhandled node: </span><span class="sc">{</span>current_node<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb144-1726"><a href="#cb144-1726" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb144-1727"><a href="#cb144-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1728"><a href="#cb144-1728" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplify_graph(graph: Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">float</span>]]:</span>
<span id="cb144-1729"><a href="#cb144-1729" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {k: {x[<span class="st">"node"</span>]: x[<span class="st">"weight"</span>] <span class="cf">for</span> x <span class="kw">in</span> v} <span class="cf">for</span> k, v <span class="kw">in</span> graph.items()}</span>
<span id="cb144-1730"><a href="#cb144-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1731"><a href="#cb144-1731" aria-hidden="true" tabindex="-1"></a><span class="co"># Main execution</span></span>
<span id="cb144-1732"><a href="#cb144-1732" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input):</span>
<span id="cb144-1733"><a href="#cb144-1733" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb144-1734"><a href="#cb144-1734" aria-hidden="true" tabindex="-1"></a>    sequence, threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input_data(input_lines)</span>
<span id="cb144-1735"><a href="#cb144-1735" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm_with_pseudocounts(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb144-1736"><a href="#cb144-1736" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (transition_probs.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb144-1737"><a href="#cb144-1737" aria-hidden="true" tabindex="-1"></a>    transition_probs_dict <span class="op">=</span> convert_transition_probs_to_dict(transition_probs)</span>
<span id="cb144-1738"><a href="#cb144-1738" aria-hidden="true" tabindex="-1"></a>    emission_probs_dict <span class="op">=</span> convert_emission_probs_to_dict(emission_probs, alphabet)</span>
<span id="cb144-1739"><a href="#cb144-1739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1740"><a href="#cb144-1740" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> build_hmm_graph(transition_probs_dict, num_states)</span>
<span id="cb144-1741"><a href="#cb144-1741" aria-hidden="true" tabindex="-1"></a>    topological_order <span class="op">=</span> generate_topological_order(num_states, <span class="bu">len</span>(sequence))</span>
<span id="cb144-1742"><a href="#cb144-1742" aria-hidden="true" tabindex="-1"></a>    simplified_graph <span class="op">=</span> simplify_graph(graph)</span>
<span id="cb144-1743"><a href="#cb144-1743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1744"><a href="#cb144-1744" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dynamic programming to find the most probable path</span></span>
<span id="cb144-1745"><a href="#cb144-1745" aria-hidden="true" tabindex="-1"></a>    previous_node <span class="op">=</span> <span class="bu">next</span>(topological_order)</span>
<span id="cb144-1746"><a href="#cb144-1746" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {previous_node: <span class="dv">0</span>}</span>
<span id="cb144-1747"><a href="#cb144-1747" aria-hidden="true" tabindex="-1"></a>    backpointers <span class="op">=</span> {previous_node: (<span class="va">None</span>, <span class="va">None</span>)}</span>
<span id="cb144-1748"><a href="#cb144-1748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1749"><a href="#cb144-1749" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_node, current_col <span class="kw">in</span> topological_order:</span>
<span id="cb144-1750"><a href="#cb144-1750" aria-hidden="true" tabindex="-1"></a>        backpointers[(current_node, current_col)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb144-1751"><a href="#cb144-1751" aria-hidden="true" tabindex="-1"></a>        scores[(current_node, current_col)] <span class="op">=</span> <span class="op">-</span>inf</span>
<span id="cb144-1752"><a href="#cb144-1752" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> prev_node, prev_col <span class="kw">in</span> get_previous_nodes(current_node, current_col, num_states, <span class="bu">len</span>(sequence)):</span>
<span id="cb144-1753"><a href="#cb144-1753" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_col <span class="op">&lt;</span> current_col <span class="kw">and</span> current_node <span class="op">!=</span> <span class="st">"E"</span>:</span>
<span id="cb144-1754"><a href="#cb144-1754" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> emission_probs_dict[current_node, sequence[current_col <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb144-1755"><a href="#cb144-1755" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb144-1756"><a href="#cb144-1756" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb144-1757"><a href="#cb144-1757" aria-hidden="true" tabindex="-1"></a>            log_prob <span class="op">=</span> log(simplified_graph[prev_node][current_node]) <span class="op">+</span> log(emission_prob) <span class="op">+</span> scores[(prev_node, prev_col)]</span>
<span id="cb144-1758"><a href="#cb144-1758" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> log_prob <span class="op">&gt;</span> scores[(current_node, current_col)]:</span>
<span id="cb144-1759"><a href="#cb144-1759" aria-hidden="true" tabindex="-1"></a>                scores[(current_node, current_col)] <span class="op">=</span> log_prob</span>
<span id="cb144-1760"><a href="#cb144-1760" aria-hidden="true" tabindex="-1"></a>                backpointers[(current_node, current_col)] <span class="op">=</span> (prev_node, prev_col)</span>
<span id="cb144-1761"><a href="#cb144-1761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1762"><a href="#cb144-1762" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to find the path</span></span>
<span id="cb144-1763"><a href="#cb144-1763" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> []</span>
<span id="cb144-1764"><a href="#cb144-1764" aria-hidden="true" tabindex="-1"></a>    position <span class="op">=</span> (<span class="st">"E"</span>, <span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb144-1765"><a href="#cb144-1765" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> position[<span class="dv">0</span>]:</span>
<span id="cb144-1766"><a href="#cb144-1766" aria-hidden="true" tabindex="-1"></a>        path.append(backpointers[position][<span class="dv">0</span>])</span>
<span id="cb144-1767"><a href="#cb144-1767" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> backpointers[position]</span>
<span id="cb144-1768"><a href="#cb144-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1769"><a href="#cb144-1769" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>path[::<span class="op">-</span><span class="dv">1</span>][<span class="dv">2</span>:])</span>
<span id="cb144-1770"><a href="#cb144-1770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1771"><a href="#cb144-1771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1772"><a href="#cb144-1772" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-1773"><a href="#cb144-1773" aria-hidden="true" tabindex="-1"></a><span class="st">AEFDFDC</span></span>
<span id="cb144-1774"><a href="#cb144-1774" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1775"><a href="#cb144-1775" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.01</span></span>
<span id="cb144-1776"><a href="#cb144-1776" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1777"><a href="#cb144-1777" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E   F</span></span>
<span id="cb144-1778"><a href="#cb144-1778" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1779"><a href="#cb144-1779" aria-hidden="true" tabindex="-1"></a><span class="st">ACDEFACADF</span></span>
<span id="cb144-1780"><a href="#cb144-1780" aria-hidden="true" tabindex="-1"></a><span class="st">AFDA---CCF</span></span>
<span id="cb144-1781"><a href="#cb144-1781" aria-hidden="true" tabindex="-1"></a><span class="st">A--EFD-FDC</span></span>
<span id="cb144-1782"><a href="#cb144-1782" aria-hidden="true" tabindex="-1"></a><span class="st">ACAEF--A-C</span></span>
<span id="cb144-1783"><a href="#cb144-1783" aria-hidden="true" tabindex="-1"></a><span class="st">ADDEFAAADF</span></span>
<span id="cb144-1784"><a href="#cb144-1784" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-1785"><a href="#cb144-1785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1786"><a href="#cb144-1786" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb144-1787"><a href="#cb144-1787" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1788"><a href="#cb144-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1789"><a href="#cb144-1789" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the Parameters of an HMM</span></span>
<span id="cb144-1790"><a href="#cb144-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1791"><a href="#cb144-1791" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of emitted symbols x <span class="op">=</span> x1 . . . xn <span class="kw">in</span> an alphabet ∑ <span class="kw">and</span> a path $π <span class="op">=</span> π_1 . . . π_n$ generated by a k<span class="op">-</span>state HMM <span class="cf">with</span> unknown transition <span class="kw">and</span> emission probabilities.</span>
<span id="cb144-1792"><a href="#cb144-1792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1793"><a href="#cb144-1793" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A matrix of transition probabilities Transition <span class="kw">and</span> a matrix of emission probabilities Emission that maximize $Pr(x,π)$ over <span class="bu">all</span> possible matrices of transition <span class="kw">and</span> emission probabilities.</span>
<span id="cb144-1794"><a href="#cb144-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1795"><a href="#cb144-1795" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-1796"><a href="#cb144-1796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1797"><a href="#cb144-1797" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1798"><a href="#cb144-1798" aria-hidden="true" tabindex="-1"></a>yzzzyxzxxx</span>
<span id="cb144-1799"><a href="#cb144-1799" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1800"><a href="#cb144-1800" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb144-1801"><a href="#cb144-1801" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1802"><a href="#cb144-1802" aria-hidden="true" tabindex="-1"></a>BBABABABAB</span>
<span id="cb144-1803"><a href="#cb144-1803" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1804"><a href="#cb144-1804" aria-hidden="true" tabindex="-1"></a>A   B   C</span>
<span id="cb144-1805"><a href="#cb144-1805" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1806"><a href="#cb144-1806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1807"><a href="#cb144-1807" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-1808"><a href="#cb144-1808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1809"><a href="#cb144-1809" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1810"><a href="#cb144-1810" aria-hidden="true" tabindex="-1"></a>A   B   C</span>
<span id="cb144-1811"><a href="#cb144-1811" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.0</span> <span class="fl">1.0</span> <span class="fl">0.0</span></span>
<span id="cb144-1812"><a href="#cb144-1812" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.8</span> <span class="fl">0.2</span> <span class="fl">0.0</span></span>
<span id="cb144-1813"><a href="#cb144-1813" aria-hidden="true" tabindex="-1"></a>C   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span></span>
<span id="cb144-1814"><a href="#cb144-1814" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1815"><a href="#cb144-1815" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb144-1816"><a href="#cb144-1816" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.25</span>    <span class="fl">0.25</span>    <span class="fl">0.5</span></span>
<span id="cb144-1817"><a href="#cb144-1817" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.5</span> <span class="fl">0.167</span>   <span class="fl">0.333</span></span>
<span id="cb144-1818"><a href="#cb144-1818" aria-hidden="true" tabindex="-1"></a>C   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span></span>
<span id="cb144-1819"><a href="#cb144-1819" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1820"><a href="#cb144-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1821"><a href="#cb144-1821" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-1822"><a href="#cb144-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1823"><a href="#cb144-1823" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-1824"><a href="#cb144-1824" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-1825"><a href="#cb144-1825" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-1826"><a href="#cb144-1826" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator, Union</span>
<span id="cb144-1827"><a href="#cb144-1827" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb144-1828"><a href="#cb144-1828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1829"><a href="#cb144-1829" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1830"><a href="#cb144-1830" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb144-1831"><a href="#cb144-1831" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb144-1832"><a href="#cb144-1832" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb144-1833"><a href="#cb144-1833" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb144-1834"><a href="#cb144-1834" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb144-1835"><a href="#cb144-1835" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb144-1836"><a href="#cb144-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1837"><a href="#cb144-1837" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1838"><a href="#cb144-1838" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb144-1839"><a href="#cb144-1839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1840"><a href="#cb144-1840" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1841"><a href="#cb144-1841" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-1842"><a href="#cb144-1842" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb144-1843"><a href="#cb144-1843" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb144-1844"><a href="#cb144-1844" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-1845"><a href="#cb144-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1846"><a href="#cb144-1846" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], <span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-1847"><a href="#cb144-1847" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb144-1848"><a href="#cb144-1848" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-1849"><a href="#cb144-1849" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb144-1850"><a href="#cb144-1850" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-1851"><a href="#cb144-1851" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb144-1852"><a href="#cb144-1852" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-1853"><a href="#cb144-1853" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb144-1854"><a href="#cb144-1854" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, alphabet, path, states</span>
<span id="cb144-1855"><a href="#cb144-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1856"><a href="#cb144-1856" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_dict(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb144-1857"><a href="#cb144-1857" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb144-1858"><a href="#cb144-1858" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb144-1859"><a href="#cb144-1859" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">1</span>]):</span>
<span id="cb144-1860"><a href="#cb144-1860" aria-hidden="true" tabindex="-1"></a>            result[row_labels[i], column_labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb144-1861"><a href="#cb144-1861" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb144-1862"><a href="#cb144-1862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1863"><a href="#cb144-1863" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb144-1864"><a href="#cb144-1864" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1865"><a href="#cb144-1865" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_state, next_state <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb144-1866"><a href="#cb144-1866" aria-hidden="true" tabindex="-1"></a>        transition_matrix[states.index(current_state)][states.index(next_state)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1867"><a href="#cb144-1867" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> normalize_matrix(transition_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb144-1868"><a href="#cb144-1868" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb144-1869"><a href="#cb144-1869" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(transition_matrix, states, states)</span>
<span id="cb144-1870"><a href="#cb144-1870" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-1871"><a href="#cb144-1871" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> transition_matrix</span>
<span id="cb144-1872"><a href="#cb144-1872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1873"><a href="#cb144-1873" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb144-1874"><a href="#cb144-1874" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1875"><a href="#cb144-1875" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> state, symbol <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb144-1876"><a href="#cb144-1876" aria-hidden="true" tabindex="-1"></a>        emission_matrix[states.index(state)][alphabet.index(symbol)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1877"><a href="#cb144-1877" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> normalize_matrix(emission_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb144-1878"><a href="#cb144-1878" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb144-1879"><a href="#cb144-1879" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(emission_matrix, states, alphabet)</span>
<span id="cb144-1880"><a href="#cb144-1880" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-1881"><a href="#cb144-1881" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> emission_matrix</span>
<span id="cb144-1882"><a href="#cb144-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1883"><a href="#cb144-1883" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1884"><a href="#cb144-1884" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb144-1885"><a href="#cb144-1885" aria-hidden="true" tabindex="-1"></a>    sequence, alphabet, path, states <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb144-1886"><a href="#cb144-1886" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states)</span>
<span id="cb144-1887"><a href="#cb144-1887" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states)</span>
<span id="cb144-1888"><a href="#cb144-1888" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, states, states)</span>
<span id="cb144-1889"><a href="#cb144-1889" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb144-1890"><a href="#cb144-1890" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, states, alphabet)</span>
<span id="cb144-1891"><a href="#cb144-1891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1892"><a href="#cb144-1892" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-1893"><a href="#cb144-1893" aria-hidden="true" tabindex="-1"></a><span class="st">yzzzyxzxxx</span></span>
<span id="cb144-1894"><a href="#cb144-1894" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1895"><a href="#cb144-1895" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb144-1896"><a href="#cb144-1896" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1897"><a href="#cb144-1897" aria-hidden="true" tabindex="-1"></a><span class="st">BBABABABAB</span></span>
<span id="cb144-1898"><a href="#cb144-1898" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-1899"><a href="#cb144-1899" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C</span></span>
<span id="cb144-1900"><a href="#cb144-1900" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-1901"><a href="#cb144-1901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1902"><a href="#cb144-1902" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb144-1903"><a href="#cb144-1903" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1904"><a href="#cb144-1904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1905"><a href="#cb144-1905" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement Viterbi Learning</span></span>
<span id="cb144-1906"><a href="#cb144-1906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1907"><a href="#cb144-1907" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of emitted symbols&nbsp;$x<span class="op">=</span>x_1 ... x_n$&nbsp;in an alphabet&nbsp;_A_, generated by a&nbsp;_k_<span class="op">-</span>state HMM <span class="cf">with</span> unknown transition <span class="kw">and</span> emission probabilities, initial&nbsp;_Transition_&nbsp;and&nbsp;_Emission_&nbsp;matrices <span class="kw">and</span> a number of iterations&nbsp;_i_.</span>
<span id="cb144-1908"><a href="#cb144-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1909"><a href="#cb144-1909" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A matrix of transition probabilities&nbsp;_Transition_&nbsp;and a matrix of emission probabilities&nbsp;_Emission_&nbsp;that maximizes $Pr(x,π)$ over <span class="bu">all</span> possible transition <span class="kw">and</span> emission matrices <span class="kw">and</span> over <span class="bu">all</span> hidden paths&nbsp;_π_.</span>
<span id="cb144-1910"><a href="#cb144-1910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1911"><a href="#cb144-1911" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-1912"><a href="#cb144-1912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1913"><a href="#cb144-1913" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1914"><a href="#cb144-1914" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span>
<span id="cb144-1915"><a href="#cb144-1915" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1916"><a href="#cb144-1916" aria-hidden="true" tabindex="-1"></a>xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span>
<span id="cb144-1917"><a href="#cb144-1917" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1918"><a href="#cb144-1918" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb144-1919"><a href="#cb144-1919" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1920"><a href="#cb144-1920" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb144-1921"><a href="#cb144-1921" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1922"><a href="#cb144-1922" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb144-1923"><a href="#cb144-1923" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.582</span>   <span class="fl">0.418</span></span>
<span id="cb144-1924"><a href="#cb144-1924" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.272</span>   <span class="fl">0.728</span></span>
<span id="cb144-1925"><a href="#cb144-1925" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1926"><a href="#cb144-1926" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb144-1927"><a href="#cb144-1927" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.129</span>   <span class="fl">0.35</span>    <span class="fl">0.52</span></span>
<span id="cb144-1928"><a href="#cb144-1928" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.422</span>   <span class="fl">0.151</span>   <span class="fl">0.426</span></span>
<span id="cb144-1929"><a href="#cb144-1929" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1930"><a href="#cb144-1930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1931"><a href="#cb144-1931" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-1932"><a href="#cb144-1932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1933"><a href="#cb144-1933" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1934"><a href="#cb144-1934" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb144-1935"><a href="#cb144-1935" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.875</span>   <span class="fl">0.125</span></span>
<span id="cb144-1936"><a href="#cb144-1936" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.011</span>   <span class="fl">0.989</span></span>
<span id="cb144-1937"><a href="#cb144-1937" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-1938"><a href="#cb144-1938" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb144-1939"><a href="#cb144-1939" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.0</span> <span class="fl">0.75</span>    <span class="fl">0.25</span></span>
<span id="cb144-1940"><a href="#cb144-1940" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.402</span>   <span class="fl">0.174</span>   <span class="fl">0.424</span></span>
<span id="cb144-1941"><a href="#cb144-1941" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-1942"><a href="#cb144-1942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1943"><a href="#cb144-1943" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-1944"><a href="#cb144-1944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1945"><a href="#cb144-1945" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-1946"><a href="#cb144-1946" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-1947"><a href="#cb144-1947" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb144-1948"><a href="#cb144-1948" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb144-1949"><a href="#cb144-1949" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb144-1950"><a href="#cb144-1950" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1951"><a href="#cb144-1951" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-1952"><a href="#cb144-1952" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)))</span>
<span id="cb144-1953"><a href="#cb144-1953" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb144-1954"><a href="#cb144-1954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1955"><a href="#cb144-1955" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-1956"><a href="#cb144-1956" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states))</span>
<span id="cb144-1957"><a href="#cb144-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1958"><a href="#cb144-1958" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb144-1959"><a href="#cb144-1959" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-1960"><a href="#cb144-1960" aria-hidden="true" tabindex="-1"></a>            opt <span class="op">=</span> [</span>
<span id="cb144-1961"><a href="#cb144-1961" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[prev, state]) <span class="op">+</span> log(emission_matrix[state, emission]) <span class="op">+</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb144-1962"><a href="#cb144-1962" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb144-1963"><a href="#cb144-1963" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb144-1964"><a href="#cb144-1964" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> opt.index(<span class="bu">max</span>(opt))</span>
<span id="cb144-1965"><a href="#cb144-1965" aria-hidden="true" tabindex="-1"></a>            ptr[i, j] <span class="op">=</span> p</span>
<span id="cb144-1966"><a href="#cb144-1966" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">max</span>(opt)</span>
<span id="cb144-1967"><a href="#cb144-1967" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> np.argmax(mat[i, :])</span>
<span id="cb144-1968"><a href="#cb144-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1969"><a href="#cb144-1969" aria-hidden="true" tabindex="-1"></a>    state_sequence <span class="op">=</span> states[ind]</span>
<span id="cb144-1970"><a href="#cb144-1970" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb144-1971"><a href="#cb144-1971" aria-hidden="true" tabindex="-1"></a>        state_sequence <span class="op">=</span> states[ptr[i, ind]] <span class="op">+</span> state_sequence</span>
<span id="cb144-1972"><a href="#cb144-1972" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> ptr[i, ind]</span>
<span id="cb144-1973"><a href="#cb144-1973" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb144-1974"><a href="#cb144-1974" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> state_sequence</span>
<span id="cb144-1975"><a href="#cb144-1975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1976"><a href="#cb144-1976" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-1977"><a href="#cb144-1977" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-1978"><a href="#cb144-1978" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb144-1979"><a href="#cb144-1979" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb144-1980"><a href="#cb144-1980" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-1981"><a href="#cb144-1981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1982"><a href="#cb144-1982" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, min_val: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1e-16</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-1983"><a href="#cb144-1983" aria-hidden="true" tabindex="-1"></a>    normalized <span class="op">=</span> matrix <span class="op">/</span> matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb144-1984"><a href="#cb144-1984" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros:</span>
<span id="cb144-1985"><a href="#cb144-1985" aria-hidden="true" tabindex="-1"></a>        normalized[normalized <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> min_val</span>
<span id="cb144-1986"><a href="#cb144-1986" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalized</span>
<span id="cb144-1987"><a href="#cb144-1987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1988"><a href="#cb144-1988" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb144-1989"><a href="#cb144-1989" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1990"><a href="#cb144-1990" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb144-1991"><a href="#cb144-1991" aria-hidden="true" tabindex="-1"></a>        tmat[states.index(a)][states.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-1992"><a href="#cb144-1992" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> normalize_matrix(tmat)</span>
<span id="cb144-1993"><a href="#cb144-1993" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb144-1994"><a href="#cb144-1994" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], states[j]): tmat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states))}</span>
<span id="cb144-1995"><a href="#cb144-1995" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tmat</span>
<span id="cb144-1996"><a href="#cb144-1996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-1997"><a href="#cb144-1997" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb144-1998"><a href="#cb144-1998" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-1999"><a href="#cb144-1999" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb144-2000"><a href="#cb144-2000" aria-hidden="true" tabindex="-1"></a>        emat[states.index(a)][alphabet.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-2001"><a href="#cb144-2001" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> normalize_matrix(emat)</span>
<span id="cb144-2002"><a href="#cb144-2002" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb144-2003"><a href="#cb144-2003" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], alphabet[j]): emat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(alphabet))}</span>
<span id="cb144-2004"><a href="#cb144-2004" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emat</span>
<span id="cb144-2005"><a href="#cb144-2005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2006"><a href="#cb144-2006" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-2007"><a href="#cb144-2007" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(column_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-2008"><a href="#cb144-2008" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb144-2009"><a href="#cb144-2009" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(column_labels):</span>
<span id="cb144-2010"><a href="#cb144-2010" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb144-2011"><a href="#cb144-2011" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, column_labels)</span>
<span id="cb144-2012"><a href="#cb144-2012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2013"><a href="#cb144-2013" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: StringIO) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb144-2014"><a href="#cb144-2014" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb144-2015"><a href="#cb144-2015" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2016"><a href="#cb144-2016" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb144-2017"><a href="#cb144-2017" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2018"><a href="#cb144-2018" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb144-2019"><a href="#cb144-2019" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2020"><a href="#cb144-2020" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb144-2021"><a href="#cb144-2021" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2022"><a href="#cb144-2022" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-2023"><a href="#cb144-2023" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb144-2024"><a href="#cb144-2024" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb144-2025"><a href="#cb144-2025" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb144-2026"><a href="#cb144-2026" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb144-2027"><a href="#cb144-2027" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-2028"><a href="#cb144-2028" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2029"><a href="#cb144-2029" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-2030"><a href="#cb144-2030" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb144-2031"><a href="#cb144-2031" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb144-2032"><a href="#cb144-2032" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb144-2033"><a href="#cb144-2033" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb144-2034"><a href="#cb144-2034" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-2035"><a href="#cb144-2035" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, sequence, states, alphabet, transition_matrix, emission_matrix</span>
<span id="cb144-2036"><a href="#cb144-2036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2037"><a href="#cb144-2037" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-2038"><a href="#cb144-2038" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb144-2039"><a href="#cb144-2039" aria-hidden="true" tabindex="-1"></a>    niter, sequence, states, alphabet, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb144-2040"><a href="#cb144-2040" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb144-2041"><a href="#cb144-2041" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb144-2042"><a href="#cb144-2042" aria-hidden="true" tabindex="-1"></a>        transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb144-2043"><a href="#cb144-2043" aria-hidden="true" tabindex="-1"></a>        emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb144-2044"><a href="#cb144-2044" aria-hidden="true" tabindex="-1"></a>    print_dict(transition_matrix, states, states)</span>
<span id="cb144-2045"><a href="#cb144-2045" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb144-2046"><a href="#cb144-2046" aria-hidden="true" tabindex="-1"></a>    print_dict(emission_matrix, states, alphabet)</span>
<span id="cb144-2047"><a href="#cb144-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2048"><a href="#cb144-2048" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-2049"><a href="#cb144-2049" aria-hidden="true" tabindex="-1"></a><span class="st">100</span></span>
<span id="cb144-2050"><a href="#cb144-2050" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2051"><a href="#cb144-2051" aria-hidden="true" tabindex="-1"></a><span class="st">xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span></span>
<span id="cb144-2052"><a href="#cb144-2052" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2053"><a href="#cb144-2053" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb144-2054"><a href="#cb144-2054" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2055"><a href="#cb144-2055" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb144-2056"><a href="#cb144-2056" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2057"><a href="#cb144-2057" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb144-2058"><a href="#cb144-2058" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.582   0.418</span></span>
<span id="cb144-2059"><a href="#cb144-2059" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.272   0.728</span></span>
<span id="cb144-2060"><a href="#cb144-2060" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2061"><a href="#cb144-2061" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb144-2062"><a href="#cb144-2062" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.129   0.35    0.52</span></span>
<span id="cb144-2063"><a href="#cb144-2063" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.422   0.151   0.426</span></span>
<span id="cb144-2064"><a href="#cb144-2064" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-2065"><a href="#cb144-2065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2066"><a href="#cb144-2066" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb144-2067"><a href="#cb144-2067" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2068"><a href="#cb144-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2069"><a href="#cb144-2069" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the Soft Decoding Problem</span></span>
<span id="cb144-2070"><a href="#cb144-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2071"><a href="#cb144-2071" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;_x_, followed by the alphabet&nbsp;_Σ_&nbsp;from which&nbsp;_x_&nbsp;was constructed, followed by the states&nbsp;_States_, transition matrix&nbsp;_Transition_, <span class="kw">and</span> emission matrix&nbsp;_Emission_&nbsp;of an HMM (_Σ_,&nbsp;_States_,&nbsp;_Transition_,&nbsp;_Emission_).</span>
<span id="cb144-2072"><a href="#cb144-2072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2073"><a href="#cb144-2073" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The probability $Pr(π_i<span class="op">=</span>k<span class="op">|</span>x)$ that the HMM was <span class="kw">in</span> state k at step i (<span class="cf">for</span> each state k <span class="kw">and</span> each step i).</span>
<span id="cb144-2074"><a href="#cb144-2074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2075"><a href="#cb144-2075" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2076"><a href="#cb144-2076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2077"><a href="#cb144-2077" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2078"><a href="#cb144-2078" aria-hidden="true" tabindex="-1"></a>zyxxxxyxzz</span>
<span id="cb144-2079"><a href="#cb144-2079" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2080"><a href="#cb144-2080" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb144-2081"><a href="#cb144-2081" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2082"><a href="#cb144-2082" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb144-2083"><a href="#cb144-2083" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2084"><a href="#cb144-2084" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb144-2085"><a href="#cb144-2085" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.911</span>   <span class="fl">0.089</span></span>
<span id="cb144-2086"><a href="#cb144-2086" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.228</span>   <span class="fl">0.772</span></span>
<span id="cb144-2087"><a href="#cb144-2087" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2088"><a href="#cb144-2088" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb144-2089"><a href="#cb144-2089" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.356</span>   <span class="fl">0.191</span>   <span class="fl">0.453</span> </span>
<span id="cb144-2090"><a href="#cb144-2090" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.04</span>    <span class="fl">0.467</span>   <span class="fl">0.493</span></span>
<span id="cb144-2091"><a href="#cb144-2091" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2092"><a href="#cb144-2092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2093"><a href="#cb144-2093" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2094"><a href="#cb144-2094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2095"><a href="#cb144-2095" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2096"><a href="#cb144-2096" aria-hidden="true" tabindex="-1"></a>A   B </span>
<span id="cb144-2097"><a href="#cb144-2097" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5438</span>  <span class="fl">0.4562</span> </span>
<span id="cb144-2098"><a href="#cb144-2098" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6492</span>  <span class="fl">0.3508</span> </span>
<span id="cb144-2099"><a href="#cb144-2099" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9647</span>  <span class="fl">0.0353</span> </span>
<span id="cb144-2100"><a href="#cb144-2100" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9936</span>  <span class="fl">0.0064</span> </span>
<span id="cb144-2101"><a href="#cb144-2101" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9957</span>  <span class="fl">0.0043</span> </span>
<span id="cb144-2102"><a href="#cb144-2102" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9891</span>  <span class="fl">0.0109</span> </span>
<span id="cb144-2103"><a href="#cb144-2103" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9154</span>  <span class="fl">0.0846</span> </span>
<span id="cb144-2104"><a href="#cb144-2104" aria-hidden="true" tabindex="-1"></a><span class="fl">0.964</span>   <span class="fl">0.036</span> </span>
<span id="cb144-2105"><a href="#cb144-2105" aria-hidden="true" tabindex="-1"></a><span class="fl">0.8737</span>  <span class="fl">0.1263</span> </span>
<span id="cb144-2106"><a href="#cb144-2106" aria-hidden="true" tabindex="-1"></a><span class="fl">0.8167</span>  <span class="fl">0.1833</span></span>
<span id="cb144-2107"><a href="#cb144-2107" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2108"><a href="#cb144-2108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2109"><a href="#cb144-2109" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-2110"><a href="#cb144-2110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2111"><a href="#cb144-2111" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-2112"><a href="#cb144-2112" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb144-2113"><a href="#cb144-2113" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-2114"><a href="#cb144-2114" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb144-2115"><a href="#cb144-2115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2116"><a href="#cb144-2116" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb144-2117"><a href="#cb144-2117" aria-hidden="true" tabindex="-1"></a>    seq: <span class="bu">str</span> <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb144-2118"><a href="#cb144-2118" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2119"><a href="#cb144-2119" aria-hidden="true" tabindex="-1"></a>    alphabet: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb144-2120"><a href="#cb144-2120" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2121"><a href="#cb144-2121" aria-hidden="true" tabindex="-1"></a>    states: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb144-2122"><a href="#cb144-2122" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2123"><a href="#cb144-2123" aria-hidden="true" tabindex="-1"></a>    lines: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-2124"><a href="#cb144-2124" aria-hidden="true" tabindex="-1"></a>    tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb144-2125"><a href="#cb144-2125" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb144-2126"><a href="#cb144-2126" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb144-2127"><a href="#cb144-2127" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb144-2128"><a href="#cb144-2128" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-2129"><a href="#cb144-2129" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2130"><a href="#cb144-2130" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-2131"><a href="#cb144-2131" aria-hidden="true" tabindex="-1"></a>    emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb144-2132"><a href="#cb144-2132" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb144-2133"><a href="#cb144-2133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb144-2134"><a href="#cb144-2134" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb144-2135"><a href="#cb144-2135" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-2136"><a href="#cb144-2136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq, states, tmat, emat</span>
<span id="cb144-2137"><a href="#cb144-2137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2138"><a href="#cb144-2138" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-2139"><a href="#cb144-2139" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb144-2140"><a href="#cb144-2140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2141"><a href="#cb144-2141" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-2142"><a href="#cb144-2142" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb144-2143"><a href="#cb144-2143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb144-2144"><a href="#cb144-2144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-2145"><a href="#cb144-2145" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb144-2146"><a href="#cb144-2146" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb144-2147"><a href="#cb144-2147" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb144-2148"><a href="#cb144-2148" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb144-2149"><a href="#cb144-2149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2150"><a href="#cb144-2150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb144-2151"><a href="#cb144-2151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2152"><a href="#cb144-2152" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-2153"><a href="#cb144-2153" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb144-2154"><a href="#cb144-2154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2155"><a href="#cb144-2155" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb144-2156"><a href="#cb144-2156" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-2157"><a href="#cb144-2157" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb144-2158"><a href="#cb144-2158" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb144-2159"><a href="#cb144-2159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb144-2160"><a href="#cb144-2160" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb144-2161"><a href="#cb144-2161" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb144-2162"><a href="#cb144-2162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2163"><a href="#cb144-2163" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-2164"><a href="#cb144-2164" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb144-2165"><a href="#cb144-2165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb144-2166"><a href="#cb144-2166" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb144-2167"><a href="#cb144-2167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb144-2168"><a href="#cb144-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2169"><a href="#cb144-2169" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-2170"><a href="#cb144-2170" aria-hidden="true" tabindex="-1"></a>    input_lines: Iterator[<span class="bu">str</span>] <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb144-2171"><a href="#cb144-2171" aria-hidden="true" tabindex="-1"></a>    seq, states, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb144-2172"><a href="#cb144-2172" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> soft_decode(seq, states, tmat, emat)</span>
<span id="cb144-2173"><a href="#cb144-2173" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>states, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-2174"><a href="#cb144-2174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> r <span class="kw">in</span> np.<span class="bu">round</span>(tot, <span class="dv">4</span>):</span>
<span id="cb144-2175"><a href="#cb144-2175" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-2176"><a href="#cb144-2176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2177"><a href="#cb144-2177" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-2178"><a href="#cb144-2178" aria-hidden="true" tabindex="-1"></a><span class="st">zyxxxxyxzz</span></span>
<span id="cb144-2179"><a href="#cb144-2179" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2180"><a href="#cb144-2180" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb144-2181"><a href="#cb144-2181" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2182"><a href="#cb144-2182" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb144-2183"><a href="#cb144-2183" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2184"><a href="#cb144-2184" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb144-2185"><a href="#cb144-2185" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.911   0.089</span></span>
<span id="cb144-2186"><a href="#cb144-2186" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.228   0.772</span></span>
<span id="cb144-2187"><a href="#cb144-2187" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2188"><a href="#cb144-2188" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb144-2189"><a href="#cb144-2189" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.356   0.191   0.453 </span></span>
<span id="cb144-2190"><a href="#cb144-2190" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.04    0.467   0.493</span></span>
<span id="cb144-2191"><a href="#cb144-2191" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-2192"><a href="#cb144-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2193"><a href="#cb144-2193" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb144-2194"><a href="#cb144-2194" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2195"><a href="#cb144-2195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2196"><a href="#cb144-2196" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement Baum-Welch Learning</span></span>
<span id="cb144-2197"><a href="#cb144-2197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2198"><a href="#cb144-2198" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of emitted symbols $x<span class="op">=</span>x_1...x_n$ <span class="kw">in</span> an alphabet A, generated by a k<span class="op">-</span>state HMM <span class="cf">with</span> unknown transition <span class="kw">and</span> emission probabilities, initial Transition <span class="kw">and</span> Emission matrices <span class="kw">and</span> a number of iterations I.</span>
<span id="cb144-2199"><a href="#cb144-2199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2200"><a href="#cb144-2200" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A matrix of transition probabilities Transition <span class="kw">and</span> a matrix of emission probabilities Emission that maximizes $Pr(x,π)$ over <span class="bu">all</span> possible transition <span class="kw">and</span> emission matrices <span class="kw">and</span> over <span class="bu">all</span> hidden paths π.</span>
<span id="cb144-2201"><a href="#cb144-2201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2202"><a href="#cb144-2202" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2203"><a href="#cb144-2203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2204"><a href="#cb144-2204" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2205"><a href="#cb144-2205" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span>
<span id="cb144-2206"><a href="#cb144-2206" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2207"><a href="#cb144-2207" aria-hidden="true" tabindex="-1"></a>xzyyzyzyxy</span>
<span id="cb144-2208"><a href="#cb144-2208" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2209"><a href="#cb144-2209" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb144-2210"><a href="#cb144-2210" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2211"><a href="#cb144-2211" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb144-2212"><a href="#cb144-2212" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2213"><a href="#cb144-2213" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb144-2214"><a href="#cb144-2214" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.019</span>   <span class="fl">0.981</span> </span>
<span id="cb144-2215"><a href="#cb144-2215" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.668</span>   <span class="fl">0.332</span> </span>
<span id="cb144-2216"><a href="#cb144-2216" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2217"><a href="#cb144-2217" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb144-2218"><a href="#cb144-2218" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.175</span>   <span class="fl">0.003</span>   <span class="fl">0.821</span> </span>
<span id="cb144-2219"><a href="#cb144-2219" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.196</span>   <span class="fl">0.512</span>   <span class="fl">0.293</span></span>
<span id="cb144-2220"><a href="#cb144-2220" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2221"><a href="#cb144-2221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2222"><a href="#cb144-2222" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2223"><a href="#cb144-2223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2224"><a href="#cb144-2224" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2225"><a href="#cb144-2225" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb144-2226"><a href="#cb144-2226" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.000</span>   <span class="fl">1.000</span>   </span>
<span id="cb144-2227"><a href="#cb144-2227" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.786</span>   <span class="fl">0.214</span>   </span>
<span id="cb144-2228"><a href="#cb144-2228" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb144-2229"><a href="#cb144-2229" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb144-2230"><a href="#cb144-2230" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.242</span>   <span class="fl">0.000</span>   <span class="fl">0.758</span>   </span>
<span id="cb144-2231"><a href="#cb144-2231" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.172</span>   <span class="fl">0.828</span>   <span class="fl">0.000</span></span>
<span id="cb144-2232"><a href="#cb144-2232" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2233"><a href="#cb144-2233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2234"><a href="#cb144-2234" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-2235"><a href="#cb144-2235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2236"><a href="#cb144-2236" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-2237"><a href="#cb144-2237" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb144-2238"><a href="#cb144-2238" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb144-2239"><a href="#cb144-2239" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb144-2240"><a href="#cb144-2240" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-2241"><a href="#cb144-2241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2242"><a href="#cb144-2242" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-2243"><a href="#cb144-2243" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-2244"><a href="#cb144-2244" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb144-2245"><a href="#cb144-2245" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb144-2246"><a href="#cb144-2246" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb144-2247"><a href="#cb144-2247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2248"><a href="#cb144-2248" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-2249"><a href="#cb144-2249" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(col_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-2250"><a href="#cb144-2250" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb144-2251"><a href="#cb144-2251" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(col_labels):</span>
<span id="cb144-2252"><a href="#cb144-2252" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb144-2253"><a href="#cb144-2253" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, col_labels)</span>
<span id="cb144-2254"><a href="#cb144-2254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2255"><a href="#cb144-2255" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb144-2256"><a href="#cb144-2256" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb144-2257"><a href="#cb144-2257" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2258"><a href="#cb144-2258" aria-hidden="true" tabindex="-1"></a>    seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb144-2259"><a href="#cb144-2259" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2260"><a href="#cb144-2260" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb144-2261"><a href="#cb144-2261" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2262"><a href="#cb144-2262" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb144-2263"><a href="#cb144-2263" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2264"><a href="#cb144-2264" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-2265"><a href="#cb144-2265" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> {</span>
<span id="cb144-2266"><a href="#cb144-2266" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb144-2267"><a href="#cb144-2267" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb144-2268"><a href="#cb144-2268" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb144-2269"><a href="#cb144-2269" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-2270"><a href="#cb144-2270" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb144-2271"><a href="#cb144-2271" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-2272"><a href="#cb144-2272" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> {</span>
<span id="cb144-2273"><a href="#cb144-2273" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb144-2274"><a href="#cb144-2274" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb144-2275"><a href="#cb144-2275" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb144-2276"><a href="#cb144-2276" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb144-2277"><a href="#cb144-2277" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, seq, states, alphabet, tmat, emat</span>
<span id="cb144-2278"><a href="#cb144-2278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2279"><a href="#cb144-2279" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-2280"><a href="#cb144-2280" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb144-2281"><a href="#cb144-2281" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-2282"><a href="#cb144-2282" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb144-2283"><a href="#cb144-2283" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb144-2284"><a href="#cb144-2284" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-2285"><a href="#cb144-2285" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb144-2286"><a href="#cb144-2286" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb144-2287"><a href="#cb144-2287" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb144-2288"><a href="#cb144-2288" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb144-2289"><a href="#cb144-2289" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb144-2290"><a href="#cb144-2290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2291"><a href="#cb144-2291" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-2292"><a href="#cb144-2292" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb144-2293"><a href="#cb144-2293" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb144-2294"><a href="#cb144-2294" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-2295"><a href="#cb144-2295" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb144-2296"><a href="#cb144-2296" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb144-2297"><a href="#cb144-2297" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb144-2298"><a href="#cb144-2298" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb144-2299"><a href="#cb144-2299" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb144-2300"><a href="#cb144-2300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2301"><a href="#cb144-2301" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-2302"><a href="#cb144-2302" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb144-2303"><a href="#cb144-2303" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb144-2304"><a href="#cb144-2304" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb144-2305"><a href="#cb144-2305" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb144-2306"><a href="#cb144-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2307"><a href="#cb144-2307" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_dict(x: np.ndarray, r: List[<span class="bu">str</span>], c: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb144-2308"><a href="#cb144-2308" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb144-2309"><a href="#cb144-2309" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">0</span>]):</span>
<span id="cb144-2310"><a href="#cb144-2310" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">1</span>]):</span>
<span id="cb144-2311"><a href="#cb144-2311" aria-hidden="true" tabindex="-1"></a>            g[r[i], c[j]] <span class="op">=</span> x[i][j]</span>
<span id="cb144-2312"><a href="#cb144-2312" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g</span>
<span id="cb144-2313"><a href="#cb144-2313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2314"><a href="#cb144-2314" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_pi2(seq: <span class="bu">str</span>, fwd: np.ndarray, bak: np.ndarray, tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], states: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb144-2315"><a href="#cb144-2315" aria-hidden="true" tabindex="-1"></a>    rep_mat <span class="op">=</span> np.zeros((fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-2316"><a href="#cb144-2316" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb144-2317"><a href="#cb144-2317" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, s1 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-2318"><a href="#cb144-2318" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k, s2 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb144-2319"><a href="#cb144-2319" aria-hidden="true" tabindex="-1"></a>                weight <span class="op">=</span> tmat[s1, s2] <span class="op">*</span> emat[s2, seq[i <span class="op">+</span> <span class="dv">1</span>]]</span>
<span id="cb144-2320"><a href="#cb144-2320" aria-hidden="true" tabindex="-1"></a>                rep_mat[i, j, k] <span class="op">=</span> (</span>
<span id="cb144-2321"><a href="#cb144-2321" aria-hidden="true" tabindex="-1"></a>                    fwd[i, j] <span class="op">*</span> bak[i <span class="op">+</span> <span class="dv">1</span>, k] <span class="op">*</span> weight <span class="op">/</span> <span class="bu">sum</span>(fwd[i, :] <span class="op">*</span> bak[i, :])</span>
<span id="cb144-2322"><a href="#cb144-2322" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb144-2323"><a href="#cb144-2323" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rep_mat</span>
<span id="cb144-2324"><a href="#cb144-2324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2325"><a href="#cb144-2325" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_tmat(seq: <span class="bu">str</span>, st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb144-2326"><a href="#cb144-2326" aria-hidden="true" tabindex="-1"></a>    fwd <span class="op">=</span> forward(seq, st, tmat, emat)</span>
<span id="cb144-2327"><a href="#cb144-2327" aria-hidden="true" tabindex="-1"></a>    bak <span class="op">=</span> backward(seq, st, tmat, emat)</span>
<span id="cb144-2328"><a href="#cb144-2328" aria-hidden="true" tabindex="-1"></a>    pi2 <span class="op">=</span> estimate_pi2(seq, fwd, bak, tmat, emat, st)</span>
<span id="cb144-2329"><a href="#cb144-2329" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> np.<span class="bu">sum</span>(pi2, <span class="dv">0</span>)</span>
<span id="cb144-2330"><a href="#cb144-2330" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> tmat_new <span class="op">/</span> np.<span class="bu">sum</span>(tmat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb144-2331"><a href="#cb144-2331" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(tmat_new, st, st)</span>
<span id="cb144-2332"><a href="#cb144-2332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2333"><a href="#cb144-2333" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emat(seq: <span class="bu">str</span>, al: List[<span class="bu">str</span>], st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb144-2334"><a href="#cb144-2334" aria-hidden="true" tabindex="-1"></a>    pi1 <span class="op">=</span> soft_decode(seq, st, tmat, emat)</span>
<span id="cb144-2335"><a href="#cb144-2335" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> np.zeros((<span class="bu">len</span>(st), <span class="bu">len</span>(al)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb144-2336"><a href="#cb144-2336" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(al):</span>
<span id="cb144-2337"><a href="#cb144-2337" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> np.array(<span class="bu">list</span>(seq)) <span class="op">==</span> emission</span>
<span id="cb144-2338"><a href="#cb144-2338" aria-hidden="true" tabindex="-1"></a>        emat_new[:, i] <span class="op">=</span> np.<span class="bu">sum</span>(pi1[ind, :], <span class="dv">0</span>)</span>
<span id="cb144-2339"><a href="#cb144-2339" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> emat_new <span class="op">/</span> np.<span class="bu">sum</span>(emat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb144-2340"><a href="#cb144-2340" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(emat_new, st, al)</span>
<span id="cb144-2341"><a href="#cb144-2341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2342"><a href="#cb144-2342" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb144-2343"><a href="#cb144-2343" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb144-2344"><a href="#cb144-2344" aria-hidden="true" tabindex="-1"></a>    niter, seq, st, al, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb144-2345"><a href="#cb144-2345" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb144-2346"><a href="#cb144-2346" aria-hidden="true" tabindex="-1"></a>        tmat2 <span class="op">=</span> estimate_tmat(seq, st, tmat, emat)</span>
<span id="cb144-2347"><a href="#cb144-2347" aria-hidden="true" tabindex="-1"></a>        emat2 <span class="op">=</span> estimate_emat(seq, al, st, tmat, emat)</span>
<span id="cb144-2348"><a href="#cb144-2348" aria-hidden="true" tabindex="-1"></a>        emat, tmat <span class="op">=</span> emat2, tmat2</span>
<span id="cb144-2349"><a href="#cb144-2349" aria-hidden="true" tabindex="-1"></a>    print_dict(tmat, st, st)</span>
<span id="cb144-2350"><a href="#cb144-2350" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb144-2351"><a href="#cb144-2351" aria-hidden="true" tabindex="-1"></a>    print_dict(emat, st, al)</span>
<span id="cb144-2352"><a href="#cb144-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2353"><a href="#cb144-2353" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-2354"><a href="#cb144-2354" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb144-2355"><a href="#cb144-2355" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2356"><a href="#cb144-2356" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzyzyxy</span></span>
<span id="cb144-2357"><a href="#cb144-2357" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2358"><a href="#cb144-2358" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb144-2359"><a href="#cb144-2359" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2360"><a href="#cb144-2360" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb144-2361"><a href="#cb144-2361" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2362"><a href="#cb144-2362" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb144-2363"><a href="#cb144-2363" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.019   0.981 </span></span>
<span id="cb144-2364"><a href="#cb144-2364" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.668   0.332 </span></span>
<span id="cb144-2365"><a href="#cb144-2365" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb144-2366"><a href="#cb144-2366" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb144-2367"><a href="#cb144-2367" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.175   0.003   0.821 </span></span>
<span id="cb144-2368"><a href="#cb144-2368" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.196   0.512   0.293</span></span>
<span id="cb144-2369"><a href="#cb144-2369" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-2370"><a href="#cb144-2370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2371"><a href="#cb144-2371" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb144-2372"><a href="#cb144-2372" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2373"><a href="#cb144-2373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2374"><a href="#cb144-2374" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Graph of a Spectrum</span></span>
<span id="cb144-2375"><a href="#cb144-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2376"><a href="#cb144-2376" aria-hidden="true" tabindex="-1"></a><span class="co">## Spectrum Graph Construction</span></span>
<span id="cb144-2377"><a href="#cb144-2377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2378"><a href="#cb144-2378" aria-hidden="true" tabindex="-1"></a>Construct the graph of a spectrum.</span>
<span id="cb144-2379"><a href="#cb144-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2380"><a href="#cb144-2380" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A space<span class="op">-</span>delimited <span class="bu">list</span> of integers&nbsp;_Spectrum_.</span>
<span id="cb144-2381"><a href="#cb144-2381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2382"><a href="#cb144-2382" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;_Graph(Spectrum)_.</span>
<span id="cb144-2383"><a href="#cb144-2383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2384"><a href="#cb144-2384" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb144-2385"><a href="#cb144-2385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2386"><a href="#cb144-2386" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2387"><a href="#cb144-2387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2388"><a href="#cb144-2388" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2389"><a href="#cb144-2389" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span> <span class="dv">71</span> <span class="dv">154</span> <span class="dv">185</span> <span class="dv">301</span> <span class="dv">332</span> <span class="dv">415</span> <span class="dv">429</span> <span class="dv">486</span></span>
<span id="cb144-2390"><a href="#cb144-2390" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2391"><a href="#cb144-2391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2392"><a href="#cb144-2392" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2393"><a href="#cb144-2393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2394"><a href="#cb144-2394" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2395"><a href="#cb144-2395" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">57</span>:G</span>
<span id="cb144-2396"><a href="#cb144-2396" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">71</span>:A</span>
<span id="cb144-2397"><a href="#cb144-2397" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span><span class="op">-&gt;</span><span class="dv">154</span>:P</span>
<span id="cb144-2398"><a href="#cb144-2398" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span><span class="op">-&gt;</span><span class="dv">185</span>:K</span>
<span id="cb144-2399"><a href="#cb144-2399" aria-hidden="true" tabindex="-1"></a><span class="dv">71</span><span class="op">-&gt;</span><span class="dv">185</span>:N</span>
<span id="cb144-2400"><a href="#cb144-2400" aria-hidden="true" tabindex="-1"></a><span class="dv">154</span><span class="op">-&gt;</span><span class="dv">301</span>:F</span>
<span id="cb144-2401"><a href="#cb144-2401" aria-hidden="true" tabindex="-1"></a><span class="dv">185</span><span class="op">-&gt;</span><span class="dv">332</span>:F</span>
<span id="cb144-2402"><a href="#cb144-2402" aria-hidden="true" tabindex="-1"></a><span class="dv">301</span><span class="op">-&gt;</span><span class="dv">415</span>:N</span>
<span id="cb144-2403"><a href="#cb144-2403" aria-hidden="true" tabindex="-1"></a><span class="dv">301</span><span class="op">-&gt;</span><span class="dv">429</span>:K</span>
<span id="cb144-2404"><a href="#cb144-2404" aria-hidden="true" tabindex="-1"></a><span class="dv">332</span><span class="op">-&gt;</span><span class="dv">429</span>:P</span>
<span id="cb144-2405"><a href="#cb144-2405" aria-hidden="true" tabindex="-1"></a><span class="dv">415</span><span class="op">-&gt;</span><span class="dv">486</span>:A</span>
<span id="cb144-2406"><a href="#cb144-2406" aria-hidden="true" tabindex="-1"></a><span class="dv">429</span><span class="op">-&gt;</span><span class="dv">486</span>:G</span>
<span id="cb144-2407"><a href="#cb144-2407" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2408"><a href="#cb144-2408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2409"><a href="#cb144-2409" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-2410"><a href="#cb144-2410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2411"><a href="#cb144-2411" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-2412"><a href="#cb144-2412" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-2413"><a href="#cb144-2413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2414"><a href="#cb144-2414" aria-hidden="true" tabindex="-1"></a><span class="co"># Amino acid weights dictionary</span></span>
<span id="cb144-2415"><a href="#cb144-2415" aria-hidden="true" tabindex="-1"></a>amino_acid_weights <span class="op">=</span> {</span>
<span id="cb144-2416"><a href="#cb144-2416" aria-hidden="true" tabindex="-1"></a>    <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'V'</span>: <span class="dv">99</span>,</span>
<span id="cb144-2417"><a href="#cb144-2417" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>,</span>
<span id="cb144-2418"><a href="#cb144-2418" aria-hidden="true" tabindex="-1"></a>    <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb144-2419"><a href="#cb144-2419" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'W'</span>: <span class="dv">186</span></span>
<span id="cb144-2420"><a href="#cb144-2420" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb144-2421"><a href="#cb144-2421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2422"><a href="#cb144-2422" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectrum_graph(masses):</span>
<span id="cb144-2423"><a href="#cb144-2423" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reverse mapping of weights to amino acids</span></span>
<span id="cb144-2424"><a href="#cb144-2424" aria-hidden="true" tabindex="-1"></a>    weight_to_amino_acid <span class="op">=</span> {weight: aa <span class="cf">for</span> aa, weight <span class="kw">in</span> amino_acid_weights.items()}</span>
<span id="cb144-2425"><a href="#cb144-2425" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2426"><a href="#cb144-2426" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb144-2427"><a href="#cb144-2427" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2428"><a href="#cb144-2428" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create graph based on mass differences</span></span>
<span id="cb144-2429"><a href="#cb144-2429" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(masses)):</span>
<span id="cb144-2430"><a href="#cb144-2430" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(masses)):</span>
<span id="cb144-2431"><a href="#cb144-2431" aria-hidden="true" tabindex="-1"></a>            difference <span class="op">=</span> masses[j] <span class="op">-</span> masses[i]</span>
<span id="cb144-2432"><a href="#cb144-2432" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> difference <span class="kw">in</span> weight_to_amino_acid:</span>
<span id="cb144-2433"><a href="#cb144-2433" aria-hidden="true" tabindex="-1"></a>                graph[masses[i]].append({<span class="st">"n"</span>: masses[j], <span class="st">"l"</span>: weight_to_amino_acid[difference]})</span>
<span id="cb144-2434"><a href="#cb144-2434" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2435"><a href="#cb144-2435" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-2436"><a href="#cb144-2436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2437"><a href="#cb144-2437" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-2438"><a href="#cb144-2438" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"57 71 154 185 301 332 415 429 486"</span></span>
<span id="cb144-2439"><a href="#cb144-2439" aria-hidden="true" tabindex="-1"></a>masses <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, sample_input.split()))</span>
<span id="cb144-2440"><a href="#cb144-2440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2441"><a href="#cb144-2441" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the spectrum graph</span></span>
<span id="cb144-2442"><a href="#cb144-2442" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_mass, edges <span class="kw">in</span> spectrum_graph(masses).items():</span>
<span id="cb144-2443"><a href="#cb144-2443" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb144-2444"><a href="#cb144-2444" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>start_mass<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>edge[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>edge[<span class="st">'l'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb144-2445"><a href="#cb144-2445" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2446"><a href="#cb144-2446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2447"><a href="#cb144-2447" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement MotifEnumeration</span></span>
<span id="cb144-2448"><a href="#cb144-2448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2449"><a href="#cb144-2449" aria-hidden="true" tabindex="-1"></a>Implanted Motif Problem. Implement MotifEnumeration (shown above) to find <span class="bu">all</span> (k, d)<span class="op">-</span>motifs <span class="kw">in</span> a collection of strings.</span>
<span id="cb144-2450"><a href="#cb144-2450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2451"><a href="#cb144-2451" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;_k_&nbsp;and&nbsp;_d_, followed by a collection of strings&nbsp;_Dna_.</span>
<span id="cb144-2452"><a href="#cb144-2452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2453"><a href="#cb144-2453" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All (_k_,&nbsp;_d_)<span class="op">-</span>motifs in&nbsp;_Dna_.</span>
<span id="cb144-2454"><a href="#cb144-2454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2455"><a href="#cb144-2455" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2456"><a href="#cb144-2456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2457"><a href="#cb144-2457" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2458"><a href="#cb144-2458" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">1</span></span>
<span id="cb144-2459"><a href="#cb144-2459" aria-hidden="true" tabindex="-1"></a>ATTTGGC</span>
<span id="cb144-2460"><a href="#cb144-2460" aria-hidden="true" tabindex="-1"></a>TGCCTTA</span>
<span id="cb144-2461"><a href="#cb144-2461" aria-hidden="true" tabindex="-1"></a>CGGTATC</span>
<span id="cb144-2462"><a href="#cb144-2462" aria-hidden="true" tabindex="-1"></a>GAAAATT</span>
<span id="cb144-2463"><a href="#cb144-2463" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2464"><a href="#cb144-2464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2465"><a href="#cb144-2465" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2466"><a href="#cb144-2466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2467"><a href="#cb144-2467" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2468"><a href="#cb144-2468" aria-hidden="true" tabindex="-1"></a>ATA ATT GTT TTT</span>
<span id="cb144-2469"><a href="#cb144-2469" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2470"><a href="#cb144-2470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2471"><a href="#cb144-2471" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-2472"><a href="#cb144-2472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2473"><a href="#cb144-2473" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-2474"><a href="#cb144-2474" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Iterator</span>
<span id="cb144-2475"><a href="#cb144-2475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2476"><a href="#cb144-2476" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-2477"><a href="#cb144-2477" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb144-2478"><a href="#cb144-2478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2479"><a href="#cb144-2479" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb144-2480"><a href="#cb144-2480" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb144-2481"><a href="#cb144-2481" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb144-2482"><a href="#cb144-2482" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb144-2483"><a href="#cb144-2483" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb144-2484"><a href="#cb144-2484" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb144-2485"><a href="#cb144-2485" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2486"><a href="#cb144-2486" aria-hidden="true" tabindex="-1"></a>    neighbor_set <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb144-2487"><a href="#cb144-2487" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance):</span>
<span id="cb144-2488"><a href="#cb144-2488" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], neighbor) <span class="op">&lt;</span> max_distance:</span>
<span id="cb144-2489"><a href="#cb144-2489" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb144-2490"><a href="#cb144-2490" aria-hidden="true" tabindex="-1"></a>                neighbor_set.add(nucleotide <span class="op">+</span> neighbor)</span>
<span id="cb144-2491"><a href="#cb144-2491" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb144-2492"><a href="#cb144-2492" aria-hidden="true" tabindex="-1"></a>            neighbor_set.add(sequence[<span class="dv">0</span>] <span class="op">+</span> neighbor)</span>
<span id="cb144-2493"><a href="#cb144-2493" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbor_set</span>
<span id="cb144-2494"><a href="#cb144-2494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2495"><a href="#cb144-2495" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-2496"><a href="#cb144-2496" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-2497"><a href="#cb144-2497" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb144-2498"><a href="#cb144-2498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2499"><a href="#cb144-2499" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_kmers(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb144-2500"><a href="#cb144-2500" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(kmer <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length))</span>
<span id="cb144-2501"><a href="#cb144-2501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2502"><a href="#cb144-2502" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> contains_approximate_match(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb144-2503"><a href="#cb144-2503" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_distance </span>
<span id="cb144-2504"><a href="#cb144-2504" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb144-2505"><a href="#cb144-2505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2506"><a href="#cb144-2506" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enumerate_motifs(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb144-2507"><a href="#cb144-2507" aria-hidden="true" tabindex="-1"></a>    motif_patterns <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb144-2508"><a href="#cb144-2508" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> get_all_kmers(dna_sequences, kmer_length):</span>
<span id="cb144-2509"><a href="#cb144-2509" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor_kmer <span class="kw">in</span> generate_neighbors(kmer, max_distance):</span>
<span id="cb144-2510"><a href="#cb144-2510" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(contains_approximate_match(neighbor_kmer, sequence, max_distance) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences):</span>
<span id="cb144-2511"><a href="#cb144-2511" aria-hidden="true" tabindex="-1"></a>                motif_patterns.add(neighbor_kmer)</span>
<span id="cb144-2512"><a href="#cb144-2512" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> motif_patterns</span>
<span id="cb144-2513"><a href="#cb144-2513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2514"><a href="#cb144-2514" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-2515"><a href="#cb144-2515" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-2516"><a href="#cb144-2516" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb144-2517"><a href="#cb144-2517" aria-hidden="true" tabindex="-1"></a><span class="st">ATTTGGC</span></span>
<span id="cb144-2518"><a href="#cb144-2518" aria-hidden="true" tabindex="-1"></a><span class="st">TGCCTTA</span></span>
<span id="cb144-2519"><a href="#cb144-2519" aria-hidden="true" tabindex="-1"></a><span class="st">CGGTATC</span></span>
<span id="cb144-2520"><a href="#cb144-2520" aria-hidden="true" tabindex="-1"></a><span class="st">GAAAATT</span></span>
<span id="cb144-2521"><a href="#cb144-2521" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-2522"><a href="#cb144-2522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2523"><a href="#cb144-2523" aria-hidden="true" tabindex="-1"></a>input_params, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-2524"><a href="#cb144-2524" aria-hidden="true" tabindex="-1"></a>kmer_length, max_distance <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_params.split())</span>
<span id="cb144-2525"><a href="#cb144-2525" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(enumerate_motifs(dna_sequences, kmer_length, max_distance)))</span>
<span id="cb144-2526"><a href="#cb144-2526" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2527"><a href="#cb144-2527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2528"><a href="#cb144-2528" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Median String</span></span>
<span id="cb144-2529"><a href="#cb144-2529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2530"><a href="#cb144-2530" aria-hidden="true" tabindex="-1"></a>Median String Problem, Find a median string.</span>
<span id="cb144-2531"><a href="#cb144-2531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2532"><a href="#cb144-2532" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;_k_&nbsp;and a collection of strings&nbsp;_Dna_.</span>
<span id="cb144-2533"><a href="#cb144-2533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2534"><a href="#cb144-2534" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A&nbsp;_k_<span class="op">-</span>mer&nbsp;_Pattern_&nbsp;that minimizes&nbsp;_d_(_Pattern_,&nbsp;_Dna_) over all&nbsp;_k_<span class="op">-</span>mers&nbsp;_Pattern_. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb144-2535"><a href="#cb144-2535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2536"><a href="#cb144-2536" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2537"><a href="#cb144-2537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2538"><a href="#cb144-2538" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2539"><a href="#cb144-2539" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb144-2540"><a href="#cb144-2540" aria-hidden="true" tabindex="-1"></a>AAATTGACGCAT</span>
<span id="cb144-2541"><a href="#cb144-2541" aria-hidden="true" tabindex="-1"></a>GACGACCACGTT</span>
<span id="cb144-2542"><a href="#cb144-2542" aria-hidden="true" tabindex="-1"></a>CGTCAGCGCCTG</span>
<span id="cb144-2543"><a href="#cb144-2543" aria-hidden="true" tabindex="-1"></a>GCTGAGCACCGG</span>
<span id="cb144-2544"><a href="#cb144-2544" aria-hidden="true" tabindex="-1"></a>AGTACGGGACAG</span>
<span id="cb144-2545"><a href="#cb144-2545" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2546"><a href="#cb144-2546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2547"><a href="#cb144-2547" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2548"><a href="#cb144-2548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2549"><a href="#cb144-2549" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2550"><a href="#cb144-2550" aria-hidden="true" tabindex="-1"></a>ACG</span>
<span id="cb144-2551"><a href="#cb144-2551" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2552"><a href="#cb144-2552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2553"><a href="#cb144-2553" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-2554"><a href="#cb144-2554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2555"><a href="#cb144-2555" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-2556"><a href="#cb144-2556" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb144-2557"><a href="#cb144-2557" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb144-2558"><a href="#cb144-2558" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb144-2559"><a href="#cb144-2559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2560"><a href="#cb144-2560" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-2561"><a href="#cb144-2561" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-2562"><a href="#cb144-2562" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb144-2563"><a href="#cb144-2563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2564"><a href="#cb144-2564" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-2565"><a href="#cb144-2565" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(nucleotides) <span class="cf">for</span> nucleotides <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb144-2566"><a href="#cb144-2566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2567"><a href="#cb144-2567" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-2568"><a href="#cb144-2568" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(nucleotide1 <span class="op">!=</span> nucleotide2 <span class="cf">for</span> nucleotide1, nucleotide2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb144-2569"><a href="#cb144-2569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2570"><a href="#cb144-2570" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-2571"><a href="#cb144-2571" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(substring, pattern) <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb144-2572"><a href="#cb144-2572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2573"><a href="#cb144-2573" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_total_distance(pattern: <span class="bu">str</span>, dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-2574"><a href="#cb144-2574" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, sequence) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences)</span>
<span id="cb144-2575"><a href="#cb144-2575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2576"><a href="#cb144-2576" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_median_string(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-2577"><a href="#cb144-2577" aria-hidden="true" tabindex="-1"></a>    min_distance <span class="op">=</span> math.inf</span>
<span id="cb144-2578"><a href="#cb144-2578" aria-hidden="true" tabindex="-1"></a>    median_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb144-2579"><a href="#cb144-2579" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2580"><a href="#cb144-2580" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb144-2581"><a href="#cb144-2581" aria-hidden="true" tabindex="-1"></a>        current_distance <span class="op">=</span> calculate_total_distance(kmer, dna_sequences)</span>
<span id="cb144-2582"><a href="#cb144-2582" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_distance <span class="op">&lt;</span> min_distance:</span>
<span id="cb144-2583"><a href="#cb144-2583" aria-hidden="true" tabindex="-1"></a>            min_distance <span class="op">=</span> current_distance</span>
<span id="cb144-2584"><a href="#cb144-2584" aria-hidden="true" tabindex="-1"></a>            median_kmer <span class="op">=</span> kmer</span>
<span id="cb144-2585"><a href="#cb144-2585" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2586"><a href="#cb144-2586" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> median_kmer</span>
<span id="cb144-2587"><a href="#cb144-2587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2588"><a href="#cb144-2588" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-2589"><a href="#cb144-2589" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-2590"><a href="#cb144-2590" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb144-2591"><a href="#cb144-2591" aria-hidden="true" tabindex="-1"></a><span class="st">AAATTGACGCAT</span></span>
<span id="cb144-2592"><a href="#cb144-2592" aria-hidden="true" tabindex="-1"></a><span class="st">GACGACCACGTT</span></span>
<span id="cb144-2593"><a href="#cb144-2593" aria-hidden="true" tabindex="-1"></a><span class="st">CGTCAGCGCCTG</span></span>
<span id="cb144-2594"><a href="#cb144-2594" aria-hidden="true" tabindex="-1"></a><span class="st">GCTGAGCACCGG</span></span>
<span id="cb144-2595"><a href="#cb144-2595" aria-hidden="true" tabindex="-1"></a><span class="st">AGTACGGGACAG</span></span>
<span id="cb144-2596"><a href="#cb144-2596" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-2597"><a href="#cb144-2597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2598"><a href="#cb144-2598" aria-hidden="true" tabindex="-1"></a>kmer_length, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-2599"><a href="#cb144-2599" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_median_string(dna_sequences, <span class="bu">int</span>(kmer_length))</span>
<span id="cb144-2600"><a href="#cb144-2600" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb144-2601"><a href="#cb144-2601" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2602"><a href="#cb144-2602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2603"><a href="#cb144-2603" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Profile-most Probable k-mer in a String</span></span>
<span id="cb144-2604"><a href="#cb144-2604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2605"><a href="#cb144-2605" aria-hidden="true" tabindex="-1"></a>Profile<span class="op">-</span>most Probable&nbsp;_k_<span class="op">-</span>mer Problem, Find a Profile<span class="op">-</span>most probable k<span class="op">-</span>mer <span class="kw">in</span> a string.</span>
<span id="cb144-2606"><a href="#cb144-2606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2607"><a href="#cb144-2607" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;_Text_, an integer&nbsp;_k_, <span class="kw">and</span> a <span class="dv">4</span> ×&nbsp;_k_&nbsp;matrix&nbsp;_Profile_.</span>
<span id="cb144-2608"><a href="#cb144-2608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2609"><a href="#cb144-2609" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A&nbsp;_Profile_<span class="op">-</span>most probable&nbsp;_k_<span class="op">-</span>mer in&nbsp;_Text_. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb144-2610"><a href="#cb144-2610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2611"><a href="#cb144-2611" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2612"><a href="#cb144-2612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2613"><a href="#cb144-2613" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2614"><a href="#cb144-2614" aria-hidden="true" tabindex="-1"></a>ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span>
<span id="cb144-2615"><a href="#cb144-2615" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb144-2616"><a href="#cb144-2616" aria-hidden="true" tabindex="-1"></a><span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.3</span> <span class="fl">0.2</span> <span class="fl">0.3</span></span>
<span id="cb144-2617"><a href="#cb144-2617" aria-hidden="true" tabindex="-1"></a><span class="fl">0.4</span> <span class="fl">0.3</span> <span class="fl">0.1</span> <span class="fl">0.5</span> <span class="fl">0.1</span></span>
<span id="cb144-2618"><a href="#cb144-2618" aria-hidden="true" tabindex="-1"></a><span class="fl">0.3</span> <span class="fl">0.3</span> <span class="fl">0.5</span> <span class="fl">0.2</span> <span class="fl">0.4</span></span>
<span id="cb144-2619"><a href="#cb144-2619" aria-hidden="true" tabindex="-1"></a><span class="fl">0.1</span> <span class="fl">0.2</span> <span class="fl">0.1</span> <span class="fl">0.1</span> <span class="fl">0.2</span></span>
<span id="cb144-2620"><a href="#cb144-2620" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2621"><a href="#cb144-2621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2622"><a href="#cb144-2622" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2623"><a href="#cb144-2623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2624"><a href="#cb144-2624" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2625"><a href="#cb144-2625" aria-hidden="true" tabindex="-1"></a>CCGAG</span>
<span id="cb144-2626"><a href="#cb144-2626" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2627"><a href="#cb144-2627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2628"><a href="#cb144-2628" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-2629"><a href="#cb144-2629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2630"><a href="#cb144-2630" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-2631"><a href="#cb144-2631" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb144-2632"><a href="#cb144-2632" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb144-2633"><a href="#cb144-2633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2634"><a href="#cb144-2634" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-2635"><a href="#cb144-2635" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-2636"><a href="#cb144-2636" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb144-2637"><a href="#cb144-2637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2638"><a href="#cb144-2638" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_profile_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile_matrix: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-2639"><a href="#cb144-2639" aria-hidden="true" tabindex="-1"></a>    nucleotide_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb144-2640"><a href="#cb144-2640" aria-hidden="true" tabindex="-1"></a>    max_probability <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb144-2641"><a href="#cb144-2641" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb144-2642"><a href="#cb144-2642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2643"><a href="#cb144-2643" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length):</span>
<span id="cb144-2644"><a href="#cb144-2644" aria-hidden="true" tabindex="-1"></a>        kmer_probability <span class="op">=</span> math.prod(profile_matrix[nucleotide_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb144-2645"><a href="#cb144-2645" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb144-2646"><a href="#cb144-2646" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb144-2647"><a href="#cb144-2647" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb144-2648"><a href="#cb144-2648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2649"><a href="#cb144-2649" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb144-2650"><a href="#cb144-2650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2651"><a href="#cb144-2651" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-2652"><a href="#cb144-2652" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-2653"><a href="#cb144-2653" aria-hidden="true" tabindex="-1"></a><span class="st">ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span></span>
<span id="cb144-2654"><a href="#cb144-2654" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb144-2655"><a href="#cb144-2655" aria-hidden="true" tabindex="-1"></a><span class="st">0.2 0.2 0.3 0.2 0.3</span></span>
<span id="cb144-2656"><a href="#cb144-2656" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.3 0.1 0.5 0.1</span></span>
<span id="cb144-2657"><a href="#cb144-2657" aria-hidden="true" tabindex="-1"></a><span class="st">0.3 0.3 0.5 0.2 0.4</span></span>
<span id="cb144-2658"><a href="#cb144-2658" aria-hidden="true" tabindex="-1"></a><span class="st">0.1 0.2 0.1 0.1 0.2</span></span>
<span id="cb144-2659"><a href="#cb144-2659" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-2660"><a href="#cb144-2660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2661"><a href="#cb144-2661" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, <span class="op">*</span>profile_rows <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-2662"><a href="#cb144-2662" aria-hidden="true" tabindex="-1"></a>profile_matrix <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> profile_rows]</span>
<span id="cb144-2663"><a href="#cb144-2663" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_profile_most_probable_kmer(dna_sequence, <span class="bu">int</span>(kmer_length), profile_matrix)</span>
<span id="cb144-2664"><a href="#cb144-2664" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb144-2665"><a href="#cb144-2665" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2666"><a href="#cb144-2666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2667"><a href="#cb144-2667" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GreedyMotifSearch</span></span>
<span id="cb144-2668"><a href="#cb144-2668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2669"><a href="#cb144-2669" aria-hidden="true" tabindex="-1"></a> Implement, GreedyMotifSearch.</span>
<span id="cb144-2670"><a href="#cb144-2670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2671"><a href="#cb144-2671" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;_k_&nbsp;and&nbsp;_t_, followed by a collection of strings&nbsp;_Dna_.</span>
<span id="cb144-2672"><a href="#cb144-2672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2673"><a href="#cb144-2673" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A collection of strings&nbsp;_BestMotifs_&nbsp;resulting <span class="im">from</span> running&nbsp;_GreedyMotifSearch_(_Dna_,&nbsp;_k_,&nbsp;_t_). If at <span class="bu">any</span> step you find more than one&nbsp;_Profile_<span class="op">-</span>most probable&nbsp;_k_<span class="op">-</span>mer <span class="kw">in</span> a given string, use the one occurring first.</span>
<span id="cb144-2674"><a href="#cb144-2674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2675"><a href="#cb144-2675" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2676"><a href="#cb144-2676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2677"><a href="#cb144-2677" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2678"><a href="#cb144-2678" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">5</span></span>
<span id="cb144-2679"><a href="#cb144-2679" aria-hidden="true" tabindex="-1"></a>GGCGTTCAGGCA</span>
<span id="cb144-2680"><a href="#cb144-2680" aria-hidden="true" tabindex="-1"></a>AAGAATCAGTCA</span>
<span id="cb144-2681"><a href="#cb144-2681" aria-hidden="true" tabindex="-1"></a>CAAGGAGTTCGC</span>
<span id="cb144-2682"><a href="#cb144-2682" aria-hidden="true" tabindex="-1"></a>CACGTCAATCAC</span>
<span id="cb144-2683"><a href="#cb144-2683" aria-hidden="true" tabindex="-1"></a>CAATAATATTCG</span>
<span id="cb144-2684"><a href="#cb144-2684" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2685"><a href="#cb144-2685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2686"><a href="#cb144-2686" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2687"><a href="#cb144-2687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2688"><a href="#cb144-2688" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2689"><a href="#cb144-2689" aria-hidden="true" tabindex="-1"></a>CAG</span>
<span id="cb144-2690"><a href="#cb144-2690" aria-hidden="true" tabindex="-1"></a>CAG</span>
<span id="cb144-2691"><a href="#cb144-2691" aria-hidden="true" tabindex="-1"></a>CAA</span>
<span id="cb144-2692"><a href="#cb144-2692" aria-hidden="true" tabindex="-1"></a>CAA</span>
<span id="cb144-2693"><a href="#cb144-2693" aria-hidden="true" tabindex="-1"></a>CAA</span>
<span id="cb144-2694"><a href="#cb144-2694" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2695"><a href="#cb144-2695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2696"><a href="#cb144-2696" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-2697"><a href="#cb144-2697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2698"><a href="#cb144-2698" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-2699"><a href="#cb144-2699" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb144-2700"><a href="#cb144-2700" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb144-2701"><a href="#cb144-2701" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb144-2702"><a href="#cb144-2702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2703"><a href="#cb144-2703" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-2704"><a href="#cb144-2704" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-2705"><a href="#cb144-2705" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb144-2706"><a href="#cb144-2706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2707"><a href="#cb144-2707" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-2708"><a href="#cb144-2708" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb144-2709"><a href="#cb144-2709" aria-hidden="true" tabindex="-1"></a>    max_probability: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb144-2710"><a href="#cb144-2710" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb144-2711"><a href="#cb144-2711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2712"><a href="#cb144-2712" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length):</span>
<span id="cb144-2713"><a href="#cb144-2713" aria-hidden="true" tabindex="-1"></a>        kmer_probability: <span class="bu">float</span> <span class="op">=</span> math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb144-2714"><a href="#cb144-2714" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb144-2715"><a href="#cb144-2715" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb144-2716"><a href="#cb144-2716" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb144-2717"><a href="#cb144-2717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2718"><a href="#cb144-2718" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb144-2719"><a href="#cb144-2719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2720"><a href="#cb144-2720" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(sequences: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb144-2721"><a href="#cb144-2721" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb144-2722"><a href="#cb144-2722" aria-hidden="true" tabindex="-1"></a>    profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> [[] <span class="cf">for</span> _ <span class="kw">in</span> nucleotides]</span>
<span id="cb144-2723"><a href="#cb144-2723" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(nucleotides):</span>
<span id="cb144-2724"><a href="#cb144-2724" aria-hidden="true" tabindex="-1"></a>        profile[i] <span class="op">=</span> [</span>
<span id="cb144-2725"><a href="#cb144-2725" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> sequences) <span class="op">+</span> pseudocount) <span class="op">/</span> <span class="bu">len</span>(sequences)</span>
<span id="cb144-2726"><a href="#cb144-2726" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequences[<span class="dv">0</span>]))</span>
<span id="cb144-2727"><a href="#cb144-2727" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb144-2728"><a href="#cb144-2728" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb144-2729"><a href="#cb144-2729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2730"><a href="#cb144-2730" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-2731"><a href="#cb144-2731" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb144-2732"><a href="#cb144-2732" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>])):</span>
<span id="cb144-2733"><a href="#cb144-2733" aria-hidden="true" tabindex="-1"></a>        column: List[<span class="bu">str</span>] <span class="op">=</span> [motif[i] <span class="cf">for</span> motif <span class="kw">in</span> motifs]</span>
<span id="cb144-2734"><a href="#cb144-2734" aria-hidden="true" tabindex="-1"></a>        most_common: <span class="bu">str</span> <span class="op">=</span> Counter(column).most_common()[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb144-2735"><a href="#cb144-2735" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">sum</span>(nucleotide <span class="op">!=</span> most_common <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb144-2736"><a href="#cb144-2736" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb144-2737"><a href="#cb144-2737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2738"><a href="#cb144-2738" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-2739"><a href="#cb144-2739" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [seq[:kmer_length] <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb144-2740"><a href="#cb144-2740" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb144-2741"><a href="#cb144-2741" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb144-2742"><a href="#cb144-2742" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(dna_sequences)):</span>
<span id="cb144-2743"><a href="#cb144-2743" aria-hidden="true" tabindex="-1"></a>            current_profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount<span class="op">=</span>pseudocount)</span>
<span id="cb144-2744"><a href="#cb144-2744" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(dna_sequences[i], kmer_length, current_profile))</span>
<span id="cb144-2745"><a href="#cb144-2745" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb144-2746"><a href="#cb144-2746" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb144-2747"><a href="#cb144-2747" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb144-2748"><a href="#cb144-2748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2749"><a href="#cb144-2749" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-2750"><a href="#cb144-2750" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-2751"><a href="#cb144-2751" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb144-2752"><a href="#cb144-2752" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb144-2753"><a href="#cb144-2753" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb144-2754"><a href="#cb144-2754" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb144-2755"><a href="#cb144-2755" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb144-2756"><a href="#cb144-2756" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb144-2757"><a href="#cb144-2757" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-2758"><a href="#cb144-2758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2759"><a href="#cb144-2759" aria-hidden="true" tabindex="-1"></a>ints, <span class="op">*</span>dna <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-2760"><a href="#cb144-2760" aria-hidden="true" tabindex="-1"></a>k, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, ints.split())</span>
<span id="cb144-2761"><a href="#cb144-2761" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna, k)</span>
<span id="cb144-2762"><a href="#cb144-2762" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-2763"><a href="#cb144-2763" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2764"><a href="#cb144-2764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2765"><a href="#cb144-2765" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GreedyMotifSearch with Pseudocounts</span></span>
<span id="cb144-2766"><a href="#cb144-2766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2767"><a href="#cb144-2767" aria-hidden="true" tabindex="-1"></a>Implement.&nbsp;_GreedyMotifSearch_&nbsp;with Pseudocounts.</span>
<span id="cb144-2768"><a href="#cb144-2768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2769"><a href="#cb144-2769" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;_k_&nbsp;and&nbsp;_t_, followed by a collection of strings&nbsp;_Dna_.</span>
<span id="cb144-2770"><a href="#cb144-2770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2771"><a href="#cb144-2771" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A collection of strings&nbsp;_BestMotifs_&nbsp;resulting <span class="im">from</span> running&nbsp;_GreedyMotifSearch_(_Dna_,&nbsp;_k_,&nbsp;_t_) <span class="cf">with</span> pseudocounts. If at <span class="bu">any</span> step you find more than one&nbsp;_Profile_<span class="op">-</span>most probable&nbsp;_k_<span class="op">-</span>mer <span class="kw">in</span> a given string, use the one occurring first.</span>
<span id="cb144-2772"><a href="#cb144-2772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2773"><a href="#cb144-2773" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2774"><a href="#cb144-2774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2775"><a href="#cb144-2775" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2776"><a href="#cb144-2776" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">5</span></span>
<span id="cb144-2777"><a href="#cb144-2777" aria-hidden="true" tabindex="-1"></a>GGCGTTCAGGCA</span>
<span id="cb144-2778"><a href="#cb144-2778" aria-hidden="true" tabindex="-1"></a>AAGAATCAGTCA</span>
<span id="cb144-2779"><a href="#cb144-2779" aria-hidden="true" tabindex="-1"></a>CAAGGAGTTCGC</span>
<span id="cb144-2780"><a href="#cb144-2780" aria-hidden="true" tabindex="-1"></a>CACGTCAATCAC</span>
<span id="cb144-2781"><a href="#cb144-2781" aria-hidden="true" tabindex="-1"></a>CAATAATATTCG</span>
<span id="cb144-2782"><a href="#cb144-2782" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2783"><a href="#cb144-2783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2784"><a href="#cb144-2784" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2785"><a href="#cb144-2785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2786"><a href="#cb144-2786" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2787"><a href="#cb144-2787" aria-hidden="true" tabindex="-1"></a>TTC</span>
<span id="cb144-2788"><a href="#cb144-2788" aria-hidden="true" tabindex="-1"></a>ATC</span>
<span id="cb144-2789"><a href="#cb144-2789" aria-hidden="true" tabindex="-1"></a>TTC</span>
<span id="cb144-2790"><a href="#cb144-2790" aria-hidden="true" tabindex="-1"></a>ATC</span>
<span id="cb144-2791"><a href="#cb144-2791" aria-hidden="true" tabindex="-1"></a>TTC</span>
<span id="cb144-2792"><a href="#cb144-2792" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2793"><a href="#cb144-2793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2794"><a href="#cb144-2794" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-2795"><a href="#cb144-2795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2796"><a href="#cb144-2796" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-2797"><a href="#cb144-2797" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb144-2798"><a href="#cb144-2798" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb144-2799"><a href="#cb144-2799" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb144-2800"><a href="#cb144-2800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2801"><a href="#cb144-2801" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-2802"><a href="#cb144-2802" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-2803"><a href="#cb144-2803" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb144-2804"><a href="#cb144-2804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2805"><a href="#cb144-2805" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-2806"><a href="#cb144-2806" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb144-2807"><a href="#cb144-2807" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb144-2808"><a href="#cb144-2808" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb144-2809"><a href="#cb144-2809" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][position] </span>
<span id="cb144-2810"><a href="#cb144-2810" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">for</span> position, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb144-2811"><a href="#cb144-2811" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb144-2812"><a href="#cb144-2812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2813"><a href="#cb144-2813" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb144-2814"><a href="#cb144-2814" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb144-2815"><a href="#cb144-2815" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb144-2816"><a href="#cb144-2816" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb144-2817"><a href="#cb144-2817" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2818"><a href="#cb144-2818" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb144-2819"><a href="#cb144-2819" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> motif_count </span>
<span id="cb144-2820"><a href="#cb144-2820" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb144-2821"><a href="#cb144-2821" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb144-2822"><a href="#cb144-2822" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb144-2823"><a href="#cb144-2823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2824"><a href="#cb144-2824" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-2825"><a href="#cb144-2825" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb144-2826"><a href="#cb144-2826" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb144-2827"><a href="#cb144-2827" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb144-2828"><a href="#cb144-2828" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb144-2829"><a href="#cb144-2829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2830"><a href="#cb144-2830" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-2831"><a href="#cb144-2831" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [sequence[:kmer_length] <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences]</span>
<span id="cb144-2832"><a href="#cb144-2832" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2833"><a href="#cb144-2833" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb144-2834"><a href="#cb144-2834" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb144-2835"><a href="#cb144-2835" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences[<span class="dv">1</span>:]:</span>
<span id="cb144-2836"><a href="#cb144-2836" aria-hidden="true" tabindex="-1"></a>            profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount)</span>
<span id="cb144-2837"><a href="#cb144-2837" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(sequence, kmer_length, profile))</span>
<span id="cb144-2838"><a href="#cb144-2838" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb144-2839"><a href="#cb144-2839" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb144-2840"><a href="#cb144-2840" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb144-2841"><a href="#cb144-2841" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2842"><a href="#cb144-2842" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb144-2843"><a href="#cb144-2843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2844"><a href="#cb144-2844" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-2845"><a href="#cb144-2845" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-2846"><a href="#cb144-2846" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb144-2847"><a href="#cb144-2847" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb144-2848"><a href="#cb144-2848" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb144-2849"><a href="#cb144-2849" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb144-2850"><a href="#cb144-2850" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb144-2851"><a href="#cb144-2851" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb144-2852"><a href="#cb144-2852" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-2853"><a href="#cb144-2853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2854"><a href="#cb144-2854" aria-hidden="true" tabindex="-1"></a>k_value, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb144-2855"><a href="#cb144-2855" aria-hidden="true" tabindex="-1"></a>k_value <span class="op">=</span> <span class="bu">int</span>(k_value)</span>
<span id="cb144-2856"><a href="#cb144-2856" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna_sequences, k_value, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb144-2857"><a href="#cb144-2857" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-2858"><a href="#cb144-2858" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2859"><a href="#cb144-2859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2860"><a href="#cb144-2860" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement RandomizedMotifSearch</span></span>
<span id="cb144-2861"><a href="#cb144-2861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2862"><a href="#cb144-2862" aria-hidden="true" tabindex="-1"></a>Implement&nbsp;_RandomizedMotifSearch_.</span>
<span id="cb144-2863"><a href="#cb144-2863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2864"><a href="#cb144-2864" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Positive integers&nbsp;_k_&nbsp;and&nbsp;_t_, followed by a collection of strings&nbsp;_Dna_.</span>
<span id="cb144-2865"><a href="#cb144-2865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2866"><a href="#cb144-2866" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A collection&nbsp;_BestMotifs_&nbsp;resulting <span class="im">from</span> running&nbsp;_RandomizedMotifSearch_(_Dna_,&nbsp;_k_,&nbsp;_t_) <span class="dv">1000</span> times. Remember to use pseudocounts<span class="op">!</span></span>
<span id="cb144-2867"><a href="#cb144-2867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2868"><a href="#cb144-2868" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2869"><a href="#cb144-2869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2870"><a href="#cb144-2870" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2871"><a href="#cb144-2871" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="dv">5</span></span>
<span id="cb144-2872"><a href="#cb144-2872" aria-hidden="true" tabindex="-1"></a>CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span>
<span id="cb144-2873"><a href="#cb144-2873" aria-hidden="true" tabindex="-1"></a>GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span>
<span id="cb144-2874"><a href="#cb144-2874" aria-hidden="true" tabindex="-1"></a>TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span>
<span id="cb144-2875"><a href="#cb144-2875" aria-hidden="true" tabindex="-1"></a>TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span>
<span id="cb144-2876"><a href="#cb144-2876" aria-hidden="true" tabindex="-1"></a>AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span>
<span id="cb144-2877"><a href="#cb144-2877" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2878"><a href="#cb144-2878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2879"><a href="#cb144-2879" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2880"><a href="#cb144-2880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2881"><a href="#cb144-2881" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2882"><a href="#cb144-2882" aria-hidden="true" tabindex="-1"></a>AACGGCCA</span>
<span id="cb144-2883"><a href="#cb144-2883" aria-hidden="true" tabindex="-1"></a>AAGTGCCA</span>
<span id="cb144-2884"><a href="#cb144-2884" aria-hidden="true" tabindex="-1"></a>TAGTACCG</span>
<span id="cb144-2885"><a href="#cb144-2885" aria-hidden="true" tabindex="-1"></a>AAGTTTCA</span>
<span id="cb144-2886"><a href="#cb144-2886" aria-hidden="true" tabindex="-1"></a>ACGTGCAA</span>
<span id="cb144-2887"><a href="#cb144-2887" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2888"><a href="#cb144-2888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2889"><a href="#cb144-2889" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-2890"><a href="#cb144-2890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2891"><a href="#cb144-2891" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-2892"><a href="#cb144-2892" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Callable</span>
<span id="cb144-2893"><a href="#cb144-2893" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb144-2894"><a href="#cb144-2894" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> randint</span>
<span id="cb144-2895"><a href="#cb144-2895" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb144-2896"><a href="#cb144-2896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2897"><a href="#cb144-2897" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-2898"><a href="#cb144-2898" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [sequence[i:i<span class="op">+</span>kmer_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb144-2899"><a href="#cb144-2899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2900"><a href="#cb144-2900" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-2901"><a href="#cb144-2901" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb144-2902"><a href="#cb144-2902" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb144-2903"><a href="#cb144-2903" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb144-2904"><a href="#cb144-2904" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][j] <span class="cf">for</span> j, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb144-2905"><a href="#cb144-2905" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb144-2906"><a href="#cb144-2906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2907"><a href="#cb144-2907" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb144-2908"><a href="#cb144-2908" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb144-2909"><a href="#cb144-2909" aria-hidden="true" tabindex="-1"></a>    profile <span class="op">=</span> []</span>
<span id="cb144-2910"><a href="#cb144-2910" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb144-2911"><a href="#cb144-2911" aria-hidden="true" tabindex="-1"></a>        profile.append([</span>
<span id="cb144-2912"><a href="#cb144-2912" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (<span class="bu">len</span>(motifs) <span class="op">+</span> <span class="dv">4</span> <span class="op">*</span> pseudocount)</span>
<span id="cb144-2913"><a href="#cb144-2913" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>]))</span>
<span id="cb144-2914"><a href="#cb144-2914" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb144-2915"><a href="#cb144-2915" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb144-2916"><a href="#cb144-2916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2917"><a href="#cb144-2917" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-2918"><a href="#cb144-2918" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb144-2919"><a href="#cb144-2919" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb144-2920"><a href="#cb144-2920" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb144-2921"><a href="#cb144-2921" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb144-2922"><a href="#cb144-2922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2923"><a href="#cb144-2923" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-2924"><a href="#cb144-2924" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb144-2925"><a href="#cb144-2925" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start : start <span class="op">+</span> kmer_length]</span>
<span id="cb144-2926"><a href="#cb144-2926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2927"><a href="#cb144-2927" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_motifs(profile: List[List[<span class="bu">float</span>]], dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-2928"><a href="#cb144-2928" aria-hidden="true" tabindex="-1"></a>    kmer_length <span class="op">=</span> <span class="bu">len</span>(profile[<span class="dv">0</span>])</span>
<span id="cb144-2929"><a href="#cb144-2929" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [find_most_probable_kmer(seq, kmer_length, profile) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb144-2930"><a href="#cb144-2930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2931"><a href="#cb144-2931" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> randomized_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-2932"><a href="#cb144-2932" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb144-2933"><a href="#cb144-2933" aria-hidden="true" tabindex="-1"></a>    best_score <span class="op">=</span> math.inf</span>
<span id="cb144-2934"><a href="#cb144-2934" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2935"><a href="#cb144-2935" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb144-2936"><a href="#cb144-2936" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb144-2937"><a href="#cb144-2937" aria-hidden="true" tabindex="-1"></a>        motifs <span class="op">=</span> find_motifs(profile, dna_sequences)</span>
<span id="cb144-2938"><a href="#cb144-2938" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> calculate_score(motifs)</span>
<span id="cb144-2939"><a href="#cb144-2939" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb144-2940"><a href="#cb144-2940" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;=</span> best_score:</span>
<span id="cb144-2941"><a href="#cb144-2941" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> best_score, motifs</span>
<span id="cb144-2942"><a href="#cb144-2942" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb144-2943"><a href="#cb144-2943" aria-hidden="true" tabindex="-1"></a>        best_score <span class="op">=</span> current_score</span>
<span id="cb144-2944"><a href="#cb144-2944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2945"><a href="#cb144-2945" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-2946"><a href="#cb144-2946" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb144-2947"><a href="#cb144-2947" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2948"><a href="#cb144-2948" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb144-2949"><a href="#cb144-2949" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb144-2950"><a href="#cb144-2950" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb144-2951"><a href="#cb144-2951" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb144-2952"><a href="#cb144-2952" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-2953"><a href="#cb144-2953" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb144-2954"><a href="#cb144-2954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2955"><a href="#cb144-2955" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-2956"><a href="#cb144-2956" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-2957"><a href="#cb144-2957" aria-hidden="true" tabindex="-1"></a><span class="st">8 5</span></span>
<span id="cb144-2958"><a href="#cb144-2958" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span></span>
<span id="cb144-2959"><a href="#cb144-2959" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span></span>
<span id="cb144-2960"><a href="#cb144-2960" aria-hidden="true" tabindex="-1"></a><span class="st">TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span></span>
<span id="cb144-2961"><a href="#cb144-2961" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span></span>
<span id="cb144-2962"><a href="#cb144-2962" aria-hidden="true" tabindex="-1"></a><span class="st">AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span></span>
<span id="cb144-2963"><a href="#cb144-2963" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-2964"><a href="#cb144-2964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2965"><a href="#cb144-2965" aria-hidden="true" tabindex="-1"></a>kmer_length, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb144-2966"><a href="#cb144-2966" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb144-2967"><a href="#cb144-2967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2968"><a href="#cb144-2968" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(randomized_motif_search, <span class="dv">1000</span>, dna_sequences, kmer_length)</span>
<span id="cb144-2969"><a href="#cb144-2969" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-2970"><a href="#cb144-2970" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2971"><a href="#cb144-2971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2972"><a href="#cb144-2972" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GibbsSampler</span></span>
<span id="cb144-2973"><a href="#cb144-2973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2974"><a href="#cb144-2974" aria-hidden="true" tabindex="-1"></a>Implement,&nbsp;_GibbsSampler_.</span>
<span id="cb144-2975"><a href="#cb144-2975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2976"><a href="#cb144-2976" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;_k_,&nbsp;_t_, and&nbsp;_N_, followed by a collection of strings&nbsp;_Dna_.</span>
<span id="cb144-2977"><a href="#cb144-2977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2978"><a href="#cb144-2978" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The strings&nbsp;_BestMotifs_&nbsp;resulting <span class="im">from</span> running&nbsp;_GibbsSampler_(_Dna_,&nbsp;_k_,&nbsp;_t_,&nbsp;_N_) <span class="cf">with</span> <span class="dv">20</span> random starts. Remember to use pseudocounts<span class="op">!</span></span>
<span id="cb144-2979"><a href="#cb144-2979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2980"><a href="#cb144-2980" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-2981"><a href="#cb144-2981" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2982"><a href="#cb144-2982" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2983"><a href="#cb144-2983" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="dv">5</span> <span class="dv">100</span></span>
<span id="cb144-2984"><a href="#cb144-2984" aria-hidden="true" tabindex="-1"></a>CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span>
<span id="cb144-2985"><a href="#cb144-2985" aria-hidden="true" tabindex="-1"></a>GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span>
<span id="cb144-2986"><a href="#cb144-2986" aria-hidden="true" tabindex="-1"></a>TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span>
<span id="cb144-2987"><a href="#cb144-2987" aria-hidden="true" tabindex="-1"></a>TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span>
<span id="cb144-2988"><a href="#cb144-2988" aria-hidden="true" tabindex="-1"></a>AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span>
<span id="cb144-2989"><a href="#cb144-2989" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2990"><a href="#cb144-2990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2991"><a href="#cb144-2991" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-2992"><a href="#cb144-2992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-2993"><a href="#cb144-2993" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-2994"><a href="#cb144-2994" aria-hidden="true" tabindex="-1"></a>TCTCGGGG</span>
<span id="cb144-2995"><a href="#cb144-2995" aria-hidden="true" tabindex="-1"></a>CCAAGGTG</span>
<span id="cb144-2996"><a href="#cb144-2996" aria-hidden="true" tabindex="-1"></a>TACAGGCG</span>
<span id="cb144-2997"><a href="#cb144-2997" aria-hidden="true" tabindex="-1"></a>TTCAGGTG</span>
<span id="cb144-2998"><a href="#cb144-2998" aria-hidden="true" tabindex="-1"></a>TCCACGTG</span>
<span id="cb144-2999"><a href="#cb144-2999" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3000"><a href="#cb144-3000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3001"><a href="#cb144-3001" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3002"><a href="#cb144-3002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3003"><a href="#cb144-3003" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3004"><a href="#cb144-3004" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, Tuple, Callable</span>
<span id="cb144-3005"><a href="#cb144-3005" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb144-3006"><a href="#cb144-3006" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb144-3007"><a href="#cb144-3007" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb144-3008"><a href="#cb144-3008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3009"><a href="#cb144-3009" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-3010"><a href="#cb144-3010" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-3011"><a href="#cb144-3011" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb144-3012"><a href="#cb144-3012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3013"><a href="#cb144-3013" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb144-3014"><a href="#cb144-3014" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb144-3015"><a href="#cb144-3015" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb144-3016"><a href="#cb144-3016" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb144-3017"><a href="#cb144-3017" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-3018"><a href="#cb144-3018" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb144-3019"><a href="#cb144-3019" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (motif_count <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>pseudocount)</span>
<span id="cb144-3020"><a href="#cb144-3020" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb144-3021"><a href="#cb144-3021" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb144-3022"><a href="#cb144-3022" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb144-3023"><a href="#cb144-3023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3024"><a href="#cb144-3024" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-3025"><a href="#cb144-3025" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb144-3026"><a href="#cb144-3026" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb144-3027"><a href="#cb144-3027" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb144-3028"><a href="#cb144-3028" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb144-3029"><a href="#cb144-3029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3030"><a href="#cb144-3030" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-3031"><a href="#cb144-3031" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb144-3032"><a href="#cb144-3032" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb144-3033"><a href="#cb144-3033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3034"><a href="#cb144-3034" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-3035"><a href="#cb144-3035" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb144-3036"><a href="#cb144-3036" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb144-3037"><a href="#cb144-3037" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb144-3038"><a href="#cb144-3038" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb144-3039"><a href="#cb144-3039" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb144-3040"><a href="#cb144-3040" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb144-3041"><a href="#cb144-3041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3042"><a href="#cb144-3042" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_probabilities(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb144-3043"><a href="#cb144-3043" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb144-3044"><a href="#cb144-3044" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb144-3045"><a href="#cb144-3045" aria-hidden="true" tabindex="-1"></a>        math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb144-3046"><a href="#cb144-3046" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length)</span>
<span id="cb144-3047"><a href="#cb144-3047" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb144-3048"><a href="#cb144-3048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3049"><a href="#cb144-3049" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-3050"><a href="#cb144-3050" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> calculate_kmer_probabilities(sequence, kmer_length, profile)</span>
<span id="cb144-3051"><a href="#cb144-3051" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.choices(<span class="bu">range</span>(<span class="bu">len</span>(probabilities)), probabilities)[<span class="dv">0</span>]</span>
<span id="cb144-3052"><a href="#cb144-3052" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb144-3053"><a href="#cb144-3053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3054"><a href="#cb144-3054" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gibbs_sampler(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, num_iterations: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3055"><a href="#cb144-3055" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb144-3056"><a href="#cb144-3056" aria-hidden="true" tabindex="-1"></a>    best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb144-3057"><a href="#cb144-3057" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_iterations):</span>
<span id="cb144-3058"><a href="#cb144-3058" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(dna_sequences) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb144-3059"><a href="#cb144-3059" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs[:i] <span class="op">+</span> motifs[i <span class="op">+</span> <span class="dv">1</span> :], pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb144-3060"><a href="#cb144-3060" aria-hidden="true" tabindex="-1"></a>        motifs[i] <span class="op">=</span> select_random_kmer(dna_sequences[i], kmer_length, profile)</span>
<span id="cb144-3061"><a href="#cb144-3061" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb144-3062"><a href="#cb144-3062" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb144-3063"><a href="#cb144-3063" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> calculate_score(best_motifs), best_motifs</span>
<span id="cb144-3064"><a href="#cb144-3064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3065"><a href="#cb144-3065" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-3066"><a href="#cb144-3066" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3067"><a href="#cb144-3067" aria-hidden="true" tabindex="-1"></a><span class="st">8 5 100</span></span>
<span id="cb144-3068"><a href="#cb144-3068" aria-hidden="true" tabindex="-1"></a><span class="st">TCTCGGGG</span></span>
<span id="cb144-3069"><a href="#cb144-3069" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGGTG</span></span>
<span id="cb144-3070"><a href="#cb144-3070" aria-hidden="true" tabindex="-1"></a><span class="st">TACAGGCG</span></span>
<span id="cb144-3071"><a href="#cb144-3071" aria-hidden="true" tabindex="-1"></a><span class="st">TTCAGGTG</span></span>
<span id="cb144-3072"><a href="#cb144-3072" aria-hidden="true" tabindex="-1"></a><span class="st">TCCACGTG</span></span>
<span id="cb144-3073"><a href="#cb144-3073" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3074"><a href="#cb144-3074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3075"><a href="#cb144-3075" aria-hidden="true" tabindex="-1"></a>kmer_length, num_sequences, num_iterations, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb144-3076"><a href="#cb144-3076" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb144-3077"><a href="#cb144-3077" aria-hidden="true" tabindex="-1"></a>num_iterations <span class="op">=</span> <span class="bu">int</span>(num_iterations)</span>
<span id="cb144-3078"><a href="#cb144-3078" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(gibbs_sampler, <span class="dv">20</span>, dna_sequences, kmer_length, num_iterations)</span>
<span id="cb144-3079"><a href="#cb144-3079" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3080"><a href="#cb144-3080" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3081"><a href="#cb144-3081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3082"><a href="#cb144-3082" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement DistanceBetweenPatternAndStrings</span></span>
<span id="cb144-3083"><a href="#cb144-3083" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3084"><a href="#cb144-3084" aria-hidden="true" tabindex="-1"></a>Compute DistanceBetweenPatternAndStrings. _Find the distance between a pattern <span class="kw">and</span> a <span class="bu">set</span> of strings._.</span>
<span id="cb144-3085"><a href="#cb144-3085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3086"><a href="#cb144-3086" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;_Pattern_&nbsp;and a collection of DNA strings&nbsp;_Dna_.</span>
<span id="cb144-3087"><a href="#cb144-3087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3088"><a href="#cb144-3088" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;_DistanceBetweenPatternAndStrings_(_Pattern_,&nbsp;_Dna_).</span>
<span id="cb144-3089"><a href="#cb144-3089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3090"><a href="#cb144-3090" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3091"><a href="#cb144-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3092"><a href="#cb144-3092" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3093"><a href="#cb144-3093" aria-hidden="true" tabindex="-1"></a>AAA</span>
<span id="cb144-3094"><a href="#cb144-3094" aria-hidden="true" tabindex="-1"></a>TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span>
<span id="cb144-3095"><a href="#cb144-3095" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3096"><a href="#cb144-3096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3097"><a href="#cb144-3097" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3098"><a href="#cb144-3098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3099"><a href="#cb144-3099" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3100"><a href="#cb144-3100" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb144-3101"><a href="#cb144-3101" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3102"><a href="#cb144-3102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3103"><a href="#cb144-3103" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3104"><a href="#cb144-3104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3105"><a href="#cb144-3105" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3106"><a href="#cb144-3106" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator</span>
<span id="cb144-3107"><a href="#cb144-3107" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb144-3108"><a href="#cb144-3108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3109"><a href="#cb144-3109" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-3110"><a href="#cb144-3110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-3111"><a href="#cb144-3111" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb144-3112"><a href="#cb144-3112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3113"><a href="#cb144-3113" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-3114"><a href="#cb144-3114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb144-3115"><a href="#cb144-3115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3116"><a href="#cb144-3116" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-3117"><a href="#cb144-3117" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(kmer, pattern) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb144-3118"><a href="#cb144-3118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3119"><a href="#cb144-3119" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_pattern_distance_to_strings(pattern: <span class="bu">str</span>, dna_strings: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb144-3120"><a href="#cb144-3120" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, dna_string) <span class="cf">for</span> dna_string <span class="kw">in</span> dna_strings)</span>
<span id="cb144-3121"><a href="#cb144-3121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3122"><a href="#cb144-3122" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb144-3123"><a href="#cb144-3123" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3124"><a href="#cb144-3124" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb144-3125"><a href="#cb144-3125" aria-hidden="true" tabindex="-1"></a><span class="st">TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span></span>
<span id="cb144-3126"><a href="#cb144-3126" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3127"><a href="#cb144-3127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3128"><a href="#cb144-3128" aria-hidden="true" tabindex="-1"></a>pattern, dna_strings_raw <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3129"><a href="#cb144-3129" aria-hidden="true" tabindex="-1"></a>dna_strings <span class="op">=</span> dna_strings_raw.split()</span>
<span id="cb144-3130"><a href="#cb144-3130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3131"><a href="#cb144-3131" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_pattern_distance_to_strings(pattern, dna_strings)</span>
<span id="cb144-3132"><a href="#cb144-3132" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb144-3133"><a href="#cb144-3133" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3134"><a href="#cb144-3134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3135"><a href="#cb144-3135" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the k-mer Composition of a String</span></span>
<span id="cb144-3136"><a href="#cb144-3136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3137"><a href="#cb144-3137" aria-hidden="true" tabindex="-1"></a>String Composition Problem, Generate the k<span class="op">-</span>mer composition of a string.</span>
<span id="cb144-3138"><a href="#cb144-3138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3139"><a href="#cb144-3139" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;_k_&nbsp;and a string&nbsp;_Text_.</span>
<span id="cb144-3140"><a href="#cb144-3140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3141"><a href="#cb144-3141" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;_Composition__k_(_Text_) (the&nbsp;_k_<span class="op">-</span>mers can be provided <span class="kw">in</span> <span class="bu">any</span> order).</span>
<span id="cb144-3142"><a href="#cb144-3142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3143"><a href="#cb144-3143" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3144"><a href="#cb144-3144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3145"><a href="#cb144-3145" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3146"><a href="#cb144-3146" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb144-3147"><a href="#cb144-3147" aria-hidden="true" tabindex="-1"></a>CAATCCAAC</span>
<span id="cb144-3148"><a href="#cb144-3148" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3149"><a href="#cb144-3149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3150"><a href="#cb144-3150" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3151"><a href="#cb144-3151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3152"><a href="#cb144-3152" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3153"><a href="#cb144-3153" aria-hidden="true" tabindex="-1"></a>CAATC</span>
<span id="cb144-3154"><a href="#cb144-3154" aria-hidden="true" tabindex="-1"></a>AATCC</span>
<span id="cb144-3155"><a href="#cb144-3155" aria-hidden="true" tabindex="-1"></a>ATCCA</span>
<span id="cb144-3156"><a href="#cb144-3156" aria-hidden="true" tabindex="-1"></a>TCCAA</span>
<span id="cb144-3157"><a href="#cb144-3157" aria-hidden="true" tabindex="-1"></a>CCAAC</span>
<span id="cb144-3158"><a href="#cb144-3158" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3159"><a href="#cb144-3159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3160"><a href="#cb144-3160" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3161"><a href="#cb144-3161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3162"><a href="#cb144-3162" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3163"><a href="#cb144-3163" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator</span>
<span id="cb144-3164"><a href="#cb144-3164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3165"><a href="#cb144-3165" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb144-3166"><a href="#cb144-3166" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-3167"><a href="#cb144-3167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i:i <span class="op">+</span> kmer_length]</span>
<span id="cb144-3168"><a href="#cb144-3168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3169"><a href="#cb144-3169" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3170"><a href="#cb144-3170" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb144-3171"><a href="#cb144-3171" aria-hidden="true" tabindex="-1"></a><span class="st">CAATCCAAC</span></span>
<span id="cb144-3172"><a href="#cb144-3172" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3173"><a href="#cb144-3173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3174"><a href="#cb144-3174" aria-hidden="true" tabindex="-1"></a>input_lines: <span class="bu">list</span>[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3175"><a href="#cb144-3175" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb144-3176"><a href="#cb144-3176" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb144-3177"><a href="#cb144-3177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3178"><a href="#cb144-3178" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequence, kmer_length):</span>
<span id="cb144-3179"><a href="#cb144-3179" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kmer)</span>
<span id="cb144-3180"><a href="#cb144-3180" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3181"><a href="#cb144-3181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3182"><a href="#cb144-3182" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its Genome Path</span></span>
<span id="cb144-3183"><a href="#cb144-3183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3184"><a href="#cb144-3184" aria-hidden="true" tabindex="-1"></a>String Spelled by a Genome Path Problem, Find the string spelled by a genome path.</span>
<span id="cb144-3185"><a href="#cb144-3185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3186"><a href="#cb144-3186" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of&nbsp;_k_<span class="op">-</span>mers&nbsp;_Pattern1, ... , Patternn_&nbsp;such that the last&nbsp;_k <span class="op">-</span> <span class="dv">1</span><span class="er">_</span>&nbsp;symbols of&nbsp;_Patterni_&nbsp;are equal to the first&nbsp;_k <span class="op">-</span> <span class="dv">1</span><span class="er">_</span>&nbsp;symbols of&nbsp;_Patterni<span class="op">+</span><span class="dv">1</span><span class="er">_</span>&nbsp;for&nbsp;_i_&nbsp;from <span class="dv">1</span> to n<span class="op">-</span><span class="fl">1.</span></span>
<span id="cb144-3187"><a href="#cb144-3187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3188"><a href="#cb144-3188" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;_Text_&nbsp;of length&nbsp;_k<span class="op">+</span>n<span class="op">-</span><span class="dv">1</span><span class="er">_</span>&nbsp;where the&nbsp;_i_<span class="op">-</span>th&nbsp;_k_<span class="op">-</span>mer in&nbsp;_Text_&nbsp;is equal to&nbsp;_Patterni_&nbsp;for all&nbsp;_i_.</span>
<span id="cb144-3189"><a href="#cb144-3189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3190"><a href="#cb144-3190" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3191"><a href="#cb144-3191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3192"><a href="#cb144-3192" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3193"><a href="#cb144-3193" aria-hidden="true" tabindex="-1"></a>ACCGA</span>
<span id="cb144-3194"><a href="#cb144-3194" aria-hidden="true" tabindex="-1"></a>CCGAA</span>
<span id="cb144-3195"><a href="#cb144-3195" aria-hidden="true" tabindex="-1"></a>CGAAG</span>
<span id="cb144-3196"><a href="#cb144-3196" aria-hidden="true" tabindex="-1"></a>GAAGC</span>
<span id="cb144-3197"><a href="#cb144-3197" aria-hidden="true" tabindex="-1"></a>AAGCT</span>
<span id="cb144-3198"><a href="#cb144-3198" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3199"><a href="#cb144-3199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3200"><a href="#cb144-3200" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3201"><a href="#cb144-3201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3202"><a href="#cb144-3202" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3203"><a href="#cb144-3203" aria-hidden="true" tabindex="-1"></a>ACCGAAGCT</span>
<span id="cb144-3204"><a href="#cb144-3204" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3205"><a href="#cb144-3205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3206"><a href="#cb144-3206" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3207"><a href="#cb144-3207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3208"><a href="#cb144-3208" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3209"><a href="#cb144-3209" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb144-3210"><a href="#cb144-3210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3211"><a href="#cb144-3211" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_dna_sequence(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-3212"><a href="#cb144-3212" aria-hidden="true" tabindex="-1"></a>    reconstructed_sequence: <span class="bu">str</span> <span class="op">=</span> kmers[<span class="dv">0</span>]</span>
<span id="cb144-3213"><a href="#cb144-3213" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(kmers)):</span>
<span id="cb144-3214"><a href="#cb144-3214" aria-hidden="true" tabindex="-1"></a>        reconstructed_sequence <span class="op">+=</span> kmers[i][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb144-3215"><a href="#cb144-3215" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_sequence</span>
<span id="cb144-3216"><a href="#cb144-3216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3217"><a href="#cb144-3217" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3218"><a href="#cb144-3218" aria-hidden="true" tabindex="-1"></a><span class="st">ACCGA</span></span>
<span id="cb144-3219"><a href="#cb144-3219" aria-hidden="true" tabindex="-1"></a><span class="st">CCGAA</span></span>
<span id="cb144-3220"><a href="#cb144-3220" aria-hidden="true" tabindex="-1"></a><span class="st">CGAAG</span></span>
<span id="cb144-3221"><a href="#cb144-3221" aria-hidden="true" tabindex="-1"></a><span class="st">GAAGC</span></span>
<span id="cb144-3222"><a href="#cb144-3222" aria-hidden="true" tabindex="-1"></a><span class="st">AAGCT</span></span>
<span id="cb144-3223"><a href="#cb144-3223" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3224"><a href="#cb144-3224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3225"><a href="#cb144-3225" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3226"><a href="#cb144-3226" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_dna_sequence(kmer_list))</span>
<span id="cb144-3227"><a href="#cb144-3227" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3228"><a href="#cb144-3228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3229"><a href="#cb144-3229" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Overlap Graph of a Collection of k-mers</span></span>
<span id="cb144-3230"><a href="#cb144-3230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3231"><a href="#cb144-3231" aria-hidden="true" tabindex="-1"></a>Overlap Graph Problem, Construct the overlap graph of a collection of k<span class="op">-</span>mers.</span>
<span id="cb144-3232"><a href="#cb144-3232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3233"><a href="#cb144-3233" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection&nbsp;_Patterns_&nbsp;of&nbsp;_k_<span class="op">-</span>mers.</span>
<span id="cb144-3234"><a href="#cb144-3234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3235"><a href="#cb144-3235" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The overlap graph&nbsp;_Overlap_(_Patterns_), <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb144-3236"><a href="#cb144-3236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3237"><a href="#cb144-3237" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3238"><a href="#cb144-3238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3239"><a href="#cb144-3239" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3240"><a href="#cb144-3240" aria-hidden="true" tabindex="-1"></a>ATGCG</span>
<span id="cb144-3241"><a href="#cb144-3241" aria-hidden="true" tabindex="-1"></a>GCATG</span>
<span id="cb144-3242"><a href="#cb144-3242" aria-hidden="true" tabindex="-1"></a>CATGC</span>
<span id="cb144-3243"><a href="#cb144-3243" aria-hidden="true" tabindex="-1"></a>AGGCA</span>
<span id="cb144-3244"><a href="#cb144-3244" aria-hidden="true" tabindex="-1"></a>GGCAT</span>
<span id="cb144-3245"><a href="#cb144-3245" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3246"><a href="#cb144-3246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3247"><a href="#cb144-3247" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3248"><a href="#cb144-3248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3249"><a href="#cb144-3249" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3250"><a href="#cb144-3250" aria-hidden="true" tabindex="-1"></a>GCATG <span class="op">-&gt;</span> CATGC</span>
<span id="cb144-3251"><a href="#cb144-3251" aria-hidden="true" tabindex="-1"></a>CATGC <span class="op">-&gt;</span> ATGCG</span>
<span id="cb144-3252"><a href="#cb144-3252" aria-hidden="true" tabindex="-1"></a>AGGCA <span class="op">-&gt;</span> GGCAT</span>
<span id="cb144-3253"><a href="#cb144-3253" aria-hidden="true" tabindex="-1"></a>GGCAT <span class="op">-&gt;</span> GCATG</span>
<span id="cb144-3254"><a href="#cb144-3254" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3255"><a href="#cb144-3255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3256"><a href="#cb144-3256" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3257"><a href="#cb144-3257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3258"><a href="#cb144-3258" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3259"><a href="#cb144-3259" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb144-3260"><a href="#cb144-3260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3261"><a href="#cb144-3261" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> overlap_graph(patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>]]:</span>
<span id="cb144-3262"><a href="#cb144-3262" aria-hidden="true" tabindex="-1"></a>    adj_list <span class="op">=</span> []</span>
<span id="cb144-3263"><a href="#cb144-3263" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb144-3264"><a href="#cb144-3264" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb144-3265"><a href="#cb144-3265" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j <span class="kw">and</span> patterns[i][<span class="dv">1</span>:] <span class="op">==</span> patterns[j][:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb144-3266"><a href="#cb144-3266" aria-hidden="true" tabindex="-1"></a>                adj_list.append((patterns[i], patterns[j]))</span>
<span id="cb144-3267"><a href="#cb144-3267" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adj_list</span>
<span id="cb144-3268"><a href="#cb144-3268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3269"><a href="#cb144-3269" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3270"><a href="#cb144-3270" aria-hidden="true" tabindex="-1"></a><span class="st">ATGCG</span></span>
<span id="cb144-3271"><a href="#cb144-3271" aria-hidden="true" tabindex="-1"></a><span class="st">GCATG</span></span>
<span id="cb144-3272"><a href="#cb144-3272" aria-hidden="true" tabindex="-1"></a><span class="st">CATGC</span></span>
<span id="cb144-3273"><a href="#cb144-3273" aria-hidden="true" tabindex="-1"></a><span class="st">AGGCA</span></span>
<span id="cb144-3274"><a href="#cb144-3274" aria-hidden="true" tabindex="-1"></a><span class="st">GGCAT</span></span>
<span id="cb144-3275"><a href="#cb144-3275" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3276"><a href="#cb144-3276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3277"><a href="#cb144-3277" aria-hidden="true" tabindex="-1"></a>Patterns: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3278"><a href="#cb144-3278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3279"><a href="#cb144-3279" aria-hidden="true" tabindex="-1"></a>adj_list <span class="op">=</span> overlap_graph(Patterns)</span>
<span id="cb144-3280"><a href="#cb144-3280" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> adj_list:</span>
<span id="cb144-3281"><a href="#cb144-3281" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>edge[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>edge[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb144-3282"><a href="#cb144-3282" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3283"><a href="#cb144-3283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3284"><a href="#cb144-3284" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the De Bruijn Graph of a String</span></span>
<span id="cb144-3285"><a href="#cb144-3285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3286"><a href="#cb144-3286" aria-hidden="true" tabindex="-1"></a>De Bruijn Graph <span class="im">from</span> a String Problem. Construct the de Bruijn graph of a string.</span>
<span id="cb144-3287"><a href="#cb144-3287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3288"><a href="#cb144-3288" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;_k_&nbsp;and a string&nbsp;_Text_.</span>
<span id="cb144-3289"><a href="#cb144-3289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3290"><a href="#cb144-3290" aria-hidden="true" tabindex="-1"></a>Return:_DeBruijn__k_(_Text_), <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb144-3291"><a href="#cb144-3291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3292"><a href="#cb144-3292" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3293"><a href="#cb144-3293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3294"><a href="#cb144-3294" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3295"><a href="#cb144-3295" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb144-3296"><a href="#cb144-3296" aria-hidden="true" tabindex="-1"></a>AAGATTCTCTAC</span>
<span id="cb144-3297"><a href="#cb144-3297" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3298"><a href="#cb144-3298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3299"><a href="#cb144-3299" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3300"><a href="#cb144-3300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3301"><a href="#cb144-3301" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3302"><a href="#cb144-3302" aria-hidden="true" tabindex="-1"></a>AAG <span class="op">-&gt;</span> AGA</span>
<span id="cb144-3303"><a href="#cb144-3303" aria-hidden="true" tabindex="-1"></a>AGA <span class="op">-&gt;</span> GAT</span>
<span id="cb144-3304"><a href="#cb144-3304" aria-hidden="true" tabindex="-1"></a>ATT <span class="op">-&gt;</span> TTC</span>
<span id="cb144-3305"><a href="#cb144-3305" aria-hidden="true" tabindex="-1"></a>CTA <span class="op">-&gt;</span> TAC</span>
<span id="cb144-3306"><a href="#cb144-3306" aria-hidden="true" tabindex="-1"></a>CTC <span class="op">-&gt;</span> TCT</span>
<span id="cb144-3307"><a href="#cb144-3307" aria-hidden="true" tabindex="-1"></a>GAT <span class="op">-&gt;</span> ATT</span>
<span id="cb144-3308"><a href="#cb144-3308" aria-hidden="true" tabindex="-1"></a>TCT <span class="op">-&gt;</span> CTA,CTC</span>
<span id="cb144-3309"><a href="#cb144-3309" aria-hidden="true" tabindex="-1"></a>TTC <span class="op">-&gt;</span> TCT</span>
<span id="cb144-3310"><a href="#cb144-3310" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3311"><a href="#cb144-3311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3312"><a href="#cb144-3312" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3313"><a href="#cb144-3313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3314"><a href="#cb144-3314" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3315"><a href="#cb144-3315" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict</span>
<span id="cb144-3316"><a href="#cb144-3316" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, OrderedDict <span class="im">as</span> OrderedDictType</span>
<span id="cb144-3317"><a href="#cb144-3317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3318"><a href="#cb144-3318" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]]:</span>
<span id="cb144-3319"><a href="#cb144-3319" aria-hidden="true" tabindex="-1"></a>    adjacency_list: OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]] <span class="op">=</span> OrderedDict()</span>
<span id="cb144-3320"><a href="#cb144-3320" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-3321"><a href="#cb144-3321" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">2</span>):</span>
<span id="cb144-3322"><a href="#cb144-3322" aria-hidden="true" tabindex="-1"></a>        adjacency_list[sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb144-3323"><a href="#cb144-3323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3324"><a href="#cb144-3324" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb144-3325"><a href="#cb144-3325" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb144-3326"><a href="#cb144-3326" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:i <span class="op">+</span> kmer_length]</span>
<span id="cb144-3327"><a href="#cb144-3327" aria-hidden="true" tabindex="-1"></a>        adjacency_list[prefix].add(suffix)</span>
<span id="cb144-3328"><a href="#cb144-3328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3329"><a href="#cb144-3329" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb144-3330"><a href="#cb144-3330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3331"><a href="#cb144-3331" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3332"><a href="#cb144-3332" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb144-3333"><a href="#cb144-3333" aria-hidden="true" tabindex="-1"></a><span class="st">AAGATTCTCTAC</span></span>
<span id="cb144-3334"><a href="#cb144-3334" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3335"><a href="#cb144-3335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3336"><a href="#cb144-3336" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3337"><a href="#cb144-3337" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb144-3338"><a href="#cb144-3338" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb144-3339"><a href="#cb144-3339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3340"><a href="#cb144-3340" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(dna_sequence, kmer_length)</span>
<span id="cb144-3341"><a href="#cb144-3341" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb144-3342"><a href="#cb144-3342" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> neighbors:</span>
<span id="cb144-3343"><a href="#cb144-3343" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb144-3344"><a href="#cb144-3344" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3345"><a href="#cb144-3345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3346"><a href="#cb144-3346" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the De Bruijn Graph of a Collection of k-mers</span></span>
<span id="cb144-3347"><a href="#cb144-3347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3348"><a href="#cb144-3348" aria-hidden="true" tabindex="-1"></a>De Bruijn Graph from&nbsp;_k_<span class="op">-</span>mers Problem. Construct the de Bruijn graph <span class="im">from</span> a collection of k<span class="op">-</span>mers.</span>
<span id="cb144-3349"><a href="#cb144-3349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3350"><a href="#cb144-3350" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of&nbsp;_k_<span class="op">-</span>mers&nbsp;_Patterns_.</span>
<span id="cb144-3351"><a href="#cb144-3351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3352"><a href="#cb144-3352" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The de Bruijn graph&nbsp;_DeBruijn_(_Patterns_), <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb144-3353"><a href="#cb144-3353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3354"><a href="#cb144-3354" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3355"><a href="#cb144-3355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3356"><a href="#cb144-3356" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3357"><a href="#cb144-3357" aria-hidden="true" tabindex="-1"></a>GAGG</span>
<span id="cb144-3358"><a href="#cb144-3358" aria-hidden="true" tabindex="-1"></a>CAGG</span>
<span id="cb144-3359"><a href="#cb144-3359" aria-hidden="true" tabindex="-1"></a>GGGG</span>
<span id="cb144-3360"><a href="#cb144-3360" aria-hidden="true" tabindex="-1"></a>GGGA</span>
<span id="cb144-3361"><a href="#cb144-3361" aria-hidden="true" tabindex="-1"></a>CAGG</span>
<span id="cb144-3362"><a href="#cb144-3362" aria-hidden="true" tabindex="-1"></a>AGGG</span>
<span id="cb144-3363"><a href="#cb144-3363" aria-hidden="true" tabindex="-1"></a>GGAG</span>
<span id="cb144-3364"><a href="#cb144-3364" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3365"><a href="#cb144-3365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3366"><a href="#cb144-3366" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3367"><a href="#cb144-3367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3368"><a href="#cb144-3368" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3369"><a href="#cb144-3369" aria-hidden="true" tabindex="-1"></a>GAG <span class="op">-&gt;</span> AGG</span>
<span id="cb144-3370"><a href="#cb144-3370" aria-hidden="true" tabindex="-1"></a>CAG <span class="op">-&gt;</span> AGG,AGG</span>
<span id="cb144-3371"><a href="#cb144-3371" aria-hidden="true" tabindex="-1"></a>GGG <span class="op">-&gt;</span> GGG,GGA</span>
<span id="cb144-3372"><a href="#cb144-3372" aria-hidden="true" tabindex="-1"></a>AGG <span class="op">-&gt;</span> GGG</span>
<span id="cb144-3373"><a href="#cb144-3373" aria-hidden="true" tabindex="-1"></a>GGA <span class="op">-&gt;</span> GAG</span>
<span id="cb144-3374"><a href="#cb144-3374" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3375"><a href="#cb144-3375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3376"><a href="#cb144-3376" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3377"><a href="#cb144-3377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3378"><a href="#cb144-3378" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3379"><a href="#cb144-3379" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb144-3380"><a href="#cb144-3380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3381"><a href="#cb144-3381" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3382"><a href="#cb144-3382" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb144-3383"><a href="#cb144-3383" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb144-3384"><a href="#cb144-3384" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb144-3385"><a href="#cb144-3385" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb144-3386"><a href="#cb144-3386" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_list:</span>
<span id="cb144-3387"><a href="#cb144-3387" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb144-3388"><a href="#cb144-3388" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb144-3389"><a href="#cb144-3389" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix].append(suffix)</span>
<span id="cb144-3390"><a href="#cb144-3390" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb144-3391"><a href="#cb144-3391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3392"><a href="#cb144-3392" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3393"><a href="#cb144-3393" aria-hidden="true" tabindex="-1"></a><span class="st">GAGG</span></span>
<span id="cb144-3394"><a href="#cb144-3394" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb144-3395"><a href="#cb144-3395" aria-hidden="true" tabindex="-1"></a><span class="st">GGGG</span></span>
<span id="cb144-3396"><a href="#cb144-3396" aria-hidden="true" tabindex="-1"></a><span class="st">GGGA</span></span>
<span id="cb144-3397"><a href="#cb144-3397" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb144-3398"><a href="#cb144-3398" aria-hidden="true" tabindex="-1"></a><span class="st">AGGG</span></span>
<span id="cb144-3399"><a href="#cb144-3399" aria-hidden="true" tabindex="-1"></a><span class="st">GGAG</span></span>
<span id="cb144-3400"><a href="#cb144-3400" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3401"><a href="#cb144-3401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3402"><a href="#cb144-3402" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3403"><a href="#cb144-3403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3404"><a href="#cb144-3404" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmer_list)</span>
<span id="cb144-3405"><a href="#cb144-3405" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb144-3406"><a href="#cb144-3406" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb144-3407"><a href="#cb144-3407" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3408"><a href="#cb144-3408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3409"><a href="#cb144-3409" aria-hidden="true" tabindex="-1"></a><span class="co"># Find an Eulerian Cycle in a Graph</span></span>
<span id="cb144-3410"><a href="#cb144-3410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3411"><a href="#cb144-3411" aria-hidden="true" tabindex="-1"></a>Eulerian Cycle Problem, Find an Eulerian cycle <span class="kw">in</span> a graph.</span>
<span id="cb144-3412"><a href="#cb144-3412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3413"><a href="#cb144-3413" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An Eulerian directed graph, <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb144-3414"><a href="#cb144-3414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3415"><a href="#cb144-3415" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An&nbsp;[Eulerian cycle](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>eulerian<span class="op">-</span>cycle<span class="op">/</span>)&nbsp;in this graph.</span>
<span id="cb144-3416"><a href="#cb144-3416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3417"><a href="#cb144-3417" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3418"><a href="#cb144-3418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3419"><a href="#cb144-3419" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3420"><a href="#cb144-3420" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb144-3421"><a href="#cb144-3421" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">0</span></span>
<span id="cb144-3422"><a href="#cb144-3422" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">1</span>,<span class="dv">6</span></span>
<span id="cb144-3423"><a href="#cb144-3423" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb144-3424"><a href="#cb144-3424" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb144-3425"><a href="#cb144-3425" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="op">-&gt;</span> <span class="dv">4</span></span>
<span id="cb144-3426"><a href="#cb144-3426" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">5</span>,<span class="dv">8</span></span>
<span id="cb144-3427"><a href="#cb144-3427" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">9</span></span>
<span id="cb144-3428"><a href="#cb144-3428" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="op">-&gt;</span> <span class="dv">7</span></span>
<span id="cb144-3429"><a href="#cb144-3429" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb144-3430"><a href="#cb144-3430" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3431"><a href="#cb144-3431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3432"><a href="#cb144-3432" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3433"><a href="#cb144-3433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3434"><a href="#cb144-3434" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3435"><a href="#cb144-3435" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">8</span><span class="op">-&gt;</span><span class="dv">7</span><span class="op">-&gt;</span><span class="dv">9</span><span class="op">-&gt;</span><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">6</span></span>
<span id="cb144-3436"><a href="#cb144-3436" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3437"><a href="#cb144-3437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3438"><a href="#cb144-3438" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3439"><a href="#cb144-3439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3440"><a href="#cb144-3440" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3441"><a href="#cb144-3441" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb144-3442"><a href="#cb144-3442" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb144-3443"><a href="#cb144-3443" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb144-3444"><a href="#cb144-3444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3445"><a href="#cb144-3445" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_list_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3446"><a href="#cb144-3446" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb144-3447"><a href="#cb144-3447" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> element <span class="kw">in</span> adjacency_list_text:</span>
<span id="cb144-3448"><a href="#cb144-3448" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, element)</span>
<span id="cb144-3449"><a href="#cb144-3449" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb144-3450"><a href="#cb144-3450" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb144-3451"><a href="#cb144-3451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3452"><a href="#cb144-3452" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3453"><a href="#cb144-3453" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb144-3454"><a href="#cb144-3454" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb144-3455"><a href="#cb144-3455" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb144-3456"><a href="#cb144-3456" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-3457"><a href="#cb144-3457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3458"><a href="#cb144-3458" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-3459"><a href="#cb144-3459" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Form a cycle by randomly walking in the graph</span></span>
<span id="cb144-3460"><a href="#cb144-3460" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb144-3461"><a href="#cb144-3461" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3462"><a href="#cb144-3462" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb144-3463"><a href="#cb144-3463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3464"><a href="#cb144-3464" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb144-3465"><a href="#cb144-3465" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb144-3466"><a href="#cb144-3466" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb144-3467"><a href="#cb144-3467" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3468"><a href="#cb144-3468" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3469"><a href="#cb144-3469" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3470"><a href="#cb144-3470" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3471"><a href="#cb144-3471" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb144-3472"><a href="#cb144-3472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3473"><a href="#cb144-3473" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb144-3474"><a href="#cb144-3474" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb144-3475"><a href="#cb144-3475" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb144-3476"><a href="#cb144-3476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3477"><a href="#cb144-3477" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Form new_cycle by traversing cycle (starting at new_start) and then randomly walking</span></span>
<span id="cb144-3478"><a href="#cb144-3478" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb144-3479"><a href="#cb144-3479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3480"><a href="#cb144-3480" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb144-3481"><a href="#cb144-3481" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb144-3482"><a href="#cb144-3482" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3483"><a href="#cb144-3483" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb144-3484"><a href="#cb144-3484" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb144-3485"><a href="#cb144-3485" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3486"><a href="#cb144-3486" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3487"><a href="#cb144-3487" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3488"><a href="#cb144-3488" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb144-3489"><a href="#cb144-3489" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb144-3490"><a href="#cb144-3490" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb144-3491"><a href="#cb144-3491" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb144-3492"><a href="#cb144-3492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3493"><a href="#cb144-3493" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3494"><a href="#cb144-3494" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 3</span></span>
<span id="cb144-3495"><a href="#cb144-3495" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 0</span></span>
<span id="cb144-3496"><a href="#cb144-3496" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1,6</span></span>
<span id="cb144-3497"><a href="#cb144-3497" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 2</span></span>
<span id="cb144-3498"><a href="#cb144-3498" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb144-3499"><a href="#cb144-3499" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 4</span></span>
<span id="cb144-3500"><a href="#cb144-3500" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 5,8</span></span>
<span id="cb144-3501"><a href="#cb144-3501" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 9</span></span>
<span id="cb144-3502"><a href="#cb144-3502" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 7</span></span>
<span id="cb144-3503"><a href="#cb144-3503" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb144-3504"><a href="#cb144-3504" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3505"><a href="#cb144-3505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3506"><a href="#cb144-3506" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3507"><a href="#cb144-3507" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb144-3508"><a href="#cb144-3508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3509"><a href="#cb144-3509" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_cycle(adjacency_list)))</span>
<span id="cb144-3510"><a href="#cb144-3510" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3511"><a href="#cb144-3511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3512"><a href="#cb144-3512" aria-hidden="true" tabindex="-1"></a><span class="co"># Find an Eulerian Path in a Graph</span></span>
<span id="cb144-3513"><a href="#cb144-3513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3514"><a href="#cb144-3514" aria-hidden="true" tabindex="-1"></a>Eulerian Path Problem, Find an Eulerian path <span class="kw">in</span> a graph.</span>
<span id="cb144-3515"><a href="#cb144-3515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3516"><a href="#cb144-3516" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[directed graph](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>directed<span class="op">-</span>graph<span class="op">/</span>)&nbsp;that contains an Eulerian path, where the graph <span class="kw">is</span> given <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb144-3517"><a href="#cb144-3517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3518"><a href="#cb144-3518" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An Eulerian path <span class="kw">in</span> this graph.</span>
<span id="cb144-3519"><a href="#cb144-3519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3520"><a href="#cb144-3520" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3521"><a href="#cb144-3521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3522"><a href="#cb144-3522" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3523"><a href="#cb144-3523" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb144-3524"><a href="#cb144-3524" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb144-3525"><a href="#cb144-3525" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">1</span></span>
<span id="cb144-3526"><a href="#cb144-3526" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">0</span>,<span class="dv">4</span></span>
<span id="cb144-3527"><a href="#cb144-3527" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">3</span>,<span class="dv">7</span></span>
<span id="cb144-3528"><a href="#cb144-3528" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">8</span></span>
<span id="cb144-3529"><a href="#cb144-3529" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="op">-&gt;</span> <span class="dv">9</span></span>
<span id="cb144-3530"><a href="#cb144-3530" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb144-3531"><a href="#cb144-3531" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3532"><a href="#cb144-3532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3533"><a href="#cb144-3533" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3534"><a href="#cb144-3534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3535"><a href="#cb144-3535" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3536"><a href="#cb144-3536" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">7</span><span class="op">-&gt;</span><span class="dv">8</span><span class="op">-&gt;</span><span class="dv">9</span><span class="op">-&gt;</span><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb144-3537"><a href="#cb144-3537" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3538"><a href="#cb144-3538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3539"><a href="#cb144-3539" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3540"><a href="#cb144-3540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3541"><a href="#cb144-3541" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3542"><a href="#cb144-3542" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb144-3543"><a href="#cb144-3543" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb144-3544"><a href="#cb144-3544" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb144-3545"><a href="#cb144-3545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3546"><a href="#cb144-3546" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3547"><a href="#cb144-3547" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb144-3548"><a href="#cb144-3548" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb144-3549"><a href="#cb144-3549" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb144-3550"><a href="#cb144-3550" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb144-3551"><a href="#cb144-3551" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb144-3552"><a href="#cb144-3552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3553"><a href="#cb144-3553" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3554"><a href="#cb144-3554" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb144-3555"><a href="#cb144-3555" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb144-3556"><a href="#cb144-3556" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb144-3557"><a href="#cb144-3557" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-3558"><a href="#cb144-3558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3559"><a href="#cb144-3559" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-3560"><a href="#cb144-3560" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb144-3561"><a href="#cb144-3561" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3562"><a href="#cb144-3562" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb144-3563"><a href="#cb144-3563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3564"><a href="#cb144-3564" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb144-3565"><a href="#cb144-3565" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb144-3566"><a href="#cb144-3566" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb144-3567"><a href="#cb144-3567" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3568"><a href="#cb144-3568" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3569"><a href="#cb144-3569" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3570"><a href="#cb144-3570" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3571"><a href="#cb144-3571" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb144-3572"><a href="#cb144-3572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3573"><a href="#cb144-3573" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb144-3574"><a href="#cb144-3574" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb144-3575"><a href="#cb144-3575" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb144-3576"><a href="#cb144-3576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3577"><a href="#cb144-3577" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb144-3578"><a href="#cb144-3578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3579"><a href="#cb144-3579" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb144-3580"><a href="#cb144-3580" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb144-3581"><a href="#cb144-3581" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3582"><a href="#cb144-3582" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb144-3583"><a href="#cb144-3583" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb144-3584"><a href="#cb144-3584" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3585"><a href="#cb144-3585" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3586"><a href="#cb144-3586" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3587"><a href="#cb144-3587" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb144-3588"><a href="#cb144-3588" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb144-3589"><a href="#cb144-3589" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb144-3590"><a href="#cb144-3590" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb144-3591"><a href="#cb144-3591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3592"><a href="#cb144-3592" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-3593"><a href="#cb144-3593" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb144-3594"><a href="#cb144-3594" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb144-3595"><a href="#cb144-3595" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb144-3596"><a href="#cb144-3596" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb144-3597"><a href="#cb144-3597" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb144-3598"><a href="#cb144-3598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3599"><a href="#cb144-3599" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb144-3600"><a href="#cb144-3600" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb144-3601"><a href="#cb144-3601" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-3602"><a href="#cb144-3602" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb144-3603"><a href="#cb144-3603" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb144-3604"><a href="#cb144-3604" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-3605"><a href="#cb144-3605" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb144-3606"><a href="#cb144-3606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3607"><a href="#cb144-3607" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb144-3608"><a href="#cb144-3608" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb144-3609"><a href="#cb144-3609" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb144-3610"><a href="#cb144-3610" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb144-3611"><a href="#cb144-3611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3612"><a href="#cb144-3612" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb144-3613"><a href="#cb144-3613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3614"><a href="#cb144-3614" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3615"><a href="#cb144-3615" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 2</span></span>
<span id="cb144-3616"><a href="#cb144-3616" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 3</span></span>
<span id="cb144-3617"><a href="#cb144-3617" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1</span></span>
<span id="cb144-3618"><a href="#cb144-3618" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 0,4</span></span>
<span id="cb144-3619"><a href="#cb144-3619" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 3,7</span></span>
<span id="cb144-3620"><a href="#cb144-3620" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 8</span></span>
<span id="cb144-3621"><a href="#cb144-3621" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 9</span></span>
<span id="cb144-3622"><a href="#cb144-3622" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb144-3623"><a href="#cb144-3623" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3624"><a href="#cb144-3624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3625"><a href="#cb144-3625" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3626"><a href="#cb144-3626" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb144-3627"><a href="#cb144-3627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3628"><a href="#cb144-3628" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_path(adjacency_list)))</span>
<span id="cb144-3629"><a href="#cb144-3629" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3630"><a href="#cb144-3630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3631"><a href="#cb144-3631" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its k-mer Composition</span></span>
<span id="cb144-3632"><a href="#cb144-3632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3633"><a href="#cb144-3633" aria-hidden="true" tabindex="-1"></a>String Reconstruction Problem. Reconstruct a string <span class="im">from</span> its k<span class="op">-</span>mer composition.</span>
<span id="cb144-3634"><a href="#cb144-3634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3635"><a href="#cb144-3635" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;_k_&nbsp;followed by a <span class="bu">list</span> of&nbsp;_k_<span class="op">-</span>mers&nbsp;_Patterns_.</span>
<span id="cb144-3636"><a href="#cb144-3636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3637"><a href="#cb144-3637" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;_Text_&nbsp;with&nbsp;_k_<span class="op">-</span>mer composition equal to&nbsp;_Patterns_. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb144-3638"><a href="#cb144-3638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3639"><a href="#cb144-3639" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3640"><a href="#cb144-3640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3641"><a href="#cb144-3641" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3642"><a href="#cb144-3642" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb144-3643"><a href="#cb144-3643" aria-hidden="true" tabindex="-1"></a>CTTA</span>
<span id="cb144-3644"><a href="#cb144-3644" aria-hidden="true" tabindex="-1"></a>ACCA</span>
<span id="cb144-3645"><a href="#cb144-3645" aria-hidden="true" tabindex="-1"></a>TACC</span>
<span id="cb144-3646"><a href="#cb144-3646" aria-hidden="true" tabindex="-1"></a>GGCT</span>
<span id="cb144-3647"><a href="#cb144-3647" aria-hidden="true" tabindex="-1"></a>GCTT</span>
<span id="cb144-3648"><a href="#cb144-3648" aria-hidden="true" tabindex="-1"></a>TTAC</span>
<span id="cb144-3649"><a href="#cb144-3649" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3650"><a href="#cb144-3650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3651"><a href="#cb144-3651" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3652"><a href="#cb144-3652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3653"><a href="#cb144-3653" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3654"><a href="#cb144-3654" aria-hidden="true" tabindex="-1"></a>GGCTTACCA</span>
<span id="cb144-3655"><a href="#cb144-3655" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3656"><a href="#cb144-3656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3657"><a href="#cb144-3657" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3658"><a href="#cb144-3658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3659"><a href="#cb144-3659" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3660"><a href="#cb144-3660" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb144-3661"><a href="#cb144-3661" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb144-3662"><a href="#cb144-3662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3663"><a href="#cb144-3663" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3664"><a href="#cb144-3664" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb144-3665"><a href="#cb144-3665" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb144-3666"><a href="#cb144-3666" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb144-3667"><a href="#cb144-3667" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb144-3668"><a href="#cb144-3668" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb144-3669"><a href="#cb144-3669" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb144-3670"><a href="#cb144-3670" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb144-3671"><a href="#cb144-3671" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb144-3672"><a href="#cb144-3672" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb144-3673"><a href="#cb144-3673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3674"><a href="#cb144-3674" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3675"><a href="#cb144-3675" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb144-3676"><a href="#cb144-3676" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb144-3677"><a href="#cb144-3677" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb144-3678"><a href="#cb144-3678" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-3679"><a href="#cb144-3679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3680"><a href="#cb144-3680" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-3681"><a href="#cb144-3681" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb144-3682"><a href="#cb144-3682" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3683"><a href="#cb144-3683" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb144-3684"><a href="#cb144-3684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3685"><a href="#cb144-3685" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb144-3686"><a href="#cb144-3686" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb144-3687"><a href="#cb144-3687" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb144-3688"><a href="#cb144-3688" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3689"><a href="#cb144-3689" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3690"><a href="#cb144-3690" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3691"><a href="#cb144-3691" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3692"><a href="#cb144-3692" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb144-3693"><a href="#cb144-3693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3694"><a href="#cb144-3694" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb144-3695"><a href="#cb144-3695" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb144-3696"><a href="#cb144-3696" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb144-3697"><a href="#cb144-3697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3698"><a href="#cb144-3698" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb144-3699"><a href="#cb144-3699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3700"><a href="#cb144-3700" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb144-3701"><a href="#cb144-3701" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb144-3702"><a href="#cb144-3702" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3703"><a href="#cb144-3703" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb144-3704"><a href="#cb144-3704" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb144-3705"><a href="#cb144-3705" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3706"><a href="#cb144-3706" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3707"><a href="#cb144-3707" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3708"><a href="#cb144-3708" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb144-3709"><a href="#cb144-3709" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb144-3710"><a href="#cb144-3710" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb144-3711"><a href="#cb144-3711" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb144-3712"><a href="#cb144-3712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3713"><a href="#cb144-3713" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-3714"><a href="#cb144-3714" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb144-3715"><a href="#cb144-3715" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb144-3716"><a href="#cb144-3716" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb144-3717"><a href="#cb144-3717" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb144-3718"><a href="#cb144-3718" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb144-3719"><a href="#cb144-3719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3720"><a href="#cb144-3720" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb144-3721"><a href="#cb144-3721" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb144-3722"><a href="#cb144-3722" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-3723"><a href="#cb144-3723" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb144-3724"><a href="#cb144-3724" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb144-3725"><a href="#cb144-3725" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-3726"><a href="#cb144-3726" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb144-3727"><a href="#cb144-3727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3728"><a href="#cb144-3728" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb144-3729"><a href="#cb144-3729" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb144-3730"><a href="#cb144-3730" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb144-3731"><a href="#cb144-3731" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb144-3732"><a href="#cb144-3732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3733"><a href="#cb144-3733" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb144-3734"><a href="#cb144-3734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3735"><a href="#cb144-3735" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-3736"><a href="#cb144-3736" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb144-3737"><a href="#cb144-3737" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(adjacency_list)</span>
<span id="cb144-3738"><a href="#cb144-3738" aria-hidden="true" tabindex="-1"></a>    reconstructed_string <span class="op">=</span> path[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb144-3739"><a href="#cb144-3739" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> path:</span>
<span id="cb144-3740"><a href="#cb144-3740" aria-hidden="true" tabindex="-1"></a>        reconstructed_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb144-3741"><a href="#cb144-3741" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_string</span>
<span id="cb144-3742"><a href="#cb144-3742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3743"><a href="#cb144-3743" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3744"><a href="#cb144-3744" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb144-3745"><a href="#cb144-3745" aria-hidden="true" tabindex="-1"></a><span class="st">CTTA</span></span>
<span id="cb144-3746"><a href="#cb144-3746" aria-hidden="true" tabindex="-1"></a><span class="st">ACCA</span></span>
<span id="cb144-3747"><a href="#cb144-3747" aria-hidden="true" tabindex="-1"></a><span class="st">TACC</span></span>
<span id="cb144-3748"><a href="#cb144-3748" aria-hidden="true" tabindex="-1"></a><span class="st">GGCT</span></span>
<span id="cb144-3749"><a href="#cb144-3749" aria-hidden="true" tabindex="-1"></a><span class="st">GCTT</span></span>
<span id="cb144-3750"><a href="#cb144-3750" aria-hidden="true" tabindex="-1"></a><span class="st">TTAC</span></span>
<span id="cb144-3751"><a href="#cb144-3751" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3752"><a href="#cb144-3752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3753"><a href="#cb144-3753" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3754"><a href="#cb144-3754" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb144-3755"><a href="#cb144-3755" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb144-3756"><a href="#cb144-3756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3757"><a href="#cb144-3757" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string(kmers))</span>
<span id="cb144-3758"><a href="#cb144-3758" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3759"><a href="#cb144-3759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3760"><a href="#cb144-3760" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a k-Universal Circular String</span></span>
<span id="cb144-3761"><a href="#cb144-3761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3762"><a href="#cb144-3762" aria-hidden="true" tabindex="-1"></a> _k_<span class="op">-</span>Universal Circular String Problem. Find a k<span class="op">-</span>universal circular binary string.</span>
<span id="cb144-3763"><a href="#cb144-3763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3764"><a href="#cb144-3764" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;_k_.</span>
<span id="cb144-3765"><a href="#cb144-3765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3766"><a href="#cb144-3766" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A&nbsp;_k_<span class="op">-</span>universal circular string. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb144-3767"><a href="#cb144-3767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3768"><a href="#cb144-3768" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3769"><a href="#cb144-3769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3770"><a href="#cb144-3770" aria-hidden="true" tabindex="-1"></a>```<span class="dv">4</span>```</span>
<span id="cb144-3771"><a href="#cb144-3771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3772"><a href="#cb144-3772" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3773"><a href="#cb144-3773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3774"><a href="#cb144-3774" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3775"><a href="#cb144-3775" aria-hidden="true" tabindex="-1"></a><span class="dv">1111010010110000</span></span>
<span id="cb144-3776"><a href="#cb144-3776" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3777"><a href="#cb144-3777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3778"><a href="#cb144-3778" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3779"><a href="#cb144-3779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3780"><a href="#cb144-3780" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3781"><a href="#cb144-3781" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb144-3782"><a href="#cb144-3782" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb144-3783"><a href="#cb144-3783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3784"><a href="#cb144-3784" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3785"><a href="#cb144-3785" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb144-3786"><a href="#cb144-3786" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb144-3787"><a href="#cb144-3787" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb144-3788"><a href="#cb144-3788" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb144-3789"><a href="#cb144-3789" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb144-3790"><a href="#cb144-3790" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb144-3791"><a href="#cb144-3791" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb144-3792"><a href="#cb144-3792" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb144-3793"><a href="#cb144-3793" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb144-3794"><a href="#cb144-3794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3795"><a href="#cb144-3795" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3796"><a href="#cb144-3796" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb144-3797"><a href="#cb144-3797" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb144-3798"><a href="#cb144-3798" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb144-3799"><a href="#cb144-3799" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-3800"><a href="#cb144-3800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3801"><a href="#cb144-3801" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-3802"><a href="#cb144-3802" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb144-3803"><a href="#cb144-3803" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3804"><a href="#cb144-3804" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb144-3805"><a href="#cb144-3805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3806"><a href="#cb144-3806" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb144-3807"><a href="#cb144-3807" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb144-3808"><a href="#cb144-3808" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb144-3809"><a href="#cb144-3809" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3810"><a href="#cb144-3810" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3811"><a href="#cb144-3811" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3812"><a href="#cb144-3812" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3813"><a href="#cb144-3813" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb144-3814"><a href="#cb144-3814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3815"><a href="#cb144-3815" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb144-3816"><a href="#cb144-3816" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb144-3817"><a href="#cb144-3817" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb144-3818"><a href="#cb144-3818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3819"><a href="#cb144-3819" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb144-3820"><a href="#cb144-3820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3821"><a href="#cb144-3821" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb144-3822"><a href="#cb144-3822" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb144-3823"><a href="#cb144-3823" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3824"><a href="#cb144-3824" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb144-3825"><a href="#cb144-3825" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb144-3826"><a href="#cb144-3826" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3827"><a href="#cb144-3827" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3828"><a href="#cb144-3828" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3829"><a href="#cb144-3829" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb144-3830"><a href="#cb144-3830" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb144-3831"><a href="#cb144-3831" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb144-3832"><a href="#cb144-3832" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb144-3833"><a href="#cb144-3833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3834"><a href="#cb144-3834" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_k_universal_circular_string(k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-3835"><a href="#cb144-3835" aria-hidden="true" tabindex="-1"></a>    kmers: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb144-3836"><a href="#cb144-3836" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span> <span class="op">**</span> k):</span>
<span id="cb144-3837"><a href="#cb144-3837" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> <span class="bu">format</span>(i, <span class="ss">f'0</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">b'</span>)</span>
<span id="cb144-3838"><a href="#cb144-3838" aria-hidden="true" tabindex="-1"></a>        kmers.append(kmer)</span>
<span id="cb144-3839"><a href="#cb144-3839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3840"><a href="#cb144-3840" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb144-3841"><a href="#cb144-3841" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(adjacency_list)</span>
<span id="cb144-3842"><a href="#cb144-3842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3843"><a href="#cb144-3843" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> cycle[:<span class="bu">len</span>(cycle) <span class="op">-</span> k <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb144-3844"><a href="#cb144-3844" aria-hidden="true" tabindex="-1"></a>    circular_string <span class="op">=</span> cycle[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb144-3845"><a href="#cb144-3845" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> cycle:</span>
<span id="cb144-3846"><a href="#cb144-3846" aria-hidden="true" tabindex="-1"></a>        circular_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb144-3847"><a href="#cb144-3847" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> circular_string</span>
<span id="cb144-3848"><a href="#cb144-3848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3849"><a href="#cb144-3849" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3850"><a href="#cb144-3850" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb144-3851"><a href="#cb144-3851" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3852"><a href="#cb144-3852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3853"><a href="#cb144-3853" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3854"><a href="#cb144-3854" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb144-3855"><a href="#cb144-3855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3856"><a href="#cb144-3856" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generate_k_universal_circular_string(k))</span>
<span id="cb144-3857"><a href="#cb144-3857" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3858"><a href="#cb144-3858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3859"><a href="#cb144-3859" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its Paired Composition</span></span>
<span id="cb144-3860"><a href="#cb144-3860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3861"><a href="#cb144-3861" aria-hidden="true" tabindex="-1"></a>String Reconstruction <span class="im">from</span> Read<span class="op">-</span>Pairs Problem. Reconstruct a string <span class="im">from</span> its paired composition.</span>
<span id="cb144-3862"><a href="#cb144-3862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3863"><a href="#cb144-3863" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;_k_&nbsp;and&nbsp;_d_&nbsp;followed by a collection of paired&nbsp;_k_<span class="op">-</span>mers&nbsp;_PairedReads_.</span>
<span id="cb144-3864"><a href="#cb144-3864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3865"><a href="#cb144-3865" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;_Text_&nbsp;with (_k_,&nbsp;_d_)<span class="op">-</span>mer composition equal to&nbsp;_PairedReads_. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb144-3866"><a href="#cb144-3866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3867"><a href="#cb144-3867" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-3868"><a href="#cb144-3868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3869"><a href="#cb144-3869" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3870"><a href="#cb144-3870" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">2</span></span>
<span id="cb144-3871"><a href="#cb144-3871" aria-hidden="true" tabindex="-1"></a>GAGA<span class="op">|</span>TTGA</span>
<span id="cb144-3872"><a href="#cb144-3872" aria-hidden="true" tabindex="-1"></a>TCGT<span class="op">|</span>GATG</span>
<span id="cb144-3873"><a href="#cb144-3873" aria-hidden="true" tabindex="-1"></a>CGTG<span class="op">|</span>ATGT</span>
<span id="cb144-3874"><a href="#cb144-3874" aria-hidden="true" tabindex="-1"></a>TGGT<span class="op">|</span>TGAG</span>
<span id="cb144-3875"><a href="#cb144-3875" aria-hidden="true" tabindex="-1"></a>GTGA<span class="op">|</span>TGTT</span>
<span id="cb144-3876"><a href="#cb144-3876" aria-hidden="true" tabindex="-1"></a>GTGG<span class="op">|</span>GTGA</span>
<span id="cb144-3877"><a href="#cb144-3877" aria-hidden="true" tabindex="-1"></a>TGAG<span class="op">|</span>GTTG</span>
<span id="cb144-3878"><a href="#cb144-3878" aria-hidden="true" tabindex="-1"></a>GGTC<span class="op">|</span>GAGA</span>
<span id="cb144-3879"><a href="#cb144-3879" aria-hidden="true" tabindex="-1"></a>GTCG<span class="op">|</span>AGAT</span>
<span id="cb144-3880"><a href="#cb144-3880" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3881"><a href="#cb144-3881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3882"><a href="#cb144-3882" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-3883"><a href="#cb144-3883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3884"><a href="#cb144-3884" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3885"><a href="#cb144-3885" aria-hidden="true" tabindex="-1"></a>GTGGTCGTGAGATGTTGA</span>
<span id="cb144-3886"><a href="#cb144-3886" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3887"><a href="#cb144-3887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3888"><a href="#cb144-3888" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-3889"><a href="#cb144-3889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3890"><a href="#cb144-3890" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-3891"><a href="#cb144-3891" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb144-3892"><a href="#cb144-3892" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-3893"><a href="#cb144-3893" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb144-3894"><a href="#cb144-3894" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb144-3895"><a href="#cb144-3895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3896"><a href="#cb144-3896" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-3897"><a href="#cb144-3897" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb144-3898"><a href="#cb144-3898" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb144-3899"><a href="#cb144-3899" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb144-3900"><a href="#cb144-3900" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-3901"><a href="#cb144-3901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3902"><a href="#cb144-3902" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-3903"><a href="#cb144-3903" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb144-3904"><a href="#cb144-3904" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3905"><a href="#cb144-3905" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb144-3906"><a href="#cb144-3906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3907"><a href="#cb144-3907" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb144-3908"><a href="#cb144-3908" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb144-3909"><a href="#cb144-3909" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb144-3910"><a href="#cb144-3910" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3911"><a href="#cb144-3911" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3912"><a href="#cb144-3912" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3913"><a href="#cb144-3913" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3914"><a href="#cb144-3914" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb144-3915"><a href="#cb144-3915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3916"><a href="#cb144-3916" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb144-3917"><a href="#cb144-3917" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb144-3918"><a href="#cb144-3918" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb144-3919"><a href="#cb144-3919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3920"><a href="#cb144-3920" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb144-3921"><a href="#cb144-3921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3922"><a href="#cb144-3922" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb144-3923"><a href="#cb144-3923" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb144-3924"><a href="#cb144-3924" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb144-3925"><a href="#cb144-3925" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb144-3926"><a href="#cb144-3926" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb144-3927"><a href="#cb144-3927" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb144-3928"><a href="#cb144-3928" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb144-3929"><a href="#cb144-3929" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-3930"><a href="#cb144-3930" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb144-3931"><a href="#cb144-3931" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb144-3932"><a href="#cb144-3932" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb144-3933"><a href="#cb144-3933" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb144-3934"><a href="#cb144-3934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3935"><a href="#cb144-3935" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-3936"><a href="#cb144-3936" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb144-3937"><a href="#cb144-3937" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb144-3938"><a href="#cb144-3938" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb144-3939"><a href="#cb144-3939" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb144-3940"><a href="#cb144-3940" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb144-3941"><a href="#cb144-3941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3942"><a href="#cb144-3942" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb144-3943"><a href="#cb144-3943" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb144-3944"><a href="#cb144-3944" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-3945"><a href="#cb144-3945" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb144-3946"><a href="#cb144-3946" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb144-3947"><a href="#cb144-3947" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb144-3948"><a href="#cb144-3948" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb144-3949"><a href="#cb144-3949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3950"><a href="#cb144-3950" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb144-3951"><a href="#cb144-3951" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb144-3952"><a href="#cb144-3952" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb144-3953"><a href="#cb144-3953" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb144-3954"><a href="#cb144-3954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3955"><a href="#cb144-3955" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb144-3956"><a href="#cb144-3956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3957"><a href="#cb144-3957" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph_paired_reads(paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]]:</span>
<span id="cb144-3958"><a href="#cb144-3958" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb144-3959"><a href="#cb144-3959" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pair <span class="kw">in</span> paired_reads:</span>
<span id="cb144-3960"><a href="#cb144-3960" aria-hidden="true" tabindex="-1"></a>        graph[(pair[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>], pair[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>])].append((pair[<span class="dv">0</span>][<span class="dv">1</span>:], pair[<span class="dv">1</span>][<span class="dv">1</span>:]))</span>
<span id="cb144-3961"><a href="#cb144-3961" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-3962"><a href="#cb144-3962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3963"><a href="#cb144-3963" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> string_spelled_by_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-3964"><a href="#cb144-3964" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb144-3965"><a href="#cb144-3965" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">1</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>]</span>
<span id="cb144-3966"><a href="#cb144-3966" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-3967"><a href="#cb144-3967" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb144-3968"><a href="#cb144-3968" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb144-3969"><a href="#cb144-3969" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb144-3970"><a href="#cb144-3970" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb144-3971"><a href="#cb144-3971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3972"><a href="#cb144-3972" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_read_pairs(k: <span class="bu">int</span>, d: <span class="bu">int</span>, paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-3973"><a href="#cb144-3973" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph_paired_reads(paired_reads)</span>
<span id="cb144-3974"><a href="#cb144-3974" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(graph)</span>
<span id="cb144-3975"><a href="#cb144-3975" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> string_spelled_by_gapped_patterns(path, k <span class="op">-</span> <span class="dv">1</span>, d)</span>
<span id="cb144-3976"><a href="#cb144-3976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3977"><a href="#cb144-3977" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-3978"><a href="#cb144-3978" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb144-3979"><a href="#cb144-3979" aria-hidden="true" tabindex="-1"></a><span class="st">GAGA|TTGA</span></span>
<span id="cb144-3980"><a href="#cb144-3980" aria-hidden="true" tabindex="-1"></a><span class="st">TCGT|GATG</span></span>
<span id="cb144-3981"><a href="#cb144-3981" aria-hidden="true" tabindex="-1"></a><span class="st">CGTG|ATGT</span></span>
<span id="cb144-3982"><a href="#cb144-3982" aria-hidden="true" tabindex="-1"></a><span class="st">TGGT|TGAG</span></span>
<span id="cb144-3983"><a href="#cb144-3983" aria-hidden="true" tabindex="-1"></a><span class="st">GTGA|TGTT</span></span>
<span id="cb144-3984"><a href="#cb144-3984" aria-hidden="true" tabindex="-1"></a><span class="st">GTGG|GTGA</span></span>
<span id="cb144-3985"><a href="#cb144-3985" aria-hidden="true" tabindex="-1"></a><span class="st">TGAG|GTTG</span></span>
<span id="cb144-3986"><a href="#cb144-3986" aria-hidden="true" tabindex="-1"></a><span class="st">GGTC|GAGA</span></span>
<span id="cb144-3987"><a href="#cb144-3987" aria-hidden="true" tabindex="-1"></a><span class="st">GTCG|AGAT</span></span>
<span id="cb144-3988"><a href="#cb144-3988" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-3989"><a href="#cb144-3989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3990"><a href="#cb144-3990" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-3991"><a href="#cb144-3991" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb144-3992"><a href="#cb144-3992" aria-hidden="true" tabindex="-1"></a>paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb144-3993"><a href="#cb144-3993" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3994"><a href="#cb144-3994" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_read_pairs(k, d, paired_reads))</span>
<span id="cb144-3995"><a href="#cb144-3995" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-3996"><a href="#cb144-3996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3997"><a href="#cb144-3997" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Contigs from a Collection of Reads</span></span>
<span id="cb144-3998"><a href="#cb144-3998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-3999"><a href="#cb144-3999" aria-hidden="true" tabindex="-1"></a>Contig Generation Problem. Generate the contigs <span class="im">from</span> a collection of reads (<span class="cf">with</span> imperfect coverage).</span>
<span id="cb144-4000"><a href="#cb144-4000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4001"><a href="#cb144-4001" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of k<span class="op">-</span>mers&nbsp;_Patterns_.</span>
<span id="cb144-4002"><a href="#cb144-4002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4003"><a href="#cb144-4003" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All contigs in&nbsp;_DeBruijn(Patterns)_. (You may <span class="cf">return</span> the strings <span class="kw">in</span> <span class="bu">any</span> order.)</span>
<span id="cb144-4004"><a href="#cb144-4004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4005"><a href="#cb144-4005" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-4006"><a href="#cb144-4006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4007"><a href="#cb144-4007" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4008"><a href="#cb144-4008" aria-hidden="true" tabindex="-1"></a>ATG</span>
<span id="cb144-4009"><a href="#cb144-4009" aria-hidden="true" tabindex="-1"></a>ATG</span>
<span id="cb144-4010"><a href="#cb144-4010" aria-hidden="true" tabindex="-1"></a>TGT</span>
<span id="cb144-4011"><a href="#cb144-4011" aria-hidden="true" tabindex="-1"></a>TGG</span>
<span id="cb144-4012"><a href="#cb144-4012" aria-hidden="true" tabindex="-1"></a>CAT</span>
<span id="cb144-4013"><a href="#cb144-4013" aria-hidden="true" tabindex="-1"></a>GGA</span>
<span id="cb144-4014"><a href="#cb144-4014" aria-hidden="true" tabindex="-1"></a>GAT</span>
<span id="cb144-4015"><a href="#cb144-4015" aria-hidden="true" tabindex="-1"></a>AGA</span>
<span id="cb144-4016"><a href="#cb144-4016" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4017"><a href="#cb144-4017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4018"><a href="#cb144-4018" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-4019"><a href="#cb144-4019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4020"><a href="#cb144-4020" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4021"><a href="#cb144-4021" aria-hidden="true" tabindex="-1"></a>AGA ATG ATG CAT GAT TGGA TGT</span>
<span id="cb144-4022"><a href="#cb144-4022" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4023"><a href="#cb144-4023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4024"><a href="#cb144-4024" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-4025"><a href="#cb144-4025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4026"><a href="#cb144-4026" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-4027"><a href="#cb144-4027" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb144-4028"><a href="#cb144-4028" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb144-4029"><a href="#cb144-4029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4030"><a href="#cb144-4030" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-4031"><a href="#cb144-4031" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb144-4032"><a href="#cb144-4032" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb144-4033"><a href="#cb144-4033" aria-hidden="true" tabindex="-1"></a>        prefix, suffix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>], kmer[<span class="dv">1</span>:]</span>
<span id="cb144-4034"><a href="#cb144-4034" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[prefix].append(suffix)</span>
<span id="cb144-4035"><a href="#cb144-4035" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb144-4036"><a href="#cb144-4036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4037"><a href="#cb144-4037" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-4038"><a href="#cb144-4038" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb144-4039"><a href="#cb144-4039" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb144-4040"><a href="#cb144-4040" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb144-4041"><a href="#cb144-4041" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-4042"><a href="#cb144-4042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4043"><a href="#cb144-4043" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb144-4044"><a href="#cb144-4044" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb144-4045"><a href="#cb144-4045" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb144-4046"><a href="#cb144-4046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4047"><a href="#cb144-4047" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb144-4048"><a href="#cb144-4048" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb144-4049"><a href="#cb144-4049" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb144-4050"><a href="#cb144-4050" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(targets)]</span>
<span id="cb144-4051"><a href="#cb144-4051" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb144-4052"><a href="#cb144-4052" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(targets)</span>
<span id="cb144-4053"><a href="#cb144-4053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4054"><a href="#cb144-4054" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb144-4055"><a href="#cb144-4055" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb144-4056"><a href="#cb144-4056" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb144-4057"><a href="#cb144-4057" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb144-4058"><a href="#cb144-4058" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-4059"><a href="#cb144-4059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4060"><a href="#cb144-4060" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb144-4061"><a href="#cb144-4061" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb144-4062"><a href="#cb144-4062" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb144-4063"><a href="#cb144-4063" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb144-4064"><a href="#cb144-4064" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb144-4065"><a href="#cb144-4065" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb144-4066"><a href="#cb144-4066" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb144-4067"><a href="#cb144-4067" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb144-4068"><a href="#cb144-4068" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb144-4069"><a href="#cb144-4069" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb144-4070"><a href="#cb144-4070" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb144-4071"><a href="#cb144-4071" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb144-4072"><a href="#cb144-4072" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb144-4073"><a href="#cb144-4073" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb144-4074"><a href="#cb144-4074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4075"><a href="#cb144-4075" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb144-4076"><a href="#cb144-4076" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb144-4077"><a href="#cb144-4077" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb144-4078"><a href="#cb144-4078" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb144-4079"><a href="#cb144-4079" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb144-4080"><a href="#cb144-4080" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb144-4081"><a href="#cb144-4081" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb144-4082"><a href="#cb144-4082" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb144-4083"><a href="#cb144-4083" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb144-4084"><a href="#cb144-4084" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-4085"><a href="#cb144-4085" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb144-4086"><a href="#cb144-4086" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb144-4087"><a href="#cb144-4087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4088"><a href="#cb144-4088" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb144-4089"><a href="#cb144-4089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4090"><a href="#cb144-4090" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_contigs(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb144-4091"><a href="#cb144-4091" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb144-4092"><a href="#cb144-4092" aria-hidden="true" tabindex="-1"></a>    paths <span class="op">=</span> find_maximal_non_branching_paths(graph)</span>
<span id="cb144-4093"><a href="#cb144-4093" aria-hidden="true" tabindex="-1"></a>    contigs: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb144-4094"><a href="#cb144-4094" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> path <span class="kw">in</span> paths:</span>
<span id="cb144-4095"><a href="#cb144-4095" aria-hidden="true" tabindex="-1"></a>        contig <span class="op">=</span> path[<span class="dv">0</span>]</span>
<span id="cb144-4096"><a href="#cb144-4096" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> path[<span class="dv">1</span>:]:</span>
<span id="cb144-4097"><a href="#cb144-4097" aria-hidden="true" tabindex="-1"></a>            contig <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb144-4098"><a href="#cb144-4098" aria-hidden="true" tabindex="-1"></a>        contigs.append(contig)</span>
<span id="cb144-4099"><a href="#cb144-4099" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> contigs</span>
<span id="cb144-4100"><a href="#cb144-4100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4101"><a href="#cb144-4101" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-4102"><a href="#cb144-4102" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb144-4103"><a href="#cb144-4103" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb144-4104"><a href="#cb144-4104" aria-hidden="true" tabindex="-1"></a><span class="st">TGT</span></span>
<span id="cb144-4105"><a href="#cb144-4105" aria-hidden="true" tabindex="-1"></a><span class="st">TGG</span></span>
<span id="cb144-4106"><a href="#cb144-4106" aria-hidden="true" tabindex="-1"></a><span class="st">CAT</span></span>
<span id="cb144-4107"><a href="#cb144-4107" aria-hidden="true" tabindex="-1"></a><span class="st">GGA</span></span>
<span id="cb144-4108"><a href="#cb144-4108" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb144-4109"><a href="#cb144-4109" aria-hidden="true" tabindex="-1"></a><span class="st">AGA</span></span>
<span id="cb144-4110"><a href="#cb144-4110" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-4111"><a href="#cb144-4111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4112"><a href="#cb144-4112" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-4113"><a href="#cb144-4113" aria-hidden="true" tabindex="-1"></a>contigs <span class="op">=</span> generate_contigs(kmers)</span>
<span id="cb144-4114"><a href="#cb144-4114" aria-hidden="true" tabindex="-1"></a>contigs.sort()</span>
<span id="cb144-4115"><a href="#cb144-4115" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(contigs))</span>
<span id="cb144-4116"><a href="#cb144-4116" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4117"><a href="#cb144-4117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4118"><a href="#cb144-4118" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a String Spelled by a Gapped Genome Path</span></span>
<span id="cb144-4119"><a href="#cb144-4119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4120"><a href="#cb144-4120" aria-hidden="true" tabindex="-1"></a>Gapped Genome Path String Problem. Reconstruct a string <span class="im">from</span> a sequence of (k,d)<span class="op">-</span>mers corresponding to a path <span class="kw">in</span> a paired de Bruijn graph.</span>
<span id="cb144-4121"><a href="#cb144-4121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4122"><a href="#cb144-4122" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of&nbsp;_(k, d)_<span class="op">-</span>mers (_a1<span class="op">|</span>b1_), ... , (_an<span class="op">|</span>bn_) such that&nbsp;_Suffix(ai<span class="op">|</span>bi) <span class="op">=</span> Prefix(ai<span class="op">+</span><span class="dv">1</span><span class="op">|</span>bi<span class="op">+</span><span class="dv">1</span>)_&nbsp;for all&nbsp;_i_&nbsp;from <span class="dv">1</span> to n<span class="op">-</span><span class="fl">1.</span></span>
<span id="cb144-4123"><a href="#cb144-4123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4124"><a href="#cb144-4124" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;_Text_&nbsp;where the&nbsp;_i_<span class="op">-</span>th&nbsp;_k_<span class="op">-</span>mer in&nbsp;_Text_&nbsp;is equal to&nbsp;_Suffix(ai<span class="op">|</span>bi)_&nbsp;for all&nbsp;_i_&nbsp;from <span class="dv">1</span> to n, <span class="cf">if</span> such a string exists.</span>
<span id="cb144-4125"><a href="#cb144-4125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4126"><a href="#cb144-4126" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-4127"><a href="#cb144-4127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4128"><a href="#cb144-4128" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4129"><a href="#cb144-4129" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">2</span></span>
<span id="cb144-4130"><a href="#cb144-4130" aria-hidden="true" tabindex="-1"></a>GACC<span class="op">|</span>GCGC</span>
<span id="cb144-4131"><a href="#cb144-4131" aria-hidden="true" tabindex="-1"></a>ACCG<span class="op">|</span>CGCC</span>
<span id="cb144-4132"><a href="#cb144-4132" aria-hidden="true" tabindex="-1"></a>CCGA<span class="op">|</span>GCCG</span>
<span id="cb144-4133"><a href="#cb144-4133" aria-hidden="true" tabindex="-1"></a>CGAG<span class="op">|</span>CCGG</span>
<span id="cb144-4134"><a href="#cb144-4134" aria-hidden="true" tabindex="-1"></a>GAGC<span class="op">|</span>CGGA</span>
<span id="cb144-4135"><a href="#cb144-4135" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4136"><a href="#cb144-4136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4137"><a href="#cb144-4137" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-4138"><a href="#cb144-4138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4139"><a href="#cb144-4139" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4140"><a href="#cb144-4140" aria-hidden="true" tabindex="-1"></a>GACCGAGCGCCGGA</span>
<span id="cb144-4141"><a href="#cb144-4141" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4142"><a href="#cb144-4142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4143"><a href="#cb144-4143" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-4144"><a href="#cb144-4144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4145"><a href="#cb144-4145" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-4146"><a href="#cb144-4146" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb144-4147"><a href="#cb144-4147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4148"><a href="#cb144-4148" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb144-4149"><a href="#cb144-4149" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb144-4150"><a href="#cb144-4150" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb144-4151"><a href="#cb144-4151" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (prefix, suffix) <span class="kw">in</span> <span class="bu">enumerate</span>(gapped_patterns):</span>
<span id="cb144-4152"><a href="#cb144-4152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">!=</span> <span class="bu">len</span>(gapped_patterns) <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb144-4153"><a href="#cb144-4153" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix[<span class="dv">0</span>]</span>
<span id="cb144-4154"><a href="#cb144-4154" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix[<span class="dv">0</span>]</span>
<span id="cb144-4155"><a href="#cb144-4155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb144-4156"><a href="#cb144-4156" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix</span>
<span id="cb144-4157"><a href="#cb144-4157" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix</span>
<span id="cb144-4158"><a href="#cb144-4158" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-4159"><a href="#cb144-4159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb144-4160"><a href="#cb144-4160" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb144-4161"><a href="#cb144-4161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb144-4162"><a href="#cb144-4162" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb144-4163"><a href="#cb144-4163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb144-4164"><a href="#cb144-4164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4165"><a href="#cb144-4165" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-4166"><a href="#cb144-4166" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb144-4167"><a href="#cb144-4167" aria-hidden="true" tabindex="-1"></a><span class="st">GACC|GCGC</span></span>
<span id="cb144-4168"><a href="#cb144-4168" aria-hidden="true" tabindex="-1"></a><span class="st">ACCG|CGCC</span></span>
<span id="cb144-4169"><a href="#cb144-4169" aria-hidden="true" tabindex="-1"></a><span class="st">CCGA|GCCG</span></span>
<span id="cb144-4170"><a href="#cb144-4170" aria-hidden="true" tabindex="-1"></a><span class="st">CGAG|CCGG</span></span>
<span id="cb144-4171"><a href="#cb144-4171" aria-hidden="true" tabindex="-1"></a><span class="st">GAGC|CGGA</span></span>
<span id="cb144-4172"><a href="#cb144-4172" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-4173"><a href="#cb144-4173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4174"><a href="#cb144-4174" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-4175"><a href="#cb144-4175" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb144-4176"><a href="#cb144-4176" aria-hidden="true" tabindex="-1"></a>gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb144-4177"><a href="#cb144-4177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4178"><a href="#cb144-4178" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_gapped_patterns(gapped_patterns, k <span class="op">-</span> <span class="dv">1</span>, d))</span>
<span id="cb144-4179"><a href="#cb144-4179" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4180"><a href="#cb144-4180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4181"><a href="#cb144-4181" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate All Maximal Non-Branching Paths in a Graph</span></span>
<span id="cb144-4182"><a href="#cb144-4182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4183"><a href="#cb144-4183" aria-hidden="true" tabindex="-1"></a> Maximal Non<span class="op">-</span>Branching Path Problem. Find <span class="bu">all</span> maximal non<span class="op">-</span>branching paths <span class="kw">in</span> a graph.</span>
<span id="cb144-4184"><a href="#cb144-4184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4185"><a href="#cb144-4185" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;The adjacency <span class="bu">list</span> of a graph whose nodes are integers.</span>
<span id="cb144-4186"><a href="#cb144-4186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4187"><a href="#cb144-4187" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The collection of <span class="bu">all</span> maximal non<span class="op">-</span>branching paths <span class="kw">in</span> the graph.</span>
<span id="cb144-4188"><a href="#cb144-4188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4189"><a href="#cb144-4189" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-4190"><a href="#cb144-4190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4191"><a href="#cb144-4191" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4192"><a href="#cb144-4192" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb144-4193"><a href="#cb144-4193" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb144-4194"><a href="#cb144-4194" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">4</span>,<span class="dv">5</span></span>
<span id="cb144-4195"><a href="#cb144-4195" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">7</span></span>
<span id="cb144-4196"><a href="#cb144-4196" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb144-4197"><a href="#cb144-4197" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4198"><a href="#cb144-4198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4199"><a href="#cb144-4199" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-4200"><a href="#cb144-4200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4201"><a href="#cb144-4201" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4202"><a href="#cb144-4202" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb144-4203"><a href="#cb144-4203" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">4</span></span>
<span id="cb144-4204"><a href="#cb144-4204" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">5</span></span>
<span id="cb144-4205"><a href="#cb144-4205" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb144-4206"><a href="#cb144-4206" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4207"><a href="#cb144-4207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4208"><a href="#cb144-4208" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-4209"><a href="#cb144-4209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4210"><a href="#cb144-4210" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-4211"><a href="#cb144-4211" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb144-4212"><a href="#cb144-4212" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb144-4213"><a href="#cb144-4213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4214"><a href="#cb144-4214" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-4215"><a href="#cb144-4215" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb144-4216"><a href="#cb144-4216" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb144-4217"><a href="#cb144-4217" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb144-4218"><a href="#cb144-4218" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[source] <span class="op">=</span> targets.split(<span class="st">','</span>)</span>
<span id="cb144-4219"><a href="#cb144-4219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb144-4220"><a href="#cb144-4220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4221"><a href="#cb144-4221" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb144-4222"><a href="#cb144-4222" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb144-4223"><a href="#cb144-4223" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb144-4224"><a href="#cb144-4224" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb144-4225"><a href="#cb144-4225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb144-4226"><a href="#cb144-4226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4227"><a href="#cb144-4227" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb144-4228"><a href="#cb144-4228" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb144-4229"><a href="#cb144-4229" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb144-4230"><a href="#cb144-4230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4231"><a href="#cb144-4231" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb144-4232"><a href="#cb144-4232" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb144-4233"><a href="#cb144-4233" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb144-4234"><a href="#cb144-4234" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(neighbors)]</span>
<span id="cb144-4235"><a href="#cb144-4235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb144-4236"><a href="#cb144-4236" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(neighbors)</span>
<span id="cb144-4237"><a href="#cb144-4237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4238"><a href="#cb144-4238" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb144-4239"><a href="#cb144-4239" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb144-4240"><a href="#cb144-4240" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb144-4241"><a href="#cb144-4241" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb144-4242"><a href="#cb144-4242" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb144-4243"><a href="#cb144-4243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4244"><a href="#cb144-4244" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb144-4245"><a href="#cb144-4245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb144-4246"><a href="#cb144-4246" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb144-4247"><a href="#cb144-4247" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb144-4248"><a href="#cb144-4248" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb144-4249"><a href="#cb144-4249" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb144-4250"><a href="#cb144-4250" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb144-4251"><a href="#cb144-4251" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb144-4252"><a href="#cb144-4252" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb144-4253"><a href="#cb144-4253" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb144-4254"><a href="#cb144-4254" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb144-4255"><a href="#cb144-4255" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb144-4256"><a href="#cb144-4256" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb144-4257"><a href="#cb144-4257" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb144-4258"><a href="#cb144-4258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4259"><a href="#cb144-4259" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb144-4260"><a href="#cb144-4260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb144-4261"><a href="#cb144-4261" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb144-4262"><a href="#cb144-4262" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb144-4263"><a href="#cb144-4263" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb144-4264"><a href="#cb144-4264" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb144-4265"><a href="#cb144-4265" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb144-4266"><a href="#cb144-4266" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb144-4267"><a href="#cb144-4267" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb144-4268"><a href="#cb144-4268" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb144-4269"><a href="#cb144-4269" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb144-4270"><a href="#cb144-4270" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb144-4271"><a href="#cb144-4271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4272"><a href="#cb144-4272" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb144-4273"><a href="#cb144-4273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4274"><a href="#cb144-4274" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb144-4275"><a href="#cb144-4275" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb144-4276"><a href="#cb144-4276" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb144-4277"><a href="#cb144-4277" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 4,5</span></span>
<span id="cb144-4278"><a href="#cb144-4278" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 7</span></span>
<span id="cb144-4279"><a href="#cb144-4279" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 6</span></span>
<span id="cb144-4280"><a href="#cb144-4280" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb144-4281"><a href="#cb144-4281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4282"><a href="#cb144-4282" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb144-4283"><a href="#cb144-4283" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb144-4284"><a href="#cb144-4284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4285"><a href="#cb144-4285" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_maximal_non_branching_paths(adjacency_list)</span>
<span id="cb144-4286"><a href="#cb144-4286" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> result:</span>
<span id="cb144-4287"><a href="#cb144-4287" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">" -&gt; "</span>.join(path))</span>
<span id="cb144-4288"><a href="#cb144-4288" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4289"><a href="#cb144-4289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4290"><a href="#cb144-4290" aria-hidden="true" tabindex="-1"></a><span class="co"># Translate an RNA String into an Amino Acid String</span></span>
<span id="cb144-4291"><a href="#cb144-4291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4292"><a href="#cb144-4292" aria-hidden="true" tabindex="-1"></a>Protein Translation Problem. Translate an&nbsp;[RNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>rna<span class="op">-</span>string<span class="op">/</span>)&nbsp;into an&nbsp;[amino acid string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb144-4293"><a href="#cb144-4293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4294"><a href="#cb144-4294" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An RNA string&nbsp;_Pattern_.</span>
<span id="cb144-4295"><a href="#cb144-4295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4296"><a href="#cb144-4296" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The translation of&nbsp;_Pattern_&nbsp;into an amino acid string&nbsp;_Peptide_.</span>
<span id="cb144-4297"><a href="#cb144-4297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4298"><a href="#cb144-4298" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb144-4299"><a href="#cb144-4299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4300"><a href="#cb144-4300" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4301"><a href="#cb144-4301" aria-hidden="true" tabindex="-1"></a>AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</span>
<span id="cb144-4302"><a href="#cb144-4302" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4303"><a href="#cb144-4303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4304"><a href="#cb144-4304" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb144-4305"><a href="#cb144-4305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4306"><a href="#cb144-4306" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4307"><a href="#cb144-4307" aria-hidden="true" tabindex="-1"></a>MAMAPRTEINSTRING</span>
<span id="cb144-4308"><a href="#cb144-4308" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb144-4309"><a href="#cb144-4309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4310"><a href="#cb144-4310" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb144-4311"><a href="#cb144-4311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4312"><a href="#cb144-4312" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb144-4313"><a href="#cb144-4313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb144-4314"><a href="#cb144-4314" aria-hidden="true" tabindex="-1"></a>```</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>