<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Taeyoon Kim">
<meta name="dcterms.date" content="2024-09-28">

<title>Rosalind Textbook track 문제풀이 – tomorrow-lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-54a3bae54f78c194261bd58cdfbac44f.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-522971af95d0e085e01a2f9638043ec8.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-d6580b36af8345b149954aa0ebf8b540.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-5d805fd313b734e3b464cdf2bd00452d.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-31EWCYNR0V"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-31EWCYNR0V', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<meta name="google-site-verification" content="z2S1Xqj9hfJiC31aNGCnOA1gYpL_8MoZpPI2avrWMvg">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Rosalind Textbook track 문제풀이 – tomorrow-lab">
<meta property="og:description" content="The future of scientific discovery lies at the convergence of computational power and biological complexity. Our mission is to provide a platform where enthusiasts, researchers, and professionals can learn about and contribute to the rapidly evolving fields of bioinformatics, computational biology, and systems biology.">
<meta property="og:image" content="https://tomorrow-lab.github.io/posts/md/Rosalind_textbookTrack.png">
<meta property="og:site_name" content="tomorrow-lab">
<meta property="og:image:height" content="320">
<meta property="og:image:width" content="640">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">tomorrow-lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../book.html"> 
<span class="menu-text">Book</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://partrita.github.io"> <i class="bi bi-sign-do-not-enter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/partrita"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/partrita"> <i class="bi bi-twitter-x" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div style="padding-bottom: 30px;">
    <a href="https://substack.com/@tomorrowlab">
    <img alt="Static Badge" src="https://img.shields.io/badge/EHOTTL%40substack_-FF6719?link=https%3A%2F%2Fsubstack.com%2F%40tomorrowlab">
</a><a href="https://pixi.sh"><img src="https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/prefix-dev/pixi/main/assets/badge/v0.json" alt="Pixi Badge"></a>
    <script async="" src="https://eocampaign1.com/form/2616a818-1ef8-11ef-b372-4587d096212f.js" data-form="2616a818-1ef8-11ef-b372-4587d096212f"></script>
</div>
</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#compute-the-number-of-times-a-pattern-appears-in-a-text" id="toc-compute-the-number-of-times-a-pattern-appears-in-a-text" class="nav-link active" data-scroll-target="#compute-the-number-of-times-a-pattern-appears-in-a-text"><span class="header-section-number">0.1</span> Compute the Number of Times a Pattern Appears in a Text</a></li>
  <li><a href="#sample-dataset" id="toc-sample-dataset" class="nav-link" data-scroll-target="#sample-dataset"><span class="header-section-number">0.2</span> Sample Dataset</a></li>
  <li><a href="#sample-output" id="toc-sample-output" class="nav-link" data-scroll-target="#sample-output"><span class="header-section-number">0.3</span> Sample Output</a></li>
  <li><a href="#solution" id="toc-solution" class="nav-link" data-scroll-target="#solution"><span class="header-section-number">0.4</span> Solution</a></li>
  <li><a href="#find-the-most-frequent-words-in-a-string" id="toc-find-the-most-frequent-words-in-a-string" class="nav-link" data-scroll-target="#find-the-most-frequent-words-in-a-string"><span class="header-section-number">1</span> Find the Most Frequent Words in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-1" id="toc-sample-dataset-1" class="nav-link" data-scroll-target="#sample-dataset-1"><span class="header-section-number">1.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-1" id="toc-sample-output-1" class="nav-link" data-scroll-target="#sample-output-1"><span class="header-section-number">1.2</span> Sample Output</a></li>
  <li><a href="#solution-1" id="toc-solution-1" class="nav-link" data-scroll-target="#solution-1"><span class="header-section-number">1.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-reverse-complement-of-a-string" id="toc-find-the-reverse-complement-of-a-string" class="nav-link" data-scroll-target="#find-the-reverse-complement-of-a-string"><span class="header-section-number">2</span> Find the Reverse Complement of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-2" id="toc-sample-dataset-2" class="nav-link" data-scroll-target="#sample-dataset-2"><span class="header-section-number">2.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-2" id="toc-sample-output-2" class="nav-link" data-scroll-target="#sample-output-2"><span class="header-section-number">2.2</span> Sample Output</a></li>
  <li><a href="#solution-2" id="toc-solution-2" class="nav-link" data-scroll-target="#solution-2"><span class="header-section-number">2.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-occurrences-of-a-pattern-in-a-string" id="toc-find-all-occurrences-of-a-pattern-in-a-string" class="nav-link" data-scroll-target="#find-all-occurrences-of-a-pattern-in-a-string"><span class="header-section-number">3</span> Find All Occurrences of a Pattern in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-3" id="toc-sample-dataset-3" class="nav-link" data-scroll-target="#sample-dataset-3"><span class="header-section-number">3.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-3" id="toc-sample-output-3" class="nav-link" data-scroll-target="#sample-output-3"><span class="header-section-number">3.2</span> Sample Output</a></li>
  <li><a href="#solution-3" id="toc-solution-3" class="nav-link" data-scroll-target="#solution-3"><span class="header-section-number">3.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-patterns-forming-clumps-in-a-string" id="toc-find-patterns-forming-clumps-in-a-string" class="nav-link" data-scroll-target="#find-patterns-forming-clumps-in-a-string"><span class="header-section-number">4</span> Find Patterns Forming Clumps in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-4" id="toc-sample-dataset-4" class="nav-link" data-scroll-target="#sample-dataset-4"><span class="header-section-number">4.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-4" id="toc-sample-output-4" class="nav-link" data-scroll-target="#sample-output-4"><span class="header-section-number">4.2</span> Sample Output</a></li>
  <li><a href="#solution-4" id="toc-solution-4" class="nav-link" data-scroll-target="#solution-4"><span class="header-section-number">4.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-position-in-a-genome-minimizing-the-skew" id="toc-find-a-position-in-a-genome-minimizing-the-skew" class="nav-link" data-scroll-target="#find-a-position-in-a-genome-minimizing-the-skew"><span class="header-section-number">5</span> Find a Position in a Genome Minimizing the Skew</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-5" id="toc-sample-dataset-5" class="nav-link" data-scroll-target="#sample-dataset-5"><span class="header-section-number">5.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-5" id="toc-sample-output-5" class="nav-link" data-scroll-target="#sample-output-5"><span class="header-section-number">5.2</span> Sample Output</a></li>
  <li><a href="#solution-5" id="toc-solution-5" class="nav-link" data-scroll-target="#solution-5"><span class="header-section-number">5.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-hamming-distance-between-two-strings" id="toc-compute-the-hamming-distance-between-two-strings" class="nav-link" data-scroll-target="#compute-the-hamming-distance-between-two-strings"><span class="header-section-number">6</span> Compute the Hamming Distance Between Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-6" id="toc-sample-dataset-6" class="nav-link" data-scroll-target="#sample-dataset-6"><span class="header-section-number">6.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-6" id="toc-sample-output-6" class="nav-link" data-scroll-target="#sample-output-6"><span class="header-section-number">6.2</span> Sample Output</a></li>
  <li><a href="#solution-6" id="toc-solution-6" class="nav-link" data-scroll-target="#solution-6"><span class="header-section-number">6.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-approximate-occurrences-of-a-pattern-in-a-string" id="toc-find-all-approximate-occurrences-of-a-pattern-in-a-string" class="nav-link" data-scroll-target="#find-all-approximate-occurrences-of-a-pattern-in-a-string"><span class="header-section-number">7</span> Find All Approximate Occurrences of a Pattern in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-7" id="toc-sample-dataset-7" class="nav-link" data-scroll-target="#sample-dataset-7"><span class="header-section-number">7.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-7" id="toc-sample-output-7" class="nav-link" data-scroll-target="#sample-output-7"><span class="header-section-number">7.2</span> Sample Output</a></li>
  <li><a href="#solution-7" id="toc-solution-7" class="nav-link" data-scroll-target="#solution-7"><span class="header-section-number">7.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-most-frequent-words-with-mismatches-in-a-string" id="toc-find-the-most-frequent-words-with-mismatches-in-a-string" class="nav-link" data-scroll-target="#find-the-most-frequent-words-with-mismatches-in-a-string"><span class="header-section-number">8</span> Find the Most Frequent Words with Mismatches in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-8" id="toc-sample-dataset-8" class="nav-link" data-scroll-target="#sample-dataset-8"><span class="header-section-number">8.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-8" id="toc-sample-output-8" class="nav-link" data-scroll-target="#sample-output-8"><span class="header-section-number">8.2</span> Sample Output</a></li>
  <li><a href="#solution-8" id="toc-solution-8" class="nav-link" data-scroll-target="#solution-8"><span class="header-section-number">8.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-frequent-words-with-mismatches-and-reverse-complements" id="toc-find-frequent-words-with-mismatches-and-reverse-complements" class="nav-link" data-scroll-target="#find-frequent-words-with-mismatches-and-reverse-complements"><span class="header-section-number">9</span> Find Frequent Words with Mismatches and Reverse Complements</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-9" id="toc-sample-dataset-9" class="nav-link" data-scroll-target="#sample-dataset-9"><span class="header-section-number">9.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-9" id="toc-sample-output-9" class="nav-link" data-scroll-target="#sample-output-9"><span class="header-section-number">9.2</span> Sample Output</a></li>
  <li><a href="#solution-9" id="toc-solution-9" class="nav-link" data-scroll-target="#solution-9"><span class="header-section-number">9.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-frequency-array-of-a-string" id="toc-generate-the-frequency-array-of-a-string" class="nav-link" data-scroll-target="#generate-the-frequency-array-of-a-string"><span class="header-section-number">10</span> Generate the Frequency Array of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-10" id="toc-sample-dataset-10" class="nav-link" data-scroll-target="#sample-dataset-10"><span class="header-section-number">10.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-10" id="toc-sample-output-10" class="nav-link" data-scroll-target="#sample-output-10"><span class="header-section-number">10.2</span> Sample Output</a></li>
  <li><a href="#solution-10" id="toc-solution-10" class="nav-link" data-scroll-target="#solution-10"><span class="header-section-number">10.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-patterntonumber" id="toc-implement-patterntonumber" class="nav-link" data-scroll-target="#implement-patterntonumber"><span class="header-section-number">11</span> Implement PatternToNumber</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-11" id="toc-sample-dataset-11" class="nav-link" data-scroll-target="#sample-dataset-11"><span class="header-section-number">11.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-11" id="toc-sample-output-11" class="nav-link" data-scroll-target="#sample-output-11"><span class="header-section-number">11.2</span> Sample Output</a></li>
  <li><a href="#solution-11" id="toc-solution-11" class="nav-link" data-scroll-target="#solution-11"><span class="header-section-number">11.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-numbertopattern" id="toc-implement-numbertopattern" class="nav-link" data-scroll-target="#implement-numbertopattern"><span class="header-section-number">12</span> Implement NumberToPattern</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-12" id="toc-sample-dataset-12" class="nav-link" data-scroll-target="#sample-dataset-12"><span class="header-section-number">12.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-12" id="toc-sample-output-12" class="nav-link" data-scroll-target="#sample-output-12"><span class="header-section-number">12.2</span> Sample Output</a></li>
  <li><a href="#solution-12" id="toc-solution-12" class="nav-link" data-scroll-target="#solution-12"><span class="header-section-number">12.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-d-neighborhood-of-a-string" id="toc-generate-the-d-neighborhood-of-a-string" class="nav-link" data-scroll-target="#generate-the-d-neighborhood-of-a-string"><span class="header-section-number">13</span> Generate the d-Neighborhood of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-13" id="toc-sample-dataset-13" class="nav-link" data-scroll-target="#sample-dataset-13"><span class="header-section-number">13.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-13" id="toc-sample-output-13" class="nav-link" data-scroll-target="#sample-output-13"><span class="header-section-number">13.2</span> Sample Output</a></li>
  <li><a href="#solution-13" id="toc-solution-13" class="nav-link" data-scroll-target="#solution-13"><span class="header-section-number">13.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-motifenumeration" id="toc-implement-motifenumeration" class="nav-link" data-scroll-target="#implement-motifenumeration"><span class="header-section-number">14</span> Implement MotifEnumeration</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-14" id="toc-sample-dataset-14" class="nav-link" data-scroll-target="#sample-dataset-14"><span class="header-section-number">14.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-14" id="toc-sample-output-14" class="nav-link" data-scroll-target="#sample-output-14"><span class="header-section-number">14.2</span> Sample Output</a></li>
  <li><a href="#solution-14" id="toc-solution-14" class="nav-link" data-scroll-target="#solution-14"><span class="header-section-number">14.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-median-string" id="toc-find-a-median-string" class="nav-link" data-scroll-target="#find-a-median-string"><span class="header-section-number">15</span> Find a Median String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-15" id="toc-sample-dataset-15" class="nav-link" data-scroll-target="#sample-dataset-15"><span class="header-section-number">15.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-15" id="toc-sample-output-15" class="nav-link" data-scroll-target="#sample-output-15"><span class="header-section-number">15.2</span> Sample Output</a></li>
  <li><a href="#solution-15" id="toc-solution-15" class="nav-link" data-scroll-target="#solution-15"><span class="header-section-number">15.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-profile-most-probable-k-mer-in-a-string" id="toc-find-a-profile-most-probable-k-mer-in-a-string" class="nav-link" data-scroll-target="#find-a-profile-most-probable-k-mer-in-a-string"><span class="header-section-number">16</span> Find a Profile-most Probable k-mer in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-16" id="toc-sample-dataset-16" class="nav-link" data-scroll-target="#sample-dataset-16"><span class="header-section-number">16.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-16" id="toc-sample-output-16" class="nav-link" data-scroll-target="#sample-output-16"><span class="header-section-number">16.2</span> Sample Output</a></li>
  <li><a href="#solution-16" id="toc-solution-16" class="nav-link" data-scroll-target="#solution-16"><span class="header-section-number">16.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedymotifsearch" id="toc-implement-greedymotifsearch" class="nav-link" data-scroll-target="#implement-greedymotifsearch"><span class="header-section-number">17</span> Implement GreedyMotifSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-17" id="toc-sample-dataset-17" class="nav-link" data-scroll-target="#sample-dataset-17"><span class="header-section-number">17.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-17" id="toc-sample-output-17" class="nav-link" data-scroll-target="#sample-output-17"><span class="header-section-number">17.2</span> Sample Output</a></li>
  <li><a href="#solution-17" id="toc-solution-17" class="nav-link" data-scroll-target="#solution-17"><span class="header-section-number">17.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedymotifsearch-with-pseudocounts" id="toc-implement-greedymotifsearch-with-pseudocounts" class="nav-link" data-scroll-target="#implement-greedymotifsearch-with-pseudocounts"><span class="header-section-number">18</span> Implement GreedyMotifSearch with Pseudocounts</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-18" id="toc-sample-dataset-18" class="nav-link" data-scroll-target="#sample-dataset-18"><span class="header-section-number">18.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-18" id="toc-sample-output-18" class="nav-link" data-scroll-target="#sample-output-18"><span class="header-section-number">18.2</span> Sample Output</a></li>
  <li><a href="#solution-18" id="toc-solution-18" class="nav-link" data-scroll-target="#solution-18"><span class="header-section-number">18.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-randomizedmotifsearch" id="toc-implement-randomizedmotifsearch" class="nav-link" data-scroll-target="#implement-randomizedmotifsearch"><span class="header-section-number">19</span> Implement RandomizedMotifSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-19" id="toc-sample-dataset-19" class="nav-link" data-scroll-target="#sample-dataset-19"><span class="header-section-number">19.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-19" id="toc-sample-output-19" class="nav-link" data-scroll-target="#sample-output-19"><span class="header-section-number">19.2</span> Sample Output</a></li>
  <li><a href="#solution-19" id="toc-solution-19" class="nav-link" data-scroll-target="#solution-19"><span class="header-section-number">19.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-gibbssampler" id="toc-implement-gibbssampler" class="nav-link" data-scroll-target="#implement-gibbssampler"><span class="header-section-number">20</span> Implement GibbsSampler</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-20" id="toc-sample-dataset-20" class="nav-link" data-scroll-target="#sample-dataset-20"><span class="header-section-number">20.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-20" id="toc-sample-output-20" class="nav-link" data-scroll-target="#sample-output-20"><span class="header-section-number">20.2</span> Sample Output</a></li>
  <li><a href="#solution-20" id="toc-solution-20" class="nav-link" data-scroll-target="#solution-20"><span class="header-section-number">20.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-distancebetweenpatternandstrings" id="toc-implement-distancebetweenpatternandstrings" class="nav-link" data-scroll-target="#implement-distancebetweenpatternandstrings"><span class="header-section-number">21</span> Implement DistanceBetweenPatternAndStrings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-21" id="toc-sample-dataset-21" class="nav-link" data-scroll-target="#sample-dataset-21"><span class="header-section-number">21.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-21" id="toc-sample-output-21" class="nav-link" data-scroll-target="#sample-output-21"><span class="header-section-number">21.2</span> Sample Output</a></li>
  <li><a href="#solution-21" id="toc-solution-21" class="nav-link" data-scroll-target="#solution-21"><span class="header-section-number">21.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-k-mer-composition-of-a-string" id="toc-generate-the-k-mer-composition-of-a-string" class="nav-link" data-scroll-target="#generate-the-k-mer-composition-of-a-string"><span class="header-section-number">22</span> Generate the k-mer Composition of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-22" id="toc-sample-dataset-22" class="nav-link" data-scroll-target="#sample-dataset-22"><span class="header-section-number">22.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-22" id="toc-sample-output-22" class="nav-link" data-scroll-target="#sample-output-22"><span class="header-section-number">22.2</span> Sample Output</a></li>
  <li><a href="#solution-22" id="toc-solution-22" class="nav-link" data-scroll-target="#solution-22"><span class="header-section-number">22.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-genome-path" id="toc-reconstruct-a-string-from-its-genome-path" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-genome-path"><span class="header-section-number">23</span> Reconstruct a String from its Genome Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-23" id="toc-sample-dataset-23" class="nav-link" data-scroll-target="#sample-dataset-23"><span class="header-section-number">23.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-23" id="toc-sample-output-23" class="nav-link" data-scroll-target="#sample-output-23"><span class="header-section-number">23.2</span> Sample Output</a></li>
  <li><a href="#solution-23" id="toc-solution-23" class="nav-link" data-scroll-target="#solution-23"><span class="header-section-number">23.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-overlap-graph-of-a-collection-of-k-mers" id="toc-construct-the-overlap-graph-of-a-collection-of-k-mers" class="nav-link" data-scroll-target="#construct-the-overlap-graph-of-a-collection-of-k-mers"><span class="header-section-number">24</span> Construct the Overlap Graph of a Collection of k-mers</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-24" id="toc-sample-dataset-24" class="nav-link" data-scroll-target="#sample-dataset-24"><span class="header-section-number">24.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-24" id="toc-sample-output-24" class="nav-link" data-scroll-target="#sample-output-24"><span class="header-section-number">24.2</span> Sample Output</a></li>
  <li><a href="#solution-24" id="toc-solution-24" class="nav-link" data-scroll-target="#solution-24"><span class="header-section-number">24.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-de-bruijn-graph-of-a-string" id="toc-construct-the-de-bruijn-graph-of-a-string" class="nav-link" data-scroll-target="#construct-the-de-bruijn-graph-of-a-string"><span class="header-section-number">25</span> Construct the De Bruijn Graph of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-25" id="toc-sample-dataset-25" class="nav-link" data-scroll-target="#sample-dataset-25"><span class="header-section-number">25.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-25" id="toc-sample-output-25" class="nav-link" data-scroll-target="#sample-output-25"><span class="header-section-number">25.2</span> Sample Output</a></li>
  <li><a href="#solution-25" id="toc-solution-25" class="nav-link" data-scroll-target="#solution-25"><span class="header-section-number">25.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-de-bruijn-graph-of-a-collection-of-k-mers" id="toc-construct-the-de-bruijn-graph-of-a-collection-of-k-mers" class="nav-link" data-scroll-target="#construct-the-de-bruijn-graph-of-a-collection-of-k-mers"><span class="header-section-number">26</span> Construct the De Bruijn Graph of a Collection of k-mers</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-26" id="toc-sample-dataset-26" class="nav-link" data-scroll-target="#sample-dataset-26"><span class="header-section-number">26.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-26" id="toc-sample-output-26" class="nav-link" data-scroll-target="#sample-output-26"><span class="header-section-number">26.2</span> Sample Output</a></li>
  <li><a href="#solution-26" id="toc-solution-26" class="nav-link" data-scroll-target="#solution-26"><span class="header-section-number">26.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-an-eulerian-cycle-in-a-graph" id="toc-find-an-eulerian-cycle-in-a-graph" class="nav-link" data-scroll-target="#find-an-eulerian-cycle-in-a-graph"><span class="header-section-number">27</span> Find an Eulerian Cycle in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-27" id="toc-sample-dataset-27" class="nav-link" data-scroll-target="#sample-dataset-27"><span class="header-section-number">27.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-27" id="toc-sample-output-27" class="nav-link" data-scroll-target="#sample-output-27"><span class="header-section-number">27.2</span> Sample Output</a></li>
  <li><a href="#solution-27" id="toc-solution-27" class="nav-link" data-scroll-target="#solution-27"><span class="header-section-number">27.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-an-eulerian-path-in-a-graph" id="toc-find-an-eulerian-path-in-a-graph" class="nav-link" data-scroll-target="#find-an-eulerian-path-in-a-graph"><span class="header-section-number">28</span> Find an Eulerian Path in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-28" id="toc-sample-dataset-28" class="nav-link" data-scroll-target="#sample-dataset-28"><span class="header-section-number">28.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-28" id="toc-sample-output-28" class="nav-link" data-scroll-target="#sample-output-28"><span class="header-section-number">28.2</span> Sample Output</a></li>
  <li><a href="#solution-28" id="toc-solution-28" class="nav-link" data-scroll-target="#solution-28"><span class="header-section-number">28.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-k-mer-composition" id="toc-reconstruct-a-string-from-its-k-mer-composition" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-k-mer-composition"><span class="header-section-number">29</span> Reconstruct a String from its k-mer Composition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-29" id="toc-sample-dataset-29" class="nav-link" data-scroll-target="#sample-dataset-29"><span class="header-section-number">29.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-29" id="toc-sample-output-29" class="nav-link" data-scroll-target="#sample-output-29"><span class="header-section-number">29.2</span> Sample Output</a></li>
  <li><a href="#solution-29" id="toc-solution-29" class="nav-link" data-scroll-target="#solution-29"><span class="header-section-number">29.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-k-universal-circular-string" id="toc-find-a-k-universal-circular-string" class="nav-link" data-scroll-target="#find-a-k-universal-circular-string"><span class="header-section-number">30</span> Find a k-Universal Circular String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-30" id="toc-sample-dataset-30" class="nav-link" data-scroll-target="#sample-dataset-30"><span class="header-section-number">30.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-30" id="toc-sample-output-30" class="nav-link" data-scroll-target="#sample-output-30"><span class="header-section-number">30.2</span> Sample Output</a></li>
  <li><a href="#solution-30" id="toc-solution-30" class="nav-link" data-scroll-target="#solution-30"><span class="header-section-number">30.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-paired-composition" id="toc-reconstruct-a-string-from-its-paired-composition" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-paired-composition"><span class="header-section-number">31</span> Reconstruct a String from its Paired Composition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-31" id="toc-sample-dataset-31" class="nav-link" data-scroll-target="#sample-dataset-31"><span class="header-section-number">31.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-31" id="toc-sample-output-31" class="nav-link" data-scroll-target="#sample-output-31"><span class="header-section-number">31.2</span> Sample Output</a></li>
  <li><a href="#solution-31" id="toc-solution-31" class="nav-link" data-scroll-target="#solution-31"><span class="header-section-number">31.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-contigs-from-a-collection-of-reads" id="toc-generate-contigs-from-a-collection-of-reads" class="nav-link" data-scroll-target="#generate-contigs-from-a-collection-of-reads"><span class="header-section-number">32</span> Generate Contigs from a Collection of Reads</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-32" id="toc-sample-dataset-32" class="nav-link" data-scroll-target="#sample-dataset-32"><span class="header-section-number">32.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-32" id="toc-sample-output-32" class="nav-link" data-scroll-target="#sample-output-32"><span class="header-section-number">32.2</span> Sample Output</a></li>
  <li><a href="#solution-32" id="toc-solution-32" class="nav-link" data-scroll-target="#solution-32"><span class="header-section-number">32.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-string-spelled-by-a-gapped-genome-path" id="toc-construct-a-string-spelled-by-a-gapped-genome-path" class="nav-link" data-scroll-target="#construct-a-string-spelled-by-a-gapped-genome-path"><span class="header-section-number">33</span> Construct a String Spelled by a Gapped Genome Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-33" id="toc-sample-dataset-33" class="nav-link" data-scroll-target="#sample-dataset-33"><span class="header-section-number">33.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-33" id="toc-sample-output-33" class="nav-link" data-scroll-target="#sample-output-33"><span class="header-section-number">33.2</span> Sample Output</a></li>
  <li><a href="#solution-33" id="toc-solution-33" class="nav-link" data-scroll-target="#solution-33"><span class="header-section-number">33.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-all-maximal-non-branching-paths-in-a-graph" id="toc-generate-all-maximal-non-branching-paths-in-a-graph" class="nav-link" data-scroll-target="#generate-all-maximal-non-branching-paths-in-a-graph"><span class="header-section-number">34</span> Generate All Maximal Non-Branching Paths in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-34" id="toc-sample-dataset-34" class="nav-link" data-scroll-target="#sample-dataset-34"><span class="header-section-number">34.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-34" id="toc-sample-output-34" class="nav-link" data-scroll-target="#sample-output-34"><span class="header-section-number">34.2</span> Sample Output</a></li>
  <li><a href="#solution-34" id="toc-solution-34" class="nav-link" data-scroll-target="#solution-34"><span class="header-section-number">34.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#translate-an-rna-string-into-an-amino-acid-string" id="toc-translate-an-rna-string-into-an-amino-acid-string" class="nav-link" data-scroll-target="#translate-an-rna-string-into-an-amino-acid-string"><span class="header-section-number">35</span> Translate an RNA String into an Amino Acid String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-35" id="toc-sample-dataset-35" class="nav-link" data-scroll-target="#sample-dataset-35"><span class="header-section-number">35.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-35" id="toc-sample-output-35" class="nav-link" data-scroll-target="#sample-output-35"><span class="header-section-number">35.2</span> Sample Output</a></li>
  <li><a href="#solution-35" id="toc-solution-35" class="nav-link" data-scroll-target="#solution-35"><span class="header-section-number">35.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-substrings-of-a-genome-encoding-a-given-amino-acid-string" id="toc-find-substrings-of-a-genome-encoding-a-given-amino-acid-string" class="nav-link" data-scroll-target="#find-substrings-of-a-genome-encoding-a-given-amino-acid-string"><span class="header-section-number">36</span> Find Substrings of a Genome Encoding a Given Amino Acid String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-36" id="toc-sample-dataset-36" class="nav-link" data-scroll-target="#sample-dataset-36"><span class="header-section-number">36.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-36" id="toc-sample-output-36" class="nav-link" data-scroll-target="#sample-output-36"><span class="header-section-number">36.2</span> Sample Output</a></li>
  <li><a href="#solution-36" id="toc-solution-36" class="nav-link" data-scroll-target="#solution-36"><span class="header-section-number">36.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-theoretical-spectrum-of-a-cyclic-peptide" id="toc-generate-the-theoretical-spectrum-of-a-cyclic-peptide" class="nav-link" data-scroll-target="#generate-the-theoretical-spectrum-of-a-cyclic-peptide"><span class="header-section-number">37</span> Generate the Theoretical Spectrum of a Cyclic Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-37" id="toc-sample-dataset-37" class="nav-link" data-scroll-target="#sample-dataset-37"><span class="header-section-number">37.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-37" id="toc-sample-output-37" class="nav-link" data-scroll-target="#sample-output-37"><span class="header-section-number">37.2</span> Sample Output</a></li>
  <li><a href="#solution-37" id="toc-solution-37" class="nav-link" data-scroll-target="#solution-37"><span class="header-section-number">37.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-number-of-peptides-of-given-total-mass" id="toc-compute-the-number-of-peptides-of-given-total-mass" class="nav-link" data-scroll-target="#compute-the-number-of-peptides-of-given-total-mass"><span class="header-section-number">38</span> Compute the Number of Peptides of Given Total Mass</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-38" id="toc-sample-dataset-38" class="nav-link" data-scroll-target="#sample-dataset-38"><span class="header-section-number">38.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-38" id="toc-sample-output-38" class="nav-link" data-scroll-target="#sample-output-38"><span class="header-section-number">38.2</span> Sample Output</a></li>
  <li><a href="#solution-38" id="toc-solution-38" class="nav-link" data-scroll-target="#solution-38"><span class="header-section-number">38.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum" id="toc-find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum" class="nav-link" data-scroll-target="#find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum"><span class="header-section-number">39</span> Find a Cyclic Peptide with Theoretical Spectrum Matching an Ideal Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-39" id="toc-sample-dataset-39" class="nav-link" data-scroll-target="#sample-dataset-39"><span class="header-section-number">39.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-39" id="toc-sample-output-39" class="nav-link" data-scroll-target="#sample-output-39"><span class="header-section-number">39.2</span> Sample Output</a></li>
  <li><a href="#solution-39" id="toc-solution-39" class="nav-link" data-scroll-target="#solution-39"><span class="header-section-number">39.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-score-of-a-cyclic-peptide-against-a-spectrum" id="toc-compute-the-score-of-a-cyclic-peptide-against-a-spectrum" class="nav-link" data-scroll-target="#compute-the-score-of-a-cyclic-peptide-against-a-spectrum"><span class="header-section-number">40</span> Compute the Score of a Cyclic Peptide Against a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-40" id="toc-sample-dataset-40" class="nav-link" data-scroll-target="#sample-dataset-40"><span class="header-section-number">40.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-40" id="toc-sample-output-40" class="nav-link" data-scroll-target="#sample-output-40"><span class="header-section-number">40.2</span> Sample Output</a></li>
  <li><a href="#solution-40" id="toc-solution-40" class="nav-link" data-scroll-target="#solution-40"><span class="header-section-number">40.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-leaderboardcyclopeptidesequencing" id="toc-implement-leaderboardcyclopeptidesequencing" class="nav-link" data-scroll-target="#implement-leaderboardcyclopeptidesequencing"><span class="header-section-number">41</span> Implement LeaderboardCyclopeptideSequencing</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-41" id="toc-sample-dataset-41" class="nav-link" data-scroll-target="#sample-dataset-41"><span class="header-section-number">41.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-41" id="toc-sample-output-41" class="nav-link" data-scroll-target="#sample-output-41"><span class="header-section-number">41.2</span> Sample Output</a></li>
  <li><a href="#solution-41" id="toc-solution-41" class="nav-link" data-scroll-target="#solution-41"><span class="header-section-number">41.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-convolution-of-a-spectrum" id="toc-generate-the-convolution-of-a-spectrum" class="nav-link" data-scroll-target="#generate-the-convolution-of-a-spectrum"><span class="header-section-number">42</span> Generate the Convolution of a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-42" id="toc-sample-dataset-42" class="nav-link" data-scroll-target="#sample-dataset-42"><span class="header-section-number">42.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-42" id="toc-sample-output-42" class="nav-link" data-scroll-target="#sample-output-42"><span class="header-section-number">42.2</span> Sample Output</a></li>
  <li><a href="#solution-42" id="toc-solution-42" class="nav-link" data-scroll-target="#solution-42"><span class="header-section-number">42.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-convolutioncyclopeptidesequencing" id="toc-implement-convolutioncyclopeptidesequencing" class="nav-link" data-scroll-target="#implement-convolutioncyclopeptidesequencing"><span class="header-section-number">43</span> Implement ConvolutionCyclopeptideSequencing</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-43" id="toc-sample-dataset-43" class="nav-link" data-scroll-target="#sample-dataset-43"><span class="header-section-number">43.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-43" id="toc-sample-output-43" class="nav-link" data-scroll-target="#sample-output-43"><span class="header-section-number">43.2</span> Sample Output</a></li>
  <li><a href="#solution-43" id="toc-solution-43" class="nav-link" data-scroll-target="#solution-43"><span class="header-section-number">43.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-theoretical-spectrum-of-a-linear-peptide" id="toc-generate-the-theoretical-spectrum-of-a-linear-peptide" class="nav-link" data-scroll-target="#generate-the-theoretical-spectrum-of-a-linear-peptide"><span class="header-section-number">44</span> Generate the Theoretical Spectrum of a Linear Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-44" id="toc-sample-dataset-44" class="nav-link" data-scroll-target="#sample-dataset-44"><span class="header-section-number">44.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-44" id="toc-sample-output-44" class="nav-link" data-scroll-target="#sample-output-44"><span class="header-section-number">44.2</span> Sample Output</a></li>
  <li><a href="#solution-44" id="toc-solution-44" class="nav-link" data-scroll-target="#solution-44"><span class="header-section-number">44.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-score-of-a-linear-peptide" id="toc-compute-the-score-of-a-linear-peptide" class="nav-link" data-scroll-target="#compute-the-score-of-a-linear-peptide"><span class="header-section-number">45</span> Compute the Score of a Linear Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-45" id="toc-sample-dataset-45" class="nav-link" data-scroll-target="#sample-dataset-45"><span class="header-section-number">45.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-45" id="toc-sample-output-45" class="nav-link" data-scroll-target="#sample-output-45"><span class="header-section-number">45.2</span> Sample Output</a></li>
  <li><a href="#solution-45" id="toc-solution-45" class="nav-link" data-scroll-target="#solution-45"><span class="header-section-number">45.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#trim-a-peptide-leaderboard" id="toc-trim-a-peptide-leaderboard" class="nav-link" data-scroll-target="#trim-a-peptide-leaderboard"><span class="header-section-number">46</span> Trim a Peptide Leaderboard</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-46" id="toc-sample-dataset-46" class="nav-link" data-scroll-target="#sample-dataset-46"><span class="header-section-number">46.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-46" id="toc-sample-output-46" class="nav-link" data-scroll-target="#sample-output-46"><span class="header-section-number">46.2</span> Sample Output</a></li>
  <li><a href="#solution-46" id="toc-solution-46" class="nav-link" data-scroll-target="#solution-46"><span class="header-section-number">46.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#solve-the-turnpike-problem" id="toc-solve-the-turnpike-problem" class="nav-link" data-scroll-target="#solve-the-turnpike-problem"><span class="header-section-number">47</span> Solve the Turnpike Problem</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-47" id="toc-sample-dataset-47" class="nav-link" data-scroll-target="#sample-dataset-47"><span class="header-section-number">47.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-47" id="toc-sample-output-47" class="nav-link" data-scroll-target="#sample-output-47"><span class="header-section-number">47.2</span> Sample Output</a></li>
  <li><a href="#solution-47" id="toc-solution-47" class="nav-link" data-scroll-target="#solution-47"><span class="header-section-number">47.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-minimum-number-of-coins-needed-to-make-change" id="toc-find-the-minimum-number-of-coins-needed-to-make-change" class="nav-link" data-scroll-target="#find-the-minimum-number-of-coins-needed-to-make-change"><span class="header-section-number">48</span> Find the Minimum Number of Coins Needed to Make Change</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-48" id="toc-sample-dataset-48" class="nav-link" data-scroll-target="#sample-dataset-48"><span class="header-section-number">48.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-48" id="toc-sample-output-48" class="nav-link" data-scroll-target="#sample-output-48"><span class="header-section-number">48.2</span> Sample Output</a></li>
  <li><a href="#solution-48" id="toc-solution-48" class="nav-link" data-scroll-target="#solution-48"><span class="header-section-number">48.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-length-of-a-longest-path-in-a-manhattan-like-grid" id="toc-find-the-length-of-a-longest-path-in-a-manhattan-like-grid" class="nav-link" data-scroll-target="#find-the-length-of-a-longest-path-in-a-manhattan-like-grid"><span class="header-section-number">49</span> Find the Length of a Longest Path in a Manhattan-like Grid</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-49" id="toc-sample-dataset-49" class="nav-link" data-scroll-target="#sample-dataset-49"><span class="header-section-number">49.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-49" id="toc-sample-output-49" class="nav-link" data-scroll-target="#sample-output-49"><span class="header-section-number">49.2</span> Sample Output</a></li>
  <li><a href="#solution-49" id="toc-solution-49" class="nav-link" data-scroll-target="#solution-49"><span class="header-section-number">49.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-longest-common-subsequence-of-two-strings" id="toc-find-a-longest-common-subsequence-of-two-strings" class="nav-link" data-scroll-target="#find-a-longest-common-subsequence-of-two-strings"><span class="header-section-number">50</span> Find a Longest Common Subsequence of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-50" id="toc-sample-dataset-50" class="nav-link" data-scroll-target="#sample-dataset-50"><span class="header-section-number">50.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-50" id="toc-sample-output-50" class="nav-link" data-scroll-target="#sample-output-50"><span class="header-section-number">50.2</span> Sample Output</a></li>
  <li><a href="#solution-50" id="toc-solution-50" class="nav-link" data-scroll-target="#solution-50"><span class="header-section-number">50.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-longest-path-in-a-dag" id="toc-find-the-longest-path-in-a-dag" class="nav-link" data-scroll-target="#find-the-longest-path-in-a-dag"><span class="header-section-number">51</span> Find the Longest Path in a DAG</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-51" id="toc-sample-dataset-51" class="nav-link" data-scroll-target="#sample-dataset-51"><span class="header-section-number">51.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-51" id="toc-sample-output-51" class="nav-link" data-scroll-target="#sample-output-51"><span class="header-section-number">51.2</span> Sample Output</a></li>
  <li><a href="#solution-51" id="toc-solution-51" class="nav-link" data-scroll-target="#solution-51"><span class="header-section-number">51.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-alignment-of-two-strings" id="toc-find-a-highest-scoring-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-alignment-of-two-strings"><span class="header-section-number">52</span> Find a Highest-Scoring Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-52" id="toc-sample-dataset-52" class="nav-link" data-scroll-target="#sample-dataset-52"><span class="header-section-number">52.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-52" id="toc-sample-output-52" class="nav-link" data-scroll-target="#sample-output-52"><span class="header-section-number">52.2</span> Sample Output</a></li>
  <li><a href="#solution-52" id="toc-solution-52" class="nav-link" data-scroll-target="#solution-52"><span class="header-section-number">52.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-local-alignment-of-two-strings" id="toc-find-a-highest-scoring-local-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-local-alignment-of-two-strings"><span class="header-section-number">53</span> Find a Highest-Scoring Local Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-53" id="toc-sample-dataset-53" class="nav-link" data-scroll-target="#sample-dataset-53"><span class="header-section-number">53.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-53" id="toc-sample-output-53" class="nav-link" data-scroll-target="#sample-output-53"><span class="header-section-number">53.2</span> Sample Output</a></li>
  <li><a href="#solution-53" id="toc-solution-53" class="nav-link" data-scroll-target="#solution-53"><span class="header-section-number">53.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-edit-distance-between-two-strings" id="toc-compute-the-edit-distance-between-two-strings" class="nav-link" data-scroll-target="#compute-the-edit-distance-between-two-strings"><span class="header-section-number">54</span> Compute the Edit Distance Between Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-54" id="toc-sample-dataset-54" class="nav-link" data-scroll-target="#sample-dataset-54"><span class="header-section-number">54.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-54" id="toc-sample-output-54" class="nav-link" data-scroll-target="#sample-output-54"><span class="header-section-number">54.2</span> Sample Output</a></li>
  <li><a href="#solution-54" id="toc-solution-54" class="nav-link" data-scroll-target="#solution-54"><span class="header-section-number">54.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-fitting-alignment-of-two-strings" id="toc-find-a-highest-scoring-fitting-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-fitting-alignment-of-two-strings"><span class="header-section-number">55</span> Find a Highest-Scoring Fitting Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-55" id="toc-sample-dataset-55" class="nav-link" data-scroll-target="#sample-dataset-55"><span class="header-section-number">55.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-55" id="toc-sample-output-55" class="nav-link" data-scroll-target="#sample-output-55"><span class="header-section-number">55.2</span> Sample Output</a></li>
  <li><a href="#solution-55" id="toc-solution-55" class="nav-link" data-scroll-target="#solution-55"><span class="header-section-number">55.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-overlap-alignment-of-two-strings" id="toc-find-a-highest-scoring-overlap-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-overlap-alignment-of-two-strings"><span class="header-section-number">56</span> Find a Highest-Scoring Overlap Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-56" id="toc-sample-dataset-56" class="nav-link" data-scroll-target="#sample-dataset-56"><span class="header-section-number">56.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-56" id="toc-sample-output-56" class="nav-link" data-scroll-target="#sample-output-56"><span class="header-section-number">56.2</span> Sample Output</a></li>
  <li><a href="#solution-56" id="toc-solution-56" class="nav-link" data-scroll-target="#solution-56"><span class="header-section-number">56.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#align-two-strings-using-affine-gap-penalties" id="toc-align-two-strings-using-affine-gap-penalties" class="nav-link" data-scroll-target="#align-two-strings-using-affine-gap-penalties"><span class="header-section-number">57</span> Align Two Strings Using Affine Gap Penalties</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-57" id="toc-sample-dataset-57" class="nav-link" data-scroll-target="#sample-dataset-57"><span class="header-section-number">57.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-57" id="toc-sample-output-57" class="nav-link" data-scroll-target="#sample-output-57"><span class="header-section-number">57.2</span> Sample Output</a></li>
  <li><a href="#solution-57" id="toc-solution-57" class="nav-link" data-scroll-target="#solution-57"><span class="header-section-number">57.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-middle-edge-in-an-alignment-graph-in-linear-space" id="toc-find-a-middle-edge-in-an-alignment-graph-in-linear-space" class="nav-link" data-scroll-target="#find-a-middle-edge-in-an-alignment-graph-in-linear-space"><span class="header-section-number">58</span> Find a Middle Edge in an Alignment Graph in Linear Space</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-58" id="toc-sample-dataset-58" class="nav-link" data-scroll-target="#sample-dataset-58"><span class="header-section-number">58.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-58" id="toc-sample-output-58" class="nav-link" data-scroll-target="#sample-output-58"><span class="header-section-number">58.2</span> Sample Output</a></li>
  <li><a href="#solution-58" id="toc-solution-58" class="nav-link" data-scroll-target="#solution-58"><span class="header-section-number">58.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#align-two-strings-using-linear-space" id="toc-align-two-strings-using-linear-space" class="nav-link" data-scroll-target="#align-two-strings-using-linear-space"><span class="header-section-number">59</span> Align Two Strings Using Linear Space</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-59" id="toc-sample-dataset-59" class="nav-link" data-scroll-target="#sample-dataset-59"><span class="header-section-number">59.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-59" id="toc-sample-output-59" class="nav-link" data-scroll-target="#sample-output-59"><span class="header-section-number">59.2</span> Sample Output</a></li>
  <li><a href="#solution-59" id="toc-solution-59" class="nav-link" data-scroll-target="#solution-59"><span class="header-section-number">59.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-multiple-sequence-alignment" id="toc-find-a-highest-scoring-multiple-sequence-alignment" class="nav-link" data-scroll-target="#find-a-highest-scoring-multiple-sequence-alignment"><span class="header-section-number">60</span> Find a Highest-Scoring Multiple Sequence Alignment</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-60" id="toc-sample-dataset-60" class="nav-link" data-scroll-target="#sample-dataset-60"><span class="header-section-number">60.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-60" id="toc-sample-output-60" class="nav-link" data-scroll-target="#sample-output-60"><span class="header-section-number">60.2</span> Sample Output</a></li>
  <li><a href="#solution-60" id="toc-solution-60" class="nav-link" data-scroll-target="#solution-60"><span class="header-section-number">60.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-topological-ordering-of-a-dag" id="toc-find-a-topological-ordering-of-a-dag" class="nav-link" data-scroll-target="#find-a-topological-ordering-of-a-dag"><span class="header-section-number">61</span> Find a Topological Ordering of a DAG</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-61" id="toc-sample-dataset-61" class="nav-link" data-scroll-target="#sample-dataset-61"><span class="header-section-number">61.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-61" id="toc-sample-output-61" class="nav-link" data-scroll-target="#sample-output-61"><span class="header-section-number">61.2</span> Sample Output</a></li>
  <li><a href="#solution-61" id="toc-solution-61" class="nav-link" data-scroll-target="#solution-61"><span class="header-section-number">61.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedysorting-to-sort-a-permutation-by-reversals" id="toc-implement-greedysorting-to-sort-a-permutation-by-reversals" class="nav-link" data-scroll-target="#implement-greedysorting-to-sort-a-permutation-by-reversals"><span class="header-section-number">62</span> Implement GreedySorting to Sort a Permutation by Reversals</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-62" id="toc-sample-dataset-62" class="nav-link" data-scroll-target="#sample-dataset-62"><span class="header-section-number">62.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-62" id="toc-sample-output-62" class="nav-link" data-scroll-target="#sample-output-62"><span class="header-section-number">62.2</span> Sample Output</a></li>
  <li><a href="#solution-62" id="toc-solution-62" class="nav-link" data-scroll-target="#solution-62"><span class="header-section-number">62.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-number-of-breakpoints-in-a-permutation" id="toc-compute-the-number-of-breakpoints-in-a-permutation" class="nav-link" data-scroll-target="#compute-the-number-of-breakpoints-in-a-permutation"><span class="header-section-number">63</span> Compute the Number of Breakpoints in a Permutation</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-63" id="toc-sample-dataset-63" class="nav-link" data-scroll-target="#sample-dataset-63"><span class="header-section-number">63.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-63" id="toc-sample-output-63" class="nav-link" data-scroll-target="#sample-output-63"><span class="header-section-number">63.2</span> Sample Output</a></li>
  <li><a href="#solution-63" id="toc-solution-63" class="nav-link" data-scroll-target="#solution-63"><span class="header-section-number">63.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-2-break-distance-between-a-pair-of-genomes" id="toc-compute-the-2-break-distance-between-a-pair-of-genomes" class="nav-link" data-scroll-target="#compute-the-2-break-distance-between-a-pair-of-genomes"><span class="header-section-number">64</span> Compute the 2-Break Distance Between a Pair of Genomes</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-64" id="toc-sample-dataset-64" class="nav-link" data-scroll-target="#sample-dataset-64"><span class="header-section-number">64.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-64" id="toc-sample-output-64" class="nav-link" data-scroll-target="#sample-output-64"><span class="header-section-number">64.2</span> Sample Output</a></li>
  <li><a href="#solution-64" id="toc-solution-64" class="nav-link" data-scroll-target="#solution-64"><span class="header-section-number">64.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks" id="toc-find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks" class="nav-link" data-scroll-target="#find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks"><span class="header-section-number">65</span> Find a Shortest Transformation of One Genome into Another by 2-Breaks</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-65" id="toc-sample-dataset-65" class="nav-link" data-scroll-target="#sample-dataset-65"><span class="header-section-number">65.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-65" id="toc-sample-output-65" class="nav-link" data-scroll-target="#sample-output-65"><span class="header-section-number">65.2</span> Sample Output</a></li>
  <li><a href="#solution-65" id="toc-solution-65" class="nav-link" data-scroll-target="#solution-65"><span class="header-section-number">65.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-shared-k-mers-of-a-pair-of-strings" id="toc-find-all-shared-k-mers-of-a-pair-of-strings" class="nav-link" data-scroll-target="#find-all-shared-k-mers-of-a-pair-of-strings"><span class="header-section-number">66</span> Find All Shared k-mers of a Pair of Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-66" id="toc-sample-dataset-66" class="nav-link" data-scroll-target="#sample-dataset-66"><span class="header-section-number">66.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-66" id="toc-sample-output-66" class="nav-link" data-scroll-target="#sample-output-66"><span class="header-section-number">66.2</span> Sample Output</a></li>
  <li><a href="#solution-66" id="toc-solution-66" class="nav-link" data-scroll-target="#solution-66"><span class="header-section-number">66.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-chromosometocycle" id="toc-implement-chromosometocycle" class="nav-link" data-scroll-target="#implement-chromosometocycle"><span class="header-section-number">67</span> Implement ChromosomeToCycle</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-67" id="toc-sample-dataset-67" class="nav-link" data-scroll-target="#sample-dataset-67"><span class="header-section-number">67.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-67" id="toc-sample-output-67" class="nav-link" data-scroll-target="#sample-output-67"><span class="header-section-number">67.2</span> Sample Output</a></li>
  <li><a href="#solution-67" id="toc-solution-67" class="nav-link" data-scroll-target="#solution-67"><span class="header-section-number">67.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-cycletochromosome" id="toc-implement-cycletochromosome" class="nav-link" data-scroll-target="#implement-cycletochromosome"><span class="header-section-number">68</span> Implement CycleToChromosome</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-68" id="toc-sample-dataset-68" class="nav-link" data-scroll-target="#sample-dataset-68"><span class="header-section-number">68.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-68" id="toc-sample-output-68" class="nav-link" data-scroll-target="#sample-output-68"><span class="header-section-number">68.2</span> Sample Output</a></li>
  <li><a href="#solution-68" id="toc-solution-68" class="nav-link" data-scroll-target="#solution-68"><span class="header-section-number">68.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-colorededges" id="toc-implement-colorededges" class="nav-link" data-scroll-target="#implement-colorededges"><span class="header-section-number">69</span> Implement ColoredEdges</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-69" id="toc-sample-dataset-69" class="nav-link" data-scroll-target="#sample-dataset-69"><span class="header-section-number">69.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-69" id="toc-sample-output-69" class="nav-link" data-scroll-target="#sample-output-69"><span class="header-section-number">69.2</span> Sample Output</a></li>
  <li><a href="#solution-69" id="toc-solution-69" class="nav-link" data-scroll-target="#solution-69"><span class="header-section-number">69.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-graphtogenome" id="toc-implement-graphtogenome" class="nav-link" data-scroll-target="#implement-graphtogenome"><span class="header-section-number">70</span> Implement GraphToGenome</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-70" id="toc-sample-dataset-70" class="nav-link" data-scroll-target="#sample-dataset-70"><span class="header-section-number">70.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-70" id="toc-sample-output-70" class="nav-link" data-scroll-target="#sample-output-70"><span class="header-section-number">70.2</span> Sample Output</a></li>
  <li><a href="#solution-70" id="toc-solution-70" class="nav-link" data-scroll-target="#solution-70"><span class="header-section-number">70.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-2-breakongenomegraph" id="toc-implement-2-breakongenomegraph" class="nav-link" data-scroll-target="#implement-2-breakongenomegraph"><span class="header-section-number">71</span> Implement 2-BreakOnGenomeGraph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-71" id="toc-sample-dataset-71" class="nav-link" data-scroll-target="#sample-dataset-71"><span class="header-section-number">71.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-71" id="toc-sample-output-71" class="nav-link" data-scroll-target="#sample-output-71"><span class="header-section-number">71.2</span> Sample Output</a></li>
  <li><a href="#solution-71" id="toc-solution-71" class="nav-link" data-scroll-target="#solution-71"><span class="header-section-number">71.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-2-breakongenome" id="toc-implement-2-breakongenome" class="nav-link" data-scroll-target="#implement-2-breakongenome"><span class="header-section-number">72</span> Implement 2-BreakOnGenome</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-72" id="toc-sample-dataset-72" class="nav-link" data-scroll-target="#sample-dataset-72"><span class="header-section-number">72.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-72" id="toc-sample-output-72" class="nav-link" data-scroll-target="#sample-output-72"><span class="header-section-number">72.2</span> Sample Output</a></li>
  <li><a href="#solution-72" id="toc-solution-72" class="nav-link" data-scroll-target="#solution-72"><span class="header-section-number">72.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-distances-between-leaves" id="toc-compute-distances-between-leaves" class="nav-link" data-scroll-target="#compute-distances-between-leaves"><span class="header-section-number">73</span> Compute Distances Between Leaves</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-73" id="toc-sample-dataset-73" class="nav-link" data-scroll-target="#sample-dataset-73"><span class="header-section-number">73.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-73" id="toc-sample-output-73" class="nav-link" data-scroll-target="#sample-output-73"><span class="header-section-number">73.2</span> Sample Output</a></li>
  <li><a href="#solution-73" id="toc-solution-73" class="nav-link" data-scroll-target="#solution-73"><span class="header-section-number">73.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-limb-lengths-in-a-tree" id="toc-compute-limb-lengths-in-a-tree" class="nav-link" data-scroll-target="#compute-limb-lengths-in-a-tree"><span class="header-section-number">74</span> Compute Limb Lengths in a Tree</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-74" id="toc-sample-dataset-74" class="nav-link" data-scroll-target="#sample-dataset-74"><span class="header-section-number">74.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-74" id="toc-sample-output-74" class="nav-link" data-scroll-target="#sample-output-74"><span class="header-section-number">74.2</span> Sample Output</a></li>
  <li><a href="#solution-74" id="toc-solution-74" class="nav-link" data-scroll-target="#solution-74"><span class="header-section-number">74.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-additivephylogeny" id="toc-implement-additivephylogeny" class="nav-link" data-scroll-target="#implement-additivephylogeny"><span class="header-section-number">75</span> Implement AdditivePhylogeny</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-75" id="toc-sample-dataset-75" class="nav-link" data-scroll-target="#sample-dataset-75"><span class="header-section-number">75.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-75" id="toc-sample-output-75" class="nav-link" data-scroll-target="#sample-output-75"><span class="header-section-number">75.2</span> Sample Output</a></li>
  <li><a href="#solution-75" id="toc-solution-75" class="nav-link" data-scroll-target="#solution-75"><span class="header-section-number">75.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-upgma" id="toc-implement-upgma" class="nav-link" data-scroll-target="#implement-upgma"><span class="header-section-number">76</span> Implement UPGMA</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-76" id="toc-sample-dataset-76" class="nav-link" data-scroll-target="#sample-dataset-76"><span class="header-section-number">76.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-76" id="toc-sample-output-76" class="nav-link" data-scroll-target="#sample-output-76"><span class="header-section-number">76.2</span> Sample Output</a></li>
  <li><a href="#solution-76" id="toc-solution-76" class="nav-link" data-scroll-target="#solution-76"><span class="header-section-number">76.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-neighbor-joining-algorithm" id="toc-implement-the-neighbor-joining-algorithm" class="nav-link" data-scroll-target="#implement-the-neighbor-joining-algorithm"><span class="header-section-number">77</span> Implement the Neighbor Joining Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-77" id="toc-sample-dataset-77" class="nav-link" data-scroll-target="#sample-dataset-77"><span class="header-section-number">77.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-77" id="toc-sample-output-77" class="nav-link" data-scroll-target="#sample-output-77"><span class="header-section-number">77.2</span> Sample Output</a></li>
  <li><a href="#solution-77" id="toc-solution-77" class="nav-link" data-scroll-target="#solution-77"><span class="header-section-number">77.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-smallparsimony" id="toc-implement-smallparsimony" class="nav-link" data-scroll-target="#implement-smallparsimony"><span class="header-section-number">78</span> Implement SmallParsimony</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-78" id="toc-sample-dataset-78" class="nav-link" data-scroll-target="#sample-dataset-78"><span class="header-section-number">78.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-78" id="toc-sample-output-78" class="nav-link" data-scroll-target="#sample-output-78"><span class="header-section-number">78.2</span> Sample Output</a></li>
  <li><a href="#solution-78" id="toc-solution-78" class="nav-link" data-scroll-target="#solution-78"><span class="header-section-number">78.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#adapt-smallparsimony-to-unrooted-trees" id="toc-adapt-smallparsimony-to-unrooted-trees" class="nav-link" data-scroll-target="#adapt-smallparsimony-to-unrooted-trees"><span class="header-section-number">79</span> Adapt SmallParsimony to Unrooted Trees</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-79" id="toc-sample-dataset-79" class="nav-link" data-scroll-target="#sample-dataset-79"><span class="header-section-number">79.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-79" id="toc-sample-output-79" class="nav-link" data-scroll-target="#sample-output-79"><span class="header-section-number">79.2</span> Sample Output</a></li>
  <li><a href="#solution-79" id="toc-solution-79" class="nav-link" data-scroll-target="#solution-79"><span class="header-section-number">79.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#adapt-smallparsimony-to-unrooted-trees-1" id="toc-adapt-smallparsimony-to-unrooted-trees-1" class="nav-link" data-scroll-target="#adapt-smallparsimony-to-unrooted-trees-1"><span class="header-section-number">80</span> Adapt SmallParsimony to Unrooted Trees</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-80" id="toc-sample-dataset-80" class="nav-link" data-scroll-target="#sample-dataset-80"><span class="header-section-number">80.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-80" id="toc-sample-output-80" class="nav-link" data-scroll-target="#sample-output-80"><span class="header-section-number">80.2</span> Sample Output</a></li>
  <li><a href="#solution-80" id="toc-solution-80" class="nav-link" data-scroll-target="#solution-80"><span class="header-section-number">80.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-farthestfirsttraversal" id="toc-implement-farthestfirsttraversal" class="nav-link" data-scroll-target="#implement-farthestfirsttraversal"><span class="header-section-number">81</span> Implement FarthestFirstTraversal</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-81" id="toc-sample-dataset-81" class="nav-link" data-scroll-target="#sample-dataset-81"><span class="header-section-number">81.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-81" id="toc-sample-output-81" class="nav-link" data-scroll-target="#sample-output-81"><span class="header-section-number">81.2</span> Sample Output</a></li>
  <li><a href="#solution-81" id="toc-solution-81" class="nav-link" data-scroll-target="#solution-81"><span class="header-section-number">81.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-squared-error-distortion" id="toc-compute-the-squared-error-distortion" class="nav-link" data-scroll-target="#compute-the-squared-error-distortion"><span class="header-section-number">82</span> Compute the Squared Error Distortion</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-82" id="toc-sample-dataset-82" class="nav-link" data-scroll-target="#sample-dataset-82"><span class="header-section-number">82.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-82" id="toc-sample-output-82" class="nav-link" data-scroll-target="#sample-output-82"><span class="header-section-number">82.2</span> Sample Output</a></li>
  <li><a href="#solution-82" id="toc-solution-82" class="nav-link" data-scroll-target="#solution-82"><span class="header-section-number">82.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-lloyd-algorithm-for-k-means-clustering" id="toc-implement-the-lloyd-algorithm-for-k-means-clustering" class="nav-link" data-scroll-target="#implement-the-lloyd-algorithm-for-k-means-clustering"><span class="header-section-number">83</span> Implement the Lloyd Algorithm for k-Means Clustering</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-83" id="toc-sample-dataset-83" class="nav-link" data-scroll-target="#sample-dataset-83"><span class="header-section-number">83.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-83" id="toc-sample-output-83" class="nav-link" data-scroll-target="#sample-output-83"><span class="header-section-number">83.2</span> Sample Output</a></li>
  <li><a href="#solution-83" id="toc-solution-83" class="nav-link" data-scroll-target="#solution-83"><span class="header-section-number">83.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-soft-k-means-clustering-algorithm" id="toc-implement-the-soft-k-means-clustering-algorithm" class="nav-link" data-scroll-target="#implement-the-soft-k-means-clustering-algorithm"><span class="header-section-number">84</span> Implement the Soft k-Means Clustering Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-84" id="toc-sample-dataset-84" class="nav-link" data-scroll-target="#sample-dataset-84"><span class="header-section-number">84.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-84" id="toc-sample-output-84" class="nav-link" data-scroll-target="#sample-output-84"><span class="header-section-number">84.2</span> Sample Output</a></li>
  <li><a href="#solution-84" id="toc-solution-84" class="nav-link" data-scroll-target="#solution-84"><span class="header-section-number">84.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-hierarchical-clustering" id="toc-implement-hierarchical-clustering" class="nav-link" data-scroll-target="#implement-hierarchical-clustering"><span class="header-section-number">85</span> Implement Hierarchical Clustering</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-85" id="toc-sample-dataset-85" class="nav-link" data-scroll-target="#sample-dataset-85"><span class="header-section-number">85.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-85" id="toc-sample-output-85" class="nav-link" data-scroll-target="#sample-output-85"><span class="header-section-number">85.2</span> Sample Output</a></li>
  <li><a href="#solution-85" id="toc-solution-85" class="nav-link" data-scroll-target="#solution-85"><span class="header-section-number">85.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-trie-from-a-collection-of-patterns" id="toc-construct-a-trie-from-a-collection-of-patterns" class="nav-link" data-scroll-target="#construct-a-trie-from-a-collection-of-patterns"><span class="header-section-number">86</span> Construct a Trie from a Collection of Patterns</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-86" id="toc-sample-dataset-86" class="nav-link" data-scroll-target="#sample-dataset-86"><span class="header-section-number">86.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-86" id="toc-sample-output-86" class="nav-link" data-scroll-target="#sample-output-86"><span class="header-section-number">86.2</span> Sample Output</a></li>
  <li><a href="#solution-86" id="toc-solution-86" class="nav-link" data-scroll-target="#solution-86"><span class="header-section-number">86.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-triematching" id="toc-implement-triematching" class="nav-link" data-scroll-target="#implement-triematching"><span class="header-section-number">87</span> Implement TrieMatching</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-87" id="toc-sample-dataset-87" class="nav-link" data-scroll-target="#sample-dataset-87"><span class="header-section-number">87.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-87" id="toc-sample-output-87" class="nav-link" data-scroll-target="#sample-output-87"><span class="header-section-number">87.2</span> Sample Output</a></li>
  <li><a href="#solution-87" id="toc-solution-87" class="nav-link" data-scroll-target="#solution-87"><span class="header-section-number">87.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-suffix-tree-of-a-string" id="toc-construct-the-suffix-tree-of-a-string" class="nav-link" data-scroll-target="#construct-the-suffix-tree-of-a-string"><span class="header-section-number">88</span> Construct the Suffix Tree of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-88" id="toc-sample-dataset-88" class="nav-link" data-scroll-target="#sample-dataset-88"><span class="header-section-number">88.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-88" id="toc-sample-output-88" class="nav-link" data-scroll-target="#sample-output-88"><span class="header-section-number">88.2</span> Sample Output</a></li>
  <li><a href="#solution-88" id="toc-solution-88" class="nav-link" data-scroll-target="#solution-88"><span class="header-section-number">88.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-longest-repeat-in-a-string" id="toc-find-the-longest-repeat-in-a-string" class="nav-link" data-scroll-target="#find-the-longest-repeat-in-a-string"><span class="header-section-number">89</span> Find the Longest Repeat in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-89" id="toc-sample-dataset-89" class="nav-link" data-scroll-target="#sample-dataset-89"><span class="header-section-number">89.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-89" id="toc-sample-output-89" class="nav-link" data-scroll-target="#sample-output-89"><span class="header-section-number">89.2</span> Sample Output</a></li>
  <li><a href="#solution-89" id="toc-solution-89" class="nav-link" data-scroll-target="#solution-89"><span class="header-section-number">89.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-longest-substring-shared-by-two-strings" id="toc-find-the-longest-substring-shared-by-two-strings" class="nav-link" data-scroll-target="#find-the-longest-substring-shared-by-two-strings"><span class="header-section-number">90</span> Find the Longest Substring Shared by Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-90" id="toc-sample-dataset-90" class="nav-link" data-scroll-target="#sample-dataset-90"><span class="header-section-number">90.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-90" id="toc-sample-output-90" class="nav-link" data-scroll-target="#sample-output-90"><span class="header-section-number">90.2</span> Sample Output</a></li>
  <li><a href="#solution-90" id="toc-solution-90" class="nav-link" data-scroll-target="#solution-90"><span class="header-section-number">90.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-shortest-non-shared-substring-of-two-strings" id="toc-find-the-shortest-non-shared-substring-of-two-strings" class="nav-link" data-scroll-target="#find-the-shortest-non-shared-substring-of-two-strings"><span class="header-section-number">91</span> Find the Shortest Non-Shared Substring of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-91" id="toc-sample-dataset-91" class="nav-link" data-scroll-target="#sample-dataset-91"><span class="header-section-number">91.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-91" id="toc-sample-output-91" class="nav-link" data-scroll-target="#sample-output-91"><span class="header-section-number">91.2</span> Sample Output</a></li>
  <li><a href="#solution-91" id="toc-solution-91" class="nav-link" data-scroll-target="#solution-91"><span class="header-section-number">91.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-suffix-array-of-a-string" id="toc-construct-the-suffix-array-of-a-string" class="nav-link" data-scroll-target="#construct-the-suffix-array-of-a-string"><span class="header-section-number">92</span> Construct the Suffix Array of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-92" id="toc-sample-dataset-92" class="nav-link" data-scroll-target="#sample-dataset-92"><span class="header-section-number">92.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-92" id="toc-sample-output-92" class="nav-link" data-scroll-target="#sample-output-92"><span class="header-section-number">92.2</span> Sample Output</a></li>
  <li><a href="#solution-92" id="toc-solution-92" class="nav-link" data-scroll-target="#solution-92"><span class="header-section-number">92.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#pattern-matching-with-the-suffix-array" id="toc-pattern-matching-with-the-suffix-array" class="nav-link" data-scroll-target="#pattern-matching-with-the-suffix-array"><span class="header-section-number">93</span> Pattern Matching with the Suffix Array</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-93" id="toc-sample-dataset-93" class="nav-link" data-scroll-target="#sample-dataset-93"><span class="header-section-number">93.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-93" id="toc-sample-output-93" class="nav-link" data-scroll-target="#sample-output-93"><span class="header-section-number">93.2</span> Sample Output</a></li>
  <li><a href="#solution-93" id="toc-solution-93" class="nav-link" data-scroll-target="#solution-93"><span class="header-section-number">93.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-burrows-wheeler-transform-of-a-string" id="toc-construct-the-burrows-wheeler-transform-of-a-string" class="nav-link" data-scroll-target="#construct-the-burrows-wheeler-transform-of-a-string"><span class="header-section-number">94</span> Construct the Burrows-Wheeler Transform of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-94" id="toc-sample-dataset-94" class="nav-link" data-scroll-target="#sample-dataset-94"><span class="header-section-number">94.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-94" id="toc-sample-output-94" class="nav-link" data-scroll-target="#sample-output-94"><span class="header-section-number">94.2</span> Sample Output</a></li>
  <li><a href="#solution-94" id="toc-solution-94" class="nav-link" data-scroll-target="#solution-94"><span class="header-section-number">94.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-burrows-wheeler-transform" id="toc-reconstruct-a-string-from-its-burrows-wheeler-transform" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-burrows-wheeler-transform"><span class="header-section-number">95</span> Reconstruct a String from its Burrows-Wheeler Transform</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-95" id="toc-sample-dataset-95" class="nav-link" data-scroll-target="#sample-dataset-95"><span class="header-section-number">95.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-95" id="toc-sample-output-95" class="nav-link" data-scroll-target="#sample-output-95"><span class="header-section-number">95.2</span> Sample Output</a></li>
  <li><a href="#solution-95" id="toc-solution-95" class="nav-link" data-scroll-target="#solution-95"><span class="header-section-number">95.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-last-to-first-mapping-of-a-string" id="toc-generate-the-last-to-first-mapping-of-a-string" class="nav-link" data-scroll-target="#generate-the-last-to-first-mapping-of-a-string"><span class="header-section-number">96</span> Generate the Last-to-First Mapping of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-96" id="toc-sample-dataset-96" class="nav-link" data-scroll-target="#sample-dataset-96"><span class="header-section-number">96.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-96" id="toc-sample-output-96" class="nav-link" data-scroll-target="#sample-output-96"><span class="header-section-number">96.2</span> Sample Output</a></li>
  <li><a href="#solution-96" id="toc-solution-96" class="nav-link" data-scroll-target="#solution-96"><span class="header-section-number">96.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-bwmatching" id="toc-implement-bwmatching" class="nav-link" data-scroll-target="#implement-bwmatching"><span class="header-section-number">97</span> Implement BWMatching</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-97" id="toc-sample-dataset-97" class="nav-link" data-scroll-target="#sample-dataset-97"><span class="header-section-number">97.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-97" id="toc-sample-output-97" class="nav-link" data-scroll-target="#sample-output-97"><span class="header-section-number">97.2</span> Sample Output</a></li>
  <li><a href="#solution-97" id="toc-solution-97" class="nav-link" data-scroll-target="#solution-97"><span class="header-section-number">97.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-betterbwmatching" id="toc-implement-betterbwmatching" class="nav-link" data-scroll-target="#implement-betterbwmatching"><span class="header-section-number">98</span> Implement BetterBWMatching</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-98" id="toc-sample-dataset-98" class="nav-link" data-scroll-target="#sample-dataset-98"><span class="header-section-number">98.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-98" id="toc-sample-output-98" class="nav-link" data-scroll-target="#sample-output-98"><span class="header-section-number">98.2</span> Sample Output</a></li>
  <li><a href="#solution-98" id="toc-solution-98" class="nav-link" data-scroll-target="#solution-98"><span class="header-section-number">98.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-occurrences-of-a-collection-of-patterns-in-a-string" id="toc-find-all-occurrences-of-a-collection-of-patterns-in-a-string" class="nav-link" data-scroll-target="#find-all-occurrences-of-a-collection-of-patterns-in-a-string"><span class="header-section-number">99</span> Find All Occurrences of a Collection of Patterns in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-99" id="toc-sample-dataset-99" class="nav-link" data-scroll-target="#sample-dataset-99"><span class="header-section-number">99.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-99" id="toc-sample-output-99" class="nav-link" data-scroll-target="#sample-output-99"><span class="header-section-number">99.2</span> Sample Output</a></li>
  <li><a href="#solution-99" id="toc-solution-99" class="nav-link" data-scroll-target="#solution-99"><span class="header-section-number">99.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-approximate-occurrences-of-a-collection-of-patterns-in-a-string" id="toc-find-all-approximate-occurrences-of-a-collection-of-patterns-in-a-string" class="nav-link" data-scroll-target="#find-all-approximate-occurrences-of-a-collection-of-patterns-in-a-string"><span class="header-section-number">100</span> Find All Approximate Occurrences of a Collection of Patterns in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-100" id="toc-sample-dataset-100" class="nav-link" data-scroll-target="#sample-dataset-100"><span class="header-section-number">100.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-100" id="toc-sample-output-100" class="nav-link" data-scroll-target="#sample-output-100"><span class="header-section-number">100.2</span> Sample Output</a></li>
  <li><a href="#solution-100" id="toc-solution-100" class="nav-link" data-scroll-target="#solution-100"><span class="header-section-number">100.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-treecoloring" id="toc-implement-treecoloring" class="nav-link" data-scroll-target="#implement-treecoloring"><span class="header-section-number">101</span> Implement TreeColoring</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-101" id="toc-sample-dataset-101" class="nav-link" data-scroll-target="#sample-dataset-101"><span class="header-section-number">101.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-101" id="toc-sample-output-101" class="nav-link" data-scroll-target="#sample-output-101"><span class="header-section-number">101.2</span> Sample Output</a></li>
  <li><a href="#solution-101" id="toc-solution-101" class="nav-link" data-scroll-target="#solution-101"><span class="header-section-number">101.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-partial-suffix-array-of-a-string" id="toc-construct-the-partial-suffix-array-of-a-string" class="nav-link" data-scroll-target="#construct-the-partial-suffix-array-of-a-string"><span class="header-section-number">102</span> Construct the Partial Suffix Array of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-102" id="toc-sample-dataset-102" class="nav-link" data-scroll-target="#sample-dataset-102"><span class="header-section-number">102.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-102" id="toc-sample-output-102" class="nav-link" data-scroll-target="#sample-output-102"><span class="header-section-number">102.2</span> Sample Output</a></li>
  <li><a href="#solution-102" id="toc-solution-102" class="nav-link" data-scroll-target="#solution-102"><span class="header-section-number">102.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-suffix-tree-from-a-suffix-array" id="toc-construct-a-suffix-tree-from-a-suffix-array" class="nav-link" data-scroll-target="#construct-a-suffix-tree-from-a-suffix-array"><span class="header-section-number">103</span> Construct a Suffix Tree from a Suffix Array</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-103" id="toc-sample-dataset-103" class="nav-link" data-scroll-target="#sample-dataset-103"><span class="header-section-number">103.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-103" id="toc-sample-output-103" class="nav-link" data-scroll-target="#sample-output-103"><span class="header-section-number">103.2</span> Sample Output</a></li>
  <li><a href="#solution-103" id="toc-solution-103" class="nav-link" data-scroll-target="#solution-103"><span class="header-section-number">103.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-hidden-path" id="toc-compute-the-probability-of-a-hidden-path" class="nav-link" data-scroll-target="#compute-the-probability-of-a-hidden-path"><span class="header-section-number">104</span> Compute the Probability of a Hidden Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-104" id="toc-sample-dataset-104" class="nav-link" data-scroll-target="#sample-dataset-104"><span class="header-section-number">104.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-104" id="toc-sample-output-104" class="nav-link" data-scroll-target="#sample-output-104"><span class="header-section-number">104.2</span> Sample Output</a></li>
  <li><a href="#solution-104" id="toc-solution-104" class="nav-link" data-scroll-target="#solution-104"><span class="header-section-number">104.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-an-outcome-given-a-hidden-path" id="toc-compute-the-probability-of-an-outcome-given-a-hidden-path" class="nav-link" data-scroll-target="#compute-the-probability-of-an-outcome-given-a-hidden-path"><span class="header-section-number">105</span> Compute the Probability of an Outcome Given a Hidden Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-105" id="toc-sample-dataset-105" class="nav-link" data-scroll-target="#sample-dataset-105"><span class="header-section-number">105.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-105" id="toc-sample-output-105" class="nav-link" data-scroll-target="#sample-output-105"><span class="header-section-number">105.2</span> Sample Output</a></li>
  <li><a href="#solution-105" id="toc-solution-105" class="nav-link" data-scroll-target="#solution-105"><span class="header-section-number">105.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-viterbi-algorithm" id="toc-implement-the-viterbi-algorithm" class="nav-link" data-scroll-target="#implement-the-viterbi-algorithm"><span class="header-section-number">106</span> Implement the Viterbi Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-106" id="toc-sample-dataset-106" class="nav-link" data-scroll-target="#sample-dataset-106"><span class="header-section-number">106.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-106" id="toc-sample-output-106" class="nav-link" data-scroll-target="#sample-output-106"><span class="header-section-number">106.2</span> Sample Output</a></li>
  <li><a href="#solution-106" id="toc-solution-106" class="nav-link" data-scroll-target="#solution-106"><span class="header-section-number">106.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-string-emitted-by-an-hmm" id="toc-compute-the-probability-of-a-string-emitted-by-an-hmm" class="nav-link" data-scroll-target="#compute-the-probability-of-a-string-emitted-by-an-hmm"><span class="header-section-number">107</span> Compute the Probability of a String Emitted by an HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-107" id="toc-sample-dataset-107" class="nav-link" data-scroll-target="#sample-dataset-107"><span class="header-section-number">107.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-107" id="toc-sample-output-107" class="nav-link" data-scroll-target="#sample-output-107"><span class="header-section-number">107.2</span> Sample Output</a></li>
  <li><a href="#solution-107" id="toc-solution-107" class="nav-link" data-scroll-target="#solution-107"><span class="header-section-number">107.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-profile-hmm" id="toc-construct-a-profile-hmm" class="nav-link" data-scroll-target="#construct-a-profile-hmm"><span class="header-section-number">108</span> Construct a Profile HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-108" id="toc-sample-dataset-108" class="nav-link" data-scroll-target="#sample-dataset-108"><span class="header-section-number">108.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-108" id="toc-sample-output-108" class="nav-link" data-scroll-target="#sample-output-108"><span class="header-section-number">108.2</span> Sample Output</a></li>
  <li><a href="#solution-108" id="toc-solution-108" class="nav-link" data-scroll-target="#solution-108"><span class="header-section-number">108.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-profile-hmm-with-pseudocounts" id="toc-construct-a-profile-hmm-with-pseudocounts" class="nav-link" data-scroll-target="#construct-a-profile-hmm-with-pseudocounts"><span class="header-section-number">109</span> Construct a Profile HMM with Pseudocounts</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-109" id="toc-sample-dataset-109" class="nav-link" data-scroll-target="#sample-dataset-109"><span class="header-section-number">109.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-109" id="toc-sample-output-109" class="nav-link" data-scroll-target="#sample-output-109"><span class="header-section-number">109.2</span> Sample Output</a></li>
  <li><a href="#solution-109" id="toc-solution-109" class="nav-link" data-scroll-target="#solution-109"><span class="header-section-number">109.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#perform-a-multiple-sequence-alignment-with-a-profile-hmm" id="toc-perform-a-multiple-sequence-alignment-with-a-profile-hmm" class="nav-link" data-scroll-target="#perform-a-multiple-sequence-alignment-with-a-profile-hmm"><span class="header-section-number">110</span> Perform a Multiple Sequence Alignment with a Profile HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-110" id="toc-sample-dataset-110" class="nav-link" data-scroll-target="#sample-dataset-110"><span class="header-section-number">110.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-110" id="toc-sample-output-110" class="nav-link" data-scroll-target="#sample-output-110"><span class="header-section-number">110.2</span> Sample Output</a></li>
  <li><a href="#solution-110" id="toc-solution-110" class="nav-link" data-scroll-target="#solution-110"><span class="header-section-number">110.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#estimate-the-parameters-of-an-hmm" id="toc-estimate-the-parameters-of-an-hmm" class="nav-link" data-scroll-target="#estimate-the-parameters-of-an-hmm"><span class="header-section-number">111</span> Estimate the Parameters of an HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-111" id="toc-sample-dataset-111" class="nav-link" data-scroll-target="#sample-dataset-111"><span class="header-section-number">111.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-111" id="toc-sample-output-111" class="nav-link" data-scroll-target="#sample-output-111"><span class="header-section-number">111.2</span> Sample Output</a></li>
  <li><a href="#solution-111" id="toc-solution-111" class="nav-link" data-scroll-target="#solution-111"><span class="header-section-number">111.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-viterbi-learning" id="toc-implement-viterbi-learning" class="nav-link" data-scroll-target="#implement-viterbi-learning"><span class="header-section-number">112</span> Implement Viterbi Learning</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-112" id="toc-sample-dataset-112" class="nav-link" data-scroll-target="#sample-dataset-112"><span class="header-section-number">112.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-112" id="toc-sample-output-112" class="nav-link" data-scroll-target="#sample-output-112"><span class="header-section-number">112.2</span> Sample Output</a></li>
  <li><a href="#solution-112" id="toc-solution-112" class="nav-link" data-scroll-target="#solution-112"><span class="header-section-number">112.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#solve-the-soft-decoding-problem" id="toc-solve-the-soft-decoding-problem" class="nav-link" data-scroll-target="#solve-the-soft-decoding-problem"><span class="header-section-number">113</span> Solve the Soft Decoding Problem</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-113" id="toc-sample-dataset-113" class="nav-link" data-scroll-target="#sample-dataset-113"><span class="header-section-number">113.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-113" id="toc-sample-output-113" class="nav-link" data-scroll-target="#sample-output-113"><span class="header-section-number">113.2</span> Sample Output</a></li>
  <li><a href="#solution-113" id="toc-solution-113" class="nav-link" data-scroll-target="#solution-113"><span class="header-section-number">113.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-baum-welch-learning" id="toc-implement-baum-welch-learning" class="nav-link" data-scroll-target="#implement-baum-welch-learning"><span class="header-section-number">114</span> Implement Baum-Welch Learning</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-114" id="toc-sample-dataset-114" class="nav-link" data-scroll-target="#sample-dataset-114"><span class="header-section-number">114.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-114" id="toc-sample-output-114" class="nav-link" data-scroll-target="#sample-output-114"><span class="header-section-number">114.2</span> Sample Output</a></li>
  <li><a href="#solution-114" id="toc-solution-114" class="nav-link" data-scroll-target="#solution-114"><span class="header-section-number">114.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-graph-of-a-spectrum" id="toc-construct-the-graph-of-a-spectrum" class="nav-link" data-scroll-target="#construct-the-graph-of-a-spectrum"><span class="header-section-number">115</span> Construct the Graph of a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-115" id="toc-sample-dataset-115" class="nav-link" data-scroll-target="#sample-dataset-115"><span class="header-section-number">115.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-115" id="toc-sample-output-115" class="nav-link" data-scroll-target="#sample-output-115"><span class="header-section-number">115.2</span> Sample Output</a></li>
  <li><a href="#solution-115" id="toc-solution-115" class="nav-link" data-scroll-target="#solution-115"><span class="header-section-number">115.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-decodingidealspectrum" id="toc-implement-decodingidealspectrum" class="nav-link" data-scroll-target="#implement-decodingidealspectrum"><span class="header-section-number">116</span> Implement DecodingIdealSpectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-116" id="toc-sample-dataset-116" class="nav-link" data-scroll-target="#sample-dataset-116"><span class="header-section-number">116.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-116" id="toc-sample-output-116" class="nav-link" data-scroll-target="#sample-output-116"><span class="header-section-number">116.2</span> Sample Output</a></li>
  <li><a href="#solution-116" id="toc-solution-116" class="nav-link" data-scroll-target="#solution-116"><span class="header-section-number">116.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#convert-a-peptide-into-a-peptide-vector" id="toc-convert-a-peptide-into-a-peptide-vector" class="nav-link" data-scroll-target="#convert-a-peptide-into-a-peptide-vector"><span class="header-section-number">117</span> Convert a Peptide into a Peptide Vector</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-117" id="toc-sample-dataset-117" class="nav-link" data-scroll-target="#sample-dataset-117"><span class="header-section-number">117.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-117" id="toc-sample-output-117" class="nav-link" data-scroll-target="#sample-output-117"><span class="header-section-number">117.2</span> Sample Output</a></li>
  <li><a href="#solution-117" id="toc-solution-117" class="nav-link" data-scroll-target="#solution-117"><span class="header-section-number">117.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#convert-a-peptide-vector-into-a-peptide" id="toc-convert-a-peptide-vector-into-a-peptide" class="nav-link" data-scroll-target="#convert-a-peptide-vector-into-a-peptide"><span class="header-section-number">118</span> Convert a Peptide Vector into a Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-118" id="toc-sample-dataset-118" class="nav-link" data-scroll-target="#sample-dataset-118"><span class="header-section-number">118.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-118" id="toc-sample-output-118" class="nav-link" data-scroll-target="#sample-output-118"><span class="header-section-number">118.2</span> Sample Output</a></li>
  <li><a href="#solution-118" id="toc-solution-118" class="nav-link" data-scroll-target="#solution-118"><span class="header-section-number">118.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#sequence-a-peptide" id="toc-sequence-a-peptide" class="nav-link" data-scroll-target="#sequence-a-peptide"><span class="header-section-number">119</span> Sequence a Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-119" id="toc-sample-dataset-119" class="nav-link" data-scroll-target="#sample-dataset-119"><span class="header-section-number">119.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-119" id="toc-sample-output-119" class="nav-link" data-scroll-target="#sample-output-119"><span class="header-section-number">119.2</span> Sample Output</a></li>
  <li><a href="#solution-119" id="toc-solution-119" class="nav-link" data-scroll-target="#solution-119"><span class="header-section-number">119.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-peptide-in-a-proteome-against-a-spectrum" id="toc-find-a-highest-scoring-peptide-in-a-proteome-against-a-spectrum" class="nav-link" data-scroll-target="#find-a-highest-scoring-peptide-in-a-proteome-against-a-spectrum"><span class="header-section-number">120</span> Find a Highest-Scoring Peptide in a Proteome against a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-120" id="toc-sample-dataset-120" class="nav-link" data-scroll-target="#sample-dataset-120"><span class="header-section-number">120.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-120" id="toc-sample-output-120" class="nav-link" data-scroll-target="#sample-output-120"><span class="header-section-number">120.2</span> Sample Output</a></li>
  <li><a href="#solution-120" id="toc-solution-120" class="nav-link" data-scroll-target="#solution-120"><span class="header-section-number">120.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-psmsearch" id="toc-implement-psmsearch" class="nav-link" data-scroll-target="#implement-psmsearch"><span class="header-section-number">121</span> Implement PSMSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-121" id="toc-sample-dataset-121" class="nav-link" data-scroll-target="#sample-dataset-121"><span class="header-section-number">121.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-121" id="toc-sample-output-121" class="nav-link" data-scroll-target="#sample-output-121"><span class="header-section-number">121.2</span> Sample Output</a></li>
  <li><a href="#solution-121" id="toc-solution-121" class="nav-link" data-scroll-target="#solution-121"><span class="header-section-number">121.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-size-of-a-spectral-dictionary" id="toc-compute-the-size-of-a-spectral-dictionary" class="nav-link" data-scroll-target="#compute-the-size-of-a-spectral-dictionary"><span class="header-section-number">122</span> Compute the Size of a Spectral Dictionary</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-122" id="toc-sample-dataset-122" class="nav-link" data-scroll-target="#sample-dataset-122"><span class="header-section-number">122.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-122" id="toc-sample-output-122" class="nav-link" data-scroll-target="#sample-output-122"><span class="header-section-number">122.2</span> Sample Output</a></li>
  <li><a href="#solution-122" id="toc-solution-122" class="nav-link" data-scroll-target="#solution-122"><span class="header-section-number">122.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-spectral-dictionary" id="toc-compute-the-probability-of-a-spectral-dictionary" class="nav-link" data-scroll-target="#compute-the-probability-of-a-spectral-dictionary"><span class="header-section-number">123</span> Compute the Probability of a Spectral Dictionary</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-123" id="toc-sample-dataset-123" class="nav-link" data-scroll-target="#sample-dataset-123"><span class="header-section-number">123.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-123" id="toc-sample-output-123" class="nav-link" data-scroll-target="#sample-output-123"><span class="header-section-number">123.2</span> Sample Output</a></li>
  <li><a href="#solution-123" id="toc-solution-123" class="nav-link" data-scroll-target="#solution-123"><span class="header-section-number">123.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-modified-peptide-against-a-spectrum" id="toc-find-a-highest-scoring-modified-peptide-against-a-spectrum" class="nav-link" data-scroll-target="#find-a-highest-scoring-modified-peptide-against-a-spectrum"><span class="header-section-number">124</span> Find a Highest-Scoring Modified Peptide against a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-124" id="toc-sample-dataset-124" class="nav-link" data-scroll-target="#sample-dataset-124"><span class="header-section-number">124.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-124" id="toc-sample-output-124" class="nav-link" data-scroll-target="#sample-output-124"><span class="header-section-number">124.2</span> Sample Output</a></li>
  <li><a href="#solution-124" id="toc-solution-124" class="nav-link" data-scroll-target="#solution-124"><span class="header-section-number">124.3</span> Solution</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Rosalind Textbook track 문제풀이</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Rosalind</div>
    <div class="quarto-category">Bioinformatics</div>
    <div class="quarto-category">Tip</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Taeyoon Kim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 28, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">January 14, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Rosalind_textbookTrack.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></p>
</figure>
</div>
<p>Phillip Compeau 와 Pavel Pevzner 가 쓴 책 “<a href="https://www.bioinformaticsalgorithms.org/">능동적 접근 방식의 생물정보학 알고리즘</a>” 에서 제공되는 연습 문제 모음입니다.</p>
<p><a href="https://rosalind.info/">Rosalind</a> 는 <a href="http://projecteuler.net/">프로젝트 오일러</a>, <a href="http://code.google.com/codejam">구글 코드 잼</a> 에서 영감을 얻었습니다. 이 프로젝트의 이름은 DNA 이중나선을 발견하는 데 기여한 <a href="http://en.wikipedia.org/wiki/Rosalind_Franklin">로잘린드 프랭클린</a> 에서 따왔습니다. Rosalind 는 프로그래밍 실력을 키우고자 하는 생물학자와 분자생물학의 계산 문제를 접해본 적이 없는 프로그래머들에게 도움이 될 것입니다.</p>
<section id="compute-the-number-of-times-a-pattern-appears-in-a-text" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="compute-the-number-of-times-a-pattern-appears-in-a-text"><span class="header-section-number">0.1</span> Compute the Number of Times a Pattern Appears in a Text</h2>
<p>This is the first problem in a collection of”code challenges”to accompany&nbsp;<a href="http://bioinformaticsalgorithms.org/">Bioinformatics Algorithms: An Active-Learning Approach</a>&nbsp;by Phillip Compeau &amp; Pavel Pevzner.</p>
<p>A&nbsp;<a href="https://rosalind.info/glossary/k-mer/">k-mer</a>&nbsp;is a&nbsp;<a href="https://rosalind.info/glossary/string/">string</a>&nbsp;of length&nbsp;<em>k</em>. We define&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>) as the number of times that a&nbsp;<em>k</em>-mer&nbsp;<em>Pattern</em>&nbsp;appears as a&nbsp;<a href="https://rosalind.info/glossary/substring/">substring</a>&nbsp;of&nbsp;<em>Text</em>.</p>
<p>For example, We note that&nbsp;<span class="math inline">\(Count(CGATATATCCATAGCGATATATCCATAG,ATAATA)\)</span> is equal to 3 (not 2) since we should account for overlapping occurrences of&nbsp;<em>Pattern</em>&nbsp;in&nbsp;<em>Text</em>.</p>
<p>Given:&nbsp;{DNA strings}}&nbsp;<em>Text</em>&nbsp;and&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>).</p>
</section>
<section id="sample-dataset" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="sample-dataset"><span class="header-section-number">0.2</span> Sample Dataset</h2>
<pre><code>GCGCG
GCG</code></pre>
</section>
<section id="sample-output" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="sample-output"><span class="header-section-number">0.3</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="solution"><span class="header-section-number">0.4</span> Solution</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i:i <span class="op">+</span> size]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count how many times the pattern occurs in the text."""</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">GCGCG</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">GCG</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>text, pattern <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the count of pattern occurrences in text</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_pattern_occurrences(text, pattern))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="find-the-most-frequent-words-in-a-string" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Find the Most Frequent Words in a String</h1>
<p>We say that&nbsp;<em>Pattern</em>&nbsp;is a&nbsp;<strong>most frequent&nbsp;k-mer</strong>&nbsp;in&nbsp;<em>Text</em>&nbsp;if it maximizes&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>) among all&nbsp;<a href="https://rosalind.info/glossary/k-mer/">k-mers</a>. For example,“ACTAT”is a most frequent 5-mer in”ACAACTATGCATCACTATCGGGAACTATCCT”, and”ATA”is a most frequent 3-mer of”CGATATATCCATAG”.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;All most frequent&nbsp;<em>k</em>-mers in&nbsp;<em>Text</em>&nbsp;(in any order).</p>
<section id="sample-dataset-1" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sample-dataset-1"><span class="header-section-number">1.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4</code></pre>
</section>
<section id="sample-output-1" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sample-output-1"><span class="header-section-number">1.2</span> Sample Output</h2>
<pre><code>CATG GCAT</code></pre>
</section>
<section id="solution-1" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="solution-1"><span class="header-section-number">1.3</span> Solution</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count occurrences of each k-mer in the text."""</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(text, k):</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> most_frequent_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find the most frequent k-mers."""</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern size</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>text, k <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="bu">int</span>(k)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Find and print the most frequent k-mers</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> most_frequent_kmers(count_kmers(text, k))</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-reverse-complement-of-a-string" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Find the Reverse Complement of a String</h1>
<p>Find the reverse complement of a DNA string.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<span class="math inline">\(\overline{Pattern}\)</span>, the reverse complement of&nbsp;<em>Pattern</em>.</p>
<section id="sample-dataset-2" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sample-dataset-2"><span class="header-section-number">2.1</span> Sample Dataset</h2>
<pre><code>AAAACCCGGT</code></pre>
</section>
<section id="sample-output-2" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sample-output-2"><span class="header-section-number">2.2</span> Sample Output</h2>
<pre><code>ACCGGGTTTT</code></pre>
</section>
<section id="solution-2" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="solution-2"><span class="header-section-number">2.3</span> Solution</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Return the reverse complement of a DNA sequence."""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">AAAACCCGGT</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the reverse complement</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip().split()[<span class="dv">0</span>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reverse_complement(sequence))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-occurrences-of-a-pattern-in-a-string" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Find All Occurrences of a Pattern in a String</h1>
<p>Pattern Matching Problem, Find all occurrences of a pattern in a string.</p>
<p>Given:&nbsp;Strings&nbsp;<em>Pattern</em>&nbsp;and&nbsp;<em>Genome</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Genome</em>&nbsp;where&nbsp;<em>Pattern</em>&nbsp;appears as a substring. Use&nbsp;<a href="https://rosalind.info/glossary/0-based-numbering/">0-based indexing</a>.</p>
<section id="sample-dataset-3" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sample-dataset-3"><span class="header-section-number">3.1</span> Sample Dataset</h2>
<pre><code>ATAT
GATATATGCATATACTT</code></pre>
</section>
<section id="sample-output-3" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sample-output-3"><span class="header-section-number">3.2</span> Sample Output</h2>
<pre><code>1 3 9</code></pre>
</section>
<section id="solution-3" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="solution-3"><span class="header-section-number">3.3</span> Solution</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Generator</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_indices(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Yield starting indices where the pattern is found in the text."""</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, <span class="bu">len</span>(pattern))):</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> substring <span class="op">==</span> pattern:</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> i</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="st">ATAT</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="st">GATATATGCATATACTT</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into pattern and text</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>pattern, text <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print indices where the pattern is found</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_pattern_indices(text, pattern))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-patterns-forming-clumps-in-a-string" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Find Patterns Forming Clumps in a String</h1>
<p>Clump Finding Problem, Find patterns forming clumps in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Genome</em>, and integers&nbsp;<em>k</em>,&nbsp;<em>L</em>, and&nbsp;<em>t</em>.</p>
<p>Return:&nbsp;All distinct&nbsp;<em>k</em>-mers forming (<em>L</em>,&nbsp;<em>t</em>)-clumps in&nbsp;<em>Genome</em>.</p>
<section id="sample-dataset-4" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sample-dataset-4"><span class="header-section-number">4.1</span> Sample Dataset</h2>
<pre><code>CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC
5 75 4</code></pre>
</section>
<section id="sample-output-4" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sample-output-4"><span class="header-section-number">4.2</span> Sample Output</h2>
<pre><code>CGACA GAAGA AATGT</code></pre>
</section>
<section id="solution-4" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="solution-4"><span class="header-section-number">4.3</span> Solution</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions of k-length kmers within the text."""</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    kmer_positions <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, k)):</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        kmer_positions[substring].append(i)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_positions</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_clump(positions: List[<span class="bu">int</span>], L: <span class="bu">int</span>, t: <span class="bu">int</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if a given array of kmers at positions forms a clump of t within L."""</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(positions) <span class="op">-</span> t <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (positions[i <span class="op">+</span> t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> k <span class="op">-</span> positions[i]) <span class="op">&lt;=</span> L:</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="st">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="st">5 75 4</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into sequence and parameters</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>seq, params <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>k, L, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Find kmers and print those forming clumps</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>kmers <span class="op">=</span> find_kmers(seq, k)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>clumps <span class="op">=</span> [kmer <span class="cf">for</span> kmer <span class="kw">in</span> kmers <span class="cf">if</span> has_clump(kmers[kmer], L, t, k)]</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>clumps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-position-in-a-genome-minimizing-the-skew" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Find a Position in a Genome Minimizing the Skew</h1>
<p>Minimum Skew Problem, Find a position in a genome minimizing the skew.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Genome</em>.</p>
<p>Return:&nbsp;All integer(s)&nbsp;<em>i</em>&nbsp;minimizing&nbsp;<em>Skew</em>(*Prefix__i<em>&nbsp;(</em>Text<em>)) over all values of&nbsp;</em>i<em>&nbsp;(from 0 to |</em>Genome*|).</p>
<section id="sample-dataset-5" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sample-dataset-5"><span class="header-section-number">5.1</span> Sample Dataset</h2>
<pre><code>CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</code></pre>
</section>
<section id="sample-output-5" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sample-output-5"><span class="header-section-number">5.2</span> Sample Output</h2>
<pre><code>53 97</code></pre>
</section>
<section id="solution-5" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="solution-5"><span class="header-section-number">5.3</span> Solution</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minima(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions with the minimum skew in a DNA sequence."""</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> {<span class="st">"G"</span>: <span class="dv">1</span>, <span class="st">"C"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"T"</span>: <span class="dv">0</span>}</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(seq):</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        skew.append(skew[i] <span class="op">+</span> delta[nucleotide])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    min_skew <span class="op">=</span> <span class="bu">min</span>(skew)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (i <span class="cf">for</span> i, value <span class="kw">in</span> <span class="bu">enumerate</span>(skew) <span class="cf">if</span> value <span class="op">==</span> min_skew)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the positions with minimum skew</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_minima(sequence))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-hamming-distance-between-two-strings" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Compute the Hamming Distance Between Two Strings</h1>
<p>Hamming Distance Problem, Compute the Hamming distance between two DNA strings.</p>
<p>Given:&nbsp;Two DNA strings.</p>
<p>Return:&nbsp;An integer value representing the Hamming distance.</p>
<section id="sample-dataset-6" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sample-dataset-6"><span class="header-section-number">6.1</span> Sample Dataset</h2>
<pre><code>GGGCCGTTGGT
GGACCGTTGAC</code></pre>
</section>
<section id="sample-output-6" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sample-output-6"><span class="header-section-number">6.2</span> Sample Output</h2>
<pre><code>3</code></pre>
</section>
<section id="solution-6" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="solution-6"><span class="header-section-number">6.3</span> Solution</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> zip_longest</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> zip_longest(sequence1, sequence2, fillvalue<span class="op">=</span><span class="va">None</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_dna_sequences(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(input_string.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>Sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCCGTTGGT</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="st">GGACCGTTGAC</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>dna_sequence1, dna_sequence2 <span class="op">=</span> parse_dna_sequences(Sample_input)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>hamming_distance <span class="op">=</span> calculate_hamming_distance(dna_sequence1, dna_sequence2)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hamming_distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-approximate-occurrences-of-a-pattern-in-a-string" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Find All Approximate Occurrences of a Pattern in a String</h1>
<p>Approximate Pattern Matching Problem, Find all approximate occurrences of a pattern in a string.</p>
<p>Given:&nbsp;Strings&nbsp;<em>Pattern</em>&nbsp;and&nbsp;<em>Text</em>&nbsp;along with an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All starting positions where&nbsp;<em>Pattern</em>&nbsp;appears as a substring of&nbsp;<em>Text</em>&nbsp;with at most&nbsp;<em>d</em>&nbsp;mismatches.</p>
<section id="sample-dataset-7" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="sample-dataset-7"><span class="header-section-number">7.1</span> Sample Dataset</h2>
<pre><code>ATTCTGGA
CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC
3</code></pre>
</section>
<section id="sample-output-7" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sample-output-7"><span class="header-section-number">7.2</span> Sample Output</h2>
<pre><code>6 7 26 27 78</code></pre>
</section>
<section id="solution-7" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="solution-7"><span class="header-section-number">7.3</span> Solution</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_approximate_matches(pattern: <span class="bu">str</span>, genome: <span class="bu">str</span>, max_mismatch: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    pattern_length <span class="op">=</span> <span class="bu">len</span>(pattern)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (position <span class="cf">for</span> position, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(genome, pattern_length))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_mismatch)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    pattern, genome, max_mismatch_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pattern, genome, <span class="bu">int</span>(max_mismatch_str)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">ATTCTGGA</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>pattern, genome, max_mismatch <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>match_positions <span class="op">=</span> <span class="bu">list</span>(find_approximate_matches(pattern, genome, max_mismatch))</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>match_positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-most-frequent-words-with-mismatches-in-a-string" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Find the Most Frequent Words with Mismatches in a String</h1>
<p>Frequent Words with Mismatches Problem, Find the most frequent k-mers with mismatches in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;as well as integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All most frequent&nbsp;<em>k</em>-mers with up to&nbsp;<em>d</em>&nbsp;mismatches in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-8" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sample-dataset-8"><span class="header-section-number">8.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4 1</code></pre>
</section>
<section id="sample-output-8" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="sample-output-8"><span class="header-section-number">8.2</span> Sample Output</h2>
<pre><code>ATGC ATGT GATG</code></pre>
</section>
<section id="solution-8" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="solution-8"><span class="header-section-number">8.3</span> Solution</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna_sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna_sequence, kmer_length):</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(observed_kmers: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(observed_kmers[observed_kmer] </span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> observed_kmer <span class="kw">in</span> observed_kmers </span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>observed_kmers <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(observed_kmers, max_mismatches, kmer_length))</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>most_frequent_kmers <span class="op">=</span> find_most_frequent(approximate_kmer_counts)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent_kmers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-frequent-words-with-mismatches-and-reverse-complements" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Find Frequent Words with Mismatches and Reverse Complements</h1>
<p>Frequent Words with Mismatches and Reverse Complements Problem. Find the most frequent k-mers (with mismatches and reverse complements) in a DNA string.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Text</em>&nbsp;as well as integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All&nbsp;<em>k</em>-mers&nbsp;<em>Pattern</em>&nbsp;maximizing the sum&nbsp;*Count__d<em>(</em>Text<em>,&nbsp;<span class="math inline">\(Pattern\)</span>) +&nbsp;</em>Count__d<em>(</em>Text<em>,&nbsp;<span class="math inline">\(\overline{Pattern}\)</span>}) over all possible&nbsp;</em>k*-mers.</p>
<section id="sample-dataset-9" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="sample-dataset-9"><span class="header-section-number">9.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4 1</code></pre>
</section>
<section id="sample-output-9" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sample-output-9"><span class="header-section-number">9.2</span> Sample Output</h2>
<pre><code>ATGT ACAT</code></pre>
</section>
<section id="solution-9" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="solution-9"><span class="header-section-number">9.3</span> Solution</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna: <span class="bu">str</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna[i:i <span class="op">+</span> length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna) <span class="op">-</span> length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna, kmer_length):</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> hamming_distance(reverse_complement(potential_kmer), observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>kmer_counts <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(kmer_counts, max_mismatches, kmer_length))</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_most_frequent(approximate_kmer_counts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-frequency-array-of-a-string" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Generate the Frequency Array of a String</h1>
<p>Computing a Frequency Array, Generate the frequency array of a DNA string.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;The frequency array of&nbsp;<em>k</em>-mers in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-10" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="sample-dataset-10"><span class="header-section-number">10.1</span> Sample Dataset</h2>
<pre><code>ACGCGGCTCTGAAA
2</code></pre>
</section>
<section id="sample-output-10" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="sample-output-10"><span class="header-section-number">10.2</span> Sample Output</h2>
<pre><code>2 1 0 0 0 0 2 2 1 2 1 0 0 1 1 0</code></pre>
</section>
<section id="solution-10" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="solution-10"><span class="header-section-number">10.3</span> Solution</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict, Tuple</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (text[i : i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(s1: <span class="bu">str</span>, s2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(s1, s2))</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(k: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>k))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_frequencies(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_pattern_occurrences(sequence, kmer) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length)]</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    sequence, kmer_length <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(kmer_length)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="st">ACGCGGCTCTGAAA</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>sequence, kmer_length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>kmer_frequencies <span class="op">=</span> calculate_kmer_frequencies(sequence, kmer_length)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>kmer_frequencies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-patterntonumber" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Implement PatternToNumber</h1>
<p>Implement PatternToNumber, Convert a DNA string to a number.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<em>PatternToNumber</em>(<em>Pattern</em>).</p>
<section id="sample-dataset-11" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sample-dataset-11"><span class="header-section-number">11.1</span> Sample Dataset</h2>
<pre><code>AGT</code></pre>
</section>
<section id="sample-output-11" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sample-output-11"><span class="header-section-number">11.2</span> Sample Output</h2>
<pre><code>11</code></pre>
</section>
<section id="solution-11" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="solution-11"><span class="header-section-number">11.3</span> Solution</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_nucleotide_to_number_map() <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_nucleotide_to_number(nucleotide: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotide_map[nucleotide]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_dna_pattern_to_number(dna_pattern: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> dna_pattern:</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> convert_dna_pattern_to_number(dna_pattern[:<span class="op">-</span><span class="dv">1</span>], nucleotide_map) <span class="op">+</span> convert_nucleotide_to_number(dna_pattern[<span class="op">-</span><span class="dv">1</span>], nucleotide_map)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_data.strip()</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="st">AGT</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>nucleotide_map <span class="op">=</span> create_nucleotide_to_number_map()</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> convert_dna_pattern_to_number(dna_pattern, nucleotide_map)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-numbertopattern" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Implement NumberToPattern</h1>
<p>Implement NumberToPattern, Convert an integer to its corresponding DNA string.</p>
<p>Given:&nbsp;Integers&nbsp;<em>index</em>&nbsp;and&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;<em>NumberToPattern</em>(<em>index</em>,&nbsp;<em>k</em>).</p>
<section id="sample-dataset-12" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="sample-dataset-12"><span class="header-section-number">12.1</span> Sample Dataset</h2>
<pre><code>45
4</code></pre>
</section>
<section id="sample-output-12" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="sample-output-12"><span class="header-section-number">12.2</span> Sample Output</h2>
<pre><code>AGTC</code></pre>
</section>
<section id="solution-12" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="solution-12"><span class="header-section-number">12.3</span> Solution</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_nucleotide(index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotides[index]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_dna_pattern(index: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> length <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> number_to_nucleotide(index)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    quotient, remainder <span class="op">=</span> <span class="bu">divmod</span>(index, <span class="dv">4</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> number_to_dna_pattern(quotient, length <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> number_to_nucleotide(remainder)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    index_str, length_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(index_str), <span class="bu">int</span>(length_str)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="st">45</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>index, length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> number_to_dna_pattern(index, length)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dna_pattern)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-d-neighborhood-of-a-string" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Generate the d-Neighborhood of a String</h1>
<p>Generate the d-Neighborhood of a String Find all the neighbors of a pattern.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>&nbsp;and an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;The collection of strings&nbsp;<em>Neighbors</em>(<em>Pattern</em>,&nbsp;<em>d</em>).</p>
<section id="sample-dataset-13" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="sample-dataset-13"><span class="header-section-number">13.1</span> Sample Dataset</h2>
<pre><code>ACG
1</code></pre>
</section>
<section id="sample-output-13" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sample-output-13"><span class="header-section-number">13.2</span> Sample Output</h2>
<pre><code>CCG
TCG
GCG
AAG
ATG
AGG
ACA
ACC
ACT
ACG</code></pre>
</section>
<section id="solution-13" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="solution-13"><span class="header-section-number">13.3</span> Solution</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Set, List, Tuple, Iterator</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_immediate_neighbors(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, current_base <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> new_base <span class="kw">in</span> nucleotides:</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> new_base <span class="op">!=</span> current_base:</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence[:i] <span class="op">+</span> new_base <span class="op">+</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:]</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    suffix_neighbors <span class="op">=</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> suffix <span class="kw">in</span> suffix_neighbors:</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], suffix) <span class="op">&lt;</span> max_distance:</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>            neighbors.update(base <span class="op">+</span> suffix <span class="cf">for</span> base <span class="kw">in</span> nucleotides)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>            neighbors.add(sequence[<span class="dv">0</span>] <span class="op">+</span> suffix)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbors</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    sequence, distance <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(distance)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="st">ACG</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>sequence, max_distance <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>neighbor_sequences <span class="op">=</span> generate_neighbors(sequence, max_distance)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(neighbor_sequences), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-motifenumeration" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Implement MotifEnumeration</h1>
<p>Implanted Motif Problem. Implement MotifEnumeration (shown above) to find all (k, d)-motifs in a collection of strings.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;All (<em>k</em>,&nbsp;<em>d</em>)-motifs in&nbsp;<em>Dna</em>.</p>
<section id="sample-dataset-14" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="sample-dataset-14"><span class="header-section-number">14.1</span> Sample Dataset</h2>
<pre><code>3 1
ATTTGGC
TGCCTTA
CGGTATC
GAAAATT</code></pre>
</section>
<section id="sample-output-14" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="sample-output-14"><span class="header-section-number">14.2</span> Sample Output</h2>
<pre><code>ATA ATT GTT TTT</code></pre>
</section>
<section id="solution-14" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="solution-14"><span class="header-section-number">14.3</span> Solution</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Iterator</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    neighbor_set <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance):</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], neighbor) <span class="op">&lt;</span> max_distance:</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                neighbor_set.add(nucleotide <span class="op">+</span> neighbor)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>            neighbor_set.add(sequence[<span class="dv">0</span>] <span class="op">+</span> neighbor)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbor_set</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_kmers(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(kmer <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length))</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> contains_approximate_match(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_distance </span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enumerate_motifs(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    motif_patterns <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> get_all_kmers(dna_sequences, kmer_length):</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor_kmer <span class="kw">in</span> generate_neighbors(kmer, max_distance):</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(contains_approximate_match(neighbor_kmer, sequence, max_distance) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences):</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>                motif_patterns.add(neighbor_kmer)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> motif_patterns</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="st">ATTTGGC</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="st">TGCCTTA</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="st">CGGTATC</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="st">GAAAATT</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>input_params, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>kmer_length, max_distance <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_params.split())</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(enumerate_motifs(dna_sequences, kmer_length, max_distance)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-median-string" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Find a Median String</h1>
<p>Median String Problem, Find a median string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>k</em>-mer&nbsp;<em>Pattern</em>&nbsp;that minimizes&nbsp;<em>d</em>(<em>Pattern</em>,&nbsp;<em>Dna</em>) over all&nbsp;<em>k</em>-mers&nbsp;<em>Pattern</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-15" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="sample-dataset-15"><span class="header-section-number">15.1</span> Sample Dataset</h2>
<pre><code>3
AAATTGACGCAT
GACGACCACGTT
CGTCAGCGCCTG
GCTGAGCACCGG
AGTACGGGACAG</code></pre>
</section>
<section id="sample-output-15" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="sample-output-15"><span class="header-section-number">15.2</span> Sample Output</h2>
<pre><code>ACG</code></pre>
</section>
<section id="solution-15" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="solution-15"><span class="header-section-number">15.3</span> Solution</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(nucleotides) <span class="cf">for</span> nucleotides <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(nucleotide1 <span class="op">!=</span> nucleotide2 <span class="cf">for</span> nucleotide1, nucleotide2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(substring, pattern) <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_total_distance(pattern: <span class="bu">str</span>, dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, sequence) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_median_string(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    min_distance <span class="op">=</span> math.inf</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    median_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>        current_distance <span class="op">=</span> calculate_total_distance(kmer, dna_sequences)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_distance <span class="op">&lt;</span> min_distance:</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>            min_distance <span class="op">=</span> current_distance</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>            median_kmer <span class="op">=</span> kmer</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> median_kmer</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="st">AAATTGACGCAT</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="st">GACGACCACGTT</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="st">CGTCAGCGCCTG</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="st">GCTGAGCACCGG</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="st">AGTACGGGACAG</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>kmer_length, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_median_string(dna_sequences, <span class="bu">int</span>(kmer_length))</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-profile-most-probable-k-mer-in-a-string" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Find a Profile-most Probable k-mer in a String</h1>
<p>Profile-most Probable&nbsp;<em>k</em>-mer Problem, Find a Profile-most probable k-mer in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>, an integer&nbsp;<em>k</em>, and a 4 ×&nbsp;<em>k</em>&nbsp;matrix&nbsp;<em>Profile</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-16" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="sample-dataset-16"><span class="header-section-number">16.1</span> Sample Dataset</h2>
<pre><code>ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT
5
0.2 0.2 0.3 0.2 0.3
0.4 0.3 0.1 0.5 0.1
0.3 0.3 0.5 0.2 0.4
0.1 0.2 0.1 0.1 0.2</code></pre>
</section>
<section id="sample-output-16" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="sample-output-16"><span class="header-section-number">16.2</span> Sample Output</h2>
<pre><code>CCGAG</code></pre>
</section>
<section id="solution-16" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="solution-16"><span class="header-section-number">16.3</span> Solution</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_profile_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile_matrix: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    nucleotide_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    max_probability <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length):</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>        kmer_probability <span class="op">=</span> math.prod(profile_matrix[nucleotide_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="st">ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="st">0.2 0.2 0.3 0.2 0.3</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.3 0.1 0.5 0.1</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="st">0.3 0.3 0.5 0.2 0.4</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="st">0.1 0.2 0.1 0.1 0.2</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, <span class="op">*</span>profile_rows <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>profile_matrix <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> profile_rows]</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_profile_most_probable_kmer(dna_sequence, <span class="bu">int</span>(kmer_length), profile_matrix)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedymotifsearch" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Implement GreedyMotifSearch</h1>
<p>Implement, GreedyMotifSearch.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection of strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GreedyMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>). If at any step you find more than one&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in a given string, use the one occurring first.</p>
<section id="sample-dataset-17" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="sample-dataset-17"><span class="header-section-number">17.1</span> Sample Dataset</h2>
<pre><code>3 5
GGCGTTCAGGCA
AAGAATCAGTCA
CAAGGAGTTCGC
CACGTCAATCAC
CAATAATATTCG</code></pre>
</section>
<section id="sample-output-17" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="sample-output-17"><span class="header-section-number">17.2</span> Sample Output</h2>
<pre><code>CAG
CAG
CAA
CAA
CAA</code></pre>
</section>
<section id="solution-17" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="solution-17"><span class="header-section-number">17.3</span> Solution</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    max_probability: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length):</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>        kmer_probability: <span class="bu">float</span> <span class="op">=</span> math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(sequences: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> [[] <span class="cf">for</span> _ <span class="kw">in</span> nucleotides]</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(nucleotides):</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>        profile[i] <span class="op">=</span> [</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> sequences) <span class="op">+</span> pseudocount) <span class="op">/</span> <span class="bu">len</span>(sequences)</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequences[<span class="dv">0</span>]))</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>])):</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>        column: List[<span class="bu">str</span>] <span class="op">=</span> [motif[i] <span class="cf">for</span> motif <span class="kw">in</span> motifs]</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>        most_common: <span class="bu">str</span> <span class="op">=</span> Counter(column).most_common()[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">sum</span>(nucleotide <span class="op">!=</span> most_common <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [seq[:kmer_length] <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(dna_sequences)):</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>            current_profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount<span class="op">=</span>pseudocount)</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(dna_sequences[i], kmer_length, current_profile))</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a>ints, <span class="op">*</span>dna <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>k, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, ints.split())</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna, k)</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedymotifsearch-with-pseudocounts" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Implement GreedyMotifSearch with Pseudocounts</h1>
<p>Implement.&nbsp;<em>GreedyMotifSearch</em>&nbsp;with Pseudocounts.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection of strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GreedyMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>) with pseudocounts. If at any step you find more than one&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in a given string, use the one occurring first.</p>
<section id="sample-dataset-18" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="sample-dataset-18"><span class="header-section-number">18.1</span> Sample Dataset</h2>
<pre><code>3 5
GGCGTTCAGGCA
AAGAATCAGTCA
CAAGGAGTTCGC
CACGTCAATCAC
CAATAATATTCG</code></pre>
</section>
<section id="sample-output-18" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="sample-output-18"><span class="header-section-number">18.2</span> Sample Output</h2>
<pre><code>TTC
ATC
TTC
ATC
TTC</code></pre>
</section>
<section id="solution-18" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="solution-18"><span class="header-section-number">18.3</span> Solution</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][position] </span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">for</span> position, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> motif_count </span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [sequence[:kmer_length] <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences]</span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences[<span class="dv">1</span>:]:</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>            profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount)</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(sequence, kmer_length, profile))</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>k_value, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a>k_value <span class="op">=</span> <span class="bu">int</span>(k_value)</span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna_sequences, k_value, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-randomizedmotifsearch" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Implement RandomizedMotifSearch</h1>
<p>Implement&nbsp;<em>RandomizedMotifSearch</em>.</p>
<p>Given:&nbsp;Positive integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>RandomizedMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>) 1000 times. Remember to use pseudocounts!</p>
<section id="sample-dataset-19" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="sample-dataset-19"><span class="header-section-number">19.1</span> Sample Dataset</h2>
<pre><code>8 5
CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA
GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG
TAGTACCGAGACCGAAAGAAGTATACAGGCGT
TAGATCAAGTTTCAGGTGCACGTCGGTGAACC
AATCCACCAGCTCCACGTGCAATGTTGGCCTA</code></pre>
</section>
<section id="sample-output-19" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="sample-output-19"><span class="header-section-number">19.2</span> Sample Output</h2>
<pre><code>AACGGCCA
AAGTGCCA
TAGTACCG
AAGTTTCA
ACGTGCAA</code></pre>
</section>
<section id="solution-19" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="solution-19"><span class="header-section-number">19.3</span> Solution</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Callable</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> randint</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [sequence[i:i<span class="op">+</span>kmer_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][j] <span class="cf">for</span> j, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    profile <span class="op">=</span> []</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>        profile.append([</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (<span class="bu">len</span>(motifs) <span class="op">+</span> <span class="dv">4</span> <span class="op">*</span> pseudocount)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>]))</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start : start <span class="op">+</span> kmer_length]</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_motifs(profile: List[List[<span class="bu">float</span>]], dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>    kmer_length <span class="op">=</span> <span class="bu">len</span>(profile[<span class="dv">0</span>])</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [find_most_probable_kmer(seq, kmer_length, profile) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> randomized_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>    best_score <span class="op">=</span> math.inf</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>        motifs <span class="op">=</span> find_motifs(profile, dna_sequences)</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> calculate_score(motifs)</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;=</span> best_score:</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> best_score, motifs</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>        best_score <span class="op">=</span> current_score</span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a><span class="st">8 5</span></span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span></span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span></span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a><span class="st">TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span></span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span></span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a><span class="st">AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span></span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a>kmer_length, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(randomized_motif_search, <span class="dv">1000</span>, dna_sequences, kmer_length)</span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-gibbssampler" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Implement GibbsSampler</h1>
<p>Implement,&nbsp;<em>GibbsSampler</em>.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>,&nbsp;<em>t</em>, and&nbsp;<em>N</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;The strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GibbsSampler</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>,&nbsp;<em>N</em>) with 20 random starts. Remember to use pseudocounts!</p>
<section id="sample-dataset-20" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="sample-dataset-20"><span class="header-section-number">20.1</span> Sample Dataset</h2>
<pre><code>8 5 100
CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA
GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG
TAGTACCGAGACCGAAAGAAGTATACAGGCGT
TAGATCAAGTTTCAGGTGCACGTCGGTGAACC
AATCCACCAGCTCCACGTGCAATGTTGGCCTA</code></pre>
</section>
<section id="sample-output-20" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="sample-output-20"><span class="header-section-number">20.2</span> Sample Output</h2>
<pre><code>TCTCGGGG
CCAAGGTG
TACAGGCG
TTCAGGTG
TCCACGTG</code></pre>
</section>
<section id="solution-20" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="solution-20"><span class="header-section-number">20.3</span> Solution</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, Tuple, Callable</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (motif_count <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>pseudocount)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_probabilities(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>        math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length)</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> calculate_kmer_probabilities(sequence, kmer_length, profile)</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.choices(<span class="bu">range</span>(<span class="bu">len</span>(probabilities)), probabilities)[<span class="dv">0</span>]</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gibbs_sampler(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, num_iterations: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>    best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_iterations):</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(dna_sequences) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs[:i] <span class="op">+</span> motifs[i <span class="op">+</span> <span class="dv">1</span> :], pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>        motifs[i] <span class="op">=</span> select_random_kmer(dna_sequences[i], kmer_length, profile)</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> calculate_score(best_motifs), best_motifs</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a><span class="st">8 5 100</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a><span class="st">TCTCGGGG</span></span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGGTG</span></span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a><span class="st">TACAGGCG</span></span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a><span class="st">TTCAGGTG</span></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a><span class="st">TCCACGTG</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>kmer_length, num_sequences, num_iterations, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>num_iterations <span class="op">=</span> <span class="bu">int</span>(num_iterations)</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(gibbs_sampler, <span class="dv">20</span>, dna_sequences, kmer_length, num_iterations)</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-distancebetweenpatternandstrings" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Implement DistanceBetweenPatternAndStrings</h1>
<p>Compute DistanceBetweenPatternAndStrings. <em>Find the distance between a pattern and a set of strings.</em>.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>&nbsp;and a collection of DNA strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;<em>DistanceBetweenPatternAndStrings</em>(<em>Pattern</em>,&nbsp;<em>Dna</em>).</p>
<section id="sample-dataset-21" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="sample-dataset-21"><span class="header-section-number">21.1</span> Sample Dataset</h2>
<pre><code>AAA
TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</code></pre>
</section>
<section id="sample-output-21" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="sample-output-21"><span class="header-section-number">21.2</span> Sample Output</h2>
<pre><code>5</code></pre>
</section>
<section id="solution-21" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="solution-21"><span class="header-section-number">21.3</span> Solution</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(kmer, pattern) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_pattern_distance_to_strings(pattern: <span class="bu">str</span>, dna_strings: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, dna_string) <span class="cf">for</span> dna_string <span class="kw">in</span> dna_strings)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="st">TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>pattern, dna_strings_raw <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>dna_strings <span class="op">=</span> dna_strings_raw.split()</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_pattern_distance_to_strings(pattern, dna_strings)</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-k-mer-composition-of-a-string" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> Generate the k-mer Composition of a String</h1>
<p>String Composition Problem, Generate the k-mer composition of a string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;*Composition__k<em>(</em>Text<em>) (the&nbsp;</em>k*-mers can be provided in any order).</p>
<section id="sample-dataset-22" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="sample-dataset-22"><span class="header-section-number">22.1</span> Sample Dataset</h2>
<pre><code>5
CAATCCAAC</code></pre>
</section>
<section id="sample-output-22" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="sample-output-22"><span class="header-section-number">22.2</span> Sample Output</h2>
<pre><code>CAATC
AATCC
ATCCA
TCCAA
CCAAC</code></pre>
</section>
<section id="solution-22" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="solution-22"><span class="header-section-number">22.3</span> Solution</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i:i <span class="op">+</span> kmer_length]</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="st">CAATCCAAC</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>input_lines: <span class="bu">list</span>[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequence, kmer_length):</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-genome-path" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> Reconstruct a String from its Genome Path</h1>
<p>String Spelled by a Genome Path Problem, Find the string spelled by a genome path.</p>
<p>Given:&nbsp;A sequence of&nbsp;<em>k</em>-mers&nbsp;<em>Pattern1,…, Patternn</em>&nbsp;such that the last&nbsp;<em>k - 1</em>&nbsp;symbols of&nbsp;<em>Patterni</em>&nbsp;are equal to the first&nbsp;<em>k - 1</em>&nbsp;symbols of&nbsp;<em>Patterni+1</em>&nbsp;for&nbsp;<em>i</em>&nbsp;from 1 to n-1.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;of length&nbsp;<em>k+n-1</em>&nbsp;where the&nbsp;<em>i</em>-th&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>&nbsp;is equal to&nbsp;<em>Patterni</em>&nbsp;for all&nbsp;<em>i</em>.</p>
<section id="sample-dataset-23" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="sample-dataset-23"><span class="header-section-number">23.1</span> Sample Dataset</h2>
<pre><code>ACCGA
CCGAA
CGAAG
GAAGC
AAGCT</code></pre>
</section>
<section id="sample-output-23" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="sample-output-23"><span class="header-section-number">23.2</span> Sample Output</h2>
<pre><code>ACCGAAGCT</code></pre>
</section>
<section id="solution-23" class="level2" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="solution-23"><span class="header-section-number">23.3</span> Solution</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_dna_sequence(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    reconstructed_sequence: <span class="bu">str</span> <span class="op">=</span> kmers[<span class="dv">0</span>]</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(kmers)):</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>        reconstructed_sequence <span class="op">+=</span> kmers[i][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_sequence</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="st">ACCGA</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="st">CCGAA</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="st">CGAAG</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="st">GAAGC</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="st">AAGCT</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_dna_sequence(kmer_list))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-overlap-graph-of-a-collection-of-k-mers" class="level1" data-number="24">
<h1 data-number="24"><span class="header-section-number">24</span> Construct the Overlap Graph of a Collection of k-mers</h1>
<p>Overlap Graph Problem, Construct the overlap graph of a collection of k-mers.</p>
<p>Given:&nbsp;A collection&nbsp;<em>Patterns</em>&nbsp;of&nbsp;<em>k</em>-mers.</p>
<p>Return:&nbsp;The overlap graph&nbsp;<em>Overlap</em>(<em>Patterns</em>), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-24" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="sample-dataset-24"><span class="header-section-number">24.1</span> Sample Dataset</h2>
<pre><code>ATGCG
GCATG
CATGC
AGGCA
GGCAT</code></pre>
</section>
<section id="sample-output-24" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="sample-output-24"><span class="header-section-number">24.2</span> Sample Output</h2>
<pre><code>GCATG -&gt; CATGC
CATGC -&gt; ATGCG
AGGCA -&gt; GGCAT
GGCAT -&gt; GCATG</code></pre>
</section>
<section id="solution-24" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="solution-24"><span class="header-section-number">24.3</span> Solution</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> overlap_graph(patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>]]:</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    adj_list <span class="op">=</span> []</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j <span class="kw">and</span> patterns[i][<span class="dv">1</span>:] <span class="op">==</span> patterns[j][:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                adj_list.append((patterns[i], patterns[j]))</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adj_list</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="st">ATGCG</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="st">GCATG</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="st">CATGC</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="st">AGGCA</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="st">GGCAT</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>Patterns: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>adj_list <span class="op">=</span> overlap_graph(Patterns)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> adj_list:</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>edge[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>edge[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-de-bruijn-graph-of-a-string" class="level1" data-number="25">
<h1 data-number="25"><span class="header-section-number">25</span> Construct the De Bruijn Graph of a String</h1>
<p>De Bruijn Graph from a String Problem. Construct the de Bruijn graph of a string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a string&nbsp;<em>Text</em>.</p>
<p>Return:*DeBruijn__k<em>(</em>Text*), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-25" class="level2" data-number="25.1">
<h2 data-number="25.1" class="anchored" data-anchor-id="sample-dataset-25"><span class="header-section-number">25.1</span> Sample Dataset</h2>
<pre><code>4
AAGATTCTCTAC</code></pre>
</section>
<section id="sample-output-25" class="level2" data-number="25.2">
<h2 data-number="25.2" class="anchored" data-anchor-id="sample-output-25"><span class="header-section-number">25.2</span> Sample Output</h2>
<pre><code>AAG -&gt; AGA
AGA -&gt; GAT
ATT -&gt; TTC
CTA -&gt; TAC
CTC -&gt; TCT
GAT -&gt; ATT
TCT -&gt; CTA,CTC
TTC -&gt; TCT</code></pre>
</section>
<section id="solution-25" class="level2" data-number="25.3">
<h2 data-number="25.3" class="anchored" data-anchor-id="solution-25"><span class="header-section-number">25.3</span> Solution</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, OrderedDict <span class="im">as</span> OrderedDictType</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]]:</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    adjacency_list: OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]] <span class="op">=</span> OrderedDict()</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">2</span>):</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>        adjacency_list[sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:i <span class="op">+</span> kmer_length]</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>        adjacency_list[prefix].add(suffix)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="st">AAGATTCTCTAC</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(dna_sequence, kmer_length)</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> neighbors:</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-de-bruijn-graph-of-a-collection-of-k-mers" class="level1" data-number="26">
<h1 data-number="26"><span class="header-section-number">26</span> Construct the De Bruijn Graph of a Collection of k-mers</h1>
<p>De Bruijn Graph from&nbsp;<em>k</em>-mers Problem. Construct the de Bruijn graph from a collection of k-mers.</p>
<p>Given:&nbsp;A collection of&nbsp;<em>k</em>-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;The de Bruijn graph&nbsp;<em>DeBruijn</em>(<em>Patterns</em>), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-26" class="level2" data-number="26.1">
<h2 data-number="26.1" class="anchored" data-anchor-id="sample-dataset-26"><span class="header-section-number">26.1</span> Sample Dataset</h2>
<pre><code>GAGG
CAGG
GGGG
GGGA
CAGG
AGGG
GGAG</code></pre>
</section>
<section id="sample-output-26" class="level2" data-number="26.2">
<h2 data-number="26.2" class="anchored" data-anchor-id="sample-output-26"><span class="header-section-number">26.2</span> Sample Output</h2>
<pre><code>GAG -&gt; AGG
CAG -&gt; AGG,AGG
GGG -&gt; GGG,GGA
AGG -&gt; GGG
GGA -&gt; GAG</code></pre>
</section>
<section id="solution-26" class="level2" data-number="26.3">
<h2 data-number="26.3" class="anchored" data-anchor-id="solution-26"><span class="header-section-number">26.3</span> Solution</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_list:</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix].append(suffix)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="st">GAGG</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="st">GGGG</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="st">GGGA</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="st">AGGG</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="st">GGAG</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmer_list)</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-an-eulerian-cycle-in-a-graph" class="level1" data-number="27">
<h1 data-number="27"><span class="header-section-number">27</span> Find an Eulerian Cycle in a Graph</h1>
<p>Eulerian Cycle Problem, Find an Eulerian cycle in a graph.</p>
<p>Given:&nbsp;An Eulerian directed graph, in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<p>Return:&nbsp;An&nbsp;<a href="https://rosalind.info/glossary/eulerian-cycle/">Eulerian cycle</a>&nbsp;in this graph.</p>
<section id="sample-dataset-27" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="sample-dataset-27"><span class="header-section-number">27.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; 3
1 -&gt; 0
2 -&gt; 1,6
3 -&gt; 2
4 -&gt; 2
5 -&gt; 4
6 -&gt; 5,8
7 -&gt; 9
8 -&gt; 7
9 -&gt; 6</code></pre>
</section>
<section id="sample-output-27" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="sample-output-27"><span class="header-section-number">27.2</span> Sample Output</h2>
<pre><code>6-&gt;8-&gt;7-&gt;9-&gt;6-&gt;5-&gt;4-&gt;2-&gt;1-&gt;0-&gt;3-&gt;2-&gt;6</code></pre>
</section>
<section id="solution-27" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="solution-27"><span class="header-section-number">27.3</span> Solution</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_list_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> element <span class="kw">in</span> adjacency_list_text:</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, element)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Form a cycle by randomly walking in the graph</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Form new_cycle by traversing cycle (starting at new_start) and then randomly walking</span></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb84-52"><a href="#cb84-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-53"><a href="#cb84-53" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb84-54"><a href="#cb84-54" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 3</span></span>
<span id="cb84-55"><a href="#cb84-55" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 0</span></span>
<span id="cb84-56"><a href="#cb84-56" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1,6</span></span>
<span id="cb84-57"><a href="#cb84-57" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 2</span></span>
<span id="cb84-58"><a href="#cb84-58" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb84-59"><a href="#cb84-59" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 4</span></span>
<span id="cb84-60"><a href="#cb84-60" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 5,8</span></span>
<span id="cb84-61"><a href="#cb84-61" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 9</span></span>
<span id="cb84-62"><a href="#cb84-62" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 7</span></span>
<span id="cb84-63"><a href="#cb84-63" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb84-64"><a href="#cb84-64" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb84-65"><a href="#cb84-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-66"><a href="#cb84-66" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb84-67"><a href="#cb84-67" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb84-68"><a href="#cb84-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-69"><a href="#cb84-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_cycle(adjacency_list)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-an-eulerian-path-in-a-graph" class="level1" data-number="28">
<h1 data-number="28"><span class="header-section-number">28</span> Find an Eulerian Path in a Graph</h1>
<p>Eulerian Path Problem, Find an Eulerian path in a graph.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/directed-graph/">directed graph</a>&nbsp;that contains an Eulerian path, where the graph is given in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<p>Return:&nbsp;An Eulerian path in this graph.</p>
<section id="sample-dataset-28" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="sample-dataset-28"><span class="header-section-number">28.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; 2
1 -&gt; 3
2 -&gt; 1
3 -&gt; 0,4
6 -&gt; 3,7
7 -&gt; 8
8 -&gt; 9
9 -&gt; 6</code></pre>
</section>
<section id="sample-output-28" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="sample-output-28"><span class="header-section-number">28.2</span> Sample Output</h2>
<pre><code>6-&gt;7-&gt;8-&gt;9-&gt;6-&gt;3-&gt;0-&gt;2-&gt;1-&gt;3-&gt;4</code></pre>
</section>
<section id="solution-28" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="solution-28"><span class="header-section-number">28.3</span> Solution</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-66"><a href="#cb87-66" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb87-67"><a href="#cb87-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb87-68"><a href="#cb87-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb87-69"><a href="#cb87-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb87-70"><a href="#cb87-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-71"><a href="#cb87-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb87-72"><a href="#cb87-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-73"><a href="#cb87-73" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb87-74"><a href="#cb87-74" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 2</span></span>
<span id="cb87-75"><a href="#cb87-75" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 3</span></span>
<span id="cb87-76"><a href="#cb87-76" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1</span></span>
<span id="cb87-77"><a href="#cb87-77" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 0,4</span></span>
<span id="cb87-78"><a href="#cb87-78" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 3,7</span></span>
<span id="cb87-79"><a href="#cb87-79" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 8</span></span>
<span id="cb87-80"><a href="#cb87-80" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 9</span></span>
<span id="cb87-81"><a href="#cb87-81" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb87-82"><a href="#cb87-82" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb87-83"><a href="#cb87-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-84"><a href="#cb87-84" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb87-85"><a href="#cb87-85" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb87-86"><a href="#cb87-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-87"><a href="#cb87-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_path(adjacency_list)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-k-mer-composition" class="level1" data-number="29">
<h1 data-number="29"><span class="header-section-number">29</span> Reconstruct a String from its k-mer Composition</h1>
<p>String Reconstruction Problem. Reconstruct a string from its k-mer composition.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;followed by a list of&nbsp;<em>k</em>-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;with&nbsp;<em>k</em>-mer composition equal to&nbsp;<em>Patterns</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-29" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="sample-dataset-29"><span class="header-section-number">29.1</span> Sample Dataset</h2>
<pre><code>4
CTTA
ACCA
TACC
GGCT
GCTT
TTAC</code></pre>
</section>
<section id="sample-output-29" class="level2" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="sample-output-29"><span class="header-section-number">29.2</span> Sample Output</h2>
<pre><code>GGCTTACCA</code></pre>
</section>
<section id="solution-29" class="level2" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="solution-29"><span class="header-section-number">29.3</span> Solution</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb90-65"><a href="#cb90-65" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb90-66"><a href="#cb90-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb90-67"><a href="#cb90-67" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb90-68"><a href="#cb90-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-69"><a href="#cb90-69" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb90-70"><a href="#cb90-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb90-71"><a href="#cb90-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb90-72"><a href="#cb90-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb90-73"><a href="#cb90-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-74"><a href="#cb90-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb90-75"><a href="#cb90-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-76"><a href="#cb90-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb90-77"><a href="#cb90-77" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb90-78"><a href="#cb90-78" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(adjacency_list)</span>
<span id="cb90-79"><a href="#cb90-79" aria-hidden="true" tabindex="-1"></a>    reconstructed_string <span class="op">=</span> path[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-80"><a href="#cb90-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> path:</span>
<span id="cb90-81"><a href="#cb90-81" aria-hidden="true" tabindex="-1"></a>        reconstructed_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-82"><a href="#cb90-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_string</span>
<span id="cb90-83"><a href="#cb90-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-84"><a href="#cb90-84" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb90-85"><a href="#cb90-85" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb90-86"><a href="#cb90-86" aria-hidden="true" tabindex="-1"></a><span class="st">CTTA</span></span>
<span id="cb90-87"><a href="#cb90-87" aria-hidden="true" tabindex="-1"></a><span class="st">ACCA</span></span>
<span id="cb90-88"><a href="#cb90-88" aria-hidden="true" tabindex="-1"></a><span class="st">TACC</span></span>
<span id="cb90-89"><a href="#cb90-89" aria-hidden="true" tabindex="-1"></a><span class="st">GGCT</span></span>
<span id="cb90-90"><a href="#cb90-90" aria-hidden="true" tabindex="-1"></a><span class="st">GCTT</span></span>
<span id="cb90-91"><a href="#cb90-91" aria-hidden="true" tabindex="-1"></a><span class="st">TTAC</span></span>
<span id="cb90-92"><a href="#cb90-92" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb90-93"><a href="#cb90-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-94"><a href="#cb90-94" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb90-95"><a href="#cb90-95" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb90-96"><a href="#cb90-96" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb90-97"><a href="#cb90-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-98"><a href="#cb90-98" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string(kmers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-k-universal-circular-string" class="level1" data-number="30">
<h1 data-number="30"><span class="header-section-number">30</span> Find a k-Universal Circular String</h1>
<p><em>k</em>-Universal Circular String Problem. Find a k-universal circular binary string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>k</em>-universal circular string. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-30" class="level2" data-number="30.1">
<h2 data-number="30.1" class="anchored" data-anchor-id="sample-dataset-30"><span class="header-section-number">30.1</span> Sample Dataset</h2>
<p><code>4</code></p>
</section>
<section id="sample-output-30" class="level2" data-number="30.2">
<h2 data-number="30.2" class="anchored" data-anchor-id="sample-output-30"><span class="header-section-number">30.2</span> Sample Output</h2>
<pre><code>1111010010110000</code></pre>
</section>
<section id="solution-30" class="level2" data-number="30.3">
<h2 data-number="30.3" class="anchored" data-anchor-id="solution-30"><span class="header-section-number">30.3</span> Solution</h2>
<div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb92-37"><a href="#cb92-37" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb92-38"><a href="#cb92-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-39"><a href="#cb92-39" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb92-40"><a href="#cb92-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-41"><a href="#cb92-41" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb92-42"><a href="#cb92-42" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb92-43"><a href="#cb92-43" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb92-44"><a href="#cb92-44" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb92-45"><a href="#cb92-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb92-46"><a href="#cb92-46" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb92-47"><a href="#cb92-47" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb92-48"><a href="#cb92-48" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb92-49"><a href="#cb92-49" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb92-50"><a href="#cb92-50" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb92-51"><a href="#cb92-51" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb92-52"><a href="#cb92-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb92-53"><a href="#cb92-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-54"><a href="#cb92-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_k_universal_circular_string(k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb92-55"><a href="#cb92-55" aria-hidden="true" tabindex="-1"></a>    kmers: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb92-56"><a href="#cb92-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span> <span class="op">**</span> k):</span>
<span id="cb92-57"><a href="#cb92-57" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> <span class="bu">format</span>(i, <span class="ss">f'0</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">b'</span>)</span>
<span id="cb92-58"><a href="#cb92-58" aria-hidden="true" tabindex="-1"></a>        kmers.append(kmer)</span>
<span id="cb92-59"><a href="#cb92-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-60"><a href="#cb92-60" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb92-61"><a href="#cb92-61" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(adjacency_list)</span>
<span id="cb92-62"><a href="#cb92-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-63"><a href="#cb92-63" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> cycle[:<span class="bu">len</span>(cycle) <span class="op">-</span> k <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb92-64"><a href="#cb92-64" aria-hidden="true" tabindex="-1"></a>    circular_string <span class="op">=</span> cycle[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb92-65"><a href="#cb92-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> cycle:</span>
<span id="cb92-66"><a href="#cb92-66" aria-hidden="true" tabindex="-1"></a>        circular_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb92-67"><a href="#cb92-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> circular_string</span>
<span id="cb92-68"><a href="#cb92-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-69"><a href="#cb92-69" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb92-70"><a href="#cb92-70" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb92-71"><a href="#cb92-71" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb92-72"><a href="#cb92-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-73"><a href="#cb92-73" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb92-74"><a href="#cb92-74" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb92-75"><a href="#cb92-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-76"><a href="#cb92-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generate_k_universal_circular_string(k))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-paired-composition" class="level1" data-number="31">
<h1 data-number="31"><span class="header-section-number">31</span> Reconstruct a String from its Paired Composition</h1>
<p>String Reconstruction from Read-Pairs Problem. Reconstruct a string from its paired composition.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>&nbsp;followed by a collection of paired&nbsp;<em>k</em>-mers&nbsp;<em>PairedReads</em>.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;with (<em>k</em>,&nbsp;<em>d</em>)-mer composition equal to&nbsp;<em>PairedReads</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-31" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="sample-dataset-31"><span class="header-section-number">31.1</span> Sample Dataset</h2>
<pre><code>4 2
GAGA|TTGA
TCGT|GATG
CGTG|ATGT
TGGT|TGAG
GTGA|TGTT
GTGG|GTGA
TGAG|GTTG
GGTC|GAGA
GTCG|AGAT</code></pre>
</section>
<section id="sample-output-31" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="sample-output-31"><span class="header-section-number">31.2</span> Sample Output</h2>
<pre><code>GTGGTCGTGAGATGTTGA</code></pre>
</section>
<section id="solution-31" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="solution-31"><span class="header-section-number">31.3</span> Solution</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb95-48"><a href="#cb95-48" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb95-49"><a href="#cb95-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb95-50"><a href="#cb95-50" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb95-51"><a href="#cb95-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-52"><a href="#cb95-52" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb95-53"><a href="#cb95-53" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb95-54"><a href="#cb95-54" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-55"><a href="#cb95-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb95-56"><a href="#cb95-56" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb95-57"><a href="#cb95-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb95-58"><a href="#cb95-58" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb95-59"><a href="#cb95-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-60"><a href="#cb95-60" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb95-61"><a href="#cb95-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb95-62"><a href="#cb95-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb95-63"><a href="#cb95-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb95-64"><a href="#cb95-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-65"><a href="#cb95-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb95-66"><a href="#cb95-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-67"><a href="#cb95-67" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph_paired_reads(paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]]:</span>
<span id="cb95-68"><a href="#cb95-68" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb95-69"><a href="#cb95-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pair <span class="kw">in</span> paired_reads:</span>
<span id="cb95-70"><a href="#cb95-70" aria-hidden="true" tabindex="-1"></a>        graph[(pair[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>], pair[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>])].append((pair[<span class="dv">0</span>][<span class="dv">1</span>:], pair[<span class="dv">1</span>][<span class="dv">1</span>:]))</span>
<span id="cb95-71"><a href="#cb95-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb95-72"><a href="#cb95-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-73"><a href="#cb95-73" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> string_spelled_by_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb95-74"><a href="#cb95-74" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb95-75"><a href="#cb95-75" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">1</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>]</span>
<span id="cb95-76"><a href="#cb95-76" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb95-77"><a href="#cb95-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb95-78"><a href="#cb95-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb95-79"><a href="#cb95-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb95-80"><a href="#cb95-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb95-81"><a href="#cb95-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-82"><a href="#cb95-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_read_pairs(k: <span class="bu">int</span>, d: <span class="bu">int</span>, paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb95-83"><a href="#cb95-83" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph_paired_reads(paired_reads)</span>
<span id="cb95-84"><a href="#cb95-84" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(graph)</span>
<span id="cb95-85"><a href="#cb95-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> string_spelled_by_gapped_patterns(path, k <span class="op">-</span> <span class="dv">1</span>, d)</span>
<span id="cb95-86"><a href="#cb95-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-87"><a href="#cb95-87" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb95-88"><a href="#cb95-88" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb95-89"><a href="#cb95-89" aria-hidden="true" tabindex="-1"></a><span class="st">GAGA|TTGA</span></span>
<span id="cb95-90"><a href="#cb95-90" aria-hidden="true" tabindex="-1"></a><span class="st">TCGT|GATG</span></span>
<span id="cb95-91"><a href="#cb95-91" aria-hidden="true" tabindex="-1"></a><span class="st">CGTG|ATGT</span></span>
<span id="cb95-92"><a href="#cb95-92" aria-hidden="true" tabindex="-1"></a><span class="st">TGGT|TGAG</span></span>
<span id="cb95-93"><a href="#cb95-93" aria-hidden="true" tabindex="-1"></a><span class="st">GTGA|TGTT</span></span>
<span id="cb95-94"><a href="#cb95-94" aria-hidden="true" tabindex="-1"></a><span class="st">GTGG|GTGA</span></span>
<span id="cb95-95"><a href="#cb95-95" aria-hidden="true" tabindex="-1"></a><span class="st">TGAG|GTTG</span></span>
<span id="cb95-96"><a href="#cb95-96" aria-hidden="true" tabindex="-1"></a><span class="st">GGTC|GAGA</span></span>
<span id="cb95-97"><a href="#cb95-97" aria-hidden="true" tabindex="-1"></a><span class="st">GTCG|AGAT</span></span>
<span id="cb95-98"><a href="#cb95-98" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb95-99"><a href="#cb95-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-100"><a href="#cb95-100" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb95-101"><a href="#cb95-101" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb95-102"><a href="#cb95-102" aria-hidden="true" tabindex="-1"></a>paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb95-103"><a href="#cb95-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-104"><a href="#cb95-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_read_pairs(k, d, paired_reads))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-contigs-from-a-collection-of-reads" class="level1" data-number="32">
<h1 data-number="32"><span class="header-section-number">32</span> Generate Contigs from a Collection of Reads</h1>
<p>Contig Generation Problem. Generate the contigs from a collection of reads (with imperfect coverage).</p>
<p>Given:&nbsp;A collection of k-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All contigs in&nbsp;<em>DeBruijn(Patterns)</em>. (You may return the strings in any order.)</p>
<section id="sample-dataset-32" class="level2" data-number="32.1">
<h2 data-number="32.1" class="anchored" data-anchor-id="sample-dataset-32"><span class="header-section-number">32.1</span> Sample Dataset</h2>
<pre><code>ATG
ATG
TGT
TGG
CAT
GGA
GAT
AGA</code></pre>
</section>
<section id="sample-output-32" class="level2" data-number="32.2">
<h2 data-number="32.2" class="anchored" data-anchor-id="sample-output-32"><span class="header-section-number">32.2</span> Sample Output</h2>
<pre><code>AGA ATG ATG CAT GAT TGGA TGT</code></pre>
</section>
<section id="solution-32" class="level2" data-number="32.3">
<h2 data-number="32.3" class="anchored" data-anchor-id="solution-32"><span class="header-section-number">32.3</span> Solution</h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>        prefix, suffix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>], kmer[<span class="dv">1</span>:]</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[prefix].append(suffix)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(targets)]</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(targets)</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb98-47"><a href="#cb98-47" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb98-48"><a href="#cb98-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-49"><a href="#cb98-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb98-50"><a href="#cb98-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb98-51"><a href="#cb98-51" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb98-52"><a href="#cb98-52" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb98-53"><a href="#cb98-53" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb98-54"><a href="#cb98-54" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb98-55"><a href="#cb98-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb98-56"><a href="#cb98-56" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb98-57"><a href="#cb98-57" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb98-58"><a href="#cb98-58" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb98-59"><a href="#cb98-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb98-60"><a href="#cb98-60" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb98-61"><a href="#cb98-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-62"><a href="#cb98-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb98-63"><a href="#cb98-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-64"><a href="#cb98-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_contigs(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb98-65"><a href="#cb98-65" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb98-66"><a href="#cb98-66" aria-hidden="true" tabindex="-1"></a>    paths <span class="op">=</span> find_maximal_non_branching_paths(graph)</span>
<span id="cb98-67"><a href="#cb98-67" aria-hidden="true" tabindex="-1"></a>    contigs: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb98-68"><a href="#cb98-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> path <span class="kw">in</span> paths:</span>
<span id="cb98-69"><a href="#cb98-69" aria-hidden="true" tabindex="-1"></a>        contig <span class="op">=</span> path[<span class="dv">0</span>]</span>
<span id="cb98-70"><a href="#cb98-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> path[<span class="dv">1</span>:]:</span>
<span id="cb98-71"><a href="#cb98-71" aria-hidden="true" tabindex="-1"></a>            contig <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb98-72"><a href="#cb98-72" aria-hidden="true" tabindex="-1"></a>        contigs.append(contig)</span>
<span id="cb98-73"><a href="#cb98-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> contigs</span>
<span id="cb98-74"><a href="#cb98-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-75"><a href="#cb98-75" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb98-76"><a href="#cb98-76" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb98-77"><a href="#cb98-77" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb98-78"><a href="#cb98-78" aria-hidden="true" tabindex="-1"></a><span class="st">TGT</span></span>
<span id="cb98-79"><a href="#cb98-79" aria-hidden="true" tabindex="-1"></a><span class="st">TGG</span></span>
<span id="cb98-80"><a href="#cb98-80" aria-hidden="true" tabindex="-1"></a><span class="st">CAT</span></span>
<span id="cb98-81"><a href="#cb98-81" aria-hidden="true" tabindex="-1"></a><span class="st">GGA</span></span>
<span id="cb98-82"><a href="#cb98-82" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb98-83"><a href="#cb98-83" aria-hidden="true" tabindex="-1"></a><span class="st">AGA</span></span>
<span id="cb98-84"><a href="#cb98-84" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb98-85"><a href="#cb98-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-86"><a href="#cb98-86" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb98-87"><a href="#cb98-87" aria-hidden="true" tabindex="-1"></a>contigs <span class="op">=</span> generate_contigs(kmers)</span>
<span id="cb98-88"><a href="#cb98-88" aria-hidden="true" tabindex="-1"></a>contigs.sort()</span>
<span id="cb98-89"><a href="#cb98-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(contigs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-string-spelled-by-a-gapped-genome-path" class="level1" data-number="33">
<h1 data-number="33"><span class="header-section-number">33</span> Construct a String Spelled by a Gapped Genome Path</h1>
<p>Gapped Genome Path String Problem. Reconstruct a string from a sequence of (k,d)-mers corresponding to a path in a paired de Bruijn graph.</p>
<p>Given:&nbsp;A sequence of&nbsp;<em>(k, d)</em>-mers (<em>a1|b1</em>),…, (<em>an|bn</em>) such that&nbsp;<em>Suffix(ai|bi) = Prefix(ai+1|bi+1)</em>&nbsp;for all&nbsp;<em>i</em>&nbsp;from 1 to n-1.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;where the&nbsp;<em>i</em>-th&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>&nbsp;is equal to&nbsp;<em>Suffix(ai|bi)</em>&nbsp;for all&nbsp;<em>i</em>&nbsp;from 1 to n, if such a string exists.</p>
<section id="sample-dataset-33" class="level2" data-number="33.1">
<h2 data-number="33.1" class="anchored" data-anchor-id="sample-dataset-33"><span class="header-section-number">33.1</span> Sample Dataset</h2>
<pre><code>4 2
GACC|GCGC
ACCG|CGCC
CCGA|GCCG
CGAG|CCGG
GAGC|CGGA</code></pre>
</section>
<section id="sample-output-33" class="level2" data-number="33.2">
<h2 data-number="33.2" class="anchored" data-anchor-id="sample-output-33"><span class="header-section-number">33.2</span> Sample Output</h2>
<pre><code>GACCGAGCGCCGGA</code></pre>
</section>
<section id="solution-33" class="level2" data-number="33.3">
<h2 data-number="33.3" class="anchored" data-anchor-id="solution-33"><span class="header-section-number">33.3</span> Solution</h2>
<div class="sourceCode" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (prefix, suffix) <span class="kw">in</span> <span class="bu">enumerate</span>(gapped_patterns):</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">!=</span> <span class="bu">len</span>(gapped_patterns) <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix[<span class="dv">0</span>]</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix[<span class="dv">0</span>]</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="st">GACC|GCGC</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="st">ACCG|CGCC</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a><span class="st">CCGA|GCCG</span></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="st">CGAG|CCGG</span></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a><span class="st">GAGC|CGGA</span></span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a>gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_gapped_patterns(gapped_patterns, k <span class="op">-</span> <span class="dv">1</span>, d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-all-maximal-non-branching-paths-in-a-graph" class="level1" data-number="34">
<h1 data-number="34"><span class="header-section-number">34</span> Generate All Maximal Non-Branching Paths in a Graph</h1>
<p>Maximal Non-Branching Path Problem. Find all maximal non-branching paths in a graph.</p>
<p>Given:&nbsp;The adjacency list of a graph whose nodes are integers.</p>
<p>Return:&nbsp;The collection of all maximal non-branching paths in the graph.</p>
<section id="sample-dataset-34" class="level2" data-number="34.1">
<h2 data-number="34.1" class="anchored" data-anchor-id="sample-dataset-34"><span class="header-section-number">34.1</span> Sample Dataset</h2>
<pre><code>1 -&gt; 2
2 -&gt; 3
3 -&gt; 4,5
6 -&gt; 7
7 -&gt; 6</code></pre>
</section>
<section id="sample-output-34" class="level2" data-number="34.2">
<h2 data-number="34.2" class="anchored" data-anchor-id="sample-output-34"><span class="header-section-number">34.2</span> Sample Output</h2>
<pre><code>1 -&gt; 2 -&gt; 3
3 -&gt; 4
3 -&gt; 5
6 -&gt; 7 -&gt; 6</code></pre>
</section>
<section id="solution-34" class="level2" data-number="34.3">
<h2 data-number="34.3" class="anchored" data-anchor-id="solution-34"><span class="header-section-number">34.3</span> Solution</h2>
<div class="sourceCode" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[source] <span class="op">=</span> targets.split(<span class="st">','</span>)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(neighbors)]</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(neighbors)</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb104-44"><a href="#cb104-44" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb104-45"><a href="#cb104-45" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb104-46"><a href="#cb104-46" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb104-47"><a href="#cb104-47" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb104-48"><a href="#cb104-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-49"><a href="#cb104-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb104-50"><a href="#cb104-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb104-51"><a href="#cb104-51" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb104-52"><a href="#cb104-52" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb104-53"><a href="#cb104-53" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb104-54"><a href="#cb104-54" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb104-55"><a href="#cb104-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb104-56"><a href="#cb104-56" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb104-57"><a href="#cb104-57" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb104-58"><a href="#cb104-58" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb104-59"><a href="#cb104-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb104-60"><a href="#cb104-60" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb104-61"><a href="#cb104-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-62"><a href="#cb104-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb104-63"><a href="#cb104-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-64"><a href="#cb104-64" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb104-65"><a href="#cb104-65" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb104-66"><a href="#cb104-66" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb104-67"><a href="#cb104-67" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 4,5</span></span>
<span id="cb104-68"><a href="#cb104-68" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 7</span></span>
<span id="cb104-69"><a href="#cb104-69" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 6</span></span>
<span id="cb104-70"><a href="#cb104-70" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb104-71"><a href="#cb104-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-72"><a href="#cb104-72" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb104-73"><a href="#cb104-73" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb104-74"><a href="#cb104-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-75"><a href="#cb104-75" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_maximal_non_branching_paths(adjacency_list)</span>
<span id="cb104-76"><a href="#cb104-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> result:</span>
<span id="cb104-77"><a href="#cb104-77" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">" -&gt; "</span>.join(path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="translate-an-rna-string-into-an-amino-acid-string" class="level1" data-number="35">
<h1 data-number="35"><span class="header-section-number">35</span> Translate an RNA String into an Amino Acid String</h1>
<p>Protein Translation Problem. Translate an&nbsp;<a href="https://rosalind.info/glossary/rna-string/">RNA string</a>&nbsp;into an&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>.</p>
<p>Given:&nbsp;An RNA string&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;The translation of&nbsp;<em>Pattern</em>&nbsp;into an amino acid string&nbsp;<em>Peptide</em>.</p>
<section id="sample-dataset-35" class="level2" data-number="35.1">
<h2 data-number="35.1" class="anchored" data-anchor-id="sample-dataset-35"><span class="header-section-number">35.1</span> Sample Dataset</h2>
<pre><code>AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</code></pre>
</section>
<section id="sample-output-35" class="level2" data-number="35.2">
<h2 data-number="35.2" class="anchored" data-anchor-id="sample-output-35"><span class="header-section-number">35.2</span> Sample Output</h2>
<pre><code>MAMAPRTEINSTRING</code></pre>
</section>
<section id="solution-35" class="level2" data-number="35.3">
<h2 data-number="35.3" class="anchored" data-anchor-id="solution-35"><span class="header-section-number">35.3</span> Solution</h2>
<div class="sourceCode" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 코돈을 아미노산으로 변환하는 딕셔너리</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    codon_table: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>    protein_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 서열을 3개의 뉴클레오티드(코돈)씩 나누어 처리</span></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈이 3개의 뉴클레오티드로 완전하지 않으면 중단</span></span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈을 아미노산으로 변환</span></span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_table.get(codon, <span class="st">''</span>)</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 종결 코돈('*')을 만나면 번역 중단</span></span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a>        protein_sequence <span class="op">+=</span> amino_acid</span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> protein_sequence</span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 입력 RNA 서열</span></span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a><span class="st">AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</span></span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a>rna_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span>.join(sample_input.strip().split())</span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a><span class="co"># RNA를 단백질로 번역</span></span>
<span id="cb107-53"><a href="#cb107-53" aria-hidden="true" tabindex="-1"></a>protein: <span class="bu">str</span> <span class="op">=</span> translate_rna_to_protein(rna_sequence)</span>
<span id="cb107-54"><a href="#cb107-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-55"><a href="#cb107-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(protein)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-substrings-of-a-genome-encoding-a-given-amino-acid-string" class="level1" data-number="36">
<h1 data-number="36"><span class="header-section-number">36</span> Find Substrings of a Genome Encoding a Given Amino Acid String</h1>
<p>Peptide Encoding Problem, Find substrings of a genome encoding a given amino acid sequence.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>&nbsp;<em>Peptide</em>.</p>
<p>Return:&nbsp;All substrings of&nbsp;<em>Text</em>&nbsp;encoding&nbsp;<em>Peptide</em>&nbsp;(if any such substrings exist).</p>
<section id="sample-dataset-36" class="level2" data-number="36.1">
<h2 data-number="36.1" class="anchored" data-anchor-id="sample-dataset-36"><span class="header-section-number">36.1</span> Sample Dataset</h2>
<pre><code>ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA
MA</code></pre>
</section>
<section id="sample-output-36" class="level2" data-number="36.2">
<h2 data-number="36.2" class="anchored" data-anchor-id="sample-output-36"><span class="header-section-number">36.2</span> Sample Output</h2>
<pre><code>ATGGCC
GGCCAT
ATGGCC</code></pre>
</section>
<section id="solution-36" class="level2" data-number="36.3">
<h2 data-number="36.3" class="anchored" data-anchor-id="solution-36"><span class="header-section-number">36.3</span> Solution</h2>
<div class="sourceCode" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    codon_to_amino_acid: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>    protein_sequence: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_to_amino_acid.get(codon, <span class="st">''</span>)</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>        protein_sequence.append(amino_acid)</span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(protein_sequence)</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dna_to_rna(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence.replace(<span class="st">"T"</span>, <span class="st">"U"</span>)</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_peptide_encoding_substrings(dna_sequence: <span class="bu">str</span>, peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>    substring_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(peptide) <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>    encoding_substrings: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>        dna_substring: <span class="bu">str</span> <span class="op">=</span> dna_sequence[i:i <span class="op">+</span> substring_length]</span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a>        reverse_complement_substring: <span class="bu">str</span> <span class="op">=</span> reverse_complement(dna_substring)</span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>        rna_substring: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(dna_substring)</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a>        reverse_complement_rna: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(reverse_complement_substring)</span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (translate_rna_to_protein(rna_substring) <span class="op">==</span> peptide <span class="kw">or</span> </span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a>            translate_rna_to_protein(reverse_complement_rna) <span class="op">==</span> peptide):</span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a>            encoding_substrings.append(dna_substring)</span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> encoding_substrings</span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true" tabindex="-1"></a><span class="st">ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA</span></span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true" tabindex="-1"></a><span class="st">MA</span></span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-68"><a href="#cb110-68" aria-hidden="true" tabindex="-1"></a>dna_sequence, peptide <span class="op">=</span> sample_input.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb110-69"><a href="#cb110-69" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> find_peptide_encoding_substrings(dna_sequence, peptide)</span>
<span id="cb110-70"><a href="#cb110-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-theoretical-spectrum-of-a-cyclic-peptide" class="level1" data-number="37">
<h1 data-number="37"><span class="header-section-number">37</span> Generate the Theoretical Spectrum of a Cyclic Peptide</h1>
<p>Generating Theoretical Spectrum Problem, Generate the theoretical spectrum of a cyclic peptide.</p>
<p>Given:&nbsp;An amino acid string&nbsp;<em>Peptide</em>.</p>
<p>Return:&nbsp;<em>Cyclospectrum</em>(<em>Peptide</em>).</p>
<section id="sample-dataset-37" class="level2" data-number="37.1">
<h2 data-number="37.1" class="anchored" data-anchor-id="sample-dataset-37"><span class="header-section-number">37.1</span> Sample Dataset</h2>
<pre><code>LEQN</code></pre>
</section>
<section id="sample-output-37" class="level2" data-number="37.2">
<h2 data-number="37.2" class="anchored" data-anchor-id="sample-output-37"><span class="header-section-number">37.2</span> Sample Output</h2>
<pre><code>0 113 114 128 129 227 242 242 257 355 356 370 371 484</code></pre>
</section>
<section id="solution-37" class="level2" data-number="37.3">
<h2 data-number="37.3" class="anchored" data-anchor-id="solution-37"><span class="header-section-number">37.3</span> Solution</h2>
<div class="sourceCode" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide)</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>    circular_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subpeptide_length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> circular_peptide[start_index:start_index <span class="op">+</span> subpeptide_length]</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> subpeptide)</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(spectrum)</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="st">LEQN</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(input_peptide)</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-number-of-peptides-of-given-total-mass" class="level1" data-number="38">
<h1 data-number="38"><span class="header-section-number">38</span> Compute the Number of Peptides of Given Total Mass</h1>
<p>Counting Peptides with Given Mass Problem, Compute the number of peptides of given total mass.</p>
<p>Given:&nbsp;An integer&nbsp;<em>m</em>.</p>
<p>Return:&nbsp;The number of linear peptides having integer mass&nbsp;<em>m</em>.</p>
<section id="sample-dataset-38" class="level2" data-number="38.1">
<h2 data-number="38.1" class="anchored" data-anchor-id="sample-dataset-38"><span class="header-section-number">38.1</span> Sample Dataset</h2>
<pre><code>1024</code></pre>
</section>
<section id="sample-output-38" class="level2" data-number="38.2">
<h2 data-number="38.2" class="anchored" data-anchor-id="sample-output-38"><span class="header-section-number">38.2</span> Sample Output</h2>
<pre><code>14712706211</code></pre>
</section>
<section id="solution-38" class="level2" data-number="38.3">
<h2 data-number="38.3" class="anchored" data-anchor-id="solution-38"><span class="header-section-number">38.3</span> Solution</h2>
<div class="sourceCode" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>LIGHTEST_AMINO_ACID: <span class="bu">int</span> <span class="op">=</span> <span class="bu">min</span>(AMINO_ACID_MASSES)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_possible_peptides(target_mass: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    peptide_count: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_mass <span class="kw">in</span> <span class="bu">range</span>(LIGHTEST_AMINO_ACID, target_mass <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>        peptide_count[current_mass] <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES <span class="cf">if</span> amino_acid_mass <span class="op">==</span> current_mass)</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_mass <span class="op">&gt;=</span> amino_acid_mass:</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>                peptide_count[current_mass] <span class="op">+=</span> peptide_count[current_mass <span class="op">-</span> amino_acid_mass]</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide_count[target_mass]</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="st">1024</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>target_peptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(sample_input.strip())</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> count_possible_peptides(target_peptide_mass)</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum" class="level1" data-number="39">
<h1 data-number="39"><span class="header-section-number">39</span> Find a Cyclic Peptide with Theoretical Spectrum Matching an Ideal Spectrum</h1>
<p>Cyclopeptide Sequencing Problem, Given an ideal experimental spectrum, find a cyclic peptide whose theoretical spectrum matches the experimental spectrum.</p>
<p>Given:&nbsp;A collection of (possibly repeated) integers&nbsp;<em>Spectrum</em>&nbsp;corresponding to an ideal experimental spectrum.</p>
<p>Return:&nbsp;Every amino acid string&nbsp;<em>Peptide</em>&nbsp;such that&nbsp;<em>Cyclospectrum</em>(<em>Peptide</em>) =&nbsp;<em>Spectrum</em>&nbsp;(if such a string exists).</p>
<section id="sample-dataset-39" class="level2" data-number="39.1">
<h2 data-number="39.1" class="anchored" data-anchor-id="sample-dataset-39"><span class="header-section-number">39.1</span> Sample Dataset</h2>
<pre><code>0 113 128 186 241 299 314 427</code></pre>
</section>
<section id="sample-output-39" class="level2" data-number="39.2">
<h2 data-number="39.2" class="anchored" data-anchor-id="sample-output-39"><span class="header-section-number">39.2</span> Sample Output</h2>
<pre><code>113-128-186 113-186-128 186-128-113 128-186-113 186-113-128 128-113-186</code></pre>
</section>
<section id="solution-39" class="level2" data-number="39.3">
<h2 data-number="39.3" class="anchored" data-anchor-id="solution-39"><span class="header-section-number">39.3</span> Solution</h2>
<div class="sourceCode" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>    prefix_mass: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> peptide:</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>        prefix_mass.append(prefix_mass[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> mass)</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(prefix_mass[j] <span class="op">-</span> prefix_mass[i])</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>    linear_spectrum.sort()</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_spectrum</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> AMINO_ACID_MASSES[<span class="dv">0</span>]:</span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(mass <span class="kw">in</span> spectrum <span class="cf">for</span> mass <span class="kw">in</span> peptide_spectrum)</span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb119-46"><a href="#cb119-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb119-47"><a href="#cb119-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb119-50"><a href="#cb119-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb119-51"><a href="#cb119-51" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb119-52"><a href="#cb119-52" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb119-53"><a href="#cb119-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb119-54"><a href="#cb119-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-55"><a href="#cb119-55" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb119-56"><a href="#cb119-56" aria-hidden="true" tabindex="-1"></a><span class="st">0 113 128 186 241 299 314 427</span></span>
<span id="cb119-57"><a href="#cb119-57" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb119-58"><a href="#cb119-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-59"><a href="#cb119-59" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb119-60"><a href="#cb119-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-61"><a href="#cb119-61" aria-hidden="true" tabindex="-1"></a>result: Set[<span class="bu">str</span>] <span class="op">=</span> cyclopeptide_sequencing(input_spectrum)</span>
<span id="cb119-62"><a href="#cb119-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-score-of-a-cyclic-peptide-against-a-spectrum" class="level1" data-number="40">
<h1 data-number="40"><span class="header-section-number">40</span> Compute the Score of a Cyclic Peptide Against a Spectrum</h1>
<p>Cyclic Peptide Scoring Problem, Compute the score of a cyclic peptide against a spectrum.</p>
<p>Given:&nbsp;An amino acid string&nbsp;<em>Peptide</em>&nbsp;and a collection of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;The score of&nbsp;<em>Peptide</em>&nbsp;against&nbsp;<em>Spectrum</em>,&nbsp;<em>Score</em>(<em>Peptide</em>,&nbsp;<em>Spectrum</em>).</p>
<section id="sample-dataset-40" class="level2" data-number="40.1">
<h2 data-number="40.1" class="anchored" data-anchor-id="sample-dataset-40"><span class="header-section-number">40.1</span> Sample Dataset</h2>
<pre><code>NQEL
0 99 113 114 128 227 257 299 355 356 370 371 484</code></pre>
</section>
<section id="sample-output-40" class="level2" data-number="40.2">
<h2 data-number="40.2" class="anchored" data-anchor-id="sample-output-40"><span class="header-section-number">40.2</span> Sample Output</h2>
<pre><code>11</code></pre>
</section>
<section id="solution-40" class="level2" data-number="40.3">
<h2 data-number="40.3" class="anchored" data-anchor-id="solution-40"><span class="header-section-number">40.3</span> Solution</h2>
<div class="sourceCode" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> peptide)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    extended_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> subpeptide)</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-41"><a href="#cb122-41" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_score(input_peptide, input_spectrum)</span>
<span id="cb122-42"><a href="#cb122-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-leaderboardcyclopeptidesequencing" class="level1" data-number="41">
<h1 data-number="41"><span class="header-section-number">41</span> Implement LeaderboardCyclopeptideSequencing</h1>
<p>Implement&nbsp;<em>LeaderboardCyclopeptideSequencing</em></p>
<p>Given:&nbsp;An integer&nbsp;<em>N</em>&nbsp;and a collection of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;<em>LeaderPeptide</em>&nbsp;after running&nbsp;<em>LeaderboardCyclopeptideSequencing</em>(<em>Spectrum</em>,&nbsp;<em>N</em>).</p>
<section id="sample-dataset-41" class="level2" data-number="41.1">
<h2 data-number="41.1" class="anchored" data-anchor-id="sample-dataset-41"><span class="header-section-number">41.1</span> Sample Dataset</h2>
<pre><code>10
0 71 113 129 147 200 218 260 313 331 347 389 460</code></pre>
</section>
<section id="sample-output-41" class="level2" data-number="41.2">
<h2 data-number="41.2" class="anchored" data-anchor-id="sample-output-41"><span class="header-section-number">41.2</span> Sample Output</h2>
<pre><code>113-147-71-129</code></pre>
</section>
<section id="solution-41" class="level2" data-number="41.3">
<h2 data-number="41.3" class="anchored" data-anchor-id="solution-41"><span class="header-section-number">41.3</span> Solution</h2>
<div class="sourceCode" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Dict</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(peptide)</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(subpeptide)</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(peptide_spectrum.count(mass) <span class="op">&lt;=</span> spectrum.count(mass) <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(peptide_spectrum))</span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a>    unique_masses: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb125-51"><a href="#cb125-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-52"><a href="#cb125-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb125-53"><a href="#cb125-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb125-54"><a href="#cb125-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb125-55"><a href="#cb125-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-56"><a href="#cb125-56" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb125-57"><a href="#cb125-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb125-58"><a href="#cb125-58" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb125-59"><a href="#cb125-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-60"><a href="#cb125-60" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb125-61"><a href="#cb125-61" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="bu">len</span>(sorted_scores) <span class="cf">else</span> sorted_scores[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb125-62"><a href="#cb125-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-63"><a href="#cb125-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb125-64"><a href="#cb125-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-65"><a href="#cb125-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaderboard_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb125-66"><a href="#cb125-66" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb125-67"><a href="#cb125-67" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb125-68"><a href="#cb125-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-69"><a href="#cb125-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb125-70"><a href="#cb125-70" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard)</span>
<span id="cb125-71"><a href="#cb125-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb125-72"><a href="#cb125-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb125-73"><a href="#cb125-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb125-74"><a href="#cb125-74" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb125-75"><a href="#cb125-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb125-76"><a href="#cb125-76" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb125-77"><a href="#cb125-77" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb125-78"><a href="#cb125-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb125-79"><a href="#cb125-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-80"><a href="#cb125-80" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb125-81"><a href="#cb125-81" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb125-82"><a href="#cb125-82" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 113 129 147 200 218 260 313 331 347 389 460</span></span>
<span id="cb125-83"><a href="#cb125-83" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb125-84"><a href="#cb125-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-85"><a href="#cb125-85" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb125-86"><a href="#cb125-86" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb125-87"><a href="#cb125-87" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb125-88"><a href="#cb125-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-89"><a href="#cb125-89" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> leaderboard_cyclopeptide_sequencing(spectrum, n)</span>
<span id="cb125-90"><a href="#cb125-90" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-convolution-of-a-spectrum" class="level1" data-number="42">
<h1 data-number="42"><span class="header-section-number">42</span> Generate the Convolution of a Spectrum</h1>
<p>Spectral Convolution Problem, Compute the convolution of a spectrum.</p>
<p>Given:&nbsp;A collection of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;The list of elements in the convolution of&nbsp;<em>Spectrum</em>&nbsp;in decreasing order of their multiplicities. If an element has multiplicity&nbsp;<em>k</em>, it should appear exactly&nbsp;<em>k</em>&nbsp;times.</p>
<section id="sample-dataset-42" class="level2" data-number="42.1">
<h2 data-number="42.1" class="anchored" data-anchor-id="sample-dataset-42"><span class="header-section-number">42.1</span> Sample Dataset</h2>
<pre><code>0 137 186 323</code></pre>
</section>
<section id="sample-output-42" class="level2" data-number="42.2">
<h2 data-number="42.2" class="anchored" data-anchor-id="sample-output-42"><span class="header-section-number">42.2</span> Sample Output</h2>
<pre><code>137 137 186 186 323 49</code></pre>
</section>
<section id="solution-42" class="level2" data-number="42.3">
<h2 data-number="42.3" class="anchored" data-anchor-id="solution-42"><span class="header-section-number">42.3</span> Solution</h2>
<div class="sourceCode" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(spectrum)):</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>            mass_difference: <span class="bu">int</span> <span class="op">=</span> spectrum[j] <span class="op">-</span> spectrum[i]</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mass_difference <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(mass_difference)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict, key<span class="op">=</span>frequency_dict.get, reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>        result.extend([mass] <span class="op">*</span> frequency_dict[mass])</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a><span class="st">0 137 186 323</span></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a>convolution_result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(input_spectrum)</span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, convolution_result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-convolutioncyclopeptidesequencing" class="level1" data-number="43">
<h1 data-number="43"><span class="header-section-number">43</span> Implement ConvolutionCyclopeptideSequencing</h1>
<p>Implement&nbsp;<em>ConvolutionCyclopeptideSequencing</em>.</p>
<p>Given:&nbsp;An integer&nbsp;<em>M</em>, an integer&nbsp;<em>N</em>, and a collection of (possibly repeated) integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;A cyclic peptide LeaderPeptide with amino acids taken only from the top&nbsp;<em>M</em>&nbsp;elements (and ties) of the convolution of&nbsp;<em>Spectrum</em>&nbsp;that fall between 57 and 200, and where the size of&nbsp;<em>Leaderboard</em>&nbsp;is restricted to the top&nbsp;<em>N</em>&nbsp;(and ties).</p>
<section id="sample-dataset-43" class="level2" data-number="43.1">
<h2 data-number="43.1" class="anchored" data-anchor-id="sample-dataset-43"><span class="header-section-number">43.1</span> Sample Dataset</h2>
<pre><code>20
60
57 57 71 99 129 137 170 186 194 208 228 265 285 299 307 323 356 364 394 422 493</code></pre>
</section>
<section id="sample-output-43" class="level2" data-number="43.2">
<h2 data-number="43.2" class="anchored" data-anchor-id="sample-output-43"><span class="header-section-number">43.2</span> Sample Output</h2>
<pre><code>99-71-137-57-72-57</code></pre>
</section>
<section id="solution-43" class="level2" data-number="43.3">
<h2 data-number="43.3" class="anchored" data-anchor-id="solution-43"><span class="header-section-number">43.3</span> Solution</h2>
<div class="sourceCode" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectrum)):</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spectrum[j] <span class="op">-</span> spectrum[i] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(spectrum[j] <span class="op">-</span> spectrum[i])</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> [k <span class="cf">for</span> k, _ <span class="kw">in</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> item: item[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> [mass] <span class="op">*</span> frequency_dict[mass]</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_top_masses(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>    convolution: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(spectrum)</span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>    filtered_convolution: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> convolution <span class="cf">if</span> <span class="dv">57</span> <span class="op">&lt;=</span> x <span class="op">&lt;=</span> <span class="dv">200</span>]</span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(filtered_convolution):</span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> filtered_convolution.count(mass)</span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a>    sorted_elements: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> kv: kv[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a>    top_masses: List[<span class="bu">int</span>] <span class="op">=</span> [mass <span class="cf">for</span> mass, freq <span class="kw">in</span> sorted_elements <span class="cf">if</span> freq <span class="op">&gt;=</span> sorted_elements[m <span class="op">-</span> <span class="dv">1</span>][<span class="dv">1</span>]]</span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a>    top_masses.sort()</span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> top_masses</span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]], masses: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> masses:</span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convolution_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>, n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a>    masses: List[<span class="bu">int</span>] <span class="op">=</span> find_top_masses(spectrum, m)</span>
<span id="cb131-74"><a href="#cb131-74" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb131-75"><a href="#cb131-75" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb131-76"><a href="#cb131-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-77"><a href="#cb131-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb131-78"><a href="#cb131-78" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard, masses)</span>
<span id="cb131-79"><a href="#cb131-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb131-80"><a href="#cb131-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb131-81"><a href="#cb131-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb131-82"><a href="#cb131-82" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb131-83"><a href="#cb131-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb131-84"><a href="#cb131-84" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb131-85"><a href="#cb131-85" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb131-86"><a href="#cb131-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb131-87"><a href="#cb131-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-88"><a href="#cb131-88" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb131-89"><a href="#cb131-89" aria-hidden="true" tabindex="-1"></a><span class="st">20</span></span>
<span id="cb131-90"><a href="#cb131-90" aria-hidden="true" tabindex="-1"></a><span class="st">60</span></span>
<span id="cb131-91"><a href="#cb131-91" aria-hidden="true" tabindex="-1"></a><span class="st">57 57 71 99 129 137 170 186 194 208 228 265 285 299 307 323 356 364 394 422 493</span></span>
<span id="cb131-92"><a href="#cb131-92" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb131-93"><a href="#cb131-93" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb131-94"><a href="#cb131-94" aria-hidden="true" tabindex="-1"></a>m: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb131-95"><a href="#cb131-95" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb131-96"><a href="#cb131-96" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">2</span>].split()]</span>
<span id="cb131-97"><a href="#cb131-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-98"><a href="#cb131-98" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> convolution_cyclopeptide_sequencing(spectrum, m, n)</span>
<span id="cb131-99"><a href="#cb131-99" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-theoretical-spectrum-of-a-linear-peptide" class="level1" data-number="44">
<h1 data-number="44"><span class="header-section-number">44</span> Generate the Theoretical Spectrum of a Linear Peptide</h1>
<p>Linear Spectrum Problem, Generate the ideal linear spectrum of a peptide.</p>
<p>Given:&nbsp;An&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>&nbsp;<em>Peptide</em>.</p>
<p>Return:&nbsp;The linear spectrum of&nbsp;<em>Peptide</em>.</p>
<section id="sample-dataset-44" class="level2" data-number="44.1">
<h2 data-number="44.1" class="anchored" data-anchor-id="sample-dataset-44"><span class="header-section-number">44.1</span> Sample Dataset</h2>
<pre><code>NQEL</code></pre>
</section>
<section id="sample-output-44" class="level2" data-number="44.2">
<h2 data-number="44.2" class="anchored" data-anchor-id="sample-output-44"><span class="header-section-number">44.2</span> Sample Output</h2>
<pre><code>0 113 114 128 129 242 242 257 370 371 484</code></pre>
</section>
<section id="solution-44" class="level2" data-number="44.3">
<h2 data-number="44.3" class="anchored" data-anchor-id="solution-44"><span class="header-section-number">44.3</span> Solution</h2>
<div class="sourceCode" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb134-26"><a href="#cb134-26" aria-hidden="true" tabindex="-1"></a>sample_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">"NQEL"</span></span>
<span id="cb134-27"><a href="#cb134-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-28"><a href="#cb134-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear spectrum</span></span>
<span id="cb134-29"><a href="#cb134-29" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(sample_peptide)</span>
<span id="cb134-30"><a href="#cb134-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-score-of-a-linear-peptide" class="level1" data-number="45">
<h1 data-number="45"><span class="header-section-number">45</span> Compute the Score of a Linear Peptide</h1>
<p>Linear Peptide Scoring Problem, Compute the score of a linear peptide with respect to a spectrum.</p>
<p>Given:&nbsp;An amino acid string&nbsp;<em>Peptide</em>&nbsp;and a collection of integers&nbsp;<em>LinearSpectrum</em>.</p>
<p>Return:&nbsp;The linear score of&nbsp;<em>Peptide</em>&nbsp;against&nbsp;<em>Spectrum</em>,&nbsp;<em>LinearScore</em>(<em>Peptide</em>,&nbsp;<em>Spectrum</em>).</p>
<section id="sample-dataset-45" class="level2" data-number="45.1">
<h2 data-number="45.1" class="anchored" data-anchor-id="sample-dataset-45"><span class="header-section-number">45.1</span> Sample Dataset</h2>
<pre><code>NQEL
0 99 113 114 128 227 257 299 355 356 370 371 484</code></pre>
</section>
<section id="sample-output-45" class="level2" data-number="45.2">
<h2 data-number="45.2" class="anchored" data-anchor-id="sample-output-45"><span class="header-section-number">45.2</span> Sample Output</h2>
<pre><code>8</code></pre>
</section>
<section id="solution-45" class="level2" data-number="45.3">
<h2 data-number="45.3" class="anchored" data-anchor-id="solution-45"><span class="header-section-number">45.3</span> Solution</h2>
<div class="sourceCode" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-35"><a href="#cb137-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb137-36"><a href="#cb137-36" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb137-37"><a href="#cb137-37" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb137-38"><a href="#cb137-38" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb137-39"><a href="#cb137-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb137-40"><a href="#cb137-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-41"><a href="#cb137-41" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb137-42"><a href="#cb137-42" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb137-43"><a href="#cb137-43" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb137-44"><a href="#cb137-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-45"><a href="#cb137-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear score</span></span>
<span id="cb137-46"><a href="#cb137-46" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_linear_score(input_peptide, input_spectrum)</span>
<span id="cb137-47"><a href="#cb137-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="trim-a-peptide-leaderboard" class="level1" data-number="46">
<h1 data-number="46"><span class="header-section-number">46</span> Trim a Peptide Leaderboard</h1>
<p>Trim Problem, Trim a leaderboard of peptides.</p>
<p>Given:&nbsp;A leaderboard of linear peptides&nbsp;<em>Leaderboard</em>, a linear spectrum&nbsp;<em>Spectrum</em>, and an integer&nbsp;<em>N</em>.</p>
<p>Return:&nbsp;The top&nbsp;<em>N</em>&nbsp;peptides from&nbsp;<em>Leaderboard</em>&nbsp;scored against&nbsp;<em>Spectrum</em>. Remember to use&nbsp;<em>LinearScore</em>.</p>
<section id="sample-dataset-46" class="level2" data-number="46.1">
<h2 data-number="46.1" class="anchored" data-anchor-id="sample-dataset-46"><span class="header-section-number">46.1</span> Sample Dataset</h2>
<pre><code>LAST ALST TLLT TQAS
0 71 87 101 113 158 184 188 259 271 372
2</code></pre>
</section>
<section id="sample-output-46" class="level2" data-number="46.2">
<h2 data-number="46.2" class="anchored" data-anchor-id="sample-output-46"><span class="header-section-number">46.2</span> Sample Output</h2>
<pre><code>LAST ALST</code></pre>
</section>
<section id="solution-46" class="level2" data-number="46.3">
<h2 data-number="46.3" class="anchored" data-anchor-id="solution-46"><span class="header-section-number">46.3</span> Solution</h2>
<div class="sourceCode" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[<span class="bu">str</span>], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb140-37"><a href="#cb140-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb140-38"><a href="#cb140-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-39"><a href="#cb140-39" aria-hidden="true" tabindex="-1"></a>    peptide_scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb140-40"><a href="#cb140-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb140-41"><a href="#cb140-41" aria-hidden="true" tabindex="-1"></a>        peptide_scores[i] <span class="op">=</span> calculate_linear_score(peptide, spectrum)</span>
<span id="cb140-42"><a href="#cb140-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-43"><a href="#cb140-43" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(peptide_scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb140-44"><a href="#cb140-44" aria-hidden="true" tabindex="-1"></a>    score_threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb140-45"><a href="#cb140-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-46"><a href="#cb140-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> peptide_scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> score_threshold]</span>
<span id="cb140-47"><a href="#cb140-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-48"><a href="#cb140-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb140-49"><a href="#cb140-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb140-50"><a href="#cb140-50" aria-hidden="true" tabindex="-1"></a><span class="st">LAST ALST TLLT TQAS</span></span>
<span id="cb140-51"><a href="#cb140-51" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 87 101 113 158 184 188 259 271 372</span></span>
<span id="cb140-52"><a href="#cb140-52" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb140-53"><a href="#cb140-53" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb140-54"><a href="#cb140-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-55"><a href="#cb140-55" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb140-56"><a href="#cb140-56" aria-hidden="true" tabindex="-1"></a>input_leaderboard: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">0</span>].split()</span>
<span id="cb140-57"><a href="#cb140-57" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb140-58"><a href="#cb140-58" aria-hidden="true" tabindex="-1"></a>input_n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb140-59"><a href="#cb140-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-60"><a href="#cb140-60" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> trim_leaderboard(input_leaderboard, input_spectrum, input_n)</span>
<span id="cb140-61"><a href="#cb140-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="solve-the-turnpike-problem" class="level1" data-number="47">
<h1 data-number="47"><span class="header-section-number">47</span> Solve the Turnpike Problem</h1>
<p>Turnpike Problem. Given all pairwise distances between points on a line segment, reconstruct the positions of those points.</p>
<p>Given:&nbsp;A collection of integers&nbsp;<em>L</em>.</p>
<p>Return:&nbsp;A set&nbsp;<em>A</em>&nbsp;such that <span class="math inline">\(∆A\)</span>&nbsp;=&nbsp;<em>L</em>.</p>
<section id="sample-dataset-47" class="level2" data-number="47.1">
<h2 data-number="47.1" class="anchored" data-anchor-id="sample-dataset-47"><span class="header-section-number">47.1</span> Sample Dataset</h2>
<pre><code>-10 -8 -7 -6 -5 -4 -3 -3 -2 -2 0 0 0 0 0 2 2 3 3 4 5 6 7 8 10</code></pre>
</section>
<section id="sample-output-47" class="level2" data-number="47.2">
<h2 data-number="47.2" class="anchored" data-anchor-id="sample-output-47"><span class="header-section-number">47.2</span> Sample Output</h2>
<pre><code>0 2 4 7 10</code></pre>
</section>
<section id="solution-47" class="level2" data-number="47.3">
<h2 data-number="47.3" class="anchored" data-anchor-id="solution-47"><span class="header-section-number">47.3</span> Solution</h2>
<div class="sourceCode" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Optional</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_absolute_differences(set_a: Set[<span class="bu">int</span>], set_b: Set[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">abs</span>(a <span class="op">-</span> b) <span class="cf">for</span> a <span class="kw">in</span> set_a <span class="cf">for</span> b <span class="kw">in</span> set_b]</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_multiset_subset(subset: List[<span class="bu">int</span>], superset: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(subset.count(elem) <span class="op">&lt;=</span> superset.count(elem) <span class="cf">for</span> elem <span class="kw">in</span> <span class="bu">set</span>(subset))</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiset_difference(set_a: List[<span class="bu">int</span>], set_b: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    difference: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    unique_elements: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(set_a)</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> elem <span class="kw">in</span> unique_elements:</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>        count_difference <span class="op">=</span> set_a.count(elem) <span class="op">-</span> set_b.count(elem)</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count_difference <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>            difference.extend([elem] <span class="op">*</span> count_difference)</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(difference)</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> place_elements(distances: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Optional[Set[<span class="bu">int</span>]]:</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> distances:</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> placed_elements</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>    current_distance: <span class="bu">int</span> <span class="op">=</span> distances[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the left</span></span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>    left_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({current_distance}, placed_elements)</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(left_differences, distances):</span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(current_distance)</span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>        remaining_distances_left: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, left_differences)</span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>        left_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_left)</span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left_result:</span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> left_result</span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(current_distance)</span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the right</span></span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a>    right_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({total_width <span class="op">-</span> current_distance}, placed_elements)</span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(right_differences, distances):</span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(total_width <span class="op">-</span> current_distance)</span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a>        remaining_distances_right: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, right_differences)</span>
<span id="cb143-39"><a href="#cb143-39" aria-hidden="true" tabindex="-1"></a>        right_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_right)</span>
<span id="cb143-40"><a href="#cb143-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> right_result:</span>
<span id="cb143-41"><a href="#cb143-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> right_result</span>
<span id="cb143-42"><a href="#cb143-42" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(total_width <span class="op">-</span> current_distance)</span>
<span id="cb143-43"><a href="#cb143-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-44"><a href="#cb143-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb143-45"><a href="#cb143-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-46"><a href="#cb143-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb143-47"><a href="#cb143-47" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb143-48"><a href="#cb143-48" aria-hidden="true" tabindex="-1"></a><span class="st">-10 -8 -7 -6 -5 -4 -3 -3 -2 -2 0 0 0 0 0 2 2 3 3 4 5 6 7 8 10</span></span>
<span id="cb143-49"><a href="#cb143-49" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb143-50"><a href="#cb143-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-51"><a href="#cb143-51" aria-hidden="true" tabindex="-1"></a>input_distances: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb143-52"><a href="#cb143-52" aria-hidden="true" tabindex="-1"></a>positive_distances: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> input_distances <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb143-53"><a href="#cb143-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-54"><a href="#cb143-54" aria-hidden="true" tabindex="-1"></a>total_width: <span class="bu">int</span> <span class="op">=</span> positive_distances.pop(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb143-55"><a href="#cb143-55" aria-hidden="true" tabindex="-1"></a>placed_elements: Set[<span class="bu">int</span>] <span class="op">=</span> {<span class="dv">0</span>, total_width}</span>
<span id="cb143-56"><a href="#cb143-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-57"><a href="#cb143-57" aria-hidden="true" tabindex="-1"></a>result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(positive_distances)</span>
<span id="cb143-58"><a href="#cb143-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, <span class="bu">sorted</span>(result))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-minimum-number-of-coins-needed-to-make-change" class="level1" data-number="48">
<h1 data-number="48"><span class="header-section-number">48</span> Find the Minimum Number of Coins Needed to Make Change</h1>
<p>The Change Problem, Find the minimum number of coins needed to make change</p>
<p>Given:&nbsp;An integer&nbsp;<em>money</em>&nbsp;and an array&nbsp;<em>Coins</em>&nbsp;of positive integers.</p>
<p>Return:&nbsp;The minimum number of coins with denominations&nbsp;<em>Coins</em>&nbsp;that changes&nbsp;<em>money</em>.</p>
<section id="sample-dataset-48" class="level2" data-number="48.1">
<h2 data-number="48.1" class="anchored" data-anchor-id="sample-dataset-48"><span class="header-section-number">48.1</span> Sample Dataset</h2>
<pre><code>40
1,5,10,20,25,50</code></pre>
</section>
<section id="sample-output-48" class="level2" data-number="48.2">
<h2 data-number="48.2" class="anchored" data-anchor-id="sample-output-48"><span class="header-section-number">48.2</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution-48" class="level2" data-number="48.3">
<h2 data-number="48.3" class="anchored" data-anchor-id="solution-48"><span class="header-section-number">48.3</span> Solution</h2>
<div class="sourceCode" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> min_coins_for_change(target_amount: <span class="bu">int</span>, available_coins: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    min_coins_needed <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_amount <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, target_amount <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>        min_coins_needed.append(target_amount <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> coin <span class="kw">in</span> available_coins:</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_amount <span class="op">&gt;=</span> coin:</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>                coins_for_current <span class="op">=</span> min_coins_needed[current_amount <span class="op">-</span> coin] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> coins_for_current <span class="op">&lt;</span> min_coins_needed[current_amount]:</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>                    min_coins_needed[current_amount] <span class="op">=</span> coins_for_current</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> min_coins_needed[target_amount]</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="st">40</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="st">1,5,10,20,25,50</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a>target_amount <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a>available_coins <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split(<span class="st">","</span>)]</span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(min_coins_for_change(target_amount, available_coins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-length-of-a-longest-path-in-a-manhattan-like-grid" class="level1" data-number="49">
<h1 data-number="49"><span class="header-section-number">49</span> Find the Length of a Longest Path in a Manhattan-like Grid</h1>
<p>Length of a Longest Path in the Manhattan Tourist Problem. Find the length of a longest path in a rectangular city.</p>
<p>Given:&nbsp;Integers&nbsp;<em>n</em>&nbsp;and&nbsp;<em>m</em>, followed by an&nbsp;<em>n</em>&nbsp;× (<em>m</em>+1) matrix&nbsp;<em>Down</em>&nbsp;and an (<em>n</em>+1) ×&nbsp;<em>m</em>&nbsp;matrix&nbsp;<em>Right</em>. The two matrices are separated by the”-“symbol.</p>
<p>Return:&nbsp;The length of a longest path from source (0, 0) to sink (<em>n</em>,&nbsp;<em>m</em>) in the&nbsp;<em>n</em>&nbsp;×&nbsp;<em>m</em>&nbsp;rectangular grid whose edges are defined by the matrices&nbsp;<em>Down</em>&nbsp;and&nbsp;<em>Right</em>.</p>
<section id="sample-dataset-49" class="level2" data-number="49.1">
<h2 data-number="49.1" class="anchored" data-anchor-id="sample-dataset-49"><span class="header-section-number">49.1</span> Sample Dataset</h2>
<pre><code>4 4
1 0 2 4 3
4 6 5 2 1
4 4 5 2 1
5 6 8 5 3
-
3 2 4 0
3 2 4 2
0 7 3 3
3 3 0 2
1 3 2 2</code></pre>
</section>
<section id="sample-output-49" class="level2" data-number="49.2">
<h2 data-number="49.2" class="anchored" data-anchor-id="sample-output-49"><span class="header-section-number">49.2</span> Sample Output</h2>
<pre><code>34</code></pre>
</section>
<section id="solution-49" class="level2" data-number="49.3">
<h2 data-number="49.3" class="anchored" data-anchor-id="solution-49"><span class="header-section-number">49.3</span> Solution</h2>
<div class="sourceCode" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_manhattan_tourist_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, List[List[<span class="bu">int</span>]], List[List[<span class="bu">int</span>]]]:</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_text.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>    rows, cols <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">0</span>].split())</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>    down_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows)]</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows):</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>            down_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>    separator_index <span class="op">=</span> rows <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>    right_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> cols <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> separator_index <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols):</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>            right_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rows, cols, down_weights, right_weights</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_longest_manhattan_path(rows: <span class="bu">int</span>, cols: <span class="bu">int</span>, down_weights: List[List[<span class="bu">int</span>]], right_weights: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>    path_scores <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>        path_scores[i][<span class="dv">0</span>] <span class="op">=</span> path_scores[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>        path_scores[<span class="dv">0</span>][j] <span class="op">=</span> path_scores[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a>            path_scores[i][j] <span class="op">=</span> <span class="bu">max</span>(path_scores[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][j],</span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a>                                    path_scores[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[i][j <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_scores[rows][cols]</span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a><span class="st">4 4</span></span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a><span class="st">1 0 2 4 3</span></span>
<span id="cb149-41"><a href="#cb149-41" aria-hidden="true" tabindex="-1"></a><span class="st">4 6 5 2 1</span></span>
<span id="cb149-42"><a href="#cb149-42" aria-hidden="true" tabindex="-1"></a><span class="st">4 4 5 2 1</span></span>
<span id="cb149-43"><a href="#cb149-43" aria-hidden="true" tabindex="-1"></a><span class="st">5 6 8 5 3</span></span>
<span id="cb149-44"><a href="#cb149-44" aria-hidden="true" tabindex="-1"></a><span class="st">-</span></span>
<span id="cb149-45"><a href="#cb149-45" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 0</span></span>
<span id="cb149-46"><a href="#cb149-46" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 2</span></span>
<span id="cb149-47"><a href="#cb149-47" aria-hidden="true" tabindex="-1"></a><span class="st">0 7 3 3</span></span>
<span id="cb149-48"><a href="#cb149-48" aria-hidden="true" tabindex="-1"></a><span class="st">3 3 0 2</span></span>
<span id="cb149-49"><a href="#cb149-49" aria-hidden="true" tabindex="-1"></a><span class="st">1 3 2 2</span></span>
<span id="cb149-50"><a href="#cb149-50" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb149-51"><a href="#cb149-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-52"><a href="#cb149-52" aria-hidden="true" tabindex="-1"></a>rows, cols, down_weights, right_weights <span class="op">=</span> parse_manhattan_tourist_input(sample_input)</span>
<span id="cb149-53"><a href="#cb149-53" aria-hidden="true" tabindex="-1"></a>longest_path_score <span class="op">=</span> calculate_longest_manhattan_path(rows, cols, down_weights, right_weights)</span>
<span id="cb149-54"><a href="#cb149-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>longest_path_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-longest-common-subsequence-of-two-strings" class="level1" data-number="50">
<h1 data-number="50"><span class="header-section-number">50</span> Find a Longest Common Subsequence of Two Strings</h1>
<p>Longest Common Subsequence Problem.</p>
<p>Given:&nbsp;Two strings.</p>
<p>Return:&nbsp;A longest common subsequence of these strings.</p>
<section id="sample-dataset-50" class="level2" data-number="50.1">
<h2 data-number="50.1" class="anchored" data-anchor-id="sample-dataset-50"><span class="header-section-number">50.1</span> Sample Dataset</h2>
<pre><code>AACCTTGG
ACACTGTGA</code></pre>
</section>
<section id="sample-output-50" class="level2" data-number="50.2">
<h2 data-number="50.2" class="anchored" data-anchor-id="sample-output-50"><span class="header-section-number">50.2</span> Sample Output</h2>
<pre><code>AACTGG</code></pre>
</section>
<section id="solution-50" class="level2" data-number="50.3">
<h2 data-number="50.3" class="anchored" data-anchor-id="solution-50"><span class="header-section-number">50.3</span> Solution</h2>
<div class="sourceCode" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_common_subsequence(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>    padded_seq1 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence1</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>    padded_seq2 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence2</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="cf">if</span> padded_seq1[i] <span class="op">==</span> padded_seq2[j] <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j], score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>], match_score)</span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j]:</span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diag"</span></span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a>    lcs <span class="op">=</span> <span class="st">""</span></span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb152-24"><a href="#cb152-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb152-25"><a href="#cb152-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"diag"</span>:</span>
<span id="cb152-26"><a href="#cb152-26" aria-hidden="true" tabindex="-1"></a>            lcs <span class="op">=</span> padded_seq1[i] <span class="op">+</span> lcs</span>
<span id="cb152-27"><a href="#cb152-27" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb152-28"><a href="#cb152-28" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb152-29"><a href="#cb152-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"left"</span>:</span>
<span id="cb152-30"><a href="#cb152-30" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb152-31"><a href="#cb152-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb152-32"><a href="#cb152-32" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb152-33"><a href="#cb152-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-34"><a href="#cb152-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lcs</span>
<span id="cb152-35"><a href="#cb152-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-36"><a href="#cb152-36" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb152-37"><a href="#cb152-37" aria-hidden="true" tabindex="-1"></a><span class="st">AACCTTGG</span></span>
<span id="cb152-38"><a href="#cb152-38" aria-hidden="true" tabindex="-1"></a><span class="st">ACACTGTGA</span></span>
<span id="cb152-39"><a href="#cb152-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb152-40"><a href="#cb152-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-41"><a href="#cb152-41" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb152-42"><a href="#cb152-42" aria-hidden="true" tabindex="-1"></a>sequence1 <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb152-43"><a href="#cb152-43" aria-hidden="true" tabindex="-1"></a>sequence2 <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb152-44"><a href="#cb152-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-45"><a href="#cb152-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_common_subsequence(sequence1, sequence2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-longest-path-in-a-dag" class="level1" data-number="51">
<h1 data-number="51"><span class="header-section-number">51</span> Find the Longest Path in a DAG</h1>
<p>Longest Path in a DAG Problem. Find a longest path between two nodes in an edge-weighted DAG.</p>
<p>Given:&nbsp;An integer representing the source node of a graph, followed by an integer representing the sink node of the graph, followed by an edge-weighted graph. The graph is represented by a modified&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>&nbsp;in which the notation”0-&gt;1:7”indicates that an edge connects node 0 to node 1 with weight 7.</p>
<p>Return:&nbsp;The length of a longest path in the graph, followed by a longest path. (If multiple longest paths exist, you may return any one.)</p>
<section id="sample-dataset-51" class="level2" data-number="51.1">
<h2 data-number="51.1" class="anchored" data-anchor-id="sample-dataset-51"><span class="header-section-number">51.1</span> Sample Dataset</h2>
<pre><code>0
4
0-&gt;1:7
0-&gt;2:4
2-&gt;3:2
1-&gt;4:1
3-&gt;4:3</code></pre>
</section>
<section id="sample-output-51" class="level2" data-number="51.2">
<h2 data-number="51.2" class="anchored" data-anchor-id="sample-output-51"><span class="header-section-number">51.2</span> Sample Output</h2>
<pre><code>9
0-&gt;2-&gt;3-&gt;4</code></pre>
</section>
<section id="solution-51" class="level2" data-number="51.3">
<h2 data-number="51.3" class="anchored" data-anchor-id="solution-51"><span class="header-section-number">51.3</span> Solution</h2>
<div class="sourceCode" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Optional</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Node:</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, label: <span class="bu">str</span>):</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label: <span class="bu">str</span> <span class="op">=</span> label</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.parent_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.target_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.visited: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DAG:</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict: Dict[<span class="bu">str</span>, Node] <span class="op">=</span> {}</span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances: Dict[<span class="bu">str</span>, <span class="bu">float</span>] <span class="op">=</span> {}</span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack: Dict[<span class="bu">str</span>, Optional[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>, label: <span class="bu">str</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Node(label)</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict[label] <span class="op">=</span> new_node</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_dag(<span class="va">self</span>, adjacency_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> adjacency_list:</span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a>            source_label, temp <span class="op">=</span> line.split(<span class="st">"-&gt;"</span>)</span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a>            target_label, weight_str <span class="op">=</span> temp.split(<span class="st">":"</span>)</span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>            weight <span class="op">=</span> <span class="bu">int</span>(weight_str)</span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>            source_node <span class="op">=</span> <span class="va">self</span>.add_node(source_label)</span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a>            target_node <span class="op">=</span> <span class="va">self</span>.add_node(target_label)</span>
<span id="cb155-32"><a href="#cb155-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-33"><a href="#cb155-33" aria-hidden="true" tabindex="-1"></a>            source_node.target_nodes.append((target_node, weight))</span>
<span id="cb155-34"><a href="#cb155-34" aria-hidden="true" tabindex="-1"></a>            target_node.parent_nodes.append((source_node, weight))</span>
<span id="cb155-35"><a href="#cb155-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-36"><a href="#cb155-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort_util(<span class="va">self</span>, current_node: Node, sorted_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb155-37"><a href="#cb155-37" aria-hidden="true" tabindex="-1"></a>        current_node.visited <span class="op">=</span> <span class="va">True</span></span>
<span id="cb155-38"><a href="#cb155-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor, _ <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb155-39"><a href="#cb155-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> neighbor.visited:</span>
<span id="cb155-40"><a href="#cb155-40" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(neighbor, sorted_labels)</span>
<span id="cb155-41"><a href="#cb155-41" aria-hidden="true" tabindex="-1"></a>        sorted_labels.insert(<span class="dv">0</span>, current_node.label)</span>
<span id="cb155-42"><a href="#cb155-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-43"><a href="#cb155-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort(<span class="va">self</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb155-44"><a href="#cb155-44" aria-hidden="true" tabindex="-1"></a>        sorted_labels: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb155-45"><a href="#cb155-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.nodes_dict.values():</span>
<span id="cb155-46"><a href="#cb155-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> node.visited:</span>
<span id="cb155-47"><a href="#cb155-47" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(node, sorted_labels)</span>
<span id="cb155-48"><a href="#cb155-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sorted_labels</span>
<span id="cb155-49"><a href="#cb155-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-50"><a href="#cb155-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> longest_path(<span class="va">self</span>, source: <span class="bu">str</span>, sink: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb155-51"><a href="#cb155-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb155-52"><a href="#cb155-52" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.distances[label] <span class="op">=</span> <span class="bu">float</span>(<span class="st">"-inf"</span>)</span>
<span id="cb155-53"><a href="#cb155-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-54"><a href="#cb155-54" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances[source] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb155-55"><a href="#cb155-55" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack[source] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb155-56"><a href="#cb155-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-57"><a href="#cb155-57" aria-hidden="true" tabindex="-1"></a>        topological_order <span class="op">=</span> <span class="va">self</span>.topological_sort()</span>
<span id="cb155-58"><a href="#cb155-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> topological_order:</span>
<span id="cb155-59"><a href="#cb155-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb155-60"><a href="#cb155-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target_node, weight <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb155-61"><a href="#cb155-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.distances[target_node.label] <span class="op">&lt;</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight:</span>
<span id="cb155-62"><a href="#cb155-62" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.distances[target_node.label] <span class="op">=</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight</span>
<span id="cb155-63"><a href="#cb155-63" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.backtrack[target_node.label] <span class="op">=</span> label</span>
<span id="cb155-64"><a href="#cb155-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-65"><a href="#cb155-65" aria-hidden="true" tabindex="-1"></a>        path: List[<span class="bu">str</span>] <span class="op">=</span> [sink]</span>
<span id="cb155-66"><a href="#cb155-66" aria-hidden="true" tabindex="-1"></a>        current_label <span class="op">=</span> <span class="va">self</span>.backtrack[sink]</span>
<span id="cb155-67"><a href="#cb155-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_label <span class="op">!=</span> source:</span>
<span id="cb155-68"><a href="#cb155-68" aria-hidden="true" tabindex="-1"></a>            path <span class="op">=</span> [current_label] <span class="op">+</span> path</span>
<span id="cb155-69"><a href="#cb155-69" aria-hidden="true" tabindex="-1"></a>            current_label <span class="op">=</span> <span class="va">self</span>.backtrack[current_label]</span>
<span id="cb155-70"><a href="#cb155-70" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> [source] <span class="op">+</span> path</span>
<span id="cb155-71"><a href="#cb155-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.distances[sink], path</span>
<span id="cb155-72"><a href="#cb155-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-73"><a href="#cb155-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb155-74"><a href="#cb155-74" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb155-75"><a href="#cb155-75" aria-hidden="true" tabindex="-1"></a><span class="st">0</span></span>
<span id="cb155-76"><a href="#cb155-76" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb155-77"><a href="#cb155-77" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;1:7</span></span>
<span id="cb155-78"><a href="#cb155-78" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;2:4</span></span>
<span id="cb155-79"><a href="#cb155-79" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;3:2</span></span>
<span id="cb155-80"><a href="#cb155-80" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:1</span></span>
<span id="cb155-81"><a href="#cb155-81" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;4:3</span></span>
<span id="cb155-82"><a href="#cb155-82" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb155-83"><a href="#cb155-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-84"><a href="#cb155-84" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb155-85"><a href="#cb155-85" aria-hidden="true" tabindex="-1"></a>source_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb155-86"><a href="#cb155-86" aria-hidden="true" tabindex="-1"></a>sink_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb155-87"><a href="#cb155-87" aria-hidden="true" tabindex="-1"></a>adjacency_list: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">2</span>:]</span>
<span id="cb155-88"><a href="#cb155-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-89"><a href="#cb155-89" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> DAG()</span>
<span id="cb155-90"><a href="#cb155-90" aria-hidden="true" tabindex="-1"></a>graph.construct_dag(adjacency_list)</span>
<span id="cb155-91"><a href="#cb155-91" aria-hidden="true" tabindex="-1"></a>longest_distance, longest_path <span class="op">=</span> graph.longest_path(source_label, sink_label)</span>
<span id="cb155-92"><a href="#cb155-92" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_distance)</span>
<span id="cb155-93"><a href="#cb155-93" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(longest_path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-alignment-of-two-strings" class="level1" data-number="52">
<h1 data-number="52"><span class="header-section-number">52</span> Find a Highest-Scoring Alignment of Two Strings</h1>
<p>Global Alignment Problem. Find the highest-scoring alignment between two strings using a scoring matrix.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;The maximum alignment score of these strings followed by an alignment achieving this maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix and indel penalty σ = 5. (If multiple alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-52" class="level2" data-number="52.1">
<h2 data-number="52.1" class="anchored" data-anchor-id="sample-dataset-52"><span class="header-section-number">52.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEANLY</code></pre>
</section>
<section id="sample-output-52" class="level2" data-number="52.2">
<h2 data-number="52.2" class="anchored" data-anchor-id="sample-output-52"><span class="header-section-number">52.2</span> Sample Output</h2>
<pre><code>8
PLEASANTLY
-MEA--N-LY</code></pre>
</section>
<section id="solution-52" class="level2" data-number="52.3">
<h2 data-number="52.3" class="anchored" data-anchor-id="solution-52"><span class="header-section-number">52.3</span> Solution</h2>
<div class="sourceCode" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-31"><a href="#cb158-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-32"><a href="#cb158-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-33"><a href="#cb158-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb158-34"><a href="#cb158-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-35"><a href="#cb158-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb158-36"><a href="#cb158-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb158-37"><a href="#cb158-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-38"><a href="#cb158-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb158-39"><a href="#cb158-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-40"><a href="#cb158-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb158-41"><a href="#cb158-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb158-42"><a href="#cb158-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb158-43"><a href="#cb158-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb158-44"><a href="#cb158-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-45"><a href="#cb158-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb158-46"><a href="#cb158-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-47"><a href="#cb158-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-48"><a href="#cb158-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-49"><a href="#cb158-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-50"><a href="#cb158-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-51"><a href="#cb158-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb158-52"><a href="#cb158-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-53"><a href="#cb158-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-54"><a href="#cb158-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-55"><a href="#cb158-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-56"><a href="#cb158-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-57"><a href="#cb158-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb158-58"><a href="#cb158-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb158-59"><a href="#cb158-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-60"><a href="#cb158-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb158-61"><a href="#cb158-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb158-62"><a href="#cb158-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-63"><a href="#cb158-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-64"><a href="#cb158-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-65"><a href="#cb158-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-66"><a href="#cb158-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-67"><a href="#cb158-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-68"><a href="#cb158-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-69"><a href="#cb158-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-70"><a href="#cb158-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb158-71"><a href="#cb158-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-72"><a href="#cb158-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb158-73"><a href="#cb158-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-74"><a href="#cb158-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-75"><a href="#cb158-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb158-76"><a href="#cb158-76" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb158-77"><a href="#cb158-77" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb158-78"><a href="#cb158-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-79"><a href="#cb158-79" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb158-80"><a href="#cb158-80" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb158-81"><a href="#cb158-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-82"><a href="#cb158-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb158-83"><a href="#cb158-83" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> j</span>
<span id="cb158-84"><a href="#cb158-84" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb158-85"><a href="#cb158-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-86"><a href="#cb158-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb158-87"><a href="#cb158-87" aria-hidden="true" tabindex="-1"></a>        score_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> i</span>
<span id="cb158-88"><a href="#cb158-88" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb158-89"><a href="#cb158-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-90"><a href="#cb158-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb158-91"><a href="#cb158-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb158-92"><a href="#cb158-92" aria-hidden="true" tabindex="-1"></a>            key: Tuple[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> (padded_seq1[i], padded_seq2[j]) <span class="cf">if</span> (padded_seq1[i], padded_seq2[j]) <span class="kw">in</span> BLOSUM62 <span class="cf">else</span> (padded_seq2[j], padded_seq1[i])</span>
<span id="cb158-93"><a href="#cb158-93" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> BLOSUM62[key]</span>
<span id="cb158-94"><a href="#cb158-94" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb158-95"><a href="#cb158-95" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb158-96"><a href="#cb158-96" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score)</span>
<span id="cb158-97"><a href="#cb158-97" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb158-98"><a href="#cb158-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb158-99"><a href="#cb158-99" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb158-100"><a href="#cb158-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb158-101"><a href="#cb158-101" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb158-102"><a href="#cb158-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb158-103"><a href="#cb158-103" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb158-104"><a href="#cb158-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-105"><a href="#cb158-105" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb158-106"><a href="#cb158-106" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb158-107"><a href="#cb158-107" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb158-108"><a href="#cb158-108" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb158-109"><a href="#cb158-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb158-110"><a href="#cb158-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">!=</span> <span class="dv">0</span> <span class="kw">or</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb158-111"><a href="#cb158-111" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb158-112"><a href="#cb158-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb158-113"><a href="#cb158-113" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb158-114"><a href="#cb158-114" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb158-115"><a href="#cb158-115" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb158-116"><a href="#cb158-116" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb158-117"><a href="#cb158-117" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb158-118"><a href="#cb158-118" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb158-119"><a href="#cb158-119" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb158-120"><a href="#cb158-120" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb158-121"><a href="#cb158-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb158-122"><a href="#cb158-122" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb158-123"><a href="#cb158-123" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb158-124"><a href="#cb158-124" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb158-125"><a href="#cb158-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-126"><a href="#cb158-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score_matrix[<span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>][<span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span>], aligned_seq1, aligned_seq2</span>
<span id="cb158-127"><a href="#cb158-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-128"><a href="#cb158-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb158-129"><a href="#cb158-129" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb158-130"><a href="#cb158-130" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb158-131"><a href="#cb158-131" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb158-132"><a href="#cb158-132" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb158-133"><a href="#cb158-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-134"><a href="#cb158-134" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb158-135"><a href="#cb158-135" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb158-136"><a href="#cb158-136" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb158-137"><a href="#cb158-137" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb158-138"><a href="#cb158-138" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb158-139"><a href="#cb158-139" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb158-140"><a href="#cb158-140" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> global_alignment(sequence1, sequence2)</span>
<span id="cb158-141"><a href="#cb158-141" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb158-142"><a href="#cb158-142" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb158-143"><a href="#cb158-143" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-local-alignment-of-two-strings" class="level1" data-number="53">
<h1 data-number="53"><span class="header-section-number">53</span> Find a Highest-Scoring Local Alignment of Two Strings</h1>
<p>Local Alignment Problem, Find the highest-scoring local alignment between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;The maximum score of a local alignment of the strings, followed by a local alignment of these strings achieving the maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/pam250/">PAM250</a>&nbsp;scoring matrix and indel penalty σ = 5. (If multiple local alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-53" class="level2" data-number="53.1">
<h2 data-number="53.1" class="anchored" data-anchor-id="sample-dataset-53"><span class="header-section-number">53.1</span> Sample Dataset</h2>
<pre><code>MEANLY
PENALTY</code></pre>
</section>
<section id="sample-output-53" class="level2" data-number="53.2">
<h2 data-number="53.2" class="anchored" data-anchor-id="sample-output-53"><span class="header-section-number">53.2</span> Sample Output</h2>
<pre><code>15
EANL-Y
ENALTY</code></pre>
</section>
<section id="solution-53" class="level2" data-number="53.3">
<h2 data-number="53.3" class="anchored" data-anchor-id="solution-53"><span class="header-section-number">53.3</span> Solution</h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Optional</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>PAM250: Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'A'</span>: {<span class="st">'A'</span>: <span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">'C'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="dv">12</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">5</span>,</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">'D'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">4</span>, <span class="st">'E'</span>: <span class="dv">3</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">'E'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">3</span>, <span class="st">'E'</span>: <span class="dv">4</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">'F'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="dv">9</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">7</span>},</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">'G'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">'H'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">6</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">3</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">'I'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">'K'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>          <span class="st">'L'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'F'</span>: <span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="dv">6</span>, <span class="st">'M'</span>: <span class="dv">4</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>          <span class="st">'M'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="dv">4</span>, <span class="st">'M'</span>: <span class="dv">6</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>          <span class="st">'N'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>          <span class="st">'P'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">6</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Q'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">4</span>, <span class="st">'R'</span>: <span class="dv">1</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>          <span class="st">'R'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">6</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a>          <span class="st">'S'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">2</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a>          <span class="st">'T'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="dv">0</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">3</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a>          <span class="st">'V'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">4</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb161-39"><a href="#cb161-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb161-40"><a href="#cb161-40" aria-hidden="true" tabindex="-1"></a>          <span class="st">'W'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb161-41"><a href="#cb161-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'W'</span>: <span class="dv">17</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb161-42"><a href="#cb161-42" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Y'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'F'</span>: <span class="dv">7</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb161-43"><a href="#cb161-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">10</span>}}</span>
<span id="cb161-44"><a href="#cb161-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-45"><a href="#cb161-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> local_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb161-46"><a href="#cb161-46" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb161-47"><a href="#cb161-47" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb161-48"><a href="#cb161-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-49"><a href="#cb161-49" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb161-50"><a href="#cb161-50" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[Optional[<span class="bu">str</span>]]] <span class="op">=</span> [[<span class="va">None</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb161-51"><a href="#cb161-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-52"><a href="#cb161-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb161-53"><a href="#cb161-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb161-54"><a href="#cb161-54" aria-hidden="true" tabindex="-1"></a>            key1: <span class="bu">str</span> <span class="op">=</span> padded_seq1[i] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq2[j]</span>
<span id="cb161-55"><a href="#cb161-55" aria-hidden="true" tabindex="-1"></a>            key2: <span class="bu">str</span> <span class="op">=</span> padded_seq2[j] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq1[i]</span>
<span id="cb161-56"><a href="#cb161-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-57"><a href="#cb161-57" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> PAM250[key1][key2]</span>
<span id="cb161-58"><a href="#cb161-58" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb161-59"><a href="#cb161-59" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb161-60"><a href="#cb161-60" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score, <span class="dv">0</span>)</span>
<span id="cb161-61"><a href="#cb161-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-62"><a href="#cb161-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb161-63"><a href="#cb161-63" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb161-64"><a href="#cb161-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb161-65"><a href="#cb161-65" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb161-66"><a href="#cb161-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> left_score:</span>
<span id="cb161-67"><a href="#cb161-67" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb161-68"><a href="#cb161-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-69"><a href="#cb161-69" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb161-70"><a href="#cb161-70" aria-hidden="true" tabindex="-1"></a>    max_i: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb161-71"><a href="#cb161-71" aria-hidden="true" tabindex="-1"></a>    max_j: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb161-72"><a href="#cb161-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb161-73"><a href="#cb161-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb161-74"><a href="#cb161-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">&gt;</span> max_score:</span>
<span id="cb161-75"><a href="#cb161-75" aria-hidden="true" tabindex="-1"></a>                max_score <span class="op">=</span> score_matrix[i][j]</span>
<span id="cb161-76"><a href="#cb161-76" aria-hidden="true" tabindex="-1"></a>                max_i, max_j <span class="op">=</span> i, j</span>
<span id="cb161-77"><a href="#cb161-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-78"><a href="#cb161-78" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> max_i</span>
<span id="cb161-79"><a href="#cb161-79" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> max_j</span>
<span id="cb161-80"><a href="#cb161-80" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb161-81"><a href="#cb161-81" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb161-82"><a href="#cb161-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> backtrack_matrix[i][j] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb161-83"><a href="#cb161-83" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb161-84"><a href="#cb161-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb161-85"><a href="#cb161-85" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb161-86"><a href="#cb161-86" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb161-87"><a href="#cb161-87" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb161-88"><a href="#cb161-88" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb161-89"><a href="#cb161-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb161-90"><a href="#cb161-90" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb161-91"><a href="#cb161-91" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb161-92"><a href="#cb161-92" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb161-93"><a href="#cb161-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb161-94"><a href="#cb161-94" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb161-95"><a href="#cb161-95" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb161-96"><a href="#cb161-96" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb161-97"><a href="#cb161-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-98"><a href="#cb161-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb161-99"><a href="#cb161-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-100"><a href="#cb161-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb161-101"><a href="#cb161-101" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb161-102"><a href="#cb161-102" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb161-103"><a href="#cb161-103" aria-hidden="true" tabindex="-1"></a><span class="st">PENALTY</span></span>
<span id="cb161-104"><a href="#cb161-104" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb161-105"><a href="#cb161-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-106"><a href="#cb161-106" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb161-107"><a href="#cb161-107" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb161-108"><a href="#cb161-108" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb161-109"><a href="#cb161-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-110"><a href="#cb161-110" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb161-111"><a href="#cb161-111" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb161-112"><a href="#cb161-112" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb161-113"><a href="#cb161-113" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> local_alignment(sequence1, sequence2)</span>
<span id="cb161-114"><a href="#cb161-114" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb161-115"><a href="#cb161-115" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb161-116"><a href="#cb161-116" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-edit-distance-between-two-strings" class="level1" data-number="54">
<h1 data-number="54"><span class="header-section-number">54</span> Compute the Edit Distance Between Two Strings</h1>
<p>Edit Distance Problem. Find the edit distance between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;The&nbsp;<a href="https://rosalind.info/glossary/edit-distance/">edit distance</a>&nbsp;between these strings.</p>
<section id="sample-dataset-54" class="level2" data-number="54.1">
<h2 data-number="54.1" class="anchored" data-anchor-id="sample-dataset-54"><span class="header-section-number">54.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEANLY</code></pre>
</section>
<section id="sample-output-54" class="level2" data-number="54.2">
<h2 data-number="54.2" class="anchored" data-anchor-id="sample-output-54"><span class="header-section-number">54.2</span> Sample Output</h2>
<pre><code>5</code></pre>
</section>
<section id="solution-54" class="level2" data-number="54.3">
<h2 data-number="54.3" class="anchored" data-anchor-id="solution-54"><span class="header-section-number">54.3</span> Solution</h2>
<div class="sourceCode" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_edit_distance(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> {}</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>        distance_matrix[target_index, <span class="dv">0</span>] <span class="op">=</span> target_index</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>        distance_matrix[<span class="dv">0</span>, source_index] <span class="op">=</span> source_index</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target)):</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source)):</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> source[source_index] <span class="op">==</span> target[target_index]:</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> distance_matrix[target_index, source_index]</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> <span class="bu">min</span>([</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index],</span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index],</span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>                ]) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_matrix[<span class="bu">len</span>(target), <span class="bu">len</span>(source)]</span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a>source, target <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_edit_distance(source, target))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-fitting-alignment-of-two-strings" class="level1" data-number="55">
<h1 data-number="55"><span class="header-section-number">55</span> Find a Highest-Scoring Fitting Alignment of Two Strings</h1>
<p>Fitting Alignment Problem. Construct a highest-scoring fitting alignment between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA strings</a>&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, where&nbsp;<em>v</em>&nbsp;has length at most 10000 and&nbsp;<em>w</em>&nbsp;has length at most 1000.</p>
<p>Return:&nbsp;The maximum score of a fitting alignment of&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, followed by a fitting alignment achieving this maximum score. Use the simple scoring method in which matches count +1 and both the mismatch and indel penalties are equal to 1. (If multiple fitting alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-55" class="level2" data-number="55.1">
<h2 data-number="55.1" class="anchored" data-anchor-id="sample-dataset-55"><span class="header-section-number">55.1</span> Sample Dataset</h2>
<pre><code>GTAGGCTTAAGGTTA
TAGATA</code></pre>
</section>
<section id="sample-output-55" class="level2" data-number="55.2">
<h2 data-number="55.2" class="anchored" data-anchor-id="sample-output-55"><span class="header-section-number">55.2</span> Sample Output</h2>
<pre><code>2
TAGGCTTA
TAGA--TA</code></pre>
</section>
<section id="solution-55" class="level2" data-number="55.3">
<h2 data-number="55.3" class="anchored" data-anchor-id="solution-55"><span class="header-section-number">55.3</span> Solution</h2>
<div class="sourceCode" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_fitting_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>seq2_index</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[<span class="bu">len</span>(sequence2), i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> <span class="bu">len</span>(sequence2)</span>
<span id="cb167-31"><a href="#cb167-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-32"><a href="#cb167-32" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb167-33"><a href="#cb167-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb167-34"><a href="#cb167-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb167-35"><a href="#cb167-35" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb167-36"><a href="#cb167-36" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb167-37"><a href="#cb167-37" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb167-38"><a href="#cb167-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb167-39"><a href="#cb167-39" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb167-40"><a href="#cb167-40" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb167-41"><a href="#cb167-41" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb167-42"><a href="#cb167-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb167-43"><a href="#cb167-43" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb167-44"><a href="#cb167-44" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb167-45"><a href="#cb167-45" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb167-46"><a href="#cb167-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-47"><a href="#cb167-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb167-48"><a href="#cb167-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-49"><a href="#cb167-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb167-50"><a href="#cb167-50" aria-hidden="true" tabindex="-1"></a><span class="st">GTAGGCTTAAGGTTA</span></span>
<span id="cb167-51"><a href="#cb167-51" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATA</span></span>
<span id="cb167-52"><a href="#cb167-52" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb167-53"><a href="#cb167-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-54"><a href="#cb167-54" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb167-55"><a href="#cb167-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_fitting_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-overlap-alignment-of-two-strings" class="level1" data-number="56">
<h1 data-number="56"><span class="header-section-number">56</span> Find a Highest-Scoring Overlap Alignment of Two Strings</h1>
<p>Overlap Alignment Problem. Construct a highest-scoring overlap alignment between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">protein strings</a>&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, each of length at most 1000.</p>
<p>Return:&nbsp;The score of an optimal overlap alignment of&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, followed by an alignment of a suffix&nbsp;<em>v’</em>&nbsp;of&nbsp;<em>v</em>&nbsp;and a prefix&nbsp;<em>w’</em>&nbsp;of&nbsp;<em>w</em>&nbsp;achieving this maximum score. Use an alignment score in which matches count +1 and both the mismatch and indel penalties are 2. (If multiple overlap alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-56" class="level2" data-number="56.1">
<h2 data-number="56.1" class="anchored" data-anchor-id="sample-dataset-56"><span class="header-section-number">56.1</span> Sample Dataset</h2>
<pre><code>PAWHEAE
HEAGAWGHEE</code></pre>
</section>
<section id="sample-output-56" class="level2" data-number="56.2">
<h2 data-number="56.2" class="anchored" data-anchor-id="sample-output-56"><span class="header-section-number">56.2</span> Sample Output</h2>
<pre><code>1
HEAE
HEAG</code></pre>
</section>
<section id="solution-56" class="level2" data-number="56.3">
<h2 data-number="56.3" class="anchored" data-anchor-id="solution-56"><span class="header-section-number">56.3</span> Solution</h2>
<div class="sourceCode" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_overlap_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, mismatch_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">2</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> seq2_index <span class="op">*</span> mismatch_penalty</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> mismatch_penalty</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[seq2_index, <span class="bu">len</span>(sequence1)] <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> <span class="bu">len</span>(sequence1)</span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb170-33"><a href="#cb170-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb170-34"><a href="#cb170-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb170-40"><a href="#cb170-40" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb170-41"><a href="#cb170-41" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb170-42"><a href="#cb170-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb170-43"><a href="#cb170-43" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb170-44"><a href="#cb170-44" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb170-45"><a href="#cb170-45" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb170-46"><a href="#cb170-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-47"><a href="#cb170-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb170-48"><a href="#cb170-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-49"><a href="#cb170-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb170-50"><a href="#cb170-50" aria-hidden="true" tabindex="-1"></a><span class="st">PAWHEAE</span></span>
<span id="cb170-51"><a href="#cb170-51" aria-hidden="true" tabindex="-1"></a><span class="st">HEAGAWGHEE</span></span>
<span id="cb170-52"><a href="#cb170-52" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb170-53"><a href="#cb170-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-54"><a href="#cb170-54" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb170-55"><a href="#cb170-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_overlap_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="align-two-strings-using-affine-gap-penalties" class="level1" data-number="57">
<h1 data-number="57"><span class="header-section-number">57</span> Align Two Strings Using Affine Gap Penalties</h1>
<p>Alignment with Affine Gap Penalties Problem. Construct a highest-scoring global alignment of two strings (with affine gap penalties).</p>
<p>Given:&nbsp;Two amino acid strings&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>&nbsp;(each of length at most 100).</p>
<p>Return:&nbsp;The maximum alignment score between&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, followed by an alignment of&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>&nbsp;achieving this maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix, a gap opening penalty of 11, and a gap extension penalty of 1.</p>
<section id="sample-dataset-57" class="level2" data-number="57.1">
<h2 data-number="57.1" class="anchored" data-anchor-id="sample-dataset-57"><span class="header-section-number">57.1</span> Sample Dataset</h2>
<pre><code>PRTEINS
PRTWPSEIN</code></pre>
</section>
<section id="sample-output-57" class="level2" data-number="57.2">
<h2 data-number="57.2" class="anchored" data-anchor-id="sample-output-57"><span class="header-section-number">57.2</span> Sample Output</h2>
<pre><code>8
PRT---EINS
PRTWPSEIN-</code></pre>
</section>
<section id="solution-57" class="level2" data-number="57.3">
<h2 data-number="57.3" class="anchored" data-anchor-id="solution-57"><span class="header-section-number">57.3</span> Solution</h2>
<div class="sourceCode" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List, Optional</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-31"><a href="#cb173-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-32"><a href="#cb173-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-33"><a href="#cb173-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb173-34"><a href="#cb173-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-35"><a href="#cb173-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb173-36"><a href="#cb173-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb173-37"><a href="#cb173-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-38"><a href="#cb173-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb173-39"><a href="#cb173-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-40"><a href="#cb173-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb173-41"><a href="#cb173-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb173-42"><a href="#cb173-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb173-43"><a href="#cb173-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb173-44"><a href="#cb173-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-45"><a href="#cb173-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb173-46"><a href="#cb173-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-47"><a href="#cb173-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-48"><a href="#cb173-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-49"><a href="#cb173-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-50"><a href="#cb173-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-51"><a href="#cb173-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb173-52"><a href="#cb173-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-53"><a href="#cb173-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-54"><a href="#cb173-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-55"><a href="#cb173-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-56"><a href="#cb173-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-57"><a href="#cb173-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb173-58"><a href="#cb173-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb173-59"><a href="#cb173-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-60"><a href="#cb173-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb173-61"><a href="#cb173-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb173-62"><a href="#cb173-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-63"><a href="#cb173-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-64"><a href="#cb173-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-65"><a href="#cb173-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-66"><a href="#cb173-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-67"><a href="#cb173-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-68"><a href="#cb173-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-69"><a href="#cb173-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-70"><a href="#cb173-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb173-71"><a href="#cb173-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-72"><a href="#cb173-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb173-73"><a href="#cb173-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb173-74"><a href="#cb173-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-75"><a href="#cb173-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert_gap(sequence: <span class="bu">str</span>, position: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb173-76"><a href="#cb173-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Insert a gap ('-') into the sequence at the specified position."""</span></span>
<span id="cb173-77"><a href="#cb173-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[:position] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> sequence[position:]</span>
<span id="cb173-78"><a href="#cb173-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-79"><a href="#cb173-79" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment_affine(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>, gap_open_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">11</span>, gap_extend_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb173-80"><a href="#cb173-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb173-81"><a href="#cb173-81" aria-hidden="true" tabindex="-1"></a><span class="co">    Perform global sequence alignment with affine gap penalty.</span></span>
<span id="cb173-82"><a href="#cb173-82" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb173-83"><a href="#cb173-83" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb173-84"><a href="#cb173-84" aria-hidden="true" tabindex="-1"></a><span class="co">    seq1 (str): First sequence to align</span></span>
<span id="cb173-85"><a href="#cb173-85" aria-hidden="true" tabindex="-1"></a><span class="co">    seq2 (str): Second sequence to align</span></span>
<span id="cb173-86"><a href="#cb173-86" aria-hidden="true" tabindex="-1"></a><span class="co">    gap_open_penalty (int): Penalty for opening a gap</span></span>
<span id="cb173-87"><a href="#cb173-87" aria-hidden="true" tabindex="-1"></a><span class="co">    gap_extend_penalty (int): Penalty for extending a gap</span></span>
<span id="cb173-88"><a href="#cb173-88" aria-hidden="true" tabindex="-1"></a><span class="co">    </span></span>
<span id="cb173-89"><a href="#cb173-89" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb173-90"><a href="#cb173-90" aria-hidden="true" tabindex="-1"></a><span class="co">    Tuple[int, str, str]: Alignment score and aligned sequences</span></span>
<span id="cb173-91"><a href="#cb173-91" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb173-92"><a href="#cb173-92" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> BLOSUM62</span>
<span id="cb173-93"><a href="#cb173-93" aria-hidden="true" tabindex="-1"></a>    match_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-94"><a href="#cb173-94" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-95"><a href="#cb173-95" aria-hidden="true" tabindex="-1"></a>    gap_seq2_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-96"><a href="#cb173-96" aria-hidden="true" tabindex="-1"></a>    prev_match: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-97"><a href="#cb173-97" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq1: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-98"><a href="#cb173-98" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq2: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-99"><a href="#cb173-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-100"><a href="#cb173-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize matrices</span></span>
<span id="cb173-101"><a href="#cb173-101" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> match_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> gap_seq2_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb173-102"><a href="#cb173-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb173-103"><a href="#cb173-103" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb173-104"><a href="#cb173-104" aria-hidden="true" tabindex="-1"></a>        match_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb173-105"><a href="#cb173-105" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb173-106"><a href="#cb173-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb173-107"><a href="#cb173-107" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb173-108"><a href="#cb173-108" aria-hidden="true" tabindex="-1"></a>        match_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb173-109"><a href="#cb173-109" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb173-110"><a href="#cb173-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-111"><a href="#cb173-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill matrices</span></span>
<span id="cb173-112"><a href="#cb173-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb173-113"><a href="#cb173-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb173-114"><a href="#cb173-114" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq1</span></span>
<span id="cb173-115"><a href="#cb173-115" aria-hidden="true" tabindex="-1"></a>            gap_seq1_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb173-116"><a href="#cb173-116" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb173-117"><a href="#cb173-117" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_open_penalty</span>
<span id="cb173-118"><a href="#cb173-118" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb173-119"><a href="#cb173-119" aria-hidden="true" tabindex="-1"></a>            gap_seq1_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq1_options)</span>
<span id="cb173-120"><a href="#cb173-120" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq1[i, j] <span class="op">=</span> gap_seq1_options.index(gap_seq1_score[i, j])</span>
<span id="cb173-121"><a href="#cb173-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-122"><a href="#cb173-122" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq2</span></span>
<span id="cb173-123"><a href="#cb173-123" aria-hidden="true" tabindex="-1"></a>            gap_seq2_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb173-124"><a href="#cb173-124" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb173-125"><a href="#cb173-125" aria-hidden="true" tabindex="-1"></a>                match_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_open_penalty</span>
<span id="cb173-126"><a href="#cb173-126" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb173-127"><a href="#cb173-127" aria-hidden="true" tabindex="-1"></a>            gap_seq2_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq2_options)</span>
<span id="cb173-128"><a href="#cb173-128" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq2[i, j] <span class="op">=</span> gap_seq2_options.index(gap_seq2_score[i, j])</span>
<span id="cb173-129"><a href="#cb173-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-130"><a href="#cb173-130" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate match/mismatch score</span></span>
<span id="cb173-131"><a href="#cb173-131" aria-hidden="true" tabindex="-1"></a>            blosum_score: <span class="bu">int</span> <span class="op">=</span> scoring_matrix.get((seq1[i<span class="op">-</span><span class="dv">1</span>], seq2[j<span class="op">-</span><span class="dv">1</span>]), scoring_matrix.get((seq2[j<span class="op">-</span><span class="dv">1</span>], seq1[i<span class="op">-</span><span class="dv">1</span>]), <span class="dv">0</span>))</span>
<span id="cb173-132"><a href="#cb173-132" aria-hidden="true" tabindex="-1"></a>            match_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb173-133"><a href="#cb173-133" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i, j],</span>
<span id="cb173-134"><a href="#cb173-134" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> blosum_score,</span>
<span id="cb173-135"><a href="#cb173-135" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j]</span>
<span id="cb173-136"><a href="#cb173-136" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb173-137"><a href="#cb173-137" aria-hidden="true" tabindex="-1"></a>            match_score[i, j] <span class="op">=</span> <span class="bu">max</span>(match_options)</span>
<span id="cb173-138"><a href="#cb173-138" aria-hidden="true" tabindex="-1"></a>            prev_match[i, j] <span class="op">=</span> match_options.index(match_score[i, j])</span>
<span id="cb173-139"><a href="#cb173-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-140"><a href="#cb173-140" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback</span></span>
<span id="cb173-141"><a href="#cb173-141" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(seq1), <span class="bu">len</span>(seq2)</span>
<span id="cb173-142"><a href="#cb173-142" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> seq1, seq2</span>
<span id="cb173-143"><a href="#cb173-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-144"><a href="#cb173-144" aria-hidden="true" tabindex="-1"></a>    scores: List[<span class="bu">int</span>] <span class="op">=</span> [gap_seq1_score[i, j], match_score[i, j], gap_seq2_score[i, j]]</span>
<span id="cb173-145"><a href="#cb173-145" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">max</span>(scores)</span>
<span id="cb173-146"><a href="#cb173-146" aria-hidden="true" tabindex="-1"></a>    current_matrix: <span class="bu">int</span> <span class="op">=</span> scores.index(max_score)</span>
<span id="cb173-147"><a href="#cb173-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-148"><a href="#cb173-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">*</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb173-149"><a href="#cb173-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_matrix <span class="op">==</span> <span class="dv">0</span>:  <span class="co"># In gap_seq1_score matrix</span></span>
<span id="cb173-150"><a href="#cb173-150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq1[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb173-151"><a href="#cb173-151" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb173-152"><a href="#cb173-152" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-153"><a href="#cb173-153" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, j)</span>
<span id="cb173-154"><a href="#cb173-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> current_matrix <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># In match_score matrix</span></span>
<span id="cb173-155"><a href="#cb173-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_match[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb173-156"><a href="#cb173-156" aria-hidden="true" tabindex="-1"></a>                i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-157"><a href="#cb173-157" aria-hidden="true" tabindex="-1"></a>                j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-158"><a href="#cb173-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb173-159"><a href="#cb173-159" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> prev_match[i, j]</span>
<span id="cb173-160"><a href="#cb173-160" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># In gap_seq2_score matrix</span></span>
<span id="cb173-161"><a href="#cb173-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq2[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb173-162"><a href="#cb173-162" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb173-163"><a href="#cb173-163" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-164"><a href="#cb173-164" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, i)</span>
<span id="cb173-165"><a href="#cb173-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-166"><a href="#cb173-166" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle remaining overhangs</span></span>
<span id="cb173-167"><a href="#cb173-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb173-168"><a href="#cb173-168" aria-hidden="true" tabindex="-1"></a>        aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, <span class="dv">0</span>)</span>
<span id="cb173-169"><a href="#cb173-169" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-170"><a href="#cb173-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb173-171"><a href="#cb173-171" aria-hidden="true" tabindex="-1"></a>        aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, <span class="dv">0</span>)</span>
<span id="cb173-172"><a href="#cb173-172" aria-hidden="true" tabindex="-1"></a>        j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-173"><a href="#cb173-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-174"><a href="#cb173-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb173-175"><a href="#cb173-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-176"><a href="#cb173-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb173-177"><a href="#cb173-177" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb173-178"><a href="#cb173-178" aria-hidden="true" tabindex="-1"></a><span class="st">PRTEINS</span></span>
<span id="cb173-179"><a href="#cb173-179" aria-hidden="true" tabindex="-1"></a><span class="st">PRTWPSEIN</span></span>
<span id="cb173-180"><a href="#cb173-180" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb173-181"><a href="#cb173-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-182"><a href="#cb173-182" aria-hidden="true" tabindex="-1"></a>seq1, seq2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb173-183"><a href="#cb173-183" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_seq1, aligned_seq2 <span class="op">=</span> global_alignment_affine(seq1, seq2)</span>
<span id="cb173-184"><a href="#cb173-184" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score, aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-middle-edge-in-an-alignment-graph-in-linear-space" class="level1" data-number="58">
<h1 data-number="58"><span class="header-section-number">58</span> Find a Middle Edge in an Alignment Graph in Linear Space</h1>
<p>Middle Edge in Linear Space Problem. Find a middle edge in the alignment graph in linear space.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;A middle edge in the alignment graph of these strings, where the optimal path is defined by the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix and a linear indel penalty equal to 5. Return the middle edge in the form”(<em>i</em>,&nbsp;<em>j</em>) (<em>k</em>,&nbsp;<em>l</em>)“, where (<em>i</em>,&nbsp;<em>j</em>) connects to (<em>k</em>,&nbsp;<em>l</em>).</p>
<section id="sample-dataset-58" class="level2" data-number="58.1">
<h2 data-number="58.1" class="anchored" data-anchor-id="sample-dataset-58"><span class="header-section-number">58.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEASNLY</code></pre>
</section>
<section id="sample-output-58" class="level2" data-number="58.2">
<h2 data-number="58.2" class="anchored" data-anchor-id="sample-output-58"><span class="header-section-number">58.2</span> Sample Output</h2>
<pre><code>(4, 3) (5, 4)</code></pre>
</section>
<section id="solution-58" class="level2" data-number="58.3">
<h2 data-number="58.3" class="anchored" data-anchor-id="solution-58"><span class="header-section-number">58.3</span> Solution</h2>
<div class="sourceCode" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-26"><a href="#cb176-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb176-27"><a href="#cb176-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-28"><a href="#cb176-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-29"><a href="#cb176-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-30"><a href="#cb176-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-31"><a href="#cb176-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-32"><a href="#cb176-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-33"><a href="#cb176-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-34"><a href="#cb176-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb176-35"><a href="#cb176-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-36"><a href="#cb176-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb176-37"><a href="#cb176-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb176-38"><a href="#cb176-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-39"><a href="#cb176-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb176-40"><a href="#cb176-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-41"><a href="#cb176-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb176-42"><a href="#cb176-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb176-43"><a href="#cb176-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb176-44"><a href="#cb176-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb176-45"><a href="#cb176-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-46"><a href="#cb176-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb176-47"><a href="#cb176-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-48"><a href="#cb176-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-49"><a href="#cb176-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-50"><a href="#cb176-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-51"><a href="#cb176-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-52"><a href="#cb176-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb176-53"><a href="#cb176-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-54"><a href="#cb176-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-55"><a href="#cb176-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-56"><a href="#cb176-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-57"><a href="#cb176-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-58"><a href="#cb176-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb176-59"><a href="#cb176-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb176-60"><a href="#cb176-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-61"><a href="#cb176-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb176-62"><a href="#cb176-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb176-63"><a href="#cb176-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-64"><a href="#cb176-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-65"><a href="#cb176-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-66"><a href="#cb176-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-67"><a href="#cb176-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-68"><a href="#cb176-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-69"><a href="#cb176-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-70"><a href="#cb176-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-71"><a href="#cb176-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb176-72"><a href="#cb176-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-73"><a href="#cb176-73" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb176-74"><a href="#cb176-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb176-75"><a href="#cb176-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-76"><a href="#cb176-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb176-77"><a href="#cb176-77" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb176-78"><a href="#cb176-78" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb176-79"><a href="#cb176-79" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb176-80"><a href="#cb176-80" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb176-81"><a href="#cb176-81" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb176-82"><a href="#cb176-82" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb176-83"><a href="#cb176-83" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb176-84"><a href="#cb176-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-85"><a href="#cb176-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb176-86"><a href="#cb176-86" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb176-87"><a href="#cb176-87" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb176-88"><a href="#cb176-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb176-89"><a href="#cb176-89" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb176-90"><a href="#cb176-90" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb176-91"><a href="#cb176-91" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb176-92"><a href="#cb176-92" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb176-93"><a href="#cb176-93" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb176-94"><a href="#cb176-94" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb176-95"><a href="#cb176-95" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb176-96"><a href="#cb176-96" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb176-97"><a href="#cb176-97" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb176-98"><a href="#cb176-98" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb176-99"><a href="#cb176-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-100"><a href="#cb176-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb176-101"><a href="#cb176-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-102"><a href="#cb176-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb176-103"><a href="#cb176-103" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb176-104"><a href="#cb176-104" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb176-105"><a href="#cb176-105" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb176-106"><a href="#cb176-106" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb176-107"><a href="#cb176-107" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb176-108"><a href="#cb176-108" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb176-109"><a href="#cb176-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-110"><a href="#cb176-110" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb176-111"><a href="#cb176-111" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb176-112"><a href="#cb176-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb176-113"><a href="#cb176-113" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb176-114"><a href="#cb176-114" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb176-115"><a href="#cb176-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb176-116"><a href="#cb176-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-117"><a href="#cb176-117" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb176-118"><a href="#cb176-118" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb176-119"><a href="#cb176-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-120"><a href="#cb176-120" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb176-121"><a href="#cb176-121" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb176-122"><a href="#cb176-122" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb176-123"><a href="#cb176-123" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb176-124"><a href="#cb176-124" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb176-125"><a href="#cb176-125" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb176-126"><a href="#cb176-126" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb176-127"><a href="#cb176-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb176-128"><a href="#cb176-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb176-129"><a href="#cb176-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-130"><a href="#cb176-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb176-131"><a href="#cb176-131" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb176-132"><a href="#cb176-132" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb176-133"><a href="#cb176-133" aria-hidden="true" tabindex="-1"></a><span class="st">MEASNLY</span></span>
<span id="cb176-134"><a href="#cb176-134" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb176-135"><a href="#cb176-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-136"><a href="#cb176-136" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb176-137"><a href="#cb176-137" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_middle_edge(sequence1, sequence2, BLOSUM62, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb176-138"><a href="#cb176-138" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="align-two-strings-using-linear-space" class="level1" data-number="59">
<h1 data-number="59"><span class="header-section-number">59</span> Align Two Strings Using Linear Space</h1>
<p>Global Alignment in Linear Space Problem. Find the highest-scoring alignment between two strings using a scoring matrix in linear space.</p>
<p>Given:&nbsp;Two&nbsp;<strong>long</strong>&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>&nbsp;(of length approximately 10,000).</p>
<p>Return:&nbsp;The maximum alignment score of these strings, followed by an alignment achieving this maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix and indel penalty σ = 5.</p>
<section id="sample-dataset-59" class="level2" data-number="59.1">
<h2 data-number="59.1" class="anchored" data-anchor-id="sample-dataset-59"><span class="header-section-number">59.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEANLY</code></pre>
</section>
<section id="sample-output-59" class="level2" data-number="59.2">
<h2 data-number="59.2" class="anchored" data-anchor-id="sample-output-59"><span class="header-section-number">59.2</span> Sample Output</h2>
<pre><code>8
PLEASANTLY
-MEA--N-LY</code></pre>
</section>
<section id="solution-59" class="level2" data-number="59.3">
<h2 data-number="59.3" class="anchored" data-anchor-id="solution-59"><span class="header-section-number">59.3</span> Solution</h2>
<div class="sourceCode" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-25"><a href="#cb179-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-26"><a href="#cb179-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb179-27"><a href="#cb179-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-28"><a href="#cb179-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-29"><a href="#cb179-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-30"><a href="#cb179-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-31"><a href="#cb179-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-32"><a href="#cb179-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-33"><a href="#cb179-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-34"><a href="#cb179-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb179-35"><a href="#cb179-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-36"><a href="#cb179-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb179-37"><a href="#cb179-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb179-38"><a href="#cb179-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-39"><a href="#cb179-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb179-40"><a href="#cb179-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-41"><a href="#cb179-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb179-42"><a href="#cb179-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb179-43"><a href="#cb179-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb179-44"><a href="#cb179-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb179-45"><a href="#cb179-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-46"><a href="#cb179-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb179-47"><a href="#cb179-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-48"><a href="#cb179-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-49"><a href="#cb179-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-50"><a href="#cb179-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-51"><a href="#cb179-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-52"><a href="#cb179-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb179-53"><a href="#cb179-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-54"><a href="#cb179-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-55"><a href="#cb179-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-56"><a href="#cb179-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-57"><a href="#cb179-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-58"><a href="#cb179-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb179-59"><a href="#cb179-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb179-60"><a href="#cb179-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-61"><a href="#cb179-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb179-62"><a href="#cb179-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb179-63"><a href="#cb179-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-64"><a href="#cb179-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-65"><a href="#cb179-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-66"><a href="#cb179-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-67"><a href="#cb179-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-68"><a href="#cb179-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-69"><a href="#cb179-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-70"><a href="#cb179-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-71"><a href="#cb179-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb179-72"><a href="#cb179-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-73"><a href="#cb179-73" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb179-74"><a href="#cb179-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb179-75"><a href="#cb179-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-76"><a href="#cb179-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb179-77"><a href="#cb179-77" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb179-78"><a href="#cb179-78" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb179-79"><a href="#cb179-79" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb179-80"><a href="#cb179-80" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb179-81"><a href="#cb179-81" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb179-82"><a href="#cb179-82" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb179-83"><a href="#cb179-83" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb179-84"><a href="#cb179-84" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-85"><a href="#cb179-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb179-86"><a href="#cb179-86" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb179-87"><a href="#cb179-87" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb179-88"><a href="#cb179-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb179-89"><a href="#cb179-89" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb179-90"><a href="#cb179-90" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb179-91"><a href="#cb179-91" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb179-92"><a href="#cb179-92" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb179-93"><a href="#cb179-93" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb179-94"><a href="#cb179-94" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb179-95"><a href="#cb179-95" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb179-96"><a href="#cb179-96" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb179-97"><a href="#cb179-97" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb179-98"><a href="#cb179-98" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb179-99"><a href="#cb179-99" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-100"><a href="#cb179-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb179-101"><a href="#cb179-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-102"><a href="#cb179-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb179-103"><a href="#cb179-103" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb179-104"><a href="#cb179-104" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb179-105"><a href="#cb179-105" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb179-106"><a href="#cb179-106" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb179-107"><a href="#cb179-107" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb179-108"><a href="#cb179-108" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb179-109"><a href="#cb179-109" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-110"><a href="#cb179-110" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb179-111"><a href="#cb179-111" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb179-112"><a href="#cb179-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb179-113"><a href="#cb179-113" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb179-114"><a href="#cb179-114" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb179-115"><a href="#cb179-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb179-116"><a href="#cb179-116" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-117"><a href="#cb179-117" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb179-118"><a href="#cb179-118" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb179-119"><a href="#cb179-119" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-120"><a href="#cb179-120" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb179-121"><a href="#cb179-121" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb179-122"><a href="#cb179-122" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb179-123"><a href="#cb179-123" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb179-124"><a href="#cb179-124" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb179-125"><a href="#cb179-125" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb179-126"><a href="#cb179-126" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb179-127"><a href="#cb179-127" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb179-128"><a href="#cb179-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb179-129"><a href="#cb179-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-130"><a href="#cb179-130" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_score(</span>
<span id="cb179-131"><a href="#cb179-131" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span>,</span>
<span id="cb179-132"><a href="#cb179-132" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span>,</span>
<span id="cb179-133"><a href="#cb179-133" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb179-134"><a href="#cb179-134" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb179-135"><a href="#cb179-135" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb179-136"><a href="#cb179-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb179-137"><a href="#cb179-137" aria-hidden="true" tabindex="-1"></a>        gap_penalty <span class="cf">if</span> aligned_seq1[i] <span class="op">==</span> <span class="st">"-"</span> <span class="kw">or</span> aligned_seq2[i] <span class="op">==</span> <span class="st">"-"</span> <span class="cf">else</span></span>
<span id="cb179-138"><a href="#cb179-138" aria-hidden="true" tabindex="-1"></a>        scoring_matrix.get((aligned_seq1[i], aligned_seq2[i]),</span>
<span id="cb179-139"><a href="#cb179-139" aria-hidden="true" tabindex="-1"></a>                           scoring_matrix.get((aligned_seq2[i], aligned_seq1[i]), <span class="dv">0</span>))</span>
<span id="cb179-140"><a href="#cb179-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(aligned_seq1))</span>
<span id="cb179-141"><a href="#cb179-141" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb179-142"><a href="#cb179-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-143"><a href="#cb179-143" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_alignment_path(</span>
<span id="cb179-144"><a href="#cb179-144" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb179-145"><a href="#cb179-145" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb179-146"><a href="#cb179-146" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb179-147"><a href="#cb179-147" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb179-148"><a href="#cb179-148" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb179-149"><a href="#cb179-149" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> linear_space_alignment(top: <span class="bu">int</span>, bottom: <span class="bu">int</span>, left: <span class="bu">int</span>, right: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb179-150"><a href="#cb179-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left <span class="op">==</span> right:</span>
<span id="cb179-151"><a href="#cb179-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"↓"</span> <span class="op">*</span> (bottom <span class="op">-</span> top)</span>
<span id="cb179-152"><a href="#cb179-152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> top <span class="op">==</span> bottom:</span>
<span id="cb179-153"><a href="#cb179-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"→"</span> <span class="op">*</span> (right <span class="op">-</span> left)</span>
<span id="cb179-154"><a href="#cb179-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb179-155"><a href="#cb179-155" aria-hidden="true" tabindex="-1"></a>            ((i, j), (i2, j2)) <span class="op">=</span> find_middle_edge(</span>
<span id="cb179-156"><a href="#cb179-156" aria-hidden="true" tabindex="-1"></a>                sequence1[top:bottom], sequence2[left:right], scoring_matrix, gap_penalty</span>
<span id="cb179-157"><a href="#cb179-157" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb179-158"><a href="#cb179-158" aria-hidden="true" tabindex="-1"></a>            edge <span class="op">=</span> <span class="st">"↓"</span> <span class="cf">if</span> j <span class="op">==</span> j2 <span class="cf">else</span> <span class="st">"→"</span> <span class="cf">if</span> i <span class="op">==</span> i2 <span class="cf">else</span> <span class="st">"↘"</span></span>
<span id="cb179-159"><a href="#cb179-159" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (</span>
<span id="cb179-160"><a href="#cb179-160" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(top, i <span class="op">+</span> top, left, j <span class="op">+</span> left) <span class="op">+</span></span>
<span id="cb179-161"><a href="#cb179-161" aria-hidden="true" tabindex="-1"></a>                edge <span class="op">+</span></span>
<span id="cb179-162"><a href="#cb179-162" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(i2 <span class="op">+</span> top, bottom, j2 <span class="op">+</span> left, right)</span>
<span id="cb179-163"><a href="#cb179-163" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb179-164"><a href="#cb179-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-165"><a href="#cb179-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_space_alignment(<span class="dv">0</span>, <span class="bu">len</span>(sequence1), <span class="dv">0</span>, <span class="bu">len</span>(sequence2))</span>
<span id="cb179-166"><a href="#cb179-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-167"><a href="#cb179-167" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_alignment(</span>
<span id="cb179-168"><a href="#cb179-168" aria-hidden="true" tabindex="-1"></a>    alignment_path: <span class="bu">str</span>,</span>
<span id="cb179-169"><a href="#cb179-169" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb179-170"><a href="#cb179-170" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span></span>
<span id="cb179-171"><a href="#cb179-171" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb179-172"><a href="#cb179-172" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb179-173"><a href="#cb179-173" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb179-174"><a href="#cb179-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> direction <span class="kw">in</span> alignment_path:</span>
<span id="cb179-175"><a href="#cb179-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"↘"</span>:</span>
<span id="cb179-176"><a href="#cb179-176" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb179-177"><a href="#cb179-177" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb179-178"><a href="#cb179-178" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb179-179"><a href="#cb179-179" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb179-180"><a href="#cb179-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"↓"</span>:</span>
<span id="cb179-181"><a href="#cb179-181" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb179-182"><a href="#cb179-182" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb179-183"><a href="#cb179-183" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb179-184"><a href="#cb179-184" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb179-185"><a href="#cb179-185" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb179-186"><a href="#cb179-186" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb179-187"><a href="#cb179-187" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb179-188"><a href="#cb179-188" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> aligned_seq1, aligned_seq2</span>
<span id="cb179-189"><a href="#cb179-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-190"><a href="#cb179-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb179-191"><a href="#cb179-191" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb179-192"><a href="#cb179-192" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb179-193"><a href="#cb179-193" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb179-194"><a href="#cb179-194" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb179-195"><a href="#cb179-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-196"><a href="#cb179-196" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb179-197"><a href="#cb179-197" aria-hidden="true" tabindex="-1"></a>scoring_matrix <span class="op">=</span> BLOSUM62</span>
<span id="cb179-198"><a href="#cb179-198" aria-hidden="true" tabindex="-1"></a>alignment_path <span class="op">=</span> find_alignment_path(sequence1, sequence2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb179-199"><a href="#cb179-199" aria-hidden="true" tabindex="-1"></a>aligned_seq1, aligned_seq2 <span class="op">=</span> construct_alignment(alignment_path, sequence1, sequence2)</span>
<span id="cb179-200"><a href="#cb179-200" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_alignment_score(aligned_seq1, aligned_seq2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>))</span>
<span id="cb179-201"><a href="#cb179-201" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-multiple-sequence-alignment" class="level1" data-number="60">
<h1 data-number="60"><span class="header-section-number">60</span> Find a Highest-Scoring Multiple Sequence Alignment</h1>
<p>Multiple Longest Common Subsequence Problem. Find a longest common subsequence of multiple strings.</p>
<p>Given:&nbsp;Three&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA strings</a>.</p>
<p>Return:&nbsp;The maximum score of a multiple alignment of these three strings, followed by a multiple alignment of the three strings achieving this maximum. Use a scoring function in which the score of an alignment column is 1 if all three symbols are identical and 0 otherwise. (If more than one multiple alignment achieve the maximum, you may return any one.)</p>
<section id="sample-dataset-60" class="level2" data-number="60.1">
<h2 data-number="60.1" class="anchored" data-anchor-id="sample-dataset-60"><span class="header-section-number">60.1</span> Sample Dataset</h2>
<pre><code>ATATCCG
TCCGA
ATGTACTG</code></pre>
</section>
<section id="sample-output-60" class="level2" data-number="60.2">
<h2 data-number="60.2" class="anchored" data-anchor-id="sample-output-60"><span class="header-section-number">60.2</span> Sample Output</h2>
<pre><code>3
ATATCC-G-
---TCC-GA
ATGTACTG-</code></pre>
</section>
<section id="solution-60" class="level2" data-number="60.3">
<h2 data-number="60.3" class="anchored" data-anchor-id="solution-60"><span class="header-section-number">60.3</span> Solution</h2>
<div class="sourceCode" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the coordinates are non-negative in the alignment matrix</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid_coordinate(pointer: Tuple[<span class="bu">int</span>, ...], position: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>([i <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">for</span> i <span class="kw">in</span> get_previous_position(position, pointer)])</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the previous position given a current position and a pointer</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_position(position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, ...]:</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>([p <span class="op">+</span> d <span class="cf">for</span> p, d <span class="kw">in</span> <span class="bu">zip</span>(position, pointer)])</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the score for a given position and pointer</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(sequences: List[<span class="bu">str</span>], position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pointer <span class="op">==</span> (<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>        bases <span class="op">=</span> [sequences[i][j] <span class="cf">for</span> i, j <span class="kw">in</span> <span class="bu">enumerate</span>(get_previous_position(position, pointer))]</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(<span class="bu">all</span>(base <span class="op">==</span> bases[<span class="dv">0</span>] <span class="cf">for</span> base <span class="kw">in</span> bases))</span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate possible previous cell pointers</span></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_moves(dimension: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, ...]]:</span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(product([<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], repeat<span class="op">=</span>dimension))[<span class="dv">1</span>:]</span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiple_sequence_alignment(sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>    scores: Dict[Tuple[<span class="bu">int</span>, ...], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>    pointers: Dict[Tuple[<span class="bu">int</span>, ...], Tuple[<span class="bu">int</span>, ...]] <span class="op">=</span> {}</span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a>    scores[(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a>    ranges <span class="op">=</span> [<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(seq) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> seq <span class="kw">in</span> sequences]</span>
<span id="cb182-30"><a href="#cb182-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb182-31"><a href="#cb182-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> position <span class="kw">in</span> product(<span class="op">*</span>ranges):</span>
<span id="cb182-32"><a href="#cb182-32" aria-hidden="true" tabindex="-1"></a>        valid_pointers <span class="op">=</span> <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: is_valid_coordinate(x, position), generate_moves(<span class="dv">3</span>)))</span>
<span id="cb182-33"><a href="#cb182-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> valid_pointers:</span>
<span id="cb182-34"><a href="#cb182-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb182-35"><a href="#cb182-35" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb182-36"><a href="#cb182-36" aria-hidden="true" tabindex="-1"></a>        possible_scores <span class="op">=</span> [scores[get_previous_position(position, ptr)] <span class="op">+</span> calculate_score(sequences, position, ptr) <span class="cf">for</span> ptr <span class="kw">in</span> valid_pointers]</span>
<span id="cb182-37"><a href="#cb182-37" aria-hidden="true" tabindex="-1"></a>        scores[position] <span class="op">=</span> <span class="bu">max</span>(possible_scores)</span>
<span id="cb182-38"><a href="#cb182-38" aria-hidden="true" tabindex="-1"></a>        pointers[position] <span class="op">=</span> valid_pointers[possible_scores.index(<span class="bu">max</span>(possible_scores))]</span>
<span id="cb182-39"><a href="#cb182-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-40"><a href="#cb182-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to recover alignment</span></span>
<span id="cb182-41"><a href="#cb182-41" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> scores[position]</span>
<span id="cb182-42"><a href="#cb182-42" aria-hidden="true" tabindex="-1"></a>    aligned_sequences <span class="op">=</span> [<span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>]</span>
<span id="cb182-43"><a href="#cb182-43" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb182-44"><a href="#cb182-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">any</span>([x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> position]):</span>
<span id="cb182-45"><a href="#cb182-45" aria-hidden="true" tabindex="-1"></a>        pointer <span class="op">=</span> pointers[position]</span>
<span id="cb182-46"><a href="#cb182-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, seq <span class="kw">in</span> <span class="bu">enumerate</span>(sequences):</span>
<span id="cb182-47"><a href="#cb182-47" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[i] <span class="op">+=</span> seq[position[i] <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> pointer[i] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="cf">else</span> <span class="st">"-"</span></span>
<span id="cb182-48"><a href="#cb182-48" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> get_previous_position(position, pointer)</span>
<span id="cb182-49"><a href="#cb182-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-50"><a href="#cb182-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (total_score, </span>
<span id="cb182-51"><a href="#cb182-51" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">0</span>][::<span class="op">-</span><span class="dv">1</span>], </span>
<span id="cb182-52"><a href="#cb182-52" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">1</span>][::<span class="op">-</span><span class="dv">1</span>], </span>
<span id="cb182-53"><a href="#cb182-53" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">2</span>][::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb182-54"><a href="#cb182-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-55"><a href="#cb182-55" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb182-56"><a href="#cb182-56" aria-hidden="true" tabindex="-1"></a><span class="st">ATATCCG</span></span>
<span id="cb182-57"><a href="#cb182-57" aria-hidden="true" tabindex="-1"></a><span class="st">TCCGA</span></span>
<span id="cb182-58"><a href="#cb182-58" aria-hidden="true" tabindex="-1"></a><span class="st">ATGTACTG</span></span>
<span id="cb182-59"><a href="#cb182-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb182-60"><a href="#cb182-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-61"><a href="#cb182-61" aria-hidden="true" tabindex="-1"></a>sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb182-62"><a href="#cb182-62" aria-hidden="true" tabindex="-1"></a>alignment_score, seq1, seq2, seq3 <span class="op">=</span> multiple_sequence_alignment(sequences)</span>
<span id="cb182-63"><a href="#cb182-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb182-64"><a href="#cb182-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq1)</span>
<span id="cb182-65"><a href="#cb182-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq2)</span>
<span id="cb182-66"><a href="#cb182-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-topological-ordering-of-a-dag" class="level1" data-number="61">
<h1 data-number="61"><span class="header-section-number">61</span> Find a Topological Ordering of a DAG</h1>
<p>Topological Ordering Problem. Find a topological ordering of a directed acyclic graph.</p>
<p>Given:&nbsp;The&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>&nbsp;of a graph (with nodes represented by integers).</p>
<p>Return:&nbsp;A topological ordering of this graph.</p>
<section id="sample-dataset-61" class="level2" data-number="61.1">
<h2 data-number="61.1" class="anchored" data-anchor-id="sample-dataset-61"><span class="header-section-number">61.1</span> Sample Dataset</h2>
<pre><code>1 -&gt; 2
2 -&gt; 3
4 -&gt; 2
5 -&gt; 3</code></pre>
</section>
<section id="sample-output-61" class="level2" data-number="61.2">
<h2 data-number="61.2" class="anchored" data-anchor-id="sample-output-61"><span class="header-section-number">61.2</span> Sample Output</h2>
<pre><code>1, 4, 5, 2, 3</code></pre>
</section>
<section id="solution-61" class="level2" data-number="61.3">
<h2 data-number="61.3" class="anchored" data-anchor-id="solution-61"><span class="header-section-number">61.3</span> Solution</h2>
<div class="sourceCode" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Set</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>NodeLabel <span class="op">=</span> <span class="bu">str</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[NodeLabel, List[NodeLabel]]</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_graph(edge_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Graph:</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>    graph: Graph <span class="op">=</span> {}</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edge_list:</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> edge.split(<span class="st">" -&gt; "</span>)</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>        target_list <span class="op">=</span> targets.split(<span class="st">","</span>)</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>            graph[source] <span class="op">=</span> []</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>        graph[source].extend(target_list)</span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> target_list:</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>                graph[target] <span class="op">=</span> []</span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> depth_first_search(graph: Graph, node: NodeLabel, visited: Set[NodeLabel], stack: List[NodeLabel]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a>    visited.add(node)</span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> graph.get(node, []):</span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, neighbor, visited, stack)</span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a>    stack.insert(<span class="dv">0</span>, node)</span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph: Graph) <span class="op">-&gt;</span> List[NodeLabel]:</span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a>    visited: Set[NodeLabel] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a>    stack: List[NodeLabel] <span class="op">=</span> []</span>
<span id="cb185-29"><a href="#cb185-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb185-30"><a href="#cb185-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb185-31"><a href="#cb185-31" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, node, visited, stack)</span>
<span id="cb185-32"><a href="#cb185-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack</span>
<span id="cb185-33"><a href="#cb185-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-34"><a href="#cb185-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb185-35"><a href="#cb185-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_text.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb185-36"><a href="#cb185-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-37"><a href="#cb185-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb185-38"><a href="#cb185-38" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb185-39"><a href="#cb185-39" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb185-40"><a href="#cb185-40" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb185-41"><a href="#cb185-41" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb185-42"><a href="#cb185-42" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 3</span></span>
<span id="cb185-43"><a href="#cb185-43" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb185-44"><a href="#cb185-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-45"><a href="#cb185-45" aria-hidden="true" tabindex="-1"></a>edge_list <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb185-46"><a href="#cb185-46" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> create_graph(edge_list)</span>
<span id="cb185-47"><a href="#cb185-47" aria-hidden="true" tabindex="-1"></a>sorted_nodes <span class="op">=</span> topological_sort(graph)</span>
<span id="cb185-48"><a href="#cb185-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">", "</span>.join(sorted_nodes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedysorting-to-sort-a-permutation-by-reversals" class="level1" data-number="62">
<h1 data-number="62"><span class="header-section-number">62</span> Implement GreedySorting to Sort a Permutation by Reversals</h1>
<p>Implement&nbsp;<em>GreedySorting</em>.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/signed-permutation/">signed permutation</a>&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The sequence of permutations corresponding to applying&nbsp;<em>GreedySorting</em>&nbsp;to&nbsp;<em>P</em>, ending with the identity permutation.</p>
<section id="sample-dataset-62" class="level2" data-number="62.1">
<h2 data-number="62.1" class="anchored" data-anchor-id="sample-dataset-62"><span class="header-section-number">62.1</span> Sample Dataset</h2>
<pre><code>(-3 +4 +1 +5 -2)</code></pre>
</section>
<section id="sample-output-62" class="level2" data-number="62.2">
<h2 data-number="62.2" class="anchored" data-anchor-id="sample-output-62"><span class="header-section-number">62.2</span> Sample Output</h2>
<pre><code>(-1 -4 +3 +5 -2)
(+1 -4 +3 +5 -2)
(+1 +2 -5 -3 +4)
(+1 +2 +3 +5 +4)
(+1 +2 +3 -4 -5)
(+1 +2 +3 +4 -5)
(+1 +2 +3 +4 +5)</code></pre>
</section>
<section id="solution-62" class="level2" data-number="62.3">
<h2 data-number="62.3" class="anchored" data-anchor-id="solution-62"><span class="header-section-number">62.3</span> Solution</h2>
<div class="sourceCode" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perform_k_sorting_reversal(permutation: List[<span class="bu">int</span>], k: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> k</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">abs</span>(permutation[j]) <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>        j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>    permutation[k:j<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> [<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">reversed</span>(permutation[k:j<span class="op">+</span><span class="dv">1</span>])]</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> permutation</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_sorting(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>    reversal_sequence: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(permutation)):</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> permutation[k] <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>            permutation <span class="op">=</span> perform_k_sorting_reversal(permutation, k)</span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>            reversal_sequence.append(<span class="bu">list</span>(permutation))</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversal_sequence</span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>    cleaned_input <span class="op">=</span> input_text.strip().replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> cleaned_input.split()]</span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_permutation(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>    formatted_elements <span class="op">=</span> [(<span class="st">"+"</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">""</span>) <span class="op">+</span> <span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation]</span>
<span id="cb188-24"><a href="#cb188-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join(formatted_elements) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb188-25"><a href="#cb188-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-26"><a href="#cb188-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb188-27"><a href="#cb188-27" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb188-28"><a href="#cb188-28" aria-hidden="true" tabindex="-1"></a><span class="st">(-3 +4 +1 +5 -2)</span></span>
<span id="cb188-29"><a href="#cb188-29" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb188-30"><a href="#cb188-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-31"><a href="#cb188-31" aria-hidden="true" tabindex="-1"></a>initial_permutation <span class="op">=</span> parse_permutation(sample_input)</span>
<span id="cb188-32"><a href="#cb188-32" aria-hidden="true" tabindex="-1"></a>sorting_sequence <span class="op">=</span> greedy_sorting(initial_permutation)</span>
<span id="cb188-33"><a href="#cb188-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-34"><a href="#cb188-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> permutation <span class="kw">in</span> sorting_sequence:</span>
<span id="cb188-35"><a href="#cb188-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(format_permutation(permutation))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-number-of-breakpoints-in-a-permutation" class="level1" data-number="63">
<h1 data-number="63"><span class="header-section-number">63</span> Compute the Number of Breakpoints in a Permutation</h1>
<p>Number of Breakpoints Problem. Find the number of breakpoints in a permutation.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/signed-permutation/">signed permutation</a>&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The number of breakpoints in&nbsp;<em>P</em>.</p>
<section id="sample-dataset-63" class="level2" data-number="63.1">
<h2 data-number="63.1" class="anchored" data-anchor-id="sample-dataset-63"><span class="header-section-number">63.1</span> Sample Dataset</h2>
<pre><code>(+3 +4 +5 -12 -8 -7 -6 +1 +2 +10 +9 -11 +13 +14)</code></pre>
</section>
<section id="sample-output-63" class="level2" data-number="63.2">
<h2 data-number="63.2" class="anchored" data-anchor-id="sample-output-63"><span class="header-section-number">63.2</span> Sample Output</h2>
<pre><code>8</code></pre>
</section>
<section id="solution-63" class="level2" data-number="63.3">
<h2 data-number="63.3" class="anchored" data-anchor-id="solution-63"><span class="header-section-number">63.3</span> Solution</h2>
<div class="sourceCode" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_breakpoints(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    augmented_permutation <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> permutation <span class="op">+</span> [<span class="bu">max</span>(permutation) <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>    breakpoint_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(augmented_permutation) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> augmented_permutation[i] <span class="op">!=</span> augmented_permutation[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>            breakpoint_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> breakpoint_count</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="st">(+3 +4 +5 -12 -8 -7 -6 +1 +2 +10 +9 -11 +13 +14)</span></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> sample_input.strip()</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> permutation_string.replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>permutation <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation_string.split()]</span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_breakpoints(permutation))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-2-break-distance-between-a-pair-of-genomes" class="level1" data-number="64">
<h1 data-number="64"><span class="header-section-number">64</span> Compute the 2-Break Distance Between a Pair of Genomes</h1>
<p>2-Break Distance Problem. Find the 2-break distance between two genomes.</p>
<p>Given:&nbsp;Two genomes with circular chromosomes on the same set of synteny blocks.</p>
<p>Return:&nbsp;The 2-break distance between these two genomes.</p>
<section id="sample-dataset-64" class="level2" data-number="64.1">
<h2 data-number="64.1" class="anchored" data-anchor-id="sample-dataset-64"><span class="header-section-number">64.1</span> Sample Dataset</h2>
<pre><code>(+1 +2 +3 +4 +5 +6)
(+1 -3 -6 -5)(+2 -4)</code></pre>
</section>
<section id="sample-output-64" class="level2" data-number="64.2">
<h2 data-number="64.2" class="anchored" data-anchor-id="sample-output-64"><span class="header-section-number">64.2</span> Sample Output</h2>
<pre><code>3</code></pre>
</section>
<section id="solution-64" class="level2" data-number="64.3">
<h2 data-number="64.3" class="anchored" data-anchor-id="solution-64"><span class="header-section-number">64.3</span> Solution</h2>
<div class="sourceCode" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, DefaultDict</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string):</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb194-32"><a href="#cb194-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-33"><a href="#cb194-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_two_break_distance(genomes: List[DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb194-34"><a href="#cb194-34" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(<span class="op">*</span>genomes)</span>
<span id="cb194-35"><a href="#cb194-35" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(combined_graph.keys())</span>
<span id="cb194-36"><a href="#cb194-36" aria-hidden="true" tabindex="-1"></a>    num_blocks <span class="op">=</span> <span class="bu">len</span>(nodes) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb194-37"><a href="#cb194-37" aria-hidden="true" tabindex="-1"></a>    num_components <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb194-38"><a href="#cb194-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb194-39"><a href="#cb194-39" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), combined_graph)</span>
<span id="cb194-40"><a href="#cb194-40" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">-=</span> component</span>
<span id="cb194-41"><a href="#cb194-41" aria-hidden="true" tabindex="-1"></a>        num_components <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb194-42"><a href="#cb194-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num_blocks <span class="op">-</span> num_components</span>
<span id="cb194-43"><a href="#cb194-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-44"><a href="#cb194-44" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb194-45"><a href="#cb194-45" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 +3 +4 +5 +6)</span></span>
<span id="cb194-46"><a href="#cb194-46" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -3 -6 -5)(+2 -4)</span></span>
<span id="cb194-47"><a href="#cb194-47" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb194-48"><a href="#cb194-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-49"><a href="#cb194-49" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb194-50"><a href="#cb194-50" aria-hidden="true" tabindex="-1"></a>genomes <span class="op">=</span> [parse_genome_graph(genome_string) <span class="cf">for</span> genome_string <span class="kw">in</span> input_lines]</span>
<span id="cb194-51"><a href="#cb194-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_two_break_distance(genomes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks" class="level1" data-number="65">
<h1 data-number="65"><span class="header-section-number">65</span> Find a Shortest Transformation of One Genome into Another by 2-Breaks</h1>
<p>2-Break Sorting Problem. Find a shortest transformation of one genome into another by 2-breaks.</p>
<p>Given:&nbsp;Two genomes with circular chromosomes on the same set of synteny blocks.</p>
<p>Return:&nbsp;The sequence of genomes resulting from applying a shortest sequence of 2-breaks transforming one genome into the other.</p>
<section id="sample-dataset-65" class="level2" data-number="65.1">
<h2 data-number="65.1" class="anchored" data-anchor-id="sample-dataset-65"><span class="header-section-number">65.1</span> Sample Dataset</h2>
<pre><code>(+1 -2 -3 +4)
(+1 +2 -4 -3)</code></pre>
</section>
<section id="sample-output-65" class="level2" data-number="65.2">
<h2 data-number="65.2" class="anchored" data-anchor-id="sample-output-65"><span class="header-section-number">65.2</span> Sample Output</h2>
<pre><code>(+1 -2 -3 +4)
(+1 +2 -3 +4)
(+1 +2 -4 +3)
(+1 +2 -4 -3)</code></pre>
</section>
<section id="solution-65" class="level2" data-number="65.3">
<h2 data-number="65.3" class="anchored" data-anchor-id="solution-65"><span class="header-section-number">65.3</span> Solution</h2>
<div class="sourceCode" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Generator, DefaultDict</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string):</span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb197-25"><a href="#cb197-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb197-26"><a href="#cb197-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-27"><a href="#cb197-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb197-28"><a href="#cb197-28" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb197-29"><a href="#cb197-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb197-30"><a href="#cb197-30" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb197-31"><a href="#cb197-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb197-32"><a href="#cb197-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-33"><a href="#cb197-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_perm(perm: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb197-34"><a href="#cb197-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> x <span class="kw">in</span> perm]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb197-35"><a href="#cb197-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-36"><a href="#cb197-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_components(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[Set[<span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb197-37"><a href="#cb197-37" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb197-38"><a href="#cb197-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb197-39"><a href="#cb197-39" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), graph)</span>
<span id="cb197-40"><a href="#cb197-40" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> component</span>
<span id="cb197-41"><a href="#cb197-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> component</span>
<span id="cb197-42"><a href="#cb197-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-43"><a href="#cb197-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> non_trivial_cycle_nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>] <span class="op">|</span> <span class="va">None</span>:</span>
<span id="cb197-44"><a href="#cb197-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> find_components(graph):</span>
<span id="cb197-45"><a href="#cb197-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(component) <span class="op">&gt;</span> <span class="dv">2</span>:</span>
<span id="cb197-46"><a href="#cb197-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">list</span>(component)</span>
<span id="cb197-47"><a href="#cb197-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb197-48"><a href="#cb197-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-49"><a href="#cb197-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_genome_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb197-50"><a href="#cb197-50" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb197-51"><a href="#cb197-51" aria-hidden="true" tabindex="-1"></a>    visited: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb197-52"><a href="#cb197-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb197-53"><a href="#cb197-53" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb197-54"><a href="#cb197-54" aria-hidden="true" tabindex="-1"></a>        visited.append(current_node)</span>
<span id="cb197-55"><a href="#cb197-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb197-56"><a href="#cb197-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">-</span>neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb197-57"><a href="#cb197-57" aria-hidden="true" tabindex="-1"></a>                queue.append(<span class="op">-</span>neighbor)</span>
<span id="cb197-58"><a href="#cb197-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb197-59"><a href="#cb197-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-60"><a href="#cb197-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_genome_graph(genome_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb197-61"><a href="#cb197-61" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(genome_graph.keys())</span>
<span id="cb197-62"><a href="#cb197-62" aria-hidden="true" tabindex="-1"></a>    components: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb197-63"><a href="#cb197-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb197-64"><a href="#cb197-64" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_genome_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), genome_graph)</span>
<span id="cb197-65"><a href="#cb197-65" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(component)</span>
<span id="cb197-66"><a href="#cb197-66" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> component)</span>
<span id="cb197-67"><a href="#cb197-67" aria-hidden="true" tabindex="-1"></a>        components.append(component)</span>
<span id="cb197-68"><a href="#cb197-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join([format_perm(c) <span class="cf">for</span> c <span class="kw">in</span> components])</span>
<span id="cb197-69"><a href="#cb197-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-70"><a href="#cb197-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb197-71"><a href="#cb197-71" aria-hidden="true" tabindex="-1"></a>    graph[node1].append(node2)</span>
<span id="cb197-72"><a href="#cb197-72" aria-hidden="true" tabindex="-1"></a>    graph[node2].append(node1)</span>
<span id="cb197-73"><a href="#cb197-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-74"><a href="#cb197-74" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> del_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb197-75"><a href="#cb197-75" aria-hidden="true" tabindex="-1"></a>    graph[node1].remove(node2)</span>
<span id="cb197-76"><a href="#cb197-76" aria-hidden="true" tabindex="-1"></a>    graph[node2].remove(node1)</span>
<span id="cb197-77"><a href="#cb197-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-78"><a href="#cb197-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6d(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb197-79"><a href="#cb197-79" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb197-80"><a href="#cb197-80" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb197-81"><a href="#cb197-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb197-82"><a href="#cb197-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb197-83"><a href="#cb197-83" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> nodes[<span class="dv">0</span>]</span>
<span id="cb197-84"><a href="#cb197-84" aria-hidden="true" tabindex="-1"></a>        i2 <span class="op">=</span> genome2[nodes[<span class="dv">0</span>]][<span class="dv">0</span>]</span>
<span id="cb197-85"><a href="#cb197-85" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> genome1[j][<span class="dv">0</span>]</span>
<span id="cb197-86"><a href="#cb197-86" aria-hidden="true" tabindex="-1"></a>        j2 <span class="op">=</span> genome1[i2][<span class="dv">0</span>]</span>
<span id="cb197-87"><a href="#cb197-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-88"><a href="#cb197-88" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i, j)</span>
<span id="cb197-89"><a href="#cb197-89" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i2, j2)</span>
<span id="cb197-90"><a href="#cb197-90" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j, i2)</span>
<span id="cb197-91"><a href="#cb197-91" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j2, i)</span>
<span id="cb197-92"><a href="#cb197-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-93"><a href="#cb197-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb197-94"><a href="#cb197-94" aria-hidden="true" tabindex="-1"></a>        combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb197-95"><a href="#cb197-95" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb197-96"><a href="#cb197-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-97"><a href="#cb197-97" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb197-98"><a href="#cb197-98" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -2 -3 +4)</span></span>
<span id="cb197-99"><a href="#cb197-99" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 -4 -3)</span></span>
<span id="cb197-100"><a href="#cb197-100" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb197-101"><a href="#cb197-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-102"><a href="#cb197-102" aria-hidden="true" tabindex="-1"></a>genome1, genome2 <span class="op">=</span> [parse_genome_graph(s) <span class="cf">for</span> s <span class="kw">in</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)]</span>
<span id="cb197-103"><a href="#cb197-103" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> genome <span class="kw">in</span> ba6d(genome1, genome2):</span>
<span id="cb197-104"><a href="#cb197-104" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(genome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-shared-k-mers-of-a-pair-of-strings" class="level1" data-number="66">
<h1 data-number="66"><span class="header-section-number">66</span> Find All Shared k-mers of a Pair of Strings</h1>
<p>Shared&nbsp;<em>k</em>-mers Problem. Given two strings, find all their shared k-mers.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and two strings.</p>
<p>Return:&nbsp;All&nbsp;<em>k</em>-mers shared by these strings, in the form of ordered pairs (<em>x</em>,&nbsp;<em>y</em>) corresponding to starting positions of these k-mers in the respective strings.</p>
<section id="sample-dataset-66" class="level2" data-number="66.1">
<h2 data-number="66.1" class="anchored" data-anchor-id="sample-dataset-66"><span class="header-section-number">66.1</span> Sample Dataset</h2>
<pre><code>3
AAACTCATC
TTTCAAATC</code></pre>
</section>
<section id="sample-output-66" class="level2" data-number="66.2">
<h2 data-number="66.2" class="anchored" data-anchor-id="sample-output-66"><span class="header-section-number">66.2</span> Sample Output</h2>
<pre><code>(0, 4)
(0, 0)
(4, 2)
(6, 6)</code></pre>
</section>
<section id="solution-66" class="level2" data-number="66.3">
<h2 data-number="66.3" class="anchored" data-anchor-id="solution-66"><span class="header-section-number">66.3</span> Solution</h2>
<div class="sourceCode" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_overlapping_matches(pattern: <span class="bu">str</span>, sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[re.Match]:</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> re.finditer(<span class="vs">rf"(?=(</span><span class="sc">{</span>pattern<span class="sc">}</span><span class="vs">))"</span>, sequence)</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_shared_kmers(kmer_length: <span class="bu">int</span>, sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> sequence1[i : (i <span class="op">+</span> kmer_length)]</span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> current_sequence <span class="kw">in</span> [kmer, reverse_complement(kmer)]:</span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>            matches <span class="op">=</span> <span class="bu">list</span>(find_overlapping_matches(current_sequence, sequence2))</span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> match <span class="kw">in</span> matches:</span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (i, match.start())</span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a><span class="st">AAACTCATC</span></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a><span class="st">TTTCAAATC</span></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a>kmer_length, sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> match <span class="kw">in</span> find_shared_kmers(<span class="bu">int</span>(kmer_length), sequence1, sequence2):</span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(match)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-chromosometocycle" class="level1" data-number="67">
<h1 data-number="67"><span class="header-section-number">67</span> Implement ChromosomeToCycle</h1>
<p>Chromosome To Cycle Problem. Solve the Chromosome To Cycle Problem.</p>
<p>Given:&nbsp;A chromosome&nbsp;<em>Chromosome</em>&nbsp;containing&nbsp;<em>n</em>&nbsp;synteny blocks.</p>
<p>Return:&nbsp;The sequence&nbsp;<em>Nodes</em>&nbsp;of integers between 1 and 2_n_&nbsp;resulting from applying ChromosomeToCycle to&nbsp;<em>Chromosome</em>.</p>
<section id="sample-dataset-67" class="level2" data-number="67.1">
<h2 data-number="67.1" class="anchored" data-anchor-id="sample-dataset-67"><span class="header-section-number">67.1</span> Sample Dataset</h2>
<pre><code>(+1 -2 -3 +4)</code></pre>
</section>
<section id="sample-output-67" class="level2" data-number="67.2">
<h2 data-number="67.2" class="anchored" data-anchor-id="sample-output-67"><span class="header-section-number">67.2</span> Sample Output</h2>
<pre><code>(1 2 4 3 6 5 7 8)</code></pre>
</section>
<section id="solution-67" class="level2" data-number="67.3">
<h2 data-number="67.3" class="anchored" data-anchor-id="solution-67"><span class="header-section-number">67.3</span> Solution</h2>
<div class="sourceCode" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(permutation_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, permutation_string[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split()))</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chromosome_to_cycle(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>    nodes: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gene <span class="kw">in</span> chromosome:</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gene <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span> gene])</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene, <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_chromosome_to_cycle(chromosome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome_to_cycle(parse_permutation(chromosome_string))</span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_cycle(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, cycle)) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(+1 -2 -3 +4)"</span></span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a>chromosome_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(format_cycle(convert_chromosome_to_cycle(chromosome_string)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-cycletochromosome" class="level1" data-number="68">
<h1 data-number="68"><span class="header-section-number">68</span> Implement CycleToChromosome</h1>
<p>Cycle To Chromosome Problem. Solve the Cycle to Chromosome Problem.</p>
<p>Given:&nbsp;A sequence Nodes of integers between 1 and 2_n_.</p>
<p>Return:&nbsp;The chromosome&nbsp;<em>Chromosome</em>&nbsp;containing&nbsp;<em>n</em>&nbsp;synteny blocks resulting from applying CycleToChromosome to&nbsp;<em>Nodes</em>.</p>
<section id="sample-dataset-68" class="level2" data-number="68.1">
<h2 data-number="68.1" class="anchored" data-anchor-id="sample-dataset-68"><span class="header-section-number">68.1</span> Sample Dataset</h2>
<pre><code>(1 2 4 3 6 5 7 8)</code></pre>
</section>
<section id="sample-output-68" class="level2" data-number="68.2">
<h2 data-number="68.2" class="anchored" data-anchor-id="sample-output-68"><span class="header-section-number">68.2</span> Sample Output</h2>
<pre><code>(+1 -2 -3 +4)</code></pre>
</section>
<section id="solution-68" class="level2" data-number="68.3">
<h2 data-number="68.3" class="anchored" data-anchor-id="solution-68"><span class="header-section-number">68.3</span> Solution</h2>
<div class="sourceCode" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_cycle(cycle_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, cycle_string[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split()))</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_chromosome(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>gene<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cycle_to_chromosome(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>    chromosome: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j1, j2 <span class="kw">in</span> <span class="bu">zip</span>(cycle[::<span class="dv">2</span>], cycle[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j1 <span class="op">&lt;</span> j2:</span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>            chromosome.append(j2 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>            chromosome.append(<span class="op">-</span>j1 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(1 2 4 3 6 5 7 8)"</span></span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>cycle_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>chromosome: List[<span class="bu">int</span>] <span class="op">=</span> cycle_to_chromosome(parse_cycle(cycle_string))</span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(format_chromosome(chromosome))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-colorededges" class="level1" data-number="69">
<h1 data-number="69"><span class="header-section-number">69</span> Implement ColoredEdges</h1>
<p>Colored Edges Problem. Find the Colored Edges in a genome.</p>
<p>Given:&nbsp;A genome&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The collection of colored edges in the genome graph of&nbsp;<em>P</em>&nbsp;in the form (<em>x</em>,&nbsp;<em>y</em>).</p>
<section id="sample-dataset-69" class="level2" data-number="69.1">
<h2 data-number="69.1" class="anchored" data-anchor-id="sample-dataset-69"><span class="header-section-number">69.1</span> Sample Dataset</h2>
<pre><code>(+1 -2 -3)(+4 +5 -6)</code></pre>
</section>
<section id="sample-output-69" class="level2" data-number="69.2">
<h2 data-number="69.2" class="anchored" data-anchor-id="sample-output-69"><span class="header-section-number">69.2</span> Sample Output</h2>
<pre><code>(2, 4), (3, 6), (5, 1), (8, 9), (10, 12), (11, 7)</code></pre>
</section>
<section id="solution-69" class="level2" data-number="69.3">
<h2 data-number="69.3" class="anchored" data-anchor-id="solution-69"><span class="header-section-number">69.3</span> Solution</h2>
<div class="sourceCode" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chromosome_to_cycle(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>    nodes: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gene <span class="kw">in</span> chromosome:</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gene <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span> gene])</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene, <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split()))</span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_colored_edges(genome: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>    edge_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chromosome <span class="kw">in</span> genome:</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> chromosome_to_cycle(chromosome)</span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome)):</span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>            start_index <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a>            end_index <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">2</span>) <span class="op">%</span> <span class="bu">len</span>(nodes)</span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a>            edge_dict[nodes[start_index]] <span class="op">=</span> nodes[end_index]</span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> edge_dict</span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(+1 -2 -3)(+4 +5 -6)"</span></span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a>genome_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>genome: List[List[<span class="bu">int</span>]] <span class="op">=</span> [parse_integers(x) <span class="cf">for</span> x <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string)]</span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>edges: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> [(k, v) <span class="cf">for</span> k, v <span class="kw">in</span> get_colored_edges(genome).items()]</span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>edges, sep<span class="op">=</span><span class="st">", "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-graphtogenome" class="level1" data-number="70">
<h1 data-number="70"><span class="header-section-number">70</span> Implement GraphToGenome</h1>
<p>Graph To Genome Problem. Solve the Graph To Genome Problem.</p>
<p>Given:&nbsp;The colored edges of a genome graph.</p>
<p>Return:&nbsp;A genome corresponding to the genome graph.</p>
<section id="sample-dataset-70" class="level2" data-number="70.1">
<h2 data-number="70.1" class="anchored" data-anchor-id="sample-dataset-70"><span class="header-section-number">70.1</span> Sample Dataset</h2>
<pre><code>(2, 4), (3, 6), (5, 1), (7, 9), (10, 12), (11, 8)</code></pre>
</section>
<section id="sample-output-70" class="level2" data-number="70.2">
<h2 data-number="70.2" class="anchored" data-anchor-id="sample-output-70"><span class="header-section-number">70.2</span> Sample Output</h2>
<pre><code>(+1 -2 -3)(-4 +5 -6)</code></pre>
</section>
<section id="solution-70" class="level2" data-number="70.3">
<h2 data-number="70.3" class="anchored" data-anchor-id="solution-70"><span class="header-section-number">70.3</span> Solution</h2>
<div class="sourceCode" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_chromosome(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>gene<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cycle_to_chromosome(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    chromosome: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j1, j2 <span class="kw">in</span> <span class="bu">zip</span>(cycle[::<span class="dv">2</span>], cycle[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j1 <span class="op">&lt;</span> j2:</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>            chromosome.append(j2 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>            chromosome.append(<span class="op">-</span>j1 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome</span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split(<span class="st">", "</span>)))</span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_first_key(dictionary: Dict) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">next</span>(<span class="bu">iter</span>(dictionary.keys()))</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a single cycle from colored edges</span></span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycle(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a>    start: <span class="bu">int</span> <span class="op">=</span> get_first_key(graph)</span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a>    current: <span class="bu">int</span> <span class="op">=</span> start</span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a>    component: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a>        next_node: <span class="bu">int</span> <span class="op">=</span> graph.pop(current)</span>
<span id="cb212-30"><a href="#cb212-30" aria-hidden="true" tabindex="-1"></a>        graph.pop(next_node)</span>
<span id="cb212-31"><a href="#cb212-31" aria-hidden="true" tabindex="-1"></a>        neighbor: <span class="bu">int</span> <span class="op">=</span> next_node <span class="op">+</span> <span class="dv">1</span> <span class="cf">if</span> next_node <span class="op">%</span> <span class="dv">2</span> <span class="cf">else</span> next_node <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb212-32"><a href="#cb212-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="op">==</span> start:</span>
<span id="cb212-33"><a href="#cb212-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [next_node] <span class="op">+</span> component <span class="op">+</span> [current]</span>
<span id="cb212-34"><a href="#cb212-34" aria-hidden="true" tabindex="-1"></a>        component.extend([current, next_node])</span>
<span id="cb212-35"><a href="#cb212-35" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> neighbor</span>
<span id="cb212-36"><a href="#cb212-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-37"><a href="#cb212-37" aria-hidden="true" tabindex="-1"></a><span class="co"># find cycles in colored edges</span></span>
<span id="cb212-38"><a href="#cb212-38" aria-hidden="true" tabindex="-1"></a><span class="co"># to do this, we first make each edge "undirected"</span></span>
<span id="cb212-39"><a href="#cb212-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycles(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> Iterator[List[<span class="bu">int</span>]]:</span>
<span id="cb212-40"><a href="#cb212-40" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> copy(graph)</span>
<span id="cb212-41"><a href="#cb212-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> <span class="bu">list</span>(graph.items()):</span>
<span id="cb212-42"><a href="#cb212-42" aria-hidden="true" tabindex="-1"></a>        graph[v] <span class="op">=</span> k</span>
<span id="cb212-43"><a href="#cb212-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb212-44"><a href="#cb212-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> find_node_cycle(graph)</span>
<span id="cb212-45"><a href="#cb212-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-46"><a href="#cb212-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graph_to_genome(genome_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb212-47"><a href="#cb212-47" aria-hidden="true" tabindex="-1"></a>    genome: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb212-48"><a href="#cb212-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nodes <span class="kw">in</span> find_node_cycles(genome_graph):</span>
<span id="cb212-49"><a href="#cb212-49" aria-hidden="true" tabindex="-1"></a>        genome.append(cycle_to_chromosome(nodes))</span>
<span id="cb212-50"><a href="#cb212-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome</span>
<span id="cb212-51"><a href="#cb212-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-52"><a href="#cb212-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_edge_string(edge_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb212-53"><a href="#cb212-53" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb212-54"><a href="#cb212-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, edge_string):</span>
<span id="cb212-55"><a href="#cb212-55" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> parse_integers(x)</span>
<span id="cb212-56"><a href="#cb212-56" aria-hidden="true" tabindex="-1"></a>        graph[a] <span class="op">=</span> b</span>
<span id="cb212-57"><a href="#cb212-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb212-58"><a href="#cb212-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-59"><a href="#cb212-59" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(2, 4), (3, 6), (5, 1), (7, 9), (10, 12), (11, 8)"</span></span>
<span id="cb212-60"><a href="#cb212-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-61"><a href="#cb212-61" aria-hidden="true" tabindex="-1"></a>edge_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb212-62"><a href="#cb212-62" aria-hidden="true" tabindex="-1"></a>genome_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> parse_edge_string(edge_string)</span>
<span id="cb212-63"><a href="#cb212-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[format_chromosome(x) <span class="cf">for</span> x <span class="kw">in</span> graph_to_genome(genome_graph)], sep<span class="op">=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-2-breakongenomegraph" class="level1" data-number="71">
<h1 data-number="71"><span class="header-section-number">71</span> Implement 2-BreakOnGenomeGraph</h1>
<p>2-Break On Genome Graph Problem. Solve the 2-Break On Genome Graph Problem.</p>
<p>Given:&nbsp;The colored edges of a genome graph&nbsp;<em>GenomeGraph</em>, followed by indices&nbsp;<em>i</em>,&nbsp;<em>i’</em>,&nbsp;<em>j</em>, and&nbsp;<em>j’</em>.</p>
<p>Return:&nbsp;The colored edges of the genome graph resulting from applying the 2-break operation.</p>
<section id="sample-dataset-71" class="level2" data-number="71.1">
<h2 data-number="71.1" class="anchored" data-anchor-id="sample-dataset-71"><span class="header-section-number">71.1</span> Sample Dataset</h2>
<pre><code>(2, 4), (3, 8), (7, 5), (6, 1)
1, 6, 3, 8</code></pre>
</section>
<section id="sample-output-71" class="level2" data-number="71.2">
<h2 data-number="71.2" class="anchored" data-anchor-id="sample-output-71"><span class="header-section-number">71.2</span> Sample Output</h2>
<pre><code>(2, 4), (3, 1), (7, 5), (6, 8)</code></pre>
</section>
<section id="solution-71" class="level2" data-number="71.3">
<h2 data-number="71.3" class="anchored" data-anchor-id="solution-71"><span class="header-section-number">71.3</span> Solution</h2>
<div class="sourceCode" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_edge_string(edge_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> match <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, edge_string):</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>        node1, node2 <span class="op">=</span> parse_integers(match)</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>        graph[node1] <span class="op">=</span> node2</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split(<span class="st">", "</span>)))</span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], edge: Tuple[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> edge[<span class="dv">0</span>] <span class="kw">in</span> graph:</span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">0</span>])</span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">1</span>])</span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_break_on_genome_graph(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], i: <span class="bu">int</span>, ip: <span class="bu">int</span>, j: <span class="bu">int</span>, jp: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a>    new_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> copy(graph)</span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> [(i, ip), (j, jp)]:</span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a>        remove_edge(new_graph, edge)</span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>    new_graph[i] <span class="op">=</span> j</span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a>    new_graph[ip] <span class="op">=</span> jp</span>
<span id="cb215-27"><a href="#cb215-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_graph</span>
<span id="cb215-28"><a href="#cb215-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-29"><a href="#cb215-29" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb215-30"><a href="#cb215-30" aria-hidden="true" tabindex="-1"></a><span class="st">(2, 4), (3, 8), (7, 5), (6, 1)</span></span>
<span id="cb215-31"><a href="#cb215-31" aria-hidden="true" tabindex="-1"></a><span class="st">1, 6, 3, 8</span></span>
<span id="cb215-32"><a href="#cb215-32" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb215-33"><a href="#cb215-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-34"><a href="#cb215-34" aria-hidden="true" tabindex="-1"></a>edge_string, break_points <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb215-35"><a href="#cb215-35" aria-hidden="true" tabindex="-1"></a>graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> parse_edge_string(edge_string)</span>
<span id="cb215-36"><a href="#cb215-36" aria-hidden="true" tabindex="-1"></a>break_points_list: List[<span class="bu">int</span>] <span class="op">=</span> parse_integers(break_points)</span>
<span id="cb215-37"><a href="#cb215-37" aria-hidden="true" tabindex="-1"></a>new_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> two_break_on_genome_graph(graph, <span class="op">*</span>break_points_list)</span>
<span id="cb215-38"><a href="#cb215-38" aria-hidden="true" tabindex="-1"></a>edges: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> [(k, v) <span class="cf">for</span> k, v <span class="kw">in</span> new_graph.items()]</span>
<span id="cb215-39"><a href="#cb215-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>edges, sep<span class="op">=</span><span class="st">", "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-2-breakongenome" class="level1" data-number="72">
<h1 data-number="72"><span class="header-section-number">72</span> Implement 2-BreakOnGenome</h1>
<p>Implement 2-BreakOnGenome. Solve the 2-Break On Genome Graph Problem.</p>
<p>Given:&nbsp;A genome&nbsp;<em>P</em>, followed by indices&nbsp;<em>i</em>,&nbsp;<em>i’</em>,&nbsp;<em>j</em>, and&nbsp;<em>j’</em>.</p>
<p>Return:&nbsp;The genome&nbsp;<em>P’</em>&nbsp;resulting from applying the 2-break operation.</p>
<section id="sample-dataset-72" class="level2" data-number="72.1">
<h2 data-number="72.1" class="anchored" data-anchor-id="sample-dataset-72"><span class="header-section-number">72.1</span> Sample Dataset</h2>
<pre><code>(+1 -2 -4 +3)
1, 6, 3, 8</code></pre>
</section>
<section id="sample-output-72" class="level2" data-number="72.2">
<h2 data-number="72.2" class="anchored" data-anchor-id="sample-output-72"><span class="header-section-number">72.2</span> Sample Output</h2>
<pre><code>(+1 -2) (-4 +3)</code></pre>
</section>
<section id="solution-72" class="level2" data-number="72.3">
<h2 data-number="72.3" class="anchored" data-anchor-id="solution-72"><span class="header-section-number">72.3</span> Solution</h2>
<div class="sourceCode" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(s: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, s[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split()))</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_permutation(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>gene<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chromosome_to_cycle(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>    nodes: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gene <span class="kw">in</span> chromosome:</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gene <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span> gene])</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene, <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> colored_edges(genome: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb218-21"><a href="#cb218-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chromosome <span class="kw">in</span> genome:</span>
<span id="cb218-22"><a href="#cb218-22" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> chromosome_to_cycle(chromosome)</span>
<span id="cb218-23"><a href="#cb218-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome)):</span>
<span id="cb218-24"><a href="#cb218-24" aria-hidden="true" tabindex="-1"></a>            start_index <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb218-25"><a href="#cb218-25" aria-hidden="true" tabindex="-1"></a>            end_index <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">2</span>) <span class="op">%</span> <span class="bu">len</span>(nodes)</span>
<span id="cb218-26"><a href="#cb218-26" aria-hidden="true" tabindex="-1"></a>            graph[nodes[start_index]] <span class="op">=</span> nodes[end_index]</span>
<span id="cb218-27"><a href="#cb218-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb218-28"><a href="#cb218-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-29"><a href="#cb218-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], edge: Tuple[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb218-30"><a href="#cb218-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> edge[<span class="dv">0</span>] <span class="kw">in</span> graph:</span>
<span id="cb218-31"><a href="#cb218-31" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">0</span>])</span>
<span id="cb218-32"><a href="#cb218-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb218-33"><a href="#cb218-33" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">1</span>])</span>
<span id="cb218-34"><a href="#cb218-34" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb218-35"><a href="#cb218-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_break_on_genome_graph(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], i: <span class="bu">int</span>, ip: <span class="bu">int</span>, j: <span class="bu">int</span>, jp: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb218-36"><a href="#cb218-36" aria-hidden="true" tabindex="-1"></a>    new_graph <span class="op">=</span> copy(graph)</span>
<span id="cb218-37"><a href="#cb218-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> [(i, ip), (j, jp)]:</span>
<span id="cb218-38"><a href="#cb218-38" aria-hidden="true" tabindex="-1"></a>        remove_edge(new_graph, edge)</span>
<span id="cb218-39"><a href="#cb218-39" aria-hidden="true" tabindex="-1"></a>    new_graph[i] <span class="op">=</span> j</span>
<span id="cb218-40"><a href="#cb218-40" aria-hidden="true" tabindex="-1"></a>    new_graph[ip] <span class="op">=</span> jp</span>
<span id="cb218-41"><a href="#cb218-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_graph</span>
<span id="cb218-42"><a href="#cb218-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-43"><a href="#cb218-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_first_key(dictionary: Dict) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb218-44"><a href="#cb218-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">next</span>(<span class="bu">iter</span>(dictionary.keys()))</span>
<span id="cb218-45"><a href="#cb218-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb218-46"><a href="#cb218-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycle(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-47"><a href="#cb218-47" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> get_first_key(graph)</span>
<span id="cb218-48"><a href="#cb218-48" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> start</span>
<span id="cb218-49"><a href="#cb218-49" aria-hidden="true" tabindex="-1"></a>    component: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb218-50"><a href="#cb218-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb218-51"><a href="#cb218-51" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> graph.pop(current)</span>
<span id="cb218-52"><a href="#cb218-52" aria-hidden="true" tabindex="-1"></a>        graph.pop(next_node)</span>
<span id="cb218-53"><a href="#cb218-53" aria-hidden="true" tabindex="-1"></a>        neighbor <span class="op">=</span> next_node <span class="op">+</span> <span class="dv">1</span> <span class="cf">if</span> next_node <span class="op">%</span> <span class="dv">2</span> <span class="cf">else</span> next_node <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb218-54"><a href="#cb218-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="op">==</span> start:</span>
<span id="cb218-55"><a href="#cb218-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [next_node] <span class="op">+</span> component <span class="op">+</span> [current]</span>
<span id="cb218-56"><a href="#cb218-56" aria-hidden="true" tabindex="-1"></a>        component.extend([current, next_node])</span>
<span id="cb218-57"><a href="#cb218-57" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> neighbor</span>
<span id="cb218-58"><a href="#cb218-58" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb218-59"><a href="#cb218-59" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycles(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> Iterator[List[<span class="bu">int</span>]]:</span>
<span id="cb218-60"><a href="#cb218-60" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> copy(graph)</span>
<span id="cb218-61"><a href="#cb218-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> <span class="bu">list</span>(graph.items()):</span>
<span id="cb218-62"><a href="#cb218-62" aria-hidden="true" tabindex="-1"></a>        graph[v] <span class="op">=</span> k</span>
<span id="cb218-63"><a href="#cb218-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb218-64"><a href="#cb218-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> find_node_cycle(graph)</span>
<span id="cb218-65"><a href="#cb218-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-66"><a href="#cb218-66" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cycle_to_chromosome(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-67"><a href="#cb218-67" aria-hidden="true" tabindex="-1"></a>    chromosome: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb218-68"><a href="#cb218-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j1, j2 <span class="kw">in</span> <span class="bu">zip</span>(cycle[::<span class="dv">2</span>], cycle[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb218-69"><a href="#cb218-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j1 <span class="op">&lt;</span> j2:</span>
<span id="cb218-70"><a href="#cb218-70" aria-hidden="true" tabindex="-1"></a>            chromosome.append(j2 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb218-71"><a href="#cb218-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb218-72"><a href="#cb218-72" aria-hidden="true" tabindex="-1"></a>            chromosome.append(<span class="op">-</span>j1 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb218-73"><a href="#cb218-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome</span>
<span id="cb218-74"><a href="#cb218-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-75"><a href="#cb218-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graph_to_genome(genome_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb218-76"><a href="#cb218-76" aria-hidden="true" tabindex="-1"></a>    genome: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb218-77"><a href="#cb218-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nodes <span class="kw">in</span> find_node_cycles(genome_graph):</span>
<span id="cb218-78"><a href="#cb218-78" aria-hidden="true" tabindex="-1"></a>        genome.append(cycle_to_chromosome(nodes))</span>
<span id="cb218-79"><a href="#cb218-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome</span>
<span id="cb218-80"><a href="#cb218-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-81"><a href="#cb218-81" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(x: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-82"><a href="#cb218-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, x.split(<span class="st">", "</span>)))</span>
<span id="cb218-83"><a href="#cb218-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-84"><a href="#cb218-84" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_break_on_genome(chromosome: List[<span class="bu">int</span>], i: <span class="bu">int</span>, ip: <span class="bu">int</span>, j: <span class="bu">int</span>, jp: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb218-85"><a href="#cb218-85" aria-hidden="true" tabindex="-1"></a>    genome_graph <span class="op">=</span> colored_edges([chromosome])</span>
<span id="cb218-86"><a href="#cb218-86" aria-hidden="true" tabindex="-1"></a>    genome_graph <span class="op">=</span> two_break_on_genome_graph(genome_graph, i, ip, j, jp)</span>
<span id="cb218-87"><a href="#cb218-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph_to_genome(genome_graph)</span>
<span id="cb218-88"><a href="#cb218-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-89"><a href="#cb218-89" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb218-90"><a href="#cb218-90" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -2 -4 +3)</span></span>
<span id="cb218-91"><a href="#cb218-91" aria-hidden="true" tabindex="-1"></a><span class="st">1, 6, 3, 8</span></span>
<span id="cb218-92"><a href="#cb218-92" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb218-93"><a href="#cb218-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-94"><a href="#cb218-94" aria-hidden="true" tabindex="-1"></a>genome_str, indices_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb218-95"><a href="#cb218-95" aria-hidden="true" tabindex="-1"></a>genome <span class="op">=</span> parse_permutation(genome_str)</span>
<span id="cb218-96"><a href="#cb218-96" aria-hidden="true" tabindex="-1"></a>new_genome <span class="op">=</span> two_break_on_genome(genome, <span class="op">*</span>parse_integers(indices_str))</span>
<span id="cb218-97"><a href="#cb218-97" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[format_permutation(x) <span class="cf">for</span> x <span class="kw">in</span> new_genome])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-distances-between-leaves" class="level1" data-number="73">
<h1 data-number="73"><span class="header-section-number">73</span> Compute Distances Between Leaves</h1>
<p>Distance Between Leaves Problem. Compute the distances between leaves in a weighted tree.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>&nbsp;followed by the adjacency list of a weighted tree with&nbsp;<em>n</em>&nbsp;leaves.</p>
<p>Return:&nbsp;A space-separated&nbsp;<em>n</em>&nbsp;x&nbsp;<em>n</em>&nbsp;(*d__i<em>,&nbsp;</em>j<em>), where&nbsp;</em>d__i<em>,&nbsp;</em>j<em>&nbsp;is the length of the path between leaves&nbsp;</em>i<em>&nbsp;and&nbsp;</em>j*.</p>
<section id="sample-dataset-73" class="level2" data-number="73.1">
<h2 data-number="73.1" class="anchored" data-anchor-id="sample-dataset-73"><span class="header-section-number">73.1</span> Sample Dataset</h2>
<pre><code>4
0-&gt;4:11
1-&gt;4:2
2-&gt;5:6
3-&gt;5:7
4-&gt;0:11
4-&gt;1:2
4-&gt;5:4
5-&gt;4:4
5-&gt;3:7
5-&gt;2:6</code></pre>
</section>
<section id="sample-output-73" class="level2" data-number="73.2">
<h2 data-number="73.2" class="anchored" data-anchor-id="sample-output-73"><span class="header-section-number">73.2</span> Sample Output</h2>
<pre><code>0   13  21  22
13  0   12  13
21  12  0   13
22  13  13  0</code></pre>
</section>
<section id="solution-73" class="level2" data-number="73.3">
<h2 data-number="73.3" class="anchored" data-anchor-id="solution-73"><span class="header-section-number">73.3</span> Solution</h2>
<div class="sourceCode" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> heapq <span class="im">import</span> heappush, heappop</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>    destination_nodes <span class="op">=</span> {edge[<span class="st">"n"</span>] <span class="cf">for</span> edges <span class="kw">in</span> graph.values() <span class="cf">for</span> edge <span class="kw">in</span> edges}</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> destination_nodes</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Dijkstra's algorithm to find distance from start to all other nodes</span></span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes nodes are integers starting at 0!</span></span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dijkstra(start: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [inf <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(get_all_nodes(graph)))]</span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>    distances[start] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>    priority_queue: List[Tuple[<span class="bu">float</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>    heappush(priority_queue, (<span class="dv">0</span>, start))</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a>    processed_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> priority_queue:</span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> heappop(priority_queue)[<span class="dv">1</span>]</span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a>        processed_nodes.add(current_node)</span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor[<span class="st">"n"</span>] <span class="kw">not</span> <span class="kw">in</span> processed_nodes:</span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a>                distances[neighbor[<span class="st">"n"</span>]] <span class="op">=</span> <span class="bu">min</span>(distances[current_node] <span class="op">+</span> neighbor[<span class="st">"w"</span>], distances[neighbor[<span class="st">"n"</span>]])</span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a>                heappush(priority_queue, (distances[neighbor[<span class="st">"n"</span>]], neighbor[<span class="st">"n"</span>]))</span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances</span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_weighted_graph(edges: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a>        from_node, to_node, weight <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, split(<span class="vs">r"\D+"</span>, edge))</span>
<span id="cb221-36"><a href="#cb221-36" aria-hidden="true" tabindex="-1"></a>        graph[from_node].append({<span class="st">"n"</span>: to_node, <span class="st">"w"</span>: weight})</span>
<span id="cb221-37"><a href="#cb221-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-38"><a href="#cb221-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb221-39"><a href="#cb221-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-40"><a href="#cb221-40" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb221-41"><a href="#cb221-41" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb221-42"><a href="#cb221-42" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;4:11</span></span>
<span id="cb221-43"><a href="#cb221-43" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:2</span></span>
<span id="cb221-44"><a href="#cb221-44" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;5:6</span></span>
<span id="cb221-45"><a href="#cb221-45" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;5:7</span></span>
<span id="cb221-46"><a href="#cb221-46" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;0:11</span></span>
<span id="cb221-47"><a href="#cb221-47" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;1:2</span></span>
<span id="cb221-48"><a href="#cb221-48" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;5:4</span></span>
<span id="cb221-49"><a href="#cb221-49" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;4:4</span></span>
<span id="cb221-50"><a href="#cb221-50" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;3:7</span></span>
<span id="cb221-51"><a href="#cb221-51" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;2:6</span></span>
<span id="cb221-52"><a href="#cb221-52" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb221-53"><a href="#cb221-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-54"><a href="#cb221-54" aria-hidden="true" tabindex="-1"></a>num_leaves, <span class="op">*</span>edges <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb221-55"><a href="#cb221-55" aria-hidden="true" tabindex="-1"></a>num_leaves <span class="op">=</span> <span class="bu">int</span>(num_leaves)</span>
<span id="cb221-56"><a href="#cb221-56" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> parse_weighted_graph(edges)</span>
<span id="cb221-57"><a href="#cb221-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_leaves):</span>
<span id="cb221-58"><a href="#cb221-58" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>dijkstra(i, graph)[:num_leaves])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-limb-lengths-in-a-tree" class="level1" data-number="74">
<h1 data-number="74"><span class="header-section-number">74</span> Compute Limb Lengths in a Tree</h1>
<p>Limb Length Problem. Find the limb length for a leaf in a tree.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>, followed by an integer&nbsp;<em>j</em>&nbsp;between 0 and&nbsp;<em>n</em>&nbsp;- 1, followed by a space-separated additive distance matrix&nbsp;<em>D</em>&nbsp;(whose elements are integers).</p>
<p>Return:&nbsp;The limb length of the leaf in&nbsp;<em>Tree</em>(<em>D</em>) corresponding to row&nbsp;<em>j</em>&nbsp;of this distance matrix (use&nbsp;<a href="https://rosalind.info/glossary/0-based-numbering/">0-based indexing</a>).</p>
<section id="sample-dataset-74" class="level2" data-number="74.1">
<h2 data-number="74.1" class="anchored" data-anchor-id="sample-dataset-74"><span class="header-section-number">74.1</span> Sample Dataset</h2>
<pre><code>4
1
0   13  21  22
13  0   12  13
21  12  0   13
22  13  13  0</code></pre>
</section>
<section id="sample-output-74" class="level2" data-number="74.2">
<h2 data-number="74.2" class="anchored" data-anchor-id="sample-output-74"><span class="header-section-number">74.2</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution-74" class="level2" data-number="74.3">
<h2 data-number="74.3" class="anchored" data-anchor-id="solution-74"><span class="header-section-number">74.3</span> Solution</h2>
<div class="sourceCode" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> heapq <span class="im">import</span> heappush, heappop</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>    source_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>    destination_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> {edge[<span class="st">"to"</span>] <span class="cf">for</span> edges <span class="kw">in</span> graph.values() <span class="cf">for</span> edge <span class="kw">in</span> edges}</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> destination_nodes</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Dijkstra's algorithm to find distance from start to all other nodes</span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes nodes are integers starting at 0!</span></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dijkstra(start: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>    distances: List[<span class="bu">float</span>] <span class="op">=</span> [inf <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(get_all_nodes(graph)))]</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>    distances[start] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>    priority_queue: List[Tuple[<span class="bu">float</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>    heappush(priority_queue, (<span class="dv">0</span>, start))</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>    processed_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> priority_queue:</span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>        current_distance, current_node <span class="op">=</span> heappop(priority_queue)</span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_node <span class="kw">in</span> processed_nodes:</span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a>        processed_nodes.add(current_node)</span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>            neighbor_node: <span class="bu">int</span> <span class="op">=</span> neighbor[<span class="st">"to"</span>]</span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>            edge_weight: <span class="bu">int</span> <span class="op">=</span> neighbor[<span class="st">"weight"</span>]</span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor_node <span class="kw">not</span> <span class="kw">in</span> processed_nodes:</span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a>                new_distance: <span class="bu">float</span> <span class="op">=</span> current_distance <span class="op">+</span> edge_weight</span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> new_distance <span class="op">&lt;</span> distances[neighbor_node]:</span>
<span id="cb224-32"><a href="#cb224-32" aria-hidden="true" tabindex="-1"></a>                    distances[neighbor_node] <span class="op">=</span> new_distance</span>
<span id="cb224-33"><a href="#cb224-33" aria-hidden="true" tabindex="-1"></a>                    heappush(priority_queue, (new_distance, neighbor_node))</span>
<span id="cb224-34"><a href="#cb224-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-35"><a href="#cb224-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances</span>
<span id="cb224-36"><a href="#cb224-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-37"><a href="#cb224-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_weighted_graph(edges: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb224-38"><a href="#cb224-38" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb224-39"><a href="#cb224-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-40"><a href="#cb224-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb224-41"><a href="#cb224-41" aria-hidden="true" tabindex="-1"></a>        from_node, to_node, weight <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, split(<span class="vs">r"\D+"</span>, edge))</span>
<span id="cb224-42"><a href="#cb224-42" aria-hidden="true" tabindex="-1"></a>        graph[from_node].append({<span class="st">"to"</span>: to_node, <span class="st">"weight"</span>: weight})</span>
<span id="cb224-43"><a href="#cb224-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-44"><a href="#cb224-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb224-45"><a href="#cb224-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-46"><a href="#cb224-46" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb224-47"><a href="#cb224-47" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb224-48"><a href="#cb224-48" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;4:11</span></span>
<span id="cb224-49"><a href="#cb224-49" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:2</span></span>
<span id="cb224-50"><a href="#cb224-50" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;5:6</span></span>
<span id="cb224-51"><a href="#cb224-51" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;5:7</span></span>
<span id="cb224-52"><a href="#cb224-52" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;0:11</span></span>
<span id="cb224-53"><a href="#cb224-53" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;1:2</span></span>
<span id="cb224-54"><a href="#cb224-54" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;5:4</span></span>
<span id="cb224-55"><a href="#cb224-55" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;4:4</span></span>
<span id="cb224-56"><a href="#cb224-56" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;3:7</span></span>
<span id="cb224-57"><a href="#cb224-57" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;2:6</span></span>
<span id="cb224-58"><a href="#cb224-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb224-59"><a href="#cb224-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-60"><a href="#cb224-60" aria-hidden="true" tabindex="-1"></a>num_leaves, <span class="op">*</span>edges <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb224-61"><a href="#cb224-61" aria-hidden="true" tabindex="-1"></a>num_leaves: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(num_leaves)</span>
<span id="cb224-62"><a href="#cb224-62" aria-hidden="true" tabindex="-1"></a>graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> parse_weighted_graph(edges)</span>
<span id="cb224-63"><a href="#cb224-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_leaves):</span>
<span id="cb224-64"><a href="#cb224-64" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>dijkstra(i, graph)[:num_leaves])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-additivephylogeny" class="level1" data-number="75">
<h1 data-number="75"><span class="header-section-number">75</span> Implement AdditivePhylogeny</h1>
<p>Additive Phylogeny Problem. Construct the simple tree fitting an additive matrix.</p>
<p>Given:&nbsp;<em>n</em>&nbsp;and a tab-delimited&nbsp;<em>n</em>&nbsp;x&nbsp;<em>n</em>&nbsp;additive matrix.</p>
<p>Return:&nbsp;A weighted adjacency list for the simple tree fitting this matrix.</p>
<p><strong>Note on formatting</strong>: The adjacency list must have consecutive integer node labels starting from 0. The&nbsp;<em>n</em>&nbsp;leaves must be labeled&nbsp;<em>0, 1, …, n-1</em>&nbsp;in order of their appearance in the distance matrix. Labels for internal nodes may be labeled in any order but must start from&nbsp;<em>n</em>&nbsp;and increase consecutively.</p>
<section id="sample-dataset-75" class="level2" data-number="75.1">
<h2 data-number="75.1" class="anchored" data-anchor-id="sample-dataset-75"><span class="header-section-number">75.1</span> Sample Dataset</h2>
<pre><code>4
0   13  21  22
13  0   12  13
21  12  0   13
22  13  13  0</code></pre>
</section>
<section id="sample-output-75" class="level2" data-number="75.2">
<h2 data-number="75.2" class="anchored" data-anchor-id="sample-output-75"><span class="header-section-number">75.2</span> Sample Output</h2>
<pre><code>0-&gt;4:11
1-&gt;4:2
2-&gt;5:6
3-&gt;5:7
4-&gt;0:11
4-&gt;1:2
4-&gt;5:4
5-&gt;2:6
5-&gt;3:7
5-&gt;4:4</code></pre>
</section>
<section id="solution-75" class="level2" data-number="75.3">
<h2 data-number="75.3" class="anchored" data-anchor-id="solution-75"><span class="header-section-number">75.3</span> Solution</h2>
<div class="sourceCode" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Tuple, Generator</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Type aliases for clarity</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>DistanceMatrix <span class="op">=</span> List[List[<span class="bu">int</span>]]</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_distance_matrix(lines: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> DistanceMatrix:</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Parse integer matrix from set of lines"""</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split()] <span class="cf">for</span> line <span class="kw">in</span> lines]</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_limb_length(distance_matrix: DistanceMatrix, j: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Calculate limb length j for distance matrix"""</span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>    min_limb_length <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(distance_matrix)</span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">!=</span> k <span class="kw">and</span> i <span class="op">!=</span> j:</span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>                limb_length <span class="op">=</span> (distance_matrix[i][j] <span class="op">+</span> distance_matrix[j][k] <span class="op">-</span> distance_matrix[i][k]) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a>                min_limb_length <span class="op">=</span> <span class="bu">min</span>(limb_length, min_limb_length)</span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> min_limb_length</span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Graph) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get all nodes in the graph"""</span></span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a>    target_nodes <span class="op">=</span> {edge[<span class="st">"n"</span>] <span class="cf">for</span> edges <span class="kw">in</span> graph.values() <span class="cf">for</span> edge <span class="kw">in</span> edges}</span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> target_nodes</span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-29"><a href="#cb227-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_path(graph: Graph, path: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]], target: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb227-30"><a href="#cb227-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Search tree, returning route to target and cumulative distance"""</span></span>
<span id="cb227-31"><a href="#cb227-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> target <span class="kw">in</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> path]:</span>
<span id="cb227-32"><a href="#cb227-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> path</span>
<span id="cb227-33"><a href="#cb227-33" aria-hidden="true" tabindex="-1"></a>    current_node, current_distance <span class="op">=</span> path[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb227-34"><a href="#cb227-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node <span class="kw">in</span> graph:</span>
<span id="cb227-35"><a href="#cb227-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> graph[current_node]:</span>
<span id="cb227-36"><a href="#cb227-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> edge[<span class="st">"n"</span>] <span class="kw">not</span> <span class="kw">in</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> path]:</span>
<span id="cb227-37"><a href="#cb227-37" aria-hidden="true" tabindex="-1"></a>                new_path <span class="op">=</span> path <span class="op">+</span> [(edge[<span class="st">"n"</span>], current_distance <span class="op">+</span> edge[<span class="st">"w"</span>])]</span>
<span id="cb227-38"><a href="#cb227-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> <span class="cf">from</span> find_path(graph, new_path, target)</span>
<span id="cb227-39"><a href="#cb227-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-40"><a href="#cb227-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_leaves(distance_matrix: DistanceMatrix, n: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb227-41"><a href="#cb227-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find three leaves i, n, k such that D[i][k] = D[i][n] + D[n][k]"""</span></span>
<span id="cb227-42"><a href="#cb227-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb227-43"><a href="#cb227-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(distance_matrix)):</span>
<span id="cb227-44"><a href="#cb227-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> distance_matrix[i][k] <span class="op">==</span> distance_matrix[i][n] <span class="op">+</span> distance_matrix[n][k]:</span>
<span id="cb227-45"><a href="#cb227-45" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> i, n, k</span>
<span id="cb227-46"><a href="#cb227-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"No suitable leaves found"</span>)</span>
<span id="cb227-47"><a href="#cb227-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-48"><a href="#cb227-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_node(tree: Graph, i: <span class="bu">int</span>, k: <span class="bu">int</span>, x: <span class="bu">int</span>, n: <span class="bu">int</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb227-49"><a href="#cb227-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Add node in graph between i and k, distance x from i, labelled n"""</span></span>
<span id="cb227-50"><a href="#cb227-50" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">list</span>(find_path(tree, [(i, <span class="dv">0</span>)], k))[<span class="dv">0</span>]</span>
<span id="cb227-51"><a href="#cb227-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p, node <span class="kw">in</span> <span class="bu">enumerate</span>(path):</span>
<span id="cb227-52"><a href="#cb227-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node[<span class="dv">1</span>] <span class="op">&gt;</span> x:</span>
<span id="cb227-53"><a href="#cb227-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb227-54"><a href="#cb227-54" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> p <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb227-55"><a href="#cb227-55" aria-hidden="true" tabindex="-1"></a>    i, d1 <span class="op">=</span> path[p]</span>
<span id="cb227-56"><a href="#cb227-56" aria-hidden="true" tabindex="-1"></a>    k, d2 <span class="op">=</span> path[p <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb227-57"><a href="#cb227-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-58"><a href="#cb227-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Delete old edge and add new edges</span></span>
<span id="cb227-59"><a href="#cb227-59" aria-hidden="true" tabindex="-1"></a>    tree[i] <span class="op">=</span> [edge <span class="cf">for</span> edge <span class="kw">in</span> tree[i] <span class="cf">if</span> edge[<span class="st">"n"</span>] <span class="op">!=</span> k]</span>
<span id="cb227-60"><a href="#cb227-60" aria-hidden="true" tabindex="-1"></a>    tree[i].append({<span class="st">"n"</span>: n, <span class="st">"w"</span>: x <span class="op">-</span> d1})</span>
<span id="cb227-61"><a href="#cb227-61" aria-hidden="true" tabindex="-1"></a>    tree.setdefault(n, []).append({<span class="st">"n"</span>: k, <span class="st">"w"</span>: d2 <span class="op">-</span> x})</span>
<span id="cb227-62"><a href="#cb227-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb227-63"><a href="#cb227-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-64"><a href="#cb227-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> additive_phylogeny(distance_matrix: DistanceMatrix, m: <span class="bu">int</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb227-65"><a href="#cb227-65" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(distance_matrix) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb227-66"><a href="#cb227-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(distance_matrix) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb227-67"><a href="#cb227-67" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb227-68"><a href="#cb227-68" aria-hidden="true" tabindex="-1"></a>        graph[<span class="dv">0</span>].append({<span class="st">"n"</span>: <span class="dv">1</span>, <span class="st">"w"</span>: distance_matrix[<span class="dv">0</span>][<span class="dv">1</span>]})</span>
<span id="cb227-69"><a href="#cb227-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> graph</span>
<span id="cb227-70"><a href="#cb227-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-71"><a href="#cb227-71" aria-hidden="true" tabindex="-1"></a>    limb_length <span class="op">=</span> calculate_limb_length(distance_matrix, n)</span>
<span id="cb227-72"><a href="#cb227-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb227-73"><a href="#cb227-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">!=</span> n:</span>
<span id="cb227-74"><a href="#cb227-74" aria-hidden="true" tabindex="-1"></a>            distance_matrix[j][n] <span class="op">-=</span> limb_length</span>
<span id="cb227-75"><a href="#cb227-75" aria-hidden="true" tabindex="-1"></a>            distance_matrix[n][j] <span class="op">=</span> distance_matrix[j][n]</span>
<span id="cb227-76"><a href="#cb227-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-77"><a href="#cb227-77" aria-hidden="true" tabindex="-1"></a>    i, n, k <span class="op">=</span> find_leaves(distance_matrix, n)</span>
<span id="cb227-78"><a href="#cb227-78" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> distance_matrix[i][n]</span>
<span id="cb227-79"><a href="#cb227-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-80"><a href="#cb227-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove row n and column n from distance_matrix</span></span>
<span id="cb227-81"><a href="#cb227-81" aria-hidden="true" tabindex="-1"></a>    reduced_matrix <span class="op">=</span> [row[:n] <span class="op">+</span> row[n<span class="op">+</span><span class="dv">1</span>:] <span class="cf">for</span> row <span class="kw">in</span> distance_matrix[:n] <span class="op">+</span> distance_matrix[n<span class="op">+</span><span class="dv">1</span>:]]</span>
<span id="cb227-82"><a href="#cb227-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-83"><a href="#cb227-83" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> additive_phylogeny(reduced_matrix, m)</span>
<span id="cb227-84"><a href="#cb227-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-85"><a href="#cb227-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Label for new internal node</span></span>
<span id="cb227-86"><a href="#cb227-86" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> <span class="bu">max</span>(<span class="bu">max</span>(get_all_nodes(tree)), m <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb227-87"><a href="#cb227-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-88"><a href="#cb227-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Break an internal edge adding a new node (possibly) and add the new leaf node</span></span>
<span id="cb227-89"><a href="#cb227-89" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> add_node(tree, i, k, x, v)</span>
<span id="cb227-90"><a href="#cb227-90" aria-hidden="true" tabindex="-1"></a>    tree.setdefault(v, []).append({<span class="st">"n"</span>: n, <span class="st">"w"</span>: limb_length})</span>
<span id="cb227-91"><a href="#cb227-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb227-92"><a href="#cb227-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-93"><a href="#cb227-93" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_edges(graph: Graph) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb227-94"><a href="#cb227-94" aria-hidden="true" tabindex="-1"></a>    edges <span class="op">=</span> []</span>
<span id="cb227-95"><a href="#cb227-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">sorted</span>(graph):</span>
<span id="cb227-96"><a href="#cb227-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> graph[k]:</span>
<span id="cb227-97"><a href="#cb227-97" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>v[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>v[<span class="st">'w'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb227-98"><a href="#cb227-98" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>v[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>v[<span class="st">'w'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb227-99"><a href="#cb227-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(edges)</span>
<span id="cb227-100"><a href="#cb227-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-101"><a href="#cb227-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb227-102"><a href="#cb227-102" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb227-103"><a href="#cb227-103" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb227-104"><a href="#cb227-104" aria-hidden="true" tabindex="-1"></a><span class="st">0   13  21  22</span></span>
<span id="cb227-105"><a href="#cb227-105" aria-hidden="true" tabindex="-1"></a><span class="st">13  0   12  13</span></span>
<span id="cb227-106"><a href="#cb227-106" aria-hidden="true" tabindex="-1"></a><span class="st">21  12  0   13</span></span>
<span id="cb227-107"><a href="#cb227-107" aria-hidden="true" tabindex="-1"></a><span class="st">22  13  13  0</span></span>
<span id="cb227-108"><a href="#cb227-108" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb227-109"><a href="#cb227-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-110"><a href="#cb227-110" aria-hidden="true" tabindex="-1"></a>n, <span class="op">*</span>distance_matrix_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb227-111"><a href="#cb227-111" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> parse_distance_matrix(distance_matrix_str)</span>
<span id="cb227-112"><a href="#cb227-112" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> additive_phylogeny(distance_matrix, <span class="bu">int</span>(n))</span>
<span id="cb227-113"><a href="#cb227-113" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> get_edges(graph):</span>
<span id="cb227-114"><a href="#cb227-114" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-upgma" class="level1" data-number="76">
<h1 data-number="76"><span class="header-section-number">76</span> Implement UPGMA</h1>
<p>UPGMA Problem. Construct the ultrametric tree resulting from UPGMA.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>&nbsp;followed by a space-delimited&nbsp;<em>n</em>&nbsp;x&nbsp;<em>n</em>&nbsp;distance matrix.</p>
<p>Return:&nbsp;An adjacency list for the ultrametric tree output by&nbsp;<strong>UPGMA</strong>. Weights should be accurate to three decimal places.</p>
<p><strong>Note on formatting</strong>: The adjacency list must have consecutive integer node labels starting from 0. The&nbsp;<em>n</em>&nbsp;leaves must be labeled 0, 1, …,&nbsp;<em>n</em>-1 in order of their appearance in the distance matrix. Labels for internal nodes may be labeled in any order but must start from&nbsp;<em>n</em>&nbsp;and increase consecutively.</p>
<section id="sample-dataset-76" class="level2" data-number="76.1">
<h2 data-number="76.1" class="anchored" data-anchor-id="sample-dataset-76"><span class="header-section-number">76.1</span> Sample Dataset</h2>
<pre><code>4
0   20  17  11
20  0   20  13
17  20  0   10
11  13  10  0</code></pre>
</section>
<section id="sample-output-76" class="level2" data-number="76.2">
<h2 data-number="76.2" class="anchored" data-anchor-id="sample-output-76"><span class="header-section-number">76.2</span> Sample Output</h2>
<pre><code>0-&gt;5:7.000
1-&gt;6:8.833
2-&gt;4:5.000
3-&gt;4:5.000
4-&gt;2:5.000
4-&gt;3:5.000
4-&gt;5:2.000
5-&gt;0:7.000
5-&gt;4:2.000
5-&gt;6:1.833
6-&gt;5:1.833
6-&gt;1:8.833</code></pre>
</section>
<section id="solution-76" class="level2" data-number="76.3">
<h2 data-number="76.3" class="anchored" data-anchor-id="solution-76"><span class="header-section-number">76.3</span> Solution</h2>
<div class="sourceCode" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_matrix(lines: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Parse integer matrix from set of lines"""</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split()] <span class="cf">for</span> line <span class="kw">in</span> lines]</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_edges(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>    edges <span class="op">=</span> []</span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> <span class="bu">sorted</span>(graph):</span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> graph[source]:</span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>source<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>target[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>target[<span class="st">'w'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>target[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>source<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>target[<span class="st">'w'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(edges)</span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> closest(distance_matrix: np.ndarray) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find (first) minimum off diagonal index in an array"""</span></span>
<span id="cb230-21"><a href="#cb230-21" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb230-22"><a href="#cb230-22" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(distance_matrix, distance_matrix.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb230-23"><a href="#cb230-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">divmod</span>(distance_matrix.argmin(), distance_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb230-24"><a href="#cb230-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-25"><a href="#cb230-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> average_ind(distance_matrix: np.ndarray, i: <span class="bu">int</span>, j: <span class="bu">int</span>, size_i: <span class="bu">int</span>, size_j: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb230-26"><a href="#cb230-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Replace the ith row/col with the average of the ith and jth and remove the jth"""</span></span>
<span id="cb230-27"><a href="#cb230-27" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb230-28"><a href="#cb230-28" aria-hidden="true" tabindex="-1"></a>    average <span class="op">=</span> (distance_matrix[i, :] <span class="op">*</span> size_i <span class="op">+</span> distance_matrix[j, :] <span class="op">*</span> size_j) <span class="op">/</span> (size_i <span class="op">+</span> size_j)</span>
<span id="cb230-29"><a href="#cb230-29" aria-hidden="true" tabindex="-1"></a>    distance_matrix[i, :] <span class="op">=</span> average</span>
<span id="cb230-30"><a href="#cb230-30" aria-hidden="true" tabindex="-1"></a>    distance_matrix[:, i] <span class="op">=</span> average</span>
<span id="cb230-31"><a href="#cb230-31" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.delete(distance_matrix, j, <span class="dv">0</span>)</span>
<span id="cb230-32"><a href="#cb230-32" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.delete(distance_matrix, j, <span class="dv">1</span>)</span>
<span id="cb230-33"><a href="#cb230-33" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(distance_matrix, <span class="dv">0</span>)</span>
<span id="cb230-34"><a href="#cb230-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_matrix</span>
<span id="cb230-35"><a href="#cb230-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-36"><a href="#cb230-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> upgma(distance_matrix: np.ndarray, num_clusters: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb230-37"><a href="#cb230-37" aria-hidden="true" tabindex="-1"></a>    clusters <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, num_clusters))</span>
<span id="cb230-38"><a href="#cb230-38" aria-hidden="true" tabindex="-1"></a>    ages: Dict[<span class="bu">int</span>, <span class="bu">float</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="dv">0</span>)  <span class="co"># the "age" of a node</span></span>
<span id="cb230-39"><a href="#cb230-39" aria-hidden="true" tabindex="-1"></a>    size: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="dv">1</span>)  <span class="co"># the number of descendants of a node</span></span>
<span id="cb230-40"><a href="#cb230-40" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]] <span class="op">=</span> {}  <span class="co"># the graph / tree we're building</span></span>
<span id="cb230-41"><a href="#cb230-41" aria-hidden="true" tabindex="-1"></a>    node_label <span class="op">=</span> num_clusters  <span class="co"># a label for internal nodes as we add them</span></span>
<span id="cb230-42"><a href="#cb230-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb230-43"><a href="#cb230-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(clusters) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb230-44"><a href="#cb230-44" aria-hidden="true" tabindex="-1"></a>        i, j <span class="op">=</span> closest(distance_matrix)</span>
<span id="cb230-45"><a href="#cb230-45" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> clusters[i], clusters[j]</span>
<span id="cb230-46"><a href="#cb230-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-47"><a href="#cb230-47" aria-hidden="true" tabindex="-1"></a>        tree[node_label] <span class="op">=</span> [</span>
<span id="cb230-48"><a href="#cb230-48" aria-hidden="true" tabindex="-1"></a>            {<span class="st">"n"</span>: a, <span class="st">"w"</span>: distance_matrix[i, j] <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> ages[a]},</span>
<span id="cb230-49"><a href="#cb230-49" aria-hidden="true" tabindex="-1"></a>            {<span class="st">"n"</span>: b, <span class="st">"w"</span>: distance_matrix[i, j] <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> ages[b]},</span>
<span id="cb230-50"><a href="#cb230-50" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb230-51"><a href="#cb230-51" aria-hidden="true" tabindex="-1"></a>        size[node_label] <span class="op">=</span> size[a] <span class="op">+</span> size[b]</span>
<span id="cb230-52"><a href="#cb230-52" aria-hidden="true" tabindex="-1"></a>        ages[node_label] <span class="op">=</span> distance_matrix[i, j] <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb230-53"><a href="#cb230-53" aria-hidden="true" tabindex="-1"></a>        clusters[i] <span class="op">=</span> node_label</span>
<span id="cb230-54"><a href="#cb230-54" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> clusters[j]</span>
<span id="cb230-55"><a href="#cb230-55" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> average_ind(distance_matrix, <span class="op">*</span>closest(distance_matrix), size[a], size[b])</span>
<span id="cb230-56"><a href="#cb230-56" aria-hidden="true" tabindex="-1"></a>        node_label <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb230-57"><a href="#cb230-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-58"><a href="#cb230-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb230-59"><a href="#cb230-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-60"><a href="#cb230-60" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb230-61"><a href="#cb230-61" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb230-62"><a href="#cb230-62" aria-hidden="true" tabindex="-1"></a><span class="st">0   20  17  11</span></span>
<span id="cb230-63"><a href="#cb230-63" aria-hidden="true" tabindex="-1"></a><span class="st">20  0   20  13</span></span>
<span id="cb230-64"><a href="#cb230-64" aria-hidden="true" tabindex="-1"></a><span class="st">17  20  0   10</span></span>
<span id="cb230-65"><a href="#cb230-65" aria-hidden="true" tabindex="-1"></a><span class="st">11  13  10  0</span></span>
<span id="cb230-66"><a href="#cb230-66" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb230-67"><a href="#cb230-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-68"><a href="#cb230-68" aria-hidden="true" tabindex="-1"></a>num_clusters, <span class="op">*</span>distance_data <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb230-69"><a href="#cb230-69" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> np.array(parse_matrix(distance_data), <span class="bu">float</span>)</span>
<span id="cb230-70"><a href="#cb230-70" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> upgma(distance_matrix, <span class="bu">int</span>(num_clusters))</span>
<span id="cb230-71"><a href="#cb230-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> as_edges(graph):</span>
<span id="cb230-72"><a href="#cb230-72" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-neighbor-joining-algorithm" class="level1" data-number="77">
<h1 data-number="77"><span class="header-section-number">77</span> Implement the Neighbor Joining Algorithm</h1>
<p>Neighbor Joining Problem. Construct the tree resulting from applying the neighbor-joining algorithm to a distance matrix.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>, followed by a space-separated&nbsp;<em>n</em>&nbsp;x&nbsp;<em>n</em>&nbsp;distance matrix.</p>
<p>Return:&nbsp;An adjacency list for the tree resulting from applying the neighbor-joining algorithm. Edge-weights should be accurate to two decimal places (they are provided to three decimal places in the sample output below).</p>
<p><strong>Note on formatting</strong>: The adjacency list must have consecutive integer node labels starting from 0. The&nbsp;<em>n</em>&nbsp;leaves must be labeled&nbsp;<em>0, 1, …, n-1</em>&nbsp;in order of their appearance in the distance matrix. Labels for internal nodes may be labeled in any order but must start from&nbsp;<em>n</em>&nbsp;and increase consecutively.</p>
<section id="sample-dataset-77" class="level2" data-number="77.1">
<h2 data-number="77.1" class="anchored" data-anchor-id="sample-dataset-77"><span class="header-section-number">77.1</span> Sample Dataset</h2>
<pre><code>4
0   23  27  20
23  0   30  28
27  30  0   30
20  28  30  0</code></pre>
</section>
<section id="sample-output-77" class="level2" data-number="77.2">
<h2 data-number="77.2" class="anchored" data-anchor-id="sample-output-77"><span class="header-section-number">77.2</span> Sample Output</h2>
<pre><code>0-&gt;4:8.000
1-&gt;5:13.500
2-&gt;5:16.500
3-&gt;4:12.000
4-&gt;5:2.000
4-&gt;0:8.000
4-&gt;3:12.000
5-&gt;1:13.500
5-&gt;2:16.500
5-&gt;4:2.000</code></pre>
</section>
<section id="solution-77" class="level2" data-number="77.3">
<h2 data-number="77.3" class="anchored" data-anchor-id="solution-77"><span class="header-section-number">77.3</span> Solution</h2>
<div class="sourceCode" id="cb233"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_matrix(lines: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Parse integer matrix from set of lines"""</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split()] <span class="cf">for</span> line <span class="kw">in</span> lines]</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_edges(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, Union[<span class="bu">int</span>, <span class="bu">float</span>]]]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>    formatted_edges <span class="op">=</span> []</span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">sorted</span>(tree):</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> tree[node]:</span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>            formatted_edges.append(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>neighbor[<span class="st">'node'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>neighbor[<span class="st">'weight'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a>            formatted_edges.append(<span class="ss">f"</span><span class="sc">{</span>neighbor[<span class="st">'node'</span>]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>neighbor[<span class="st">'weight'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(formatted_edges)</span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_closest_pair(distance_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find (first) minimum off-diagonal index in an array"""</span></span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(temp_matrix, temp_matrix.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb233-21"><a href="#cb233-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">divmod</span>(temp_matrix.argmin(), temp_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb233-22"><a href="#cb233-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-23"><a href="#cb233-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_neighbor_joining_matrix(distance_matrix: np.ndarray, num_nodes: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb233-24"><a href="#cb233-24" aria-hidden="true" tabindex="-1"></a>    nj_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb233-25"><a href="#cb233-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb233-26"><a href="#cb233-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb233-27"><a href="#cb233-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j:</span>
<span id="cb233-28"><a href="#cb233-28" aria-hidden="true" tabindex="-1"></a>                nj_matrix[i, j] <span class="op">=</span> (num_nodes <span class="op">-</span> <span class="dv">2</span>) <span class="op">*</span> distance_matrix[i, j] <span class="op">-</span> <span class="bu">sum</span>(distance_matrix[i, :]) <span class="op">-</span> <span class="bu">sum</span>(distance_matrix[j, :])</span>
<span id="cb233-29"><a href="#cb233-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nj_matrix</span>
<span id="cb233-30"><a href="#cb233-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-31"><a href="#cb233-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> neighbor_joining(distance_matrix: np.ndarray, num_nodes: <span class="bu">int</span>, labels: List[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, Union[<span class="bu">int</span>, <span class="bu">float</span>]]]]:</span>
<span id="cb233-32"><a href="#cb233-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> labels:</span>
<span id="cb233-33"><a href="#cb233-33" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(num_nodes))</span>
<span id="cb233-34"><a href="#cb233-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-35"><a href="#cb233-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> num_nodes <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb233-36"><a href="#cb233-36" aria-hidden="true" tabindex="-1"></a>        tree <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb233-37"><a href="#cb233-37" aria-hidden="true" tabindex="-1"></a>        tree[labels[<span class="dv">0</span>]].append({<span class="st">"node"</span>: labels[<span class="dv">1</span>], <span class="st">"weight"</span>: distance_matrix[<span class="dv">0</span>][<span class="dv">1</span>]})</span>
<span id="cb233-38"><a href="#cb233-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> tree</span>
<span id="cb233-39"><a href="#cb233-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-40"><a href="#cb233-40" aria-hidden="true" tabindex="-1"></a>    nj_matrix <span class="op">=</span> calculate_neighbor_joining_matrix(distance_matrix, num_nodes)</span>
<span id="cb233-41"><a href="#cb233-41" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> find_closest_pair(nj_matrix)</span>
<span id="cb233-42"><a href="#cb233-42" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> (<span class="bu">sum</span>(distance_matrix[i, :]) <span class="op">-</span> <span class="bu">sum</span>(distance_matrix[j, :])) <span class="op">/</span> (num_nodes <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb233-43"><a href="#cb233-43" aria-hidden="true" tabindex="-1"></a>    limb_i <span class="op">=</span> (distance_matrix[i, j] <span class="op">+</span> delta) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb233-44"><a href="#cb233-44" aria-hidden="true" tabindex="-1"></a>    limb_j <span class="op">=</span> (distance_matrix[i, j] <span class="op">-</span> delta) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb233-45"><a href="#cb233-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-46"><a href="#cb233-46" aria-hidden="true" tabindex="-1"></a>    label_i <span class="op">=</span> labels[i]</span>
<span id="cb233-47"><a href="#cb233-47" aria-hidden="true" tabindex="-1"></a>    label_j <span class="op">=</span> labels[j]</span>
<span id="cb233-48"><a href="#cb233-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-49"><a href="#cb233-49" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.append(distance_matrix, np.zeros((<span class="dv">1</span>, <span class="bu">len</span>(distance_matrix))), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb233-50"><a href="#cb233-50" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.append(distance_matrix, np.zeros((<span class="bu">len</span>(distance_matrix), <span class="dv">1</span>)), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb233-51"><a href="#cb233-51" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> labels <span class="op">+</span> [<span class="bu">max</span>(labels) <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb233-52"><a href="#cb233-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-53"><a href="#cb233-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(num_nodes):</span>
<span id="cb233-54"><a href="#cb233-54" aria-hidden="true" tabindex="-1"></a>        distance_matrix[k, num_nodes] <span class="op">=</span> (distance_matrix[k, i] <span class="op">+</span> distance_matrix[k, j] <span class="op">-</span> distance_matrix[i, j]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb233-55"><a href="#cb233-55" aria-hidden="true" tabindex="-1"></a>        distance_matrix[num_nodes, k] <span class="op">=</span> (distance_matrix[k, i] <span class="op">+</span> distance_matrix[k, j] <span class="op">-</span> distance_matrix[i, j]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb233-56"><a href="#cb233-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> [j, i]:</span>
<span id="cb233-57"><a href="#cb233-57" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> np.delete(distance_matrix, x, <span class="dv">0</span>)</span>
<span id="cb233-58"><a href="#cb233-58" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> np.delete(distance_matrix, x, <span class="dv">1</span>)</span>
<span id="cb233-59"><a href="#cb233-59" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> labels[x]</span>
<span id="cb233-60"><a href="#cb233-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-61"><a href="#cb233-61" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> neighbor_joining(distance_matrix, num_nodes <span class="op">-</span> <span class="dv">1</span>, labels)</span>
<span id="cb233-62"><a href="#cb233-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-63"><a href="#cb233-63" aria-hidden="true" tabindex="-1"></a>    tree[labels[<span class="op">-</span><span class="dv">1</span>]].append({<span class="st">"node"</span>: label_i, <span class="st">"weight"</span>: limb_i})</span>
<span id="cb233-64"><a href="#cb233-64" aria-hidden="true" tabindex="-1"></a>    tree[labels[<span class="op">-</span><span class="dv">1</span>]].append({<span class="st">"node"</span>: label_j, <span class="st">"weight"</span>: limb_j})</span>
<span id="cb233-65"><a href="#cb233-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb233-66"><a href="#cb233-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-67"><a href="#cb233-67" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb233-68"><a href="#cb233-68" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb233-69"><a href="#cb233-69" aria-hidden="true" tabindex="-1"></a><span class="st">0   23  27  20</span></span>
<span id="cb233-70"><a href="#cb233-70" aria-hidden="true" tabindex="-1"></a><span class="st">23  0   30  28</span></span>
<span id="cb233-71"><a href="#cb233-71" aria-hidden="true" tabindex="-1"></a><span class="st">27  30  0   30</span></span>
<span id="cb233-72"><a href="#cb233-72" aria-hidden="true" tabindex="-1"></a><span class="st">20  28  30  0</span></span>
<span id="cb233-73"><a href="#cb233-73" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb233-74"><a href="#cb233-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-75"><a href="#cb233-75" aria-hidden="true" tabindex="-1"></a>num_nodes, <span class="op">*</span>distance_matrix <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb233-76"><a href="#cb233-76" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> np.array(parse_matrix(distance_matrix), <span class="bu">float</span>)</span>
<span id="cb233-77"><a href="#cb233-77" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> neighbor_joining(distance_matrix, <span class="bu">int</span>(num_nodes))</span>
<span id="cb233-78"><a href="#cb233-78" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> format_edges(tree):</span>
<span id="cb233-79"><a href="#cb233-79" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-smallparsimony" class="level1" data-number="78">
<h1 data-number="78"><span class="header-section-number">78</span> Implement SmallParsimony</h1>
<p>Small Parsimony Problem. Find the most parsimonious labeling of the internal nodes of a rooted tree.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>&nbsp;followed by an adjacency list for a rooted binary tree with&nbsp;<em>n</em>&nbsp;leaves labeled by DNA strings.</p>
<p>Return:&nbsp;The minimum parsimony score of this tree, followed by the adjacency list of the tree corresponding to labeling internal nodes by DNA strings in order to minimize the parsimony score of the tree.</p>
<p><strong>Note:</strong>&nbsp;Remember to run&nbsp;<strong>SmallParsimony</strong>&nbsp;on each individual index of the strings at the leaves of the tree.</p>
<section id="sample-dataset-78" class="level2" data-number="78.1">
<h2 data-number="78.1" class="anchored" data-anchor-id="sample-dataset-78"><span class="header-section-number">78.1</span> Sample Dataset</h2>
<pre><code>4
4-&gt;CAAATCCC
4-&gt;ATTGCGAC
5-&gt;CTGCGCTG
5-&gt;ATGGACGA
6-&gt;4
6-&gt;5</code></pre>
</section>
<section id="sample-output-78" class="level2" data-number="78.2">
<h2 data-number="78.2" class="anchored" data-anchor-id="sample-output-78"><span class="header-section-number">78.2</span> Sample Output</h2>
<pre><code>16
ATAGACAA-&gt;ATAGACAC:1
ATAGACAC-&gt;ATAGACAA:1
ATAGACAC-&gt;CAAATCCC:5
CAAATCCC-&gt;ATAGACAC:5
ATAGACAC-&gt;ATTGCGAC:3
ATTGCGAC-&gt;ATAGACAC:3
ATAGACAA-&gt;ATGGACAA:1
ATGGACAA-&gt;ATAGACAA:1
ATGGACAA-&gt;CTGCGCTG:5
CTGCGCTG-&gt;ATGGACAA:5
ATGGACAA-&gt;ATGGACGA:1
ATGGACGA-&gt;ATGGACAA:1</code></pre>
</section>
<section id="solution-78" class="level2" data-number="78.3">
<h2 data-number="78.3" class="anchored" data-anchor-id="solution-78"><span class="header-section-number">78.3</span> Solution</h2>
<div class="sourceCode" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="adapt-smallparsimony-to-unrooted-trees" class="level1" data-number="79">
<h1 data-number="79"><span class="header-section-number">79</span> Adapt SmallParsimony to Unrooted Trees</h1>
<p>Small Parsimony in an Unrooted Tree Problem. Find the most parsimonious labeling of the internal nodes in an unrooted tree.</p>
<p>Given:&nbsp;An unrooted binary tree with each leaf labeled by a string of length&nbsp;<em>m</em>.</p>
<p>Return:&nbsp;A labeling of all other nodes of the tree by strings of length&nbsp;<em>m</em>&nbsp;that minimizes the parsimony score of the tree.</p>
<p><strong>Note on formatting</strong>: Your internal node labelings may differ from the sample provided.</p>
<section id="sample-dataset-79" class="level2" data-number="79.1">
<h2 data-number="79.1" class="anchored" data-anchor-id="sample-dataset-79"><span class="header-section-number">79.1</span> Sample Dataset</h2>
<pre><code>4
TCGGCCAA-&gt;4
4-&gt;TCGGCCAA
CCTGGCTG-&gt;4
4-&gt;CCTGGCTG
CACAGGAT-&gt;5
5-&gt;CACAGGAT
TGAGTACC-&gt;5
5-&gt;TGAGTACC
4-&gt;5
5-&gt;4</code></pre>
</section>
<section id="sample-output-79" class="level2" data-number="79.2">
<h2 data-number="79.2" class="anchored" data-anchor-id="sample-output-79"><span class="header-section-number">79.2</span> Sample Output</h2>
<pre><code>17
TCGGCCAA-&gt;CCAGGCAC:4
CCTGGCTG-&gt;CCAGGCAC:3
TGAGTACC-&gt;CAAGGAAC:4
CCAGGCAC-&gt;CCTGGCTG:3
CCAGGCAC-&gt;CAAGGAAC:2
CCAGGCAC-&gt;TCGGCCAA:4
CACAGGAT-&gt;CAAGGAAC:4
CAAGGAAC-&gt;CACAGGAT:4
CAAGGAAC-&gt;TGAGTACC:4
CAAGGAAC-&gt;CCAGGCAC:2</code></pre>
</section>
<section id="solution-79" class="level2" data-number="79.3">
<h2 data-number="79.3" class="anchored" data-anchor-id="solution-79"><span class="header-section-number">79.3</span> Solution</h2>
<div class="sourceCode" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a><span class="co"># return all nodes of a simple graph</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="bu">list</span>(graph.keys())</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>    e <span class="op">=</span> [y <span class="cf">for</span> v <span class="kw">in</span> graph.values() <span class="cf">for</span> y <span class="kw">in</span> v]</span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(s) <span class="op">|</span> <span class="bu">set</span>(e)</span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a><span class="co"># return all leaves of a simple graph</span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaves(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(y <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">list</span>(graph.values()) <span class="cf">for</span> y <span class="kw">in</span> v <span class="cf">if</span> <span class="kw">not</span> graph[y])</span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-15"><a href="#cb239-15" aria-hidden="true" tabindex="-1"></a><span class="co"># return all root node of a simple graph</span></span>
<span id="cb239-16"><a href="#cb239-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> root(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb239-17"><a href="#cb239-17" aria-hidden="true" tabindex="-1"></a>    rev <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb239-18"><a href="#cb239-18" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> <span class="bu">list</span>(nodes(graph))[<span class="dv">0</span>]</span>
<span id="cb239-19"><a href="#cb239-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="kw">in</span> rev:</span>
<span id="cb239-20"><a href="#cb239-20" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> rev[node]</span>
<span id="cb239-21"><a href="#cb239-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node</span>
<span id="cb239-22"><a href="#cb239-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-23"><a href="#cb239-23" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse a simple graph (child points to parent)</span></span>
<span id="cb239-24"><a href="#cb239-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb239-25"><a href="#cb239-25" aria-hidden="true" tabindex="-1"></a>    rev: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb239-26"><a href="#cb239-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb239-27"><a href="#cb239-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb239-28"><a href="#cb239-28" aria-hidden="true" tabindex="-1"></a>            rev[child] <span class="op">=</span> node</span>
<span id="cb239-29"><a href="#cb239-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rev</span>
<span id="cb239-30"><a href="#cb239-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-31"><a href="#cb239-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">int</span>, <span class="bu">str</span>], Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]:</span>
<span id="cb239-32"><a href="#cb239-32" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_string.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb239-33"><a href="#cb239-33" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">0</span>])</span>
<span id="cb239-34"><a href="#cb239-34" aria-hidden="true" tabindex="-1"></a>    seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb239-35"><a href="#cb239-35" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb239-36"><a href="#cb239-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, edge <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:n<span class="op">+</span><span class="dv">1</span>]):</span>
<span id="cb239-37"><a href="#cb239-37" aria-hidden="true" tabindex="-1"></a>        f, t <span class="op">=</span> edge.rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb239-38"><a href="#cb239-38" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(f)].append(i)</span>
<span id="cb239-39"><a href="#cb239-39" aria-hidden="true" tabindex="-1"></a>        seqs[i] <span class="op">=</span> t</span>
<span id="cb239-40"><a href="#cb239-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> lines[n<span class="op">+</span><span class="dv">1</span>:]:</span>
<span id="cb239-41"><a href="#cb239-41" aria-hidden="true" tabindex="-1"></a>        f, t <span class="op">=</span> edge.rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb239-42"><a href="#cb239-42" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(f)].append(<span class="bu">int</span>(t))</span>
<span id="cb239-43"><a href="#cb239-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seqs, graph</span>
<span id="cb239-44"><a href="#cb239-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-45"><a href="#cb239-45" aria-hidden="true" tabindex="-1"></a><span class="co"># print (bidirectional) edges</span></span>
<span id="cb239-46"><a href="#cb239-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_edges(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>], node: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb239-47"><a href="#cb239-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb239-48"><a href="#cb239-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">in</span> seqs <span class="kw">and</span> child <span class="kw">in</span> seqs:</span>
<span id="cb239-49"><a href="#cb239-49" aria-hidden="true" tabindex="-1"></a>            dist <span class="op">=</span> <span class="bu">sum</span>(a <span class="op">!=</span> b <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(seqs[node], seqs[child]))</span>
<span id="cb239-50"><a href="#cb239-50" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>seqs[node]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>seqs[child]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>dist<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb239-51"><a href="#cb239-51" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>seqs[child]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>seqs[node]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>dist<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb239-52"><a href="#cb239-52" aria-hidden="true" tabindex="-1"></a>        print_edges(graph, seqs, child)</span>
<span id="cb239-53"><a href="#cb239-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-54"><a href="#cb239-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_position(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>], pos: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb239-55"><a href="#cb239-55" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb239-56"><a href="#cb239-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> nodes(graph) <span class="op">-</span> leaves(graph):</span>
<span id="cb239-57"><a href="#cb239-57" aria-hidden="true" tabindex="-1"></a>        chars[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb239-58"><a href="#cb239-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves(graph):</span>
<span id="cb239-59"><a href="#cb239-59" aria-hidden="true" tabindex="-1"></a>        chars[leaf] <span class="op">=</span> seqs[leaf][pos]</span>
<span id="cb239-60"><a href="#cb239-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb239-61"><a href="#cb239-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-62"><a href="#cb239-62" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> traceback(skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]], node: <span class="bu">int</span>, ind: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb239-63"><a href="#cb239-63" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb239-64"><a href="#cb239-64" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb239-65"><a href="#cb239-65" aria-hidden="true" tabindex="-1"></a>    chars[node] <span class="op">=</span> bases[ind]</span>
<span id="cb239-66"><a href="#cb239-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> skp[node][ind].items():</span>
<span id="cb239-67"><a href="#cb239-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> k <span class="kw">in</span> skp:</span>
<span id="cb239-68"><a href="#cb239-68" aria-hidden="true" tabindex="-1"></a>            chars <span class="op">=</span> chars <span class="op">|</span> traceback(skp, k, v)</span>
<span id="cb239-69"><a href="#cb239-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb239-70"><a href="#cb239-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-71"><a href="#cb239-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> small_parsimony(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb239-72"><a href="#cb239-72" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb239-73"><a href="#cb239-73" aria-hidden="true" tabindex="-1"></a>    sk: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}  <span class="co"># minimum parsimony score of the subtree over possible labels</span></span>
<span id="cb239-74"><a href="#cb239-74" aria-hidden="true" tabindex="-1"></a>    skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]] <span class="op">=</span> {}  <span class="co"># pointer to selected base for each child over possible labels</span></span>
<span id="cb239-75"><a href="#cb239-75" aria-hidden="true" tabindex="-1"></a>    to_process <span class="op">=</span> nodes(graph)</span>
<span id="cb239-76"><a href="#cb239-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-77"><a href="#cb239-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialise leaves</span></span>
<span id="cb239-78"><a href="#cb239-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves(graph):</span>
<span id="cb239-79"><a href="#cb239-79" aria-hidden="true" tabindex="-1"></a>        sk[leaf] <span class="op">=</span> [<span class="dv">0</span> <span class="cf">if</span> chars[leaf] <span class="op">==</span> c <span class="cf">else</span> inf <span class="cf">for</span> c <span class="kw">in</span> bases]</span>
<span id="cb239-80"><a href="#cb239-80" aria-hidden="true" tabindex="-1"></a>        to_process.remove(leaf)</span>
<span id="cb239-81"><a href="#cb239-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-82"><a href="#cb239-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># iterate over available nodes till all are processed</span></span>
<span id="cb239-83"><a href="#cb239-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> to_process:</span>
<span id="cb239-84"><a href="#cb239-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">list</span>(to_process):</span>
<span id="cb239-85"><a href="#cb239-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(v <span class="kw">in</span> sk <span class="cf">for</span> v <span class="kw">in</span> graph[n]):</span>
<span id="cb239-86"><a href="#cb239-86" aria-hidden="true" tabindex="-1"></a>                sk[n], skp[n] <span class="op">=</span> [], []</span>
<span id="cb239-87"><a href="#cb239-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> bases:</span>
<span id="cb239-88"><a href="#cb239-88" aria-hidden="true" tabindex="-1"></a>                    tot <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb239-89"><a href="#cb239-89" aria-hidden="true" tabindex="-1"></a>                    ptr: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb239-90"><a href="#cb239-90" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> d, sk_child <span class="kw">in</span> [(d, sk[d]) <span class="cf">for</span> d <span class="kw">in</span> graph[n]]:</span>
<span id="cb239-91"><a href="#cb239-91" aria-hidden="true" tabindex="-1"></a>                        score <span class="op">=</span> []</span>
<span id="cb239-92"><a href="#cb239-92" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(bases):</span>
<span id="cb239-93"><a href="#cb239-93" aria-hidden="true" tabindex="-1"></a>                            score <span class="op">+=</span> [sk_child[i] <span class="op">+</span> (<span class="dv">0</span> <span class="cf">if</span> c <span class="op">==</span> k <span class="cf">else</span> <span class="dv">1</span>)]</span>
<span id="cb239-94"><a href="#cb239-94" aria-hidden="true" tabindex="-1"></a>                        tot <span class="op">+=</span> <span class="bu">min</span>(score)</span>
<span id="cb239-95"><a href="#cb239-95" aria-hidden="true" tabindex="-1"></a>                        ptr[d] <span class="op">=</span> score.index(<span class="bu">min</span>(score))</span>
<span id="cb239-96"><a href="#cb239-96" aria-hidden="true" tabindex="-1"></a>                    skp[n] <span class="op">+=</span> [ptr]</span>
<span id="cb239-97"><a href="#cb239-97" aria-hidden="true" tabindex="-1"></a>                    sk[n] <span class="op">+=</span> [tot]</span>
<span id="cb239-98"><a href="#cb239-98" aria-hidden="true" tabindex="-1"></a>                to_process.remove(n)</span>
<span id="cb239-99"><a href="#cb239-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-100"><a href="#cb239-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recover sequence</span></span>
<span id="cb239-101"><a href="#cb239-101" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> root(graph)</span>
<span id="cb239-102"><a href="#cb239-102" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> <span class="bu">min</span>(sk[node])</span>
<span id="cb239-103"><a href="#cb239-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score, traceback(skp, node, sk[node].index(score))</span>
<span id="cb239-104"><a href="#cb239-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-105"><a href="#cb239-105" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6f(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb239-106"><a href="#cb239-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialise sequences</span></span>
<span id="cb239-107"><a href="#cb239-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> nodes(graph) <span class="op">-</span> leaves(graph):</span>
<span id="cb239-108"><a href="#cb239-108" aria-hidden="true" tabindex="-1"></a>        seqs[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb239-109"><a href="#cb239-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-110"><a href="#cb239-110" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb239-111"><a href="#cb239-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pos <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="bu">next</span>(<span class="bu">iter</span>(seqs.values())))):</span>
<span id="cb239-112"><a href="#cb239-112" aria-hidden="true" tabindex="-1"></a>        chars <span class="op">=</span> extract_position(graph, seqs, pos)</span>
<span id="cb239-113"><a href="#cb239-113" aria-hidden="true" tabindex="-1"></a>        score, tbchars <span class="op">=</span> small_parsimony(graph, chars)</span>
<span id="cb239-114"><a href="#cb239-114" aria-hidden="true" tabindex="-1"></a>        total_score <span class="op">+=</span> score</span>
<span id="cb239-115"><a href="#cb239-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k, v <span class="kw">in</span> tbchars.items():</span>
<span id="cb239-116"><a href="#cb239-116" aria-hidden="true" tabindex="-1"></a>            seqs[k] <span class="op">+=</span> v</span>
<span id="cb239-117"><a href="#cb239-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-118"><a href="#cb239-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_score, seqs</span>
<span id="cb239-119"><a href="#cb239-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-120"><a href="#cb239-120" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb239-121"><a href="#cb239-121" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb239-122"><a href="#cb239-122" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;CAAATCCC</span></span>
<span id="cb239-123"><a href="#cb239-123" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;ATTGCGAC</span></span>
<span id="cb239-124"><a href="#cb239-124" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;CTGCGCTG</span></span>
<span id="cb239-125"><a href="#cb239-125" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;ATGGACGA</span></span>
<span id="cb239-126"><a href="#cb239-126" aria-hidden="true" tabindex="-1"></a><span class="st">6-&gt;4</span></span>
<span id="cb239-127"><a href="#cb239-127" aria-hidden="true" tabindex="-1"></a><span class="st">6-&gt;5</span></span>
<span id="cb239-128"><a href="#cb239-128" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb239-129"><a href="#cb239-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-130"><a href="#cb239-130" aria-hidden="true" tabindex="-1"></a>seqs, graph <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb239-131"><a href="#cb239-131" aria-hidden="true" tabindex="-1"></a>total_score, seqs <span class="op">=</span> ba6f(graph, seqs)</span>
<span id="cb239-132"><a href="#cb239-132" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(total_score)</span>
<span id="cb239-133"><a href="#cb239-133" aria-hidden="true" tabindex="-1"></a>print_edges(graph, seqs, root(graph))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="adapt-smallparsimony-to-unrooted-trees-1" class="level1" data-number="80">
<h1 data-number="80"><span class="header-section-number">80</span> Adapt SmallParsimony to Unrooted Trees</h1>
<p>Small Parsimony in an Unrooted Tree Problem. Find the most parsimonious labeling of the internal nodes in an unrooted tree.</p>
<p>Given:&nbsp;An unrooted binary tree with each leaf labeled by a string of length&nbsp;<em>m</em>.</p>
<p>Return:&nbsp;A labeling of all other nodes of the tree by strings of length&nbsp;<em>m</em>&nbsp;that minimizes the parsimony score of the tree.</p>
<p><strong>Note on formatting</strong>: Your internal node labelings may differ from the sample provided.</p>
<section id="sample-dataset-80" class="level2" data-number="80.1">
<h2 data-number="80.1" class="anchored" data-anchor-id="sample-dataset-80"><span class="header-section-number">80.1</span> Sample Dataset</h2>
<pre><code>4
TCGGCCAA-&gt;4
4-&gt;TCGGCCAA
CCTGGCTG-&gt;4
4-&gt;CCTGGCTG
CACAGGAT-&gt;5
5-&gt;CACAGGAT
TGAGTACC-&gt;5
5-&gt;TGAGTACC
4-&gt;5
5-&gt;4</code></pre>
</section>
<section id="sample-output-80" class="level2" data-number="80.2">
<h2 data-number="80.2" class="anchored" data-anchor-id="sample-output-80"><span class="header-section-number">80.2</span> Sample Output</h2>
<pre><code>17
TCGGCCAA-&gt;CCAGGCAC:4
CCTGGCTG-&gt;CCAGGCAC:3
TGAGTACC-&gt;CAAGGAAC:4
CCAGGCAC-&gt;CCTGGCTG:3
CCAGGCAC-&gt;CAAGGAAC:2
CCAGGCAC-&gt;TCGGCCAA:4
CACAGGAT-&gt;CAAGGAAC:4
CAAGGAAC-&gt;CACAGGAT:4
CAAGGAAC-&gt;TGAGTACC:4
CAAGGAAC-&gt;CCAGGCAC:2</code></pre>
</section>
<section id="solution-80" class="level2" data-number="80.3">
<h2 data-number="80.3" class="anchored" data-anchor-id="solution-80"><span class="header-section-number">80.3</span> Solution</h2>
<div class="sourceCode" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple, TextIO</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="bu">list</span>(graph.keys())</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>    e <span class="op">=</span> [y <span class="cf">for</span> v <span class="kw">in</span> graph.values() <span class="cf">for</span> y <span class="kw">in</span> v]</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(s) <span class="op">|</span> <span class="bu">set</span>(e)</span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaves(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(y <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">list</span>(graph.values()) <span class="cf">for</span> y <span class="kw">in</span> v <span class="cf">if</span> <span class="kw">not</span> graph[y])</span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> root(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a>    rev <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> <span class="bu">list</span>(nodes(graph))[<span class="dv">0</span>]</span>
<span id="cb242-17"><a href="#cb242-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="kw">in</span> rev:</span>
<span id="cb242-18"><a href="#cb242-18" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> rev[node]</span>
<span id="cb242-19"><a href="#cb242-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node</span>
<span id="cb242-20"><a href="#cb242-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-21"><a href="#cb242-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb242-22"><a href="#cb242-22" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb242-23"><a href="#cb242-23" aria-hidden="true" tabindex="-1"></a>    target_nodes <span class="op">=</span> {target <span class="cf">for</span> targets <span class="kw">in</span> graph.values() <span class="cf">for</span> target <span class="kw">in</span> targets}</span>
<span id="cb242-24"><a href="#cb242-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> target_nodes</span>
<span id="cb242-25"><a href="#cb242-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-26"><a href="#cb242-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb242-27"><a href="#cb242-27" aria-hidden="true" tabindex="-1"></a>    reversed_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb242-28"><a href="#cb242-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parent, children <span class="kw">in</span> graph.items():</span>
<span id="cb242-29"><a href="#cb242-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> children:</span>
<span id="cb242-30"><a href="#cb242-30" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child] <span class="op">=</span> parent</span>
<span id="cb242-31"><a href="#cb242-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb242-32"><a href="#cb242-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-33"><a href="#cb242-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_leaves(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb242-34"><a href="#cb242-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {child <span class="cf">for</span> children <span class="kw">in</span> graph.values() <span class="cf">for</span> child <span class="kw">in</span> children <span class="cf">if</span> <span class="kw">not</span> graph[child]}</span>
<span id="cb242-35"><a href="#cb242-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-36"><a href="#cb242-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_root(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb242-37"><a href="#cb242-37" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb242-38"><a href="#cb242-38" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(get_all_nodes(graph)))</span>
<span id="cb242-39"><a href="#cb242-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="kw">in</span> reversed_graph:</span>
<span id="cb242-40"><a href="#cb242-40" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> reversed_graph[node]</span>
<span id="cb242-41"><a href="#cb242-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node</span>
<span id="cb242-42"><a href="#cb242-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-43"><a href="#cb242-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_edges(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>], node: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb242-44"><a href="#cb242-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb242-45"><a href="#cb242-45" aria-hidden="true" tabindex="-1"></a>        distance <span class="op">=</span> <span class="bu">sum</span>(a <span class="op">!=</span> b <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(sequences[node], sequences[child]))</span>
<span id="cb242-46"><a href="#cb242-46" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>sequences[node]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>sequences[child]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>distance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb242-47"><a href="#cb242-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>sequences[child]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>sequences[node]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>distance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb242-48"><a href="#cb242-48" aria-hidden="true" tabindex="-1"></a>        print_edges(graph, sequences, child)</span>
<span id="cb242-49"><a href="#cb242-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-50"><a href="#cb242-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> root_tree(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb242-51"><a href="#cb242-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb242-52"><a href="#cb242-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">in</span> graph[child]:</span>
<span id="cb242-53"><a href="#cb242-53" aria-hidden="true" tabindex="-1"></a>            graph[child].remove(node)</span>
<span id="cb242-54"><a href="#cb242-54" aria-hidden="true" tabindex="-1"></a>        root_tree(graph, child)</span>
<span id="cb242-55"><a href="#cb242-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-56"><a href="#cb242-56" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: TextIO) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">int</span>, <span class="bu">str</span>], Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]:</span>
<span id="cb242-57"><a href="#cb242-57" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle))</span>
<span id="cb242-58"><a href="#cb242-58" aria-hidden="true" tabindex="-1"></a>    sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb242-59"><a href="#cb242-59" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb242-60"><a href="#cb242-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb242-61"><a href="#cb242-61" aria-hidden="true" tabindex="-1"></a>        <span class="bu">next</span>(handle)</span>
<span id="cb242-62"><a href="#cb242-62" aria-hidden="true" tabindex="-1"></a>        from_node, to_seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb242-63"><a href="#cb242-63" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(from_node)].append(i)</span>
<span id="cb242-64"><a href="#cb242-64" aria-hidden="true" tabindex="-1"></a>        sequences[i] <span class="op">=</span> to_seq</span>
<span id="cb242-65"><a href="#cb242-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-66"><a href="#cb242-66" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> handle.readlines()</span>
<span id="cb242-67"><a href="#cb242-67" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">0</span>].rstrip().split(<span class="st">"-&gt;"</span>)[<span class="dv">0</span>])</span>
<span id="cb242-68"><a href="#cb242-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> lines:</span>
<span id="cb242-69"><a href="#cb242-69" aria-hidden="true" tabindex="-1"></a>        from_node, to_node <span class="op">=</span> edge.rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb242-70"><a href="#cb242-70" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(from_node)].append(<span class="bu">int</span>(to_node))</span>
<span id="cb242-71"><a href="#cb242-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-72"><a href="#cb242-72" aria-hidden="true" tabindex="-1"></a>    root_tree(graph, root)</span>
<span id="cb242-73"><a href="#cb242-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequences, graph</span>
<span id="cb242-74"><a href="#cb242-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-75"><a href="#cb242-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_position(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>], pos: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb242-76"><a href="#cb242-76" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb242-77"><a href="#cb242-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> get_all_nodes(graph) <span class="op">-</span> get_leaves(graph):</span>
<span id="cb242-78"><a href="#cb242-78" aria-hidden="true" tabindex="-1"></a>        chars[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb242-79"><a href="#cb242-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> get_leaves(graph):</span>
<span id="cb242-80"><a href="#cb242-80" aria-hidden="true" tabindex="-1"></a>        chars[leaf] <span class="op">=</span> sequences[leaf][pos]</span>
<span id="cb242-81"><a href="#cb242-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb242-82"><a href="#cb242-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-83"><a href="#cb242-83" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6f(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb242-84"><a href="#cb242-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> get_all_nodes(graph) <span class="op">-</span> get_leaves(graph):</span>
<span id="cb242-85"><a href="#cb242-85" aria-hidden="true" tabindex="-1"></a>        sequences[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb242-86"><a href="#cb242-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-87"><a href="#cb242-87" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb242-88"><a href="#cb242-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pos <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="bu">next</span>(<span class="bu">iter</span>(sequences.values())))):</span>
<span id="cb242-89"><a href="#cb242-89" aria-hidden="true" tabindex="-1"></a>        chars <span class="op">=</span> extract_position(graph, sequences, pos)</span>
<span id="cb242-90"><a href="#cb242-90" aria-hidden="true" tabindex="-1"></a>        score, tbchars <span class="op">=</span> small_parsimony(graph, chars)</span>
<span id="cb242-91"><a href="#cb242-91" aria-hidden="true" tabindex="-1"></a>        total_score <span class="op">+=</span> score</span>
<span id="cb242-92"><a href="#cb242-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k, v <span class="kw">in</span> tbchars.items():</span>
<span id="cb242-93"><a href="#cb242-93" aria-hidden="true" tabindex="-1"></a>            sequences[k] <span class="op">+=</span> v</span>
<span id="cb242-94"><a href="#cb242-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-95"><a href="#cb242-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_score, sequences</span>
<span id="cb242-96"><a href="#cb242-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-97"><a href="#cb242-97" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> small_parsimony(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb242-98"><a href="#cb242-98" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb242-99"><a href="#cb242-99" aria-hidden="true" tabindex="-1"></a>    sk: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb242-100"><a href="#cb242-100" aria-hidden="true" tabindex="-1"></a>    skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]] <span class="op">=</span> {}</span>
<span id="cb242-101"><a href="#cb242-101" aria-hidden="true" tabindex="-1"></a>    to_process <span class="op">=</span> nodes(graph)</span>
<span id="cb242-102"><a href="#cb242-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-103"><a href="#cb242-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves(graph):</span>
<span id="cb242-104"><a href="#cb242-104" aria-hidden="true" tabindex="-1"></a>        sk[leaf] <span class="op">=</span> [<span class="dv">0</span> <span class="cf">if</span> chars[leaf] <span class="op">==</span> c <span class="cf">else</span> inf <span class="cf">for</span> c <span class="kw">in</span> bases]</span>
<span id="cb242-105"><a href="#cb242-105" aria-hidden="true" tabindex="-1"></a>        to_process.remove(leaf)</span>
<span id="cb242-106"><a href="#cb242-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-107"><a href="#cb242-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> to_process:</span>
<span id="cb242-108"><a href="#cb242-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">list</span>(to_process):</span>
<span id="cb242-109"><a href="#cb242-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(v <span class="kw">in</span> sk <span class="cf">for</span> v <span class="kw">in</span> graph[n]):</span>
<span id="cb242-110"><a href="#cb242-110" aria-hidden="true" tabindex="-1"></a>                sk[n], skp[n] <span class="op">=</span> [], []</span>
<span id="cb242-111"><a href="#cb242-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> bases:</span>
<span id="cb242-112"><a href="#cb242-112" aria-hidden="true" tabindex="-1"></a>                    tot <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb242-113"><a href="#cb242-113" aria-hidden="true" tabindex="-1"></a>                    ptr: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb242-114"><a href="#cb242-114" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> d, sk_child <span class="kw">in</span> [(d, sk[d]) <span class="cf">for</span> d <span class="kw">in</span> graph[n]]:</span>
<span id="cb242-115"><a href="#cb242-115" aria-hidden="true" tabindex="-1"></a>                        score <span class="op">=</span> []</span>
<span id="cb242-116"><a href="#cb242-116" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(bases):</span>
<span id="cb242-117"><a href="#cb242-117" aria-hidden="true" tabindex="-1"></a>                            score <span class="op">+=</span> [sk_child[i] <span class="op">+</span> (<span class="dv">0</span> <span class="cf">if</span> c <span class="op">==</span> k <span class="cf">else</span> <span class="dv">1</span>)]</span>
<span id="cb242-118"><a href="#cb242-118" aria-hidden="true" tabindex="-1"></a>                        tot <span class="op">+=</span> <span class="bu">min</span>(score)</span>
<span id="cb242-119"><a href="#cb242-119" aria-hidden="true" tabindex="-1"></a>                        ptr[d] <span class="op">=</span> score.index(<span class="bu">min</span>(score))</span>
<span id="cb242-120"><a href="#cb242-120" aria-hidden="true" tabindex="-1"></a>                    skp[n] <span class="op">+=</span> [ptr]</span>
<span id="cb242-121"><a href="#cb242-121" aria-hidden="true" tabindex="-1"></a>                    sk[n] <span class="op">+=</span> [tot]</span>
<span id="cb242-122"><a href="#cb242-122" aria-hidden="true" tabindex="-1"></a>                to_process.remove(n)</span>
<span id="cb242-123"><a href="#cb242-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-124"><a href="#cb242-124" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> root(graph)</span>
<span id="cb242-125"><a href="#cb242-125" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> <span class="bu">min</span>(sk[node])</span>
<span id="cb242-126"><a href="#cb242-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score, traceback(skp, node, sk[node].index(score))</span>
<span id="cb242-127"><a href="#cb242-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-128"><a href="#cb242-128" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> traceback(skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]], node: <span class="bu">int</span>, ind: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb242-129"><a href="#cb242-129" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb242-130"><a href="#cb242-130" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb242-131"><a href="#cb242-131" aria-hidden="true" tabindex="-1"></a>    chars[node] <span class="op">=</span> bases[ind]</span>
<span id="cb242-132"><a href="#cb242-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> skp[node][ind].items():</span>
<span id="cb242-133"><a href="#cb242-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> k <span class="kw">in</span> skp:</span>
<span id="cb242-134"><a href="#cb242-134" aria-hidden="true" tabindex="-1"></a>            chars <span class="op">=</span> chars <span class="op">|</span> traceback(skp, k, v)</span>
<span id="cb242-135"><a href="#cb242-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb242-136"><a href="#cb242-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-137"><a href="#cb242-137" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb242-138"><a href="#cb242-138" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb242-139"><a href="#cb242-139" aria-hidden="true" tabindex="-1"></a><span class="st">TCGGCCAA-&gt;4</span></span>
<span id="cb242-140"><a href="#cb242-140" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;TCGGCCAA</span></span>
<span id="cb242-141"><a href="#cb242-141" aria-hidden="true" tabindex="-1"></a><span class="st">CCTGGCTG-&gt;4</span></span>
<span id="cb242-142"><a href="#cb242-142" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;CCTGGCTG</span></span>
<span id="cb242-143"><a href="#cb242-143" aria-hidden="true" tabindex="-1"></a><span class="st">CACAGGAT-&gt;5</span></span>
<span id="cb242-144"><a href="#cb242-144" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;CACAGGAT</span></span>
<span id="cb242-145"><a href="#cb242-145" aria-hidden="true" tabindex="-1"></a><span class="st">TGAGTACC-&gt;5</span></span>
<span id="cb242-146"><a href="#cb242-146" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;TGAGTACC</span></span>
<span id="cb242-147"><a href="#cb242-147" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;5</span></span>
<span id="cb242-148"><a href="#cb242-148" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;4</span></span>
<span id="cb242-149"><a href="#cb242-149" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb242-150"><a href="#cb242-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-151"><a href="#cb242-151" aria-hidden="true" tabindex="-1"></a>sequences, graph <span class="op">=</span> parse_input(io.StringIO(sample_input.strip()))</span>
<span id="cb242-152"><a href="#cb242-152" aria-hidden="true" tabindex="-1"></a>total_score, sequences <span class="op">=</span> ba6f(graph, sequences)</span>
<span id="cb242-153"><a href="#cb242-153" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(total_score)</span>
<span id="cb242-154"><a href="#cb242-154" aria-hidden="true" tabindex="-1"></a>print_edges(graph, sequences, find_root(graph))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-farthestfirsttraversal" class="level1" data-number="81">
<h1 data-number="81"><span class="header-section-number">81</span> Implement FarthestFirstTraversal</h1>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>m</em>&nbsp;followed by a set of points&nbsp;<em>Data</em>&nbsp;in&nbsp;<em>m</em>-dimensional space.</p>
<p>Return:&nbsp;A set&nbsp;<em>Centers</em>&nbsp;consisting of&nbsp;<em>k</em>&nbsp;points (centers) resulting from applying&nbsp;<strong>FarthestFirstTraversal</strong>(<em>Data</em>,&nbsp;<em>k</em>), where the first point from&nbsp;<em>Data</em>&nbsp;is chosen as the first center to initialize the algorithm.</p>
<section id="sample-dataset-81" class="level2" data-number="81.1">
<h2 data-number="81.1" class="anchored" data-anchor-id="sample-dataset-81"><span class="header-section-number">81.1</span> Sample Dataset</h2>
<pre><code>3 2
0.0 0.0
5.0 5.0
0.0 5.0
1.0 1.0
2.0 2.0
3.0 3.0
1.0 2.0</code></pre>
</section>
<section id="sample-output-81" class="level2" data-number="81.2">
<h2 data-number="81.2" class="anchored" data-anchor-id="sample-output-81"><span class="header-section-number">81.2</span> Sample Output</h2>
<pre><code>0.0 0.0
5.0 5.0
0.0 5.0</code></pre>
</section>
<section id="solution-81" class="level2" data-number="81.3">
<h2 data-number="81.3" class="anchored" data-anchor-id="solution-81"><span class="header-section-number">81.3</span> Solution</h2>
<div class="sourceCode" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator, TextIO, TypeVar</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: TextIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: List[<span class="bu">float</span>], point_b: List[<span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((coord_a <span class="op">-</span> coord_b) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> coord_a, coord_b <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_center_distance(data_point: List[<span class="bu">float</span>], center_points: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb245-16"><a href="#cb245-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance from DataPoint to its closest center"""</span></span>
<span id="cb245-17"><a href="#cb245-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(euclidean_distance(data_point, center) <span class="cf">for</span> center <span class="kw">in</span> center_points)</span>
<span id="cb245-18"><a href="#cb245-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-19"><a href="#cb245-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> farthest_first_traversal(data_points: List[List[<span class="bu">float</span>]], num_centers: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb245-20"><a href="#cb245-20" aria-hidden="true" tabindex="-1"></a>    center_points <span class="op">=</span> [data_points[<span class="dv">0</span>]]</span>
<span id="cb245-21"><a href="#cb245-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(center_points) <span class="op">&lt;</span> num_centers:</span>
<span id="cb245-22"><a href="#cb245-22" aria-hidden="true" tabindex="-1"></a>        distances <span class="op">=</span> [(i, nearest_center_distance(point, center_points)) <span class="cf">for</span> i, point <span class="kw">in</span> <span class="bu">enumerate</span>(data_points)]</span>
<span id="cb245-23"><a href="#cb245-23" aria-hidden="true" tabindex="-1"></a>        center_points.append(data_points[<span class="bu">max</span>(distances, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])[<span class="dv">0</span>]])</span>
<span id="cb245-24"><a href="#cb245-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> center_points</span>
<span id="cb245-25"><a href="#cb245-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-26"><a href="#cb245-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb245-27"><a href="#cb245-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-28"><a href="#cb245-28" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb245-29"><a href="#cb245-29" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb245-30"><a href="#cb245-30" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 0.0</span></span>
<span id="cb245-31"><a href="#cb245-31" aria-hidden="true" tabindex="-1"></a><span class="st">5.0 5.0</span></span>
<span id="cb245-32"><a href="#cb245-32" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 5.0</span></span>
<span id="cb245-33"><a href="#cb245-33" aria-hidden="true" tabindex="-1"></a><span class="st">1.0 1.0</span></span>
<span id="cb245-34"><a href="#cb245-34" aria-hidden="true" tabindex="-1"></a><span class="st">2.0 2.0</span></span>
<span id="cb245-35"><a href="#cb245-35" aria-hidden="true" tabindex="-1"></a><span class="st">3.0 3.0</span></span>
<span id="cb245-36"><a href="#cb245-36" aria-hidden="true" tabindex="-1"></a><span class="st">1.0 2.0</span></span>
<span id="cb245-37"><a href="#cb245-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb245-38"><a href="#cb245-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-39"><a href="#cb245-39" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb245-40"><a href="#cb245-40" aria-hidden="true" tabindex="-1"></a>num_centers, dimensions <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb245-41"><a href="#cb245-41" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [point <span class="cf">for</span> point <span class="kw">in</span> read_types(file_handle, <span class="bu">float</span>)]</span>
<span id="cb245-42"><a href="#cb245-42" aria-hidden="true" tabindex="-1"></a>center_points <span class="op">=</span> farthest_first_traversal(data_points, num_centers)</span>
<span id="cb245-43"><a href="#cb245-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center <span class="kw">in</span> center_points:</span>
<span id="cb245-44"><a href="#cb245-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>center)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-squared-error-distortion" class="level1" data-number="82">
<h1 data-number="82"><span class="header-section-number">82</span> Compute the Squared Error Distortion</h1>
<p>Squared Error Distortion Problem.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>m</em>, followed by a set of centers&nbsp;<em>Centers</em>&nbsp;and a set of points&nbsp;<em>Data</em>.</p>
<p>Return:&nbsp;The squared error distortion&nbsp;<em>Distortion</em>(<em>Data</em>,&nbsp;<em>Centers</em>).</p>
<section id="sample-dataset-82" class="level2" data-number="82.1">
<h2 data-number="82.1" class="anchored" data-anchor-id="sample-dataset-82"><span class="header-section-number">82.1</span> Sample Dataset</h2>
<pre><code>2 2
2.31 4.55
5.96 9.08
--------
3.42 6.03
6.23 8.25
4.76 1.64
4.47 4.33
3.95 7.61
8.93 2.97
9.74 4.03
1.73 1.28
9.72 5.01
7.27 3.77</code></pre>
</section>
<section id="sample-output-82" class="level2" data-number="82.2">
<h2 data-number="82.2" class="anchored" data-anchor-id="sample-output-82"><span class="header-section-number">82.2</span> Sample Output</h2>
<pre><code>18.246</code></pre>
</section>
<section id="solution-82" class="level2" data-number="82.3">
<h2 data-number="82.3" class="anchored" data-anchor-id="solution-82"><span class="header-section-number">82.3</span> Solution</h2>
<div class="sourceCode" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator, TextIO, TypeVar</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: TextIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: List[<span class="bu">float</span>], point_b: List[<span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((coord_a <span class="op">-</span> coord_b) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> coord_a, coord_b <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_center_distance(data_point: List[<span class="bu">float</span>], center_points: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance from DataPoint to its closest center"""</span></span>
<span id="cb248-17"><a href="#cb248-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(euclidean_distance(data_point, center) <span class="cf">for</span> center <span class="kw">in</span> center_points)</span>
<span id="cb248-18"><a href="#cb248-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-19"><a href="#cb248-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_distortion(data_points: List[List[<span class="bu">float</span>]], center_points: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb248-20"><a href="#cb248-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span> <span class="op">/</span> <span class="bu">len</span>(data_points)) <span class="op">*</span> <span class="bu">sum</span>(nearest_center_distance(point, center_points) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> point <span class="kw">in</span> data_points)</span>
<span id="cb248-21"><a href="#cb248-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-22"><a href="#cb248-22" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb248-23"><a href="#cb248-23" aria-hidden="true" tabindex="-1"></a><span class="st">2 2</span></span>
<span id="cb248-24"><a href="#cb248-24" aria-hidden="true" tabindex="-1"></a><span class="st">2.31 4.55</span></span>
<span id="cb248-25"><a href="#cb248-25" aria-hidden="true" tabindex="-1"></a><span class="st">5.96 9.08</span></span>
<span id="cb248-26"><a href="#cb248-26" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb248-27"><a href="#cb248-27" aria-hidden="true" tabindex="-1"></a><span class="st">3.42 6.03</span></span>
<span id="cb248-28"><a href="#cb248-28" aria-hidden="true" tabindex="-1"></a><span class="st">6.23 8.25</span></span>
<span id="cb248-29"><a href="#cb248-29" aria-hidden="true" tabindex="-1"></a><span class="st">4.76 1.64</span></span>
<span id="cb248-30"><a href="#cb248-30" aria-hidden="true" tabindex="-1"></a><span class="st">4.47 4.33</span></span>
<span id="cb248-31"><a href="#cb248-31" aria-hidden="true" tabindex="-1"></a><span class="st">3.95 7.61</span></span>
<span id="cb248-32"><a href="#cb248-32" aria-hidden="true" tabindex="-1"></a><span class="st">8.93 2.97</span></span>
<span id="cb248-33"><a href="#cb248-33" aria-hidden="true" tabindex="-1"></a><span class="st">9.74 4.03</span></span>
<span id="cb248-34"><a href="#cb248-34" aria-hidden="true" tabindex="-1"></a><span class="st">1.73 1.28</span></span>
<span id="cb248-35"><a href="#cb248-35" aria-hidden="true" tabindex="-1"></a><span class="st">9.72 5.01</span></span>
<span id="cb248-36"><a href="#cb248-36" aria-hidden="true" tabindex="-1"></a><span class="st">7.27 3.77</span></span>
<span id="cb248-37"><a href="#cb248-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb248-38"><a href="#cb248-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-39"><a href="#cb248-39" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb248-40"><a href="#cb248-40" aria-hidden="true" tabindex="-1"></a>num_centers, _ <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb248-41"><a href="#cb248-41" aria-hidden="true" tabindex="-1"></a>data_generator <span class="op">=</span> read_types(file_handle, <span class="bu">float</span>)</span>
<span id="cb248-42"><a href="#cb248-42" aria-hidden="true" tabindex="-1"></a>center_points <span class="op">=</span> [<span class="bu">next</span>(data_generator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_centers)]</span>
<span id="cb248-43"><a href="#cb248-43" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> <span class="bu">next</span>(file_handle)</span>
<span id="cb248-44"><a href="#cb248-44" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [point <span class="cf">for</span> point <span class="kw">in</span> data_generator]</span>
<span id="cb248-45"><a href="#cb248-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">round</span>(calculate_distortion(data_points, center_points), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-lloyd-algorithm-for-k-means-clustering" class="level1" data-number="83">
<h1 data-number="83"><span class="header-section-number">83</span> Implement the Lloyd Algorithm for k-Means Clustering</h1>
<p>Implement the Lloyd algorithm.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>m</em>&nbsp;followed by a set of points&nbsp;<em>Data</em>&nbsp;in&nbsp;<em>m</em>-dimensional space.</p>
<p>Return:&nbsp;A set&nbsp;<em>Centers</em>&nbsp;consisting of&nbsp;<em>k</em>&nbsp;points (centers) resulting from applying the Lloyd algorithm to&nbsp;<em>Data</em>&nbsp;and&nbsp;<em>Centers</em>, where the first&nbsp;<em>k</em>&nbsp;points from&nbsp;<em>Data</em>&nbsp;are selected as the first&nbsp;<em>k</em>&nbsp;centers.</p>
<section id="sample-dataset-83" class="level2" data-number="83.1">
<h2 data-number="83.1" class="anchored" data-anchor-id="sample-dataset-83"><span class="header-section-number">83.1</span> Sample Dataset</h2>
<pre><code>2 2
1.3 1.1
1.3 0.2
0.6 2.8
3.0 3.2
1.2 0.7
1.4 1.6
1.2 1.0
1.2 1.1
0.6 1.5
1.8 2.6
1.2 1.3
1.2 1.0
0.0 1.9</code></pre>
</section>
<section id="sample-output-83" class="level2" data-number="83.2">
<h2 data-number="83.2" class="anchored" data-anchor-id="sample-output-83"><span class="header-section-number">83.2</span> Sample Output</h2>
<pre><code>1.800 2.867
1.060 1.140</code></pre>
</section>
<section id="solution-83" class="level2" data-number="83.3">
<h2 data-number="83.3" class="anchored" data-anchor-id="solution-83"><span class="header-section-number">83.3</span> Solution</h2>
<div class="sourceCode" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, TypeVar, Any</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: io.StringIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: np.ndarray, point_b: np.ndarray) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((x <span class="op">-</span> y) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb251-15"><a href="#cb251-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-16"><a href="#cb251-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_center_assignment(data_point: np.ndarray, center_points: List[np.ndarray]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb251-17"><a href="#cb251-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Center index that minimises Euclidean distance to point"""</span></span>
<span id="cb251-18"><a href="#cb251-18" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [euclidean_distance(data_point, center) <span class="cf">for</span> center <span class="kw">in</span> center_points]</span>
<span id="cb251-19"><a href="#cb251-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances.index(<span class="bu">min</span>(distances))</span>
<span id="cb251-20"><a href="#cb251-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-21"><a href="#cb251-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_center(data_points: List[np.ndarray], assignments: List[<span class="bu">int</span>], center_index: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb251-22"><a href="#cb251-22" aria-hidden="true" tabindex="-1"></a>    cluster_points <span class="op">=</span> [p <span class="cf">for</span> p, a <span class="kw">in</span> <span class="bu">zip</span>(data_points, assignments) <span class="cf">if</span> a <span class="op">==</span> center_index]</span>
<span id="cb251-23"><a href="#cb251-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(np.array(cluster_points), axis<span class="op">=</span><span class="dv">0</span>) <span class="cf">if</span> cluster_points <span class="cf">else</span> np.zeros_like(data_points[<span class="dv">0</span>])</span>
<span id="cb251-24"><a href="#cb251-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-25"><a href="#cb251-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> k_means(data_points: List[np.ndarray], num_clusters: <span class="bu">int</span>, max_iterations: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>) <span class="op">-&gt;</span> List[np.ndarray]:</span>
<span id="cb251-26"><a href="#cb251-26" aria-hidden="true" tabindex="-1"></a>    center_points <span class="op">=</span> data_points[:num_clusters]</span>
<span id="cb251-27"><a href="#cb251-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iterations):</span>
<span id="cb251-28"><a href="#cb251-28" aria-hidden="true" tabindex="-1"></a>        assignments <span class="op">=</span> [nearest_center_assignment(point, center_points) <span class="cf">for</span> point <span class="kw">in</span> data_points]</span>
<span id="cb251-29"><a href="#cb251-29" aria-hidden="true" tabindex="-1"></a>        center_points <span class="op">=</span> [compute_center(data_points, assignments, i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_clusters)]</span>
<span id="cb251-30"><a href="#cb251-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> center_points</span>
<span id="cb251-31"><a href="#cb251-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-32"><a href="#cb251-32" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb251-33"><a href="#cb251-33" aria-hidden="true" tabindex="-1"></a><span class="st">2 2</span></span>
<span id="cb251-34"><a href="#cb251-34" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 1.1</span></span>
<span id="cb251-35"><a href="#cb251-35" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 0.2</span></span>
<span id="cb251-36"><a href="#cb251-36" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 2.8</span></span>
<span id="cb251-37"><a href="#cb251-37" aria-hidden="true" tabindex="-1"></a><span class="st">3.0 3.2</span></span>
<span id="cb251-38"><a href="#cb251-38" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 0.7</span></span>
<span id="cb251-39"><a href="#cb251-39" aria-hidden="true" tabindex="-1"></a><span class="st">1.4 1.6</span></span>
<span id="cb251-40"><a href="#cb251-40" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb251-41"><a href="#cb251-41" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.1</span></span>
<span id="cb251-42"><a href="#cb251-42" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 1.5</span></span>
<span id="cb251-43"><a href="#cb251-43" aria-hidden="true" tabindex="-1"></a><span class="st">1.8 2.6</span></span>
<span id="cb251-44"><a href="#cb251-44" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.3</span></span>
<span id="cb251-45"><a href="#cb251-45" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb251-46"><a href="#cb251-46" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 1.9</span></span>
<span id="cb251-47"><a href="#cb251-47" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb251-48"><a href="#cb251-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-49"><a href="#cb251-49" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb251-50"><a href="#cb251-50" aria-hidden="true" tabindex="-1"></a>num_clusters, dimensions <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb251-51"><a href="#cb251-51" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [np.array(point) <span class="cf">for</span> point <span class="kw">in</span> read_types(file_handle, <span class="bu">float</span>)]</span>
<span id="cb251-52"><a href="#cb251-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center <span class="kw">in</span> k_means(data_points, num_clusters):</span>
<span id="cb251-53"><a href="#cb251-53" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>[<span class="ss">f"</span><span class="sc">{</span>coord<span class="sc">:f}</span><span class="ss">"</span> <span class="cf">for</span> coord <span class="kw">in</span> center])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-soft-k-means-clustering-algorithm" class="level1" data-number="84">
<h1 data-number="84"><span class="header-section-number">84</span> Implement the Soft k-Means Clustering Algorithm</h1>
<p>Implement the Soft k-Means Clustering Algorithm.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>m</em>, followed by a stiffness parameter β, followed by a set of points&nbsp;<em>Data</em>&nbsp;in&nbsp;<em>m</em>-dimensional space.</p>
<p>Return:&nbsp;A set&nbsp;<em>Centers</em>&nbsp;consisting of&nbsp;<em>k</em>&nbsp;points (centers) resulting from applying the soft&nbsp;<em>k</em>-means clustering algorithm. Select the first&nbsp;<em>k</em>&nbsp;points from&nbsp;<em>Data</em>&nbsp;as the first centers for the algorithm and run the algorithm for 100 steps. Results should be accurate up to three decimal places.</p>
<section id="sample-dataset-84" class="level2" data-number="84.1">
<h2 data-number="84.1" class="anchored" data-anchor-id="sample-dataset-84"><span class="header-section-number">84.1</span> Sample Dataset</h2>
<pre><code>2 2
2.7
1.3 1.1
1.3 0.2
0.6 2.8
3.0 3.2
1.2 0.7
1.4 1.6
1.2 1.0
1.2 1.1
0.6 1.5
1.8 2.6
1.2 1.3
1.2 1.0
0.0 1.9</code></pre>
</section>
<section id="sample-output-84" class="level2" data-number="84.2">
<h2 data-number="84.2" class="anchored" data-anchor-id="sample-output-84"><span class="header-section-number">84.2</span> Sample Output</h2>
<pre><code>1.662 2.623
1.075 1.148</code></pre>
</section>
<section id="solution-84" class="level2" data-number="84.3">
<h2 data-number="84.3" class="anchored" data-anchor-id="solution-84"><span class="header-section-number">84.3</span> Solution</h2>
<div class="sourceCode" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, TypeVar, Any</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: io.StringIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: np.ndarray, point_b: np.ndarray) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((x <span class="op">-</span> y) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partition_function(data_point: np.ndarray, center_points: np.ndarray, beta: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a>    numerator <span class="op">=</span> [np.exp(<span class="op">-</span>beta <span class="op">*</span> euclidean_distance(data_point, center)) <span class="cf">for</span> center <span class="kw">in</span> center_points]</span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(numerator) <span class="op">/</span> <span class="bu">sum</span>(numerator)</span>
<span id="cb254-19"><a href="#cb254-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-20"><a href="#cb254-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hidden_matrix(data_points: np.ndarray, center_points: np.ndarray, beta: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb254-21"><a href="#cb254-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([partition_function(x, center_points, beta) <span class="cf">for</span> x <span class="kw">in</span> data_points])</span>
<span id="cb254-22"><a href="#cb254-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-23"><a href="#cb254-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_k_means(data_points: List[np.ndarray], num_clusters: <span class="bu">int</span>, beta: <span class="bu">float</span>, max_iterations: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb254-24"><a href="#cb254-24" aria-hidden="true" tabindex="-1"></a>    center_points <span class="op">=</span> np.array(data_points[:num_clusters])</span>
<span id="cb254-25"><a href="#cb254-25" aria-hidden="true" tabindex="-1"></a>    data_points <span class="op">=</span> np.array(data_points)</span>
<span id="cb254-26"><a href="#cb254-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iterations):</span>
<span id="cb254-27"><a href="#cb254-27" aria-hidden="true" tabindex="-1"></a>        h_matrix <span class="op">=</span> hidden_matrix(data_points, center_points, beta)</span>
<span id="cb254-28"><a href="#cb254-28" aria-hidden="true" tabindex="-1"></a>        center_points <span class="op">=</span> [np.dot(h_matrix[:, i], data_points) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_clusters)]</span>
<span id="cb254-29"><a href="#cb254-29" aria-hidden="true" tabindex="-1"></a>        sums <span class="op">=</span> np.<span class="bu">sum</span>(h_matrix, <span class="dv">0</span>)</span>
<span id="cb254-30"><a href="#cb254-30" aria-hidden="true" tabindex="-1"></a>        center_points <span class="op">=</span> np.transpose(np.transpose(center_points) <span class="op">/</span> sums)</span>
<span id="cb254-31"><a href="#cb254-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> center_points</span>
<span id="cb254-32"><a href="#cb254-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-33"><a href="#cb254-33" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb254-34"><a href="#cb254-34" aria-hidden="true" tabindex="-1"></a><span class="st">2 2</span></span>
<span id="cb254-35"><a href="#cb254-35" aria-hidden="true" tabindex="-1"></a><span class="st">2.7</span></span>
<span id="cb254-36"><a href="#cb254-36" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 1.1</span></span>
<span id="cb254-37"><a href="#cb254-37" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 0.2</span></span>
<span id="cb254-38"><a href="#cb254-38" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 2.8</span></span>
<span id="cb254-39"><a href="#cb254-39" aria-hidden="true" tabindex="-1"></a><span class="st">3.0 3.2</span></span>
<span id="cb254-40"><a href="#cb254-40" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 0.7</span></span>
<span id="cb254-41"><a href="#cb254-41" aria-hidden="true" tabindex="-1"></a><span class="st">1.4 1.6</span></span>
<span id="cb254-42"><a href="#cb254-42" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb254-43"><a href="#cb254-43" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.1</span></span>
<span id="cb254-44"><a href="#cb254-44" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 1.5</span></span>
<span id="cb254-45"><a href="#cb254-45" aria-hidden="true" tabindex="-1"></a><span class="st">1.8 2.6</span></span>
<span id="cb254-46"><a href="#cb254-46" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.3</span></span>
<span id="cb254-47"><a href="#cb254-47" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb254-48"><a href="#cb254-48" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 1.9</span></span>
<span id="cb254-49"><a href="#cb254-49" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb254-50"><a href="#cb254-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-51"><a href="#cb254-51" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb254-52"><a href="#cb254-52" aria-hidden="true" tabindex="-1"></a>num_clusters, dimensions <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb254-53"><a href="#cb254-53" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">float</span>))[<span class="dv">0</span>]</span>
<span id="cb254-54"><a href="#cb254-54" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [np.array(point) <span class="cf">for</span> point <span class="kw">in</span> read_types(file_handle, <span class="bu">float</span>)]</span>
<span id="cb254-55"><a href="#cb254-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center <span class="kw">in</span> soft_k_means(data_points, num_clusters, beta):</span>
<span id="cb254-56"><a href="#cb254-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>[<span class="ss">f"</span><span class="sc">{</span>coord<span class="sc">:f}</span><span class="ss">"</span> <span class="cf">for</span> coord <span class="kw">in</span> center])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-hierarchical-clustering" class="level1" data-number="85">
<h1 data-number="85"><span class="header-section-number">85</span> Implement Hierarchical Clustering</h1>
<p>Implement Hierarchical Clustering.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>, followed by an&nbsp;<em>n_x_n</em>&nbsp;distance matrix.</p>
<p>Return:&nbsp;The result of applying&nbsp;<strong>HierarchicalClustering</strong>&nbsp;to this distance matrix (using&nbsp;<em>D</em>avg), with each newly created cluster listed on each line.</p>
<section id="sample-dataset-85" class="level2" data-number="85.1">
<h2 data-number="85.1" class="anchored" data-anchor-id="sample-dataset-85"><span class="header-section-number">85.1</span> Sample Dataset</h2>
<pre><code>7
0.00 0.74 0.85 0.54 0.83 0.92 0.89
0.74 0.00 1.59 1.35 1.20 1.48 1.55
0.85 1.59 0.00 0.63 1.13 0.69 0.73
0.54 1.35 0.63 0.00 0.66 0.43 0.88
0.83 1.20 1.13 0.66 0.00 0.72 0.55
0.92 1.48 0.69 0.43 0.72 0.00 0.80
0.89 1.55 0.73 0.88 0.55 0.80 0.00</code></pre>
</section>
<section id="sample-output-85" class="level2" data-number="85.2">
<h2 data-number="85.2" class="anchored" data-anchor-id="sample-output-85"><span class="header-section-number">85.2</span> Sample Output</h2>
<pre><code>4 6
5 7
3 4 6
1 2
5 7 3 4 6
1 2 5 7 3 4 6</code></pre>
</section>
<section id="solution-85" class="level2" data-number="85.3">
<h2 data-number="85.3" class="anchored" data-anchor-id="solution-85"><span class="header-section-number">85.3</span> Solution</h2>
<div class="sourceCode" id="cb257"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Generator</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a><span class="co"># find (first) minimum off diagonal index in an array</span></span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_closest_pair(distance_matrix: np.ndarray) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(temp_matrix, temp_matrix.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">divmod</span>(temp_matrix.argmin(), temp_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-12"><a href="#cb257-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> average_distances(distance_matrix: np.ndarray, i: <span class="bu">int</span>, j: <span class="bu">int</span>, size_i: <span class="bu">int</span>, size_j: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb257-13"><a href="#cb257-13" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb257-14"><a href="#cb257-14" aria-hidden="true" tabindex="-1"></a>    average <span class="op">=</span> (temp_matrix[i, :] <span class="op">*</span> size_i <span class="op">+</span> temp_matrix[j, :] <span class="op">*</span> size_j) <span class="op">/</span> (size_i <span class="op">+</span> size_j)</span>
<span id="cb257-15"><a href="#cb257-15" aria-hidden="true" tabindex="-1"></a>    temp_matrix[i, :] <span class="op">=</span> average</span>
<span id="cb257-16"><a href="#cb257-16" aria-hidden="true" tabindex="-1"></a>    temp_matrix[:, i] <span class="op">=</span> average</span>
<span id="cb257-17"><a href="#cb257-17" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.delete(temp_matrix, j, <span class="dv">0</span>)</span>
<span id="cb257-18"><a href="#cb257-18" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.delete(temp_matrix, j, <span class="dv">1</span>)</span>
<span id="cb257-19"><a href="#cb257-19" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(temp_matrix, <span class="dv">0</span>)</span>
<span id="cb257-20"><a href="#cb257-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> temp_matrix</span>
<span id="cb257-21"><a href="#cb257-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-22"><a href="#cb257-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_descendants(tree: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb257-23"><a href="#cb257-23" aria-hidden="true" tabindex="-1"></a>    queue <span class="op">=</span> [node]</span>
<span id="cb257-24"><a href="#cb257-24" aria-hidden="true" tabindex="-1"></a>    descendants <span class="op">=</span> []</span>
<span id="cb257-25"><a href="#cb257-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb257-26"><a href="#cb257-26" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb257-27"><a href="#cb257-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_node <span class="kw">in</span> tree:</span>
<span id="cb257-28"><a href="#cb257-28" aria-hidden="true" tabindex="-1"></a>            queue.extend(tree[current_node])</span>
<span id="cb257-29"><a href="#cb257-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb257-30"><a href="#cb257-30" aria-hidden="true" tabindex="-1"></a>            descendants.append(current_node)</span>
<span id="cb257-31"><a href="#cb257-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> descendants</span>
<span id="cb257-32"><a href="#cb257-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-33"><a href="#cb257-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hierarchical_clustering(distance_matrix: np.ndarray, num_elements: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[List[<span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb257-34"><a href="#cb257-34" aria-hidden="true" tabindex="-1"></a>    clusters <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, num_elements <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb257-35"><a href="#cb257-35" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb257-36"><a href="#cb257-36" aria-hidden="true" tabindex="-1"></a>    cluster_size <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="dv">1</span>)  <span class="co"># the number of descendants of a node</span></span>
<span id="cb257-37"><a href="#cb257-37" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> num_elements</span>
<span id="cb257-38"><a href="#cb257-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(clusters) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb257-39"><a href="#cb257-39" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb257-40"><a href="#cb257-40" aria-hidden="true" tabindex="-1"></a>        i, j <span class="op">=</span> find_closest_pair(distance_matrix)</span>
<span id="cb257-41"><a href="#cb257-41" aria-hidden="true" tabindex="-1"></a>        cluster_a, cluster_b <span class="op">=</span> clusters[i], clusters[j]</span>
<span id="cb257-42"><a href="#cb257-42" aria-hidden="true" tabindex="-1"></a>        tree[next_node] <span class="op">=</span> [cluster_a, cluster_b]</span>
<span id="cb257-43"><a href="#cb257-43" aria-hidden="true" tabindex="-1"></a>        cluster_size[next_node] <span class="op">=</span> cluster_size[cluster_a] <span class="op">+</span> cluster_size[cluster_b]</span>
<span id="cb257-44"><a href="#cb257-44" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> average_distances(distance_matrix, <span class="op">*</span>find_closest_pair(distance_matrix), cluster_size[cluster_a], cluster_size[cluster_b])</span>
<span id="cb257-45"><a href="#cb257-45" aria-hidden="true" tabindex="-1"></a>        clusters[i] <span class="op">=</span> next_node</span>
<span id="cb257-46"><a href="#cb257-46" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> clusters[j]</span>
<span id="cb257-47"><a href="#cb257-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> get_descendants(tree, cluster_a) <span class="op">+</span> get_descendants(tree, cluster_b)</span>
<span id="cb257-48"><a href="#cb257-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-49"><a href="#cb257-49" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb257-50"><a href="#cb257-50" aria-hidden="true" tabindex="-1"></a><span class="st">7</span></span>
<span id="cb257-51"><a href="#cb257-51" aria-hidden="true" tabindex="-1"></a><span class="st">0.00 0.74 0.85 0.54 0.83 0.92 0.89</span></span>
<span id="cb257-52"><a href="#cb257-52" aria-hidden="true" tabindex="-1"></a><span class="st">0.74 0.00 1.59 1.35 1.20 1.48 1.55</span></span>
<span id="cb257-53"><a href="#cb257-53" aria-hidden="true" tabindex="-1"></a><span class="st">0.85 1.59 0.00 0.63 1.13 0.69 0.73</span></span>
<span id="cb257-54"><a href="#cb257-54" aria-hidden="true" tabindex="-1"></a><span class="st">0.54 1.35 0.63 0.00 0.66 0.43 0.88</span></span>
<span id="cb257-55"><a href="#cb257-55" aria-hidden="true" tabindex="-1"></a><span class="st">0.83 1.20 1.13 0.66 0.00 0.72 0.55</span></span>
<span id="cb257-56"><a href="#cb257-56" aria-hidden="true" tabindex="-1"></a><span class="st">0.92 1.48 0.69 0.43 0.72 0.00 0.80</span></span>
<span id="cb257-57"><a href="#cb257-57" aria-hidden="true" tabindex="-1"></a><span class="st">0.89 1.55 0.73 0.88 0.55 0.80 0.00</span></span>
<span id="cb257-58"><a href="#cb257-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb257-59"><a href="#cb257-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-60"><a href="#cb257-60" aria-hidden="true" tabindex="-1"></a>num_elements, <span class="op">*</span>distance_data <span class="op">=</span> io.StringIO(sample_input.strip()).read().splitlines()</span>
<span id="cb257-61"><a href="#cb257-61" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> np.array([<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> distance_data])</span>
<span id="cb257-62"><a href="#cb257-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> step <span class="kw">in</span> hierarchical_clustering(distance_matrix, <span class="bu">int</span>(num_elements)):</span>
<span id="cb257-63"><a href="#cb257-63" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>step)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-trie-from-a-collection-of-patterns" class="level1" data-number="86">
<h1 data-number="86"><span class="header-section-number">86</span> Construct a Trie from a Collection of Patterns</h1>
<p>Trie Construction Problem. Construct a trie on a collection of patterns.</p>
<p>Given:&nbsp;A collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;The&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>&nbsp;corresponding to&nbsp;<em>Trie</em>(<em>Patterns</em>), in the following format. If&nbsp;<em>Trie</em>(<em>Patterns</em>) has&nbsp;<em>n</em>&nbsp;nodes, first label the root with 1 and then label the remaining nodes with the integers 2 through&nbsp;<em>n</em>&nbsp;in any order you like. Each edge of the adjacency list of&nbsp;<em>Trie</em>(<em>Patterns</em>) will be encoded by a triple: the first two members of the triple must be the integers labeling the initial and terminal nodes of the edge, respectively; the third member of the triple must be the symbol labeling the edge.</p>
<section id="sample-dataset-86" class="level2" data-number="86.1">
<h2 data-number="86.1" class="anchored" data-anchor-id="sample-dataset-86"><span class="header-section-number">86.1</span> Sample Dataset</h2>
<pre><code>ATAGA
ATC
GAT</code></pre>
</section>
<section id="sample-output-86" class="level2" data-number="86.2">
<h2 data-number="86.2" class="anchored" data-anchor-id="sample-output-86"><span class="header-section-number">86.2</span> Sample Output</h2>
<pre><code>0-&gt;1:A
1-&gt;2:T
2-&gt;3:A
3-&gt;4:G
4-&gt;5:A
2-&gt;6:C
0-&gt;7:G
7-&gt;8:A
8-&gt;9:T</code></pre>
</section>
<section id="solution-86" class="level2" data-number="86.3">
<h2 data-number="86.3" class="anchored" data-anchor-id="solution-86"><span class="header-section-number">86.3</span> Solution</h2>
<div class="sourceCode" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> count</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Any</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Trie:</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.id_generator <span class="op">=</span> count(start<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.root: Tuple[<span class="bu">int</span>, Dict[<span class="bu">str</span>, Any]] <span class="op">=</span> (<span class="bu">next</span>(<span class="va">self</span>.id_generator), {})</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> insert(<span class="va">self</span>, sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> <span class="va">self</span>.root</span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> character <span class="kw">in</span> sequence:</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> character <span class="kw">not</span> <span class="kw">in</span> current_node[<span class="dv">1</span>]:</span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>                current_node[<span class="dv">1</span>][character] <span class="op">=</span> (<span class="bu">next</span>(<span class="va">self</span>.id_generator), {})</span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> current_node[<span class="dv">1</span>][character]</span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_trie(sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a>    trie <span class="op">=</span> Trie()</span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> sequences:</span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a>        trie.insert(sequence)</span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> trie.root</span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_trie(node: Tuple[<span class="bu">int</span>, Dict[<span class="bu">str</span>, Any]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb260-23"><a href="#cb260-23" aria-hidden="true" tabindex="-1"></a>    formatted_output: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb260-24"><a href="#cb260-24" aria-hidden="true" tabindex="-1"></a>    node_id, children <span class="op">=</span> node</span>
<span id="cb260-25"><a href="#cb260-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char, child_node <span class="kw">in</span> children.items():</span>
<span id="cb260-26"><a href="#cb260-26" aria-hidden="true" tabindex="-1"></a>        child_id, _ <span class="op">=</span> child_node</span>
<span id="cb260-27"><a href="#cb260-27" aria-hidden="true" tabindex="-1"></a>        formatted_output.append(<span class="ss">f"</span><span class="sc">{</span>node_id<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>child_id<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>char<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb260-28"><a href="#cb260-28" aria-hidden="true" tabindex="-1"></a>        formatted_output.extend(format_trie(child_node))</span>
<span id="cb260-29"><a href="#cb260-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> formatted_output</span>
<span id="cb260-30"><a href="#cb260-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-31"><a href="#cb260-31" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb260-32"><a href="#cb260-32" aria-hidden="true" tabindex="-1"></a><span class="st">ATAGA</span></span>
<span id="cb260-33"><a href="#cb260-33" aria-hidden="true" tabindex="-1"></a><span class="st">ATC</span></span>
<span id="cb260-34"><a href="#cb260-34" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb260-35"><a href="#cb260-35" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb260-36"><a href="#cb260-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-37"><a href="#cb260-37" aria-hidden="true" tabindex="-1"></a>sequences: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb260-38"><a href="#cb260-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-39"><a href="#cb260-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> format_trie(build_trie(sequences)):</span>
<span id="cb260-40"><a href="#cb260-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-triematching" class="level1" data-number="87">
<h1 data-number="87"><span class="header-section-number">87</span> Implement TrieMatching</h1>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;and a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Text</em>&nbsp;where a string from&nbsp;<em>Patterns</em>&nbsp;appears as a substring.</p>
<section id="sample-dataset-87" class="level2" data-number="87.1">
<h2 data-number="87.1" class="anchored" data-anchor-id="sample-dataset-87"><span class="header-section-number">87.1</span> Sample Dataset</h2>
<pre><code>AATCGGGTTCAATCGGGGT
ATCG
GGGT</code></pre>
</section>
<section id="sample-output-87" class="level2" data-number="87.2">
<h2 data-number="87.2" class="anchored" data-anchor-id="sample-output-87"><span class="header-section-number">87.2</span> Sample Output</h2>
<pre><code>1 4 11 15</code></pre>
</section>
<section id="solution-87" class="level2" data-number="87.3">
<h2 data-number="87.3" class="anchored" data-anchor-id="solution-87"><span class="header-section-number">87.3</span> Solution</h2>
<div class="sourceCode" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, DefaultDict, Set</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="st">AATCGGGTTCAATCGGGGT</span></span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="st">ATCG</span></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="st">GGGT</span></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a>sequences: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a>main_sequence: <span class="bu">str</span> <span class="op">=</span> sequences[<span class="dv">0</span>]</span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sequences[<span class="dv">1</span>:]</span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-14"><a href="#cb263-14" aria-hidden="true" tabindex="-1"></a>kmer_positions: DefaultDict[<span class="bu">str</span>, Set[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">set</span>)</span>
<span id="cb263-15"><a href="#cb263-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-16"><a href="#cb263-16" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(kmers[<span class="dv">0</span>])</span>
<span id="cb263-17"><a href="#cb263-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-18"><a href="#cb263-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(main_sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb263-19"><a href="#cb263-19" aria-hidden="true" tabindex="-1"></a>    current_kmer: <span class="bu">str</span> <span class="op">=</span> main_sequence[start_index:start_index <span class="op">+</span> kmer_length]</span>
<span id="cb263-20"><a href="#cb263-20" aria-hidden="true" tabindex="-1"></a>    kmer_positions[current_kmer].add(start_index)</span>
<span id="cb263-21"><a href="#cb263-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-22"><a href="#cb263-22" aria-hidden="true" tabindex="-1"></a>all_positions: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb263-23"><a href="#cb263-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb263-24"><a href="#cb263-24" aria-hidden="true" tabindex="-1"></a>    all_positions.update(kmer_positions[kmer])</span>
<span id="cb263-25"><a href="#cb263-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-26"><a href="#cb263-26" aria-hidden="true" tabindex="-1"></a>sorted_positions: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(all_positions)</span>
<span id="cb263-27"><a href="#cb263-27" aria-hidden="true" tabindex="-1"></a>output: <span class="bu">str</span> <span class="op">=</span> <span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, sorted_positions))</span>
<span id="cb263-28"><a href="#cb263-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-29"><a href="#cb263-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-suffix-tree-of-a-string" class="level1" data-number="88">
<h1 data-number="88"><span class="header-section-number">88</span> Construct the Suffix Tree of a String</h1>
<p>Suffix Tree Construction Problem. Construct the suffix tree of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;The strings labeling the edges of&nbsp;<em>SuffixTree</em>(<em>Text</em>). (You may return these strings in any order.)</p>
<section id="sample-dataset-88" class="level2" data-number="88.1">
<h2 data-number="88.1" class="anchored" data-anchor-id="sample-dataset-88"><span class="header-section-number">88.1</span> Sample Dataset</h2>
<pre><code>ATAAATG$</code></pre>
</section>
<section id="sample-output-88" class="level2" data-number="88.2">
<h2 data-number="88.2" class="anchored" data-anchor-id="sample-output-88"><span class="header-section-number">88.2</span> Sample Output</h2>
<pre><code>AAATG$
G$
T
ATG$
TG$
A
A
AAATG$
G$
T
G$
$</code></pre>
</section>
<section id="solution-88" class="level2" data-number="88.3">
<h2 data-number="88.3" class="anchored" data-anchor-id="solution-88"><span class="header-section-number">88.3</span> Solution</h2>
<div class="sourceCode" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Optional</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Tree:</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Node:</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.label: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.edges: List[<span class="st">'Tree.Edge'</span>] <span class="op">=</span> []</span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.indicator: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.depth: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Edge:</span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.from_node: Optional[<span class="st">'Tree.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.target_node: Optional[<span class="st">'Tree.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.position: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.length: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes: List[Tree.Node] <span class="op">=</span> []</span>
<span id="cb266-20"><a href="#cb266-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges: List[Tree.Edge] <span class="op">=</span> []</span>
<span id="cb266-21"><a href="#cb266-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.root: Tree.Node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb266-22"><a href="#cb266-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-23"><a href="#cb266-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb266-24"><a href="#cb266-24" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Tree.Node()</span>
<span id="cb266-25"><a href="#cb266-25" aria-hidden="true" tabindex="-1"></a>        new_node.label <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.all_nodes)</span>
<span id="cb266-26"><a href="#cb266-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes.append(new_node)</span>
<span id="cb266-27"><a href="#cb266-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb266-28"><a href="#cb266-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-29"><a href="#cb266-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(<span class="va">self</span>, from_node: Node, target_node: Node, pos: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Edge:</span>
<span id="cb266-30"><a href="#cb266-30" aria-hidden="true" tabindex="-1"></a>        new_edge <span class="op">=</span> Tree.Edge()</span>
<span id="cb266-31"><a href="#cb266-31" aria-hidden="true" tabindex="-1"></a>        new_edge.from_node <span class="op">=</span> from_node</span>
<span id="cb266-32"><a href="#cb266-32" aria-hidden="true" tabindex="-1"></a>        new_edge.target_node <span class="op">=</span> target_node</span>
<span id="cb266-33"><a href="#cb266-33" aria-hidden="true" tabindex="-1"></a>        new_edge.position <span class="op">=</span> pos</span>
<span id="cb266-34"><a href="#cb266-34" aria-hidden="true" tabindex="-1"></a>        new_edge.length <span class="op">=</span> length</span>
<span id="cb266-35"><a href="#cb266-35" aria-hidden="true" tabindex="-1"></a>        target_node.depth <span class="op">=</span> from_node.depth <span class="op">+</span> length</span>
<span id="cb266-36"><a href="#cb266-36" aria-hidden="true" tabindex="-1"></a>        from_node.edges.append(new_edge)</span>
<span id="cb266-37"><a href="#cb266-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges.append(new_edge)</span>
<span id="cb266-38"><a href="#cb266-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_edge</span>
<span id="cb266-39"><a href="#cb266-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-40"><a href="#cb266-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> edge_labels(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb266-41"><a href="#cb266-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [text[edge.position : edge.position <span class="op">+</span> edge.length] <span class="cf">for</span> edge <span class="kw">in</span> <span class="va">self</span>.all_edges]</span>
<span id="cb266-42"><a href="#cb266-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-43"><a href="#cb266-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> return_ripe_nodes(<span class="va">self</span>) <span class="op">-&gt;</span> List[Node]:</span>
<span id="cb266-44"><a href="#cb266-44" aria-hidden="true" tabindex="-1"></a>        ripe_nodes <span class="op">=</span> []</span>
<span id="cb266-45"><a href="#cb266-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.all_nodes:</span>
<span id="cb266-46"><a href="#cb266-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> node.indicator <span class="kw">is</span> <span class="va">None</span> <span class="kw">and</span> <span class="bu">all</span>(edge.target_node.indicator <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">for</span> edge <span class="kw">in</span> node.edges):</span>
<span id="cb266-47"><a href="#cb266-47" aria-hidden="true" tabindex="-1"></a>                ripe_nodes.append(node)</span>
<span id="cb266-48"><a href="#cb266-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ripe_nodes</span>
<span id="cb266-49"><a href="#cb266-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-50"><a href="#cb266-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_indicators(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-51"><a href="#cb266-51" aria-hidden="true" tabindex="-1"></a>        ripe_nodes <span class="op">=</span> <span class="va">self</span>.return_ripe_nodes()</span>
<span id="cb266-52"><a href="#cb266-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> ripe_nodes:</span>
<span id="cb266-53"><a href="#cb266-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> node <span class="kw">in</span> ripe_nodes:</span>
<span id="cb266-54"><a href="#cb266-54" aria-hidden="true" tabindex="-1"></a>                children_indicators <span class="op">=</span> <span class="bu">set</span>(edge.target_node.indicator <span class="cf">for</span> edge <span class="kw">in</span> node.edges)</span>
<span id="cb266-55"><a href="#cb266-55" aria-hidden="true" tabindex="-1"></a>                node.indicator <span class="op">=</span> <span class="st">'*'</span> <span class="cf">if</span> <span class="bu">len</span>(children_indicators) <span class="op">!=</span> <span class="dv">1</span> <span class="cf">else</span> <span class="bu">next</span>(<span class="bu">iter</span>(children_indicators))</span>
<span id="cb266-56"><a href="#cb266-56" aria-hidden="true" tabindex="-1"></a>            ripe_nodes <span class="op">=</span> <span class="va">self</span>.return_ripe_nodes()</span>
<span id="cb266-57"><a href="#cb266-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-58"><a href="#cb266-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_suffix_tree(<span class="va">self</span>, trie_node: <span class="st">'Trie.Node'</span>, tree_node: Node, path: List[<span class="st">'Trie.Edge'</span>] <span class="op">=</span> []) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-59"><a href="#cb266-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="bu">len</span>(trie_node.edges) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb266-60"><a href="#cb266-60" aria-hidden="true" tabindex="-1"></a>            trie_edge <span class="op">=</span> trie_node.edges[<span class="dv">0</span>]</span>
<span id="cb266-61"><a href="#cb266-61" aria-hidden="true" tabindex="-1"></a>            path.append(trie_edge)</span>
<span id="cb266-62"><a href="#cb266-62" aria-hidden="true" tabindex="-1"></a>            trie_node <span class="op">=</span> trie_edge.target_node</span>
<span id="cb266-63"><a href="#cb266-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-64"><a href="#cb266-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path:</span>
<span id="cb266-65"><a href="#cb266-65" aria-hidden="true" tabindex="-1"></a>            new_tree_node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb266-66"><a href="#cb266-66" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.add_edge(tree_node, new_tree_node, path[<span class="dv">0</span>].position, <span class="bu">len</span>(path))</span>
<span id="cb266-67"><a href="#cb266-67" aria-hidden="true" tabindex="-1"></a>            tree_node <span class="op">=</span> new_tree_node</span>
<span id="cb266-68"><a href="#cb266-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-69"><a href="#cb266-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> trie_node.edges:</span>
<span id="cb266-70"><a href="#cb266-70" aria-hidden="true" tabindex="-1"></a>            tree_node.indicator <span class="op">=</span> trie_node.indicator</span>
<span id="cb266-71"><a href="#cb266-71" aria-hidden="true" tabindex="-1"></a>            tree_node.label <span class="op">=</span> trie_node.label</span>
<span id="cb266-72"><a href="#cb266-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb266-73"><a href="#cb266-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-74"><a href="#cb266-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trie_edge <span class="kw">in</span> trie_node.edges:</span>
<span id="cb266-75"><a href="#cb266-75" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.construct_suffix_tree(trie_edge.target_node, tree_node, [trie_edge])</span>
<span id="cb266-76"><a href="#cb266-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-77"><a href="#cb266-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> populate_suffix_tree(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-78"><a href="#cb266-78" aria-hidden="true" tabindex="-1"></a>        suffix_trie <span class="op">=</span> Trie()</span>
<span id="cb266-79"><a href="#cb266-79" aria-hidden="true" tabindex="-1"></a>        suffix_trie.construct_suffix_trie(text)</span>
<span id="cb266-80"><a href="#cb266-80" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.construct_suffix_tree(suffix_trie.root, <span class="va">self</span>.root)</span>
<span id="cb266-81"><a href="#cb266-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-82"><a href="#cb266-82" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Trie:</span>
<span id="cb266-83"><a href="#cb266-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Node:</span>
<span id="cb266-84"><a href="#cb266-84" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-85"><a href="#cb266-85" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.label: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-86"><a href="#cb266-86" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.edges: List[<span class="st">'Trie.Edge'</span>] <span class="op">=</span> []</span>
<span id="cb266-87"><a href="#cb266-87" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.indicator: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-88"><a href="#cb266-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-89"><a href="#cb266-89" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Edge:</span>
<span id="cb266-90"><a href="#cb266-90" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-91"><a href="#cb266-91" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.from_node: Optional[<span class="st">'Trie.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-92"><a href="#cb266-92" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.target_node: Optional[<span class="st">'Trie.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-93"><a href="#cb266-93" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.label: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-94"><a href="#cb266-94" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.position: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-95"><a href="#cb266-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-96"><a href="#cb266-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-97"><a href="#cb266-97" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes: List[Trie.Node] <span class="op">=</span> []</span>
<span id="cb266-98"><a href="#cb266-98" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges: List[Trie.Edge] <span class="op">=</span> []</span>
<span id="cb266-99"><a href="#cb266-99" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.root: Trie.Node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb266-100"><a href="#cb266-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-101"><a href="#cb266-101" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb266-102"><a href="#cb266-102" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Trie.Node()</span>
<span id="cb266-103"><a href="#cb266-103" aria-hidden="true" tabindex="-1"></a>        new_node.label <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.all_nodes)</span>
<span id="cb266-104"><a href="#cb266-104" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes.append(new_node)</span>
<span id="cb266-105"><a href="#cb266-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb266-106"><a href="#cb266-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-107"><a href="#cb266-107" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(<span class="va">self</span>, from_node: Node, target_node: Node, label: <span class="bu">str</span>, pos: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Edge:</span>
<span id="cb266-108"><a href="#cb266-108" aria-hidden="true" tabindex="-1"></a>        new_edge <span class="op">=</span> Trie.Edge()</span>
<span id="cb266-109"><a href="#cb266-109" aria-hidden="true" tabindex="-1"></a>        new_edge.from_node <span class="op">=</span> from_node</span>
<span id="cb266-110"><a href="#cb266-110" aria-hidden="true" tabindex="-1"></a>        new_edge.target_node <span class="op">=</span> target_node</span>
<span id="cb266-111"><a href="#cb266-111" aria-hidden="true" tabindex="-1"></a>        new_edge.label <span class="op">=</span> label</span>
<span id="cb266-112"><a href="#cb266-112" aria-hidden="true" tabindex="-1"></a>        new_edge.position <span class="op">=</span> pos</span>
<span id="cb266-113"><a href="#cb266-113" aria-hidden="true" tabindex="-1"></a>        from_node.edges.append(new_edge)</span>
<span id="cb266-114"><a href="#cb266-114" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges.append(new_edge)</span>
<span id="cb266-115"><a href="#cb266-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_edge</span>
<span id="cb266-116"><a href="#cb266-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-117"><a href="#cb266-117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_suffix_trie(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-118"><a href="#cb266-118" aria-hidden="true" tabindex="-1"></a>        indicator <span class="op">=</span> <span class="st">'#'</span></span>
<span id="cb266-119"><a href="#cb266-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text)):</span>
<span id="cb266-120"><a href="#cb266-120" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> <span class="va">self</span>.root</span>
<span id="cb266-121"><a href="#cb266-121" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(text)):</span>
<span id="cb266-122"><a href="#cb266-122" aria-hidden="true" tabindex="-1"></a>                current_symbol <span class="op">=</span> text[j]</span>
<span id="cb266-123"><a href="#cb266-123" aria-hidden="true" tabindex="-1"></a>                next_node <span class="op">=</span> <span class="bu">next</span>((edge.target_node <span class="cf">for</span> edge <span class="kw">in</span> current_node.edges <span class="cf">if</span> edge.label <span class="op">==</span> current_symbol), <span class="va">None</span>)</span>
<span id="cb266-124"><a href="#cb266-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> next_node <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb266-125"><a href="#cb266-125" aria-hidden="true" tabindex="-1"></a>                    new_node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb266-126"><a href="#cb266-126" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.add_edge(current_node, new_node, current_symbol, j)</span>
<span id="cb266-127"><a href="#cb266-127" aria-hidden="true" tabindex="-1"></a>                    current_node <span class="op">=</span> new_node</span>
<span id="cb266-128"><a href="#cb266-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb266-129"><a href="#cb266-129" aria-hidden="true" tabindex="-1"></a>                    current_node <span class="op">=</span> next_node</span>
<span id="cb266-130"><a href="#cb266-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> current_node.edges:</span>
<span id="cb266-131"><a href="#cb266-131" aria-hidden="true" tabindex="-1"></a>                current_node.label <span class="op">=</span> <span class="ss">f'L</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb266-132"><a href="#cb266-132" aria-hidden="true" tabindex="-1"></a>                current_node.indicator <span class="op">=</span> indicator</span>
<span id="cb266-133"><a href="#cb266-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> text[i] <span class="op">==</span> <span class="st">'#'</span>:</span>
<span id="cb266-134"><a href="#cb266-134" aria-hidden="true" tabindex="-1"></a>                indicator <span class="op">=</span> <span class="st">'$'</span></span>
<span id="cb266-135"><a href="#cb266-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-136"><a href="#cb266-136" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"ATAAATG$"</span></span>
<span id="cb266-137"><a href="#cb266-137" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb266-138"><a href="#cb266-138" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb266-139"><a href="#cb266-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-140"><a href="#cb266-140" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> Tree()</span>
<span id="cb266-141"><a href="#cb266-141" aria-hidden="true" tabindex="-1"></a>tree.populate_suffix_tree(text)</span>
<span id="cb266-142"><a href="#cb266-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-143"><a href="#cb266-143" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> tree.edge_labels(text)</span>
<span id="cb266-144"><a href="#cb266-144" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-longest-repeat-in-a-string" class="level1" data-number="89">
<h1 data-number="89"><span class="header-section-number">89</span> Find the Longest Repeat in a String</h1>
<p>Longest Repeat Problem, Find the longest repeat in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;A longest substring of&nbsp;<em>Text</em>&nbsp;that appears in&nbsp;<em>Text</em>&nbsp;more than once. (Multiple solutions may exist, in which case you may return any one.)</p>
<section id="sample-dataset-89" class="level2" data-number="89.1">
<h2 data-number="89.1" class="anchored" data-anchor-id="sample-dataset-89"><span class="header-section-number">89.1</span> Sample Dataset</h2>
<pre><code>ATATCGTTTTATCGTT</code></pre>
</section>
<section id="sample-output-89" class="level2" data-number="89.2">
<h2 data-number="89.2" class="anchored" data-anchor-id="sample-output-89"><span class="header-section-number">89.2</span> Sample Output</h2>
<pre><code>TATCGTT</code></pre>
</section>
<section id="solution-89" class="level2" data-number="89.3">
<h2 data-number="89.3" class="anchored" data-anchor-id="solution-89"><span class="header-section-number">89.3</span> Solution</h2>
<div class="sourceCode" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cache</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> commonprefix</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Generator, Iterator</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_edges(graph: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key <span class="kw">in</span> graph.keys():</span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> key</span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="cf">from</span> get_edges(graph[key])</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a><span class="at">@cache</span></span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suffix_tree(sequence: <span class="bu">str</span>, start_positions: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">str</span>, Dict] <span class="op">=</span> {}</span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>    unique_bases <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([sequence[start] <span class="cf">for</span> start <span class="kw">in</span> start_positions]))</span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> unique_bases:</span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true" tabindex="-1"></a>        matching_positions <span class="op">=</span> [start <span class="cf">for</span> start <span class="kw">in</span> start_positions <span class="cf">if</span> sequence[start] <span class="op">==</span> base]</span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true" tabindex="-1"></a>        subsequences <span class="op">=</span> [sequence[s:] <span class="cf">for</span> s <span class="kw">in</span> matching_positions]</span>
<span id="cb269-18"><a href="#cb269-18" aria-hidden="true" tabindex="-1"></a>        common_prefix <span class="op">=</span> commonprefix(subsequences)</span>
<span id="cb269-19"><a href="#cb269-19" aria-hidden="true" tabindex="-1"></a>        prefix_length <span class="op">=</span> <span class="bu">len</span>(common_prefix)</span>
<span id="cb269-20"><a href="#cb269-20" aria-hidden="true" tabindex="-1"></a>        new_start_positions <span class="op">=</span> [start <span class="op">+</span> prefix_length <span class="cf">for</span> start <span class="kw">in</span> matching_positions <span class="cf">if</span> start <span class="op">+</span> prefix_length <span class="op">&lt;</span> <span class="bu">len</span>(sequence)]</span>
<span id="cb269-21"><a href="#cb269-21" aria-hidden="true" tabindex="-1"></a>        tree[common_prefix] <span class="op">=</span> suffix_tree(sequence, <span class="bu">tuple</span>(new_start_positions))</span>
<span id="cb269-22"><a href="#cb269-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb269-23"><a href="#cb269-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb269-24"><a href="#cb269-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-25"><a href="#cb269-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_tree(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb269-26"><a href="#cb269-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> suffix_tree(sequence, <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="bu">len</span>(sequence))))</span>
<span id="cb269-27"><a href="#cb269-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-28"><a href="#cb269-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> internal_edges(tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb269-29"><a href="#cb269-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> tree.keys():</span>
<span id="cb269-30"><a href="#cb269-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">len</span>(tree[node]):</span>
<span id="cb269-31"><a href="#cb269-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> <span class="st">""</span></span>
<span id="cb269-32"><a href="#cb269-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child_edge <span class="kw">in</span> internal_edges(tree[node]):</span>
<span id="cb269-33"><a href="#cb269-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> node <span class="op">+</span> child_edge</span>
<span id="cb269-34"><a href="#cb269-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-35"><a href="#cb269-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_shared_substring(tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb269-36"><a href="#cb269-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(internal_edges(tree), key<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">len</span>(x))</span>
<span id="cb269-37"><a href="#cb269-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-38"><a href="#cb269-38" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb269-39"><a href="#cb269-39" aria-hidden="true" tabindex="-1"></a><span class="st">ATATCGTTTTATCGTT</span></span>
<span id="cb269-40"><a href="#cb269-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb269-41"><a href="#cb269-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-42"><a href="#cb269-42" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb269-43"><a href="#cb269-43" aria-hidden="true" tabindex="-1"></a>suffix_tree <span class="op">=</span> create_suffix_tree(sequence)</span>
<span id="cb269-44"><a href="#cb269-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_shared_substring(suffix_tree))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-longest-substring-shared-by-two-strings" class="level1" data-number="90">
<h1 data-number="90"><span class="header-section-number">90</span> Find the Longest Substring Shared by Two Strings</h1>
<p>Longest Shared Substring Problem. Find the longest substring shared by two strings.</p>
<p>Given:&nbsp;Strings&nbsp;_Text_1&nbsp;and&nbsp;_Text_2.</p>
<p>Return:&nbsp;The longest substring that occurs in both&nbsp;_Text_1&nbsp;and&nbsp;_Text_2. (Multiple solutions may exist, in which case you may return any one.)</p>
<section id="sample-dataset-90" class="level2" data-number="90.1">
<h2 data-number="90.1" class="anchored" data-anchor-id="sample-dataset-90"><span class="header-section-number">90.1</span> Sample Dataset</h2>
<pre><code>TCGGTAGATTGCGCCCACTC
AGGGGCTCGCAGTGTAAGAA</code></pre>
</section>
<section id="sample-output-90" class="level2" data-number="90.2">
<h2 data-number="90.2" class="anchored" data-anchor-id="sample-output-90"><span class="header-section-number">90.2</span> Sample Output</h2>
<pre><code>AGA</code></pre>
</section>
<section id="solution-90" class="level2" data-number="90.3">
<h2 data-number="90.3" class="anchored" data-anchor-id="solution-90"><span class="header-section-number">90.3</span> Solution</h2>
<div class="sourceCode" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cache</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> commonprefix</span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple, Generator</span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a><span class="at">@cache</span></span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_suffix_tree(sequence: <span class="bu">str</span>, start_positions: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">str</span>, Dict] <span class="op">=</span> {}</span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a>    unique_bases <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([sequence[start] <span class="cf">for</span> start <span class="kw">in</span> start_positions]))</span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> unique_bases:</span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true" tabindex="-1"></a>        matching_positions <span class="op">=</span> [start <span class="cf">for</span> start <span class="kw">in</span> start_positions <span class="cf">if</span> sequence[start] <span class="op">==</span> base]</span>
<span id="cb272-13"><a href="#cb272-13" aria-hidden="true" tabindex="-1"></a>        subsequences <span class="op">=</span> [sequence[s:] <span class="cf">for</span> s <span class="kw">in</span> matching_positions]</span>
<span id="cb272-14"><a href="#cb272-14" aria-hidden="true" tabindex="-1"></a>        common_prefix <span class="op">=</span> commonprefix(subsequences)</span>
<span id="cb272-15"><a href="#cb272-15" aria-hidden="true" tabindex="-1"></a>        prefix_length <span class="op">=</span> <span class="bu">len</span>(common_prefix)</span>
<span id="cb272-16"><a href="#cb272-16" aria-hidden="true" tabindex="-1"></a>        new_start_positions <span class="op">=</span> [start <span class="op">+</span> prefix_length <span class="cf">for</span> start <span class="kw">in</span> matching_positions <span class="cf">if</span> start <span class="op">+</span> prefix_length <span class="op">&lt;</span> <span class="bu">len</span>(sequence)]</span>
<span id="cb272-17"><a href="#cb272-17" aria-hidden="true" tabindex="-1"></a>        tree[common_prefix] <span class="op">=</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(new_start_positions))</span>
<span id="cb272-18"><a href="#cb272-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb272-19"><a href="#cb272-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-20"><a href="#cb272-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_tree(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb272-21"><a href="#cb272-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="bu">len</span>(sequence))))</span>
<span id="cb272-22"><a href="#cb272-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-23"><a href="#cb272-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_graph(suffix_tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb272-24"><a href="#cb272-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> build_graph_structure(subtree: Dict[<span class="bu">str</span>, Dict], graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], node_id: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb272-25"><a href="#cb272-25" aria-hidden="true" tabindex="-1"></a>        next_node_id <span class="op">=</span> node_id</span>
<span id="cb272-26"><a href="#cb272-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> <span class="bu">sorted</span>(subtree):</span>
<span id="cb272-27"><a href="#cb272-27" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb272-28"><a href="#cb272-28" aria-hidden="true" tabindex="-1"></a>            graph[node_id].append({<span class="st">"n"</span>: next_node_id, <span class="st">"l"</span>: edge})</span>
<span id="cb272-29"><a href="#cb272-29" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">=</span> build_graph_structure(subtree[edge], graph, next_node_id)</span>
<span id="cb272-30"><a href="#cb272-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> next_node_id</span>
<span id="cb272-31"><a href="#cb272-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-32"><a href="#cb272-32" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb272-33"><a href="#cb272-33" aria-hidden="true" tabindex="-1"></a>    build_graph_structure(suffix_tree, graph, <span class="dv">0</span>)</span>
<span id="cb272-34"><a href="#cb272-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb272-35"><a href="#cb272-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-36"><a href="#cb272-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_leaf_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb272-37"><a href="#cb272-37" aria-hidden="true" tabindex="-1"></a>    all_child_nodes <span class="op">=</span> <span class="bu">set</span>(node[<span class="st">"n"</span>] <span class="cf">for</span> nodes <span class="kw">in</span> graph.values() <span class="cf">for</span> node <span class="kw">in</span> nodes)</span>
<span id="cb272-38"><a href="#cb272-38" aria-hidden="true" tabindex="-1"></a>    parent_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb272-39"><a href="#cb272-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_child_nodes <span class="op">-</span> parent_nodes</span>
<span id="cb272-40"><a href="#cb272-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-41"><a href="#cb272-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph_structure(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb272-42"><a href="#cb272-42" aria-hidden="true" tabindex="-1"></a>    reversed_graph: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb272-43"><a href="#cb272-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parent_node, children <span class="kw">in</span> graph.items():</span>
<span id="cb272-44"><a href="#cb272-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> children:</span>
<span id="cb272-45"><a href="#cb272-45" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child[<span class="st">"n"</span>]] <span class="op">=</span> {<span class="st">"n"</span>: parent_node, <span class="st">"l"</span>: child[<span class="st">"l"</span>]}</span>
<span id="cb272-46"><a href="#cb272-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb272-47"><a href="#cb272-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-48"><a href="#cb272-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_purple_edges(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb272-49"><a href="#cb272-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_purple_edges(node: <span class="bu">int</span>, sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb272-50"><a href="#cb272-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> colors[node] <span class="op">==</span> <span class="st">"purple"</span>:</span>
<span id="cb272-51"><a href="#cb272-51" aria-hidden="true" tabindex="-1"></a>            has_purple_child <span class="op">=</span> <span class="bu">any</span>(colors[child[<span class="st">"n"</span>]] <span class="op">==</span> <span class="st">"purple"</span> <span class="cf">for</span> child <span class="kw">in</span> tree[node])</span>
<span id="cb272-52"><a href="#cb272-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> has_purple_child:</span>
<span id="cb272-53"><a href="#cb272-53" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> child <span class="kw">in</span> tree[node]:</span>
<span id="cb272-54"><a href="#cb272-54" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">yield</span> <span class="cf">from</span> _get_purple_edges(child[<span class="st">"n"</span>], sequence <span class="op">+</span> child[<span class="st">"l"</span>])</span>
<span id="cb272-55"><a href="#cb272-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb272-56"><a href="#cb272-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence</span>
<span id="cb272-57"><a href="#cb272-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-58"><a href="#cb272-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="cf">from</span> _get_purple_edges(<span class="dv">0</span>, <span class="st">""</span>)</span>
<span id="cb272-59"><a href="#cb272-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-60"><a href="#cb272-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_leaf_colors(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb272-61"><a href="#cb272-61" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph_structure(tree)</span>
<span id="cb272-62"><a href="#cb272-62" aria-hidden="true" tabindex="-1"></a>    colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="va">None</span>)</span>
<span id="cb272-63"><a href="#cb272-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> find_leaf_nodes(tree):</span>
<span id="cb272-64"><a href="#cb272-64" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> reversed_graph[leaf][<span class="st">"l"</span>]</span>
<span id="cb272-65"><a href="#cb272-65" aria-hidden="true" tabindex="-1"></a>        match <span class="op">=</span> re.search(<span class="vs">r"([$#])"</span>, edge)</span>
<span id="cb272-66"><a href="#cb272-66" aria-hidden="true" tabindex="-1"></a>        colors[leaf] <span class="op">=</span> <span class="st">"red"</span> <span class="cf">if</span> match.group() <span class="op">==</span> <span class="st">"$"</span> <span class="cf">else</span> <span class="st">"blue"</span></span>
<span id="cb272-67"><a href="#cb272-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb272-68"><a href="#cb272-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-69"><a href="#cb272-69" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_tree_nodes(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb272-70"><a href="#cb272-70" aria-hidden="true" tabindex="-1"></a>    nodes_to_process <span class="op">=</span> <span class="bu">list</span>(tree.keys())</span>
<span id="cb272-71"><a href="#cb272-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes_to_process:</span>
<span id="cb272-72"><a href="#cb272-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> nodes_to_process:</span>
<span id="cb272-73"><a href="#cb272-73" aria-hidden="true" tabindex="-1"></a>            child_colors <span class="op">=</span> [colors[child[<span class="st">"n"</span>]] <span class="cf">for</span> child <span class="kw">in</span> tree[node]]</span>
<span id="cb272-74"><a href="#cb272-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(child_colors):</span>
<span id="cb272-75"><a href="#cb272-75" aria-hidden="true" tabindex="-1"></a>                unique_colors <span class="op">=</span> <span class="bu">set</span>(child_colors)</span>
<span id="cb272-76"><a href="#cb272-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> unique_colors <span class="op">==</span> {<span class="st">"red"</span>}:</span>
<span id="cb272-77"><a href="#cb272-77" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb272-78"><a href="#cb272-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> unique_colors <span class="op">==</span> {<span class="st">"blue"</span>}:</span>
<span id="cb272-79"><a href="#cb272-79" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb272-80"><a href="#cb272-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb272-81"><a href="#cb272-81" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"purple"</span></span>
<span id="cb272-82"><a href="#cb272-82" aria-hidden="true" tabindex="-1"></a>                nodes_to_process.remove(node)</span>
<span id="cb272-83"><a href="#cb272-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb272-84"><a href="#cb272-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-85"><a href="#cb272-85" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_longest_shared_substring(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb272-86"><a href="#cb272-86" aria-hidden="true" tabindex="-1"></a>    combined_sequence <span class="op">=</span> seq1 <span class="op">+</span> <span class="st">"$"</span> <span class="op">+</span> seq2 <span class="op">+</span> <span class="st">"#"</span></span>
<span id="cb272-87"><a href="#cb272-87" aria-hidden="true" tabindex="-1"></a>    suffix_tree <span class="op">=</span> create_suffix_tree(combined_sequence)</span>
<span id="cb272-88"><a href="#cb272-88" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> convert_to_graph(suffix_tree)</span>
<span id="cb272-89"><a href="#cb272-89" aria-hidden="true" tabindex="-1"></a>    initial_colors <span class="op">=</span> initialize_leaf_colors(graph)</span>
<span id="cb272-90"><a href="#cb272-90" aria-hidden="true" tabindex="-1"></a>    final_colors <span class="op">=</span> color_tree_nodes(graph, initial_colors)</span>
<span id="cb272-91"><a href="#cb272-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(get_purple_edges(graph, final_colors), key<span class="op">=</span><span class="bu">len</span>)</span>
<span id="cb272-92"><a href="#cb272-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-93"><a href="#cb272-93" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb272-94"><a href="#cb272-94" aria-hidden="true" tabindex="-1"></a><span class="st">TCGGTAGATTGCGCCCACTC</span></span>
<span id="cb272-95"><a href="#cb272-95" aria-hidden="true" tabindex="-1"></a><span class="st">AGGGGCTCGCAGTGTAAGAA</span></span>
<span id="cb272-96"><a href="#cb272-96" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb272-97"><a href="#cb272-97" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb272-98"><a href="#cb272-98" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(find_longest_shared_substring(sequence1, sequence2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-shortest-non-shared-substring-of-two-strings" class="level1" data-number="91">
<h1 data-number="91"><span class="header-section-number">91</span> Find the Shortest Non-Shared Substring of Two Strings</h1>
<p>Shortest Non-Shared Substring Problem. Find the shortest substring of one string that does not appear in another string.</p>
<p>Given:&nbsp;Strings&nbsp;_Text_1&nbsp;and&nbsp;_Text_2.</p>
<p>Return:&nbsp;The shortest substring of&nbsp;_Text_1&nbsp;that does not appear in&nbsp;_Text_2. (Multiple solutions may exist, in which case you may return any one.)</p>
<section id="sample-dataset-91" class="level2" data-number="91.1">
<h2 data-number="91.1" class="anchored" data-anchor-id="sample-dataset-91"><span class="header-section-number">91.1</span> Sample Dataset</h2>
<pre><code>CCAAGCTGCTAGAGG
CATGCTGGGCTGGCT</code></pre>
</section>
<section id="sample-output-91" class="level2" data-number="91.2">
<h2 data-number="91.2" class="anchored" data-anchor-id="sample-output-91"><span class="header-section-number">91.2</span> Sample Output</h2>
<pre><code>AA</code></pre>
</section>
<section id="solution-91" class="level2" data-number="91.3">
<h2 data-number="91.3" class="anchored" data-anchor-id="solution-91"><span class="header-section-number">91.3</span> Solution</h2>
<div class="sourceCode" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cache</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> commonprefix</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Set</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a><span class="at">@cache</span></span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_suffix_tree(sequence: <span class="bu">str</span>, start_positions: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">str</span>, Dict] <span class="op">=</span> {}</span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a>    unique_bases <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([sequence[start] <span class="cf">for</span> start <span class="kw">in</span> start_positions]))</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> unique_bases:</span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>        matching_positions <span class="op">=</span> [start <span class="cf">for</span> start <span class="kw">in</span> start_positions <span class="cf">if</span> sequence[start] <span class="op">==</span> base]</span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a>        subsequences <span class="op">=</span> [sequence[s:] <span class="cf">for</span> s <span class="kw">in</span> matching_positions]</span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a>        common_prefix <span class="op">=</span> commonprefix(subsequences)</span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a>        prefix_length <span class="op">=</span> <span class="bu">len</span>(common_prefix)</span>
<span id="cb275-16"><a href="#cb275-16" aria-hidden="true" tabindex="-1"></a>        new_start_positions <span class="op">=</span> [start <span class="op">+</span> prefix_length <span class="cf">for</span> start <span class="kw">in</span> matching_positions <span class="cf">if</span> start <span class="op">+</span> prefix_length <span class="op">&lt;</span> <span class="bu">len</span>(sequence)]</span>
<span id="cb275-17"><a href="#cb275-17" aria-hidden="true" tabindex="-1"></a>        tree[common_prefix] <span class="op">=</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(new_start_positions))</span>
<span id="cb275-18"><a href="#cb275-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb275-19"><a href="#cb275-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-20"><a href="#cb275-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_tree(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb275-21"><a href="#cb275-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="bu">len</span>(sequence))))</span>
<span id="cb275-22"><a href="#cb275-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-23"><a href="#cb275-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_leaf_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb275-24"><a href="#cb275-24" aria-hidden="true" tabindex="-1"></a>    all_child_nodes <span class="op">=</span> <span class="bu">set</span>(node[<span class="st">"n"</span>] <span class="cf">for</span> nodes <span class="kw">in</span> graph.values() <span class="cf">for</span> node <span class="kw">in</span> nodes)</span>
<span id="cb275-25"><a href="#cb275-25" aria-hidden="true" tabindex="-1"></a>    parent_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb275-26"><a href="#cb275-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_child_nodes <span class="op">-</span> parent_nodes</span>
<span id="cb275-27"><a href="#cb275-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-28"><a href="#cb275-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph_structure(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb275-29"><a href="#cb275-29" aria-hidden="true" tabindex="-1"></a>    reversed_graph: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb275-30"><a href="#cb275-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parent, children <span class="kw">in</span> graph.items():</span>
<span id="cb275-31"><a href="#cb275-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> children:</span>
<span id="cb275-32"><a href="#cb275-32" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child[<span class="st">"n"</span>]] <span class="op">=</span> {<span class="st">"n"</span>: parent, <span class="st">"l"</span>: child[<span class="st">"l"</span>]}</span>
<span id="cb275-33"><a href="#cb275-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb275-34"><a href="#cb275-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-35"><a href="#cb275-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_graph(suffix_tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb275-36"><a href="#cb275-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> build_graph_structure(subtree: Dict[<span class="bu">str</span>, Dict], graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], node_id: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb275-37"><a href="#cb275-37" aria-hidden="true" tabindex="-1"></a>        next_node_id <span class="op">=</span> node_id</span>
<span id="cb275-38"><a href="#cb275-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> <span class="bu">sorted</span>(subtree):</span>
<span id="cb275-39"><a href="#cb275-39" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb275-40"><a href="#cb275-40" aria-hidden="true" tabindex="-1"></a>            graph[node_id].append({<span class="st">"n"</span>: next_node_id, <span class="st">"l"</span>: edge})</span>
<span id="cb275-41"><a href="#cb275-41" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">=</span> build_graph_structure(subtree[edge], graph, next_node_id)</span>
<span id="cb275-42"><a href="#cb275-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> next_node_id</span>
<span id="cb275-43"><a href="#cb275-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-44"><a href="#cb275-44" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb275-45"><a href="#cb275-45" aria-hidden="true" tabindex="-1"></a>    build_graph_structure(suffix_tree, graph, <span class="dv">0</span>)</span>
<span id="cb275-46"><a href="#cb275-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb275-47"><a href="#cb275-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-48"><a href="#cb275-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_leaf_colors(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb275-49"><a href="#cb275-49" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph_structure(tree)</span>
<span id="cb275-50"><a href="#cb275-50" aria-hidden="true" tabindex="-1"></a>    colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="va">None</span>)</span>
<span id="cb275-51"><a href="#cb275-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> find_leaf_nodes(tree):</span>
<span id="cb275-52"><a href="#cb275-52" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> reversed_graph[leaf][<span class="st">"l"</span>]</span>
<span id="cb275-53"><a href="#cb275-53" aria-hidden="true" tabindex="-1"></a>        match <span class="op">=</span> re.search(<span class="vs">r"([$#])"</span>, edge)</span>
<span id="cb275-54"><a href="#cb275-54" aria-hidden="true" tabindex="-1"></a>        colors[leaf] <span class="op">=</span> <span class="st">"red"</span> <span class="cf">if</span> match <span class="kw">and</span> match.group() <span class="op">==</span> <span class="st">"$"</span> <span class="cf">else</span> <span class="st">"blue"</span></span>
<span id="cb275-55"><a href="#cb275-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb275-56"><a href="#cb275-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-57"><a href="#cb275-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_tree_nodes(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb275-58"><a href="#cb275-58" aria-hidden="true" tabindex="-1"></a>    nodes_to_process <span class="op">=</span> <span class="bu">list</span>(tree.keys())</span>
<span id="cb275-59"><a href="#cb275-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes_to_process:</span>
<span id="cb275-60"><a href="#cb275-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> nodes_to_process[:]:</span>
<span id="cb275-61"><a href="#cb275-61" aria-hidden="true" tabindex="-1"></a>            child_colors <span class="op">=</span> [colors[n[<span class="st">"n"</span>]] <span class="cf">for</span> n <span class="kw">in</span> tree[node]]</span>
<span id="cb275-62"><a href="#cb275-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(child_colors):</span>
<span id="cb275-63"><a href="#cb275-63" aria-hidden="true" tabindex="-1"></a>                unique_colors <span class="op">=</span> <span class="bu">set</span>(child_colors)</span>
<span id="cb275-64"><a href="#cb275-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> unique_colors <span class="op">==</span> {<span class="st">"red"</span>}:</span>
<span id="cb275-65"><a href="#cb275-65" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb275-66"><a href="#cb275-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> unique_colors <span class="op">==</span> {<span class="st">"blue"</span>}:</span>
<span id="cb275-67"><a href="#cb275-67" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb275-68"><a href="#cb275-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb275-69"><a href="#cb275-69" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"purple"</span></span>
<span id="cb275-70"><a href="#cb275-70" aria-hidden="true" tabindex="-1"></a>                nodes_to_process.remove(node)</span>
<span id="cb275-71"><a href="#cb275-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb275-72"><a href="#cb275-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-73"><a href="#cb275-73" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_non_purple_edges(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]):</span>
<span id="cb275-74"><a href="#cb275-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _find_non_purple_edges(node: <span class="bu">int</span>, sequence: List[<span class="bu">str</span>], path: List[<span class="bu">int</span>]):</span>
<span id="cb275-75"><a href="#cb275-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> colors[node] <span class="op">==</span> <span class="st">"purple"</span>:</span>
<span id="cb275-76"><a href="#cb275-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> child <span class="kw">in</span> tree[node]:</span>
<span id="cb275-77"><a href="#cb275-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> <span class="cf">from</span> _find_non_purple_edges(child[<span class="st">"n"</span>], sequence <span class="op">+</span> [child[<span class="st">"l"</span>]], path <span class="op">+</span> [node])</span>
<span id="cb275-78"><a href="#cb275-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb275-79"><a href="#cb275-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> colors[node] <span class="op">==</span> <span class="st">"red"</span>:</span>
<span id="cb275-80"><a href="#cb275-80" aria-hidden="true" tabindex="-1"></a>                sequence[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> sequence[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb275-81"><a href="#cb275-81" aria-hidden="true" tabindex="-1"></a>                joined_sequence <span class="op">=</span> <span class="st">""</span>.join(sequence)</span>
<span id="cb275-82"><a href="#cb275-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"#"</span> <span class="kw">not</span> <span class="kw">in</span> joined_sequence <span class="kw">and</span> <span class="st">"$"</span> <span class="kw">not</span> <span class="kw">in</span> joined_sequence:</span>
<span id="cb275-83"><a href="#cb275-83" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">yield</span> joined_sequence</span>
<span id="cb275-84"><a href="#cb275-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-85"><a href="#cb275-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="cf">from</span> _find_non_purple_edges(<span class="dv">0</span>, [], [])</span>
<span id="cb275-86"><a href="#cb275-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-87"><a href="#cb275-87" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_shortest_nonshared_substring(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb275-88"><a href="#cb275-88" aria-hidden="true" tabindex="-1"></a>    combined_sequence <span class="op">=</span> seq1 <span class="op">+</span> <span class="st">"$"</span> <span class="op">+</span> seq2 <span class="op">+</span> <span class="st">"#"</span></span>
<span id="cb275-89"><a href="#cb275-89" aria-hidden="true" tabindex="-1"></a>    suffix_tree <span class="op">=</span> create_suffix_tree(combined_sequence)</span>
<span id="cb275-90"><a href="#cb275-90" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> convert_to_graph(suffix_tree)</span>
<span id="cb275-91"><a href="#cb275-91" aria-hidden="true" tabindex="-1"></a>    initial_colors <span class="op">=</span> initialize_leaf_colors(graph)</span>
<span id="cb275-92"><a href="#cb275-92" aria-hidden="true" tabindex="-1"></a>    final_colors <span class="op">=</span> color_tree_nodes(graph, initial_colors)</span>
<span id="cb275-93"><a href="#cb275-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(find_non_purple_edges(graph, final_colors), key<span class="op">=</span><span class="bu">len</span>)</span>
<span id="cb275-94"><a href="#cb275-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-95"><a href="#cb275-95" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb275-96"><a href="#cb275-96" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGCTGCTAGAGG</span></span>
<span id="cb275-97"><a href="#cb275-97" aria-hidden="true" tabindex="-1"></a><span class="st">CATGCTGGGCTGGCT</span></span>
<span id="cb275-98"><a href="#cb275-98" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb275-99"><a href="#cb275-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-100"><a href="#cb275-100" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb275-101"><a href="#cb275-101" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(find_shortest_nonshared_substring(sequence1, sequence2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-suffix-array-of-a-string" class="level1" data-number="92">
<h1 data-number="92"><span class="header-section-number">92</span> Construct the Suffix Array of a String</h1>
<p>Suffix Array Construction Problem. Construct the suffix array of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;<em>SuffixArray</em>(<em>Text</em>).</p>
<section id="sample-dataset-92" class="level2" data-number="92.1">
<h2 data-number="92.1" class="anchored" data-anchor-id="sample-dataset-92"><span class="header-section-number">92.1</span> Sample Dataset</h2>
<pre><code>AACGATAGCGGTAGA$</code></pre>
</section>
<section id="sample-output-92" class="level2" data-number="92.2">
<h2 data-number="92.2" class="anchored" data-anchor-id="sample-output-92"><span class="header-section-number">92.2</span> Sample Output</h2>
<pre><code>15, 14, 0, 1, 12, 6, 4, 2, 8, 13, 3, 7, 9, 10, 11, 5</code></pre>
</section>
<section id="solution-92" class="level2" data-number="92.3">
<h2 data-number="92.3" class="anchored" data-anchor-id="solution-92"><span class="header-section-number">92.3</span> Solution</h2>
<div class="sourceCode" id="cb278"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a suffix array for the given text.</span></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="co">    text (str): The input string to create a suffix array for.</span></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a><span class="co">    List[int]: A list of indices representing the suffix array.</span></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a>    suffixes <span class="op">=</span> [(i, text[i:]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))]</span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a>    sorted_suffixes <span class="op">=</span> <span class="bu">sorted</span>(suffixes, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [index <span class="cf">for</span> index, _ <span class="kw">in</span> sorted_suffixes]</span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"AACGATAGCGGTAGA$"</span></span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a>suffix_array <span class="op">=</span> create_suffix_array(sample_input.strip())</span>
<span id="cb278-19"><a href="#cb278-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>suffix_array, sep<span class="op">=</span><span class="st">", "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="pattern-matching-with-the-suffix-array" class="level1" data-number="93">
<h1 data-number="93"><span class="header-section-number">93</span> Pattern Matching with the Suffix Array</h1>
<p>Multiple Pattern Matching with the Suffix Array.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;and a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Text</em>&nbsp;where a string from&nbsp;<em>Patterns</em>&nbsp;appears as a substring.</p>
<section id="sample-dataset-93" class="level2" data-number="93.1">
<h2 data-number="93.1" class="anchored" data-anchor-id="sample-dataset-93"><span class="header-section-number">93.1</span> Sample Dataset</h2>
<pre><code>AATCGGGTTCAATCGGGGT
ATCG
GGGT</code></pre>
</section>
<section id="sample-output-93" class="level2" data-number="93.2">
<h2 data-number="93.2" class="anchored" data-anchor-id="sample-output-93"><span class="header-section-number">93.2</span> Sample Output</h2>
<pre><code>1 4 11 15</code></pre>
</section>
<section id="solution-93" class="level2" data-number="93.3">
<h2 data-number="93.3" class="anchored" data-anchor-id="solution-93"><span class="header-section-number">93.3</span> Solution</h2>
<div class="sourceCode" id="cb281"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a suffix array for the given text.</span></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a><span class="co">    text (str): The input string to create a suffix array for.</span></span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb281-11"><a href="#cb281-11" aria-hidden="true" tabindex="-1"></a><span class="co">    List[int]: A list of indices representing the suffix array.</span></span>
<span id="cb281-12"><a href="#cb281-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb281-13"><a href="#cb281-13" aria-hidden="true" tabindex="-1"></a>    suffixes: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(i, text[i:]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))]</span>
<span id="cb281-14"><a href="#cb281-14" aria-hidden="true" tabindex="-1"></a>    sorted_suffixes: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> <span class="bu">sorted</span>(suffixes, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb281-15"><a href="#cb281-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [index <span class="cf">for</span> index, _ <span class="kw">in</span> sorted_suffixes]</span>
<span id="cb281-16"><a href="#cb281-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-17"><a href="#cb281-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>, suffix_array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb281-18"><a href="#cb281-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb281-19"><a href="#cb281-19" aria-hidden="true" tabindex="-1"></a><span class="co">    Find all occurrences of a pattern in the text using the suffix array.</span></span>
<span id="cb281-20"><a href="#cb281-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-21"><a href="#cb281-21" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb281-22"><a href="#cb281-22" aria-hidden="true" tabindex="-1"></a><span class="co">    text (str): The input text to search in.</span></span>
<span id="cb281-23"><a href="#cb281-23" aria-hidden="true" tabindex="-1"></a><span class="co">    pattern (str): The pattern to search for.</span></span>
<span id="cb281-24"><a href="#cb281-24" aria-hidden="true" tabindex="-1"></a><span class="co">    suffix_array (List[int]): The suffix array of the text.</span></span>
<span id="cb281-25"><a href="#cb281-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-26"><a href="#cb281-26" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb281-27"><a href="#cb281-27" aria-hidden="true" tabindex="-1"></a><span class="co">    List[int]: A list of indices where the pattern occurs in the text.</span></span>
<span id="cb281-28"><a href="#cb281-28" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb281-29"><a href="#cb281-29" aria-hidden="true" tabindex="-1"></a>    lower_bound: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb281-30"><a href="#cb281-30" aria-hidden="true" tabindex="-1"></a>    upper_bound: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(text)</span>
<span id="cb281-31"><a href="#cb281-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb281-32"><a href="#cb281-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> lower_bound <span class="op">&lt;</span> upper_bound:</span>
<span id="cb281-33"><a href="#cb281-33" aria-hidden="true" tabindex="-1"></a>        mid_point: <span class="bu">int</span> <span class="op">=</span> (lower_bound <span class="op">+</span> upper_bound) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb281-34"><a href="#cb281-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pattern <span class="op">&gt;</span> text[suffix_array[mid_point]:][: <span class="bu">len</span>(pattern)]:</span>
<span id="cb281-35"><a href="#cb281-35" aria-hidden="true" tabindex="-1"></a>            lower_bound <span class="op">=</span> mid_point <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb281-36"><a href="#cb281-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb281-37"><a href="#cb281-37" aria-hidden="true" tabindex="-1"></a>            upper_bound <span class="op">=</span> mid_point</span>
<span id="cb281-38"><a href="#cb281-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb281-39"><a href="#cb281-39" aria-hidden="true" tabindex="-1"></a>    first_occurrence: <span class="bu">int</span> <span class="op">=</span> lower_bound</span>
<span id="cb281-40"><a href="#cb281-40" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> <span class="bu">len</span>(text)</span>
<span id="cb281-41"><a href="#cb281-41" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb281-42"><a href="#cb281-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> lower_bound <span class="op">&lt;</span> upper_bound:</span>
<span id="cb281-43"><a href="#cb281-43" aria-hidden="true" tabindex="-1"></a>        mid_point: <span class="bu">int</span> <span class="op">=</span> (lower_bound <span class="op">+</span> upper_bound) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb281-44"><a href="#cb281-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pattern <span class="op">&lt;</span> text[suffix_array[mid_point]:][: <span class="bu">len</span>(pattern)]:</span>
<span id="cb281-45"><a href="#cb281-45" aria-hidden="true" tabindex="-1"></a>            upper_bound <span class="op">=</span> mid_point</span>
<span id="cb281-46"><a href="#cb281-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb281-47"><a href="#cb281-47" aria-hidden="true" tabindex="-1"></a>            lower_bound <span class="op">=</span> mid_point <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb281-48"><a href="#cb281-48" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb281-49"><a href="#cb281-49" aria-hidden="true" tabindex="-1"></a>    last_occurrence: <span class="bu">int</span> <span class="op">=</span> upper_bound</span>
<span id="cb281-50"><a href="#cb281-50" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb281-51"><a href="#cb281-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> first_occurrence <span class="op">&gt;</span> last_occurrence:</span>
<span id="cb281-52"><a href="#cb281-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb281-53"><a href="#cb281-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb281-54"><a href="#cb281-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">range</span>(first_occurrence, last_occurrence))</span>
<span id="cb281-55"><a href="#cb281-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-56"><a href="#cb281-56" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb281-57"><a href="#cb281-57" aria-hidden="true" tabindex="-1"></a><span class="st">AATCGGGTTCAATCGGGGT</span></span>
<span id="cb281-58"><a href="#cb281-58" aria-hidden="true" tabindex="-1"></a><span class="st">ATCG</span></span>
<span id="cb281-59"><a href="#cb281-59" aria-hidden="true" tabindex="-1"></a><span class="st">GGGT</span></span>
<span id="cb281-60"><a href="#cb281-60" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb281-61"><a href="#cb281-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-62"><a href="#cb281-62" aria-hidden="true" tabindex="-1"></a>sequence, <span class="op">*</span>patterns <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb281-63"><a href="#cb281-63" aria-hidden="true" tabindex="-1"></a>suffix_array: List[<span class="bu">int</span>] <span class="op">=</span> create_suffix_array(sequence)</span>
<span id="cb281-64"><a href="#cb281-64" aria-hidden="true" tabindex="-1"></a>matching_indices: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb281-65"><a href="#cb281-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-66"><a href="#cb281-66" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb281-67"><a href="#cb281-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index <span class="kw">in</span> find_pattern_occurrences(sequence, pattern, suffix_array):</span>
<span id="cb281-68"><a href="#cb281-68" aria-hidden="true" tabindex="-1"></a>        matching_indices.append(suffix_array[index])</span>
<span id="cb281-69"><a href="#cb281-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-70"><a href="#cb281-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(<span class="bu">set</span>(matching_indices)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-burrows-wheeler-transform-of-a-string" class="level1" data-number="94">
<h1 data-number="94"><span class="header-section-number">94</span> Construct the Burrows-Wheeler Transform of a String</h1>
<p>Burrows-Wheeler Transform Construction Problem.Construct the Burrows-Wheeler transform of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;<em>BWT</em>(<em>Text</em>).</p>
<section id="sample-dataset-94" class="level2" data-number="94.1">
<h2 data-number="94.1" class="anchored" data-anchor-id="sample-dataset-94"><span class="header-section-number">94.1</span> Sample Dataset</h2>
<pre><code>GCGTGCCTGGTCA$</code></pre>
</section>
<section id="sample-output-94" class="level2" data-number="94.2">
<h2 data-number="94.2" class="anchored" data-anchor-id="sample-output-94"><span class="header-section-number">94.2</span> Sample Output</h2>
<pre><code>ACTGGCT$TGCGGC</code></pre>
</section>
<section id="solution-94" class="level2" data-number="94.3">
<h2 data-number="94.3" class="anchored" data-anchor-id="solution-94"><span class="header-section-number">94.3</span> Solution</h2>
<div class="sourceCode" id="cb284"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a suffix array for the given text.</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a><span class="co">    text (str): The input string to create a suffix array for.</span></span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a><span class="co">    List[int]: A list of indices representing the suffix array.</span></span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>    suffixes <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">range</span>(<span class="bu">len</span>(text)), key<span class="op">=</span><span class="kw">lambda</span> i: text[i:])</span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> suffixes</span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb284-17"><a href="#cb284-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb284-18"><a href="#cb284-18" aria-hidden="true" tabindex="-1"></a><span class="co">    Perform the Burrows-Wheeler Transform on the input sequence.</span></span>
<span id="cb284-19"><a href="#cb284-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-20"><a href="#cb284-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb284-21"><a href="#cb284-21" aria-hidden="true" tabindex="-1"></a><span class="co">    sequence (str): The input string to transform.</span></span>
<span id="cb284-22"><a href="#cb284-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-23"><a href="#cb284-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb284-24"><a href="#cb284-24" aria-hidden="true" tabindex="-1"></a><span class="co">    str: The Burrows-Wheeler Transform of the input sequence.</span></span>
<span id="cb284-25"><a href="#cb284-25" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb284-26"><a href="#cb284-26" aria-hidden="true" tabindex="-1"></a>    suffix_array <span class="op">=</span> create_suffix_array(sequence)</span>
<span id="cb284-27"><a href="#cb284-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(sequence[i <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> suffix_array)</span>
<span id="cb284-28"><a href="#cb284-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-29"><a href="#cb284-29" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"GCGTGCCTGGTCA$"</span></span>
<span id="cb284-30"><a href="#cb284-30" aria-hidden="true" tabindex="-1"></a>transformed_sequence <span class="op">=</span> burrows_wheeler_transform(sample_input.strip())</span>
<span id="cb284-31"><a href="#cb284-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(transformed_sequence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-burrows-wheeler-transform" class="level1" data-number="95">
<h1 data-number="95"><span class="header-section-number">95</span> Reconstruct a String from its Burrows-Wheeler Transform</h1>
<p>Inverse Burrows-Wheeler Transform Problem. Reconstruct a string from its Burrows-Wheeler transform.</p>
<p>Given:&nbsp;A string&nbsp;<em>Transform</em>&nbsp;(with a single “$” sign).</p>
<p>Return:&nbsp;The string&nbsp;<em>Text</em>&nbsp;such that&nbsp;<em>BWT</em>(<em>Text</em>) =&nbsp;<em>Transform</em>.</p>
<section id="sample-dataset-95" class="level2" data-number="95.1">
<h2 data-number="95.1" class="anchored" data-anchor-id="sample-dataset-95"><span class="header-section-number">95.1</span> Sample Dataset</h2>
<pre><code>TTCCTAACG$A</code></pre>
</section>
<section id="sample-output-95" class="level2" data-number="95.2">
<h2 data-number="95.2" class="anchored" data-anchor-id="sample-output-95"><span class="header-section-number">95.2</span> Sample Output</h2>
<pre><code>TACATCACGT$</code></pre>
</section>
<section id="solution-95" class="level2" data-number="95.3">
<h2 data-number="95.3" class="anchored" data-anchor-id="solution-95"><span class="header-section-number">95.3</span> Solution</h2>
<div class="sourceCode" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Generator</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> index_characters(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Generate each character with its occurrence number in the sequence.</span></span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a><span class="co">    sequence (str): The input string to index.</span></span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Yields:</span></span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Tuple[str, int]: A tuple containing the character and its occurrence number.</span></span>
<span id="cb287-13"><a href="#cb287-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb287-14"><a href="#cb287-14" aria-hidden="true" tabindex="-1"></a>    char_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb287-15"><a href="#cb287-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> sequence:</span>
<span id="cb287-16"><a href="#cb287-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> char, char_counts[char]</span>
<span id="cb287-17"><a href="#cb287-17" aria-hidden="true" tabindex="-1"></a>        char_counts[char] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb287-18"><a href="#cb287-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-19"><a href="#cb287-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform_inverse(bwt_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb287-20"><a href="#cb287-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb287-21"><a href="#cb287-21" aria-hidden="true" tabindex="-1"></a><span class="co">    Perform the inverse Burrows-Wheeler Transform on the input sequence.</span></span>
<span id="cb287-22"><a href="#cb287-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-23"><a href="#cb287-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb287-24"><a href="#cb287-24" aria-hidden="true" tabindex="-1"></a><span class="co">    bwt_sequence (str): The Burrows-Wheeler transformed string.</span></span>
<span id="cb287-25"><a href="#cb287-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-26"><a href="#cb287-26" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb287-27"><a href="#cb287-27" aria-hidden="true" tabindex="-1"></a><span class="co">    str: The original string before BWT.</span></span>
<span id="cb287-28"><a href="#cb287-28" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb287-29"><a href="#cb287-29" aria-hidden="true" tabindex="-1"></a>    first_column <span class="op">=</span> <span class="bu">list</span>(index_characters(<span class="bu">sorted</span>(bwt_sequence)))</span>
<span id="cb287-30"><a href="#cb287-30" aria-hidden="true" tabindex="-1"></a>    last_column <span class="op">=</span> <span class="bu">list</span>(index_characters(bwt_sequence))</span>
<span id="cb287-31"><a href="#cb287-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb287-32"><a href="#cb287-32" aria-hidden="true" tabindex="-1"></a>    current_char: Tuple[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> (<span class="st">"$"</span>, <span class="dv">0</span>)</span>
<span id="cb287-33"><a href="#cb287-33" aria-hidden="true" tabindex="-1"></a>    original_sequence: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb287-34"><a href="#cb287-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb287-35"><a href="#cb287-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(bwt_sequence)):</span>
<span id="cb287-36"><a href="#cb287-36" aria-hidden="true" tabindex="-1"></a>        current_char <span class="op">=</span> first_column[last_column.index(current_char)]</span>
<span id="cb287-37"><a href="#cb287-37" aria-hidden="true" tabindex="-1"></a>        original_sequence.append(current_char[<span class="dv">0</span>])</span>
<span id="cb287-38"><a href="#cb287-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb287-39"><a href="#cb287-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(original_sequence)</span>
<span id="cb287-40"><a href="#cb287-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-41"><a href="#cb287-41" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"TTCCTAACG$A"</span></span>
<span id="cb287-42"><a href="#cb287-42" aria-hidden="true" tabindex="-1"></a>original_sequence <span class="op">=</span> burrows_wheeler_transform_inverse(sample_input.strip())</span>
<span id="cb287-43"><a href="#cb287-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(original_sequence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-last-to-first-mapping-of-a-string" class="level1" data-number="96">
<h1 data-number="96"><span class="header-section-number">96</span> Generate the Last-to-First Mapping of a String</h1>
<p>Last-to-First Mapping Problem.</p>
<p>Given:&nbsp;A string&nbsp;<em>Transform</em>&nbsp;and an integer&nbsp;<em>i</em>.</p>
<p>Return:&nbsp;The position&nbsp;<em>LastToFirst</em>(<em>i</em>) in&nbsp;<em>FirstColumn</em>&nbsp;in the Burrows-Wheeler matrix if&nbsp;<em>LastColumn</em>&nbsp;=&nbsp;<em>Transform</em>.</p>
<section id="sample-dataset-96" class="level2" data-number="96.1">
<h2 data-number="96.1" class="anchored" data-anchor-id="sample-dataset-96"><span class="header-section-number">96.1</span> Sample Dataset</h2>
<pre><code>T$GACCA
3</code></pre>
</section>
<section id="sample-output-96" class="level2" data-number="96.2">
<h2 data-number="96.2" class="anchored" data-anchor-id="sample-output-96"><span class="header-section-number">96.2</span> Sample Output</h2>
<pre><code>1</code></pre>
</section>
<section id="solution-96" class="level2" data-number="96.3">
<h2 data-number="96.3" class="anchored" data-anchor-id="solution-96"><span class="header-section-number">96.3</span> Solution</h2>
<div class="sourceCode" id="cb290"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Generator</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> index_characters(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Generate each character with its occurrence number in the sequence.</span></span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a><span class="co">    sequence (str): The input string to index.</span></span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Yields:</span></span>
<span id="cb290-12"><a href="#cb290-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Tuple[str, int]: A tuple containing the character and its occurrence number.</span></span>
<span id="cb290-13"><a href="#cb290-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb290-14"><a href="#cb290-14" aria-hidden="true" tabindex="-1"></a>    char_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb290-15"><a href="#cb290-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> sequence:</span>
<span id="cb290-16"><a href="#cb290-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> char, char_counts[char]</span>
<span id="cb290-17"><a href="#cb290-17" aria-hidden="true" tabindex="-1"></a>        char_counts[char] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb290-18"><a href="#cb290-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-19"><a href="#cb290-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> last_to_first_mapping(sequence: <span class="bu">str</span>, index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb290-20"><a href="#cb290-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb290-21"><a href="#cb290-21" aria-hidden="true" tabindex="-1"></a><span class="co">    Find the mapping from Last column to First column in the Burrows-Wheeler Transform matrix.</span></span>
<span id="cb290-22"><a href="#cb290-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-23"><a href="#cb290-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb290-24"><a href="#cb290-24" aria-hidden="true" tabindex="-1"></a><span class="co">    sequence (str): The input string (Last column of BWT matrix).</span></span>
<span id="cb290-25"><a href="#cb290-25" aria-hidden="true" tabindex="-1"></a><span class="co">    index (int): The index in the Last column.</span></span>
<span id="cb290-26"><a href="#cb290-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-27"><a href="#cb290-27" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb290-28"><a href="#cb290-28" aria-hidden="true" tabindex="-1"></a><span class="co">    int: The corresponding index in the First column.</span></span>
<span id="cb290-29"><a href="#cb290-29" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb290-30"><a href="#cb290-30" aria-hidden="true" tabindex="-1"></a>    first_column <span class="op">=</span> <span class="bu">list</span>(index_characters(<span class="bu">sorted</span>(sequence)))</span>
<span id="cb290-31"><a href="#cb290-31" aria-hidden="true" tabindex="-1"></a>    last_column <span class="op">=</span> <span class="bu">list</span>(index_characters(sequence))</span>
<span id="cb290-32"><a href="#cb290-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> first_column.index(last_column[index])</span>
<span id="cb290-33"><a href="#cb290-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-34"><a href="#cb290-34" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb290-35"><a href="#cb290-35" aria-hidden="true" tabindex="-1"></a><span class="st">T$GACCA</span></span>
<span id="cb290-36"><a href="#cb290-36" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb290-37"><a href="#cb290-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb290-38"><a href="#cb290-38" aria-hidden="true" tabindex="-1"></a>sequence, index_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb290-39"><a href="#cb290-39" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> <span class="bu">int</span>(index_str)</span>
<span id="cb290-40"><a href="#cb290-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-41"><a href="#cb290-41" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> last_to_first_mapping(sequence.strip(), index)</span>
<span id="cb290-42"><a href="#cb290-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-bwmatching" class="level1" data-number="97">
<h1 data-number="97"><span class="header-section-number">97</span> Implement BWMatching</h1>
<p>Implement. BWMatching.</p>
<p>Given:&nbsp;A string&nbsp;<em>BWT</em>(<em>Text</em>), followed by a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;A list of integers, where the&nbsp;<em>i</em>-th integer corresponds to the number of substring matches of the&nbsp;<em>i</em>-th member of&nbsp;<em>Patterns</em>&nbsp;in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-97" class="level2" data-number="97.1">
<h2 data-number="97.1" class="anchored" data-anchor-id="sample-dataset-97"><span class="header-section-number">97.1</span> Sample Dataset</h2>
<pre><code>TCCTCTATGAGATCCTATTCTATGAAACCTTCA$GACCAAAATTCTCCGGC
CCT CAC GAG CAG ATC</code></pre>
</section>
<section id="sample-output-97" class="level2" data-number="97.2">
<h2 data-number="97.2" class="anchored" data-anchor-id="sample-output-97"><span class="header-section-number">97.2</span> Sample Output</h2>
<pre><code>2 1 1 0 1</code></pre>
</section>
<section id="solution-97" class="level2" data-number="97.3">
<h2 data-number="97.3" class="anchored" data-anchor-id="solution-97"><span class="header-section-number">97.3</span> Solution</h2>
<div class="sourceCode" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> BWMatching(bwt: <span class="bu">str</span>, patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_count_and_first_occurrence(bwt: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]], Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>        count: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {char: [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(bwt) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> char <span class="kw">in</span> <span class="bu">set</span>(bwt)}</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>        first_occurrence: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>        sorted_bwt: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">sorted</span>(bwt)</span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(bwt):</span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> c <span class="kw">in</span> count:</span>
<span id="cb293-11"><a href="#cb293-11" aria-hidden="true" tabindex="-1"></a>                count[c][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> count[c][i]</span>
<span id="cb293-12"><a href="#cb293-12" aria-hidden="true" tabindex="-1"></a>            count[char][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb293-13"><a href="#cb293-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-14"><a href="#cb293-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sorted_bwt):</span>
<span id="cb293-15"><a href="#cb293-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="kw">not</span> <span class="kw">in</span> first_occurrence:</span>
<span id="cb293-16"><a href="#cb293-16" aria-hidden="true" tabindex="-1"></a>                first_occurrence[char] <span class="op">=</span> i</span>
<span id="cb293-17"><a href="#cb293-17" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb293-18"><a href="#cb293-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> count, first_occurrence</span>
<span id="cb293-19"><a href="#cb293-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-20"><a href="#cb293-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> count_matches(pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb293-21"><a href="#cb293-21" aria-hidden="true" tabindex="-1"></a>        top: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb293-22"><a href="#cb293-22" aria-hidden="true" tabindex="-1"></a>        bottom: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(bwt) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb293-23"><a href="#cb293-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> top <span class="op">&lt;=</span> bottom:</span>
<span id="cb293-24"><a href="#cb293-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pattern:</span>
<span id="cb293-25"><a href="#cb293-25" aria-hidden="true" tabindex="-1"></a>                symbol: <span class="bu">str</span> <span class="op">=</span> pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb293-26"><a href="#cb293-26" aria-hidden="true" tabindex="-1"></a>                pattern <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb293-27"><a href="#cb293-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> symbol <span class="kw">in</span> bwt[top:bottom<span class="op">+</span><span class="dv">1</span>]:</span>
<span id="cb293-28"><a href="#cb293-28" aria-hidden="true" tabindex="-1"></a>                    top <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count[symbol][top]</span>
<span id="cb293-29"><a href="#cb293-29" aria-hidden="true" tabindex="-1"></a>                    bottom <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count[symbol][bottom<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb293-30"><a href="#cb293-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb293-31"><a href="#cb293-31" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb293-32"><a href="#cb293-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb293-33"><a href="#cb293-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> bottom <span class="op">-</span> top <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb293-34"><a href="#cb293-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-35"><a href="#cb293-35" aria-hidden="true" tabindex="-1"></a>    count, first_occurrence <span class="op">=</span> create_count_and_first_occurrence(bwt)</span>
<span id="cb293-36"><a href="#cb293-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_matches(pattern) <span class="cf">for</span> pattern <span class="kw">in</span> patterns]</span>
<span id="cb293-37"><a href="#cb293-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-38"><a href="#cb293-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb293-39"><a href="#cb293-39" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb293-40"><a href="#cb293-40" aria-hidden="true" tabindex="-1"></a><span class="st">TCCTCTATGAGATCCTATTCTATGAAACCTTCA$GACCAAAATTCTCCGGC</span></span>
<span id="cb293-41"><a href="#cb293-41" aria-hidden="true" tabindex="-1"></a><span class="st">CCT CAC GAG CAG ATC</span></span>
<span id="cb293-42"><a href="#cb293-42" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb293-43"><a href="#cb293-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-44"><a href="#cb293-44" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb293-45"><a href="#cb293-45" aria-hidden="true" tabindex="-1"></a>bwt: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb293-46"><a href="#cb293-46" aria-hidden="true" tabindex="-1"></a>patterns: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>].split()</span>
<span id="cb293-47"><a href="#cb293-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-48"><a href="#cb293-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the BWMatching algorithm</span></span>
<span id="cb293-49"><a href="#cb293-49" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> BWMatching(bwt, patterns)</span>
<span id="cb293-50"><a href="#cb293-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-betterbwmatching" class="level1" data-number="98">
<h1 data-number="98"><span class="header-section-number">98</span> Implement BetterBWMatching</h1>
<p>Given:&nbsp;A string&nbsp;<em>BWT</em>(<em>Text</em>), followed by a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;A list of integers, where the&nbsp;<em>i</em>-th integer corresponds to the number of substring matches of the&nbsp;<em>i</em>-th member of&nbsp;<em>Patterns</em>&nbsp;in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-98" class="level2" data-number="98.1">
<h2 data-number="98.1" class="anchored" data-anchor-id="sample-dataset-98"><span class="header-section-number">98.1</span> Sample Dataset</h2>
<pre><code>GGCGCCGC$TAGTCACACACGCCGTA
ACC CCG CAG</code></pre>
</section>
<section id="sample-output-98" class="level2" data-number="98.2">
<h2 data-number="98.2" class="anchored" data-anchor-id="sample-output-98"><span class="header-section-number">98.2</span> Sample Output</h2>
<pre><code>1 2 1</code></pre>
</section>
<section id="solution-98" class="level2" data-number="98.3">
<h2 data-number="98.3" class="anchored" data-anchor-id="solution-98"><span class="header-section-number">98.3</span> Solution</h2>
<div class="sourceCode" id="cb296"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> BetterBWMatching(bwt: <span class="bu">str</span>, patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preprocess_bwt(bwt: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">str</span>], Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]], Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>        first_column: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">sorted</span>(bwt)</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>        count: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {char: [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(bwt) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> char <span class="kw">in</span> <span class="bu">set</span>(bwt)}</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>        start_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {char: first_column.index(char) <span class="cf">for</span> char <span class="kw">in</span> <span class="bu">set</span>(bwt)}</span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(bwt):</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> c <span class="kw">in</span> count:</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>                count[c][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> count[c][i]</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>            count[char][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> first_column, count, start_index</span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> count_occurrences(pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a>        top: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb296-18"><a href="#cb296-18" aria-hidden="true" tabindex="-1"></a>        bottom: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(bwt) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb296-19"><a href="#cb296-19" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb296-20"><a href="#cb296-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> top <span class="op">&lt;=</span> bottom:</span>
<span id="cb296-21"><a href="#cb296-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pattern:</span>
<span id="cb296-22"><a href="#cb296-22" aria-hidden="true" tabindex="-1"></a>                symbol: <span class="bu">str</span> <span class="op">=</span> pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb296-23"><a href="#cb296-23" aria-hidden="true" tabindex="-1"></a>                pattern <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb296-24"><a href="#cb296-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> symbol <span class="kw">in</span> bwt[top:bottom<span class="op">+</span><span class="dv">1</span>]:</span>
<span id="cb296-25"><a href="#cb296-25" aria-hidden="true" tabindex="-1"></a>                    top <span class="op">=</span> start_index[symbol] <span class="op">+</span> count[symbol][top]</span>
<span id="cb296-26"><a href="#cb296-26" aria-hidden="true" tabindex="-1"></a>                    bottom <span class="op">=</span> start_index[symbol] <span class="op">+</span> count[symbol][bottom<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb296-27"><a href="#cb296-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb296-28"><a href="#cb296-28" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb296-29"><a href="#cb296-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb296-30"><a href="#cb296-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> bottom <span class="op">-</span> top <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb296-31"><a href="#cb296-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-32"><a href="#cb296-32" aria-hidden="true" tabindex="-1"></a>    first_column, count, start_index <span class="op">=</span> preprocess_bwt(bwt)</span>
<span id="cb296-33"><a href="#cb296-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_occurrences(pattern) <span class="cf">for</span> pattern <span class="kw">in</span> patterns]</span>
<span id="cb296-34"><a href="#cb296-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-35"><a href="#cb296-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb296-36"><a href="#cb296-36" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb296-37"><a href="#cb296-37" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGCCGC$TAGTCACACACGCCGTA</span></span>
<span id="cb296-38"><a href="#cb296-38" aria-hidden="true" tabindex="-1"></a><span class="st">ACC CCG CAG</span></span>
<span id="cb296-39"><a href="#cb296-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb296-40"><a href="#cb296-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-41"><a href="#cb296-41" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb296-42"><a href="#cb296-42" aria-hidden="true" tabindex="-1"></a>bwt: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb296-43"><a href="#cb296-43" aria-hidden="true" tabindex="-1"></a>patterns: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>].split()</span>
<span id="cb296-44"><a href="#cb296-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-45"><a href="#cb296-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the BetterBWMatching algorithm</span></span>
<span id="cb296-46"><a href="#cb296-46" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> BetterBWMatching(bwt, patterns)</span>
<span id="cb296-47"><a href="#cb296-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-occurrences-of-a-collection-of-patterns-in-a-string" class="level1" data-number="99">
<h1 data-number="99"><span class="header-section-number">99</span> Find All Occurrences of a Collection of Patterns in a String</h1>
<p>Multiple Pattern Matching Problem. Find all occurrences of a collection of patterns in a text.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;and a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Text</em>&nbsp;where a string from&nbsp;<em>Patterns</em>&nbsp;appears as a substring.</p>
<section id="sample-dataset-99" class="level2" data-number="99.1">
<h2 data-number="99.1" class="anchored" data-anchor-id="sample-dataset-99"><span class="header-section-number">99.1</span> Sample Dataset</h2>
<pre><code>AATCGGGTTCAATCGGGGT
ATCG
GGGT</code></pre>
</section>
<section id="sample-output-99" class="level2" data-number="99.2">
<h2 data-number="99.2" class="anchored" data-anchor-id="sample-output-99"><span class="header-section-number">99.2</span> Sample Output</h2>
<pre><code>1 4 11 15</code></pre>
</section>
<section id="solution-99" class="level2" data-number="99.3">
<h2 data-number="99.3" class="anchored" data-anchor-id="solution-99"><span class="header-section-number">99.3</span> Solution</h2>
<div class="sourceCode" id="cb299"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform(text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(text)</span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>    rotations <span class="op">=</span> <span class="bu">sorted</span>([text[i:] <span class="op">+</span> text[:i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)])</span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>    bwt <span class="op">=</span> <span class="st">''</span>.join([rot[<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> rot <span class="kw">in</span> rotations])</span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bwt</span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_checkpoint_array(bwt: <span class="bu">str</span>, checkpoint_interval: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(bwt))</span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a>    checkpoint_array <span class="op">=</span> {}</span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(bwt), checkpoint_interval):</span>
<span id="cb299-13"><a href="#cb299-13" aria-hidden="true" tabindex="-1"></a>        checkpoint_array[idx] <span class="op">=</span> {symbol: bwt[:idx].count(symbol) <span class="cf">for</span> symbol <span class="kw">in</span> symbols}</span>
<span id="cb299-14"><a href="#cb299-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> checkpoint_array</span>
<span id="cb299-15"><a href="#cb299-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-16"><a href="#cb299-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_symbol(checkpoint_array: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]], idx: <span class="bu">int</span>, last_column: <span class="bu">str</span>, symbol: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb299-17"><a href="#cb299-17" aria-hidden="true" tabindex="-1"></a>    checkpoints <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> checkpoint_array.keys() <span class="cf">if</span> x <span class="op">&lt;=</span> idx]</span>
<span id="cb299-18"><a href="#cb299-18" aria-hidden="true" tabindex="-1"></a>    nearest_checkpoint <span class="op">=</span> <span class="bu">max</span>(checkpoints)</span>
<span id="cb299-19"><a href="#cb299-19" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> checkpoint_array[nearest_checkpoint][symbol]</span>
<span id="cb299-20"><a href="#cb299-20" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> last_column[nearest_checkpoint:idx].count(symbol)</span>
<span id="cb299-21"><a href="#cb299-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count</span>
<span id="cb299-22"><a href="#cb299-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-23"><a href="#cb299-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_partial_suffix_array(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb299-24"><a href="#cb299-24" aria-hidden="true" tabindex="-1"></a>    suffixes <span class="op">=</span> [(text[i:], i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))]</span>
<span id="cb299-25"><a href="#cb299-25" aria-hidden="true" tabindex="-1"></a>    sorted_suffixes <span class="op">=</span> <span class="bu">sorted</span>(suffixes)</span>
<span id="cb299-26"><a href="#cb299-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {i: pos <span class="cf">for</span> i, (_, pos) <span class="kw">in</span> <span class="bu">enumerate</span>(sorted_suffixes) <span class="cf">if</span> pos <span class="op">%</span> k <span class="op">==</span> <span class="dv">0</span>}</span>
<span id="cb299-27"><a href="#cb299-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-28"><a href="#cb299-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiple_pattern_matching(first_occurrence: Dict[<span class="bu">str</span>, <span class="bu">int</span>], last_column: <span class="bu">str</span>, pattern: <span class="bu">str</span>, checkpoint_array: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb299-29"><a href="#cb299-29" aria-hidden="true" tabindex="-1"></a>    top <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb299-30"><a href="#cb299-30" aria-hidden="true" tabindex="-1"></a>    bottom <span class="op">=</span> <span class="bu">len</span>(last_column) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb299-31"><a href="#cb299-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-32"><a href="#cb299-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> top <span class="op">&lt;=</span> bottom:</span>
<span id="cb299-33"><a href="#cb299-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pattern:</span>
<span id="cb299-34"><a href="#cb299-34" aria-hidden="true" tabindex="-1"></a>            symbol <span class="op">=</span> pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb299-35"><a href="#cb299-35" aria-hidden="true" tabindex="-1"></a>            pattern <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb299-36"><a href="#cb299-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> symbol <span class="kw">in</span> last_column[top: bottom <span class="op">+</span> <span class="dv">1</span>]:</span>
<span id="cb299-37"><a href="#cb299-37" aria-hidden="true" tabindex="-1"></a>                top <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count_symbol(checkpoint_array, top, last_column, symbol)</span>
<span id="cb299-38"><a href="#cb299-38" aria-hidden="true" tabindex="-1"></a>                bottom <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count_symbol(checkpoint_array, bottom <span class="op">+</span> <span class="dv">1</span>, last_column, symbol) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb299-39"><a href="#cb299-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb299-40"><a href="#cb299-40" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span></span>
<span id="cb299-41"><a href="#cb299-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb299-42"><a href="#cb299-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> top, bottom</span>
<span id="cb299-43"><a href="#cb299-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span></span>
<span id="cb299-44"><a href="#cb299-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-45"><a href="#cb299-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_occurrences(text: <span class="bu">str</span>, patterns: List[<span class="bu">str</span>], checkpoint_interval: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb299-46"><a href="#cb299-46" aria-hidden="true" tabindex="-1"></a>    bwt <span class="op">=</span> burrows_wheeler_transform(text <span class="op">+</span> <span class="st">'$'</span>)</span>
<span id="cb299-47"><a href="#cb299-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-48"><a href="#cb299-48" aria-hidden="true" tabindex="-1"></a>    first_occurrence <span class="op">=</span> {}</span>
<span id="cb299-49"><a href="#cb299-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">sorted</span>(bwt)):</span>
<span id="cb299-50"><a href="#cb299-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> symbol <span class="kw">not</span> <span class="kw">in</span> first_occurrence:</span>
<span id="cb299-51"><a href="#cb299-51" aria-hidden="true" tabindex="-1"></a>            first_occurrence[symbol] <span class="op">=</span> idx</span>
<span id="cb299-52"><a href="#cb299-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-53"><a href="#cb299-53" aria-hidden="true" tabindex="-1"></a>    checkpoint_array <span class="op">=</span> create_checkpoint_array(bwt, checkpoint_interval)</span>
<span id="cb299-54"><a href="#cb299-54" aria-hidden="true" tabindex="-1"></a>    partial_suffix_array <span class="op">=</span> create_partial_suffix_array(text <span class="op">+</span> <span class="st">'$'</span>, checkpoint_interval)</span>
<span id="cb299-55"><a href="#cb299-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-56"><a href="#cb299-56" aria-hidden="true" tabindex="-1"></a>    positions <span class="op">=</span> []</span>
<span id="cb299-57"><a href="#cb299-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb299-58"><a href="#cb299-58" aria-hidden="true" tabindex="-1"></a>        top, bottom <span class="op">=</span> multiple_pattern_matching(first_occurrence, bwt, pattern, checkpoint_array)</span>
<span id="cb299-59"><a href="#cb299-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> top <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb299-60"><a href="#cb299-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(top, bottom <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb299-61"><a href="#cb299-61" aria-hidden="true" tabindex="-1"></a>                offset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb299-62"><a href="#cb299-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> idx <span class="kw">not</span> <span class="kw">in</span> partial_suffix_array:</span>
<span id="cb299-63"><a href="#cb299-63" aria-hidden="true" tabindex="-1"></a>                    idx <span class="op">=</span> first_occurrence[bwt[idx]] <span class="op">+</span> count_symbol(checkpoint_array, idx, bwt, bwt[idx])</span>
<span id="cb299-64"><a href="#cb299-64" aria-hidden="true" tabindex="-1"></a>                    offset <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb299-65"><a href="#cb299-65" aria-hidden="true" tabindex="-1"></a>                positions.append(partial_suffix_array[idx] <span class="op">+</span> offset)</span>
<span id="cb299-66"><a href="#cb299-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-67"><a href="#cb299-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(positions)</span>
<span id="cb299-68"><a href="#cb299-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-69"><a href="#cb299-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb299-70"><a href="#cb299-70" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb299-71"><a href="#cb299-71" aria-hidden="true" tabindex="-1"></a><span class="st">AATCGGGTTCAATCGGGGT</span></span>
<span id="cb299-72"><a href="#cb299-72" aria-hidden="true" tabindex="-1"></a><span class="st">ATCG</span></span>
<span id="cb299-73"><a href="#cb299-73" aria-hidden="true" tabindex="-1"></a><span class="st">GGGT</span></span>
<span id="cb299-74"><a href="#cb299-74" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb299-75"><a href="#cb299-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-76"><a href="#cb299-76" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb299-77"><a href="#cb299-77" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb299-78"><a href="#cb299-78" aria-hidden="true" tabindex="-1"></a>patterns <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb299-79"><a href="#cb299-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-80"><a href="#cb299-80" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_pattern_occurrences(text, patterns)</span>
<span id="cb299-81"><a href="#cb299-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>.join(<span class="bu">str</span>(pos) <span class="cf">for</span> pos <span class="kw">in</span> result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-approximate-occurrences-of-a-collection-of-patterns-in-a-string" class="level1" data-number="100">
<h1 data-number="100"><span class="header-section-number">100</span> Find All Approximate Occurrences of a Collection of Patterns in a String</h1>
<p>Multiple Approximate Pattern Matching Problem. Find all approximate occurrences of a collection of patterns in a text.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>, a collection of strings&nbsp;<em>Patterns</em>, and an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All positions in&nbsp;<em>Text</em>&nbsp;where a string from&nbsp;<em>Patterns</em>&nbsp;appears as a substring with at most&nbsp;<em>d</em>&nbsp;mismatches.</p>
<section id="sample-dataset-100" class="level2" data-number="100.1">
<h2 data-number="100.1" class="anchored" data-anchor-id="sample-dataset-100"><span class="header-section-number">100.1</span> Sample Dataset</h2>
<pre><code>ACATGCTACTTT
ATT GCC GCTA TATT
1</code></pre>
</section>
<section id="sample-output-100" class="level2" data-number="100.2">
<h2 data-number="100.2" class="anchored" data-anchor-id="sample-output-100"><span class="header-section-number">100.2</span> Sample Output</h2>
<pre><code>2 4 4 6 7 8 9</code></pre>
</section>
<section id="solution-100" class="level2" data-number="100.3">
<h2 data-number="100.3" class="anchored" data-anchor-id="solution-100"><span class="header-section-number">100.3</span> Solution</h2>
<div class="sourceCode" id="cb302"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Iterator</span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>    suffixes: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {i: text[i:] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))}</span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(suffixes.keys(), key<span class="op">=</span><span class="kw">lambda</span> x: suffixes[x])</span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partial_suffix_array(sequence: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [(i, x) <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(suffix_array(sequence)) <span class="cf">if</span> x <span class="op">%</span> k <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join(sequence[i <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> suffix_array(sequence))</span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> accumulate</span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-17"><a href="#cb302-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> first_occurrence(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb302-18"><a href="#cb302-18" aria-hidden="true" tabindex="-1"></a>    unique_letters: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(sequence))</span>
<span id="cb302-19"><a href="#cb302-19" aria-hidden="true" tabindex="-1"></a>    counts: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(accumulate(sequence.count(x) <span class="cf">for</span> x <span class="kw">in</span> unique_letters))</span>
<span id="cb302-20"><a href="#cb302-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">dict</span>(<span class="bu">zip</span>(unique_letters, counts))</span>
<span id="cb302-21"><a href="#cb302-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-22"><a href="#cb302-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_symbols(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb302-23"><a href="#cb302-23" aria-hidden="true" tabindex="-1"></a>    count: List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb302-24"><a href="#cb302-24" aria-hidden="true" tabindex="-1"></a>    count.append(defaultdict(<span class="bu">int</span>))</span>
<span id="cb302-25"><a href="#cb302-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb302-26"><a href="#cb302-26" aria-hidden="true" tabindex="-1"></a>        count.append(copy(count[i]))</span>
<span id="cb302-27"><a href="#cb302-27" aria-hidden="true" tabindex="-1"></a>        count[i <span class="op">+</span> <span class="dv">1</span>][symbol] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb302-28"><a href="#cb302-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count</span>
<span id="cb302-29"><a href="#cb302-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-30"><a href="#cb302-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_location(row: <span class="bu">int</span>, psa: Dict[<span class="bu">int</span>, <span class="bu">int</span>], last_column: <span class="bu">str</span>, fo: Dict[<span class="bu">str</span>, <span class="bu">int</span>], cs: List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb302-31"><a href="#cb302-31" aria-hidden="true" tabindex="-1"></a>    steps: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb302-32"><a href="#cb302-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> row <span class="kw">not</span> <span class="kw">in</span> psa:</span>
<span id="cb302-33"><a href="#cb302-33" aria-hidden="true" tabindex="-1"></a>        predecessor: <span class="bu">str</span> <span class="op">=</span> last_column[row]</span>
<span id="cb302-34"><a href="#cb302-34" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> fo[predecessor] <span class="op">+</span> cs[row][predecessor]</span>
<span id="cb302-35"><a href="#cb302-35" aria-hidden="true" tabindex="-1"></a>        steps <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb302-36"><a href="#cb302-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> steps <span class="op">+</span> psa[row]</span>
<span id="cb302-37"><a href="#cb302-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-38"><a href="#cb302-38" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BWMatch:</span>
<span id="cb302-39"><a href="#cb302-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, sequence: <span class="bu">str</span>, k: <span class="bu">int</span> <span class="op">=</span> <span class="dv">10</span>):</span>
<span id="cb302-40"><a href="#cb302-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.psa: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> <span class="bu">dict</span>(partial_suffix_array(sequence <span class="op">+</span> <span class="st">"$"</span>, k))</span>
<span id="cb302-41"><a href="#cb302-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.sequence: <span class="bu">str</span> <span class="op">=</span> burrows_wheeler_transform(sequence <span class="op">+</span> <span class="st">"$"</span>)</span>
<span id="cb302-42"><a href="#cb302-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fo: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> first_occurrence(<span class="va">self</span>.sequence)</span>
<span id="cb302-43"><a href="#cb302-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cs: List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> count_symbols(<span class="va">self</span>.sequence)</span>
<span id="cb302-44"><a href="#cb302-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_mismatches: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb302-45"><a href="#cb302-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-46"><a href="#cb302-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update(<span class="va">self</span>, pointers: Tuple[<span class="bu">int</span>, <span class="bu">int</span>], x: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb302-47"><a href="#cb302-47" aria-hidden="true" tabindex="-1"></a>        top, bottom <span class="op">=</span> pointers</span>
<span id="cb302-48"><a href="#cb302-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="va">self</span>.fo[x] <span class="op">+</span> <span class="va">self</span>.cs[top][x], <span class="va">self</span>.fo[x] <span class="op">+</span> <span class="va">self</span>.cs[bottom <span class="op">+</span> <span class="dv">1</span>][x] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb302-49"><a href="#cb302-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-50"><a href="#cb302-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> bwm(<span class="va">self</span>, pattern: <span class="bu">str</span>, pointers: Tuple[<span class="bu">int</span>, <span class="bu">int</span>], mismatch_count: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb302-51"><a href="#cb302-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> pattern:</span>
<span id="cb302-52"><a href="#cb302-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">range</span>(pointers[<span class="dv">0</span>], pointers[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb302-53"><a href="#cb302-53" aria-hidden="true" tabindex="-1"></a>        matches: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb302-54"><a href="#cb302-54" aria-hidden="true" tabindex="-1"></a>        pattern, symbol <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>], pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb302-55"><a href="#cb302-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> symbol <span class="kw">in</span> <span class="va">self</span>.sequence[pointers[<span class="dv">0</span>] : pointers[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>]:</span>
<span id="cb302-56"><a href="#cb302-56" aria-hidden="true" tabindex="-1"></a>            matches <span class="op">+=</span> <span class="va">self</span>.bwm(pattern, <span class="va">self</span>.update(pointers, symbol), mismatch_count)</span>
<span id="cb302-57"><a href="#cb302-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mismatch_count <span class="op">&lt;</span> <span class="va">self</span>.max_mismatches:</span>
<span id="cb302-58"><a href="#cb302-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mismatch <span class="kw">in</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]:</span>
<span id="cb302-59"><a href="#cb302-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> mismatch <span class="op">!=</span> symbol:</span>
<span id="cb302-60"><a href="#cb302-60" aria-hidden="true" tabindex="-1"></a>                    matches <span class="op">+=</span> <span class="va">self</span>.bwm(pattern, <span class="va">self</span>.update(pointers, mismatch), mismatch_count <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb302-61"><a href="#cb302-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> matches</span>
<span id="cb302-62"><a href="#cb302-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-63"><a href="#cb302-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> match_patterns(<span class="va">self</span>, patterns: List[<span class="bu">str</span>], max_mismatches: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb302-64"><a href="#cb302-64" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_mismatches <span class="op">=</span> max_mismatches</span>
<span id="cb302-65"><a href="#cb302-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb302-66"><a href="#cb302-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> match <span class="kw">in</span> <span class="va">self</span>.bwm(pattern, (<span class="dv">0</span>, <span class="bu">len</span>(<span class="va">self</span>.sequence) <span class="op">-</span> <span class="dv">1</span>), <span class="dv">0</span>):</span>
<span id="cb302-67"><a href="#cb302-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> find_location(match, <span class="va">self</span>.psa, <span class="va">self</span>.sequence, <span class="va">self</span>.fo, <span class="va">self</span>.cs)</span>
<span id="cb302-68"><a href="#cb302-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-69"><a href="#cb302-69" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb302-70"><a href="#cb302-70" aria-hidden="true" tabindex="-1"></a><span class="st">ACATGCTACTTT</span></span>
<span id="cb302-71"><a href="#cb302-71" aria-hidden="true" tabindex="-1"></a><span class="st">ATT GCC GCTA TATT</span></span>
<span id="cb302-72"><a href="#cb302-72" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb302-73"><a href="#cb302-73" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb302-74"><a href="#cb302-74" aria-hidden="true" tabindex="-1"></a>sequence, patterns, mismatches <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb302-75"><a href="#cb302-75" aria-hidden="true" tabindex="-1"></a>patterns: List[<span class="bu">str</span>] <span class="op">=</span> patterns.split()</span>
<span id="cb302-76"><a href="#cb302-76" aria-hidden="true" tabindex="-1"></a>mismatches: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(mismatches)</span>
<span id="cb302-77"><a href="#cb302-77" aria-hidden="true" tabindex="-1"></a>matcher: BWMatch <span class="op">=</span> BWMatch(sequence)</span>
<span id="cb302-78"><a href="#cb302-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(matcher.match_patterns(patterns, mismatches)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-treecoloring" class="level1" data-number="101">
<h1 data-number="101"><span class="header-section-number">101</span> Implement TreeColoring</h1>
<p>Tree Coloring Problem. Color the internal nodes of a suffix tree given colors of the leaves.</p>
<p>Given:&nbsp;An&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>, followed by color labels for leaf nodes.</p>
<p>Return:&nbsp;Color labels for all nodes, in any order.</p>
<section id="sample-dataset-101" class="level2" data-number="101.1">
<h2 data-number="101.1" class="anchored" data-anchor-id="sample-dataset-101"><span class="header-section-number">101.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; {}
1 -&gt; {}
2 -&gt; 0,1
3 -&gt; {}
4 -&gt; {}
5 -&gt; 3,2
6 -&gt; {}
7 -&gt; 4,5,6
-
0: red
1: red
3: blue
4: blue
6: red</code></pre>
</section>
<section id="sample-output-101" class="level2" data-number="101.2">
<h2 data-number="101.2" class="anchored" data-anchor-id="sample-output-101"><span class="header-section-number">101.2</span> Sample Output</h2>
<pre><code>0: red
1: red
2: red
3: blue
4: blue
5: purple
6: red
7: purple</code></pre>
</section>
<section id="solution-101" class="level2" data-number="101.3">
<h2 data-number="101.3" class="anchored" data-anchor-id="solution-101"><span class="header-section-number">101.3</span> Solution</h2>
<div class="sourceCode" id="cb305"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Union, TextIO</span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_tree(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], node_colors: Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]]:</span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>    uncolored_nodes <span class="op">=</span> <span class="bu">list</span>(tree.keys())</span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> uncolored_nodes:</span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(uncolored_nodes):  <span class="co"># Create a copy of uncolored_nodes to iterate over</span></span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>            child_colors <span class="op">=</span> [node_colors[child[<span class="st">"n"</span>]] <span class="cf">for</span> child <span class="kw">in</span> tree[node] <span class="cf">if</span> node_colors[child[<span class="st">"n"</span>]] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>]</span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(child_colors) <span class="op">==</span> <span class="bu">len</span>(tree[node]):  <span class="co"># Check if all children are colored</span></span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">all</span>(color <span class="op">==</span> <span class="st">"red"</span> <span class="cf">for</span> color <span class="kw">in</span> child_colors):</span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a>                    node_colors[node] <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="bu">all</span>(color <span class="op">==</span> <span class="st">"blue"</span> <span class="cf">for</span> color <span class="kw">in</span> child_colors):</span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a>                    node_colors[node] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true" tabindex="-1"></a>                    node_colors[node] <span class="op">=</span> <span class="st">"purple"</span></span>
<span id="cb305-17"><a href="#cb305-17" aria-hidden="true" tabindex="-1"></a>                uncolored_nodes.remove(node)</span>
<span id="cb305-18"><a href="#cb305-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node_colors</span>
<span id="cb305-19"><a href="#cb305-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-20"><a href="#cb305-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: Union[<span class="bu">str</span>, TextIO]) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]]]:</span>
<span id="cb305-21"><a href="#cb305-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(input_data, <span class="bu">str</span>):</span>
<span id="cb305-22"><a href="#cb305-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="kw">in</span> input_data:</span>
<span id="cb305-23"><a href="#cb305-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If input_data contains newlines, treat it as a string input</span></span>
<span id="cb305-24"><a href="#cb305-24" aria-hidden="true" tabindex="-1"></a>            file_obj <span class="op">=</span> io.StringIO(input_data)</span>
<span id="cb305-25"><a href="#cb305-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb305-26"><a href="#cb305-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Otherwise, treat it as a filename</span></span>
<span id="cb305-27"><a href="#cb305-27" aria-hidden="true" tabindex="-1"></a>            file_obj <span class="op">=</span> <span class="bu">open</span>(input_data)</span>
<span id="cb305-28"><a href="#cb305-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">isinstance</span>(input_data, TextIO):</span>
<span id="cb305-29"><a href="#cb305-29" aria-hidden="true" tabindex="-1"></a>        file_obj <span class="op">=</span> input_data</span>
<span id="cb305-30"><a href="#cb305-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb305-31"><a href="#cb305-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Input must be a filename, a string, or a file-like object"</span>)</span>
<span id="cb305-32"><a href="#cb305-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-33"><a href="#cb305-33" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb305-34"><a href="#cb305-34" aria-hidden="true" tabindex="-1"></a>    node_colors: Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="va">None</span>)</span>
<span id="cb305-35"><a href="#cb305-35" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb305-36"><a href="#cb305-36" aria-hidden="true" tabindex="-1"></a>    parsing_tree <span class="op">=</span> <span class="va">True</span></span>
<span id="cb305-37"><a href="#cb305-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_obj:</span>
<span id="cb305-38"><a href="#cb305-38" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> line.strip()</span>
<span id="cb305-39"><a href="#cb305-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb305-40"><a href="#cb305-40" aria-hidden="true" tabindex="-1"></a>            parsing_tree <span class="op">=</span> <span class="va">False</span></span>
<span id="cb305-41"><a href="#cb305-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb305-42"><a href="#cb305-42" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb305-43"><a href="#cb305-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> parsing_tree:</span>
<span id="cb305-44"><a href="#cb305-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">" -&gt; "</span> <span class="kw">in</span> line:</span>
<span id="cb305-45"><a href="#cb305-45" aria-hidden="true" tabindex="-1"></a>                parent, children <span class="op">=</span> line.split(<span class="st">" -&gt; "</span>)</span>
<span id="cb305-46"><a href="#cb305-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> children <span class="op">!=</span> <span class="st">"</span><span class="sc">{}</span><span class="st">"</span>:</span>
<span id="cb305-47"><a href="#cb305-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> child <span class="kw">in</span> children.split(<span class="st">","</span>):</span>
<span id="cb305-48"><a href="#cb305-48" aria-hidden="true" tabindex="-1"></a>                        tree[<span class="bu">int</span>(parent)].append({<span class="st">"n"</span>: <span class="bu">int</span>(child)})</span>
<span id="cb305-49"><a href="#cb305-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb305-50"><a href="#cb305-50" aria-hidden="true" tabindex="-1"></a>            node, color <span class="op">=</span> line.split(<span class="st">": "</span>)</span>
<span id="cb305-51"><a href="#cb305-51" aria-hidden="true" tabindex="-1"></a>            node_colors[<span class="bu">int</span>(node)] <span class="op">=</span> color</span>
<span id="cb305-52"><a href="#cb305-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-53"><a href="#cb305-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(input_data, <span class="bu">str</span>) <span class="kw">and</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="kw">not</span> <span class="kw">in</span> input_data:</span>
<span id="cb305-54"><a href="#cb305-54" aria-hidden="true" tabindex="-1"></a>        file_obj.close()</span>
<span id="cb305-55"><a href="#cb305-55" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb305-56"><a href="#cb305-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree, node_colors</span>
<span id="cb305-57"><a href="#cb305-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-58"><a href="#cb305-58" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb305-59"><a href="#cb305-59" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-60"><a href="#cb305-60" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-61"><a href="#cb305-61" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 0,1</span></span>
<span id="cb305-62"><a href="#cb305-62" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-63"><a href="#cb305-63" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-64"><a href="#cb305-64" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 3,2</span></span>
<span id="cb305-65"><a href="#cb305-65" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-66"><a href="#cb305-66" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 4,5,6</span></span>
<span id="cb305-67"><a href="#cb305-67" aria-hidden="true" tabindex="-1"></a><span class="st">-</span></span>
<span id="cb305-68"><a href="#cb305-68" aria-hidden="true" tabindex="-1"></a><span class="st">0: red</span></span>
<span id="cb305-69"><a href="#cb305-69" aria-hidden="true" tabindex="-1"></a><span class="st">1: red</span></span>
<span id="cb305-70"><a href="#cb305-70" aria-hidden="true" tabindex="-1"></a><span class="st">3: blue</span></span>
<span id="cb305-71"><a href="#cb305-71" aria-hidden="true" tabindex="-1"></a><span class="st">4: blue</span></span>
<span id="cb305-72"><a href="#cb305-72" aria-hidden="true" tabindex="-1"></a><span class="st">6: red</span></span>
<span id="cb305-73"><a href="#cb305-73" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb305-74"><a href="#cb305-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-75"><a href="#cb305-75" aria-hidden="true" tabindex="-1"></a>tree, node_colors <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb305-76"><a href="#cb305-76" aria-hidden="true" tabindex="-1"></a>colored_tree <span class="op">=</span> color_tree(tree, node_colors)</span>
<span id="cb305-77"><a href="#cb305-77" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node <span class="kw">in</span> <span class="bu">sorted</span>(colored_tree.keys()):</span>
<span id="cb305-78"><a href="#cb305-78" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>colored_tree[node]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-partial-suffix-array-of-a-string" class="level1" data-number="102">
<h1 data-number="102"><span class="header-section-number">102</span> Construct the Partial Suffix Array of a String</h1>
<p>Partial Suffix Array Construction Problem. Construct the partial suffix array of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;and a positive integer&nbsp;<em>K</em>.</p>
<p>Return:&nbsp;*SuffixArray__K<em>(</em>Text<em>), in the form of a list of ordered pairs (</em>i<em>,&nbsp;</em>SuffixArray<em>(</em>i*)) for all nonempty entries in the partial suffix array.</p>
<section id="sample-dataset-102" class="level2" data-number="102.1">
<h2 data-number="102.1" class="anchored" data-anchor-id="sample-dataset-102"><span class="header-section-number">102.1</span> Sample Dataset</h2>
<pre><code>PANAMABANANAS$
5</code></pre>
</section>
<section id="sample-output-102" class="level2" data-number="102.2">
<h2 data-number="102.2" class="anchored" data-anchor-id="sample-output-102"><span class="header-section-number">102.2</span> Sample Output</h2>
<pre><code>1,5
11,10
12,0</code></pre>
</section>
<section id="solution-102" class="level2" data-number="102.3">
<h2 data-number="102.3" class="anchored" data-anchor-id="solution-102"><span class="header-section-number">102.3</span> Solution</h2>
<div class="sourceCode" id="cb308"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>    suffixes: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {i: text[i:] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))}</span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(suffixes.keys(), key<span class="op">=</span><span class="kw">lambda</span> x: suffixes[x])</span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partial_suffix_array(sequence: <span class="bu">str</span>, step: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [(index, position) <span class="cf">for</span> index, position <span class="kw">in</span> <span class="bu">enumerate</span>(suffix_array(sequence)) <span class="cf">if</span> position <span class="op">%</span> step <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-10"><a href="#cb308-10" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb308-11"><a href="#cb308-11" aria-hidden="true" tabindex="-1"></a><span class="st">PANAMABANANAS$</span></span>
<span id="cb308-12"><a href="#cb308-12" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb308-13"><a href="#cb308-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb308-14"><a href="#cb308-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-15"><a href="#cb308-15" aria-hidden="true" tabindex="-1"></a>sequence, step_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb308-16"><a href="#cb308-16" aria-hidden="true" tabindex="-1"></a>step: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(step_str)</span>
<span id="cb308-17"><a href="#cb308-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-18"><a href="#cb308-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> entry <span class="kw">in</span> partial_suffix_array(sequence, step):</span>
<span id="cb308-19"><a href="#cb308-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>entry, sep<span class="op">=</span><span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-suffix-tree-from-a-suffix-array" class="level1" data-number="103">
<h1 data-number="103"><span class="header-section-number">103</span> Construct a Suffix Tree from a Suffix Array</h1>
<p>Suffix Tree Construction from Suffix Array Problem. Construct a suffix tree from the suffix array and LCP array of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>,&nbsp;<em>SuffixArray</em>(<em>Text</em>), and&nbsp;<em>LCP</em>(<em>Text</em>).</p>
<p>Return:&nbsp;The strings labeling the edges of&nbsp;<em>SuffixTree</em>(<em>Text</em>). (You may return these strings in any order.)</p>
<section id="sample-dataset-103" class="level2" data-number="103.1">
<h2 data-number="103.1" class="anchored" data-anchor-id="sample-dataset-103"><span class="header-section-number">103.1</span> Sample Dataset</h2>
<pre><code>GTAGT$
5, 2, 3, 0, 4, 1
0, 0, 0, 2, 0, 1</code></pre>
</section>
<section id="sample-output-103" class="level2" data-number="103.2">
<h2 data-number="103.2" class="anchored" data-anchor-id="sample-output-103"><span class="header-section-number">103.2</span> Sample Output</h2>
<pre><code>$
$
$
AGT$
AGT$
AGT$
GT
T</code></pre>
</section>
<section id="solution-103" class="level2" data-number="103.3">
<h2 data-number="103.3" class="anchored" data-anchor-id="solution-103"><span class="header-section-number">103.3</span> Solution</h2>
<div class="sourceCode" id="cb311"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Union</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Node:</span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, parent: Union[<span class="bu">int</span>, <span class="bu">str</span>, <span class="va">None</span>] <span class="op">=</span> <span class="va">None</span>, label: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span>):</span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.parent: Union[<span class="bu">int</span>, <span class="bu">str</span>, <span class="va">None</span>] <span class="op">=</span> parent</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label: <span class="bu">str</span> <span class="op">=</span> label</span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_depth(tree: Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node], node: Union[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate the length of the concatenation of all path labels from the root to node</span></span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a>    depth: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(tree[node].label)</span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> tree[node].parent <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> tree[node].parent</span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a>        depth <span class="op">+=</span> <span class="bu">len</span>(tree[node].label)</span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> depth</span>
<span id="cb311-17"><a href="#cb311-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-18"><a href="#cb311-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_suffix_tree(text: <span class="bu">str</span>, suffix_array: List[<span class="bu">int</span>], lcp_array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node]:</span>
<span id="cb311-19"><a href="#cb311-19" aria-hidden="true" tabindex="-1"></a>    tree: Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node] <span class="op">=</span> {<span class="op">-</span><span class="dv">1</span>: Node()}</span>
<span id="cb311-20"><a href="#cb311-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-21"><a href="#cb311-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text)):</span>
<span id="cb311-22"><a href="#cb311-22" aria-hidden="true" tabindex="-1"></a>        current_node: <span class="bu">int</span> <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb311-23"><a href="#cb311-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> tree[current_node].parent <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> calculate_depth(tree, current_node) <span class="op">&gt;</span> lcp_array[i]:</span>
<span id="cb311-24"><a href="#cb311-24" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> tree[current_node].parent</span>
<span id="cb311-25"><a href="#cb311-25" aria-hidden="true" tabindex="-1"></a>        current_depth: <span class="bu">int</span> <span class="op">=</span> calculate_depth(tree, current_node)</span>
<span id="cb311-26"><a href="#cb311-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-27"><a href="#cb311-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> lcp_array[i] <span class="op">==</span> current_depth:</span>
<span id="cb311-28"><a href="#cb311-28" aria-hidden="true" tabindex="-1"></a>            tree[i] <span class="op">=</span> Node(current_node, text[suffix_array[i] <span class="op">+</span> lcp_array[i]:])</span>
<span id="cb311-29"><a href="#cb311-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb311-30"><a href="#cb311-30" aria-hidden="true" tabindex="-1"></a>            temp_node: <span class="bu">int</span> <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb311-31"><a href="#cb311-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> tree[temp_node].parent <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> tree[temp_node].parent <span class="op">!=</span> current_node:</span>
<span id="cb311-32"><a href="#cb311-32" aria-hidden="true" tabindex="-1"></a>                temp_node <span class="op">=</span> tree[temp_node].parent</span>
<span id="cb311-33"><a href="#cb311-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-34"><a href="#cb311-34" aria-hidden="true" tabindex="-1"></a>            new_node_key: <span class="bu">str</span> <span class="op">=</span> <span class="ss">f"y</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb311-35"><a href="#cb311-35" aria-hidden="true" tabindex="-1"></a>            tree[new_node_key] <span class="op">=</span> Node(current_node, text[suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> current_depth : suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> lcp_array[i]])</span>
<span id="cb311-36"><a href="#cb311-36" aria-hidden="true" tabindex="-1"></a>            tree[temp_node] <span class="op">=</span> Node(new_node_key, text[suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> lcp_array[i] : suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> calculate_depth(tree, temp_node)])</span>
<span id="cb311-37"><a href="#cb311-37" aria-hidden="true" tabindex="-1"></a>            tree[i] <span class="op">=</span> Node(new_node_key, text[suffix_array[i] <span class="op">+</span> lcp_array[i]:])</span>
<span id="cb311-38"><a href="#cb311-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-39"><a href="#cb311-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> tree[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb311-40"><a href="#cb311-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb311-41"><a href="#cb311-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-42"><a href="#cb311-42" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb311-43"><a href="#cb311-43" aria-hidden="true" tabindex="-1"></a><span class="st">GTAGT$</span></span>
<span id="cb311-44"><a href="#cb311-44" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2, 3, 0, 4, 1</span></span>
<span id="cb311-45"><a href="#cb311-45" aria-hidden="true" tabindex="-1"></a><span class="st">0, 0, 0, 2, 0, 1</span></span>
<span id="cb311-46"><a href="#cb311-46" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb311-47"><a href="#cb311-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-48"><a href="#cb311-48" aria-hidden="true" tabindex="-1"></a>text, suffix_array_str, lcp_array_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb311-49"><a href="#cb311-49" aria-hidden="true" tabindex="-1"></a>suffix_array: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> suffix_array_str.split(<span class="st">", "</span>)]</span>
<span id="cb311-50"><a href="#cb311-50" aria-hidden="true" tabindex="-1"></a>lcp_array: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> lcp_array_str.split(<span class="st">", "</span>)]</span>
<span id="cb311-51"><a href="#cb311-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-52"><a href="#cb311-52" aria-hidden="true" tabindex="-1"></a>suffix_tree: Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node] <span class="op">=</span> construct_suffix_tree(text, suffix_array, lcp_array)</span>
<span id="cb311-53"><a href="#cb311-53" aria-hidden="true" tabindex="-1"></a>labels: List[<span class="bu">str</span>] <span class="op">=</span> [suffix_tree[key].label <span class="cf">for</span> key <span class="kw">in</span> suffix_tree.keys()]</span>
<span id="cb311-54"><a href="#cb311-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(labels), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-a-hidden-path" class="level1" data-number="104">
<h1 data-number="104"><span class="header-section-number">104</span> Compute the Probability of a Hidden Path</h1>
<p>Given:&nbsp;A hidden path <span class="math inline">\(π\)</span> followed by the states&nbsp;<em>States</em>&nbsp;and transition matrix&nbsp;<em>Transition</em>&nbsp;of an HMM (<span class="math inline">\(Σ\)</span>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability of this path, <span class="math inline">\(Pr(π)\)</span>. You may assume that initial probabilities are equal.</p>
<section id="sample-dataset-104" class="level2" data-number="104.1">
<h2 data-number="104.1" class="anchored" data-anchor-id="sample-dataset-104"><span class="header-section-number">104.1</span> Sample Dataset</h2>
<pre><code>AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB
--------
A   B
--------
    A   B
A   0.194   0.806
B   0.273   0.727</code></pre>
</section>
<section id="sample-output-104" class="level2" data-number="104.2">
<h2 data-number="104.2" class="anchored" data-anchor-id="sample-output-104"><span class="header-section-number">104.2</span> Sample Output</h2>
<pre><code>5.01732865318e-19</code></pre>
</section>
<section id="solution-104" class="level2" data-number="104.3">
<h2 data-number="104.3" class="anchored" data-anchor-id="solution-104"><span class="header-section-number">104.3</span> Solution</h2>
<div class="sourceCode" id="cb314"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hidden_path_data(input_lines):</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a>    transition_probabilities <span class="op">=</span> {}</span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true" tabindex="-1"></a>            current_state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> next_state, probability <span class="kw">in</span> <span class="bu">zip</span>(states, row_data[<span class="dv">1</span>:]):</span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true" tabindex="-1"></a>                transition_probabilities[(current_state, next_state)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb314-18"><a href="#cb314-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb314-19"><a href="#cb314-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hidden_path, transition_probabilities</span>
<span id="cb314-20"><a href="#cb314-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-21"><a href="#cb314-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hidden_path_probability(hidden_path, transition_probabilities):</span>
<span id="cb314-22"><a href="#cb314-22" aria-hidden="true" tabindex="-1"></a>    initial_probability <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb314-23"><a href="#cb314-23" aria-hidden="true" tabindex="-1"></a>    path_probability <span class="op">=</span> initial_probability <span class="op">*</span> prod(</span>
<span id="cb314-24"><a href="#cb314-24" aria-hidden="true" tabindex="-1"></a>        transition_probabilities[state_pair] </span>
<span id="cb314-25"><a href="#cb314-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> state_pair <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, hidden_path[<span class="dv">1</span>:])</span>
<span id="cb314-26"><a href="#cb314-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb314-27"><a href="#cb314-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_probability</span>
<span id="cb314-28"><a href="#cb314-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-29"><a href="#cb314-29" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb314-30"><a href="#cb314-30" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span></span>
<span id="cb314-31"><a href="#cb314-31" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb314-32"><a href="#cb314-32" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb314-33"><a href="#cb314-33" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb314-34"><a href="#cb314-34" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb314-35"><a href="#cb314-35" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.194   0.806</span></span>
<span id="cb314-36"><a href="#cb314-36" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.273   0.727</span></span>
<span id="cb314-37"><a href="#cb314-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb314-38"><a href="#cb314-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-39"><a href="#cb314-39" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb314-40"><a href="#cb314-40" aria-hidden="true" tabindex="-1"></a>hidden_path, transition_probabilities <span class="op">=</span> parse_hidden_path_data(input_lines)</span>
<span id="cb314-41"><a href="#cb314-41" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_hidden_path_probability(hidden_path, transition_probabilities)</span>
<span id="cb314-42"><a href="#cb314-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-an-outcome-given-a-hidden-path" class="level1" data-number="105">
<h1 data-number="105"><span class="header-section-number">105</span> Compute the Probability of an Outcome Given a Hidden Path</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by a hidden path&nbsp;<em>π</em>, followed by the states&nbsp;<em>States</em>&nbsp;and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The conditional probability <span class="math inline">\(Pr(x|π)\)</span> that string&nbsp;<em>x</em>&nbsp;will be emitted by the HMM given the hidden path&nbsp;<em>π</em>.</p>
<section id="sample-dataset-105" class="level2" data-number="105.1">
<h2 data-number="105.1" class="anchored" data-anchor-id="sample-dataset-105"><span class="header-section-number">105.1</span> Sample Dataset</h2>
<pre><code>xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx
--------
x   y   z
--------
BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB
--------
A   B
--------
    x   y   z
A   0.612   0.314   0.074 
B   0.346   0.317   0.336</code></pre>
</section>
<section id="sample-output-105" class="level2" data-number="105.2">
<h2 data-number="105.2" class="anchored" data-anchor-id="sample-output-105"><span class="header-section-number">105.2</span> Sample Output</h2>
<pre><code>1.93157070893e-28</code></pre>
</section>
<section id="solution-105" class="level2" data-number="105.3">
<h2 data-number="105.3" class="anchored" data-anchor-id="solution-105"><span class="header-section-number">105.3</span> Solution</h2>
<div class="sourceCode" id="cb317"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_emission_data(input_lines):</span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>    emission_sequence <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb317-9"><a href="#cb317-9" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb317-10"><a href="#cb317-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb317-11"><a href="#cb317-11" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb317-12"><a href="#cb317-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb317-13"><a href="#cb317-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb317-14"><a href="#cb317-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb317-15"><a href="#cb317-15" aria-hidden="true" tabindex="-1"></a>    emission_probabilities <span class="op">=</span> {}</span>
<span id="cb317-16"><a href="#cb317-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb317-17"><a href="#cb317-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb317-18"><a href="#cb317-18" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb317-19"><a href="#cb317-19" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb317-20"><a href="#cb317-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> symbol, probability <span class="kw">in</span> <span class="bu">zip</span>(symbols, row_data[<span class="dv">1</span>:]):</span>
<span id="cb317-21"><a href="#cb317-21" aria-hidden="true" tabindex="-1"></a>                emission_probabilities[(state, symbol)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb317-22"><a href="#cb317-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb317-23"><a href="#cb317-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emission_sequence, hidden_path, emission_probabilities</span>
<span id="cb317-24"><a href="#cb317-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-25"><a href="#cb317-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities):</span>
<span id="cb317-26"><a href="#cb317-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prod(emission_probabilities[state_symbol] <span class="cf">for</span> state_symbol <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, emission_sequence))</span>
<span id="cb317-27"><a href="#cb317-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-28"><a href="#cb317-28" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb317-29"><a href="#cb317-29" aria-hidden="true" tabindex="-1"></a><span class="st">xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span></span>
<span id="cb317-30"><a href="#cb317-30" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb317-31"><a href="#cb317-31" aria-hidden="true" tabindex="-1"></a><span class="st">x y z</span></span>
<span id="cb317-32"><a href="#cb317-32" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb317-33"><a href="#cb317-33" aria-hidden="true" tabindex="-1"></a><span class="st">BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span></span>
<span id="cb317-34"><a href="#cb317-34" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb317-35"><a href="#cb317-35" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb317-36"><a href="#cb317-36" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb317-37"><a href="#cb317-37" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb317-38"><a href="#cb317-38" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.612   0.314   0.074 </span></span>
<span id="cb317-39"><a href="#cb317-39" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.346   0.317   0.336</span></span>
<span id="cb317-40"><a href="#cb317-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb317-41"><a href="#cb317-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-42"><a href="#cb317-42" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb317-43"><a href="#cb317-43" aria-hidden="true" tabindex="-1"></a>emission_sequence, hidden_path, emission_probabilities <span class="op">=</span> parse_emission_data(input_lines)</span>
<span id="cb317-44"><a href="#cb317-44" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities)</span>
<span id="cb317-45"><a href="#cb317-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-viterbi-algorithm" class="level1" data-number="106">
<h1 data-number="106"><span class="header-section-number">106</span> Implement the Viterbi Algorithm</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;A path that maximizes the (unconditional) probability Pr(<em>x</em>,&nbsp;<em>π</em>) over all possible paths&nbsp;<em>π</em>.</p>
<section id="sample-dataset-106" class="level2" data-number="106.1">
<h2 data-number="106.1" class="anchored" data-anchor-id="sample-dataset-106"><span class="header-section-number">106.1</span> Sample Dataset</h2>
<pre><code>xyxzzxyxyy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.641   0.359
B   0.729   0.271
--------
    x   y   z
A   0.117   0.691   0.192   
B   0.097   0.42    0.483</code></pre>
</section>
<section id="sample-output-106" class="level2" data-number="106.2">
<h2 data-number="106.2" class="anchored" data-anchor-id="sample-output-106"><span class="header-section-number">106.2</span> Sample Output</h2>
<pre><code>AAABBAAAAA</code></pre>
</section>
<section id="solution-106" class="level2" data-number="106.3">
<h2 data-number="106.3" class="anchored" data-anchor-id="solution-106"><span class="header-section-number">106.3</span> Solution</h2>
<div class="sourceCode" id="cb320"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb320-11"><a href="#cb320-11" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb320-12"><a href="#cb320-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb320-13"><a href="#cb320-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb320-14"><a href="#cb320-14" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb320-15"><a href="#cb320-15" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb320-16"><a href="#cb320-16" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb320-17"><a href="#cb320-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb320-18"><a href="#cb320-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb320-19"><a href="#cb320-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb320-20"><a href="#cb320-20" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb320-21"><a href="#cb320-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb320-22"><a href="#cb320-22" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb320-23"><a href="#cb320-23" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb320-24"><a href="#cb320-24" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb320-25"><a href="#cb320-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb320-26"><a href="#cb320-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb320-27"><a href="#cb320-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb320-28"><a href="#cb320-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb320-29"><a href="#cb320-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb320-30"><a href="#cb320-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-31"><a href="#cb320-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb320-32"><a href="#cb320-32" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> <span class="bu">len</span>(states)</span>
<span id="cb320-33"><a href="#cb320-33" aria-hidden="true" tabindex="-1"></a>    sequence_length <span class="op">=</span> <span class="bu">len</span>(sequence)</span>
<span id="cb320-34"><a href="#cb320-34" aria-hidden="true" tabindex="-1"></a>    viterbi_matrix <span class="op">=</span> np.zeros((sequence_length, num_states))</span>
<span id="cb320-35"><a href="#cb320-35" aria-hidden="true" tabindex="-1"></a>    backpointer <span class="op">=</span> np.zeros((sequence_length, num_states), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb320-36"><a href="#cb320-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-37"><a href="#cb320-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the first column of the viterbi matrix</span></span>
<span id="cb320-38"><a href="#cb320-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb320-39"><a href="#cb320-39" aria-hidden="true" tabindex="-1"></a>        viterbi_matrix[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> num_states)</span>
<span id="cb320-40"><a href="#cb320-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-41"><a href="#cb320-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill in the rest of the viterbi matrix</span></span>
<span id="cb320-42"><a href="#cb320-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, sequence_length):</span>
<span id="cb320-43"><a href="#cb320-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb320-44"><a href="#cb320-44" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> [</span>
<span id="cb320-45"><a href="#cb320-45" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[previous_state, current_state]) <span class="op">+</span> </span>
<span id="cb320-46"><a href="#cb320-46" aria-hidden="true" tabindex="-1"></a>                log(emission_matrix[current_state, sequence[t]]) <span class="op">+</span> </span>
<span id="cb320-47"><a href="#cb320-47" aria-hidden="true" tabindex="-1"></a>                viterbi_matrix[t<span class="op">-</span><span class="dv">1</span>, k]</span>
<span id="cb320-48"><a href="#cb320-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb320-49"><a href="#cb320-49" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb320-50"><a href="#cb320-50" aria-hidden="true" tabindex="-1"></a>            max_prob_index <span class="op">=</span> probabilities.index(<span class="bu">max</span>(probabilities))</span>
<span id="cb320-51"><a href="#cb320-51" aria-hidden="true" tabindex="-1"></a>            backpointer[t, j] <span class="op">=</span> max_prob_index</span>
<span id="cb320-52"><a href="#cb320-52" aria-hidden="true" tabindex="-1"></a>            viterbi_matrix[t, j] <span class="op">=</span> <span class="bu">max</span>(probabilities)</span>
<span id="cb320-53"><a href="#cb320-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-54"><a href="#cb320-54" aria-hidden="true" tabindex="-1"></a>    best_path_index <span class="op">=</span> np.argmax(viterbi_matrix[<span class="op">-</span><span class="dv">1</span>, :])</span>
<span id="cb320-55"><a href="#cb320-55" aria-hidden="true" tabindex="-1"></a>    best_path <span class="op">=</span> states[best_path_index]</span>
<span id="cb320-56"><a href="#cb320-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(sequence_length <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb320-57"><a href="#cb320-57" aria-hidden="true" tabindex="-1"></a>        best_path_index <span class="op">=</span> backpointer[t, best_path_index]</span>
<span id="cb320-58"><a href="#cb320-58" aria-hidden="true" tabindex="-1"></a>        best_path <span class="op">=</span> states[best_path_index] <span class="op">+</span> best_path</span>
<span id="cb320-59"><a href="#cb320-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-60"><a href="#cb320-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_path</span>
<span id="cb320-61"><a href="#cb320-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-62"><a href="#cb320-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb320-63"><a href="#cb320-63" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb320-64"><a href="#cb320-64" aria-hidden="true" tabindex="-1"></a><span class="st">xyxzzxyxyy</span></span>
<span id="cb320-65"><a href="#cb320-65" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb320-66"><a href="#cb320-66" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb320-67"><a href="#cb320-67" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb320-68"><a href="#cb320-68" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb320-69"><a href="#cb320-69" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb320-70"><a href="#cb320-70" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb320-71"><a href="#cb320-71" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.641   0.359</span></span>
<span id="cb320-72"><a href="#cb320-72" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.729   0.271</span></span>
<span id="cb320-73"><a href="#cb320-73" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb320-74"><a href="#cb320-74" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb320-75"><a href="#cb320-75" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.117   0.691   0.192   </span></span>
<span id="cb320-76"><a href="#cb320-76" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.097   0.42    0.483</span></span>
<span id="cb320-77"><a href="#cb320-77" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb320-78"><a href="#cb320-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-79"><a href="#cb320-79" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb320-80"><a href="#cb320-80" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb320-81"><a href="#cb320-81" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb320-82"><a href="#cb320-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-a-string-emitted-by-an-hmm" class="level1" data-number="107">
<h1 data-number="107"><span class="header-section-number">107</span> Compute the Probability of a String Emitted by an HMM</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability Pr(<em>x</em>) that the HMM emits&nbsp;<em>x</em>.</p>
<section id="sample-dataset-107" class="level2" data-number="107.1">
<h2 data-number="107.1" class="anchored" data-anchor-id="sample-dataset-107"><span class="header-section-number">107.1</span> Sample Dataset</h2>
<pre><code>xzyyzzyzyy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.303   0.697 
B   0.831   0.169 
--------
    x   y   z
A   0.533   0.065   0.402 
B   0.342   0.334   0.324</code></pre>
</section>
<section id="sample-output-107" class="level2" data-number="107.2">
<h2 data-number="107.2" class="anchored" data-anchor-id="sample-output-107"><span class="header-section-number">107.2</span> Sample Output</h2>
<pre><code>1.1005510319694847e-06</code></pre>
</section>
<section id="solution-107" class="level2" data-number="107.3">
<h2 data-number="107.3" class="anchored" data-anchor-id="solution-107"><span class="header-section-number">107.3</span> Solution</h2>
<div class="sourceCode" id="cb323"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator):</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb323-14"><a href="#cb323-14" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb323-15"><a href="#cb323-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb323-16"><a href="#cb323-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb323-17"><a href="#cb323-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb323-18"><a href="#cb323-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb323-19"><a href="#cb323-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb323-20"><a href="#cb323-20" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb323-21"><a href="#cb323-21" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb323-22"><a href="#cb323-22" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb323-23"><a href="#cb323-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb323-24"><a href="#cb323-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb323-25"><a href="#cb323-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb323-26"><a href="#cb323-26" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb323-27"><a href="#cb323-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb323-28"><a href="#cb323-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-29"><a href="#cb323-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix):</span>
<span id="cb323-30"><a href="#cb323-30" aria-hidden="true" tabindex="-1"></a>    probability_matrix <span class="op">=</span> np.ones((<span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(states)))</span>
<span id="cb323-31"><a href="#cb323-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-32"><a href="#cb323-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb323-33"><a href="#cb323-33" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>, i] <span class="op">=</span> emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states)</span>
<span id="cb323-34"><a href="#cb323-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-35"><a href="#cb323-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb323-36"><a href="#cb323-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb323-37"><a href="#cb323-37" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb323-38"><a href="#cb323-38" aria-hidden="true" tabindex="-1"></a>                transition_matrix[previous_state, current_state] <span class="op">*</span> </span>
<span id="cb323-39"><a href="#cb323-39" aria-hidden="true" tabindex="-1"></a>                emission_matrix[current_state, emission] <span class="op">*</span> </span>
<span id="cb323-40"><a href="#cb323-40" aria-hidden="true" tabindex="-1"></a>                probability_matrix[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb323-41"><a href="#cb323-41" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb323-42"><a href="#cb323-42" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb323-43"><a href="#cb323-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-44"><a href="#cb323-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(probability_matrix[i, :])</span>
<span id="cb323-45"><a href="#cb323-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-46"><a href="#cb323-46" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb323-47"><a href="#cb323-47" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzzyzyy</span></span>
<span id="cb323-48"><a href="#cb323-48" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb323-49"><a href="#cb323-49" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb323-50"><a href="#cb323-50" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb323-51"><a href="#cb323-51" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb323-52"><a href="#cb323-52" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb323-53"><a href="#cb323-53" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb323-54"><a href="#cb323-54" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.303   0.697 </span></span>
<span id="cb323-55"><a href="#cb323-55" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.831   0.169 </span></span>
<span id="cb323-56"><a href="#cb323-56" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb323-57"><a href="#cb323-57" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb323-58"><a href="#cb323-58" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.533   0.065   0.402 </span></span>
<span id="cb323-59"><a href="#cb323-59" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.342   0.334   0.324</span></span>
<span id="cb323-60"><a href="#cb323-60" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb323-61"><a href="#cb323-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-62"><a href="#cb323-62" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb323-63"><a href="#cb323-63" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb323-64"><a href="#cb323-64" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb323-65"><a href="#cb323-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-profile-hmm" class="level1" data-number="108">
<h1 data-number="108"><span class="header-section-number">108</span> Construct a Profile HMM</h1>
<p>Given:&nbsp;A threshold&nbsp;<em>θ</em>, followed by an alphabet&nbsp;<em>Σ</em>, followed by a multiple alignment&nbsp;<em>Alignment</em>&nbsp;whose strings are formed from&nbsp;<em>Σ</em>.</p>
<p>Return:&nbsp;The transition and emission probabilities of the profile HMM&nbsp;<em>HMM</em>(<em>Alignment</em>,&nbsp;<em>θ</em>).</p>
<section id="sample-dataset-108" class="level2" data-number="108.1">
<h2 data-number="108.1" class="anchored" data-anchor-id="sample-dataset-108"><span class="header-section-number">108.1</span> Sample Dataset</h2>
<pre><code>0.289
--------
A   B   C   D   E
--------
EBA
EBD
EB-
EED
EBD
EBE
E-D
EBD</code></pre>
</section>
<section id="sample-output-108" class="level2" data-number="108.2">
<h2 data-number="108.2" class="anchored" data-anchor-id="sample-output-108"><span class="header-section-number">108.2</span> Sample Output</h2>
<pre><code>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E
S   0   0   1.0 0   0   0   0   0   0   0   0   0
I0  0   0   0   0   0   0   0   0   0   0   0   0
M1  0   0   0   0   0   0.875   0.125   0   0   0   0   0
D1  0   0   0   0   0   0   0   0   0   0   0   0
I1  0   0   0   0   0   0   0   0   0   0   0   0
M2  0   0   0   0   0   0   0   0   0.857   0.143   0   0
D2  0   0   0   0   0   0   0   0   1.0 0   0   0
I2  0   0   0   0   0   0   0   0   0   0   0   0
M3  0   0   0   0   0   0   0   0   0   0   0   1.0
D3  0   0   0   0   0   0   0   0   0   0   0   1.0
I3  0   0   0   0   0   0   0   0   0   0   0   0
E   0   0   0   0   0   0   0   0   0   0   0   0
--------
    A   B   C   D   E
S   0   0   0   0   0
I0  0   0   0   0   0
M1  0   0   0   0   1.0
D1  0   0   0   0   0
I1  0   0   0   0   0
M2  0   0.857   0   0   0.143
D2  0   0   0   0   0
I2  0   0   0   0   0
M3  0.143   0   0   0.714   0.143
D3  0   0   0   0   0
I3  0   0   0   0   0
E   0   0   0   0   0</code></pre>
</section>
<section id="solution-108" class="level2" data-number="108.3">
<h2 data-number="108.3" class="anchored" data-anchor-id="solution-108"><span class="header-section-number">108.3</span> Solution</h2>
<div class="sourceCode" id="cb326"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>    threshold <span class="op">=</span> <span class="bu">float</span>(<span class="bu">next</span>(input_iterator).rstrip())</span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_iterator])</span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, alphabet, alignment</span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb326-17"><a href="#cb326-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb326-18"><a href="#cb326-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-19"><a href="#cb326-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb326-20"><a href="#cb326-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb326-21"><a href="#cb326-21" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb326-22"><a href="#cb326-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb326-23"><a href="#cb326-23" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb326-24"><a href="#cb326-24" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb326-25"><a href="#cb326-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb326-26"><a href="#cb326-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-27"><a href="#cb326-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb326-28"><a href="#cb326-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb326-29"><a href="#cb326-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-30"><a href="#cb326-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb326-31"><a href="#cb326-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb326-32"><a href="#cb326-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb326-33"><a href="#cb326-33" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb326-34"><a href="#cb326-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb326-35"><a href="#cb326-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-36"><a href="#cb326-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probabilities(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb326-37"><a href="#cb326-37" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb326-38"><a href="#cb326-38" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb326-39"><a href="#cb326-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-40"><a href="#cb326-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probabilities(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb326-41"><a href="#cb326-41" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb326-42"><a href="#cb326-42" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb326-43"><a href="#cb326-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-44"><a href="#cb326-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb326-45"><a href="#cb326-45" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb326-46"><a href="#cb326-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb326-47"><a href="#cb326-47" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb326-48"><a href="#cb326-48" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb326-49"><a href="#cb326-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb326-50"><a href="#cb326-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-51"><a href="#cb326-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb326-52"><a href="#cb326-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb326-53"><a href="#cb326-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-54"><a href="#cb326-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb326-55"><a href="#cb326-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb326-56"><a href="#cb326-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-57"><a href="#cb326-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb326-58"><a href="#cb326-58" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb326-59"><a href="#cb326-59" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb326-60"><a href="#cb326-60" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb326-61"><a href="#cb326-61" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb326-62"><a href="#cb326-62" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb326-63"><a href="#cb326-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-64"><a href="#cb326-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb326-65"><a href="#cb326-65" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb326-66"><a href="#cb326-66" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb326-67"><a href="#cb326-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb326-68"><a href="#cb326-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb326-69"><a href="#cb326-69" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-70"><a href="#cb326-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb326-71"><a href="#cb326-71" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb326-72"><a href="#cb326-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb326-73"><a href="#cb326-73" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb326-74"><a href="#cb326-74" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-75"><a href="#cb326-75" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb326-76"><a href="#cb326-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb326-77"><a href="#cb326-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb326-78"><a href="#cb326-78" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb326-79"><a href="#cb326-79" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-80"><a href="#cb326-80" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb326-81"><a href="#cb326-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb326-82"><a href="#cb326-82" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-83"><a href="#cb326-83" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-84"><a href="#cb326-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-85"><a href="#cb326-85" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb326-86"><a href="#cb326-86" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb326-87"><a href="#cb326-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-88"><a href="#cb326-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb326-89"><a href="#cb326-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-90"><a href="#cb326-90" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb326-91"><a href="#cb326-91" aria-hidden="true" tabindex="-1"></a><span class="st">0.289</span></span>
<span id="cb326-92"><a href="#cb326-92" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb326-93"><a href="#cb326-93" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb326-94"><a href="#cb326-94" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb326-95"><a href="#cb326-95" aria-hidden="true" tabindex="-1"></a><span class="st">EBA</span></span>
<span id="cb326-96"><a href="#cb326-96" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb326-97"><a href="#cb326-97" aria-hidden="true" tabindex="-1"></a><span class="st">EB-</span></span>
<span id="cb326-98"><a href="#cb326-98" aria-hidden="true" tabindex="-1"></a><span class="st">EED</span></span>
<span id="cb326-99"><a href="#cb326-99" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb326-100"><a href="#cb326-100" aria-hidden="true" tabindex="-1"></a><span class="st">EBE</span></span>
<span id="cb326-101"><a href="#cb326-101" aria-hidden="true" tabindex="-1"></a><span class="st">E-D</span></span>
<span id="cb326-102"><a href="#cb326-102" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb326-103"><a href="#cb326-103" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb326-104"><a href="#cb326-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-105"><a href="#cb326-105" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb326-106"><a href="#cb326-106" aria-hidden="true" tabindex="-1"></a>threshold, alphabet, alignment <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb326-107"><a href="#cb326-107" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb326-108"><a href="#cb326-108" aria-hidden="true" tabindex="-1"></a>print_transition_probabilities(transition_probs)</span>
<span id="cb326-109"><a href="#cb326-109" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb326-110"><a href="#cb326-110" aria-hidden="true" tabindex="-1"></a>print_emission_probabilities(emission_probs, alphabet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-profile-hmm-with-pseudocounts" class="level1" data-number="109">
<h1 data-number="109"><span class="header-section-number">109</span> Construct a Profile HMM with Pseudocounts</h1>
<p>Given:&nbsp;A threshold&nbsp;<em>θ</em>&nbsp;and a pseudocount&nbsp;<em>σ</em>, followed by an alphabet&nbsp;<em>Σ</em>, followed by a multiple alignment&nbsp;<em>Alignment</em>&nbsp;whose strings are formed from&nbsp;<em>Σ</em>.</p>
<p>Return:&nbsp;The transition and emission probabilities of the profile HMM&nbsp;<em>HMM</em>(<em>Alignment</em>,&nbsp;<em>θ</em>,&nbsp;<em>σ</em>).</p>
<section id="sample-dataset-109" class="level2" data-number="109.1">
<h2 data-number="109.1" class="anchored" data-anchor-id="sample-dataset-109"><span class="header-section-number">109.1</span> Sample Dataset</h2>
<pre><code>0.358   0.01
--------
A   B   C   D   E
--------
ADA
ADA
AAA
ADC
-DA
D-A</code></pre>
</section>
<section id="sample-output-109" class="level2" data-number="109.2">
<h2 data-number="109.2" class="anchored" data-anchor-id="sample-output-109"><span class="header-section-number">109.2</span> Sample Output</h2>
<pre><code>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E
S   0   0.01    0.819   0.172   0   0   0   0   0   0   0   0
I0  0   0.333   0.333   0.333   0   0   0   0   0   0   0   0
M1  0   0   0   0   0.01    0.786   0.204   0   0   0   0   0
D1  0   0   0   0   0.01    0.981   0.01    0   0   0   0   0
I1  0   0   0   0   0.333   0.333   0.333   0   0   0   0   0
M2  0   0   0   0   0   0   0   0.01    0.981   0.01    0   0
D2  0   0   0   0   0   0   0   0.01    0.981   0.01    0   0
I2  0   0   0   0   0   0   0   0.333   0.333   0.333   0   0
M3  0   0   0   0   0   0   0   0   0   0   0.01    0.99
D3  0   0   0   0   0   0   0   0   0   0   0.5 0.5
I3  0   0   0   0   0   0   0   0   0   0   0.5 0.5
E   0   0   0   0   0   0   0   0   0   0   0   0
--------
    A   B   C   D   E
S   0   0   0   0   0
I0  0.2 0.2 0.2 0.2 0.2
M1  0.771   0.01    0.01    0.2 0.01
D1  0   0   0   0   0
I1  0.2 0.2 0.2 0.2 0.2
M2  0.2 0.01    0.01    0.771   0.01
D2  0   0   0   0   0
I2  0.2 0.2 0.2 0.2 0.2
M3  0.803   0.01    0.168   0.01    0.01
D3  0   0   0   0   0
I3  0.2 0.2 0.2 0.2 0.2
E   0   0   0   0   0</code></pre>
</section>
<section id="solution-109" class="level2" data-number="109.3">
<h2 data-number="109.3" class="anchored" data-anchor-id="solution-109"><span class="header-section-number">109.3</span> Solution</h2>
<div class="sourceCode" id="cb329"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb329-13"><a href="#cb329-13" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb329-14"><a href="#cb329-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb329-15"><a href="#cb329-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-16"><a href="#cb329-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb329-17"><a href="#cb329-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb329-18"><a href="#cb329-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb329-19"><a href="#cb329-19" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb329-20"><a href="#cb329-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb329-21"><a href="#cb329-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-22"><a href="#cb329-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probs(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb329-23"><a href="#cb329-23" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb329-24"><a href="#cb329-24" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb329-25"><a href="#cb329-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-26"><a href="#cb329-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probs(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb329-27"><a href="#cb329-27" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb329-28"><a href="#cb329-28" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb329-29"><a href="#cb329-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-30"><a href="#cb329-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb329-31"><a href="#cb329-31" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb329-32"><a href="#cb329-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb329-33"><a href="#cb329-33" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb329-34"><a href="#cb329-34" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb329-35"><a href="#cb329-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb329-36"><a href="#cb329-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-37"><a href="#cb329-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-38"><a href="#cb329-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb329-39"><a href="#cb329-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-40"><a href="#cb329-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-41"><a href="#cb329-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb329-42"><a href="#cb329-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-43"><a href="#cb329-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb329-44"><a href="#cb329-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb329-45"><a href="#cb329-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb329-46"><a href="#cb329-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb329-47"><a href="#cb329-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb329-48"><a href="#cb329-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-49"><a href="#cb329-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb329-50"><a href="#cb329-50" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb329-51"><a href="#cb329-51" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb329-52"><a href="#cb329-52" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb329-53"><a href="#cb329-53" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb329-54"><a href="#cb329-54" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb329-55"><a href="#cb329-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-56"><a href="#cb329-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb329-57"><a href="#cb329-57" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb329-58"><a href="#cb329-58" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb329-59"><a href="#cb329-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb329-60"><a href="#cb329-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb329-61"><a href="#cb329-61" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-62"><a href="#cb329-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb329-63"><a href="#cb329-63" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb329-64"><a href="#cb329-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb329-65"><a href="#cb329-65" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb329-66"><a href="#cb329-66" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-67"><a href="#cb329-67" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb329-68"><a href="#cb329-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb329-69"><a href="#cb329-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb329-70"><a href="#cb329-70" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb329-71"><a href="#cb329-71" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-72"><a href="#cb329-72" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb329-73"><a href="#cb329-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb329-74"><a href="#cb329-74" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-75"><a href="#cb329-75" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-76"><a href="#cb329-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-77"><a href="#cb329-77" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb329-78"><a href="#cb329-78" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb329-79"><a href="#cb329-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-80"><a href="#cb329-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb329-81"><a href="#cb329-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-82"><a href="#cb329-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb329-83"><a href="#cb329-83" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_handle).rstrip().split())</span>
<span id="cb329-84"><a href="#cb329-84" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb329-85"><a href="#cb329-85" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_handle).split()</span>
<span id="cb329-86"><a href="#cb329-86" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb329-87"><a href="#cb329-87" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_handle])</span>
<span id="cb329-88"><a href="#cb329-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, pseudocount, alphabet, alignment</span>
<span id="cb329-89"><a href="#cb329-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-90"><a href="#cb329-90" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_transition_pseudocounts(transition_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-91"><a href="#cb329-91" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb329-92"><a href="#cb329-92" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb329-93"><a href="#cb329-93" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb329-94"><a href="#cb329-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb329-95"><a href="#cb329-95" aria-hidden="true" tabindex="-1"></a>        transition_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span> : i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">5</span>, (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span> : (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb329-96"><a href="#cb329-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(transition_matrix)</span>
<span id="cb329-97"><a href="#cb329-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-98"><a href="#cb329-98" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_emission_pseudocounts(emission_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-99"><a href="#cb329-99" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb329-100"><a href="#cb329-100" aria-hidden="true" tabindex="-1"></a>    emission_matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb329-101"><a href="#cb329-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb329-102"><a href="#cb329-102" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb329-103"><a href="#cb329-103" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb329-104"><a href="#cb329-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(emission_matrix)</span>
<span id="cb329-105"><a href="#cb329-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-106"><a href="#cb329-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_pseudocount_profile_hmm(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb329-107"><a href="#cb329-107" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb329-108"><a href="#cb329-108" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_transition_pseudocounts(transition_probs, pseudocount)</span>
<span id="cb329-109"><a href="#cb329-109" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_emission_pseudocounts(emission_probs, pseudocount)</span>
<span id="cb329-110"><a href="#cb329-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb329-111"><a href="#cb329-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-112"><a href="#cb329-112" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb329-113"><a href="#cb329-113" aria-hidden="true" tabindex="-1"></a><span class="st">0.358   0.01</span></span>
<span id="cb329-114"><a href="#cb329-114" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb329-115"><a href="#cb329-115" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb329-116"><a href="#cb329-116" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb329-117"><a href="#cb329-117" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb329-118"><a href="#cb329-118" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb329-119"><a href="#cb329-119" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb329-120"><a href="#cb329-120" aria-hidden="true" tabindex="-1"></a><span class="st">ADC</span></span>
<span id="cb329-121"><a href="#cb329-121" aria-hidden="true" tabindex="-1"></a><span class="st">-DA</span></span>
<span id="cb329-122"><a href="#cb329-122" aria-hidden="true" tabindex="-1"></a><span class="st">D-A</span></span>
<span id="cb329-123"><a href="#cb329-123" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb329-124"><a href="#cb329-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-125"><a href="#cb329-125" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb329-126"><a href="#cb329-126" aria-hidden="true" tabindex="-1"></a>threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb329-127"><a href="#cb329-127" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_pseudocount_profile_hmm(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb329-128"><a href="#cb329-128" aria-hidden="true" tabindex="-1"></a>print_transition_probs(transition_probs)</span>
<span id="cb329-129"><a href="#cb329-129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb329-130"><a href="#cb329-130" aria-hidden="true" tabindex="-1"></a>print_emission_probs(emission_probs, alphabet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="perform-a-multiple-sequence-alignment-with-a-profile-hmm" class="level1" data-number="110">
<h1 data-number="110"><span class="header-section-number">110</span> Perform a Multiple Sequence Alignment with a Profile HMM</h1>
<p>Given:&nbsp;A string Text, a multiple alignment Alignment, a threshold θ, and a pseudocount σ.</p>
<p>Return:&nbsp;An optimal hidden path emitting Text in HMM(Alignment,θ,σ).</p>
<section id="sample-dataset-110" class="level2" data-number="110.1">
<h2 data-number="110.1" class="anchored" data-anchor-id="sample-dataset-110"><span class="header-section-number">110.1</span> Sample Dataset</h2>
<pre><code>AEFDFDC
--------
0.4 0.01
--------
A   B   C   D   E   F
--------
ACDEFACADF
AFDA---CCF
A--EFD-FDC
ACAEF--A-C
ADDEFAAADF</code></pre>
</section>
<section id="sample-output-110" class="level2" data-number="110.2">
<h2 data-number="110.2" class="anchored" data-anchor-id="sample-output-110"><span class="header-section-number">110.2</span> Sample Output</h2>
<pre><code>M1 D2 D3 M4 M5 I5 M6 M7 M8</code></pre>
</section>
<section id="solution-110" class="level2" data-number="110.3">
<h2 data-number="110.3" class="anchored" data-anchor-id="solution-110"><span class="header-section-number">110.3</span> Solution</h2>
<div class="sourceCode" id="cb332"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf, log</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>        labels.extend([<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>])</span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-14"><a href="#cb332-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-15"><a href="#cb332-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb332-16"><a href="#cb332-16" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb332-17"><a href="#cb332-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb332-18"><a href="#cb332-18" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb332-19"><a href="#cb332-19" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb332-20"><a href="#cb332-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb332-21"><a href="#cb332-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-22"><a href="#cb332-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-23"><a href="#cb332-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb332-24"><a href="#cb332-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-25"><a href="#cb332-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-26"><a href="#cb332-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb332-27"><a href="#cb332-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-28"><a href="#cb332-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(num_states: <span class="bu">int</span>, num_symbols: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-29"><a href="#cb332-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_symbols), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb332-30"><a href="#cb332-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-31"><a href="#cb332-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_index(state_num: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb332-32"><a href="#cb332-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb332-33"><a href="#cb332-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (state_num <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb332-34"><a href="#cb332-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb332-35"><a href="#cb332-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> state_num <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb332-36"><a href="#cb332-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-37"><a href="#cb332-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb332-38"><a href="#cb332-38" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb332-39"><a href="#cb332-39" aria-hidden="true" tabindex="-1"></a>    valid_length <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb332-40"><a href="#cb332-40" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_length <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb332-41"><a href="#cb332-41" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_length)</span>
<span id="cb332-42"><a href="#cb332-42" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_length, <span class="bu">len</span>(alphabet))</span>
<span id="cb332-43"><a href="#cb332-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-44"><a href="#cb332-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb332-45"><a href="#cb332-45" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb332-46"><a href="#cb332-46" aria-hidden="true" tabindex="-1"></a>        valid_col_count <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb332-47"><a href="#cb332-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb332-48"><a href="#cb332-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[col]:</span>
<span id="cb332-49"><a href="#cb332-49" aria-hidden="true" tabindex="-1"></a>                valid_col_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-50"><a href="#cb332-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb332-51"><a href="#cb332-51" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"del"</span>)</span>
<span id="cb332-52"><a href="#cb332-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb332-53"><a href="#cb332-53" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"match"</span>)</span>
<span id="cb332-54"><a href="#cb332-54" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-55"><a href="#cb332-55" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb332-56"><a href="#cb332-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb332-57"><a href="#cb332-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb332-58"><a href="#cb332-58" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"ins"</span>)</span>
<span id="cb332-59"><a href="#cb332-59" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-60"><a href="#cb332-60" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb332-61"><a href="#cb332-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb332-62"><a href="#cb332-62" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-63"><a href="#cb332-63" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-64"><a href="#cb332-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-65"><a href="#cb332-65" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb332-66"><a href="#cb332-66" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb332-67"><a href="#cb332-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-68"><a href="#cb332-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb332-69"><a href="#cb332-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-70"><a href="#cb332-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_transitions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-71"><a href="#cb332-71" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-72"><a href="#cb332-72" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb332-73"><a href="#cb332-73" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb332-74"><a href="#cb332-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-75"><a href="#cb332-75" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>:i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">5</span>, (i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>:(i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb332-76"><a href="#cb332-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb332-77"><a href="#cb332-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-78"><a href="#cb332-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_emissions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-79"><a href="#cb332-79" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-80"><a href="#cb332-80" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb332-81"><a href="#cb332-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-82"><a href="#cb332-82" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb332-83"><a href="#cb332-83" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb332-84"><a href="#cb332-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb332-85"><a href="#cb332-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-86"><a href="#cb332-86" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm_with_pseudocounts(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb332-87"><a href="#cb332-87" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb332-88"><a href="#cb332-88" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_pseudocounts_to_transitions(transition_probs, pseudocount)</span>
<span id="cb332-89"><a href="#cb332-89" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_pseudocounts_to_emissions(emission_probs, pseudocount)</span>
<span id="cb332-90"><a href="#cb332-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb332-91"><a href="#cb332-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-92"><a href="#cb332-92" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input_data(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb332-93"><a href="#cb332-93" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb332-94"><a href="#cb332-94" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb332-95"><a href="#cb332-95" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_iterator).rstrip().split())</span>
<span id="cb332-96"><a href="#cb332-96" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb332-97"><a href="#cb332-97" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb332-98"><a href="#cb332-98" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb332-99"><a href="#cb332-99" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(x.strip()) <span class="cf">for</span> x <span class="kw">in</span> input_iterator])</span>
<span id="cb332-100"><a href="#cb332-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, threshold, pseudocount, alphabet, alignment</span>
<span id="cb332-101"><a href="#cb332-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-102"><a href="#cb332-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_transition_probs_to_dict(matrix: np.ndarray) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb332-103"><a href="#cb332-103" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb332-104"><a href="#cb332-104" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-105"><a href="#cb332-105" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb332-106"><a href="#cb332-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb332-107"><a href="#cb332-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb332-108"><a href="#cb332-108" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb332-109"><a href="#cb332-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb332-110"><a href="#cb332-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-111"><a href="#cb332-111" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_emission_probs_to_dict(matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb332-112"><a href="#cb332-112" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb332-113"><a href="#cb332-113" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-114"><a href="#cb332-114" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb332-115"><a href="#cb332-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb332-116"><a href="#cb332-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(alphabet):</span>
<span id="cb332-117"><a href="#cb332-117" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], symbol] <span class="op">=</span> matrix[i][j]</span>
<span id="cb332-118"><a href="#cb332-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb332-119"><a href="#cb332-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-120"><a href="#cb332-120" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_hmm_graph(transition_probs: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb332-121"><a href="#cb332-121" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb332-122"><a href="#cb332-122" aria-hidden="true" tabindex="-1"></a>        graph[source].append({<span class="st">"node"</span>: target, <span class="st">"weight"</span>: transition_probs[source, target]})</span>
<span id="cb332-123"><a href="#cb332-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-124"><a href="#cb332-124" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb332-125"><a href="#cb332-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target <span class="kw">in</span> [<span class="st">"I0"</span>, <span class="st">"M1"</span>, <span class="st">"D1"</span>]:</span>
<span id="cb332-126"><a href="#cb332-126" aria-hidden="true" tabindex="-1"></a>        add_edge(<span class="st">"S"</span>, target)</span>
<span id="cb332-127"><a href="#cb332-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-128"><a href="#cb332-128" aria-hidden="true" tabindex="-1"></a>        source <span class="op">=</span> <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb332-129"><a href="#cb332-129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [source, <span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb332-130"><a href="#cb332-130" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb332-131"><a href="#cb332-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states):</span>
<span id="cb332-132"><a href="#cb332-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb332-133"><a href="#cb332-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb332-134"><a href="#cb332-134" aria-hidden="true" tabindex="-1"></a>                add_edge(source, target)</span>
<span id="cb332-135"><a href="#cb332-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb332-136"><a href="#cb332-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="st">"E"</span>]:</span>
<span id="cb332-137"><a href="#cb332-137" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb332-138"><a href="#cb332-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-139"><a href="#cb332-139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb332-140"><a href="#cb332-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-141"><a href="#cb332-141" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_topological_order(num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb332-142"><a href="#cb332-142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"S"</span>, <span class="dv">0</span>)</span>
<span id="cb332-143"><a href="#cb332-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-144"><a href="#cb332-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="ss">f"D</span><span class="sc">{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)</span>
<span id="cb332-145"><a href="#cb332-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(seq_length):</span>
<span id="cb332-146"><a href="#cb332-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="st">"I0"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb332-147"><a href="#cb332-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-148"><a href="#cb332-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> state_type <span class="kw">in</span> [<span class="st">"M"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>]:</span>
<span id="cb332-149"><a href="#cb332-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (<span class="ss">f"</span><span class="sc">{</span>state_type<span class="sc">}{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb332-150"><a href="#cb332-150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"E"</span>, seq_length <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb332-151"><a href="#cb332-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-152"><a href="#cb332-152" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_nodes(current_node: <span class="bu">str</span>, current_col: <span class="bu">int</span>, num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb332-153"><a href="#cb332-153" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"E"</span>:</span>
<span id="cb332-154"><a href="#cb332-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length)]</span>
<span id="cb332-155"><a href="#cb332-155" aria-hidden="true" tabindex="-1"></a>    state_num <span class="op">=</span> <span class="bu">int</span>(current_node[<span class="dv">1</span>:])</span>
<span id="cb332-156"><a href="#cb332-156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb332-157"><a href="#cb332-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)]</span>
<span id="cb332-158"><a href="#cb332-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"I0"</span>:</span>
<span id="cb332-159"><a href="#cb332-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb332-160"><a href="#cb332-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"M1"</span>:</span>
<span id="cb332-161"><a href="#cb332-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb332-162"><a href="#cb332-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"I"</span>:</span>
<span id="cb332-163"><a href="#cb332-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb332-164"><a href="#cb332-164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"M"</span>:</span>
<span id="cb332-165"><a href="#cb332-165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb332-166"><a href="#cb332-166" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"D"</span>:</span>
<span id="cb332-167"><a href="#cb332-167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"I0"</span>, current_col)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col)]</span>
<span id="cb332-168"><a href="#cb332-168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb332-169"><a href="#cb332-169" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Unhandled node: </span><span class="sc">{</span>current_node<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb332-170"><a href="#cb332-170" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb332-171"><a href="#cb332-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-172"><a href="#cb332-172" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplify_graph(graph: Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">float</span>]]:</span>
<span id="cb332-173"><a href="#cb332-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {k: {x[<span class="st">"node"</span>]: x[<span class="st">"weight"</span>] <span class="cf">for</span> x <span class="kw">in</span> v} <span class="cf">for</span> k, v <span class="kw">in</span> graph.items()}</span>
<span id="cb332-174"><a href="#cb332-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-175"><a href="#cb332-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Main execution</span></span>
<span id="cb332-176"><a href="#cb332-176" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input):</span>
<span id="cb332-177"><a href="#cb332-177" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb332-178"><a href="#cb332-178" aria-hidden="true" tabindex="-1"></a>    sequence, threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input_data(input_lines)</span>
<span id="cb332-179"><a href="#cb332-179" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm_with_pseudocounts(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb332-180"><a href="#cb332-180" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (transition_probs.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-181"><a href="#cb332-181" aria-hidden="true" tabindex="-1"></a>    transition_probs_dict <span class="op">=</span> convert_transition_probs_to_dict(transition_probs)</span>
<span id="cb332-182"><a href="#cb332-182" aria-hidden="true" tabindex="-1"></a>    emission_probs_dict <span class="op">=</span> convert_emission_probs_to_dict(emission_probs, alphabet)</span>
<span id="cb332-183"><a href="#cb332-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-184"><a href="#cb332-184" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> build_hmm_graph(transition_probs_dict, num_states)</span>
<span id="cb332-185"><a href="#cb332-185" aria-hidden="true" tabindex="-1"></a>    topological_order <span class="op">=</span> generate_topological_order(num_states, <span class="bu">len</span>(sequence))</span>
<span id="cb332-186"><a href="#cb332-186" aria-hidden="true" tabindex="-1"></a>    simplified_graph <span class="op">=</span> simplify_graph(graph)</span>
<span id="cb332-187"><a href="#cb332-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-188"><a href="#cb332-188" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dynamic programming to find the most probable path</span></span>
<span id="cb332-189"><a href="#cb332-189" aria-hidden="true" tabindex="-1"></a>    previous_node <span class="op">=</span> <span class="bu">next</span>(topological_order)</span>
<span id="cb332-190"><a href="#cb332-190" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {previous_node: <span class="dv">0</span>}</span>
<span id="cb332-191"><a href="#cb332-191" aria-hidden="true" tabindex="-1"></a>    backpointers <span class="op">=</span> {previous_node: (<span class="va">None</span>, <span class="va">None</span>)}</span>
<span id="cb332-192"><a href="#cb332-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-193"><a href="#cb332-193" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_node, current_col <span class="kw">in</span> topological_order:</span>
<span id="cb332-194"><a href="#cb332-194" aria-hidden="true" tabindex="-1"></a>        backpointers[(current_node, current_col)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb332-195"><a href="#cb332-195" aria-hidden="true" tabindex="-1"></a>        scores[(current_node, current_col)] <span class="op">=</span> <span class="op">-</span>inf</span>
<span id="cb332-196"><a href="#cb332-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> prev_node, prev_col <span class="kw">in</span> get_previous_nodes(current_node, current_col, num_states, <span class="bu">len</span>(sequence)):</span>
<span id="cb332-197"><a href="#cb332-197" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_col <span class="op">&lt;</span> current_col <span class="kw">and</span> current_node <span class="op">!=</span> <span class="st">"E"</span>:</span>
<span id="cb332-198"><a href="#cb332-198" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> emission_probs_dict[current_node, sequence[current_col <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb332-199"><a href="#cb332-199" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb332-200"><a href="#cb332-200" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb332-201"><a href="#cb332-201" aria-hidden="true" tabindex="-1"></a>            log_prob <span class="op">=</span> log(simplified_graph[prev_node][current_node]) <span class="op">+</span> log(emission_prob) <span class="op">+</span> scores[(prev_node, prev_col)]</span>
<span id="cb332-202"><a href="#cb332-202" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> log_prob <span class="op">&gt;</span> scores[(current_node, current_col)]:</span>
<span id="cb332-203"><a href="#cb332-203" aria-hidden="true" tabindex="-1"></a>                scores[(current_node, current_col)] <span class="op">=</span> log_prob</span>
<span id="cb332-204"><a href="#cb332-204" aria-hidden="true" tabindex="-1"></a>                backpointers[(current_node, current_col)] <span class="op">=</span> (prev_node, prev_col)</span>
<span id="cb332-205"><a href="#cb332-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-206"><a href="#cb332-206" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to find the path</span></span>
<span id="cb332-207"><a href="#cb332-207" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> []</span>
<span id="cb332-208"><a href="#cb332-208" aria-hidden="true" tabindex="-1"></a>    position <span class="op">=</span> (<span class="st">"E"</span>, <span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb332-209"><a href="#cb332-209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> position[<span class="dv">0</span>]:</span>
<span id="cb332-210"><a href="#cb332-210" aria-hidden="true" tabindex="-1"></a>        path.append(backpointers[position][<span class="dv">0</span>])</span>
<span id="cb332-211"><a href="#cb332-211" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> backpointers[position]</span>
<span id="cb332-212"><a href="#cb332-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-213"><a href="#cb332-213" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>path[::<span class="op">-</span><span class="dv">1</span>][<span class="dv">2</span>:])</span>
<span id="cb332-214"><a href="#cb332-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-215"><a href="#cb332-215" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb332-216"><a href="#cb332-216" aria-hidden="true" tabindex="-1"></a><span class="st">AEFDFDC</span></span>
<span id="cb332-217"><a href="#cb332-217" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb332-218"><a href="#cb332-218" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.01</span></span>
<span id="cb332-219"><a href="#cb332-219" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb332-220"><a href="#cb332-220" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E   F</span></span>
<span id="cb332-221"><a href="#cb332-221" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb332-222"><a href="#cb332-222" aria-hidden="true" tabindex="-1"></a><span class="st">ACDEFACADF</span></span>
<span id="cb332-223"><a href="#cb332-223" aria-hidden="true" tabindex="-1"></a><span class="st">AFDA---CCF</span></span>
<span id="cb332-224"><a href="#cb332-224" aria-hidden="true" tabindex="-1"></a><span class="st">A--EFD-FDC</span></span>
<span id="cb332-225"><a href="#cb332-225" aria-hidden="true" tabindex="-1"></a><span class="st">ACAEF--A-C</span></span>
<span id="cb332-226"><a href="#cb332-226" aria-hidden="true" tabindex="-1"></a><span class="st">ADDEFAAADF</span></span>
<span id="cb332-227"><a href="#cb332-227" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb332-228"><a href="#cb332-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-229"><a href="#cb332-229" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="estimate-the-parameters-of-an-hmm" class="level1" data-number="111">
<h1 data-number="111"><span class="header-section-number">111</span> Estimate the Parameters of an HMM</h1>
<p>Given:&nbsp;A sequence of emitted symbols x = x1… xn in an alphabet ∑ and a path <span class="math inline">\(π = π_1... π_n\)</span> generated by a k-state HMM with unknown transition and emission probabilities.</p>
<p>Return:&nbsp;A matrix of transition probabilities Transition and a matrix of emission probabilities Emission that maximize <span class="math inline">\(Pr(x,π)\)</span> over all possible matrices of transition and emission probabilities.</p>
<section id="sample-dataset-111" class="level2" data-number="111.1">
<h2 data-number="111.1" class="anchored" data-anchor-id="sample-dataset-111"><span class="header-section-number">111.1</span> Sample Dataset</h2>
<pre><code>yzzzyxzxxx
--------
x   y   z
--------
BBABABABAB
--------
A   B   C</code></pre>
</section>
<section id="sample-output-111" class="level2" data-number="111.2">
<h2 data-number="111.2" class="anchored" data-anchor-id="sample-output-111"><span class="header-section-number">111.2</span> Sample Output</h2>
<pre><code>A   B   C
A   0.0 1.0 0.0
B   0.8 0.2 0.0
C   0.333   0.333   0.333
--------
    x   y   z
A   0.25    0.25    0.5
B   0.5 0.167   0.333
C   0.333   0.333   0.333</code></pre>
</section>
<section id="solution-111" class="level2" data-number="111.3">
<h2 data-number="111.3" class="anchored" data-anchor-id="solution-111"><span class="header-section-number">111.3</span> Solution</h2>
<div class="sourceCode" id="cb335"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator, Union</span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb335-13"><a href="#cb335-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-14"><a href="#cb335-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb335-15"><a href="#cb335-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb335-16"><a href="#cb335-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-17"><a href="#cb335-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb335-18"><a href="#cb335-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb335-19"><a href="#cb335-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb335-20"><a href="#cb335-20" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb335-21"><a href="#cb335-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb335-22"><a href="#cb335-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-23"><a href="#cb335-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], <span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb335-24"><a href="#cb335-24" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb335-25"><a href="#cb335-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb335-26"><a href="#cb335-26" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb335-27"><a href="#cb335-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb335-28"><a href="#cb335-28" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb335-29"><a href="#cb335-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb335-30"><a href="#cb335-30" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb335-31"><a href="#cb335-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, alphabet, path, states</span>
<span id="cb335-32"><a href="#cb335-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-33"><a href="#cb335-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_dict(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb335-34"><a href="#cb335-34" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb335-35"><a href="#cb335-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb335-36"><a href="#cb335-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">1</span>]):</span>
<span id="cb335-37"><a href="#cb335-37" aria-hidden="true" tabindex="-1"></a>            result[row_labels[i], column_labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb335-38"><a href="#cb335-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb335-39"><a href="#cb335-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-40"><a href="#cb335-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb335-41"><a href="#cb335-41" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb335-42"><a href="#cb335-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_state, next_state <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb335-43"><a href="#cb335-43" aria-hidden="true" tabindex="-1"></a>        transition_matrix[states.index(current_state)][states.index(next_state)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb335-44"><a href="#cb335-44" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> normalize_matrix(transition_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb335-45"><a href="#cb335-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb335-46"><a href="#cb335-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(transition_matrix, states, states)</span>
<span id="cb335-47"><a href="#cb335-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb335-48"><a href="#cb335-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> transition_matrix</span>
<span id="cb335-49"><a href="#cb335-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-50"><a href="#cb335-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb335-51"><a href="#cb335-51" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb335-52"><a href="#cb335-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> state, symbol <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb335-53"><a href="#cb335-53" aria-hidden="true" tabindex="-1"></a>        emission_matrix[states.index(state)][alphabet.index(symbol)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb335-54"><a href="#cb335-54" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> normalize_matrix(emission_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb335-55"><a href="#cb335-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb335-56"><a href="#cb335-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(emission_matrix, states, alphabet)</span>
<span id="cb335-57"><a href="#cb335-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb335-58"><a href="#cb335-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> emission_matrix</span>
<span id="cb335-59"><a href="#cb335-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-60"><a href="#cb335-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb335-61"><a href="#cb335-61" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb335-62"><a href="#cb335-62" aria-hidden="true" tabindex="-1"></a>    sequence, alphabet, path, states <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb335-63"><a href="#cb335-63" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states)</span>
<span id="cb335-64"><a href="#cb335-64" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states)</span>
<span id="cb335-65"><a href="#cb335-65" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, states, states)</span>
<span id="cb335-66"><a href="#cb335-66" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb335-67"><a href="#cb335-67" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, states, alphabet)</span>
<span id="cb335-68"><a href="#cb335-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-69"><a href="#cb335-69" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb335-70"><a href="#cb335-70" aria-hidden="true" tabindex="-1"></a><span class="st">yzzzyxzxxx</span></span>
<span id="cb335-71"><a href="#cb335-71" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb335-72"><a href="#cb335-72" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb335-73"><a href="#cb335-73" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb335-74"><a href="#cb335-74" aria-hidden="true" tabindex="-1"></a><span class="st">BBABABABAB</span></span>
<span id="cb335-75"><a href="#cb335-75" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb335-76"><a href="#cb335-76" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C</span></span>
<span id="cb335-77"><a href="#cb335-77" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb335-78"><a href="#cb335-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-79"><a href="#cb335-79" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-viterbi-learning" class="level1" data-number="112">
<h1 data-number="112"><span class="header-section-number">112</span> Implement Viterbi Learning</h1>
<p>Given:&nbsp;A sequence of emitted symbols&nbsp;<span class="math inline">\(x=x_1... x_n\)</span>&nbsp;in an alphabet&nbsp;<em>A</em>, generated by a&nbsp;<em>k</em>-state HMM with unknown transition and emission probabilities, initial&nbsp;<em>Transition</em>&nbsp;and&nbsp;<em>Emission</em>&nbsp;matrices and a number of iterations&nbsp;<em>i</em>.</p>
<p>Return:&nbsp;A matrix of transition probabilities&nbsp;<em>Transition</em>&nbsp;and a matrix of emission probabilities&nbsp;<em>Emission</em>&nbsp;that maximizes <span class="math inline">\(Pr(x,π)\)</span> over all possible transition and emission matrices and over all hidden paths&nbsp;<em>π</em>.</p>
<section id="sample-dataset-112" class="level2" data-number="112.1">
<h2 data-number="112.1" class="anchored" data-anchor-id="sample-dataset-112"><span class="header-section-number">112.1</span> Sample Dataset</h2>
<pre><code>100
--------
xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz
--------
x   y   z
--------
A   B
--------
    A   B
A   0.582   0.418
B   0.272   0.728
--------
    x   y   z
A   0.129   0.35    0.52
B   0.422   0.151   0.426</code></pre>
</section>
<section id="sample-output-112" class="level2" data-number="112.2">
<h2 data-number="112.2" class="anchored" data-anchor-id="sample-output-112"><span class="header-section-number">112.2</span> Sample Output</h2>
<pre><code>A   B
A   0.875   0.125
B   0.011   0.989
--------
    x   y   z
A   0.0 0.75    0.25
B   0.402   0.174   0.424</code></pre>
</section>
<section id="solution-112" class="level2" data-number="112.3">
<h2 data-number="112.3" class="anchored" data-anchor-id="solution-112"><span class="header-section-number">112.3</span> Solution</h2>
<div class="sourceCode" id="cb338"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)))</span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states))</span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true" tabindex="-1"></a>            opt <span class="op">=</span> [</span>
<span id="cb338-16"><a href="#cb338-16" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[prev, state]) <span class="op">+</span> log(emission_matrix[state, emission]) <span class="op">+</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb338-17"><a href="#cb338-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb338-18"><a href="#cb338-18" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb338-19"><a href="#cb338-19" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> opt.index(<span class="bu">max</span>(opt))</span>
<span id="cb338-20"><a href="#cb338-20" aria-hidden="true" tabindex="-1"></a>            ptr[i, j] <span class="op">=</span> p</span>
<span id="cb338-21"><a href="#cb338-21" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">max</span>(opt)</span>
<span id="cb338-22"><a href="#cb338-22" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> np.argmax(mat[i, :])</span>
<span id="cb338-23"><a href="#cb338-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-24"><a href="#cb338-24" aria-hidden="true" tabindex="-1"></a>    state_sequence <span class="op">=</span> states[ind]</span>
<span id="cb338-25"><a href="#cb338-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb338-26"><a href="#cb338-26" aria-hidden="true" tabindex="-1"></a>        state_sequence <span class="op">=</span> states[ptr[i, ind]] <span class="op">+</span> state_sequence</span>
<span id="cb338-27"><a href="#cb338-27" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> ptr[i, ind]</span>
<span id="cb338-28"><a href="#cb338-28" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb338-29"><a href="#cb338-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> state_sequence</span>
<span id="cb338-30"><a href="#cb338-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-31"><a href="#cb338-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb338-32"><a href="#cb338-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb338-33"><a href="#cb338-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb338-34"><a href="#cb338-34" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb338-35"><a href="#cb338-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb338-36"><a href="#cb338-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-37"><a href="#cb338-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, min_val: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1e-16</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb338-38"><a href="#cb338-38" aria-hidden="true" tabindex="-1"></a>    normalized <span class="op">=</span> matrix <span class="op">/</span> matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb338-39"><a href="#cb338-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros:</span>
<span id="cb338-40"><a href="#cb338-40" aria-hidden="true" tabindex="-1"></a>        normalized[normalized <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> min_val</span>
<span id="cb338-41"><a href="#cb338-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalized</span>
<span id="cb338-42"><a href="#cb338-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-43"><a href="#cb338-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb338-44"><a href="#cb338-44" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb338-45"><a href="#cb338-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb338-46"><a href="#cb338-46" aria-hidden="true" tabindex="-1"></a>        tmat[states.index(a)][states.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb338-47"><a href="#cb338-47" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> normalize_matrix(tmat)</span>
<span id="cb338-48"><a href="#cb338-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb338-49"><a href="#cb338-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], states[j]): tmat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states))}</span>
<span id="cb338-50"><a href="#cb338-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tmat</span>
<span id="cb338-51"><a href="#cb338-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-52"><a href="#cb338-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb338-53"><a href="#cb338-53" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb338-54"><a href="#cb338-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb338-55"><a href="#cb338-55" aria-hidden="true" tabindex="-1"></a>        emat[states.index(a)][alphabet.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb338-56"><a href="#cb338-56" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> normalize_matrix(emat)</span>
<span id="cb338-57"><a href="#cb338-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb338-58"><a href="#cb338-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], alphabet[j]): emat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(alphabet))}</span>
<span id="cb338-59"><a href="#cb338-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emat</span>
<span id="cb338-60"><a href="#cb338-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-61"><a href="#cb338-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb338-62"><a href="#cb338-62" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(column_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb338-63"><a href="#cb338-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb338-64"><a href="#cb338-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(column_labels):</span>
<span id="cb338-65"><a href="#cb338-65" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb338-66"><a href="#cb338-66" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, column_labels)</span>
<span id="cb338-67"><a href="#cb338-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-68"><a href="#cb338-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: StringIO) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb338-69"><a href="#cb338-69" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb338-70"><a href="#cb338-70" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-71"><a href="#cb338-71" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb338-72"><a href="#cb338-72" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-73"><a href="#cb338-73" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb338-74"><a href="#cb338-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-75"><a href="#cb338-75" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb338-76"><a href="#cb338-76" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-77"><a href="#cb338-77" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb338-78"><a href="#cb338-78" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb338-79"><a href="#cb338-79" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb338-80"><a href="#cb338-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb338-81"><a href="#cb338-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb338-82"><a href="#cb338-82" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb338-83"><a href="#cb338-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-84"><a href="#cb338-84" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb338-85"><a href="#cb338-85" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb338-86"><a href="#cb338-86" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb338-87"><a href="#cb338-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb338-88"><a href="#cb338-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb338-89"><a href="#cb338-89" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb338-90"><a href="#cb338-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, sequence, states, alphabet, transition_matrix, emission_matrix</span>
<span id="cb338-91"><a href="#cb338-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-92"><a href="#cb338-92" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb338-93"><a href="#cb338-93" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb338-94"><a href="#cb338-94" aria-hidden="true" tabindex="-1"></a>    niter, sequence, states, alphabet, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb338-95"><a href="#cb338-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb338-96"><a href="#cb338-96" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb338-97"><a href="#cb338-97" aria-hidden="true" tabindex="-1"></a>        transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb338-98"><a href="#cb338-98" aria-hidden="true" tabindex="-1"></a>        emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb338-99"><a href="#cb338-99" aria-hidden="true" tabindex="-1"></a>    print_dict(transition_matrix, states, states)</span>
<span id="cb338-100"><a href="#cb338-100" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb338-101"><a href="#cb338-101" aria-hidden="true" tabindex="-1"></a>    print_dict(emission_matrix, states, alphabet)</span>
<span id="cb338-102"><a href="#cb338-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-103"><a href="#cb338-103" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb338-104"><a href="#cb338-104" aria-hidden="true" tabindex="-1"></a><span class="st">100</span></span>
<span id="cb338-105"><a href="#cb338-105" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-106"><a href="#cb338-106" aria-hidden="true" tabindex="-1"></a><span class="st">xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span></span>
<span id="cb338-107"><a href="#cb338-107" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-108"><a href="#cb338-108" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb338-109"><a href="#cb338-109" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-110"><a href="#cb338-110" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb338-111"><a href="#cb338-111" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-112"><a href="#cb338-112" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb338-113"><a href="#cb338-113" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.582   0.418</span></span>
<span id="cb338-114"><a href="#cb338-114" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.272   0.728</span></span>
<span id="cb338-115"><a href="#cb338-115" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-116"><a href="#cb338-116" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb338-117"><a href="#cb338-117" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.129   0.35    0.52</span></span>
<span id="cb338-118"><a href="#cb338-118" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.422   0.151   0.426</span></span>
<span id="cb338-119"><a href="#cb338-119" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb338-120"><a href="#cb338-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-121"><a href="#cb338-121" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="solve-the-soft-decoding-problem" class="level1" data-number="113">
<h1 data-number="113"><span class="header-section-number">113</span> Solve the Soft Decoding Problem</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability <span class="math inline">\(Pr(π_i=k|x)\)</span> that the HMM was in state k at step i (for each state k and each step i).</p>
<section id="sample-dataset-113" class="level2" data-number="113.1">
<h2 data-number="113.1" class="anchored" data-anchor-id="sample-dataset-113"><span class="header-section-number">113.1</span> Sample Dataset</h2>
<pre><code>zyxxxxyxzz
--------
x   y   z
--------
A   B
--------
    A   B
A   0.911   0.089
B   0.228   0.772
--------
    x   y   z
A   0.356   0.191   0.453 
B   0.04    0.467   0.493</code></pre>
</section>
<section id="sample-output-113" class="level2" data-number="113.2">
<h2 data-number="113.2" class="anchored" data-anchor-id="sample-output-113"><span class="header-section-number">113.2</span> Sample Output</h2>
<pre><code>A   B 
0.5438  0.4562 
0.6492  0.3508 
0.9647  0.0353 
0.9936  0.0064 
0.9957  0.0043 
0.9891  0.0109 
0.9154  0.0846 
0.964   0.036 
0.8737  0.1263 
0.8167  0.1833</code></pre>
</section>
<section id="solution-113" class="level2" data-number="113.3">
<h2 data-number="113.3" class="anchored" data-anchor-id="solution-113"><span class="header-section-number">113.3</span> Solution</h2>
<div class="sourceCode" id="cb341"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>    seq: <span class="bu">str</span> <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a>    alphabet: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a>    states: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a>    lines: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a>    tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true" tabindex="-1"></a>    emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb341-21"><a href="#cb341-21" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb341-22"><a href="#cb341-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb341-23"><a href="#cb341-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb341-24"><a href="#cb341-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb341-25"><a href="#cb341-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq, states, tmat, emat</span>
<span id="cb341-26"><a href="#cb341-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-27"><a href="#cb341-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb341-28"><a href="#cb341-28" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb341-29"><a href="#cb341-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-30"><a href="#cb341-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb341-31"><a href="#cb341-31" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb341-32"><a href="#cb341-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb341-33"><a href="#cb341-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb341-34"><a href="#cb341-34" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb341-35"><a href="#cb341-35" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb341-36"><a href="#cb341-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb341-37"><a href="#cb341-37" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb341-38"><a href="#cb341-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-39"><a href="#cb341-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb341-40"><a href="#cb341-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-41"><a href="#cb341-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb341-42"><a href="#cb341-42" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb341-43"><a href="#cb341-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-44"><a href="#cb341-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb341-45"><a href="#cb341-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb341-46"><a href="#cb341-46" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb341-47"><a href="#cb341-47" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb341-48"><a href="#cb341-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb341-49"><a href="#cb341-49" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb341-50"><a href="#cb341-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb341-51"><a href="#cb341-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-52"><a href="#cb341-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb341-53"><a href="#cb341-53" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb341-54"><a href="#cb341-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb341-55"><a href="#cb341-55" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb341-56"><a href="#cb341-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb341-57"><a href="#cb341-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-58"><a href="#cb341-58" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb341-59"><a href="#cb341-59" aria-hidden="true" tabindex="-1"></a>    input_lines: Iterator[<span class="bu">str</span>] <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb341-60"><a href="#cb341-60" aria-hidden="true" tabindex="-1"></a>    seq, states, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb341-61"><a href="#cb341-61" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> soft_decode(seq, states, tmat, emat)</span>
<span id="cb341-62"><a href="#cb341-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>states, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb341-63"><a href="#cb341-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> r <span class="kw">in</span> np.<span class="bu">round</span>(tot, <span class="dv">4</span>):</span>
<span id="cb341-64"><a href="#cb341-64" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb341-65"><a href="#cb341-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-66"><a href="#cb341-66" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb341-67"><a href="#cb341-67" aria-hidden="true" tabindex="-1"></a><span class="st">zyxxxxyxzz</span></span>
<span id="cb341-68"><a href="#cb341-68" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb341-69"><a href="#cb341-69" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb341-70"><a href="#cb341-70" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb341-71"><a href="#cb341-71" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb341-72"><a href="#cb341-72" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb341-73"><a href="#cb341-73" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb341-74"><a href="#cb341-74" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.911   0.089</span></span>
<span id="cb341-75"><a href="#cb341-75" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.228   0.772</span></span>
<span id="cb341-76"><a href="#cb341-76" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb341-77"><a href="#cb341-77" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb341-78"><a href="#cb341-78" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.356   0.191   0.453 </span></span>
<span id="cb341-79"><a href="#cb341-79" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.04    0.467   0.493</span></span>
<span id="cb341-80"><a href="#cb341-80" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb341-81"><a href="#cb341-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-82"><a href="#cb341-82" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-baum-welch-learning" class="level1" data-number="114">
<h1 data-number="114"><span class="header-section-number">114</span> Implement Baum-Welch Learning</h1>
<p>Given:&nbsp;A sequence of emitted symbols <span class="math inline">\(x=x_1...x_n\)</span> in an alphabet A, generated by a k-state HMM with unknown transition and emission probabilities, initial Transition and Emission matrices and a number of iterations I.</p>
<p>Return:&nbsp;A matrix of transition probabilities Transition and a matrix of emission probabilities Emission that maximizes <span class="math inline">\(Pr(x,π)\)</span> over all possible transition and emission matrices and over all hidden paths π.</p>
<section id="sample-dataset-114" class="level2" data-number="114.1">
<h2 data-number="114.1" class="anchored" data-anchor-id="sample-dataset-114"><span class="header-section-number">114.1</span> Sample Dataset</h2>
<pre><code>10
--------
xzyyzyzyxy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.019   0.981 
B   0.668   0.332 
--------
x   y   z
A   0.175   0.003   0.821 
B   0.196   0.512   0.293</code></pre>
</section>
<section id="sample-output-114" class="level2" data-number="114.2">
<h2 data-number="114.2" class="anchored" data-anchor-id="sample-output-114"><span class="header-section-number">114.2</span> Sample Output</h2>
<pre><code>A   B
A   0.000   1.000   
B   0.786   0.214   
--------
    x   y   z
A   0.242   0.000   0.758   
B   0.172   0.828   0.000</code></pre>
</section>
<section id="solution-114" class="level2" data-number="114.3">
<h2 data-number="114.3" class="anchored" data-anchor-id="solution-114"><span class="header-section-number">114.3</span> Solution</h2>
<div class="sourceCode" id="cb344"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb344-8"><a href="#cb344-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb344-9"><a href="#cb344-9" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb344-10"><a href="#cb344-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb344-11"><a href="#cb344-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-12"><a href="#cb344-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb344-13"><a href="#cb344-13" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(col_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb344-14"><a href="#cb344-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb344-15"><a href="#cb344-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(col_labels):</span>
<span id="cb344-16"><a href="#cb344-16" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb344-17"><a href="#cb344-17" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, col_labels)</span>
<span id="cb344-18"><a href="#cb344-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-19"><a href="#cb344-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb344-20"><a href="#cb344-20" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb344-21"><a href="#cb344-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-22"><a href="#cb344-22" aria-hidden="true" tabindex="-1"></a>    seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb344-23"><a href="#cb344-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-24"><a href="#cb344-24" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb344-25"><a href="#cb344-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-26"><a href="#cb344-26" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb344-27"><a href="#cb344-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-28"><a href="#cb344-28" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb344-29"><a href="#cb344-29" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> {</span>
<span id="cb344-30"><a href="#cb344-30" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb344-31"><a href="#cb344-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb344-32"><a href="#cb344-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb344-33"><a href="#cb344-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb344-34"><a href="#cb344-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-35"><a href="#cb344-35" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb344-36"><a href="#cb344-36" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> {</span>
<span id="cb344-37"><a href="#cb344-37" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb344-38"><a href="#cb344-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb344-39"><a href="#cb344-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb344-40"><a href="#cb344-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb344-41"><a href="#cb344-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, seq, states, alphabet, tmat, emat</span>
<span id="cb344-42"><a href="#cb344-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-43"><a href="#cb344-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb344-44"><a href="#cb344-44" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb344-45"><a href="#cb344-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-46"><a href="#cb344-46" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb344-47"><a href="#cb344-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb344-48"><a href="#cb344-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-49"><a href="#cb344-49" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb344-50"><a href="#cb344-50" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb344-51"><a href="#cb344-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb344-52"><a href="#cb344-52" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb344-53"><a href="#cb344-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb344-54"><a href="#cb344-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-55"><a href="#cb344-55" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb344-56"><a href="#cb344-56" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb344-57"><a href="#cb344-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb344-58"><a href="#cb344-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-59"><a href="#cb344-59" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb344-60"><a href="#cb344-60" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb344-61"><a href="#cb344-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb344-62"><a href="#cb344-62" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb344-63"><a href="#cb344-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb344-64"><a href="#cb344-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-65"><a href="#cb344-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb344-66"><a href="#cb344-66" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb344-67"><a href="#cb344-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb344-68"><a href="#cb344-68" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb344-69"><a href="#cb344-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb344-70"><a href="#cb344-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-71"><a href="#cb344-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_dict(x: np.ndarray, r: List[<span class="bu">str</span>], c: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb344-72"><a href="#cb344-72" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb344-73"><a href="#cb344-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">0</span>]):</span>
<span id="cb344-74"><a href="#cb344-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">1</span>]):</span>
<span id="cb344-75"><a href="#cb344-75" aria-hidden="true" tabindex="-1"></a>            g[r[i], c[j]] <span class="op">=</span> x[i][j]</span>
<span id="cb344-76"><a href="#cb344-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g</span>
<span id="cb344-77"><a href="#cb344-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-78"><a href="#cb344-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_pi2(seq: <span class="bu">str</span>, fwd: np.ndarray, bak: np.ndarray, tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], states: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb344-79"><a href="#cb344-79" aria-hidden="true" tabindex="-1"></a>    rep_mat <span class="op">=</span> np.zeros((fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb344-80"><a href="#cb344-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb344-81"><a href="#cb344-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, s1 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-82"><a href="#cb344-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k, s2 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-83"><a href="#cb344-83" aria-hidden="true" tabindex="-1"></a>                weight <span class="op">=</span> tmat[s1, s2] <span class="op">*</span> emat[s2, seq[i <span class="op">+</span> <span class="dv">1</span>]]</span>
<span id="cb344-84"><a href="#cb344-84" aria-hidden="true" tabindex="-1"></a>                rep_mat[i, j, k] <span class="op">=</span> (</span>
<span id="cb344-85"><a href="#cb344-85" aria-hidden="true" tabindex="-1"></a>                    fwd[i, j] <span class="op">*</span> bak[i <span class="op">+</span> <span class="dv">1</span>, k] <span class="op">*</span> weight <span class="op">/</span> <span class="bu">sum</span>(fwd[i, :] <span class="op">*</span> bak[i, :])</span>
<span id="cb344-86"><a href="#cb344-86" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb344-87"><a href="#cb344-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rep_mat</span>
<span id="cb344-88"><a href="#cb344-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-89"><a href="#cb344-89" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_tmat(seq: <span class="bu">str</span>, st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb344-90"><a href="#cb344-90" aria-hidden="true" tabindex="-1"></a>    fwd <span class="op">=</span> forward(seq, st, tmat, emat)</span>
<span id="cb344-91"><a href="#cb344-91" aria-hidden="true" tabindex="-1"></a>    bak <span class="op">=</span> backward(seq, st, tmat, emat)</span>
<span id="cb344-92"><a href="#cb344-92" aria-hidden="true" tabindex="-1"></a>    pi2 <span class="op">=</span> estimate_pi2(seq, fwd, bak, tmat, emat, st)</span>
<span id="cb344-93"><a href="#cb344-93" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> np.<span class="bu">sum</span>(pi2, <span class="dv">0</span>)</span>
<span id="cb344-94"><a href="#cb344-94" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> tmat_new <span class="op">/</span> np.<span class="bu">sum</span>(tmat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb344-95"><a href="#cb344-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(tmat_new, st, st)</span>
<span id="cb344-96"><a href="#cb344-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-97"><a href="#cb344-97" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emat(seq: <span class="bu">str</span>, al: List[<span class="bu">str</span>], st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb344-98"><a href="#cb344-98" aria-hidden="true" tabindex="-1"></a>    pi1 <span class="op">=</span> soft_decode(seq, st, tmat, emat)</span>
<span id="cb344-99"><a href="#cb344-99" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> np.zeros((<span class="bu">len</span>(st), <span class="bu">len</span>(al)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb344-100"><a href="#cb344-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(al):</span>
<span id="cb344-101"><a href="#cb344-101" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> np.array(<span class="bu">list</span>(seq)) <span class="op">==</span> emission</span>
<span id="cb344-102"><a href="#cb344-102" aria-hidden="true" tabindex="-1"></a>        emat_new[:, i] <span class="op">=</span> np.<span class="bu">sum</span>(pi1[ind, :], <span class="dv">0</span>)</span>
<span id="cb344-103"><a href="#cb344-103" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> emat_new <span class="op">/</span> np.<span class="bu">sum</span>(emat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb344-104"><a href="#cb344-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(emat_new, st, al)</span>
<span id="cb344-105"><a href="#cb344-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-106"><a href="#cb344-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb344-107"><a href="#cb344-107" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb344-108"><a href="#cb344-108" aria-hidden="true" tabindex="-1"></a>    niter, seq, st, al, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb344-109"><a href="#cb344-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb344-110"><a href="#cb344-110" aria-hidden="true" tabindex="-1"></a>        tmat2 <span class="op">=</span> estimate_tmat(seq, st, tmat, emat)</span>
<span id="cb344-111"><a href="#cb344-111" aria-hidden="true" tabindex="-1"></a>        emat2 <span class="op">=</span> estimate_emat(seq, al, st, tmat, emat)</span>
<span id="cb344-112"><a href="#cb344-112" aria-hidden="true" tabindex="-1"></a>        emat, tmat <span class="op">=</span> emat2, tmat2</span>
<span id="cb344-113"><a href="#cb344-113" aria-hidden="true" tabindex="-1"></a>    print_dict(tmat, st, st)</span>
<span id="cb344-114"><a href="#cb344-114" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb344-115"><a href="#cb344-115" aria-hidden="true" tabindex="-1"></a>    print_dict(emat, st, al)</span>
<span id="cb344-116"><a href="#cb344-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-117"><a href="#cb344-117" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb344-118"><a href="#cb344-118" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb344-119"><a href="#cb344-119" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-120"><a href="#cb344-120" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzyzyxy</span></span>
<span id="cb344-121"><a href="#cb344-121" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-122"><a href="#cb344-122" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb344-123"><a href="#cb344-123" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-124"><a href="#cb344-124" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb344-125"><a href="#cb344-125" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-126"><a href="#cb344-126" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb344-127"><a href="#cb344-127" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.019   0.981 </span></span>
<span id="cb344-128"><a href="#cb344-128" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.668   0.332 </span></span>
<span id="cb344-129"><a href="#cb344-129" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-130"><a href="#cb344-130" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb344-131"><a href="#cb344-131" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.175   0.003   0.821 </span></span>
<span id="cb344-132"><a href="#cb344-132" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.196   0.512   0.293</span></span>
<span id="cb344-133"><a href="#cb344-133" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb344-134"><a href="#cb344-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-135"><a href="#cb344-135" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-graph-of-a-spectrum" class="level1" data-number="115">
<h1 data-number="115"><span class="header-section-number">115</span> Construct the Graph of a Spectrum</h1>
<p>Spectrum Graph Construction. Construct the graph of a spectrum.</p>
<p>Given:&nbsp;A space-delimited list of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;<em>Graph(Spectrum)</em>.</p>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
<section id="sample-dataset-115" class="level2" data-number="115.1">
<h2 data-number="115.1" class="anchored" data-anchor-id="sample-dataset-115"><span class="header-section-number">115.1</span> Sample Dataset</h2>
<pre><code>57 71 154 185 301 332 415 429 486</code></pre>
</section>
<section id="sample-output-115" class="level2" data-number="115.2">
<h2 data-number="115.2" class="anchored" data-anchor-id="sample-output-115"><span class="header-section-number">115.2</span> Sample Output</h2>
<pre><code>0-&gt;57:G
0-&gt;71:A
57-&gt;154:P
57-&gt;185:K
71-&gt;185:N
154-&gt;301:F
185-&gt;332:F
301-&gt;415:N
301-&gt;429:K
332-&gt;429:P
415-&gt;486:A
429-&gt;486:G</code></pre>
</section>
<section id="solution-115" class="level2" data-number="115.3">
<h2 data-number="115.3" class="anchored" data-anchor-id="solution-115"><span class="header-section-number">115.3</span> Solution</h2>
<div class="sourceCode" id="cb347"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, DefaultDict</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Amino acid weights dictionary</span></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>amino_acid_weights: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'V'</span>: <span class="dv">99</span>,</span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>,</span>
<span id="cb347-8"><a href="#cb347-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb347-9"><a href="#cb347-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'W'</span>: <span class="dv">186</span></span>
<span id="cb347-10"><a href="#cb347-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb347-11"><a href="#cb347-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-12"><a href="#cb347-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectrum_graph(masses: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb347-13"><a href="#cb347-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reverse mapping of weights to amino acids</span></span>
<span id="cb347-14"><a href="#cb347-14" aria-hidden="true" tabindex="-1"></a>    weight_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {weight: aa <span class="cf">for</span> aa, weight <span class="kw">in</span> amino_acid_weights.items()}</span>
<span id="cb347-15"><a href="#cb347-15" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb347-16"><a href="#cb347-16" aria-hidden="true" tabindex="-1"></a>    graph: DefaultDict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb347-17"><a href="#cb347-17" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb347-18"><a href="#cb347-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create graph based on mass differences</span></span>
<span id="cb347-19"><a href="#cb347-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(masses)):</span>
<span id="cb347-20"><a href="#cb347-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(masses)):</span>
<span id="cb347-21"><a href="#cb347-21" aria-hidden="true" tabindex="-1"></a>            difference: <span class="bu">int</span> <span class="op">=</span> masses[j] <span class="op">-</span> masses[i]</span>
<span id="cb347-22"><a href="#cb347-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> difference <span class="kw">in</span> weight_to_amino_acid:</span>
<span id="cb347-23"><a href="#cb347-23" aria-hidden="true" tabindex="-1"></a>                graph[masses[i]].append({<span class="st">"n"</span>: masses[j], <span class="st">"l"</span>: weight_to_amino_acid[difference]})</span>
<span id="cb347-24"><a href="#cb347-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb347-25"><a href="#cb347-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb347-26"><a href="#cb347-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-27"><a href="#cb347-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb347-28"><a href="#cb347-28" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"57 71 154 185 301 332 415 429 486"</span></span>
<span id="cb347-29"><a href="#cb347-29" aria-hidden="true" tabindex="-1"></a>masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, sample_input.split()))</span>
<span id="cb347-30"><a href="#cb347-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-31"><a href="#cb347-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the spectrum graph</span></span>
<span id="cb347-32"><a href="#cb347-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_mass, edges <span class="kw">in</span> spectrum_graph(masses).items():</span>
<span id="cb347-33"><a href="#cb347-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb347-34"><a href="#cb347-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>start_mass<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>edge[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>edge[<span class="st">'l'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-decodingidealspectrum" class="level1" data-number="116">
<h1 data-number="116"><span class="header-section-number">116</span> Implement DecodingIdealSpectrum</h1>
<p>Decoding an Ideal Spectrum Problem. Reconstruct a peptide from its ideal spectrum.</p>
<p>Given:&nbsp;A space-delimited list of integers,&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;An amino acid string with an ideal spectrum that matches&nbsp;<em>Spectrum</em>.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-116" class="level2" data-number="116.1">
<h2 data-number="116.1" class="anchored" data-anchor-id="sample-dataset-116"><span class="header-section-number">116.1</span> Sample Dataset</h2>
<pre><code>57 71 154 185 301 332 415 429 486</code></pre>
</section>
<section id="sample-output-116" class="level2" data-number="116.2">
<h2 data-number="116.2" class="anchored" data-anchor-id="sample-output-116"><span class="header-section-number">116.2</span> Sample Output</h2>
<pre><code>GPFNA</code></pre>
</section>
<section id="solution-116" class="level2" data-number="116.3">
<h2 data-number="116.3" class="anchored" data-anchor-id="solution-116"><span class="header-section-number">116.3</span> Solution</h2>
<div class="sourceCode" id="cb350"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> amino_acid_masses.items()}</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_spectrum_graph(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a>    adjacency_list: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum)):</span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectrum)):</span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spectrum[j] <span class="op">-</span> spectrum[i] <span class="kw">in</span> mass_to_amino_acid.keys():</span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true" tabindex="-1"></a>                adjacency_list.append([spectrum[i], spectrum[j], mass_to_amino_acid[spectrum[j] <span class="op">-</span> spectrum[i]]])</span>
<span id="cb350-16"><a href="#cb350-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb350-17"><a href="#cb350-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-18"><a href="#cb350-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-19"><a href="#cb350-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_ideal_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb350-20"><a href="#cb350-20" aria-hidden="true" tabindex="-1"></a>    prefix_mass: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb350-21"><a href="#cb350-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb350-22"><a href="#cb350-22" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">=</span> prefix_mass[i] <span class="op">+</span> amino_acid_masses[peptide[i]]</span>
<span id="cb350-23"><a href="#cb350-23" aria-hidden="true" tabindex="-1"></a>        prefix_mass.append(temp)</span>
<span id="cb350-24"><a href="#cb350-24" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb350-25"><a href="#cb350-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb350-26"><a href="#cb350-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb350-27"><a href="#cb350-27" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(prefix_mass[j] <span class="op">-</span> prefix_mass[i])</span>
<span id="cb350-28"><a href="#cb350-28" aria-hidden="true" tabindex="-1"></a>    linear_spectrum.sort()</span>
<span id="cb350-29"><a href="#cb350-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_spectrum</span>
<span id="cb350-30"><a href="#cb350-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-31"><a href="#cb350-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-32"><a href="#cb350-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_paths(adjacency_list: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb350-33"><a href="#cb350-33" aria-hidden="true" tabindex="-1"></a>    node: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb350-34"><a href="#cb350-34" aria-hidden="true" tabindex="-1"></a>    peptide_list: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb350-35"><a href="#cb350-35" aria-hidden="true" tabindex="-1"></a>    tmp_edges: List[List[List[<span class="bu">int</span>]]] <span class="op">=</span> []</span>
<span id="cb350-36"><a href="#cb350-36" aria-hidden="true" tabindex="-1"></a>    peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span></span>
<span id="cb350-37"><a href="#cb350-37" aria-hidden="true" tabindex="-1"></a>    tmp_peps: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb350-38"><a href="#cb350-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-39"><a href="#cb350-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">any</span>([<span class="bu">len</span>(x) <span class="op">!=</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> tmp_edges]) <span class="kw">or</span> <span class="bu">len</span>(tmp_edges) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb350-40"><a href="#cb350-40" aria-hidden="true" tabindex="-1"></a>        next_edges: List[List[<span class="bu">int</span>]] <span class="op">=</span> [e <span class="cf">for</span> e <span class="kw">in</span> adjacency_list <span class="cf">if</span> e[<span class="dv">0</span>] <span class="op">==</span> node]</span>
<span id="cb350-41"><a href="#cb350-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(next_edges) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb350-42"><a href="#cb350-42" aria-hidden="true" tabindex="-1"></a>            tmp <span class="op">=</span> next_edges[<span class="dv">1</span>:]</span>
<span id="cb350-43"><a href="#cb350-43" aria-hidden="true" tabindex="-1"></a>            tmp_edges.append(tmp)</span>
<span id="cb350-44"><a href="#cb350-44" aria-hidden="true" tabindex="-1"></a>            tmp_peps.append(peptide)</span>
<span id="cb350-45"><a href="#cb350-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-46"><a href="#cb350-46" aria-hidden="true" tabindex="-1"></a>        next_edge <span class="op">=</span> next_edges[<span class="dv">0</span>]</span>
<span id="cb350-47"><a href="#cb350-47" aria-hidden="true" tabindex="-1"></a>        peptide <span class="op">+=</span> next_edge[<span class="dv">2</span>]</span>
<span id="cb350-48"><a href="#cb350-48" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> next_edge[<span class="dv">1</span>]</span>
<span id="cb350-49"><a href="#cb350-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-50"><a href="#cb350-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>([e <span class="cf">for</span> e <span class="kw">in</span> adjacency_list <span class="cf">if</span> e[<span class="dv">0</span>] <span class="op">==</span> node]) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb350-51"><a href="#cb350-51" aria-hidden="true" tabindex="-1"></a>            tmp <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> tmp_edges <span class="cf">if</span> <span class="bu">len</span>(x) <span class="op">!=</span> <span class="dv">0</span>][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb350-52"><a href="#cb350-52" aria-hidden="true" tabindex="-1"></a>            next_edge <span class="op">=</span> tmp.pop()</span>
<span id="cb350-53"><a href="#cb350-53" aria-hidden="true" tabindex="-1"></a>            node <span class="op">=</span> next_edge[<span class="dv">1</span>]</span>
<span id="cb350-54"><a href="#cb350-54" aria-hidden="true" tabindex="-1"></a>            peptide_list.append(peptide)</span>
<span id="cb350-55"><a href="#cb350-55" aria-hidden="true" tabindex="-1"></a>            tmp_pep <span class="op">=</span> tmp_peps.pop()</span>
<span id="cb350-56"><a href="#cb350-56" aria-hidden="true" tabindex="-1"></a>            peptide <span class="op">=</span> tmp_pep <span class="op">+</span> next_edge[<span class="dv">2</span>]</span>
<span id="cb350-57"><a href="#cb350-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-58"><a href="#cb350-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide_list</span>
<span id="cb350-59"><a href="#cb350-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-60"><a href="#cb350-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-61"><a href="#cb350-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> decode_ideal_spectrum(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb350-62"><a href="#cb350-62" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> create_spectrum_graph(spectrum)</span>
<span id="cb350-63"><a href="#cb350-63" aria-hidden="true" tabindex="-1"></a>    all_paths <span class="op">=</span> find_paths(adjacency_list)</span>
<span id="cb350-64"><a href="#cb350-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> all_paths:</span>
<span id="cb350-65"><a href="#cb350-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">set</span>(spectrum).issubset(calculate_ideal_spectrum(peptide)):</span>
<span id="cb350-66"><a href="#cb350-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> peptide</span>
<span id="cb350-67"><a href="#cb350-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-68"><a href="#cb350-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-69"><a href="#cb350-69" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb350-70"><a href="#cb350-70" aria-hidden="true" tabindex="-1"></a><span class="st">57 71 154 185 301 332 415 429 486</span></span>
<span id="cb350-71"><a href="#cb350-71" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb350-72"><a href="#cb350-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-73"><a href="#cb350-73" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(s) <span class="cf">for</span> s <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb350-74"><a href="#cb350-74" aria-hidden="true" tabindex="-1"></a>spectrum <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> spectrum</span>
<span id="cb350-75"><a href="#cb350-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-76"><a href="#cb350-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(decode_ideal_spectrum(spectrum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="convert-a-peptide-into-a-peptide-vector" class="level1" data-number="117">
<h1 data-number="117"><span class="header-section-number">117</span> Convert a Peptide into a Peptide Vector</h1>
<p>Given:&nbsp;A peptide&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The peptide vector of&nbsp;<em>P</em>.</p>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
<section id="sample-dataset-117" class="level2" data-number="117.1">
<h2 data-number="117.1" class="anchored" data-anchor-id="sample-dataset-117"><span class="header-section-number">117.1</span> Sample Dataset</h2>
<pre><code>XZZXX</code></pre>
</section>
<section id="sample-output-117" class="level2" data-number="117.2">
<h2 data-number="117.2" class="anchored" data-anchor-id="sample-output-117"><span class="header-section-number">117.2</span> Sample Output</h2>
<pre><code>0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1</code></pre>
</section>
<section id="solution-117" class="level2" data-number="117.3">
<h2 data-number="117.3" class="anchored" data-anchor-id="solution-117"><span class="header-section-number">117.3</span> Solution</h2>
<div class="sourceCode" id="cb353"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>,</span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span></span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_peptide_vector(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb353-12"><a href="#cb353-12" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> peptide[:i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb353-13"><a href="#cb353-13" aria-hidden="true" tabindex="-1"></a>        mass <span class="op">=</span> <span class="bu">sum</span>(amino_acid_masses[aa] <span class="cf">for</span> aa <span class="kw">in</span> prefix)</span>
<span id="cb353-14"><a href="#cb353-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(mass)</span>
<span id="cb353-15"><a href="#cb353-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-16"><a href="#cb353-16" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb353-17"><a href="#cb353-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses:</span>
<span id="cb353-18"><a href="#cb353-18" aria-hidden="true" tabindex="-1"></a>        vector[mass <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb353-19"><a href="#cb353-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vector</span>
<span id="cb353-20"><a href="#cb353-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-21"><a href="#cb353-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-22"><a href="#cb353-22" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb353-23"><a href="#cb353-23" aria-hidden="true" tabindex="-1"></a><span class="st">XZZXX</span></span>
<span id="cb353-24"><a href="#cb353-24" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb353-25"><a href="#cb353-25" aria-hidden="true" tabindex="-1"></a>peptide: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb353-26"><a href="#cb353-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>.join(<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> create_peptide_vector(peptide)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="convert-a-peptide-vector-into-a-peptide" class="level1" data-number="118">
<h1 data-number="118"><span class="header-section-number">118</span> Convert a Peptide Vector into a Peptide</h1>
<p>Given:&nbsp;A space-delimited binary vector&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;A peptide whose binary peptide vector matches&nbsp;<em>P</em>. For masses with more than one amino acid, any choice may be used.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-118" class="level2" data-number="118.1">
<h2 data-number="118.1" class="anchored" data-anchor-id="sample-dataset-118"><span class="header-section-number">118.1</span> Sample Dataset</h2>
<pre><code>0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1</code></pre>
</section>
<section id="sample-output-118" class="level2" data-number="118.2">
<h2 data-number="118.2" class="anchored" data-anchor-id="sample-output-118"><span class="header-section-number">118.2</span> Sample Output</h2>
<pre><code>XZZXX</code></pre>
</section>
<section id="solution-118" class="level2" data-number="118.3">
<h2 data-number="118.3" class="anchored" data-anchor-id="solution-118"><span class="header-section-number">118.3</span> Solution</h2>
<div class="sourceCode" id="cb356"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> amino_acid_masses.items()}</span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid[<span class="dv">4</span>] <span class="op">=</span> <span class="st">'X'</span></span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid[<span class="dv">5</span>] <span class="op">=</span> <span class="st">'Z'</span></span>
<span id="cb356-10"><a href="#cb356-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-11"><a href="#cb356-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-12"><a href="#cb356-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_peptide_vector_to_sequence(vector: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb356-13"><a href="#cb356-13" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [i <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(vector) <span class="cf">if</span> v <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb356-14"><a href="#cb356-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-15"><a href="#cb356-15" aria-hidden="true" tabindex="-1"></a>    peptide: <span class="bu">str</span> <span class="op">=</span> mass_to_amino_acid[prefix_masses[<span class="dv">0</span>]]</span>
<span id="cb356-16"><a href="#cb356-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(prefix_masses)):</span>
<span id="cb356-17"><a href="#cb356-17" aria-hidden="true" tabindex="-1"></a>        mass <span class="op">=</span> prefix_masses[i] <span class="op">-</span> prefix_masses[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb356-18"><a href="#cb356-18" aria-hidden="true" tabindex="-1"></a>        peptide <span class="op">+=</span> mass_to_amino_acid[mass]</span>
<span id="cb356-19"><a href="#cb356-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-20"><a href="#cb356-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide</span>
<span id="cb356-21"><a href="#cb356-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-22"><a href="#cb356-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-23"><a href="#cb356-23" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb356-24"><a href="#cb356-24" aria-hidden="true" tabindex="-1"></a><span class="st">0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1</span></span>
<span id="cb356-25"><a href="#cb356-25" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb356-26"><a href="#cb356-26" aria-hidden="true" tabindex="-1"></a>vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb356-27"><a href="#cb356-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-28"><a href="#cb356-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(convert_peptide_vector_to_sequence(vector))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="sequence-a-peptide" class="level1" data-number="119">
<h1 data-number="119"><span class="header-section-number">119</span> Sequence a Peptide</h1>
<p>Peptide Sequencing Problem. Given a spectral vector S, find a peptide vector with maximum score against S.</p>
<p>Given:&nbsp;A space-delimited spectral vector&nbsp;<em>S</em>.</p>
<p>Return:&nbsp;A peptide with maximum score against&nbsp;<em>S</em>. For masses with more than one amino acid, any choice may be used.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-119" class="level2" data-number="119.1">
<h2 data-number="119.1" class="anchored" data-anchor-id="sample-dataset-119"><span class="header-section-number">119.1</span> Sample Dataset</h2>
<pre><code>0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 0</code></pre>
</section>
<section id="sample-output-119" class="level2" data-number="119.2">
<h2 data-number="119.2" class="anchored" data-anchor-id="sample-output-119"><span class="header-section-number">119.2</span> Sample Output</h2>
<pre><code>XZZXX</code></pre>
</section>
<section id="solution-119" class="level2" data-number="119.3">
<h2 data-number="119.3" class="anchored" data-anchor-id="solution-119"><span class="header-section-number">119.3</span> Solution</h2>
<div class="sourceCode" id="cb359"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> amino_acid_masses.items()}</span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sequence_peptide(spectral_vector: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>    spectral_vector <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> spectral_vector</span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>    adjacency_list: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectral_vector)):</span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (j <span class="op">-</span> i) <span class="kw">in</span> mass_to_amino_acid.keys():</span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>                adjacency_list.append([i, j])</span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-19"><a href="#cb359-19" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">int</span>, List[List[Union[<span class="bu">int</span>, <span class="bu">str</span>]]]] <span class="op">=</span> {}</span>
<span id="cb359-20"><a href="#cb359-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb359-21"><a href="#cb359-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectral_vector)):</span>
<span id="cb359-22"><a href="#cb359-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (j <span class="op">-</span> i) <span class="kw">in</span> mass_to_amino_acid.keys():</span>
<span id="cb359-23"><a href="#cb359-23" aria-hidden="true" tabindex="-1"></a>                edge <span class="op">=</span> [i, mass_to_amino_acid[j <span class="op">-</span> i]]</span>
<span id="cb359-24"><a href="#cb359-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> j <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb359-25"><a href="#cb359-25" aria-hidden="true" tabindex="-1"></a>                    adjacency_dict[j] <span class="op">=</span> [edge]</span>
<span id="cb359-26"><a href="#cb359-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb359-27"><a href="#cb359-27" aria-hidden="true" tabindex="-1"></a>                    adjacency_dict[j].append(edge)</span>
<span id="cb359-28"><a href="#cb359-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-29"><a href="#cb359-29" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, List[Union[<span class="bu">float</span>, <span class="bu">str</span>]]] <span class="op">=</span> {<span class="dv">0</span>: [<span class="dv">0</span>, <span class="st">'-'</span>]}</span>
<span id="cb359-30"><a href="#cb359-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> adjacency_dict.keys():</span>
<span id="cb359-31"><a href="#cb359-31" aria-hidden="true" tabindex="-1"></a>        scores[node] <span class="op">=</span> [<span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'-'</span>]</span>
<span id="cb359-32"><a href="#cb359-32" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> adjacency_dict[node]</span>
<span id="cb359-33"><a href="#cb359-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb359-34"><a href="#cb359-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> edge[<span class="dv">0</span>] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb359-35"><a href="#cb359-35" aria-hidden="true" tabindex="-1"></a>                scores[edge[<span class="dv">0</span>]] <span class="op">=</span> [<span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'-'</span>]</span>
<span id="cb359-36"><a href="#cb359-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-37"><a href="#cb359-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> adjacency_dict.keys():</span>
<span id="cb359-38"><a href="#cb359-38" aria-hidden="true" tabindex="-1"></a>        max_score: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb359-39"><a href="#cb359-39" aria-hidden="true" tabindex="-1"></a>        best_edge: Union[<span class="bu">str</span>, List[Union[<span class="bu">int</span>, <span class="bu">str</span>]]] <span class="op">=</span> <span class="st">'-'</span></span>
<span id="cb359-40"><a href="#cb359-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> parent <span class="kw">in</span> adjacency_dict[node]:</span>
<span id="cb359-41"><a href="#cb359-41" aria-hidden="true" tabindex="-1"></a>            score <span class="op">=</span> scores[parent[<span class="dv">0</span>]][<span class="dv">0</span>]</span>
<span id="cb359-42"><a href="#cb359-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score <span class="op">&gt;</span> max_score:</span>
<span id="cb359-43"><a href="#cb359-43" aria-hidden="true" tabindex="-1"></a>                max_score <span class="op">=</span> score</span>
<span id="cb359-44"><a href="#cb359-44" aria-hidden="true" tabindex="-1"></a>                best_edge <span class="op">=</span> parent</span>
<span id="cb359-45"><a href="#cb359-45" aria-hidden="true" tabindex="-1"></a>        scores[node] <span class="op">=</span> [max_score <span class="op">+</span> spectral_vector[node], best_edge]</span>
<span id="cb359-46"><a href="#cb359-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-47"><a href="#cb359-47" aria-hidden="true" tabindex="-1"></a>    node: <span class="bu">int</span> <span class="op">=</span> <span class="bu">list</span>(scores.keys())[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb359-48"><a href="#cb359-48" aria-hidden="true" tabindex="-1"></a>    peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span></span>
<span id="cb359-49"><a href="#cb359-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb359-50"><a href="#cb359-50" aria-hidden="true" tabindex="-1"></a>        peptide <span class="op">=</span> scores[node][<span class="dv">1</span>][<span class="dv">1</span>] <span class="op">+</span> peptide</span>
<span id="cb359-51"><a href="#cb359-51" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> scores[node][<span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb359-52"><a href="#cb359-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-53"><a href="#cb359-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide</span>
<span id="cb359-54"><a href="#cb359-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-55"><a href="#cb359-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-56"><a href="#cb359-56" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb359-57"><a href="#cb359-57" aria-hidden="true" tabindex="-1"></a><span class="st">0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 0</span></span>
<span id="cb359-58"><a href="#cb359-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb359-59"><a href="#cb359-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-60"><a href="#cb359-60" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.split()]</span>
<span id="cb359-61"><a href="#cb359-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-62"><a href="#cb359-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sequence_peptide(spectral_vector))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-peptide-in-a-proteome-against-a-spectrum" class="level1" data-number="120">
<h1 data-number="120"><span class="header-section-number">120</span> Find a Highest-Scoring Peptide in a Proteome against a Spectrum</h1>
<p>Peptide Identification Problem. Find a peptide from a proteome with maximum score against a spectrum.</p>
<p>Given:&nbsp;A space-delimited spectral vector&nbsp;<em>S</em>&nbsp;and an amino acid string&nbsp;<em>Proteome</em>.</p>
<p>Return:&nbsp;A peptide in&nbsp;<em>Proteome</em>&nbsp;with maximum score against&nbsp;<em>S</em>.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-120" class="level2" data-number="120.1">
<h2 data-number="120.1" class="anchored" data-anchor-id="sample-dataset-120"><span class="header-section-number">120.1</span> Sample Dataset</h2>
<pre><code>0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 8
XZZXZXXXZXZZXZXXZ</code></pre>
</section>
<section id="sample-output-120" class="level2" data-number="120.2">
<h2 data-number="120.2" class="anchored" data-anchor-id="sample-output-120"><span class="header-section-number">120.2</span> Sample Output</h2>
<pre><code>ZXZXX</code></pre>
</section>
<section id="solution-120" class="level2" data-number="120.3">
<h2 data-number="120.3" class="anchored" data-anchor-id="solution-120"><span class="header-section-number">120.3</span> Solution</h2>
<div class="sourceCode" id="cb362"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>,</span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span>  <span class="co"># Added 'X' and 'Z' with arbitrary masses</span></span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_peptide_vector(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb362-10"><a href="#cb362-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb362-11"><a href="#cb362-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb362-12"><a href="#cb362-12" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> amino_acid_masses[amino_acid])</span>
<span id="cb362-13"><a href="#cb362-13" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb362-14"><a href="#cb362-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses[<span class="dv">1</span>:]:</span>
<span id="cb362-15"><a href="#cb362-15" aria-hidden="true" tabindex="-1"></a>        vector[mass <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb362-16"><a href="#cb362-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vector</span>
<span id="cb362-17"><a href="#cb362-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-18"><a href="#cb362-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> identify_peptide(spectral_vector: List[<span class="bu">int</span>], proteome: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb362-19"><a href="#cb362-19" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">float</span>(<span class="st">'-inf'</span>)</span>
<span id="cb362-20"><a href="#cb362-20" aria-hidden="true" tabindex="-1"></a>    best_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb362-21"><a href="#cb362-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-22"><a href="#cb362-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(proteome)):</span>
<span id="cb362-23"><a href="#cb362-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(proteome) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb362-24"><a href="#cb362-24" aria-hidden="true" tabindex="-1"></a>            peptide: <span class="bu">str</span> <span class="op">=</span> proteome[i:j]</span>
<span id="cb362-25"><a href="#cb362-25" aria-hidden="true" tabindex="-1"></a>            peptide_vector: List[<span class="bu">int</span>] <span class="op">=</span> create_peptide_vector(peptide)</span>
<span id="cb362-26"><a href="#cb362-26" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb362-27"><a href="#cb362-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">&gt;</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb362-28"><a href="#cb362-28" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb362-29"><a href="#cb362-29" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb362-30"><a href="#cb362-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">==</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb362-31"><a href="#cb362-31" aria-hidden="true" tabindex="-1"></a>                score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">sum</span>(s <span class="op">*</span> v <span class="cf">for</span> s, v <span class="kw">in</span> <span class="bu">zip</span>(spectral_vector, peptide_vector))</span>
<span id="cb362-32"><a href="#cb362-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> score <span class="op">&gt;</span> max_score:</span>
<span id="cb362-33"><a href="#cb362-33" aria-hidden="true" tabindex="-1"></a>                    max_score <span class="op">=</span> score</span>
<span id="cb362-34"><a href="#cb362-34" aria-hidden="true" tabindex="-1"></a>                    best_peptide <span class="op">=</span> peptide</span>
<span id="cb362-35"><a href="#cb362-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-36"><a href="#cb362-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_peptide</span>
<span id="cb362-37"><a href="#cb362-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-38"><a href="#cb362-38" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb362-39"><a href="#cb362-39" aria-hidden="true" tabindex="-1"></a><span class="st">0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 8</span></span>
<span id="cb362-40"><a href="#cb362-40" aria-hidden="true" tabindex="-1"></a><span class="st">XZZXZXXXZXZZXZXXZ</span></span>
<span id="cb362-41"><a href="#cb362-41" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb362-42"><a href="#cb362-42" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb362-43"><a href="#cb362-43" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">0</span>].strip().split()]</span>
<span id="cb362-44"><a href="#cb362-44" aria-hidden="true" tabindex="-1"></a>proteome: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>].strip()</span>
<span id="cb362-45"><a href="#cb362-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(identify_peptide(spectral_vector, proteome))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-psmsearch" class="level1" data-number="121">
<h1 data-number="121"><span class="header-section-number">121</span> Implement PSMSearch</h1>
<p>PSM Search Problem. Identify Peptide-Spectrum Matches by matching spectra against a proteome.</p>
<p>Given:&nbsp;A set of space-delimited spectral vectors&nbsp;<em>SpectralVectors</em>, an amino acid string&nbsp;<em>Proteome</em>, and a score threshold&nbsp;<em>T</em>.</p>
<p>Return:&nbsp;All unique Peptide-Spectrum Matches scoring at least as high as&nbsp;<em>T</em>.</p>
<p>Note: For this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X: 4, Z: 5.</p>
<section id="sample-dataset-121" class="level2" data-number="121.1">
<h2 data-number="121.1" class="anchored" data-anchor-id="sample-dataset-121"><span class="header-section-number">121.1</span> Sample Dataset</h2>
<pre><code>-1 5 -4 5 3 -1 -4 5 -1 0 0 4 -1 0 1 4 4 4
-4 2 -2 -4 4 -5 -1 4 -1 2 5 -3 -1 3 2 -3
XXXZXZXXZXZXXXZXXZX
5</code></pre>
</section>
<section id="sample-output-121" class="level2" data-number="121.2">
<h2 data-number="121.2" class="anchored" data-anchor-id="sample-output-121"><span class="header-section-number">121.2</span> Sample Output</h2>
<pre><code>XZXZ</code></pre>
</section>
<section id="solution-121" class="level2" data-number="121.3">
<h2 data-number="121.3" class="anchored" data-anchor-id="solution-121"><span class="header-section-number">121.3</span> Solution</h2>
<div class="sourceCode" id="cb365"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>,</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span>  <span class="co"># Added 'X' and 'Z' with arbitrary masses</span></span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_number(n: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">float</span>(n)</span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb365-13"><a href="#cb365-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb365-14"><a href="#cb365-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb365-15"><a href="#cb365-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-16"><a href="#cb365-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_peptide_vector(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb365-17"><a href="#cb365-17" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb365-18"><a href="#cb365-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb365-19"><a href="#cb365-19" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> amino_acid_masses[amino_acid])</span>
<span id="cb365-20"><a href="#cb365-20" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb365-21"><a href="#cb365-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses[<span class="dv">1</span>:]:</span>
<span id="cb365-22"><a href="#cb365-22" aria-hidden="true" tabindex="-1"></a>        vector[mass <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb365-23"><a href="#cb365-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vector</span>
<span id="cb365-24"><a href="#cb365-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-25"><a href="#cb365-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> identify_peptide(spectral_vector: List[<span class="bu">int</span>], proteome: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>]:</span>
<span id="cb365-26"><a href="#cb365-26" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">float</span>(<span class="st">'-inf'</span>)</span>
<span id="cb365-27"><a href="#cb365-27" aria-hidden="true" tabindex="-1"></a>    best_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span></span>
<span id="cb365-28"><a href="#cb365-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-29"><a href="#cb365-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(proteome)):</span>
<span id="cb365-30"><a href="#cb365-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(proteome) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb365-31"><a href="#cb365-31" aria-hidden="true" tabindex="-1"></a>            peptide: <span class="bu">str</span> <span class="op">=</span> proteome[i:j]</span>
<span id="cb365-32"><a href="#cb365-32" aria-hidden="true" tabindex="-1"></a>            peptide_vector: List[<span class="bu">int</span>] <span class="op">=</span> create_peptide_vector(peptide)</span>
<span id="cb365-33"><a href="#cb365-33" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb365-34"><a href="#cb365-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">&gt;</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb365-35"><a href="#cb365-35" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb365-36"><a href="#cb365-36" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb365-37"><a href="#cb365-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">==</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb365-38"><a href="#cb365-38" aria-hidden="true" tabindex="-1"></a>                score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">sum</span>(s <span class="op">*</span> v <span class="cf">for</span> s, v <span class="kw">in</span> <span class="bu">zip</span>(spectral_vector, peptide_vector))</span>
<span id="cb365-39"><a href="#cb365-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> score <span class="op">&gt;</span> max_score:</span>
<span id="cb365-40"><a href="#cb365-40" aria-hidden="true" tabindex="-1"></a>                    max_score <span class="op">=</span> score</span>
<span id="cb365-41"><a href="#cb365-41" aria-hidden="true" tabindex="-1"></a>                    best_peptide <span class="op">=</span> peptide</span>
<span id="cb365-42"><a href="#cb365-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-43"><a href="#cb365-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_peptide, max_score</span>
<span id="cb365-44"><a href="#cb365-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-45"><a href="#cb365-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> search_peptide_spectrum_matches(spectral_vectors: List[List[<span class="bu">int</span>]], proteome: <span class="bu">str</span>, threshold: <span class="bu">float</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb365-46"><a href="#cb365-46" aria-hidden="true" tabindex="-1"></a>    psm_set: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb365-47"><a href="#cb365-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vector <span class="kw">in</span> spectral_vectors:</span>
<span id="cb365-48"><a href="#cb365-48" aria-hidden="true" tabindex="-1"></a>        peptide, score <span class="op">=</span> identify_peptide(vector, proteome)</span>
<span id="cb365-49"><a href="#cb365-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&gt;=</span> threshold:</span>
<span id="cb365-50"><a href="#cb365-50" aria-hidden="true" tabindex="-1"></a>            psm_set.add(peptide)</span>
<span id="cb365-51"><a href="#cb365-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> psm_set</span>
<span id="cb365-52"><a href="#cb365-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-53"><a href="#cb365-53" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb365-54"><a href="#cb365-54" aria-hidden="true" tabindex="-1"></a><span class="st">-1 5 -4 5 3 -1 -4 5 -1 0 0 4 -1 0 1 4 4 4</span></span>
<span id="cb365-55"><a href="#cb365-55" aria-hidden="true" tabindex="-1"></a><span class="st">-4 2 -2 -4 4 -5 -1 4 -1 2 5 -3 -1 3 2 -3</span></span>
<span id="cb365-56"><a href="#cb365-56" aria-hidden="true" tabindex="-1"></a><span class="st">XXXZXZXXZXZXXXZXXZX</span></span>
<span id="cb365-57"><a href="#cb365-57" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb365-58"><a href="#cb365-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb365-59"><a href="#cb365-59" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb365-60"><a href="#cb365-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-61"><a href="#cb365-61" aria-hidden="true" tabindex="-1"></a>spectral_vectors: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb365-62"><a href="#cb365-62" aria-hidden="true" tabindex="-1"></a>idx: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb365-63"><a href="#cb365-63" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> idx <span class="op">&lt;</span> <span class="bu">len</span>(input_lines) <span class="kw">and</span> (is_number(input_lines[idx][<span class="dv">0</span>]) <span class="kw">or</span> is_number(input_lines[idx][:<span class="dv">2</span>])):</span>
<span id="cb365-64"><a href="#cb365-64" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[idx].strip().split()]</span>
<span id="cb365-65"><a href="#cb365-65" aria-hidden="true" tabindex="-1"></a>    spectral_vectors.append(vector)</span>
<span id="cb365-66"><a href="#cb365-66" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb365-67"><a href="#cb365-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-68"><a href="#cb365-68" aria-hidden="true" tabindex="-1"></a>proteome: <span class="bu">str</span> <span class="op">=</span> input_lines[idx].strip()</span>
<span id="cb365-69"><a href="#cb365-69" aria-hidden="true" tabindex="-1"></a>threshold: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[idx <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb365-70"><a href="#cb365-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-71"><a href="#cb365-71" aria-hidden="true" tabindex="-1"></a>result: Set[<span class="bu">str</span>] <span class="op">=</span> search_peptide_spectrum_matches(spectral_vectors, proteome, threshold)</span>
<span id="cb365-72"><a href="#cb365-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-73"><a href="#cb365-73" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> peptide <span class="kw">in</span> result:</span>
<span id="cb365-74"><a href="#cb365-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(peptide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-size-of-a-spectral-dictionary" class="level1" data-number="122">
<h1 data-number="122"><span class="header-section-number">122</span> Compute the Size of a Spectral Dictionary</h1>
<p>Size of Spectral Dictionary Problem. Find the size of the spectral dictionary for a given spectrum and score threshold.</p>
<p>Given:&nbsp;A spectral vector&nbsp;<em>Spectrum’</em>, an integer&nbsp;<em>threshold</em>, and an integer&nbsp;<em>max_score</em>.</p>
<p>Return:&nbsp;The size of the dictionary&nbsp;*Dictionary__threshold<em>(</em>Spectrum’*).</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;Use the provided&nbsp;<em>max_score</em>&nbsp;for the height of your table. Your answer should be the number of peptides whose score is at least&nbsp;<em>threshold</em>&nbsp;and at most&nbsp;<em>max_score</em>.</p>
</blockquote>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
<section id="sample-dataset-122" class="level2" data-number="122.1">
<h2 data-number="122.1" class="anchored" data-anchor-id="sample-dataset-122"><span class="header-section-number">122.1</span> Sample Dataset</h2>
<pre><code>4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3
1
8</code></pre>
</section>
<section id="sample-output-122" class="level2" data-number="122.2">
<h2 data-number="122.2" class="anchored" data-anchor-id="sample-output-122"><span class="header-section-number">122.2</span> Sample Output</h2>
<pre><code>0</code></pre>
</section>
<section id="solution-122" class="level2" data-number="122.3">
<h2 data-number="122.3" class="anchored" data-anchor-id="solution-122"><span class="header-section-number">122.3</span> Solution</h2>
<div class="sourceCode" id="cb368"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>mass_values: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">list</span>(amino_acid_masses.values())</span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectral_dictionary_size(spectral_vector: List[<span class="bu">int</span>], threshold: <span class="bu">int</span>, max_score: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>    vector_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(spectral_vector)</span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a>    size_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> {<span class="dv">0</span>: {<span class="dv">0</span>: <span class="dv">1</span>}}</span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>        size_matrix[<span class="dv">0</span>][t] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-16"><a href="#cb368-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vector_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb368-17"><a href="#cb368-17" aria-hidden="true" tabindex="-1"></a>        size_matrix[i] <span class="op">=</span> {}</span>
<span id="cb368-18"><a href="#cb368-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb368-19"><a href="#cb368-19" aria-hidden="true" tabindex="-1"></a>            size_matrix[i][t] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb368-20"><a href="#cb368-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mass <span class="kw">in</span> mass_values:</span>
<span id="cb368-21"><a href="#cb368-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (i <span class="op">-</span> mass) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&lt;=</span> max_score:</span>
<span id="cb368-22"><a href="#cb368-22" aria-hidden="true" tabindex="-1"></a>                    size_matrix[i][t] <span class="op">+=</span> size_matrix[i <span class="op">-</span> mass][t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb368-23"><a href="#cb368-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-24"><a href="#cb368-24" aria-hidden="true" tabindex="-1"></a>    final_size: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(size_matrix[vector_length][t] <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(threshold, max_score <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb368-25"><a href="#cb368-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-26"><a href="#cb368-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> final_size</span>
<span id="cb368-27"><a href="#cb368-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-28"><a href="#cb368-28" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb368-29"><a href="#cb368-29" aria-hidden="true" tabindex="-1"></a><span class="st">4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3</span></span>
<span id="cb368-30"><a href="#cb368-30" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb368-31"><a href="#cb368-31" aria-hidden="true" tabindex="-1"></a><span class="st">8</span></span>
<span id="cb368-32"><a href="#cb368-32" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb368-33"><a href="#cb368-33" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb368-34"><a href="#cb368-34" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">0</span>].strip().split()]</span>
<span id="cb368-35"><a href="#cb368-35" aria-hidden="true" tabindex="-1"></a>threshold: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb368-36"><a href="#cb368-36" aria-hidden="true" tabindex="-1"></a>max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb368-37"><a href="#cb368-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-38"><a href="#cb368-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_spectral_dictionary_size(spectral_vector, threshold, max_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-a-spectral-dictionary" class="level1" data-number="123">
<h1 data-number="123"><span class="header-section-number">123</span> Compute the Probability of a Spectral Dictionary</h1>
<p>Probability of Spectral Dictionary Problem. Find the probability of the spectral dictionary for a given spectrum and score threshold.</p>
<p>Given:&nbsp;A spectral vector&nbsp;<em>Spectrum’</em>, an integer&nbsp;<em>threshold</em>, and an integer&nbsp;<em>max_score</em>.</p>
<p>Return:&nbsp;The probability of the dictionary&nbsp;*Dictionary__threshold<em>(</em>Spectrum’*).</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;Use the provided&nbsp;<em>max_score</em>&nbsp;for the height of your table.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-123" class="level2" data-number="123.1">
<h2 data-number="123.1" class="anchored" data-anchor-id="sample-dataset-123"><span class="header-section-number">123.1</span> Sample Dataset</h2>
<pre><code>4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3
1
8</code></pre>
</section>
<section id="sample-output-123" class="level2" data-number="123.2">
<h2 data-number="123.2" class="anchored" data-anchor-id="sample-output-123"><span class="header-section-number">123.2</span> Sample Output</h2>
<pre><code>0</code></pre>
</section>
<section id="solution-123" class="level2" data-number="123.3">
<h2 data-number="123.3" class="anchored" data-anchor-id="solution-123"><span class="header-section-number">123.3</span> Solution</h2>
<div class="sourceCode" id="cb371"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>mass_values: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">list</span>(amino_acid_masses.values())</span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectral_dictionary_probability(spectral_vector: List[<span class="bu">int</span>], threshold: <span class="bu">int</span>, max_score: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a>    vector_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(spectral_vector)</span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a>    probability_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">float</span>]] <span class="op">=</span> {<span class="dv">0</span>: {<span class="dv">0</span>: <span class="fl">1.0</span>}}</span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb371-14"><a href="#cb371-14" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>][t] <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb371-15"><a href="#cb371-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-16"><a href="#cb371-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vector_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb371-17"><a href="#cb371-17" aria-hidden="true" tabindex="-1"></a>        probability_matrix[i] <span class="op">=</span> {}</span>
<span id="cb371-18"><a href="#cb371-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb371-19"><a href="#cb371-19" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i][t] <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb371-20"><a href="#cb371-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mass <span class="kw">in</span> mass_values:</span>
<span id="cb371-21"><a href="#cb371-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (i <span class="op">-</span> mass) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&lt;=</span> max_score:</span>
<span id="cb371-22"><a href="#cb371-22" aria-hidden="true" tabindex="-1"></a>                    probability_matrix[i][t] <span class="op">+=</span> probability_matrix[i <span class="op">-</span> mass][t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb371-23"><a href="#cb371-23" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i][t] <span class="op">/=</span> <span class="dv">20</span></span>
<span id="cb371-24"><a href="#cb371-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-25"><a href="#cb371-25" aria-hidden="true" tabindex="-1"></a>    final_probability: <span class="bu">float</span> <span class="op">=</span> <span class="bu">sum</span>(probability_matrix[vector_length][t] <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(threshold, max_score <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb371-26"><a href="#cb371-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-27"><a href="#cb371-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> final_probability</span>
<span id="cb371-28"><a href="#cb371-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-29"><a href="#cb371-29" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb371-30"><a href="#cb371-30" aria-hidden="true" tabindex="-1"></a><span class="st">4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3</span></span>
<span id="cb371-31"><a href="#cb371-31" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb371-32"><a href="#cb371-32" aria-hidden="true" tabindex="-1"></a><span class="st">8</span></span>
<span id="cb371-33"><a href="#cb371-33" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb371-34"><a href="#cb371-34" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb371-35"><a href="#cb371-35" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">0</span>].strip().split()]</span>
<span id="cb371-36"><a href="#cb371-36" aria-hidden="true" tabindex="-1"></a>threshold: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb371-37"><a href="#cb371-37" aria-hidden="true" tabindex="-1"></a>max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb371-38"><a href="#cb371-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-39"><a href="#cb371-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_spectral_dictionary_probability(spectral_vector, threshold, max_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-modified-peptide-against-a-spectrum" class="level1" data-number="124">
<h1 data-number="124"><span class="header-section-number">124</span> Find a Highest-Scoring Modified Peptide against a Spectrum</h1>
<p>Spectral Alignment Problem. Given a peptide and a spectral vector, find a modified variant of this peptide that maximizes the peptide-spectrum score among all variants of the peptides with up to k modifications.</p>
<p>Given:&nbsp;A peptide&nbsp;<em>Peptide</em>, a spectral vector&nbsp;<em>Spectrum’</em>, and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;A peptide&nbsp;<em>Peptide’</em>&nbsp;related to&nbsp;<em>Peptide</em>&nbsp;by up to&nbsp;<em>k</em>&nbsp;modifications with maximal score against&nbsp;<em>Spectrum’</em>&nbsp;out of all possibilities.</p>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
<section id="sample-dataset-124" class="level2" data-number="124.1">
<h2 data-number="124.1" class="anchored" data-anchor-id="sample-dataset-124"><span class="header-section-number">124.1</span> Sample Dataset</h2>
<pre><code>XXZ
4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3
2</code></pre>
</section>
<section id="sample-output-124" class="level2" data-number="124.2">
<h2 data-number="124.2" class="anchored" data-anchor-id="sample-output-124"><span class="header-section-number">124.2</span> Sample Output</h2>
<pre><code>XX(-1)Z(+2)</code></pre>
</section>
<section id="solution-124" class="level2" data-number="124.3">
<h2 data-number="124.3" class="anchored" data-anchor-id="solution-124"><span class="header-section-number">124.3</span> Solution</h2>
<div class="sourceCode" id="cb374"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>,</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span>  <span class="co"># Added 'X' and 'Z' with arbitrary masses</span></span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-9"><a href="#cb374-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_score_matrix(score_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">float</span>]]], prefix_masses: List[<span class="bu">int</span>], spectral_vector: List[<span class="bu">int</span>], max_k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb374-10"><a href="#cb374-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">2</span>, max_k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb374-11"><a href="#cb374-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> t <span class="op">==</span> <span class="op">-</span><span class="dv">2</span>:</span>
<span id="cb374-12"><a href="#cb374-12" aria-hidden="true" tabindex="-1"></a>            formatted_vector <span class="op">=</span> [<span class="bu">str</span>(x).rjust(<span class="dv">3</span>) <span class="cf">for</span> x <span class="kw">in</span> spectral_vector]</span>
<span id="cb374-13"><a href="#cb374-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'   '</span>, <span class="op">*</span>formatted_vector)</span>
<span id="cb374-14"><a href="#cb374-14" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb374-15"><a href="#cb374-15" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb374-16"><a href="#cb374-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> t <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb374-17"><a href="#cb374-17" aria-hidden="true" tabindex="-1"></a>            header <span class="op">=</span> [<span class="bu">str</span>(i).rjust(<span class="dv">3</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector))]</span>
<span id="cb374-18"><a href="#cb374-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'   '</span>, <span class="op">*</span>header)</span>
<span id="cb374-19"><a href="#cb374-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb374-20"><a href="#cb374-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses:</span>
<span id="cb374-21"><a href="#cb374-21" aria-hidden="true" tabindex="-1"></a>                row <span class="op">=</span> []</span>
<span id="cb374-22"><a href="#cb374-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">1</span>, <span class="bu">len</span>(spectral_vector)):</span>
<span id="cb374-23"><a href="#cb374-23" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> j <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb374-24"><a href="#cb374-24" aria-hidden="true" tabindex="-1"></a>                        row.append(<span class="ss">f"</span><span class="sc">{</span>mass<span class="sc">:&gt;3}</span><span class="ss"> "</span>)</span>
<span id="cb374-25"><a href="#cb374-25" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb374-26"><a href="#cb374-26" aria-hidden="true" tabindex="-1"></a>                        score <span class="op">=</span> score_matrix[mass][j][t]</span>
<span id="cb374-27"><a href="#cb374-27" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> score <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1e5</span>:</span>
<span id="cb374-28"><a href="#cb374-28" aria-hidden="true" tabindex="-1"></a>                            score <span class="op">=</span> <span class="st">'XX'</span></span>
<span id="cb374-29"><a href="#cb374-29" aria-hidden="true" tabindex="-1"></a>                        row.append(<span class="ss">f"</span><span class="sc">{</span>score<span class="sc">:&gt;3}</span><span class="ss">"</span>)</span>
<span id="cb374-30"><a href="#cb374-30" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">' '</span>.join(row))</span>
<span id="cb374-31"><a href="#cb374-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb374-32"><a href="#cb374-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb374-33"><a href="#cb374-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-34"><a href="#cb374-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectral_alignment(peptide: <span class="bu">str</span>, spectral_vector: List[<span class="bu">int</span>], max_k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb374-35"><a href="#cb374-35" aria-hidden="true" tabindex="-1"></a>    spectral_vector.insert(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb374-36"><a href="#cb374-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-37"><a href="#cb374-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate prefix masses</span></span>
<span id="cb374-38"><a href="#cb374-38" aria-hidden="true" tabindex="-1"></a>    prefix_masses <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb374-39"><a href="#cb374-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb374-40"><a href="#cb374-40" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> peptide[:i <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb374-41"><a href="#cb374-41" aria-hidden="true" tabindex="-1"></a>        mass <span class="op">=</span> <span class="bu">sum</span>(amino_acid_masses[aa] <span class="cf">for</span> aa <span class="kw">in</span> prefix)</span>
<span id="cb374-42"><a href="#cb374-42" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(mass)</span>
<span id="cb374-43"><a href="#cb374-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-44"><a href="#cb374-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create diff array</span></span>
<span id="cb374-45"><a href="#cb374-45" aria-hidden="true" tabindex="-1"></a>    mass_differences <span class="op">=</span> {}</span>
<span id="cb374-46"><a href="#cb374-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(prefix_masses)):</span>
<span id="cb374-47"><a href="#cb374-47" aria-hidden="true" tabindex="-1"></a>        mass_differences[prefix_masses[i]] <span class="op">=</span> prefix_masses[i] <span class="op">-</span> prefix_masses[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb374-48"><a href="#cb374-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-49"><a href="#cb374-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize scores</span></span>
<span id="cb374-50"><a href="#cb374-50" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">float</span>]]] <span class="op">=</span> {}</span>
<span id="cb374-51"><a href="#cb374-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses:</span>
<span id="cb374-52"><a href="#cb374-52" aria-hidden="true" tabindex="-1"></a>        score_matrix[mass] <span class="op">=</span> {}</span>
<span id="cb374-53"><a href="#cb374-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb374-54"><a href="#cb374-54" aria-hidden="true" tabindex="-1"></a>            score_matrix[mass][j] <span class="op">=</span> {t: <span class="op">-</span><span class="bu">float</span>(<span class="st">"inf"</span>) <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_k <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb374-55"><a href="#cb374-55" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb374-56"><a href="#cb374-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-57"><a href="#cb374-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate scores</span></span>
<span id="cb374-58"><a href="#cb374-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses[<span class="dv">1</span>:]:</span>
<span id="cb374-59"><a href="#cb374-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb374-60"><a href="#cb374-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb374-61"><a href="#cb374-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (t <span class="op">==</span> <span class="dv">0</span>) <span class="kw">and</span> (mass <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (j <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>):</span>
<span id="cb374-62"><a href="#cb374-62" aria-hidden="true" tabindex="-1"></a>                    score_matrix[mass][j][t] <span class="op">=</span> spectral_vector[j] <span class="op">+</span> score_matrix[mass <span class="op">-</span> mass_differences[mass]][j <span class="op">-</span> mass_differences[mass]][t]</span>
<span id="cb374-63"><a href="#cb374-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> (t <span class="op">&gt;</span> <span class="dv">0</span>) <span class="kw">and</span> (mass <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (j <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>):</span>
<span id="cb374-64"><a href="#cb374-64" aria-hidden="true" tabindex="-1"></a>                    score_matrix[mass][j][t] <span class="op">=</span> spectral_vector[j] <span class="op">+</span> <span class="bu">max</span>(score_matrix[mass <span class="op">-</span> mass_differences[mass]][j <span class="op">-</span> mass_differences[mass]][t], </span>
<span id="cb374-65"><a href="#cb374-65" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="bu">max</span>(score_matrix[mass <span class="op">-</span> mass_differences[mass]][j_star][t <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> j_star <span class="kw">in</span> <span class="bu">range</span>(j)))</span>
<span id="cb374-66"><a href="#cb374-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> (t <span class="op">&gt;</span> <span class="dv">0</span>) <span class="kw">and</span> (mass <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (j <span class="op">&gt;</span> <span class="dv">0</span>):</span>
<span id="cb374-67"><a href="#cb374-67" aria-hidden="true" tabindex="-1"></a>                    score_matrix[mass][j][t] <span class="op">=</span> spectral_vector[j] <span class="op">+</span> <span class="bu">max</span>(score_matrix[mass <span class="op">-</span> mass_differences[mass]][j_star][t <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> j_star <span class="kw">in</span> <span class="bu">range</span>(j))</span>
<span id="cb374-68"><a href="#cb374-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-69"><a href="#cb374-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find max score layer</span></span>
<span id="cb374-70"><a href="#cb374-70" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="op">-</span><span class="bu">float</span>(<span class="st">"inf"</span>)</span>
<span id="cb374-71"><a href="#cb374-71" aria-hidden="true" tabindex="-1"></a>    max_layer <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb374-72"><a href="#cb374-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb374-73"><a href="#cb374-73" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> score_matrix[prefix_masses[<span class="op">-</span><span class="dv">1</span>]][<span class="bu">len</span>(spectral_vector) <span class="op">-</span> <span class="dv">1</span>][t]</span>
<span id="cb374-74"><a href="#cb374-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;</span> max_score:</span>
<span id="cb374-75"><a href="#cb374-75" aria-hidden="true" tabindex="-1"></a>            max_score <span class="op">=</span> current_score</span>
<span id="cb374-76"><a href="#cb374-76" aria-hidden="true" tabindex="-1"></a>            max_layer <span class="op">=</span> t</span>
<span id="cb374-77"><a href="#cb374-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-78"><a href="#cb374-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Backtrace</span></span>
<span id="cb374-79"><a href="#cb374-79" aria-hidden="true" tabindex="-1"></a>    layer <span class="op">=</span> max_layer</span>
<span id="cb374-80"><a href="#cb374-80" aria-hidden="true" tabindex="-1"></a>    column_index <span class="op">=</span> <span class="bu">len</span>(spectral_vector) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb374-81"><a href="#cb374-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-82"><a href="#cb374-82" aria-hidden="true" tabindex="-1"></a>    result_peptide <span class="op">=</span> <span class="st">''</span></span>
<span id="cb374-83"><a href="#cb374-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide), <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb374-84"><a href="#cb374-84" aria-hidden="true" tabindex="-1"></a>        pre_mass <span class="op">=</span> prefix_masses[i]</span>
<span id="cb374-85"><a href="#cb374-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (column_index <span class="op">-</span> mass_differences[pre_mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (</span>
<span id="cb374-86"><a href="#cb374-86" aria-hidden="true" tabindex="-1"></a>                score_matrix[pre_mass][column_index][layer] <span class="op">==</span> spectral_vector[column_index] <span class="op">+</span> score_matrix[pre_mass <span class="op">-</span> mass_differences[pre_mass]][column_index <span class="op">-</span> mass_differences[pre_mass]][layer]):</span>
<span id="cb374-87"><a href="#cb374-87" aria-hidden="true" tabindex="-1"></a>            column_index <span class="op">-=</span> mass_differences[pre_mass]</span>
<span id="cb374-88"><a href="#cb374-88" aria-hidden="true" tabindex="-1"></a>            result_peptide <span class="op">=</span> peptide[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> result_peptide</span>
<span id="cb374-89"><a href="#cb374-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb374-90"><a href="#cb374-90" aria-hidden="true" tabindex="-1"></a>            temp_scores <span class="op">=</span> [score_matrix[pre_mass <span class="op">-</span> mass_differences[pre_mass]][j_star][layer <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> j_star <span class="kw">in</span> <span class="bu">range</span>(column_index)]</span>
<span id="cb374-91"><a href="#cb374-91" aria-hidden="true" tabindex="-1"></a>            idx_max_score <span class="op">=</span> temp_scores.index(<span class="bu">max</span>(temp_scores))</span>
<span id="cb374-92"><a href="#cb374-92" aria-hidden="true" tabindex="-1"></a>            modification_amount <span class="op">=</span> column_index <span class="op">-</span> idx_max_score <span class="op">-</span> mass_differences[pre_mass]</span>
<span id="cb374-93"><a href="#cb374-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> modification_amount <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb374-94"><a href="#cb374-94" aria-hidden="true" tabindex="-1"></a>                result_peptide <span class="op">=</span> peptide[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="st">'(+'</span> <span class="op">+</span> <span class="bu">str</span>(modification_amount) <span class="op">+</span> <span class="st">')'</span> <span class="op">+</span> result_peptide</span>
<span id="cb374-95"><a href="#cb374-95" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb374-96"><a href="#cb374-96" aria-hidden="true" tabindex="-1"></a>                result_peptide <span class="op">=</span> peptide[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="st">'('</span> <span class="op">+</span> <span class="bu">str</span>(modification_amount) <span class="op">+</span> <span class="st">')'</span> <span class="op">+</span> result_peptide</span>
<span id="cb374-97"><a href="#cb374-97" aria-hidden="true" tabindex="-1"></a>            column_index <span class="op">=</span> idx_max_score</span>
<span id="cb374-98"><a href="#cb374-98" aria-hidden="true" tabindex="-1"></a>            layer <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb374-99"><a href="#cb374-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-100"><a href="#cb374-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result_peptide</span>
<span id="cb374-101"><a href="#cb374-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-102"><a href="#cb374-102" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb374-103"><a href="#cb374-103" aria-hidden="true" tabindex="-1"></a><span class="st">XXZ</span></span>
<span id="cb374-104"><a href="#cb374-104" aria-hidden="true" tabindex="-1"></a><span class="st">4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3</span></span>
<span id="cb374-105"><a href="#cb374-105" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb374-106"><a href="#cb374-106" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb374-107"><a href="#cb374-107" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb374-108"><a href="#cb374-108" aria-hidden="true" tabindex="-1"></a>peptide_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb374-109"><a href="#cb374-109" aria-hidden="true" tabindex="-1"></a>spectral_vector_values: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].strip().split()]</span>
<span id="cb374-110"><a href="#cb374-110" aria-hidden="true" tabindex="-1"></a>max_k_value: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb374-111"><a href="#cb374-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-112"><a href="#cb374-112" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spectral_alignment(peptide_sequence, spectral_vector_values, max_k_value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/tomorrow-lab\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb375" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb375-1"><a href="#cb375-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb375-2"><a href="#cb375-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Rosalind Textbook track 문제풀이"</span></span>
<span id="cb375-3"><a href="#cb375-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Taeyoon Kim"</span></span>
<span id="cb375-4"><a href="#cb375-4" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [Python, Rosalind, Bioinformatics, Tip]</span></span>
<span id="cb375-5"><a href="#cb375-5" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb375-6"><a href="#cb375-6" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2024-09-28"</span></span>
<span id="cb375-7"><a href="#cb375-7" aria-hidden="true" tabindex="-1"></a><span class="an">date-modified:</span><span class="co"> last-modified</span></span>
<span id="cb375-8"><a href="#cb375-8" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb375-9"><a href="#cb375-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10"><a href="#cb375-10" aria-hidden="true" tabindex="-1"></a><span class="al">![](Rosalind_textbookTrack.png)</span>{width=100% fig-align="center"}</span>
<span id="cb375-11"><a href="#cb375-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-12"><a href="#cb375-12" aria-hidden="true" tabindex="-1"></a>Phillip Compeau 와 Pavel Pevzner 가 쓴 책 "<span class="co">[</span><span class="ot">능동적 접근 방식의 생물정보학 알고리즘</span><span class="co">](https://www.bioinformaticsalgorithms.org/)</span>" 에서 제공되는 연습 문제 모음입니다.</span>
<span id="cb375-13"><a href="#cb375-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-14"><a href="#cb375-14" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Rosalind</span><span class="co">](https://rosalind.info/)</span> 는 <span class="co">[</span><span class="ot">프로젝트 오일러</span><span class="co">](http://projecteuler.net/)</span>, <span class="co">[</span><span class="ot">구글 코드 잼</span><span class="co">](http://code.google.com/codejam)</span> 에서 영감을 얻었습니다. 이 프로젝트의 이름은 DNA 이중나선을 발견하는 데 기여한 <span class="co">[</span><span class="ot">로잘린드 프랭클린</span><span class="co">](http://en.wikipedia.org/wiki/Rosalind_Franklin)</span> 에서 따왔습니다. Rosalind 는 프로그래밍 실력을 키우고자 하는 생물학자와 분자생물학의 계산 문제를 접해본 적이 없는 프로그래머들에게 도움이 될 것입니다.</span>
<span id="cb375-15"><a href="#cb375-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-16"><a href="#cb375-16" aria-hidden="true" tabindex="-1"></a><span class="fu">## Compute the Number of Times a Pattern Appears in a Text</span></span>
<span id="cb375-17"><a href="#cb375-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-18"><a href="#cb375-18" aria-hidden="true" tabindex="-1"></a>This is the first problem in a collection of"code challenges"to accompany&nbsp;<span class="co">[</span><span class="ot">Bioinformatics Algorithms: An Active-Learning Approach</span><span class="co">](http://bioinformaticsalgorithms.org/)</span>&nbsp;by Phillip Compeau &amp; Pavel Pevzner.</span>
<span id="cb375-19"><a href="#cb375-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-20"><a href="#cb375-20" aria-hidden="true" tabindex="-1"></a>A&nbsp;<span class="co">[</span><span class="ot">k-mer</span><span class="co">](https://rosalind.info/glossary/k-mer/)</span>&nbsp;is a&nbsp;<span class="co">[</span><span class="ot">string</span><span class="co">](https://rosalind.info/glossary/string/)</span>&nbsp;of length&nbsp;*k*. We define&nbsp;*Count*(*Text*,&nbsp;*Pattern*) as the number of times that a&nbsp;*k*-mer&nbsp;*Pattern*&nbsp;appears as a&nbsp;[substring](https://rosalind.info/glossary/substring/)&nbsp;of&nbsp;*Text*.</span>
<span id="cb375-21"><a href="#cb375-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-22"><a href="#cb375-22" aria-hidden="true" tabindex="-1"></a>For example, We note that&nbsp;$Count(CGATATATCCATAGCGATATATCCATAG,ATAATA)$ is equal to 3 (not 2) since we should account for overlapping occurrences of&nbsp;*Pattern*&nbsp;in&nbsp;*Text*.</span>
<span id="cb375-23"><a href="#cb375-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-24"><a href="#cb375-24" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;{DNA strings}}&nbsp;*Text*&nbsp;and&nbsp;*Pattern*.</span>
<span id="cb375-25"><a href="#cb375-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-26"><a href="#cb375-26" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;*Count*(*Text*,&nbsp;*Pattern*).</span>
<span id="cb375-27"><a href="#cb375-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-28"><a href="#cb375-28" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-29"><a href="#cb375-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-30"><a href="#cb375-30" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-31"><a href="#cb375-31" aria-hidden="true" tabindex="-1"></a><span class="in">GCGCG</span></span>
<span id="cb375-32"><a href="#cb375-32" aria-hidden="true" tabindex="-1"></a><span class="in">GCG</span></span>
<span id="cb375-33"><a href="#cb375-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-34"><a href="#cb375-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-35"><a href="#cb375-35" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-36"><a href="#cb375-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-37"><a href="#cb375-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-38"><a href="#cb375-38" aria-hidden="true" tabindex="-1"></a><span class="in">2</span></span>
<span id="cb375-39"><a href="#cb375-39" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-40"><a href="#cb375-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-41"><a href="#cb375-41" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-42"><a href="#cb375-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-43"><a href="#cb375-43" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-44"><a href="#cb375-44" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb375-45"><a href="#cb375-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-46"><a href="#cb375-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-47"><a href="#cb375-47" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb375-48"><a href="#cb375-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-49"><a href="#cb375-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i:i <span class="op">+</span> size]</span>
<span id="cb375-50"><a href="#cb375-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-51"><a href="#cb375-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-52"><a href="#cb375-52" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count how many times the pattern occurs in the text."""</span></span>
<span id="cb375-53"><a href="#cb375-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb375-54"><a href="#cb375-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-55"><a href="#cb375-55" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-56"><a href="#cb375-56" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-57"><a href="#cb375-57" aria-hidden="true" tabindex="-1"></a><span class="st">GCGCG</span></span>
<span id="cb375-58"><a href="#cb375-58" aria-hidden="true" tabindex="-1"></a><span class="st">GCG</span></span>
<span id="cb375-59"><a href="#cb375-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-60"><a href="#cb375-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-61"><a href="#cb375-61" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern</span></span>
<span id="cb375-62"><a href="#cb375-62" aria-hidden="true" tabindex="-1"></a>text, pattern <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-63"><a href="#cb375-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-64"><a href="#cb375-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the count of pattern occurrences in text</span></span>
<span id="cb375-65"><a href="#cb375-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_pattern_occurrences(text, pattern))</span>
<span id="cb375-66"><a href="#cb375-66" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-67"><a href="#cb375-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-68"><a href="#cb375-68" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find the Most Frequent Words in a String</span></span>
<span id="cb375-69"><a href="#cb375-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-70"><a href="#cb375-70" aria-hidden="true" tabindex="-1"></a>We say that&nbsp;*Pattern*&nbsp;is a&nbsp;**most frequent&nbsp;k-mer**&nbsp;in&nbsp;*Text*&nbsp;if it maximizes&nbsp;*Count*(*Text*,&nbsp;*Pattern*) among all&nbsp;<span class="co">[</span><span class="ot">k-mers</span><span class="co">](https://rosalind.info/glossary/k-mer/)</span>. For example,"ACTAT"is a most frequent 5-mer in"ACAACTATGCATCACTATCGGGAACTATCCT", and"ATA"is a most frequent 3-mer of"CGATATATCCATAG".</span>
<span id="cb375-71"><a href="#cb375-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-72"><a href="#cb375-72" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;<span class="co">[</span><span class="ot">DNA string</span><span class="co">](https://rosalind.info/glossary/dna-string/)</span>&nbsp;*Text*&nbsp;and an integer&nbsp;*k*.</span>
<span id="cb375-73"><a href="#cb375-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-74"><a href="#cb375-74" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All most frequent&nbsp;*k*-mers in&nbsp;*Text*&nbsp;(in any order).</span>
<span id="cb375-75"><a href="#cb375-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-76"><a href="#cb375-76" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-77"><a href="#cb375-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-78"><a href="#cb375-78" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-79"><a href="#cb375-79" aria-hidden="true" tabindex="-1"></a><span class="in">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb375-80"><a href="#cb375-80" aria-hidden="true" tabindex="-1"></a><span class="in">4</span></span>
<span id="cb375-81"><a href="#cb375-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-82"><a href="#cb375-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-83"><a href="#cb375-83" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-84"><a href="#cb375-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-85"><a href="#cb375-85" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-86"><a href="#cb375-86" aria-hidden="true" tabindex="-1"></a><span class="in">CATG GCAT</span></span>
<span id="cb375-87"><a href="#cb375-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-88"><a href="#cb375-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-89"><a href="#cb375-89" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-90"><a href="#cb375-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-91"><a href="#cb375-91" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-92"><a href="#cb375-92" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-93"><a href="#cb375-93" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-94"><a href="#cb375-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-95"><a href="#cb375-95" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-96"><a href="#cb375-96" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb375-97"><a href="#cb375-97" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-98"><a href="#cb375-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-99"><a href="#cb375-99" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb375-100"><a href="#cb375-100" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count occurrences of each k-mer in the text."""</span></span>
<span id="cb375-101"><a href="#cb375-101" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb375-102"><a href="#cb375-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(text, k):</span>
<span id="cb375-103"><a href="#cb375-103" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-104"><a href="#cb375-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb375-105"><a href="#cb375-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-106"><a href="#cb375-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> most_frequent_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-107"><a href="#cb375-107" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find the most frequent k-mers."""</span></span>
<span id="cb375-108"><a href="#cb375-108" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb375-109"><a href="#cb375-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb375-110"><a href="#cb375-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-111"><a href="#cb375-111" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-112"><a href="#cb375-112" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-113"><a href="#cb375-113" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb375-114"><a href="#cb375-114" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-115"><a href="#cb375-115" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-116"><a href="#cb375-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-117"><a href="#cb375-117" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern size</span></span>
<span id="cb375-118"><a href="#cb375-118" aria-hidden="true" tabindex="-1"></a>text, k <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-119"><a href="#cb375-119" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="bu">int</span>(k)</span>
<span id="cb375-120"><a href="#cb375-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-121"><a href="#cb375-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Find and print the most frequent k-mers</span></span>
<span id="cb375-122"><a href="#cb375-122" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> most_frequent_kmers(count_kmers(text, k))</span>
<span id="cb375-123"><a href="#cb375-123" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent)</span>
<span id="cb375-124"><a href="#cb375-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-125"><a href="#cb375-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-126"><a href="#cb375-126" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find the Reverse Complement of a String</span></span>
<span id="cb375-127"><a href="#cb375-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-128"><a href="#cb375-128" aria-hidden="true" tabindex="-1"></a>Find the reverse complement of a DNA string.</span>
<span id="cb375-129"><a href="#cb375-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-130"><a href="#cb375-130" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A DNA string&nbsp;*Pattern*.</span>
<span id="cb375-131"><a href="#cb375-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-132"><a href="#cb375-132" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;$\overline{Pattern}$, the reverse complement of&nbsp;*Pattern*.</span>
<span id="cb375-133"><a href="#cb375-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-134"><a href="#cb375-134" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-135"><a href="#cb375-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-136"><a href="#cb375-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-137"><a href="#cb375-137" aria-hidden="true" tabindex="-1"></a><span class="in">AAAACCCGGT</span></span>
<span id="cb375-138"><a href="#cb375-138" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-139"><a href="#cb375-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-140"><a href="#cb375-140" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-141"><a href="#cb375-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-142"><a href="#cb375-142" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-143"><a href="#cb375-143" aria-hidden="true" tabindex="-1"></a><span class="in">ACCGGGTTTT</span></span>
<span id="cb375-144"><a href="#cb375-144" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-145"><a href="#cb375-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-146"><a href="#cb375-146" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-147"><a href="#cb375-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-148"><a href="#cb375-148" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-149"><a href="#cb375-149" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-150"><a href="#cb375-150" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Return the reverse complement of a DNA sequence."""</span></span>
<span id="cb375-151"><a href="#cb375-151" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb375-152"><a href="#cb375-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-153"><a href="#cb375-153" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-154"><a href="#cb375-154" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-155"><a href="#cb375-155" aria-hidden="true" tabindex="-1"></a><span class="st">AAAACCCGGT</span></span>
<span id="cb375-156"><a href="#cb375-156" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-157"><a href="#cb375-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-158"><a href="#cb375-158" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the reverse complement</span></span>
<span id="cb375-159"><a href="#cb375-159" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip().split()[<span class="dv">0</span>]</span>
<span id="cb375-160"><a href="#cb375-160" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reverse_complement(sequence))</span>
<span id="cb375-161"><a href="#cb375-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-162"><a href="#cb375-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-163"><a href="#cb375-163" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find All Occurrences of a Pattern in a String</span></span>
<span id="cb375-164"><a href="#cb375-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-165"><a href="#cb375-165" aria-hidden="true" tabindex="-1"></a>Pattern Matching Problem, Find all occurrences of a pattern in a string.</span>
<span id="cb375-166"><a href="#cb375-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-167"><a href="#cb375-167" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Strings&nbsp;*Pattern*&nbsp;and&nbsp;*Genome*.</span>
<span id="cb375-168"><a href="#cb375-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-169"><a href="#cb375-169" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All starting positions in&nbsp;*Genome*&nbsp;where&nbsp;*Pattern*&nbsp;appears as a substring. Use&nbsp;<span class="co">[</span><span class="ot">0-based indexing</span><span class="co">](https://rosalind.info/glossary/0-based-numbering/)</span>.</span>
<span id="cb375-170"><a href="#cb375-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-171"><a href="#cb375-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-172"><a href="#cb375-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-173"><a href="#cb375-173" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-174"><a href="#cb375-174" aria-hidden="true" tabindex="-1"></a><span class="in">ATAT</span></span>
<span id="cb375-175"><a href="#cb375-175" aria-hidden="true" tabindex="-1"></a><span class="in">GATATATGCATATACTT</span></span>
<span id="cb375-176"><a href="#cb375-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-177"><a href="#cb375-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-178"><a href="#cb375-178" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-179"><a href="#cb375-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-180"><a href="#cb375-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-181"><a href="#cb375-181" aria-hidden="true" tabindex="-1"></a><span class="in">1 3 9</span></span>
<span id="cb375-182"><a href="#cb375-182" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-183"><a href="#cb375-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-184"><a href="#cb375-184" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-185"><a href="#cb375-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-186"><a href="#cb375-186" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-187"><a href="#cb375-187" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Generator</span>
<span id="cb375-188"><a href="#cb375-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-189"><a href="#cb375-189" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-190"><a href="#cb375-190" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb375-191"><a href="#cb375-191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-192"><a href="#cb375-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-193"><a href="#cb375-193" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_indices(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-194"><a href="#cb375-194" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Yield starting indices where the pattern is found in the text."""</span></span>
<span id="cb375-195"><a href="#cb375-195" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, <span class="bu">len</span>(pattern))):</span>
<span id="cb375-196"><a href="#cb375-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> substring <span class="op">==</span> pattern:</span>
<span id="cb375-197"><a href="#cb375-197" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> i</span>
<span id="cb375-198"><a href="#cb375-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-199"><a href="#cb375-199" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-200"><a href="#cb375-200" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-201"><a href="#cb375-201" aria-hidden="true" tabindex="-1"></a><span class="st">ATAT</span></span>
<span id="cb375-202"><a href="#cb375-202" aria-hidden="true" tabindex="-1"></a><span class="st">GATATATGCATATACTT</span></span>
<span id="cb375-203"><a href="#cb375-203" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-204"><a href="#cb375-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-205"><a href="#cb375-205" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into pattern and text</span></span>
<span id="cb375-206"><a href="#cb375-206" aria-hidden="true" tabindex="-1"></a>pattern, text <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-207"><a href="#cb375-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-208"><a href="#cb375-208" aria-hidden="true" tabindex="-1"></a><span class="co"># Print indices where the pattern is found</span></span>
<span id="cb375-209"><a href="#cb375-209" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_pattern_indices(text, pattern))</span>
<span id="cb375-210"><a href="#cb375-210" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-211"><a href="#cb375-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-212"><a href="#cb375-212" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find Patterns Forming Clumps in a String</span></span>
<span id="cb375-213"><a href="#cb375-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-214"><a href="#cb375-214" aria-hidden="true" tabindex="-1"></a>Clump Finding Problem, Find patterns forming clumps in a string.</span>
<span id="cb375-215"><a href="#cb375-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-216"><a href="#cb375-216" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;*Genome*, and integers&nbsp;*k*,&nbsp;*L*, and&nbsp;*t*.</span>
<span id="cb375-217"><a href="#cb375-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-218"><a href="#cb375-218" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All distinct&nbsp;*k*-mers forming (*L*,&nbsp;*t*)-clumps in&nbsp;*Genome*.</span>
<span id="cb375-219"><a href="#cb375-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-220"><a href="#cb375-220" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-221"><a href="#cb375-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-222"><a href="#cb375-222" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-223"><a href="#cb375-223" aria-hidden="true" tabindex="-1"></a><span class="in">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb375-224"><a href="#cb375-224" aria-hidden="true" tabindex="-1"></a><span class="in">5 75 4</span></span>
<span id="cb375-225"><a href="#cb375-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-226"><a href="#cb375-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-227"><a href="#cb375-227" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-228"><a href="#cb375-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-229"><a href="#cb375-229" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-230"><a href="#cb375-230" aria-hidden="true" tabindex="-1"></a><span class="in">CGACA GAAGA AATGT</span></span>
<span id="cb375-231"><a href="#cb375-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-232"><a href="#cb375-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-233"><a href="#cb375-233" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-234"><a href="#cb375-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-235"><a href="#cb375-235" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-236"><a href="#cb375-236" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-237"><a href="#cb375-237" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb375-238"><a href="#cb375-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-239"><a href="#cb375-239" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-240"><a href="#cb375-240" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb375-241"><a href="#cb375-241" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-242"><a href="#cb375-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-243"><a href="#cb375-243" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb375-244"><a href="#cb375-244" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions of k-length kmers within the text."""</span></span>
<span id="cb375-245"><a href="#cb375-245" aria-hidden="true" tabindex="-1"></a>    kmer_positions <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-246"><a href="#cb375-246" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, k)):</span>
<span id="cb375-247"><a href="#cb375-247" aria-hidden="true" tabindex="-1"></a>        kmer_positions[substring].append(i)</span>
<span id="cb375-248"><a href="#cb375-248" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_positions</span>
<span id="cb375-249"><a href="#cb375-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-250"><a href="#cb375-250" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_clump(positions: List[<span class="bu">int</span>], L: <span class="bu">int</span>, t: <span class="bu">int</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb375-251"><a href="#cb375-251" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if a given array of kmers at positions forms a clump of t within L."""</span></span>
<span id="cb375-252"><a href="#cb375-252" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(positions) <span class="op">-</span> t <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-253"><a href="#cb375-253" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (positions[i <span class="op">+</span> t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> k <span class="op">-</span> positions[i]) <span class="op">&lt;=</span> L:</span>
<span id="cb375-254"><a href="#cb375-254" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb375-255"><a href="#cb375-255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb375-256"><a href="#cb375-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-257"><a href="#cb375-257" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-258"><a href="#cb375-258" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-259"><a href="#cb375-259" aria-hidden="true" tabindex="-1"></a><span class="st">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb375-260"><a href="#cb375-260" aria-hidden="true" tabindex="-1"></a><span class="st">5 75 4</span></span>
<span id="cb375-261"><a href="#cb375-261" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-262"><a href="#cb375-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-263"><a href="#cb375-263" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into sequence and parameters</span></span>
<span id="cb375-264"><a href="#cb375-264" aria-hidden="true" tabindex="-1"></a>seq, params <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-265"><a href="#cb375-265" aria-hidden="true" tabindex="-1"></a>k, L, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb375-266"><a href="#cb375-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-267"><a href="#cb375-267" aria-hidden="true" tabindex="-1"></a><span class="co"># Find kmers and print those forming clumps</span></span>
<span id="cb375-268"><a href="#cb375-268" aria-hidden="true" tabindex="-1"></a>kmers <span class="op">=</span> find_kmers(seq, k)</span>
<span id="cb375-269"><a href="#cb375-269" aria-hidden="true" tabindex="-1"></a>clumps <span class="op">=</span> [kmer <span class="cf">for</span> kmer <span class="kw">in</span> kmers <span class="cf">if</span> has_clump(kmers[kmer], L, t, k)]</span>
<span id="cb375-270"><a href="#cb375-270" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>clumps)</span>
<span id="cb375-271"><a href="#cb375-271" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-272"><a href="#cb375-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-273"><a href="#cb375-273" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find a Position in a Genome Minimizing the Skew</span></span>
<span id="cb375-274"><a href="#cb375-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-275"><a href="#cb375-275" aria-hidden="true" tabindex="-1"></a>Minimum Skew Problem, Find a position in a genome minimizing the skew.</span>
<span id="cb375-276"><a href="#cb375-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-277"><a href="#cb375-277" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A DNA string&nbsp;*Genome*.</span>
<span id="cb375-278"><a href="#cb375-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-279"><a href="#cb375-279" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All integer(s)&nbsp;*i*&nbsp;minimizing&nbsp;*Skew*(*Prefix__i*&nbsp;(*Text*)) over all values of&nbsp;*i*&nbsp;(from 0 to |*Genome*|).</span>
<span id="cb375-280"><a href="#cb375-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-281"><a href="#cb375-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-282"><a href="#cb375-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-283"><a href="#cb375-283" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-284"><a href="#cb375-284" aria-hidden="true" tabindex="-1"></a><span class="in">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb375-285"><a href="#cb375-285" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-286"><a href="#cb375-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-287"><a href="#cb375-287" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-288"><a href="#cb375-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-289"><a href="#cb375-289" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-290"><a href="#cb375-290" aria-hidden="true" tabindex="-1"></a><span class="in">53 97</span></span>
<span id="cb375-291"><a href="#cb375-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-292"><a href="#cb375-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-293"><a href="#cb375-293" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-294"><a href="#cb375-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-295"><a href="#cb375-295" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-296"><a href="#cb375-296" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb375-297"><a href="#cb375-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-298"><a href="#cb375-298" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minima(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-299"><a href="#cb375-299" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions with the minimum skew in a DNA sequence."""</span></span>
<span id="cb375-300"><a href="#cb375-300" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-301"><a href="#cb375-301" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> {<span class="st">"G"</span>: <span class="dv">1</span>, <span class="st">"C"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"T"</span>: <span class="dv">0</span>}</span>
<span id="cb375-302"><a href="#cb375-302" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-303"><a href="#cb375-303" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(seq):</span>
<span id="cb375-304"><a href="#cb375-304" aria-hidden="true" tabindex="-1"></a>        skew.append(skew[i] <span class="op">+</span> delta[nucleotide])</span>
<span id="cb375-305"><a href="#cb375-305" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-306"><a href="#cb375-306" aria-hidden="true" tabindex="-1"></a>    min_skew <span class="op">=</span> <span class="bu">min</span>(skew)</span>
<span id="cb375-307"><a href="#cb375-307" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (i <span class="cf">for</span> i, value <span class="kw">in</span> <span class="bu">enumerate</span>(skew) <span class="cf">if</span> value <span class="op">==</span> min_skew)</span>
<span id="cb375-308"><a href="#cb375-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-309"><a href="#cb375-309" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-310"><a href="#cb375-310" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-311"><a href="#cb375-311" aria-hidden="true" tabindex="-1"></a><span class="st">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb375-312"><a href="#cb375-312" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-313"><a href="#cb375-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-314"><a href="#cb375-314" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the positions with minimum skew</span></span>
<span id="cb375-315"><a href="#cb375-315" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb375-316"><a href="#cb375-316" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_minima(sequence))</span>
<span id="cb375-317"><a href="#cb375-317" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-318"><a href="#cb375-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-319"><a href="#cb375-319" aria-hidden="true" tabindex="-1"></a><span class="fu"># Compute the Hamming Distance Between Two Strings</span></span>
<span id="cb375-320"><a href="#cb375-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-321"><a href="#cb375-321" aria-hidden="true" tabindex="-1"></a>Hamming Distance Problem, Compute the Hamming distance between two DNA strings.</span>
<span id="cb375-322"><a href="#cb375-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-323"><a href="#cb375-323" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two DNA strings.</span>
<span id="cb375-324"><a href="#cb375-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-325"><a href="#cb375-325" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An integer value representing the Hamming distance.</span>
<span id="cb375-326"><a href="#cb375-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-327"><a href="#cb375-327" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-328"><a href="#cb375-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-329"><a href="#cb375-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-330"><a href="#cb375-330" aria-hidden="true" tabindex="-1"></a><span class="in">GGGCCGTTGGT</span></span>
<span id="cb375-331"><a href="#cb375-331" aria-hidden="true" tabindex="-1"></a><span class="in">GGACCGTTGAC</span></span>
<span id="cb375-332"><a href="#cb375-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-333"><a href="#cb375-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-334"><a href="#cb375-334" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-335"><a href="#cb375-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-336"><a href="#cb375-336" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-337"><a href="#cb375-337" aria-hidden="true" tabindex="-1"></a><span class="in">3</span></span>
<span id="cb375-338"><a href="#cb375-338" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-339"><a href="#cb375-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-340"><a href="#cb375-340" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-341"><a href="#cb375-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-342"><a href="#cb375-342" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-343"><a href="#cb375-343" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> zip_longest</span>
<span id="cb375-344"><a href="#cb375-344" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb375-345"><a href="#cb375-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-346"><a href="#cb375-346" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-347"><a href="#cb375-347" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> zip_longest(sequence1, sequence2, fillvalue<span class="op">=</span><span class="va">None</span>))</span>
<span id="cb375-348"><a href="#cb375-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-349"><a href="#cb375-349" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_dna_sequences(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb375-350"><a href="#cb375-350" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(input_string.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb375-351"><a href="#cb375-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-352"><a href="#cb375-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-353"><a href="#cb375-353" aria-hidden="true" tabindex="-1"></a>Sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-354"><a href="#cb375-354" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCCGTTGGT</span></span>
<span id="cb375-355"><a href="#cb375-355" aria-hidden="true" tabindex="-1"></a><span class="st">GGACCGTTGAC</span></span>
<span id="cb375-356"><a href="#cb375-356" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-357"><a href="#cb375-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-358"><a href="#cb375-358" aria-hidden="true" tabindex="-1"></a>dna_sequence1, dna_sequence2 <span class="op">=</span> parse_dna_sequences(Sample_input)</span>
<span id="cb375-359"><a href="#cb375-359" aria-hidden="true" tabindex="-1"></a>hamming_distance <span class="op">=</span> calculate_hamming_distance(dna_sequence1, dna_sequence2)</span>
<span id="cb375-360"><a href="#cb375-360" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hamming_distance)</span>
<span id="cb375-361"><a href="#cb375-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-362"><a href="#cb375-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-363"><a href="#cb375-363" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find All Approximate Occurrences of a Pattern in a String</span></span>
<span id="cb375-364"><a href="#cb375-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-365"><a href="#cb375-365" aria-hidden="true" tabindex="-1"></a>Approximate Pattern Matching Problem, Find all approximate occurrences of a pattern in a string.</span>
<span id="cb375-366"><a href="#cb375-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-367"><a href="#cb375-367" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Strings&nbsp;*Pattern*&nbsp;and&nbsp;*Text*&nbsp;along with an integer&nbsp;*d*.</span>
<span id="cb375-368"><a href="#cb375-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-369"><a href="#cb375-369" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All starting positions where&nbsp;*Pattern*&nbsp;appears as a substring of&nbsp;*Text*&nbsp;with at most&nbsp;*d*&nbsp;mismatches.</span>
<span id="cb375-370"><a href="#cb375-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-371"><a href="#cb375-371" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-372"><a href="#cb375-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-373"><a href="#cb375-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-374"><a href="#cb375-374" aria-hidden="true" tabindex="-1"></a><span class="in">ATTCTGGA</span></span>
<span id="cb375-375"><a href="#cb375-375" aria-hidden="true" tabindex="-1"></a><span class="in">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb375-376"><a href="#cb375-376" aria-hidden="true" tabindex="-1"></a><span class="in">3</span></span>
<span id="cb375-377"><a href="#cb375-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-378"><a href="#cb375-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-379"><a href="#cb375-379" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-380"><a href="#cb375-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-381"><a href="#cb375-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-382"><a href="#cb375-382" aria-hidden="true" tabindex="-1"></a><span class="in">6 7 26 27 78</span></span>
<span id="cb375-383"><a href="#cb375-383" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-384"><a href="#cb375-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-385"><a href="#cb375-385" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-386"><a href="#cb375-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-387"><a href="#cb375-387" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-388"><a href="#cb375-388" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb375-389"><a href="#cb375-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-390"><a href="#cb375-390" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-391"><a href="#cb375-391" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb375-392"><a href="#cb375-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-393"><a href="#cb375-393" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-394"><a href="#cb375-394" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb375-395"><a href="#cb375-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-396"><a href="#cb375-396" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_approximate_matches(pattern: <span class="bu">str</span>, genome: <span class="bu">str</span>, max_mismatch: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb375-397"><a href="#cb375-397" aria-hidden="true" tabindex="-1"></a>    pattern_length <span class="op">=</span> <span class="bu">len</span>(pattern)</span>
<span id="cb375-398"><a href="#cb375-398" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (position <span class="cf">for</span> position, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(genome, pattern_length))</span>
<span id="cb375-399"><a href="#cb375-399" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_mismatch)</span>
<span id="cb375-400"><a href="#cb375-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-401"><a href="#cb375-401" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb375-402"><a href="#cb375-402" aria-hidden="true" tabindex="-1"></a>    pattern, genome, max_mismatch_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-403"><a href="#cb375-403" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pattern, genome, <span class="bu">int</span>(max_mismatch_str)</span>
<span id="cb375-404"><a href="#cb375-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-405"><a href="#cb375-405" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-406"><a href="#cb375-406" aria-hidden="true" tabindex="-1"></a><span class="st">ATTCTGGA</span></span>
<span id="cb375-407"><a href="#cb375-407" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb375-408"><a href="#cb375-408" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb375-409"><a href="#cb375-409" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-410"><a href="#cb375-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-411"><a href="#cb375-411" aria-hidden="true" tabindex="-1"></a>pattern, genome, max_mismatch <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-412"><a href="#cb375-412" aria-hidden="true" tabindex="-1"></a>match_positions <span class="op">=</span> <span class="bu">list</span>(find_approximate_matches(pattern, genome, max_mismatch))</span>
<span id="cb375-413"><a href="#cb375-413" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>match_positions)</span>
<span id="cb375-414"><a href="#cb375-414" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-415"><a href="#cb375-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-416"><a href="#cb375-416" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find the Most Frequent Words with Mismatches in a String</span></span>
<span id="cb375-417"><a href="#cb375-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-418"><a href="#cb375-418" aria-hidden="true" tabindex="-1"></a>Frequent Words with Mismatches Problem, Find the most frequent k-mers with mismatches in a string.</span>
<span id="cb375-419"><a href="#cb375-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-420"><a href="#cb375-420" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;*Text*&nbsp;as well as integers&nbsp;*k*&nbsp;and&nbsp;*d*.</span>
<span id="cb375-421"><a href="#cb375-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-422"><a href="#cb375-422" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All most frequent&nbsp;*k*-mers with up to&nbsp;*d*&nbsp;mismatches in&nbsp;*Text*.</span>
<span id="cb375-423"><a href="#cb375-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-424"><a href="#cb375-424" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-425"><a href="#cb375-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-426"><a href="#cb375-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-427"><a href="#cb375-427" aria-hidden="true" tabindex="-1"></a><span class="in">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb375-428"><a href="#cb375-428" aria-hidden="true" tabindex="-1"></a><span class="in">4 1</span></span>
<span id="cb375-429"><a href="#cb375-429" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-430"><a href="#cb375-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-431"><a href="#cb375-431" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-432"><a href="#cb375-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-433"><a href="#cb375-433" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-434"><a href="#cb375-434" aria-hidden="true" tabindex="-1"></a><span class="in">ATGC ATGT GATG</span></span>
<span id="cb375-435"><a href="#cb375-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-436"><a href="#cb375-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-437"><a href="#cb375-437" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-438"><a href="#cb375-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-439"><a href="#cb375-439" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-440"><a href="#cb375-440" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-441"><a href="#cb375-441" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb375-442"><a href="#cb375-442" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb375-443"><a href="#cb375-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-444"><a href="#cb375-444" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-445"><a href="#cb375-445" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb375-446"><a href="#cb375-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-447"><a href="#cb375-447" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-448"><a href="#cb375-448" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb375-449"><a href="#cb375-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-450"><a href="#cb375-450" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna_sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb375-451"><a href="#cb375-451" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb375-452"><a href="#cb375-452" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna_sequence, kmer_length):</span>
<span id="cb375-453"><a href="#cb375-453" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-454"><a href="#cb375-454" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb375-455"><a href="#cb375-455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-456"><a href="#cb375-456" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-457"><a href="#cb375-457" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb375-458"><a href="#cb375-458" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb375-459"><a href="#cb375-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-460"><a href="#cb375-460" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-461"><a href="#cb375-461" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb375-462"><a href="#cb375-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-463"><a href="#cb375-463" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(observed_kmers: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-464"><a href="#cb375-464" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb375-465"><a href="#cb375-465" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(observed_kmers[observed_kmer] </span>
<span id="cb375-466"><a href="#cb375-466" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> observed_kmer <span class="kw">in</span> observed_kmers </span>
<span id="cb375-467"><a href="#cb375-467" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb375-468"><a href="#cb375-468" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-469"><a href="#cb375-469" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb375-470"><a href="#cb375-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-471"><a href="#cb375-471" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-472"><a href="#cb375-472" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-473"><a href="#cb375-473" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb375-474"><a href="#cb375-474" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb375-475"><a href="#cb375-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-476"><a href="#cb375-476" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-477"><a href="#cb375-477" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb375-478"><a href="#cb375-478" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb375-479"><a href="#cb375-479" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-480"><a href="#cb375-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-481"><a href="#cb375-481" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-482"><a href="#cb375-482" aria-hidden="true" tabindex="-1"></a>observed_kmers <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb375-483"><a href="#cb375-483" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(observed_kmers, max_mismatches, kmer_length))</span>
<span id="cb375-484"><a href="#cb375-484" aria-hidden="true" tabindex="-1"></a>most_frequent_kmers <span class="op">=</span> find_most_frequent(approximate_kmer_counts)</span>
<span id="cb375-485"><a href="#cb375-485" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent_kmers)</span>
<span id="cb375-486"><a href="#cb375-486" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-487"><a href="#cb375-487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-488"><a href="#cb375-488" aria-hidden="true" tabindex="-1"></a><span class="fu"># Find Frequent Words with Mismatches and Reverse Complements</span></span>
<span id="cb375-489"><a href="#cb375-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-490"><a href="#cb375-490" aria-hidden="true" tabindex="-1"></a>Frequent Words with Mismatches and Reverse Complements Problem. Find the most frequent k-mers (with mismatches and reverse complements) in a DNA string.</span>
<span id="cb375-491"><a href="#cb375-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-492"><a href="#cb375-492" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A DNA string&nbsp;*Text*&nbsp;as well as integers&nbsp;*k*&nbsp;and&nbsp;*d*.</span>
<span id="cb375-493"><a href="#cb375-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-494"><a href="#cb375-494" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All&nbsp;*k*-mers&nbsp;*Pattern*&nbsp;maximizing the sum&nbsp;*Count__d*(*Text*,&nbsp;$Pattern$) +&nbsp;*Count__d*(*Text*,&nbsp;$\overline{Pattern}$}) over all possible&nbsp;*k*-mers.</span>
<span id="cb375-495"><a href="#cb375-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-496"><a href="#cb375-496" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-497"><a href="#cb375-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-498"><a href="#cb375-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-499"><a href="#cb375-499" aria-hidden="true" tabindex="-1"></a><span class="in">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb375-500"><a href="#cb375-500" aria-hidden="true" tabindex="-1"></a><span class="in">4 1</span></span>
<span id="cb375-501"><a href="#cb375-501" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-502"><a href="#cb375-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-503"><a href="#cb375-503" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-504"><a href="#cb375-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-505"><a href="#cb375-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-506"><a href="#cb375-506" aria-hidden="true" tabindex="-1"></a><span class="in">ATGT ACAT</span></span>
<span id="cb375-507"><a href="#cb375-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-508"><a href="#cb375-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-509"><a href="#cb375-509" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-510"><a href="#cb375-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-511"><a href="#cb375-511" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-512"><a href="#cb375-512" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-513"><a href="#cb375-513" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb375-514"><a href="#cb375-514" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb375-515"><a href="#cb375-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-516"><a href="#cb375-516" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-517"><a href="#cb375-517" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb375-518"><a href="#cb375-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-519"><a href="#cb375-519" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-520"><a href="#cb375-520" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb375-521"><a href="#cb375-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-522"><a href="#cb375-522" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna: <span class="bu">str</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-523"><a href="#cb375-523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna[i:i <span class="op">+</span> length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna) <span class="op">-</span> length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb375-524"><a href="#cb375-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-525"><a href="#cb375-525" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb375-526"><a href="#cb375-526" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb375-527"><a href="#cb375-527" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna, kmer_length):</span>
<span id="cb375-528"><a href="#cb375-528" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-529"><a href="#cb375-529" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb375-530"><a href="#cb375-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-531"><a href="#cb375-531" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-532"><a href="#cb375-532" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb375-533"><a href="#cb375-533" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb375-534"><a href="#cb375-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-535"><a href="#cb375-535" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-536"><a href="#cb375-536" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb375-537"><a href="#cb375-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-538"><a href="#cb375-538" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-539"><a href="#cb375-539" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb375-540"><a href="#cb375-540" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb375-541"><a href="#cb375-541" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb375-542"><a href="#cb375-542" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb375-543"><a href="#cb375-543" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> hamming_distance(reverse_complement(potential_kmer), observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb375-544"><a href="#cb375-544" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-545"><a href="#cb375-545" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb375-546"><a href="#cb375-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-547"><a href="#cb375-547" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-548"><a href="#cb375-548" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-549"><a href="#cb375-549" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb375-550"><a href="#cb375-550" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb375-551"><a href="#cb375-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-552"><a href="#cb375-552" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-553"><a href="#cb375-553" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb375-554"><a href="#cb375-554" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb375-555"><a href="#cb375-555" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-556"><a href="#cb375-556" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-557"><a href="#cb375-557" aria-hidden="true" tabindex="-1"></a>kmer_counts <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb375-558"><a href="#cb375-558" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(kmer_counts, max_mismatches, kmer_length))</span>
<span id="cb375-559"><a href="#cb375-559" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_most_frequent(approximate_kmer_counts))</span>
<span id="cb375-560"><a href="#cb375-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-561"><a href="#cb375-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-562"><a href="#cb375-562" aria-hidden="true" tabindex="-1"></a><span class="fu"># Generate the Frequency Array of a String</span></span>
<span id="cb375-563"><a href="#cb375-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-564"><a href="#cb375-564" aria-hidden="true" tabindex="-1"></a>Computing a Frequency Array, Generate the frequency array of a DNA string.</span>
<span id="cb375-565"><a href="#cb375-565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-566"><a href="#cb375-566" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;<span class="co">[</span><span class="ot">DNA string</span><span class="co">](https://rosalind.info/glossary/dna-string/)</span>&nbsp;*Text*&nbsp;and an integer&nbsp;*k*.</span>
<span id="cb375-567"><a href="#cb375-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-568"><a href="#cb375-568" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The frequency array of&nbsp;*k*-mers in&nbsp;*Text*.</span>
<span id="cb375-569"><a href="#cb375-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-570"><a href="#cb375-570" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Dataset</span></span>
<span id="cb375-571"><a href="#cb375-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-572"><a href="#cb375-572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-573"><a href="#cb375-573" aria-hidden="true" tabindex="-1"></a><span class="in">ACGCGGCTCTGAAA</span></span>
<span id="cb375-574"><a href="#cb375-574" aria-hidden="true" tabindex="-1"></a><span class="in">2</span></span>
<span id="cb375-575"><a href="#cb375-575" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-576"><a href="#cb375-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-577"><a href="#cb375-577" aria-hidden="true" tabindex="-1"></a><span class="fu">## Sample Output</span></span>
<span id="cb375-578"><a href="#cb375-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-579"><a href="#cb375-579" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-580"><a href="#cb375-580" aria-hidden="true" tabindex="-1"></a><span class="in">2 1 0 0 0 0 2 2 1 2 1 0 0 1 1 0</span></span>
<span id="cb375-581"><a href="#cb375-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb375-582"><a href="#cb375-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-583"><a href="#cb375-583" aria-hidden="true" tabindex="-1"></a><span class="fu">## Solution</span></span>
<span id="cb375-584"><a href="#cb375-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-585"><a href="#cb375-585" aria-hidden="true" tabindex="-1"></a><span class="in">```python</span></span>
<span id="cb375-586"><a href="#cb375-586" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict, Tuple</span>
<span id="cb375-587"><a href="#cb375-587" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb375-588"><a href="#cb375-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-589"><a href="#cb375-589" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-590"><a href="#cb375-590" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (text[i : i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb375-591"><a href="#cb375-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-592"><a href="#cb375-592" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-593"><a href="#cb375-593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb375-594"><a href="#cb375-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-595"><a href="#cb375-595" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(s1: <span class="bu">str</span>, s2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-596"><a href="#cb375-596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(s1, s2))</span>
<span id="cb375-597"><a href="#cb375-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-598"><a href="#cb375-598" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(k: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-599"><a href="#cb375-599" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>k))</span>
<span id="cb375-600"><a href="#cb375-600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-601"><a href="#cb375-601" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-602"><a href="#cb375-602" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb375-603"><a href="#cb375-603" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts </span>
<span id="cb375-604"><a href="#cb375-604" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb375-605"><a href="#cb375-605" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-606"><a href="#cb375-606" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb375-607"><a href="#cb375-607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-608"><a href="#cb375-608" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_frequencies(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-609"><a href="#cb375-609" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_pattern_occurrences(sequence, kmer) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length)]</span>
<span id="cb375-610"><a href="#cb375-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-611"><a href="#cb375-611" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb375-612"><a href="#cb375-612" aria-hidden="true" tabindex="-1"></a>    sequence, kmer_length <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-613"><a href="#cb375-613" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(kmer_length)</span>
<span id="cb375-614"><a href="#cb375-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-615"><a href="#cb375-615" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-616"><a href="#cb375-616" aria-hidden="true" tabindex="-1"></a><span class="st">ACGCGGCTCTGAAA</span></span>
<span id="cb375-617"><a href="#cb375-617" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb375-618"><a href="#cb375-618" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-619"><a href="#cb375-619" aria-hidden="true" tabindex="-1"></a>sequence, kmer_length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-620"><a href="#cb375-620" aria-hidden="true" tabindex="-1"></a>kmer_frequencies <span class="op">=</span> calculate_kmer_frequencies(sequence, kmer_length)</span>
<span id="cb375-621"><a href="#cb375-621" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>kmer_frequencies</span>
<span id="cb375-622"><a href="#cb375-622" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-623"><a href="#cb375-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-624"><a href="#cb375-624" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement PatternToNumber</span></span>
<span id="cb375-625"><a href="#cb375-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-626"><a href="#cb375-626" aria-hidden="true" tabindex="-1"></a>Implement PatternToNumber, Convert a DNA string to a number.</span>
<span id="cb375-627"><a href="#cb375-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-628"><a href="#cb375-628" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>.</span>
<span id="cb375-629"><a href="#cb375-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-630"><a href="#cb375-630" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>PatternToNumber<span class="op">*</span>(<span class="op">*</span>Pattern<span class="op">*</span>).</span>
<span id="cb375-631"><a href="#cb375-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-632"><a href="#cb375-632" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-633"><a href="#cb375-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-634"><a href="#cb375-634" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-635"><a href="#cb375-635" aria-hidden="true" tabindex="-1"></a>AGT</span>
<span id="cb375-636"><a href="#cb375-636" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-637"><a href="#cb375-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-638"><a href="#cb375-638" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-639"><a href="#cb375-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-640"><a href="#cb375-640" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-641"><a href="#cb375-641" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span></span>
<span id="cb375-642"><a href="#cb375-642" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-643"><a href="#cb375-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-644"><a href="#cb375-644" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-645"><a href="#cb375-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-646"><a href="#cb375-646" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-647"><a href="#cb375-647" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple</span>
<span id="cb375-648"><a href="#cb375-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-649"><a href="#cb375-649" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_nucleotide_to_number_map() <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb375-650"><a href="#cb375-650" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb375-651"><a href="#cb375-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-652"><a href="#cb375-652" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_nucleotide_to_number(nucleotide: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-653"><a href="#cb375-653" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotide_map[nucleotide]</span>
<span id="cb375-654"><a href="#cb375-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-655"><a href="#cb375-655" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_dna_pattern_to_number(dna_pattern: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-656"><a href="#cb375-656" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> dna_pattern:</span>
<span id="cb375-657"><a href="#cb375-657" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb375-658"><a href="#cb375-658" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> convert_dna_pattern_to_number(dna_pattern[:<span class="op">-</span><span class="dv">1</span>], nucleotide_map) <span class="op">+</span> convert_nucleotide_to_number(dna_pattern[<span class="op">-</span><span class="dv">1</span>], nucleotide_map)</span>
<span id="cb375-659"><a href="#cb375-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-660"><a href="#cb375-660" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-661"><a href="#cb375-661" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_data.strip()</span>
<span id="cb375-662"><a href="#cb375-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-663"><a href="#cb375-663" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-664"><a href="#cb375-664" aria-hidden="true" tabindex="-1"></a><span class="st">AGT</span></span>
<span id="cb375-665"><a href="#cb375-665" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-666"><a href="#cb375-666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-667"><a href="#cb375-667" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-668"><a href="#cb375-668" aria-hidden="true" tabindex="-1"></a>nucleotide_map <span class="op">=</span> create_nucleotide_to_number_map()</span>
<span id="cb375-669"><a href="#cb375-669" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> convert_dna_pattern_to_number(dna_pattern, nucleotide_map)</span>
<span id="cb375-670"><a href="#cb375-670" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-671"><a href="#cb375-671" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-672"><a href="#cb375-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-673"><a href="#cb375-673" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement NumberToPattern</span></span>
<span id="cb375-674"><a href="#cb375-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-675"><a href="#cb375-675" aria-hidden="true" tabindex="-1"></a>Implement NumberToPattern, Convert an integer to its corresponding DNA string.</span>
<span id="cb375-676"><a href="#cb375-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-677"><a href="#cb375-677" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>index<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>k<span class="op">*</span>.</span>
<span id="cb375-678"><a href="#cb375-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-679"><a href="#cb375-679" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>NumberToPattern<span class="op">*</span>(<span class="op">*</span>index<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>).</span>
<span id="cb375-680"><a href="#cb375-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-681"><a href="#cb375-681" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-682"><a href="#cb375-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-683"><a href="#cb375-683" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-684"><a href="#cb375-684" aria-hidden="true" tabindex="-1"></a><span class="dv">45</span></span>
<span id="cb375-685"><a href="#cb375-685" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-686"><a href="#cb375-686" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-687"><a href="#cb375-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-688"><a href="#cb375-688" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-689"><a href="#cb375-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-690"><a href="#cb375-690" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-691"><a href="#cb375-691" aria-hidden="true" tabindex="-1"></a>AGTC</span>
<span id="cb375-692"><a href="#cb375-692" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-693"><a href="#cb375-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-694"><a href="#cb375-694" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-695"><a href="#cb375-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-696"><a href="#cb375-696" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-697"><a href="#cb375-697" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb375-698"><a href="#cb375-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-699"><a href="#cb375-699" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_nucleotide(index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-700"><a href="#cb375-700" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb375-701"><a href="#cb375-701" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotides[index]</span>
<span id="cb375-702"><a href="#cb375-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-703"><a href="#cb375-703" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_dna_pattern(index: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-704"><a href="#cb375-704" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> length <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb375-705"><a href="#cb375-705" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> number_to_nucleotide(index)</span>
<span id="cb375-706"><a href="#cb375-706" aria-hidden="true" tabindex="-1"></a>    quotient, remainder <span class="op">=</span> <span class="bu">divmod</span>(index, <span class="dv">4</span>)</span>
<span id="cb375-707"><a href="#cb375-707" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> number_to_dna_pattern(quotient, length <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> number_to_nucleotide(remainder)</span>
<span id="cb375-708"><a href="#cb375-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-709"><a href="#cb375-709" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-710"><a href="#cb375-710" aria-hidden="true" tabindex="-1"></a>    index_str, length_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-711"><a href="#cb375-711" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(index_str), <span class="bu">int</span>(length_str)</span>
<span id="cb375-712"><a href="#cb375-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-713"><a href="#cb375-713" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-714"><a href="#cb375-714" aria-hidden="true" tabindex="-1"></a><span class="st">45</span></span>
<span id="cb375-715"><a href="#cb375-715" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-716"><a href="#cb375-716" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-717"><a href="#cb375-717" aria-hidden="true" tabindex="-1"></a>index, length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-718"><a href="#cb375-718" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> number_to_dna_pattern(index, length)</span>
<span id="cb375-719"><a href="#cb375-719" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dna_pattern)</span>
<span id="cb375-720"><a href="#cb375-720" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-721"><a href="#cb375-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-722"><a href="#cb375-722" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the d-Neighborhood of a String</span></span>
<span id="cb375-723"><a href="#cb375-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-724"><a href="#cb375-724" aria-hidden="true" tabindex="-1"></a>Generate the d<span class="op">-</span>Neighborhood of a String Find <span class="bu">all</span> the neighbors of a pattern.</span>
<span id="cb375-725"><a href="#cb375-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-726"><a href="#cb375-726" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>&nbsp;and an integer&nbsp;<span class="op">*</span>d<span class="op">*</span>.</span>
<span id="cb375-727"><a href="#cb375-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-728"><a href="#cb375-728" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The collection of strings&nbsp;<span class="op">*</span>Neighbors<span class="op">*</span>(<span class="op">*</span>Pattern<span class="op">*</span>,&nbsp;<span class="op">*</span>d<span class="op">*</span>).</span>
<span id="cb375-729"><a href="#cb375-729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-730"><a href="#cb375-730" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-731"><a href="#cb375-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-732"><a href="#cb375-732" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-733"><a href="#cb375-733" aria-hidden="true" tabindex="-1"></a>ACG</span>
<span id="cb375-734"><a href="#cb375-734" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb375-735"><a href="#cb375-735" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-736"><a href="#cb375-736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-737"><a href="#cb375-737" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-738"><a href="#cb375-738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-739"><a href="#cb375-739" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-740"><a href="#cb375-740" aria-hidden="true" tabindex="-1"></a>CCG</span>
<span id="cb375-741"><a href="#cb375-741" aria-hidden="true" tabindex="-1"></a>TCG</span>
<span id="cb375-742"><a href="#cb375-742" aria-hidden="true" tabindex="-1"></a>GCG</span>
<span id="cb375-743"><a href="#cb375-743" aria-hidden="true" tabindex="-1"></a>AAG</span>
<span id="cb375-744"><a href="#cb375-744" aria-hidden="true" tabindex="-1"></a>ATG</span>
<span id="cb375-745"><a href="#cb375-745" aria-hidden="true" tabindex="-1"></a>AGG</span>
<span id="cb375-746"><a href="#cb375-746" aria-hidden="true" tabindex="-1"></a>ACA</span>
<span id="cb375-747"><a href="#cb375-747" aria-hidden="true" tabindex="-1"></a>ACC</span>
<span id="cb375-748"><a href="#cb375-748" aria-hidden="true" tabindex="-1"></a>ACT</span>
<span id="cb375-749"><a href="#cb375-749" aria-hidden="true" tabindex="-1"></a>ACG</span>
<span id="cb375-750"><a href="#cb375-750" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-751"><a href="#cb375-751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-752"><a href="#cb375-752" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-753"><a href="#cb375-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-754"><a href="#cb375-754" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-755"><a href="#cb375-755" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Set, List, Tuple, Iterator</span>
<span id="cb375-756"><a href="#cb375-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-757"><a href="#cb375-757" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-758"><a href="#cb375-758" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb375-759"><a href="#cb375-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-760"><a href="#cb375-760" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_immediate_neighbors(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-761"><a href="#cb375-761" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb375-762"><a href="#cb375-762" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, current_base <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb375-763"><a href="#cb375-763" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> new_base <span class="kw">in</span> nucleotides:</span>
<span id="cb375-764"><a href="#cb375-764" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> new_base <span class="op">!=</span> current_base:</span>
<span id="cb375-765"><a href="#cb375-765" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence[:i] <span class="op">+</span> new_base <span class="op">+</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:]</span>
<span id="cb375-766"><a href="#cb375-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-767"><a href="#cb375-767" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb375-768"><a href="#cb375-768" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb375-769"><a href="#cb375-769" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb375-770"><a href="#cb375-770" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb375-771"><a href="#cb375-771" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb375-772"><a href="#cb375-772" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb375-773"><a href="#cb375-773" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-774"><a href="#cb375-774" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-775"><a href="#cb375-775" aria-hidden="true" tabindex="-1"></a>    suffix_neighbors <span class="op">=</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance)</span>
<span id="cb375-776"><a href="#cb375-776" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> suffix <span class="kw">in</span> suffix_neighbors:</span>
<span id="cb375-777"><a href="#cb375-777" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], suffix) <span class="op">&lt;</span> max_distance:</span>
<span id="cb375-778"><a href="#cb375-778" aria-hidden="true" tabindex="-1"></a>            neighbors.update(base <span class="op">+</span> suffix <span class="cf">for</span> base <span class="kw">in</span> nucleotides)</span>
<span id="cb375-779"><a href="#cb375-779" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-780"><a href="#cb375-780" aria-hidden="true" tabindex="-1"></a>            neighbors.add(sequence[<span class="dv">0</span>] <span class="op">+</span> suffix)</span>
<span id="cb375-781"><a href="#cb375-781" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbors</span>
<span id="cb375-782"><a href="#cb375-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-783"><a href="#cb375-783" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb375-784"><a href="#cb375-784" aria-hidden="true" tabindex="-1"></a>    sequence, distance <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-785"><a href="#cb375-785" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(distance)</span>
<span id="cb375-786"><a href="#cb375-786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-787"><a href="#cb375-787" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-788"><a href="#cb375-788" aria-hidden="true" tabindex="-1"></a><span class="st">ACG</span></span>
<span id="cb375-789"><a href="#cb375-789" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb375-790"><a href="#cb375-790" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-791"><a href="#cb375-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-792"><a href="#cb375-792" aria-hidden="true" tabindex="-1"></a>sequence, max_distance <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-793"><a href="#cb375-793" aria-hidden="true" tabindex="-1"></a>neighbor_sequences <span class="op">=</span> generate_neighbors(sequence, max_distance)</span>
<span id="cb375-794"><a href="#cb375-794" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(neighbor_sequences), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-795"><a href="#cb375-795" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-796"><a href="#cb375-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-797"><a href="#cb375-797" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement MotifEnumeration</span></span>
<span id="cb375-798"><a href="#cb375-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-799"><a href="#cb375-799" aria-hidden="true" tabindex="-1"></a>Implanted Motif Problem. Implement MotifEnumeration (shown above) to find <span class="bu">all</span> (k, d)<span class="op">-</span>motifs <span class="kw">in</span> a collection of strings.</span>
<span id="cb375-800"><a href="#cb375-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-801"><a href="#cb375-801" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>d<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb375-802"><a href="#cb375-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-803"><a href="#cb375-803" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All (<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>d<span class="op">*</span>)<span class="op">-</span>motifs in&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb375-804"><a href="#cb375-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-805"><a href="#cb375-805" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-806"><a href="#cb375-806" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-807"><a href="#cb375-807" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-808"><a href="#cb375-808" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">1</span></span>
<span id="cb375-809"><a href="#cb375-809" aria-hidden="true" tabindex="-1"></a>ATTTGGC</span>
<span id="cb375-810"><a href="#cb375-810" aria-hidden="true" tabindex="-1"></a>TGCCTTA</span>
<span id="cb375-811"><a href="#cb375-811" aria-hidden="true" tabindex="-1"></a>CGGTATC</span>
<span id="cb375-812"><a href="#cb375-812" aria-hidden="true" tabindex="-1"></a>GAAAATT</span>
<span id="cb375-813"><a href="#cb375-813" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-814"><a href="#cb375-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-815"><a href="#cb375-815" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-816"><a href="#cb375-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-817"><a href="#cb375-817" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-818"><a href="#cb375-818" aria-hidden="true" tabindex="-1"></a>ATA ATT GTT TTT</span>
<span id="cb375-819"><a href="#cb375-819" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-820"><a href="#cb375-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-821"><a href="#cb375-821" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-822"><a href="#cb375-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-823"><a href="#cb375-823" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-824"><a href="#cb375-824" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Iterator</span>
<span id="cb375-825"><a href="#cb375-825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-826"><a href="#cb375-826" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-827"><a href="#cb375-827" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb375-828"><a href="#cb375-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-829"><a href="#cb375-829" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb375-830"><a href="#cb375-830" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb375-831"><a href="#cb375-831" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb375-832"><a href="#cb375-832" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb375-833"><a href="#cb375-833" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb375-834"><a href="#cb375-834" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb375-835"><a href="#cb375-835" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-836"><a href="#cb375-836" aria-hidden="true" tabindex="-1"></a>    neighbor_set <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-837"><a href="#cb375-837" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance):</span>
<span id="cb375-838"><a href="#cb375-838" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], neighbor) <span class="op">&lt;</span> max_distance:</span>
<span id="cb375-839"><a href="#cb375-839" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb375-840"><a href="#cb375-840" aria-hidden="true" tabindex="-1"></a>                neighbor_set.add(nucleotide <span class="op">+</span> neighbor)</span>
<span id="cb375-841"><a href="#cb375-841" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-842"><a href="#cb375-842" aria-hidden="true" tabindex="-1"></a>            neighbor_set.add(sequence[<span class="dv">0</span>] <span class="op">+</span> neighbor)</span>
<span id="cb375-843"><a href="#cb375-843" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbor_set</span>
<span id="cb375-844"><a href="#cb375-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-845"><a href="#cb375-845" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-846"><a href="#cb375-846" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-847"><a href="#cb375-847" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb375-848"><a href="#cb375-848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-849"><a href="#cb375-849" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_kmers(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb375-850"><a href="#cb375-850" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(kmer <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length))</span>
<span id="cb375-851"><a href="#cb375-851" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-852"><a href="#cb375-852" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> contains_approximate_match(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb375-853"><a href="#cb375-853" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_distance </span>
<span id="cb375-854"><a href="#cb375-854" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb375-855"><a href="#cb375-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-856"><a href="#cb375-856" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enumerate_motifs(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb375-857"><a href="#cb375-857" aria-hidden="true" tabindex="-1"></a>    motif_patterns <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-858"><a href="#cb375-858" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> get_all_kmers(dna_sequences, kmer_length):</span>
<span id="cb375-859"><a href="#cb375-859" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor_kmer <span class="kw">in</span> generate_neighbors(kmer, max_distance):</span>
<span id="cb375-860"><a href="#cb375-860" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(contains_approximate_match(neighbor_kmer, sequence, max_distance) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences):</span>
<span id="cb375-861"><a href="#cb375-861" aria-hidden="true" tabindex="-1"></a>                motif_patterns.add(neighbor_kmer)</span>
<span id="cb375-862"><a href="#cb375-862" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> motif_patterns</span>
<span id="cb375-863"><a href="#cb375-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-864"><a href="#cb375-864" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-865"><a href="#cb375-865" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-866"><a href="#cb375-866" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb375-867"><a href="#cb375-867" aria-hidden="true" tabindex="-1"></a><span class="st">ATTTGGC</span></span>
<span id="cb375-868"><a href="#cb375-868" aria-hidden="true" tabindex="-1"></a><span class="st">TGCCTTA</span></span>
<span id="cb375-869"><a href="#cb375-869" aria-hidden="true" tabindex="-1"></a><span class="st">CGGTATC</span></span>
<span id="cb375-870"><a href="#cb375-870" aria-hidden="true" tabindex="-1"></a><span class="st">GAAAATT</span></span>
<span id="cb375-871"><a href="#cb375-871" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-872"><a href="#cb375-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-873"><a href="#cb375-873" aria-hidden="true" tabindex="-1"></a>input_params, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-874"><a href="#cb375-874" aria-hidden="true" tabindex="-1"></a>kmer_length, max_distance <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_params.split())</span>
<span id="cb375-875"><a href="#cb375-875" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(enumerate_motifs(dna_sequences, kmer_length, max_distance)))</span>
<span id="cb375-876"><a href="#cb375-876" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-877"><a href="#cb375-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-878"><a href="#cb375-878" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Median String</span></span>
<span id="cb375-879"><a href="#cb375-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-880"><a href="#cb375-880" aria-hidden="true" tabindex="-1"></a>Median String Problem, Find a median string.</span>
<span id="cb375-881"><a href="#cb375-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-882"><a href="#cb375-882" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb375-883"><a href="#cb375-883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-884"><a href="#cb375-884" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>&nbsp;that minimizes&nbsp;<span class="op">*</span>d<span class="op">*</span>(<span class="op">*</span>Pattern<span class="op">*</span>,&nbsp;<span class="op">*</span>Dna<span class="op">*</span>) over all&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-885"><a href="#cb375-885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-886"><a href="#cb375-886" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-887"><a href="#cb375-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-888"><a href="#cb375-888" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-889"><a href="#cb375-889" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb375-890"><a href="#cb375-890" aria-hidden="true" tabindex="-1"></a>AAATTGACGCAT</span>
<span id="cb375-891"><a href="#cb375-891" aria-hidden="true" tabindex="-1"></a>GACGACCACGTT</span>
<span id="cb375-892"><a href="#cb375-892" aria-hidden="true" tabindex="-1"></a>CGTCAGCGCCTG</span>
<span id="cb375-893"><a href="#cb375-893" aria-hidden="true" tabindex="-1"></a>GCTGAGCACCGG</span>
<span id="cb375-894"><a href="#cb375-894" aria-hidden="true" tabindex="-1"></a>AGTACGGGACAG</span>
<span id="cb375-895"><a href="#cb375-895" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-896"><a href="#cb375-896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-897"><a href="#cb375-897" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-898"><a href="#cb375-898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-899"><a href="#cb375-899" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-900"><a href="#cb375-900" aria-hidden="true" tabindex="-1"></a>ACG</span>
<span id="cb375-901"><a href="#cb375-901" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-902"><a href="#cb375-902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-903"><a href="#cb375-903" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-904"><a href="#cb375-904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-905"><a href="#cb375-905" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-906"><a href="#cb375-906" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb375-907"><a href="#cb375-907" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb375-908"><a href="#cb375-908" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb375-909"><a href="#cb375-909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-910"><a href="#cb375-910" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-911"><a href="#cb375-911" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-912"><a href="#cb375-912" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb375-913"><a href="#cb375-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-914"><a href="#cb375-914" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-915"><a href="#cb375-915" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(nucleotides) <span class="cf">for</span> nucleotides <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb375-916"><a href="#cb375-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-917"><a href="#cb375-917" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-918"><a href="#cb375-918" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(nucleotide1 <span class="op">!=</span> nucleotide2 <span class="cf">for</span> nucleotide1, nucleotide2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb375-919"><a href="#cb375-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-920"><a href="#cb375-920" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-921"><a href="#cb375-921" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(substring, pattern) <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb375-922"><a href="#cb375-922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-923"><a href="#cb375-923" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_total_distance(pattern: <span class="bu">str</span>, dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-924"><a href="#cb375-924" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, sequence) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences)</span>
<span id="cb375-925"><a href="#cb375-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-926"><a href="#cb375-926" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_median_string(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-927"><a href="#cb375-927" aria-hidden="true" tabindex="-1"></a>    min_distance <span class="op">=</span> math.inf</span>
<span id="cb375-928"><a href="#cb375-928" aria-hidden="true" tabindex="-1"></a>    median_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-929"><a href="#cb375-929" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-930"><a href="#cb375-930" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb375-931"><a href="#cb375-931" aria-hidden="true" tabindex="-1"></a>        current_distance <span class="op">=</span> calculate_total_distance(kmer, dna_sequences)</span>
<span id="cb375-932"><a href="#cb375-932" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_distance <span class="op">&lt;</span> min_distance:</span>
<span id="cb375-933"><a href="#cb375-933" aria-hidden="true" tabindex="-1"></a>            min_distance <span class="op">=</span> current_distance</span>
<span id="cb375-934"><a href="#cb375-934" aria-hidden="true" tabindex="-1"></a>            median_kmer <span class="op">=</span> kmer</span>
<span id="cb375-935"><a href="#cb375-935" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-936"><a href="#cb375-936" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> median_kmer</span>
<span id="cb375-937"><a href="#cb375-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-938"><a href="#cb375-938" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-939"><a href="#cb375-939" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-940"><a href="#cb375-940" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb375-941"><a href="#cb375-941" aria-hidden="true" tabindex="-1"></a><span class="st">AAATTGACGCAT</span></span>
<span id="cb375-942"><a href="#cb375-942" aria-hidden="true" tabindex="-1"></a><span class="st">GACGACCACGTT</span></span>
<span id="cb375-943"><a href="#cb375-943" aria-hidden="true" tabindex="-1"></a><span class="st">CGTCAGCGCCTG</span></span>
<span id="cb375-944"><a href="#cb375-944" aria-hidden="true" tabindex="-1"></a><span class="st">GCTGAGCACCGG</span></span>
<span id="cb375-945"><a href="#cb375-945" aria-hidden="true" tabindex="-1"></a><span class="st">AGTACGGGACAG</span></span>
<span id="cb375-946"><a href="#cb375-946" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-947"><a href="#cb375-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-948"><a href="#cb375-948" aria-hidden="true" tabindex="-1"></a>kmer_length, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-949"><a href="#cb375-949" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_median_string(dna_sequences, <span class="bu">int</span>(kmer_length))</span>
<span id="cb375-950"><a href="#cb375-950" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-951"><a href="#cb375-951" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-952"><a href="#cb375-952" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-953"><a href="#cb375-953" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Profile-most Probable k-mer in a String</span></span>
<span id="cb375-954"><a href="#cb375-954" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-955"><a href="#cb375-955" aria-hidden="true" tabindex="-1"></a>Profile<span class="op">-</span>most Probable&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer Problem, Find a Profile<span class="op">-</span>most probable k<span class="op">-</span>mer <span class="kw">in</span> a string.</span>
<span id="cb375-956"><a href="#cb375-956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-957"><a href="#cb375-957" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>, an integer&nbsp;<span class="op">*</span>k<span class="op">*</span>, <span class="kw">and</span> a <span class="dv">4</span> ×&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;matrix&nbsp;<span class="op">*</span>Profile<span class="op">*</span>.</span>
<span id="cb375-958"><a href="#cb375-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-959"><a href="#cb375-959" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A&nbsp;<span class="op">*</span>Profile<span class="op">*-</span>most probable&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer in&nbsp;<span class="op">*</span>Text<span class="op">*</span>. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-960"><a href="#cb375-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-961"><a href="#cb375-961" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-962"><a href="#cb375-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-963"><a href="#cb375-963" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-964"><a href="#cb375-964" aria-hidden="true" tabindex="-1"></a>ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span>
<span id="cb375-965"><a href="#cb375-965" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb375-966"><a href="#cb375-966" aria-hidden="true" tabindex="-1"></a><span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.3</span> <span class="fl">0.2</span> <span class="fl">0.3</span></span>
<span id="cb375-967"><a href="#cb375-967" aria-hidden="true" tabindex="-1"></a><span class="fl">0.4</span> <span class="fl">0.3</span> <span class="fl">0.1</span> <span class="fl">0.5</span> <span class="fl">0.1</span></span>
<span id="cb375-968"><a href="#cb375-968" aria-hidden="true" tabindex="-1"></a><span class="fl">0.3</span> <span class="fl">0.3</span> <span class="fl">0.5</span> <span class="fl">0.2</span> <span class="fl">0.4</span></span>
<span id="cb375-969"><a href="#cb375-969" aria-hidden="true" tabindex="-1"></a><span class="fl">0.1</span> <span class="fl">0.2</span> <span class="fl">0.1</span> <span class="fl">0.1</span> <span class="fl">0.2</span></span>
<span id="cb375-970"><a href="#cb375-970" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-971"><a href="#cb375-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-972"><a href="#cb375-972" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-973"><a href="#cb375-973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-974"><a href="#cb375-974" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-975"><a href="#cb375-975" aria-hidden="true" tabindex="-1"></a>CCGAG</span>
<span id="cb375-976"><a href="#cb375-976" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-977"><a href="#cb375-977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-978"><a href="#cb375-978" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-979"><a href="#cb375-979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-980"><a href="#cb375-980" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-981"><a href="#cb375-981" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb375-982"><a href="#cb375-982" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb375-983"><a href="#cb375-983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-984"><a href="#cb375-984" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-985"><a href="#cb375-985" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-986"><a href="#cb375-986" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb375-987"><a href="#cb375-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-988"><a href="#cb375-988" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_profile_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile_matrix: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-989"><a href="#cb375-989" aria-hidden="true" tabindex="-1"></a>    nucleotide_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb375-990"><a href="#cb375-990" aria-hidden="true" tabindex="-1"></a>    max_probability <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb375-991"><a href="#cb375-991" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-992"><a href="#cb375-992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-993"><a href="#cb375-993" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length):</span>
<span id="cb375-994"><a href="#cb375-994" aria-hidden="true" tabindex="-1"></a>        kmer_probability <span class="op">=</span> math.prod(profile_matrix[nucleotide_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb375-995"><a href="#cb375-995" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb375-996"><a href="#cb375-996" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb375-997"><a href="#cb375-997" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb375-998"><a href="#cb375-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-999"><a href="#cb375-999" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb375-1000"><a href="#cb375-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1001"><a href="#cb375-1001" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-1002"><a href="#cb375-1002" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1003"><a href="#cb375-1003" aria-hidden="true" tabindex="-1"></a><span class="st">ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span></span>
<span id="cb375-1004"><a href="#cb375-1004" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb375-1005"><a href="#cb375-1005" aria-hidden="true" tabindex="-1"></a><span class="st">0.2 0.2 0.3 0.2 0.3</span></span>
<span id="cb375-1006"><a href="#cb375-1006" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.3 0.1 0.5 0.1</span></span>
<span id="cb375-1007"><a href="#cb375-1007" aria-hidden="true" tabindex="-1"></a><span class="st">0.3 0.3 0.5 0.2 0.4</span></span>
<span id="cb375-1008"><a href="#cb375-1008" aria-hidden="true" tabindex="-1"></a><span class="st">0.1 0.2 0.1 0.1 0.2</span></span>
<span id="cb375-1009"><a href="#cb375-1009" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1010"><a href="#cb375-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1011"><a href="#cb375-1011" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, <span class="op">*</span>profile_rows <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1012"><a href="#cb375-1012" aria-hidden="true" tabindex="-1"></a>profile_matrix <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> profile_rows]</span>
<span id="cb375-1013"><a href="#cb375-1013" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_profile_most_probable_kmer(dna_sequence, <span class="bu">int</span>(kmer_length), profile_matrix)</span>
<span id="cb375-1014"><a href="#cb375-1014" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-1015"><a href="#cb375-1015" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1016"><a href="#cb375-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1017"><a href="#cb375-1017" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GreedyMotifSearch</span></span>
<span id="cb375-1018"><a href="#cb375-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1019"><a href="#cb375-1019" aria-hidden="true" tabindex="-1"></a> Implement, GreedyMotifSearch.</span>
<span id="cb375-1020"><a href="#cb375-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1021"><a href="#cb375-1021" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>t<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb375-1022"><a href="#cb375-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1023"><a href="#cb375-1023" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A collection of strings&nbsp;<span class="op">*</span>BestMotifs<span class="op">*</span>&nbsp;resulting <span class="im">from</span> running&nbsp;<span class="op">*</span>GreedyMotifSearch<span class="op">*</span>(<span class="op">*</span>Dna<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>). If at <span class="bu">any</span> step you find more than one&nbsp;<span class="op">*</span>Profile<span class="op">*-</span>most probable&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer <span class="kw">in</span> a given string, use the one occurring first.</span>
<span id="cb375-1024"><a href="#cb375-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1025"><a href="#cb375-1025" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1026"><a href="#cb375-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1027"><a href="#cb375-1027" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1028"><a href="#cb375-1028" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">5</span></span>
<span id="cb375-1029"><a href="#cb375-1029" aria-hidden="true" tabindex="-1"></a>GGCGTTCAGGCA</span>
<span id="cb375-1030"><a href="#cb375-1030" aria-hidden="true" tabindex="-1"></a>AAGAATCAGTCA</span>
<span id="cb375-1031"><a href="#cb375-1031" aria-hidden="true" tabindex="-1"></a>CAAGGAGTTCGC</span>
<span id="cb375-1032"><a href="#cb375-1032" aria-hidden="true" tabindex="-1"></a>CACGTCAATCAC</span>
<span id="cb375-1033"><a href="#cb375-1033" aria-hidden="true" tabindex="-1"></a>CAATAATATTCG</span>
<span id="cb375-1034"><a href="#cb375-1034" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1035"><a href="#cb375-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1036"><a href="#cb375-1036" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1037"><a href="#cb375-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1038"><a href="#cb375-1038" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1039"><a href="#cb375-1039" aria-hidden="true" tabindex="-1"></a>CAG</span>
<span id="cb375-1040"><a href="#cb375-1040" aria-hidden="true" tabindex="-1"></a>CAG</span>
<span id="cb375-1041"><a href="#cb375-1041" aria-hidden="true" tabindex="-1"></a>CAA</span>
<span id="cb375-1042"><a href="#cb375-1042" aria-hidden="true" tabindex="-1"></a>CAA</span>
<span id="cb375-1043"><a href="#cb375-1043" aria-hidden="true" tabindex="-1"></a>CAA</span>
<span id="cb375-1044"><a href="#cb375-1044" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1045"><a href="#cb375-1045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1046"><a href="#cb375-1046" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1047"><a href="#cb375-1047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1048"><a href="#cb375-1048" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1049"><a href="#cb375-1049" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb375-1050"><a href="#cb375-1050" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb375-1051"><a href="#cb375-1051" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb375-1052"><a href="#cb375-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1053"><a href="#cb375-1053" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-1054"><a href="#cb375-1054" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-1055"><a href="#cb375-1055" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb375-1056"><a href="#cb375-1056" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1057"><a href="#cb375-1057" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-1058"><a href="#cb375-1058" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb375-1059"><a href="#cb375-1059" aria-hidden="true" tabindex="-1"></a>    max_probability: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb375-1060"><a href="#cb375-1060" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-1061"><a href="#cb375-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1062"><a href="#cb375-1062" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length):</span>
<span id="cb375-1063"><a href="#cb375-1063" aria-hidden="true" tabindex="-1"></a>        kmer_probability: <span class="bu">float</span> <span class="op">=</span> math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb375-1064"><a href="#cb375-1064" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb375-1065"><a href="#cb375-1065" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb375-1066"><a href="#cb375-1066" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb375-1067"><a href="#cb375-1067" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1068"><a href="#cb375-1068" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb375-1069"><a href="#cb375-1069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1070"><a href="#cb375-1070" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(sequences: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb375-1071"><a href="#cb375-1071" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb375-1072"><a href="#cb375-1072" aria-hidden="true" tabindex="-1"></a>    profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> [[] <span class="cf">for</span> _ <span class="kw">in</span> nucleotides]</span>
<span id="cb375-1073"><a href="#cb375-1073" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(nucleotides):</span>
<span id="cb375-1074"><a href="#cb375-1074" aria-hidden="true" tabindex="-1"></a>        profile[i] <span class="op">=</span> [</span>
<span id="cb375-1075"><a href="#cb375-1075" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> sequences) <span class="op">+</span> pseudocount) <span class="op">/</span> <span class="bu">len</span>(sequences)</span>
<span id="cb375-1076"><a href="#cb375-1076" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequences[<span class="dv">0</span>]))</span>
<span id="cb375-1077"><a href="#cb375-1077" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb375-1078"><a href="#cb375-1078" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb375-1079"><a href="#cb375-1079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1080"><a href="#cb375-1080" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-1081"><a href="#cb375-1081" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-1082"><a href="#cb375-1082" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>])):</span>
<span id="cb375-1083"><a href="#cb375-1083" aria-hidden="true" tabindex="-1"></a>        column: List[<span class="bu">str</span>] <span class="op">=</span> [motif[i] <span class="cf">for</span> motif <span class="kw">in</span> motifs]</span>
<span id="cb375-1084"><a href="#cb375-1084" aria-hidden="true" tabindex="-1"></a>        most_common: <span class="bu">str</span> <span class="op">=</span> Counter(column).most_common()[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb375-1085"><a href="#cb375-1085" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">sum</span>(nucleotide <span class="op">!=</span> most_common <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb375-1086"><a href="#cb375-1086" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb375-1087"><a href="#cb375-1087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1088"><a href="#cb375-1088" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-1089"><a href="#cb375-1089" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [seq[:kmer_length] <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb375-1090"><a href="#cb375-1090" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb375-1091"><a href="#cb375-1091" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb375-1092"><a href="#cb375-1092" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(dna_sequences)):</span>
<span id="cb375-1093"><a href="#cb375-1093" aria-hidden="true" tabindex="-1"></a>            current_profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount<span class="op">=</span>pseudocount)</span>
<span id="cb375-1094"><a href="#cb375-1094" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(dna_sequences[i], kmer_length, current_profile))</span>
<span id="cb375-1095"><a href="#cb375-1095" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb375-1096"><a href="#cb375-1096" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb375-1097"><a href="#cb375-1097" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb375-1098"><a href="#cb375-1098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1099"><a href="#cb375-1099" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-1100"><a href="#cb375-1100" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1101"><a href="#cb375-1101" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb375-1102"><a href="#cb375-1102" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb375-1103"><a href="#cb375-1103" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb375-1104"><a href="#cb375-1104" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb375-1105"><a href="#cb375-1105" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb375-1106"><a href="#cb375-1106" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb375-1107"><a href="#cb375-1107" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1108"><a href="#cb375-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1109"><a href="#cb375-1109" aria-hidden="true" tabindex="-1"></a>ints, <span class="op">*</span>dna <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1110"><a href="#cb375-1110" aria-hidden="true" tabindex="-1"></a>k, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, ints.split())</span>
<span id="cb375-1111"><a href="#cb375-1111" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna, k)</span>
<span id="cb375-1112"><a href="#cb375-1112" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1113"><a href="#cb375-1113" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1114"><a href="#cb375-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1115"><a href="#cb375-1115" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GreedyMotifSearch with Pseudocounts</span></span>
<span id="cb375-1116"><a href="#cb375-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1117"><a href="#cb375-1117" aria-hidden="true" tabindex="-1"></a>Implement.&nbsp;<span class="op">*</span>GreedyMotifSearch<span class="op">*</span>&nbsp;with Pseudocounts.</span>
<span id="cb375-1118"><a href="#cb375-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1119"><a href="#cb375-1119" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>t<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb375-1120"><a href="#cb375-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1121"><a href="#cb375-1121" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A collection of strings&nbsp;<span class="op">*</span>BestMotifs<span class="op">*</span>&nbsp;resulting <span class="im">from</span> running&nbsp;<span class="op">*</span>GreedyMotifSearch<span class="op">*</span>(<span class="op">*</span>Dna<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>) <span class="cf">with</span> pseudocounts. If at <span class="bu">any</span> step you find more than one&nbsp;<span class="op">*</span>Profile<span class="op">*-</span>most probable&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer <span class="kw">in</span> a given string, use the one occurring first.</span>
<span id="cb375-1122"><a href="#cb375-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1123"><a href="#cb375-1123" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1124"><a href="#cb375-1124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1125"><a href="#cb375-1125" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1126"><a href="#cb375-1126" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">5</span></span>
<span id="cb375-1127"><a href="#cb375-1127" aria-hidden="true" tabindex="-1"></a>GGCGTTCAGGCA</span>
<span id="cb375-1128"><a href="#cb375-1128" aria-hidden="true" tabindex="-1"></a>AAGAATCAGTCA</span>
<span id="cb375-1129"><a href="#cb375-1129" aria-hidden="true" tabindex="-1"></a>CAAGGAGTTCGC</span>
<span id="cb375-1130"><a href="#cb375-1130" aria-hidden="true" tabindex="-1"></a>CACGTCAATCAC</span>
<span id="cb375-1131"><a href="#cb375-1131" aria-hidden="true" tabindex="-1"></a>CAATAATATTCG</span>
<span id="cb375-1132"><a href="#cb375-1132" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1133"><a href="#cb375-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1134"><a href="#cb375-1134" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1135"><a href="#cb375-1135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1136"><a href="#cb375-1136" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1137"><a href="#cb375-1137" aria-hidden="true" tabindex="-1"></a>TTC</span>
<span id="cb375-1138"><a href="#cb375-1138" aria-hidden="true" tabindex="-1"></a>ATC</span>
<span id="cb375-1139"><a href="#cb375-1139" aria-hidden="true" tabindex="-1"></a>TTC</span>
<span id="cb375-1140"><a href="#cb375-1140" aria-hidden="true" tabindex="-1"></a>ATC</span>
<span id="cb375-1141"><a href="#cb375-1141" aria-hidden="true" tabindex="-1"></a>TTC</span>
<span id="cb375-1142"><a href="#cb375-1142" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1143"><a href="#cb375-1143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1144"><a href="#cb375-1144" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1145"><a href="#cb375-1145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1146"><a href="#cb375-1146" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1147"><a href="#cb375-1147" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb375-1148"><a href="#cb375-1148" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb375-1149"><a href="#cb375-1149" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb375-1150"><a href="#cb375-1150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1151"><a href="#cb375-1151" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-1152"><a href="#cb375-1152" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-1153"><a href="#cb375-1153" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb375-1154"><a href="#cb375-1154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1155"><a href="#cb375-1155" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-1156"><a href="#cb375-1156" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb375-1157"><a href="#cb375-1157" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb375-1158"><a href="#cb375-1158" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb375-1159"><a href="#cb375-1159" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][position] </span>
<span id="cb375-1160"><a href="#cb375-1160" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">for</span> position, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb375-1161"><a href="#cb375-1161" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-1162"><a href="#cb375-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1163"><a href="#cb375-1163" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb375-1164"><a href="#cb375-1164" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb375-1165"><a href="#cb375-1165" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb375-1166"><a href="#cb375-1166" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb375-1167"><a href="#cb375-1167" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-1168"><a href="#cb375-1168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb375-1169"><a href="#cb375-1169" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> motif_count </span>
<span id="cb375-1170"><a href="#cb375-1170" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb375-1171"><a href="#cb375-1171" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb375-1172"><a href="#cb375-1172" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb375-1173"><a href="#cb375-1173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1174"><a href="#cb375-1174" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-1175"><a href="#cb375-1175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb375-1176"><a href="#cb375-1176" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb375-1177"><a href="#cb375-1177" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb375-1178"><a href="#cb375-1178" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-1179"><a href="#cb375-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1180"><a href="#cb375-1180" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-1181"><a href="#cb375-1181" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [sequence[:kmer_length] <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences]</span>
<span id="cb375-1182"><a href="#cb375-1182" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-1183"><a href="#cb375-1183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb375-1184"><a href="#cb375-1184" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb375-1185"><a href="#cb375-1185" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences[<span class="dv">1</span>:]:</span>
<span id="cb375-1186"><a href="#cb375-1186" aria-hidden="true" tabindex="-1"></a>            profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount)</span>
<span id="cb375-1187"><a href="#cb375-1187" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(sequence, kmer_length, profile))</span>
<span id="cb375-1188"><a href="#cb375-1188" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-1189"><a href="#cb375-1189" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb375-1190"><a href="#cb375-1190" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb375-1191"><a href="#cb375-1191" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-1192"><a href="#cb375-1192" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb375-1193"><a href="#cb375-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1194"><a href="#cb375-1194" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-1195"><a href="#cb375-1195" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1196"><a href="#cb375-1196" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb375-1197"><a href="#cb375-1197" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb375-1198"><a href="#cb375-1198" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb375-1199"><a href="#cb375-1199" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb375-1200"><a href="#cb375-1200" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb375-1201"><a href="#cb375-1201" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb375-1202"><a href="#cb375-1202" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1203"><a href="#cb375-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1204"><a href="#cb375-1204" aria-hidden="true" tabindex="-1"></a>k_value, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb375-1205"><a href="#cb375-1205" aria-hidden="true" tabindex="-1"></a>k_value <span class="op">=</span> <span class="bu">int</span>(k_value)</span>
<span id="cb375-1206"><a href="#cb375-1206" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna_sequences, k_value, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb375-1207"><a href="#cb375-1207" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1208"><a href="#cb375-1208" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1209"><a href="#cb375-1209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1210"><a href="#cb375-1210" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement RandomizedMotifSearch</span></span>
<span id="cb375-1211"><a href="#cb375-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1212"><a href="#cb375-1212" aria-hidden="true" tabindex="-1"></a>Implement&nbsp;<span class="op">*</span>RandomizedMotifSearch<span class="op">*</span>.</span>
<span id="cb375-1213"><a href="#cb375-1213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1214"><a href="#cb375-1214" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Positive integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>t<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb375-1215"><a href="#cb375-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1216"><a href="#cb375-1216" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A collection&nbsp;<span class="op">*</span>BestMotifs<span class="op">*</span>&nbsp;resulting <span class="im">from</span> running&nbsp;<span class="op">*</span>RandomizedMotifSearch<span class="op">*</span>(<span class="op">*</span>Dna<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>) <span class="dv">1000</span> times. Remember to use pseudocounts<span class="op">!</span></span>
<span id="cb375-1217"><a href="#cb375-1217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1218"><a href="#cb375-1218" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1219"><a href="#cb375-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1220"><a href="#cb375-1220" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1221"><a href="#cb375-1221" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="dv">5</span></span>
<span id="cb375-1222"><a href="#cb375-1222" aria-hidden="true" tabindex="-1"></a>CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span>
<span id="cb375-1223"><a href="#cb375-1223" aria-hidden="true" tabindex="-1"></a>GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span>
<span id="cb375-1224"><a href="#cb375-1224" aria-hidden="true" tabindex="-1"></a>TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span>
<span id="cb375-1225"><a href="#cb375-1225" aria-hidden="true" tabindex="-1"></a>TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span>
<span id="cb375-1226"><a href="#cb375-1226" aria-hidden="true" tabindex="-1"></a>AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span>
<span id="cb375-1227"><a href="#cb375-1227" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1228"><a href="#cb375-1228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1229"><a href="#cb375-1229" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1230"><a href="#cb375-1230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1231"><a href="#cb375-1231" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1232"><a href="#cb375-1232" aria-hidden="true" tabindex="-1"></a>AACGGCCA</span>
<span id="cb375-1233"><a href="#cb375-1233" aria-hidden="true" tabindex="-1"></a>AAGTGCCA</span>
<span id="cb375-1234"><a href="#cb375-1234" aria-hidden="true" tabindex="-1"></a>TAGTACCG</span>
<span id="cb375-1235"><a href="#cb375-1235" aria-hidden="true" tabindex="-1"></a>AAGTTTCA</span>
<span id="cb375-1236"><a href="#cb375-1236" aria-hidden="true" tabindex="-1"></a>ACGTGCAA</span>
<span id="cb375-1237"><a href="#cb375-1237" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1238"><a href="#cb375-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1239"><a href="#cb375-1239" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1240"><a href="#cb375-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1241"><a href="#cb375-1241" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1242"><a href="#cb375-1242" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Callable</span>
<span id="cb375-1243"><a href="#cb375-1243" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb375-1244"><a href="#cb375-1244" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> randint</span>
<span id="cb375-1245"><a href="#cb375-1245" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb375-1246"><a href="#cb375-1246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1247"><a href="#cb375-1247" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-1248"><a href="#cb375-1248" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [sequence[i:i<span class="op">+</span>kmer_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-1249"><a href="#cb375-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1250"><a href="#cb375-1250" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-1251"><a href="#cb375-1251" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb375-1252"><a href="#cb375-1252" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb375-1253"><a href="#cb375-1253" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb375-1254"><a href="#cb375-1254" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][j] <span class="cf">for</span> j, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb375-1255"><a href="#cb375-1255" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-1256"><a href="#cb375-1256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1257"><a href="#cb375-1257" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb375-1258"><a href="#cb375-1258" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb375-1259"><a href="#cb375-1259" aria-hidden="true" tabindex="-1"></a>    profile <span class="op">=</span> []</span>
<span id="cb375-1260"><a href="#cb375-1260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb375-1261"><a href="#cb375-1261" aria-hidden="true" tabindex="-1"></a>        profile.append([</span>
<span id="cb375-1262"><a href="#cb375-1262" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (<span class="bu">len</span>(motifs) <span class="op">+</span> <span class="dv">4</span> <span class="op">*</span> pseudocount)</span>
<span id="cb375-1263"><a href="#cb375-1263" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>]))</span>
<span id="cb375-1264"><a href="#cb375-1264" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb375-1265"><a href="#cb375-1265" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb375-1266"><a href="#cb375-1266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1267"><a href="#cb375-1267" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-1268"><a href="#cb375-1268" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb375-1269"><a href="#cb375-1269" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb375-1270"><a href="#cb375-1270" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb375-1271"><a href="#cb375-1271" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-1272"><a href="#cb375-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1273"><a href="#cb375-1273" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-1274"><a href="#cb375-1274" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb375-1275"><a href="#cb375-1275" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start : start <span class="op">+</span> kmer_length]</span>
<span id="cb375-1276"><a href="#cb375-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1277"><a href="#cb375-1277" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_motifs(profile: List[List[<span class="bu">float</span>]], dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-1278"><a href="#cb375-1278" aria-hidden="true" tabindex="-1"></a>    kmer_length <span class="op">=</span> <span class="bu">len</span>(profile[<span class="dv">0</span>])</span>
<span id="cb375-1279"><a href="#cb375-1279" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [find_most_probable_kmer(seq, kmer_length, profile) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb375-1280"><a href="#cb375-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1281"><a href="#cb375-1281" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> randomized_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-1282"><a href="#cb375-1282" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb375-1283"><a href="#cb375-1283" aria-hidden="true" tabindex="-1"></a>    best_score <span class="op">=</span> math.inf</span>
<span id="cb375-1284"><a href="#cb375-1284" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-1285"><a href="#cb375-1285" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb375-1286"><a href="#cb375-1286" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb375-1287"><a href="#cb375-1287" aria-hidden="true" tabindex="-1"></a>        motifs <span class="op">=</span> find_motifs(profile, dna_sequences)</span>
<span id="cb375-1288"><a href="#cb375-1288" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> calculate_score(motifs)</span>
<span id="cb375-1289"><a href="#cb375-1289" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-1290"><a href="#cb375-1290" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;=</span> best_score:</span>
<span id="cb375-1291"><a href="#cb375-1291" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> best_score, motifs</span>
<span id="cb375-1292"><a href="#cb375-1292" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-1293"><a href="#cb375-1293" aria-hidden="true" tabindex="-1"></a>        best_score <span class="op">=</span> current_score</span>
<span id="cb375-1294"><a href="#cb375-1294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1295"><a href="#cb375-1295" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-1296"><a href="#cb375-1296" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb375-1297"><a href="#cb375-1297" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-1298"><a href="#cb375-1298" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb375-1299"><a href="#cb375-1299" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb375-1300"><a href="#cb375-1300" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb375-1301"><a href="#cb375-1301" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb375-1302"><a href="#cb375-1302" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-1303"><a href="#cb375-1303" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb375-1304"><a href="#cb375-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1305"><a href="#cb375-1305" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-1306"><a href="#cb375-1306" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1307"><a href="#cb375-1307" aria-hidden="true" tabindex="-1"></a><span class="st">8 5</span></span>
<span id="cb375-1308"><a href="#cb375-1308" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span></span>
<span id="cb375-1309"><a href="#cb375-1309" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span></span>
<span id="cb375-1310"><a href="#cb375-1310" aria-hidden="true" tabindex="-1"></a><span class="st">TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span></span>
<span id="cb375-1311"><a href="#cb375-1311" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span></span>
<span id="cb375-1312"><a href="#cb375-1312" aria-hidden="true" tabindex="-1"></a><span class="st">AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span></span>
<span id="cb375-1313"><a href="#cb375-1313" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1314"><a href="#cb375-1314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1315"><a href="#cb375-1315" aria-hidden="true" tabindex="-1"></a>kmer_length, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb375-1316"><a href="#cb375-1316" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb375-1317"><a href="#cb375-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1318"><a href="#cb375-1318" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(randomized_motif_search, <span class="dv">1000</span>, dna_sequences, kmer_length)</span>
<span id="cb375-1319"><a href="#cb375-1319" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1320"><a href="#cb375-1320" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1321"><a href="#cb375-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1322"><a href="#cb375-1322" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GibbsSampler</span></span>
<span id="cb375-1323"><a href="#cb375-1323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1324"><a href="#cb375-1324" aria-hidden="true" tabindex="-1"></a>Implement,&nbsp;<span class="op">*</span>GibbsSampler<span class="op">*</span>.</span>
<span id="cb375-1325"><a href="#cb375-1325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1326"><a href="#cb375-1326" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>, and&nbsp;<span class="op">*</span>N<span class="op">*</span>, followed by a collection of strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb375-1327"><a href="#cb375-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1328"><a href="#cb375-1328" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The strings&nbsp;<span class="op">*</span>BestMotifs<span class="op">*</span>&nbsp;resulting <span class="im">from</span> running&nbsp;<span class="op">*</span>GibbsSampler<span class="op">*</span>(<span class="op">*</span>Dna<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>t<span class="op">*</span>,&nbsp;<span class="op">*</span>N<span class="op">*</span>) <span class="cf">with</span> <span class="dv">20</span> random starts. Remember to use pseudocounts<span class="op">!</span></span>
<span id="cb375-1329"><a href="#cb375-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1330"><a href="#cb375-1330" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1331"><a href="#cb375-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1332"><a href="#cb375-1332" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1333"><a href="#cb375-1333" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="dv">5</span> <span class="dv">100</span></span>
<span id="cb375-1334"><a href="#cb375-1334" aria-hidden="true" tabindex="-1"></a>CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span>
<span id="cb375-1335"><a href="#cb375-1335" aria-hidden="true" tabindex="-1"></a>GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span>
<span id="cb375-1336"><a href="#cb375-1336" aria-hidden="true" tabindex="-1"></a>TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span>
<span id="cb375-1337"><a href="#cb375-1337" aria-hidden="true" tabindex="-1"></a>TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span>
<span id="cb375-1338"><a href="#cb375-1338" aria-hidden="true" tabindex="-1"></a>AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span>
<span id="cb375-1339"><a href="#cb375-1339" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1340"><a href="#cb375-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1341"><a href="#cb375-1341" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1342"><a href="#cb375-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1343"><a href="#cb375-1343" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1344"><a href="#cb375-1344" aria-hidden="true" tabindex="-1"></a>TCTCGGGG</span>
<span id="cb375-1345"><a href="#cb375-1345" aria-hidden="true" tabindex="-1"></a>CCAAGGTG</span>
<span id="cb375-1346"><a href="#cb375-1346" aria-hidden="true" tabindex="-1"></a>TACAGGCG</span>
<span id="cb375-1347"><a href="#cb375-1347" aria-hidden="true" tabindex="-1"></a>TTCAGGTG</span>
<span id="cb375-1348"><a href="#cb375-1348" aria-hidden="true" tabindex="-1"></a>TCCACGTG</span>
<span id="cb375-1349"><a href="#cb375-1349" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1350"><a href="#cb375-1350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1351"><a href="#cb375-1351" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1352"><a href="#cb375-1352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1353"><a href="#cb375-1353" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1354"><a href="#cb375-1354" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, Tuple, Callable</span>
<span id="cb375-1355"><a href="#cb375-1355" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb375-1356"><a href="#cb375-1356" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb375-1357"><a href="#cb375-1357" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb375-1358"><a href="#cb375-1358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1359"><a href="#cb375-1359" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-1360"><a href="#cb375-1360" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-1361"><a href="#cb375-1361" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb375-1362"><a href="#cb375-1362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1363"><a href="#cb375-1363" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb375-1364"><a href="#cb375-1364" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb375-1365"><a href="#cb375-1365" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb375-1366"><a href="#cb375-1366" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb375-1367"><a href="#cb375-1367" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-1368"><a href="#cb375-1368" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb375-1369"><a href="#cb375-1369" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (motif_count <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>pseudocount)</span>
<span id="cb375-1370"><a href="#cb375-1370" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb375-1371"><a href="#cb375-1371" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb375-1372"><a href="#cb375-1372" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb375-1373"><a href="#cb375-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1374"><a href="#cb375-1374" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-1375"><a href="#cb375-1375" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb375-1376"><a href="#cb375-1376" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb375-1377"><a href="#cb375-1377" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb375-1378"><a href="#cb375-1378" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-1379"><a href="#cb375-1379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1380"><a href="#cb375-1380" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-1381"><a href="#cb375-1381" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb375-1382"><a href="#cb375-1382" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb375-1383"><a href="#cb375-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1384"><a href="#cb375-1384" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-1385"><a href="#cb375-1385" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb375-1386"><a href="#cb375-1386" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb375-1387"><a href="#cb375-1387" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb375-1388"><a href="#cb375-1388" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb375-1389"><a href="#cb375-1389" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb375-1390"><a href="#cb375-1390" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb375-1391"><a href="#cb375-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1392"><a href="#cb375-1392" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_probabilities(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb375-1393"><a href="#cb375-1393" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb375-1394"><a href="#cb375-1394" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb375-1395"><a href="#cb375-1395" aria-hidden="true" tabindex="-1"></a>        math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb375-1396"><a href="#cb375-1396" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length)</span>
<span id="cb375-1397"><a href="#cb375-1397" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb375-1398"><a href="#cb375-1398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1399"><a href="#cb375-1399" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-1400"><a href="#cb375-1400" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> calculate_kmer_probabilities(sequence, kmer_length, profile)</span>
<span id="cb375-1401"><a href="#cb375-1401" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.choices(<span class="bu">range</span>(<span class="bu">len</span>(probabilities)), probabilities)[<span class="dv">0</span>]</span>
<span id="cb375-1402"><a href="#cb375-1402" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb375-1403"><a href="#cb375-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1404"><a href="#cb375-1404" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gibbs_sampler(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, num_iterations: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-1405"><a href="#cb375-1405" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb375-1406"><a href="#cb375-1406" aria-hidden="true" tabindex="-1"></a>    best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb375-1407"><a href="#cb375-1407" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_iterations):</span>
<span id="cb375-1408"><a href="#cb375-1408" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(dna_sequences) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb375-1409"><a href="#cb375-1409" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs[:i] <span class="op">+</span> motifs[i <span class="op">+</span> <span class="dv">1</span> :], pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb375-1410"><a href="#cb375-1410" aria-hidden="true" tabindex="-1"></a>        motifs[i] <span class="op">=</span> select_random_kmer(dna_sequences[i], kmer_length, profile)</span>
<span id="cb375-1411"><a href="#cb375-1411" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb375-1412"><a href="#cb375-1412" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb375-1413"><a href="#cb375-1413" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> calculate_score(best_motifs), best_motifs</span>
<span id="cb375-1414"><a href="#cb375-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1415"><a href="#cb375-1415" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-1416"><a href="#cb375-1416" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1417"><a href="#cb375-1417" aria-hidden="true" tabindex="-1"></a><span class="st">8 5 100</span></span>
<span id="cb375-1418"><a href="#cb375-1418" aria-hidden="true" tabindex="-1"></a><span class="st">TCTCGGGG</span></span>
<span id="cb375-1419"><a href="#cb375-1419" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGGTG</span></span>
<span id="cb375-1420"><a href="#cb375-1420" aria-hidden="true" tabindex="-1"></a><span class="st">TACAGGCG</span></span>
<span id="cb375-1421"><a href="#cb375-1421" aria-hidden="true" tabindex="-1"></a><span class="st">TTCAGGTG</span></span>
<span id="cb375-1422"><a href="#cb375-1422" aria-hidden="true" tabindex="-1"></a><span class="st">TCCACGTG</span></span>
<span id="cb375-1423"><a href="#cb375-1423" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1424"><a href="#cb375-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1425"><a href="#cb375-1425" aria-hidden="true" tabindex="-1"></a>kmer_length, num_sequences, num_iterations, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb375-1426"><a href="#cb375-1426" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb375-1427"><a href="#cb375-1427" aria-hidden="true" tabindex="-1"></a>num_iterations <span class="op">=</span> <span class="bu">int</span>(num_iterations)</span>
<span id="cb375-1428"><a href="#cb375-1428" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(gibbs_sampler, <span class="dv">20</span>, dna_sequences, kmer_length, num_iterations)</span>
<span id="cb375-1429"><a href="#cb375-1429" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1430"><a href="#cb375-1430" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1431"><a href="#cb375-1431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1432"><a href="#cb375-1432" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement DistanceBetweenPatternAndStrings</span></span>
<span id="cb375-1433"><a href="#cb375-1433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1434"><a href="#cb375-1434" aria-hidden="true" tabindex="-1"></a>Compute DistanceBetweenPatternAndStrings. <span class="op">*</span>Find the distance between a pattern <span class="kw">and</span> a <span class="bu">set</span> of strings.<span class="op">*</span>.</span>
<span id="cb375-1435"><a href="#cb375-1435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1436"><a href="#cb375-1436" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>&nbsp;and a collection of DNA strings&nbsp;<span class="op">*</span>Dna<span class="op">*</span>.</span>
<span id="cb375-1437"><a href="#cb375-1437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1438"><a href="#cb375-1438" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>DistanceBetweenPatternAndStrings<span class="op">*</span>(<span class="op">*</span>Pattern<span class="op">*</span>,&nbsp;<span class="op">*</span>Dna<span class="op">*</span>).</span>
<span id="cb375-1439"><a href="#cb375-1439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1440"><a href="#cb375-1440" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1441"><a href="#cb375-1441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1442"><a href="#cb375-1442" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1443"><a href="#cb375-1443" aria-hidden="true" tabindex="-1"></a>AAA</span>
<span id="cb375-1444"><a href="#cb375-1444" aria-hidden="true" tabindex="-1"></a>TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span>
<span id="cb375-1445"><a href="#cb375-1445" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1446"><a href="#cb375-1446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1447"><a href="#cb375-1447" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1448"><a href="#cb375-1448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1449"><a href="#cb375-1449" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1450"><a href="#cb375-1450" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb375-1451"><a href="#cb375-1451" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1452"><a href="#cb375-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1453"><a href="#cb375-1453" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1454"><a href="#cb375-1454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1455"><a href="#cb375-1455" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1456"><a href="#cb375-1456" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator</span>
<span id="cb375-1457"><a href="#cb375-1457" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb375-1458"><a href="#cb375-1458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1459"><a href="#cb375-1459" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-1460"><a href="#cb375-1460" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-1461"><a href="#cb375-1461" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb375-1462"><a href="#cb375-1462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1463"><a href="#cb375-1463" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-1464"><a href="#cb375-1464" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb375-1465"><a href="#cb375-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1466"><a href="#cb375-1466" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-1467"><a href="#cb375-1467" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(kmer, pattern) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb375-1468"><a href="#cb375-1468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1469"><a href="#cb375-1469" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_pattern_distance_to_strings(pattern: <span class="bu">str</span>, dna_strings: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-1470"><a href="#cb375-1470" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, dna_string) <span class="cf">for</span> dna_string <span class="kw">in</span> dna_strings)</span>
<span id="cb375-1471"><a href="#cb375-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1472"><a href="#cb375-1472" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-1473"><a href="#cb375-1473" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1474"><a href="#cb375-1474" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb375-1475"><a href="#cb375-1475" aria-hidden="true" tabindex="-1"></a><span class="st">TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span></span>
<span id="cb375-1476"><a href="#cb375-1476" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1477"><a href="#cb375-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1478"><a href="#cb375-1478" aria-hidden="true" tabindex="-1"></a>pattern, dna_strings_raw <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1479"><a href="#cb375-1479" aria-hidden="true" tabindex="-1"></a>dna_strings <span class="op">=</span> dna_strings_raw.split()</span>
<span id="cb375-1480"><a href="#cb375-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1481"><a href="#cb375-1481" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_pattern_distance_to_strings(pattern, dna_strings)</span>
<span id="cb375-1482"><a href="#cb375-1482" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-1483"><a href="#cb375-1483" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1484"><a href="#cb375-1484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1485"><a href="#cb375-1485" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the k-mer Composition of a String</span></span>
<span id="cb375-1486"><a href="#cb375-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1487"><a href="#cb375-1487" aria-hidden="true" tabindex="-1"></a>String Composition Problem, Generate the k<span class="op">-</span>mer composition of a string.</span>
<span id="cb375-1488"><a href="#cb375-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1489"><a href="#cb375-1489" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and a string&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb375-1490"><a href="#cb375-1490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1491"><a href="#cb375-1491" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>Composition__k<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>) (the&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers can be provided <span class="kw">in</span> <span class="bu">any</span> order).</span>
<span id="cb375-1492"><a href="#cb375-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1493"><a href="#cb375-1493" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1494"><a href="#cb375-1494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1495"><a href="#cb375-1495" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1496"><a href="#cb375-1496" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb375-1497"><a href="#cb375-1497" aria-hidden="true" tabindex="-1"></a>CAATCCAAC</span>
<span id="cb375-1498"><a href="#cb375-1498" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1499"><a href="#cb375-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1500"><a href="#cb375-1500" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1501"><a href="#cb375-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1502"><a href="#cb375-1502" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1503"><a href="#cb375-1503" aria-hidden="true" tabindex="-1"></a>CAATC</span>
<span id="cb375-1504"><a href="#cb375-1504" aria-hidden="true" tabindex="-1"></a>AATCC</span>
<span id="cb375-1505"><a href="#cb375-1505" aria-hidden="true" tabindex="-1"></a>ATCCA</span>
<span id="cb375-1506"><a href="#cb375-1506" aria-hidden="true" tabindex="-1"></a>TCCAA</span>
<span id="cb375-1507"><a href="#cb375-1507" aria-hidden="true" tabindex="-1"></a>CCAAC</span>
<span id="cb375-1508"><a href="#cb375-1508" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1509"><a href="#cb375-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1510"><a href="#cb375-1510" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1511"><a href="#cb375-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1512"><a href="#cb375-1512" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1513"><a href="#cb375-1513" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator</span>
<span id="cb375-1514"><a href="#cb375-1514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1515"><a href="#cb375-1515" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-1516"><a href="#cb375-1516" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-1517"><a href="#cb375-1517" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i:i <span class="op">+</span> kmer_length]</span>
<span id="cb375-1518"><a href="#cb375-1518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1519"><a href="#cb375-1519" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1520"><a href="#cb375-1520" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb375-1521"><a href="#cb375-1521" aria-hidden="true" tabindex="-1"></a><span class="st">CAATCCAAC</span></span>
<span id="cb375-1522"><a href="#cb375-1522" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1523"><a href="#cb375-1523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1524"><a href="#cb375-1524" aria-hidden="true" tabindex="-1"></a>input_lines: <span class="bu">list</span>[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1525"><a href="#cb375-1525" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb375-1526"><a href="#cb375-1526" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb375-1527"><a href="#cb375-1527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1528"><a href="#cb375-1528" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequence, kmer_length):</span>
<span id="cb375-1529"><a href="#cb375-1529" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kmer)</span>
<span id="cb375-1530"><a href="#cb375-1530" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1531"><a href="#cb375-1531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1532"><a href="#cb375-1532" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its Genome Path</span></span>
<span id="cb375-1533"><a href="#cb375-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1534"><a href="#cb375-1534" aria-hidden="true" tabindex="-1"></a>String Spelled by a Genome Path Problem, Find the string spelled by a genome path.</span>
<span id="cb375-1535"><a href="#cb375-1535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1536"><a href="#cb375-1536" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>Pattern1,..., Patternn<span class="op">*</span>&nbsp;such that the last&nbsp;<span class="op">*</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>&nbsp;symbols of&nbsp;<span class="op">*</span>Patterni<span class="op">*</span>&nbsp;are equal to the first&nbsp;<span class="op">*</span>k <span class="op">-</span> <span class="dv">1</span><span class="op">*</span>&nbsp;symbols of&nbsp;<span class="op">*</span>Patterni<span class="op">+</span><span class="dv">1</span><span class="op">*</span>&nbsp;for&nbsp;<span class="op">*</span>i<span class="op">*</span>&nbsp;from <span class="dv">1</span> to n<span class="op">-</span><span class="fl">1.</span></span>
<span id="cb375-1537"><a href="#cb375-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1538"><a href="#cb375-1538" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;of length&nbsp;<span class="op">*</span>k<span class="op">+</span>n<span class="op">-</span><span class="dv">1</span><span class="op">*</span>&nbsp;where the&nbsp;<span class="op">*</span>i<span class="op">*-</span>th&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer in&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;is equal to&nbsp;<span class="op">*</span>Patterni<span class="op">*</span>&nbsp;for all&nbsp;<span class="op">*</span>i<span class="op">*</span>.</span>
<span id="cb375-1539"><a href="#cb375-1539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1540"><a href="#cb375-1540" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1541"><a href="#cb375-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1542"><a href="#cb375-1542" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1543"><a href="#cb375-1543" aria-hidden="true" tabindex="-1"></a>ACCGA</span>
<span id="cb375-1544"><a href="#cb375-1544" aria-hidden="true" tabindex="-1"></a>CCGAA</span>
<span id="cb375-1545"><a href="#cb375-1545" aria-hidden="true" tabindex="-1"></a>CGAAG</span>
<span id="cb375-1546"><a href="#cb375-1546" aria-hidden="true" tabindex="-1"></a>GAAGC</span>
<span id="cb375-1547"><a href="#cb375-1547" aria-hidden="true" tabindex="-1"></a>AAGCT</span>
<span id="cb375-1548"><a href="#cb375-1548" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1549"><a href="#cb375-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1550"><a href="#cb375-1550" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1551"><a href="#cb375-1551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1552"><a href="#cb375-1552" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1553"><a href="#cb375-1553" aria-hidden="true" tabindex="-1"></a>ACCGAAGCT</span>
<span id="cb375-1554"><a href="#cb375-1554" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1555"><a href="#cb375-1555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1556"><a href="#cb375-1556" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1557"><a href="#cb375-1557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1558"><a href="#cb375-1558" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1559"><a href="#cb375-1559" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb375-1560"><a href="#cb375-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1561"><a href="#cb375-1561" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_dna_sequence(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-1562"><a href="#cb375-1562" aria-hidden="true" tabindex="-1"></a>    reconstructed_sequence: <span class="bu">str</span> <span class="op">=</span> kmers[<span class="dv">0</span>]</span>
<span id="cb375-1563"><a href="#cb375-1563" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(kmers)):</span>
<span id="cb375-1564"><a href="#cb375-1564" aria-hidden="true" tabindex="-1"></a>        reconstructed_sequence <span class="op">+=</span> kmers[i][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-1565"><a href="#cb375-1565" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_sequence</span>
<span id="cb375-1566"><a href="#cb375-1566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1567"><a href="#cb375-1567" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1568"><a href="#cb375-1568" aria-hidden="true" tabindex="-1"></a><span class="st">ACCGA</span></span>
<span id="cb375-1569"><a href="#cb375-1569" aria-hidden="true" tabindex="-1"></a><span class="st">CCGAA</span></span>
<span id="cb375-1570"><a href="#cb375-1570" aria-hidden="true" tabindex="-1"></a><span class="st">CGAAG</span></span>
<span id="cb375-1571"><a href="#cb375-1571" aria-hidden="true" tabindex="-1"></a><span class="st">GAAGC</span></span>
<span id="cb375-1572"><a href="#cb375-1572" aria-hidden="true" tabindex="-1"></a><span class="st">AAGCT</span></span>
<span id="cb375-1573"><a href="#cb375-1573" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1574"><a href="#cb375-1574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1575"><a href="#cb375-1575" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1576"><a href="#cb375-1576" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_dna_sequence(kmer_list))</span>
<span id="cb375-1577"><a href="#cb375-1577" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1578"><a href="#cb375-1578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1579"><a href="#cb375-1579" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Overlap Graph of a Collection of k-mers</span></span>
<span id="cb375-1580"><a href="#cb375-1580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1581"><a href="#cb375-1581" aria-hidden="true" tabindex="-1"></a>Overlap Graph Problem, Construct the overlap graph of a collection of k<span class="op">-</span>mers.</span>
<span id="cb375-1582"><a href="#cb375-1582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1583"><a href="#cb375-1583" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>&nbsp;of&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers.</span>
<span id="cb375-1584"><a href="#cb375-1584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1585"><a href="#cb375-1585" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The overlap graph&nbsp;<span class="op">*</span>Overlap<span class="op">*</span>(<span class="op">*</span>Patterns<span class="op">*</span>), <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb375-1586"><a href="#cb375-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1587"><a href="#cb375-1587" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1588"><a href="#cb375-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1589"><a href="#cb375-1589" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1590"><a href="#cb375-1590" aria-hidden="true" tabindex="-1"></a>ATGCG</span>
<span id="cb375-1591"><a href="#cb375-1591" aria-hidden="true" tabindex="-1"></a>GCATG</span>
<span id="cb375-1592"><a href="#cb375-1592" aria-hidden="true" tabindex="-1"></a>CATGC</span>
<span id="cb375-1593"><a href="#cb375-1593" aria-hidden="true" tabindex="-1"></a>AGGCA</span>
<span id="cb375-1594"><a href="#cb375-1594" aria-hidden="true" tabindex="-1"></a>GGCAT</span>
<span id="cb375-1595"><a href="#cb375-1595" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1596"><a href="#cb375-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1597"><a href="#cb375-1597" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1598"><a href="#cb375-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1599"><a href="#cb375-1599" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1600"><a href="#cb375-1600" aria-hidden="true" tabindex="-1"></a>GCATG <span class="op">-&gt;</span> CATGC</span>
<span id="cb375-1601"><a href="#cb375-1601" aria-hidden="true" tabindex="-1"></a>CATGC <span class="op">-&gt;</span> ATGCG</span>
<span id="cb375-1602"><a href="#cb375-1602" aria-hidden="true" tabindex="-1"></a>AGGCA <span class="op">-&gt;</span> GGCAT</span>
<span id="cb375-1603"><a href="#cb375-1603" aria-hidden="true" tabindex="-1"></a>GGCAT <span class="op">-&gt;</span> GCATG</span>
<span id="cb375-1604"><a href="#cb375-1604" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1605"><a href="#cb375-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1606"><a href="#cb375-1606" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1607"><a href="#cb375-1607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1608"><a href="#cb375-1608" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1609"><a href="#cb375-1609" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb375-1610"><a href="#cb375-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1611"><a href="#cb375-1611" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> overlap_graph(patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>]]:</span>
<span id="cb375-1612"><a href="#cb375-1612" aria-hidden="true" tabindex="-1"></a>    adj_list <span class="op">=</span> []</span>
<span id="cb375-1613"><a href="#cb375-1613" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb375-1614"><a href="#cb375-1614" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb375-1615"><a href="#cb375-1615" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j <span class="kw">and</span> patterns[i][<span class="dv">1</span>:] <span class="op">==</span> patterns[j][:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb375-1616"><a href="#cb375-1616" aria-hidden="true" tabindex="-1"></a>                adj_list.append((patterns[i], patterns[j]))</span>
<span id="cb375-1617"><a href="#cb375-1617" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adj_list</span>
<span id="cb375-1618"><a href="#cb375-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1619"><a href="#cb375-1619" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1620"><a href="#cb375-1620" aria-hidden="true" tabindex="-1"></a><span class="st">ATGCG</span></span>
<span id="cb375-1621"><a href="#cb375-1621" aria-hidden="true" tabindex="-1"></a><span class="st">GCATG</span></span>
<span id="cb375-1622"><a href="#cb375-1622" aria-hidden="true" tabindex="-1"></a><span class="st">CATGC</span></span>
<span id="cb375-1623"><a href="#cb375-1623" aria-hidden="true" tabindex="-1"></a><span class="st">AGGCA</span></span>
<span id="cb375-1624"><a href="#cb375-1624" aria-hidden="true" tabindex="-1"></a><span class="st">GGCAT</span></span>
<span id="cb375-1625"><a href="#cb375-1625" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1626"><a href="#cb375-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1627"><a href="#cb375-1627" aria-hidden="true" tabindex="-1"></a>Patterns: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1628"><a href="#cb375-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1629"><a href="#cb375-1629" aria-hidden="true" tabindex="-1"></a>adj_list <span class="op">=</span> overlap_graph(Patterns)</span>
<span id="cb375-1630"><a href="#cb375-1630" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> adj_list:</span>
<span id="cb375-1631"><a href="#cb375-1631" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>edge[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>edge[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-1632"><a href="#cb375-1632" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1633"><a href="#cb375-1633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1634"><a href="#cb375-1634" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the De Bruijn Graph of a String</span></span>
<span id="cb375-1635"><a href="#cb375-1635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1636"><a href="#cb375-1636" aria-hidden="true" tabindex="-1"></a>De Bruijn Graph <span class="im">from</span> a String Problem. Construct the de Bruijn graph of a string.</span>
<span id="cb375-1637"><a href="#cb375-1637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1638"><a href="#cb375-1638" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and a string&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb375-1639"><a href="#cb375-1639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1640"><a href="#cb375-1640" aria-hidden="true" tabindex="-1"></a>Return:<span class="op">*</span>DeBruijn__k<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>), <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb375-1641"><a href="#cb375-1641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1642"><a href="#cb375-1642" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1643"><a href="#cb375-1643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1644"><a href="#cb375-1644" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1645"><a href="#cb375-1645" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-1646"><a href="#cb375-1646" aria-hidden="true" tabindex="-1"></a>AAGATTCTCTAC</span>
<span id="cb375-1647"><a href="#cb375-1647" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1648"><a href="#cb375-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1649"><a href="#cb375-1649" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1650"><a href="#cb375-1650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1651"><a href="#cb375-1651" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1652"><a href="#cb375-1652" aria-hidden="true" tabindex="-1"></a>AAG <span class="op">-&gt;</span> AGA</span>
<span id="cb375-1653"><a href="#cb375-1653" aria-hidden="true" tabindex="-1"></a>AGA <span class="op">-&gt;</span> GAT</span>
<span id="cb375-1654"><a href="#cb375-1654" aria-hidden="true" tabindex="-1"></a>ATT <span class="op">-&gt;</span> TTC</span>
<span id="cb375-1655"><a href="#cb375-1655" aria-hidden="true" tabindex="-1"></a>CTA <span class="op">-&gt;</span> TAC</span>
<span id="cb375-1656"><a href="#cb375-1656" aria-hidden="true" tabindex="-1"></a>CTC <span class="op">-&gt;</span> TCT</span>
<span id="cb375-1657"><a href="#cb375-1657" aria-hidden="true" tabindex="-1"></a>GAT <span class="op">-&gt;</span> ATT</span>
<span id="cb375-1658"><a href="#cb375-1658" aria-hidden="true" tabindex="-1"></a>TCT <span class="op">-&gt;</span> CTA,CTC</span>
<span id="cb375-1659"><a href="#cb375-1659" aria-hidden="true" tabindex="-1"></a>TTC <span class="op">-&gt;</span> TCT</span>
<span id="cb375-1660"><a href="#cb375-1660" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1661"><a href="#cb375-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1662"><a href="#cb375-1662" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1663"><a href="#cb375-1663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1664"><a href="#cb375-1664" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1665"><a href="#cb375-1665" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict</span>
<span id="cb375-1666"><a href="#cb375-1666" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, OrderedDict <span class="im">as</span> OrderedDictType</span>
<span id="cb375-1667"><a href="#cb375-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1668"><a href="#cb375-1668" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]]:</span>
<span id="cb375-1669"><a href="#cb375-1669" aria-hidden="true" tabindex="-1"></a>    adjacency_list: OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]] <span class="op">=</span> OrderedDict()</span>
<span id="cb375-1670"><a href="#cb375-1670" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-1671"><a href="#cb375-1671" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">2</span>):</span>
<span id="cb375-1672"><a href="#cb375-1672" aria-hidden="true" tabindex="-1"></a>        adjacency_list[sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-1673"><a href="#cb375-1673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1674"><a href="#cb375-1674" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-1675"><a href="#cb375-1675" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-1676"><a href="#cb375-1676" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:i <span class="op">+</span> kmer_length]</span>
<span id="cb375-1677"><a href="#cb375-1677" aria-hidden="true" tabindex="-1"></a>        adjacency_list[prefix].add(suffix)</span>
<span id="cb375-1678"><a href="#cb375-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1679"><a href="#cb375-1679" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb375-1680"><a href="#cb375-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1681"><a href="#cb375-1681" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1682"><a href="#cb375-1682" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-1683"><a href="#cb375-1683" aria-hidden="true" tabindex="-1"></a><span class="st">AAGATTCTCTAC</span></span>
<span id="cb375-1684"><a href="#cb375-1684" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1685"><a href="#cb375-1685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1686"><a href="#cb375-1686" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1687"><a href="#cb375-1687" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb375-1688"><a href="#cb375-1688" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb375-1689"><a href="#cb375-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1690"><a href="#cb375-1690" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(dna_sequence, kmer_length)</span>
<span id="cb375-1691"><a href="#cb375-1691" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb375-1692"><a href="#cb375-1692" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> neighbors:</span>
<span id="cb375-1693"><a href="#cb375-1693" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-1694"><a href="#cb375-1694" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1695"><a href="#cb375-1695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1696"><a href="#cb375-1696" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the De Bruijn Graph of a Collection of k-mers</span></span>
<span id="cb375-1697"><a href="#cb375-1697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1698"><a href="#cb375-1698" aria-hidden="true" tabindex="-1"></a>De Bruijn Graph from&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers Problem. Construct the de Bruijn graph <span class="im">from</span> a collection of k<span class="op">-</span>mers.</span>
<span id="cb375-1699"><a href="#cb375-1699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1700"><a href="#cb375-1700" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb375-1701"><a href="#cb375-1701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1702"><a href="#cb375-1702" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The de Bruijn graph&nbsp;<span class="op">*</span>DeBruijn<span class="op">*</span>(<span class="op">*</span>Patterns<span class="op">*</span>), <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb375-1703"><a href="#cb375-1703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1704"><a href="#cb375-1704" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1705"><a href="#cb375-1705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1706"><a href="#cb375-1706" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1707"><a href="#cb375-1707" aria-hidden="true" tabindex="-1"></a>GAGG</span>
<span id="cb375-1708"><a href="#cb375-1708" aria-hidden="true" tabindex="-1"></a>CAGG</span>
<span id="cb375-1709"><a href="#cb375-1709" aria-hidden="true" tabindex="-1"></a>GGGG</span>
<span id="cb375-1710"><a href="#cb375-1710" aria-hidden="true" tabindex="-1"></a>GGGA</span>
<span id="cb375-1711"><a href="#cb375-1711" aria-hidden="true" tabindex="-1"></a>CAGG</span>
<span id="cb375-1712"><a href="#cb375-1712" aria-hidden="true" tabindex="-1"></a>AGGG</span>
<span id="cb375-1713"><a href="#cb375-1713" aria-hidden="true" tabindex="-1"></a>GGAG</span>
<span id="cb375-1714"><a href="#cb375-1714" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1715"><a href="#cb375-1715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1716"><a href="#cb375-1716" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1717"><a href="#cb375-1717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1718"><a href="#cb375-1718" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1719"><a href="#cb375-1719" aria-hidden="true" tabindex="-1"></a>GAG <span class="op">-&gt;</span> AGG</span>
<span id="cb375-1720"><a href="#cb375-1720" aria-hidden="true" tabindex="-1"></a>CAG <span class="op">-&gt;</span> AGG,AGG</span>
<span id="cb375-1721"><a href="#cb375-1721" aria-hidden="true" tabindex="-1"></a>GGG <span class="op">-&gt;</span> GGG,GGA</span>
<span id="cb375-1722"><a href="#cb375-1722" aria-hidden="true" tabindex="-1"></a>AGG <span class="op">-&gt;</span> GGG</span>
<span id="cb375-1723"><a href="#cb375-1723" aria-hidden="true" tabindex="-1"></a>GGA <span class="op">-&gt;</span> GAG</span>
<span id="cb375-1724"><a href="#cb375-1724" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1725"><a href="#cb375-1725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1726"><a href="#cb375-1726" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1727"><a href="#cb375-1727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1728"><a href="#cb375-1728" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1729"><a href="#cb375-1729" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb375-1730"><a href="#cb375-1730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1731"><a href="#cb375-1731" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-1732"><a href="#cb375-1732" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb375-1733"><a href="#cb375-1733" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb375-1734"><a href="#cb375-1734" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-1735"><a href="#cb375-1735" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb375-1736"><a href="#cb375-1736" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_list:</span>
<span id="cb375-1737"><a href="#cb375-1737" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb375-1738"><a href="#cb375-1738" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-1739"><a href="#cb375-1739" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix].append(suffix)</span>
<span id="cb375-1740"><a href="#cb375-1740" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb375-1741"><a href="#cb375-1741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1742"><a href="#cb375-1742" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1743"><a href="#cb375-1743" aria-hidden="true" tabindex="-1"></a><span class="st">GAGG</span></span>
<span id="cb375-1744"><a href="#cb375-1744" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb375-1745"><a href="#cb375-1745" aria-hidden="true" tabindex="-1"></a><span class="st">GGGG</span></span>
<span id="cb375-1746"><a href="#cb375-1746" aria-hidden="true" tabindex="-1"></a><span class="st">GGGA</span></span>
<span id="cb375-1747"><a href="#cb375-1747" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb375-1748"><a href="#cb375-1748" aria-hidden="true" tabindex="-1"></a><span class="st">AGGG</span></span>
<span id="cb375-1749"><a href="#cb375-1749" aria-hidden="true" tabindex="-1"></a><span class="st">GGAG</span></span>
<span id="cb375-1750"><a href="#cb375-1750" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1751"><a href="#cb375-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1752"><a href="#cb375-1752" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1753"><a href="#cb375-1753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1754"><a href="#cb375-1754" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmer_list)</span>
<span id="cb375-1755"><a href="#cb375-1755" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb375-1756"><a href="#cb375-1756" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-1757"><a href="#cb375-1757" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1758"><a href="#cb375-1758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1759"><a href="#cb375-1759" aria-hidden="true" tabindex="-1"></a><span class="co"># Find an Eulerian Cycle in a Graph</span></span>
<span id="cb375-1760"><a href="#cb375-1760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1761"><a href="#cb375-1761" aria-hidden="true" tabindex="-1"></a>Eulerian Cycle Problem, Find an Eulerian cycle <span class="kw">in</span> a graph.</span>
<span id="cb375-1762"><a href="#cb375-1762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1763"><a href="#cb375-1763" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An Eulerian directed graph, <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb375-1764"><a href="#cb375-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1765"><a href="#cb375-1765" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An&nbsp;[Eulerian cycle](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>eulerian<span class="op">-</span>cycle<span class="op">/</span>)&nbsp;in this graph.</span>
<span id="cb375-1766"><a href="#cb375-1766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1767"><a href="#cb375-1767" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1768"><a href="#cb375-1768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1769"><a href="#cb375-1769" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1770"><a href="#cb375-1770" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb375-1771"><a href="#cb375-1771" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">0</span></span>
<span id="cb375-1772"><a href="#cb375-1772" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">1</span>,<span class="dv">6</span></span>
<span id="cb375-1773"><a href="#cb375-1773" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb375-1774"><a href="#cb375-1774" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb375-1775"><a href="#cb375-1775" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="op">-&gt;</span> <span class="dv">4</span></span>
<span id="cb375-1776"><a href="#cb375-1776" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">5</span>,<span class="dv">8</span></span>
<span id="cb375-1777"><a href="#cb375-1777" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">9</span></span>
<span id="cb375-1778"><a href="#cb375-1778" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="op">-&gt;</span> <span class="dv">7</span></span>
<span id="cb375-1779"><a href="#cb375-1779" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb375-1780"><a href="#cb375-1780" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1781"><a href="#cb375-1781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1782"><a href="#cb375-1782" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1783"><a href="#cb375-1783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1784"><a href="#cb375-1784" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1785"><a href="#cb375-1785" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">8</span><span class="op">-&gt;</span><span class="dv">7</span><span class="op">-&gt;</span><span class="dv">9</span><span class="op">-&gt;</span><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">6</span></span>
<span id="cb375-1786"><a href="#cb375-1786" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1787"><a href="#cb375-1787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1788"><a href="#cb375-1788" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1789"><a href="#cb375-1789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1790"><a href="#cb375-1790" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1791"><a href="#cb375-1791" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb375-1792"><a href="#cb375-1792" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb375-1793"><a href="#cb375-1793" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb375-1794"><a href="#cb375-1794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1795"><a href="#cb375-1795" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_list_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-1796"><a href="#cb375-1796" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb375-1797"><a href="#cb375-1797" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> element <span class="kw">in</span> adjacency_list_text:</span>
<span id="cb375-1798"><a href="#cb375-1798" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, element)</span>
<span id="cb375-1799"><a href="#cb375-1799" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb375-1800"><a href="#cb375-1800" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb375-1801"><a href="#cb375-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1802"><a href="#cb375-1802" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-1803"><a href="#cb375-1803" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb375-1804"><a href="#cb375-1804" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb375-1805"><a href="#cb375-1805" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb375-1806"><a href="#cb375-1806" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-1807"><a href="#cb375-1807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1808"><a href="#cb375-1808" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-1809"><a href="#cb375-1809" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Form a cycle by randomly walking in the graph</span></span>
<span id="cb375-1810"><a href="#cb375-1810" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb375-1811"><a href="#cb375-1811" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-1812"><a href="#cb375-1812" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb375-1813"><a href="#cb375-1813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1814"><a href="#cb375-1814" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb375-1815"><a href="#cb375-1815" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb375-1816"><a href="#cb375-1816" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb375-1817"><a href="#cb375-1817" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-1818"><a href="#cb375-1818" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-1819"><a href="#cb375-1819" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-1820"><a href="#cb375-1820" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-1821"><a href="#cb375-1821" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb375-1822"><a href="#cb375-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1823"><a href="#cb375-1823" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-1824"><a href="#cb375-1824" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb375-1825"><a href="#cb375-1825" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb375-1826"><a href="#cb375-1826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1827"><a href="#cb375-1827" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Form new_cycle by traversing cycle (starting at new_start) and then randomly walking</span></span>
<span id="cb375-1828"><a href="#cb375-1828" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-1829"><a href="#cb375-1829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1830"><a href="#cb375-1830" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb375-1831"><a href="#cb375-1831" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb375-1832"><a href="#cb375-1832" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-1833"><a href="#cb375-1833" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb375-1834"><a href="#cb375-1834" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb375-1835"><a href="#cb375-1835" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-1836"><a href="#cb375-1836" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-1837"><a href="#cb375-1837" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-1838"><a href="#cb375-1838" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb375-1839"><a href="#cb375-1839" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb375-1840"><a href="#cb375-1840" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb375-1841"><a href="#cb375-1841" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb375-1842"><a href="#cb375-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1843"><a href="#cb375-1843" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1844"><a href="#cb375-1844" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 3</span></span>
<span id="cb375-1845"><a href="#cb375-1845" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 0</span></span>
<span id="cb375-1846"><a href="#cb375-1846" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1,6</span></span>
<span id="cb375-1847"><a href="#cb375-1847" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 2</span></span>
<span id="cb375-1848"><a href="#cb375-1848" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb375-1849"><a href="#cb375-1849" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 4</span></span>
<span id="cb375-1850"><a href="#cb375-1850" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 5,8</span></span>
<span id="cb375-1851"><a href="#cb375-1851" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 9</span></span>
<span id="cb375-1852"><a href="#cb375-1852" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 7</span></span>
<span id="cb375-1853"><a href="#cb375-1853" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb375-1854"><a href="#cb375-1854" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1855"><a href="#cb375-1855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1856"><a href="#cb375-1856" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1857"><a href="#cb375-1857" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb375-1858"><a href="#cb375-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1859"><a href="#cb375-1859" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_cycle(adjacency_list)))</span>
<span id="cb375-1860"><a href="#cb375-1860" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1861"><a href="#cb375-1861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1862"><a href="#cb375-1862" aria-hidden="true" tabindex="-1"></a><span class="co"># Find an Eulerian Path in a Graph</span></span>
<span id="cb375-1863"><a href="#cb375-1863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1864"><a href="#cb375-1864" aria-hidden="true" tabindex="-1"></a>Eulerian Path Problem, Find an Eulerian path <span class="kw">in</span> a graph.</span>
<span id="cb375-1865"><a href="#cb375-1865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1866"><a href="#cb375-1866" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[directed graph](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>directed<span class="op">-</span>graph<span class="op">/</span>)&nbsp;that contains an Eulerian path, where the graph <span class="kw">is</span> given <span class="kw">in</span> the form of an&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>).</span>
<span id="cb375-1867"><a href="#cb375-1867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1868"><a href="#cb375-1868" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An Eulerian path <span class="kw">in</span> this graph.</span>
<span id="cb375-1869"><a href="#cb375-1869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1870"><a href="#cb375-1870" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1871"><a href="#cb375-1871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1872"><a href="#cb375-1872" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1873"><a href="#cb375-1873" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb375-1874"><a href="#cb375-1874" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb375-1875"><a href="#cb375-1875" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">1</span></span>
<span id="cb375-1876"><a href="#cb375-1876" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">0</span>,<span class="dv">4</span></span>
<span id="cb375-1877"><a href="#cb375-1877" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">3</span>,<span class="dv">7</span></span>
<span id="cb375-1878"><a href="#cb375-1878" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">8</span></span>
<span id="cb375-1879"><a href="#cb375-1879" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span> <span class="op">-&gt;</span> <span class="dv">9</span></span>
<span id="cb375-1880"><a href="#cb375-1880" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb375-1881"><a href="#cb375-1881" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1882"><a href="#cb375-1882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1883"><a href="#cb375-1883" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-1884"><a href="#cb375-1884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1885"><a href="#cb375-1885" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1886"><a href="#cb375-1886" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">7</span><span class="op">-&gt;</span><span class="dv">8</span><span class="op">-&gt;</span><span class="dv">9</span><span class="op">-&gt;</span><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb375-1887"><a href="#cb375-1887" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1888"><a href="#cb375-1888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1889"><a href="#cb375-1889" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-1890"><a href="#cb375-1890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1891"><a href="#cb375-1891" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-1892"><a href="#cb375-1892" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb375-1893"><a href="#cb375-1893" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb375-1894"><a href="#cb375-1894" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb375-1895"><a href="#cb375-1895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1896"><a href="#cb375-1896" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-1897"><a href="#cb375-1897" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb375-1898"><a href="#cb375-1898" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb375-1899"><a href="#cb375-1899" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb375-1900"><a href="#cb375-1900" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb375-1901"><a href="#cb375-1901" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb375-1902"><a href="#cb375-1902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1903"><a href="#cb375-1903" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-1904"><a href="#cb375-1904" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb375-1905"><a href="#cb375-1905" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb375-1906"><a href="#cb375-1906" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb375-1907"><a href="#cb375-1907" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-1908"><a href="#cb375-1908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1909"><a href="#cb375-1909" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-1910"><a href="#cb375-1910" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb375-1911"><a href="#cb375-1911" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-1912"><a href="#cb375-1912" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb375-1913"><a href="#cb375-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1914"><a href="#cb375-1914" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb375-1915"><a href="#cb375-1915" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb375-1916"><a href="#cb375-1916" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb375-1917"><a href="#cb375-1917" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-1918"><a href="#cb375-1918" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-1919"><a href="#cb375-1919" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-1920"><a href="#cb375-1920" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-1921"><a href="#cb375-1921" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb375-1922"><a href="#cb375-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1923"><a href="#cb375-1923" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-1924"><a href="#cb375-1924" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb375-1925"><a href="#cb375-1925" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb375-1926"><a href="#cb375-1926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1927"><a href="#cb375-1927" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-1928"><a href="#cb375-1928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1929"><a href="#cb375-1929" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb375-1930"><a href="#cb375-1930" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb375-1931"><a href="#cb375-1931" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-1932"><a href="#cb375-1932" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb375-1933"><a href="#cb375-1933" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb375-1934"><a href="#cb375-1934" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-1935"><a href="#cb375-1935" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-1936"><a href="#cb375-1936" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-1937"><a href="#cb375-1937" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb375-1938"><a href="#cb375-1938" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb375-1939"><a href="#cb375-1939" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb375-1940"><a href="#cb375-1940" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb375-1941"><a href="#cb375-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1942"><a href="#cb375-1942" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-1943"><a href="#cb375-1943" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-1944"><a href="#cb375-1944" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb375-1945"><a href="#cb375-1945" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb375-1946"><a href="#cb375-1946" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb375-1947"><a href="#cb375-1947" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-1948"><a href="#cb375-1948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1949"><a href="#cb375-1949" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-1950"><a href="#cb375-1950" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-1951"><a href="#cb375-1951" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-1952"><a href="#cb375-1952" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb375-1953"><a href="#cb375-1953" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb375-1954"><a href="#cb375-1954" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-1955"><a href="#cb375-1955" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb375-1956"><a href="#cb375-1956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1957"><a href="#cb375-1957" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb375-1958"><a href="#cb375-1958" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb375-1959"><a href="#cb375-1959" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb375-1960"><a href="#cb375-1960" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-1961"><a href="#cb375-1961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1962"><a href="#cb375-1962" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb375-1963"><a href="#cb375-1963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1964"><a href="#cb375-1964" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-1965"><a href="#cb375-1965" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 2</span></span>
<span id="cb375-1966"><a href="#cb375-1966" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 3</span></span>
<span id="cb375-1967"><a href="#cb375-1967" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1</span></span>
<span id="cb375-1968"><a href="#cb375-1968" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 0,4</span></span>
<span id="cb375-1969"><a href="#cb375-1969" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 3,7</span></span>
<span id="cb375-1970"><a href="#cb375-1970" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 8</span></span>
<span id="cb375-1971"><a href="#cb375-1971" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 9</span></span>
<span id="cb375-1972"><a href="#cb375-1972" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb375-1973"><a href="#cb375-1973" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-1974"><a href="#cb375-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1975"><a href="#cb375-1975" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-1976"><a href="#cb375-1976" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb375-1977"><a href="#cb375-1977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1978"><a href="#cb375-1978" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_path(adjacency_list)))</span>
<span id="cb375-1979"><a href="#cb375-1979" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1980"><a href="#cb375-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1981"><a href="#cb375-1981" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its k-mer Composition</span></span>
<span id="cb375-1982"><a href="#cb375-1982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1983"><a href="#cb375-1983" aria-hidden="true" tabindex="-1"></a>String Reconstruction Problem. Reconstruct a string <span class="im">from</span> its k<span class="op">-</span>mer composition.</span>
<span id="cb375-1984"><a href="#cb375-1984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1985"><a href="#cb375-1985" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;followed by a <span class="bu">list</span> of&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb375-1986"><a href="#cb375-1986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1987"><a href="#cb375-1987" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;with&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer composition equal to&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-1988"><a href="#cb375-1988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1989"><a href="#cb375-1989" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-1990"><a href="#cb375-1990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-1991"><a href="#cb375-1991" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-1992"><a href="#cb375-1992" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-1993"><a href="#cb375-1993" aria-hidden="true" tabindex="-1"></a>CTTA</span>
<span id="cb375-1994"><a href="#cb375-1994" aria-hidden="true" tabindex="-1"></a>ACCA</span>
<span id="cb375-1995"><a href="#cb375-1995" aria-hidden="true" tabindex="-1"></a>TACC</span>
<span id="cb375-1996"><a href="#cb375-1996" aria-hidden="true" tabindex="-1"></a>GGCT</span>
<span id="cb375-1997"><a href="#cb375-1997" aria-hidden="true" tabindex="-1"></a>GCTT</span>
<span id="cb375-1998"><a href="#cb375-1998" aria-hidden="true" tabindex="-1"></a>TTAC</span>
<span id="cb375-1999"><a href="#cb375-1999" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2000"><a href="#cb375-2000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2001"><a href="#cb375-2001" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2002"><a href="#cb375-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2003"><a href="#cb375-2003" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2004"><a href="#cb375-2004" aria-hidden="true" tabindex="-1"></a>GGCTTACCA</span>
<span id="cb375-2005"><a href="#cb375-2005" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2006"><a href="#cb375-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2007"><a href="#cb375-2007" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2008"><a href="#cb375-2008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2009"><a href="#cb375-2009" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2010"><a href="#cb375-2010" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-2011"><a href="#cb375-2011" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb375-2012"><a href="#cb375-2012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2013"><a href="#cb375-2013" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-2014"><a href="#cb375-2014" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb375-2015"><a href="#cb375-2015" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb375-2016"><a href="#cb375-2016" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-2017"><a href="#cb375-2017" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb375-2018"><a href="#cb375-2018" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb375-2019"><a href="#cb375-2019" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb375-2020"><a href="#cb375-2020" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-2021"><a href="#cb375-2021" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb375-2022"><a href="#cb375-2022" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb375-2023"><a href="#cb375-2023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2024"><a href="#cb375-2024" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-2025"><a href="#cb375-2025" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb375-2026"><a href="#cb375-2026" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb375-2027"><a href="#cb375-2027" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb375-2028"><a href="#cb375-2028" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-2029"><a href="#cb375-2029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2030"><a href="#cb375-2030" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-2031"><a href="#cb375-2031" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb375-2032"><a href="#cb375-2032" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-2033"><a href="#cb375-2033" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb375-2034"><a href="#cb375-2034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2035"><a href="#cb375-2035" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb375-2036"><a href="#cb375-2036" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb375-2037"><a href="#cb375-2037" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb375-2038"><a href="#cb375-2038" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-2039"><a href="#cb375-2039" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-2040"><a href="#cb375-2040" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-2041"><a href="#cb375-2041" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-2042"><a href="#cb375-2042" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb375-2043"><a href="#cb375-2043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2044"><a href="#cb375-2044" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-2045"><a href="#cb375-2045" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb375-2046"><a href="#cb375-2046" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb375-2047"><a href="#cb375-2047" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2048"><a href="#cb375-2048" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-2049"><a href="#cb375-2049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2050"><a href="#cb375-2050" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb375-2051"><a href="#cb375-2051" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb375-2052"><a href="#cb375-2052" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-2053"><a href="#cb375-2053" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb375-2054"><a href="#cb375-2054" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb375-2055"><a href="#cb375-2055" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-2056"><a href="#cb375-2056" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-2057"><a href="#cb375-2057" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-2058"><a href="#cb375-2058" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb375-2059"><a href="#cb375-2059" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb375-2060"><a href="#cb375-2060" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb375-2061"><a href="#cb375-2061" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb375-2062"><a href="#cb375-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2063"><a href="#cb375-2063" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-2064"><a href="#cb375-2064" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-2065"><a href="#cb375-2065" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb375-2066"><a href="#cb375-2066" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb375-2067"><a href="#cb375-2067" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb375-2068"><a href="#cb375-2068" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-2069"><a href="#cb375-2069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2070"><a href="#cb375-2070" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-2071"><a href="#cb375-2071" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-2072"><a href="#cb375-2072" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2073"><a href="#cb375-2073" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb375-2074"><a href="#cb375-2074" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb375-2075"><a href="#cb375-2075" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-2076"><a href="#cb375-2076" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb375-2077"><a href="#cb375-2077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2078"><a href="#cb375-2078" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb375-2079"><a href="#cb375-2079" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb375-2080"><a href="#cb375-2080" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb375-2081"><a href="#cb375-2081" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-2082"><a href="#cb375-2082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2083"><a href="#cb375-2083" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb375-2084"><a href="#cb375-2084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2085"><a href="#cb375-2085" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-2086"><a href="#cb375-2086" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb375-2087"><a href="#cb375-2087" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(adjacency_list)</span>
<span id="cb375-2088"><a href="#cb375-2088" aria-hidden="true" tabindex="-1"></a>    reconstructed_string <span class="op">=</span> path[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-2089"><a href="#cb375-2089" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> path:</span>
<span id="cb375-2090"><a href="#cb375-2090" aria-hidden="true" tabindex="-1"></a>        reconstructed_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-2091"><a href="#cb375-2091" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_string</span>
<span id="cb375-2092"><a href="#cb375-2092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2093"><a href="#cb375-2093" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2094"><a href="#cb375-2094" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-2095"><a href="#cb375-2095" aria-hidden="true" tabindex="-1"></a><span class="st">CTTA</span></span>
<span id="cb375-2096"><a href="#cb375-2096" aria-hidden="true" tabindex="-1"></a><span class="st">ACCA</span></span>
<span id="cb375-2097"><a href="#cb375-2097" aria-hidden="true" tabindex="-1"></a><span class="st">TACC</span></span>
<span id="cb375-2098"><a href="#cb375-2098" aria-hidden="true" tabindex="-1"></a><span class="st">GGCT</span></span>
<span id="cb375-2099"><a href="#cb375-2099" aria-hidden="true" tabindex="-1"></a><span class="st">GCTT</span></span>
<span id="cb375-2100"><a href="#cb375-2100" aria-hidden="true" tabindex="-1"></a><span class="st">TTAC</span></span>
<span id="cb375-2101"><a href="#cb375-2101" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2102"><a href="#cb375-2102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2103"><a href="#cb375-2103" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-2104"><a href="#cb375-2104" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb375-2105"><a href="#cb375-2105" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb375-2106"><a href="#cb375-2106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2107"><a href="#cb375-2107" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string(kmers))</span>
<span id="cb375-2108"><a href="#cb375-2108" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2109"><a href="#cb375-2109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2110"><a href="#cb375-2110" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a k-Universal Circular String</span></span>
<span id="cb375-2111"><a href="#cb375-2111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2112"><a href="#cb375-2112" aria-hidden="true" tabindex="-1"></a> <span class="op">*</span>k<span class="op">*-</span>Universal Circular String Problem. Find a k<span class="op">-</span>universal circular binary string.</span>
<span id="cb375-2113"><a href="#cb375-2113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2114"><a href="#cb375-2114" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>.</span>
<span id="cb375-2115"><a href="#cb375-2115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2116"><a href="#cb375-2116" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A&nbsp;<span class="op">*</span>k<span class="op">*-</span>universal circular string. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-2117"><a href="#cb375-2117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2118"><a href="#cb375-2118" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2119"><a href="#cb375-2119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2120"><a href="#cb375-2120" aria-hidden="true" tabindex="-1"></a>```<span class="dv">4</span>```</span>
<span id="cb375-2121"><a href="#cb375-2121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2122"><a href="#cb375-2122" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2123"><a href="#cb375-2123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2124"><a href="#cb375-2124" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2125"><a href="#cb375-2125" aria-hidden="true" tabindex="-1"></a><span class="dv">1111010010110000</span></span>
<span id="cb375-2126"><a href="#cb375-2126" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2127"><a href="#cb375-2127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2128"><a href="#cb375-2128" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2129"><a href="#cb375-2129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2130"><a href="#cb375-2130" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2131"><a href="#cb375-2131" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-2132"><a href="#cb375-2132" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb375-2133"><a href="#cb375-2133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2134"><a href="#cb375-2134" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-2135"><a href="#cb375-2135" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb375-2136"><a href="#cb375-2136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb375-2137"><a href="#cb375-2137" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-2138"><a href="#cb375-2138" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb375-2139"><a href="#cb375-2139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb375-2140"><a href="#cb375-2140" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb375-2141"><a href="#cb375-2141" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-2142"><a href="#cb375-2142" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb375-2143"><a href="#cb375-2143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb375-2144"><a href="#cb375-2144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2145"><a href="#cb375-2145" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-2146"><a href="#cb375-2146" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb375-2147"><a href="#cb375-2147" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb375-2148"><a href="#cb375-2148" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb375-2149"><a href="#cb375-2149" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-2150"><a href="#cb375-2150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2151"><a href="#cb375-2151" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-2152"><a href="#cb375-2152" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb375-2153"><a href="#cb375-2153" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-2154"><a href="#cb375-2154" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb375-2155"><a href="#cb375-2155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2156"><a href="#cb375-2156" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb375-2157"><a href="#cb375-2157" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb375-2158"><a href="#cb375-2158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb375-2159"><a href="#cb375-2159" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-2160"><a href="#cb375-2160" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-2161"><a href="#cb375-2161" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-2162"><a href="#cb375-2162" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-2163"><a href="#cb375-2163" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb375-2164"><a href="#cb375-2164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2165"><a href="#cb375-2165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-2166"><a href="#cb375-2166" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb375-2167"><a href="#cb375-2167" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb375-2168"><a href="#cb375-2168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2169"><a href="#cb375-2169" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-2170"><a href="#cb375-2170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2171"><a href="#cb375-2171" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb375-2172"><a href="#cb375-2172" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb375-2173"><a href="#cb375-2173" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-2174"><a href="#cb375-2174" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb375-2175"><a href="#cb375-2175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb375-2176"><a href="#cb375-2176" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-2177"><a href="#cb375-2177" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-2178"><a href="#cb375-2178" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-2179"><a href="#cb375-2179" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb375-2180"><a href="#cb375-2180" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb375-2181"><a href="#cb375-2181" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb375-2182"><a href="#cb375-2182" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb375-2183"><a href="#cb375-2183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2184"><a href="#cb375-2184" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_k_universal_circular_string(k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-2185"><a href="#cb375-2185" aria-hidden="true" tabindex="-1"></a>    kmers: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb375-2186"><a href="#cb375-2186" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span> <span class="op">**</span> k):</span>
<span id="cb375-2187"><a href="#cb375-2187" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> <span class="bu">format</span>(i, <span class="ss">f'0</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">b'</span>)</span>
<span id="cb375-2188"><a href="#cb375-2188" aria-hidden="true" tabindex="-1"></a>        kmers.append(kmer)</span>
<span id="cb375-2189"><a href="#cb375-2189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2190"><a href="#cb375-2190" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb375-2191"><a href="#cb375-2191" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(adjacency_list)</span>
<span id="cb375-2192"><a href="#cb375-2192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2193"><a href="#cb375-2193" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> cycle[:<span class="bu">len</span>(cycle) <span class="op">-</span> k <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-2194"><a href="#cb375-2194" aria-hidden="true" tabindex="-1"></a>    circular_string <span class="op">=</span> cycle[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-2195"><a href="#cb375-2195" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> cycle:</span>
<span id="cb375-2196"><a href="#cb375-2196" aria-hidden="true" tabindex="-1"></a>        circular_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-2197"><a href="#cb375-2197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> circular_string</span>
<span id="cb375-2198"><a href="#cb375-2198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2199"><a href="#cb375-2199" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2200"><a href="#cb375-2200" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-2201"><a href="#cb375-2201" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2202"><a href="#cb375-2202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2203"><a href="#cb375-2203" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-2204"><a href="#cb375-2204" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb375-2205"><a href="#cb375-2205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2206"><a href="#cb375-2206" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generate_k_universal_circular_string(k))</span>
<span id="cb375-2207"><a href="#cb375-2207" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2208"><a href="#cb375-2208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2209"><a href="#cb375-2209" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its Paired Composition</span></span>
<span id="cb375-2210"><a href="#cb375-2210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2211"><a href="#cb375-2211" aria-hidden="true" tabindex="-1"></a>String Reconstruction <span class="im">from</span> Read<span class="op">-</span>Pairs Problem. Reconstruct a string <span class="im">from</span> its paired composition.</span>
<span id="cb375-2212"><a href="#cb375-2212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2213"><a href="#cb375-2213" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>d<span class="op">*</span>&nbsp;followed by a collection of paired&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers&nbsp;<span class="op">*</span>PairedReads<span class="op">*</span>.</span>
<span id="cb375-2214"><a href="#cb375-2214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2215"><a href="#cb375-2215" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;with (<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>d<span class="op">*</span>)<span class="op">-</span>mer composition equal to&nbsp;<span class="op">*</span>PairedReads<span class="op">*</span>. (If multiple answers exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-2216"><a href="#cb375-2216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2217"><a href="#cb375-2217" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2218"><a href="#cb375-2218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2219"><a href="#cb375-2219" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2220"><a href="#cb375-2220" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">2</span></span>
<span id="cb375-2221"><a href="#cb375-2221" aria-hidden="true" tabindex="-1"></a>GAGA<span class="op">|</span>TTGA</span>
<span id="cb375-2222"><a href="#cb375-2222" aria-hidden="true" tabindex="-1"></a>TCGT<span class="op">|</span>GATG</span>
<span id="cb375-2223"><a href="#cb375-2223" aria-hidden="true" tabindex="-1"></a>CGTG<span class="op">|</span>ATGT</span>
<span id="cb375-2224"><a href="#cb375-2224" aria-hidden="true" tabindex="-1"></a>TGGT<span class="op">|</span>TGAG</span>
<span id="cb375-2225"><a href="#cb375-2225" aria-hidden="true" tabindex="-1"></a>GTGA<span class="op">|</span>TGTT</span>
<span id="cb375-2226"><a href="#cb375-2226" aria-hidden="true" tabindex="-1"></a>GTGG<span class="op">|</span>GTGA</span>
<span id="cb375-2227"><a href="#cb375-2227" aria-hidden="true" tabindex="-1"></a>TGAG<span class="op">|</span>GTTG</span>
<span id="cb375-2228"><a href="#cb375-2228" aria-hidden="true" tabindex="-1"></a>GGTC<span class="op">|</span>GAGA</span>
<span id="cb375-2229"><a href="#cb375-2229" aria-hidden="true" tabindex="-1"></a>GTCG<span class="op">|</span>AGAT</span>
<span id="cb375-2230"><a href="#cb375-2230" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2231"><a href="#cb375-2231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2232"><a href="#cb375-2232" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2233"><a href="#cb375-2233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2234"><a href="#cb375-2234" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2235"><a href="#cb375-2235" aria-hidden="true" tabindex="-1"></a>GTGGTCGTGAGATGTTGA</span>
<span id="cb375-2236"><a href="#cb375-2236" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2237"><a href="#cb375-2237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2238"><a href="#cb375-2238" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2239"><a href="#cb375-2239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2240"><a href="#cb375-2240" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2241"><a href="#cb375-2241" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb375-2242"><a href="#cb375-2242" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-2243"><a href="#cb375-2243" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb375-2244"><a href="#cb375-2244" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb375-2245"><a href="#cb375-2245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2246"><a href="#cb375-2246" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-2247"><a href="#cb375-2247" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb375-2248"><a href="#cb375-2248" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb375-2249"><a href="#cb375-2249" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb375-2250"><a href="#cb375-2250" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-2251"><a href="#cb375-2251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2252"><a href="#cb375-2252" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-2253"><a href="#cb375-2253" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb375-2254"><a href="#cb375-2254" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-2255"><a href="#cb375-2255" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb375-2256"><a href="#cb375-2256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2257"><a href="#cb375-2257" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb375-2258"><a href="#cb375-2258" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb375-2259"><a href="#cb375-2259" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb375-2260"><a href="#cb375-2260" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-2261"><a href="#cb375-2261" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-2262"><a href="#cb375-2262" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-2263"><a href="#cb375-2263" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-2264"><a href="#cb375-2264" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb375-2265"><a href="#cb375-2265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2266"><a href="#cb375-2266" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-2267"><a href="#cb375-2267" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb375-2268"><a href="#cb375-2268" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb375-2269"><a href="#cb375-2269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2270"><a href="#cb375-2270" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-2271"><a href="#cb375-2271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2272"><a href="#cb375-2272" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb375-2273"><a href="#cb375-2273" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb375-2274"><a href="#cb375-2274" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb375-2275"><a href="#cb375-2275" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb375-2276"><a href="#cb375-2276" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb375-2277"><a href="#cb375-2277" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb375-2278"><a href="#cb375-2278" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb375-2279"><a href="#cb375-2279" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-2280"><a href="#cb375-2280" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb375-2281"><a href="#cb375-2281" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb375-2282"><a href="#cb375-2282" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb375-2283"><a href="#cb375-2283" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb375-2284"><a href="#cb375-2284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2285"><a href="#cb375-2285" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-2286"><a href="#cb375-2286" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-2287"><a href="#cb375-2287" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb375-2288"><a href="#cb375-2288" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb375-2289"><a href="#cb375-2289" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb375-2290"><a href="#cb375-2290" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-2291"><a href="#cb375-2291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2292"><a href="#cb375-2292" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-2293"><a href="#cb375-2293" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-2294"><a href="#cb375-2294" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2295"><a href="#cb375-2295" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb375-2296"><a href="#cb375-2296" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb375-2297"><a href="#cb375-2297" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-2298"><a href="#cb375-2298" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb375-2299"><a href="#cb375-2299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2300"><a href="#cb375-2300" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb375-2301"><a href="#cb375-2301" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb375-2302"><a href="#cb375-2302" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb375-2303"><a href="#cb375-2303" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-2304"><a href="#cb375-2304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2305"><a href="#cb375-2305" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb375-2306"><a href="#cb375-2306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2307"><a href="#cb375-2307" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph_paired_reads(paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]]:</span>
<span id="cb375-2308"><a href="#cb375-2308" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-2309"><a href="#cb375-2309" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pair <span class="kw">in</span> paired_reads:</span>
<span id="cb375-2310"><a href="#cb375-2310" aria-hidden="true" tabindex="-1"></a>        graph[(pair[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>], pair[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>])].append((pair[<span class="dv">0</span>][<span class="dv">1</span>:], pair[<span class="dv">1</span>][<span class="dv">1</span>:]))</span>
<span id="cb375-2311"><a href="#cb375-2311" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-2312"><a href="#cb375-2312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2313"><a href="#cb375-2313" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> string_spelled_by_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-2314"><a href="#cb375-2314" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-2315"><a href="#cb375-2315" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">1</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>]</span>
<span id="cb375-2316"><a href="#cb375-2316" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2317"><a href="#cb375-2317" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb375-2318"><a href="#cb375-2318" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb375-2319"><a href="#cb375-2319" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb375-2320"><a href="#cb375-2320" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb375-2321"><a href="#cb375-2321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2322"><a href="#cb375-2322" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_read_pairs(k: <span class="bu">int</span>, d: <span class="bu">int</span>, paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-2323"><a href="#cb375-2323" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph_paired_reads(paired_reads)</span>
<span id="cb375-2324"><a href="#cb375-2324" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(graph)</span>
<span id="cb375-2325"><a href="#cb375-2325" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> string_spelled_by_gapped_patterns(path, k <span class="op">-</span> <span class="dv">1</span>, d)</span>
<span id="cb375-2326"><a href="#cb375-2326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2327"><a href="#cb375-2327" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2328"><a href="#cb375-2328" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb375-2329"><a href="#cb375-2329" aria-hidden="true" tabindex="-1"></a><span class="st">GAGA|TTGA</span></span>
<span id="cb375-2330"><a href="#cb375-2330" aria-hidden="true" tabindex="-1"></a><span class="st">TCGT|GATG</span></span>
<span id="cb375-2331"><a href="#cb375-2331" aria-hidden="true" tabindex="-1"></a><span class="st">CGTG|ATGT</span></span>
<span id="cb375-2332"><a href="#cb375-2332" aria-hidden="true" tabindex="-1"></a><span class="st">TGGT|TGAG</span></span>
<span id="cb375-2333"><a href="#cb375-2333" aria-hidden="true" tabindex="-1"></a><span class="st">GTGA|TGTT</span></span>
<span id="cb375-2334"><a href="#cb375-2334" aria-hidden="true" tabindex="-1"></a><span class="st">GTGG|GTGA</span></span>
<span id="cb375-2335"><a href="#cb375-2335" aria-hidden="true" tabindex="-1"></a><span class="st">TGAG|GTTG</span></span>
<span id="cb375-2336"><a href="#cb375-2336" aria-hidden="true" tabindex="-1"></a><span class="st">GGTC|GAGA</span></span>
<span id="cb375-2337"><a href="#cb375-2337" aria-hidden="true" tabindex="-1"></a><span class="st">GTCG|AGAT</span></span>
<span id="cb375-2338"><a href="#cb375-2338" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2339"><a href="#cb375-2339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2340"><a href="#cb375-2340" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-2341"><a href="#cb375-2341" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb375-2342"><a href="#cb375-2342" aria-hidden="true" tabindex="-1"></a>paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb375-2343"><a href="#cb375-2343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2344"><a href="#cb375-2344" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_read_pairs(k, d, paired_reads))</span>
<span id="cb375-2345"><a href="#cb375-2345" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2346"><a href="#cb375-2346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2347"><a href="#cb375-2347" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate Contigs from a Collection of Reads</span></span>
<span id="cb375-2348"><a href="#cb375-2348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2349"><a href="#cb375-2349" aria-hidden="true" tabindex="-1"></a>Contig Generation Problem. Generate the contigs <span class="im">from</span> a collection of reads (<span class="cf">with</span> imperfect coverage).</span>
<span id="cb375-2350"><a href="#cb375-2350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2351"><a href="#cb375-2351" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of k<span class="op">-</span>mers&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb375-2352"><a href="#cb375-2352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2353"><a href="#cb375-2353" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All contigs in&nbsp;<span class="op">*</span>DeBruijn(Patterns)<span class="op">*</span>. (You may <span class="cf">return</span> the strings <span class="kw">in</span> <span class="bu">any</span> order.)</span>
<span id="cb375-2354"><a href="#cb375-2354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2355"><a href="#cb375-2355" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2356"><a href="#cb375-2356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2357"><a href="#cb375-2357" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2358"><a href="#cb375-2358" aria-hidden="true" tabindex="-1"></a>ATG</span>
<span id="cb375-2359"><a href="#cb375-2359" aria-hidden="true" tabindex="-1"></a>ATG</span>
<span id="cb375-2360"><a href="#cb375-2360" aria-hidden="true" tabindex="-1"></a>TGT</span>
<span id="cb375-2361"><a href="#cb375-2361" aria-hidden="true" tabindex="-1"></a>TGG</span>
<span id="cb375-2362"><a href="#cb375-2362" aria-hidden="true" tabindex="-1"></a>CAT</span>
<span id="cb375-2363"><a href="#cb375-2363" aria-hidden="true" tabindex="-1"></a>GGA</span>
<span id="cb375-2364"><a href="#cb375-2364" aria-hidden="true" tabindex="-1"></a>GAT</span>
<span id="cb375-2365"><a href="#cb375-2365" aria-hidden="true" tabindex="-1"></a>AGA</span>
<span id="cb375-2366"><a href="#cb375-2366" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2367"><a href="#cb375-2367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2368"><a href="#cb375-2368" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2369"><a href="#cb375-2369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2370"><a href="#cb375-2370" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2371"><a href="#cb375-2371" aria-hidden="true" tabindex="-1"></a>AGA ATG ATG CAT GAT TGGA TGT</span>
<span id="cb375-2372"><a href="#cb375-2372" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2373"><a href="#cb375-2373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2374"><a href="#cb375-2374" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2375"><a href="#cb375-2375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2376"><a href="#cb375-2376" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2377"><a href="#cb375-2377" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-2378"><a href="#cb375-2378" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-2379"><a href="#cb375-2379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2380"><a href="#cb375-2380" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-2381"><a href="#cb375-2381" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-2382"><a href="#cb375-2382" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb375-2383"><a href="#cb375-2383" aria-hidden="true" tabindex="-1"></a>        prefix, suffix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>], kmer[<span class="dv">1</span>:]</span>
<span id="cb375-2384"><a href="#cb375-2384" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[prefix].append(suffix)</span>
<span id="cb375-2385"><a href="#cb375-2385" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb375-2386"><a href="#cb375-2386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2387"><a href="#cb375-2387" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-2388"><a href="#cb375-2388" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb375-2389"><a href="#cb375-2389" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb375-2390"><a href="#cb375-2390" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb375-2391"><a href="#cb375-2391" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-2392"><a href="#cb375-2392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2393"><a href="#cb375-2393" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb375-2394"><a href="#cb375-2394" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb375-2395"><a href="#cb375-2395" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb375-2396"><a href="#cb375-2396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2397"><a href="#cb375-2397" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb375-2398"><a href="#cb375-2398" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb375-2399"><a href="#cb375-2399" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb375-2400"><a href="#cb375-2400" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(targets)]</span>
<span id="cb375-2401"><a href="#cb375-2401" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-2402"><a href="#cb375-2402" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(targets)</span>
<span id="cb375-2403"><a href="#cb375-2403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2404"><a href="#cb375-2404" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb375-2405"><a href="#cb375-2405" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb375-2406"><a href="#cb375-2406" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb375-2407"><a href="#cb375-2407" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-2408"><a href="#cb375-2408" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-2409"><a href="#cb375-2409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2410"><a href="#cb375-2410" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb375-2411"><a href="#cb375-2411" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb375-2412"><a href="#cb375-2412" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb375-2413"><a href="#cb375-2413" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-2414"><a href="#cb375-2414" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb375-2415"><a href="#cb375-2415" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb375-2416"><a href="#cb375-2416" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb375-2417"><a href="#cb375-2417" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb375-2418"><a href="#cb375-2418" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb375-2419"><a href="#cb375-2419" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb375-2420"><a href="#cb375-2420" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb375-2421"><a href="#cb375-2421" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb375-2422"><a href="#cb375-2422" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb375-2423"><a href="#cb375-2423" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb375-2424"><a href="#cb375-2424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2425"><a href="#cb375-2425" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb375-2426"><a href="#cb375-2426" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-2427"><a href="#cb375-2427" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb375-2428"><a href="#cb375-2428" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb375-2429"><a href="#cb375-2429" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb375-2430"><a href="#cb375-2430" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb375-2431"><a href="#cb375-2431" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb375-2432"><a href="#cb375-2432" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb375-2433"><a href="#cb375-2433" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb375-2434"><a href="#cb375-2434" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-2435"><a href="#cb375-2435" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb375-2436"><a href="#cb375-2436" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb375-2437"><a href="#cb375-2437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2438"><a href="#cb375-2438" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb375-2439"><a href="#cb375-2439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2440"><a href="#cb375-2440" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_contigs(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-2441"><a href="#cb375-2441" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb375-2442"><a href="#cb375-2442" aria-hidden="true" tabindex="-1"></a>    paths <span class="op">=</span> find_maximal_non_branching_paths(graph)</span>
<span id="cb375-2443"><a href="#cb375-2443" aria-hidden="true" tabindex="-1"></a>    contigs: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb375-2444"><a href="#cb375-2444" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> path <span class="kw">in</span> paths:</span>
<span id="cb375-2445"><a href="#cb375-2445" aria-hidden="true" tabindex="-1"></a>        contig <span class="op">=</span> path[<span class="dv">0</span>]</span>
<span id="cb375-2446"><a href="#cb375-2446" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> path[<span class="dv">1</span>:]:</span>
<span id="cb375-2447"><a href="#cb375-2447" aria-hidden="true" tabindex="-1"></a>            contig <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-2448"><a href="#cb375-2448" aria-hidden="true" tabindex="-1"></a>        contigs.append(contig)</span>
<span id="cb375-2449"><a href="#cb375-2449" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> contigs</span>
<span id="cb375-2450"><a href="#cb375-2450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2451"><a href="#cb375-2451" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2452"><a href="#cb375-2452" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb375-2453"><a href="#cb375-2453" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb375-2454"><a href="#cb375-2454" aria-hidden="true" tabindex="-1"></a><span class="st">TGT</span></span>
<span id="cb375-2455"><a href="#cb375-2455" aria-hidden="true" tabindex="-1"></a><span class="st">TGG</span></span>
<span id="cb375-2456"><a href="#cb375-2456" aria-hidden="true" tabindex="-1"></a><span class="st">CAT</span></span>
<span id="cb375-2457"><a href="#cb375-2457" aria-hidden="true" tabindex="-1"></a><span class="st">GGA</span></span>
<span id="cb375-2458"><a href="#cb375-2458" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb375-2459"><a href="#cb375-2459" aria-hidden="true" tabindex="-1"></a><span class="st">AGA</span></span>
<span id="cb375-2460"><a href="#cb375-2460" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2461"><a href="#cb375-2461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2462"><a href="#cb375-2462" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-2463"><a href="#cb375-2463" aria-hidden="true" tabindex="-1"></a>contigs <span class="op">=</span> generate_contigs(kmers)</span>
<span id="cb375-2464"><a href="#cb375-2464" aria-hidden="true" tabindex="-1"></a>contigs.sort()</span>
<span id="cb375-2465"><a href="#cb375-2465" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(contigs))</span>
<span id="cb375-2466"><a href="#cb375-2466" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2467"><a href="#cb375-2467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2468"><a href="#cb375-2468" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a String Spelled by a Gapped Genome Path</span></span>
<span id="cb375-2469"><a href="#cb375-2469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2470"><a href="#cb375-2470" aria-hidden="true" tabindex="-1"></a>Gapped Genome Path String Problem. Reconstruct a string <span class="im">from</span> a sequence of (k,d)<span class="op">-</span>mers corresponding to a path <span class="kw">in</span> a paired de Bruijn graph.</span>
<span id="cb375-2471"><a href="#cb375-2471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2472"><a href="#cb375-2472" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of&nbsp;<span class="op">*</span>(k, d)<span class="op">*-</span>mers (<span class="op">*</span>a1<span class="op">|</span>b1<span class="op">*</span>),..., (<span class="op">*</span>an<span class="op">|</span>bn<span class="op">*</span>) such that&nbsp;<span class="op">*</span>Suffix(ai<span class="op">|</span>bi) <span class="op">=</span> Prefix(ai<span class="op">+</span><span class="dv">1</span><span class="op">|</span>bi<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>&nbsp;for all&nbsp;<span class="op">*</span>i<span class="op">*</span>&nbsp;from <span class="dv">1</span> to n<span class="op">-</span><span class="fl">1.</span></span>
<span id="cb375-2473"><a href="#cb375-2473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2474"><a href="#cb375-2474" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;where the&nbsp;<span class="op">*</span>i<span class="op">*-</span>th&nbsp;<span class="op">*</span>k<span class="op">*-</span>mer in&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;is equal to&nbsp;<span class="op">*</span>Suffix(ai<span class="op">|</span>bi)<span class="op">*</span>&nbsp;for all&nbsp;<span class="op">*</span>i<span class="op">*</span>&nbsp;from <span class="dv">1</span> to n, <span class="cf">if</span> such a string exists.</span>
<span id="cb375-2475"><a href="#cb375-2475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2476"><a href="#cb375-2476" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2477"><a href="#cb375-2477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2478"><a href="#cb375-2478" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2479"><a href="#cb375-2479" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">2</span></span>
<span id="cb375-2480"><a href="#cb375-2480" aria-hidden="true" tabindex="-1"></a>GACC<span class="op">|</span>GCGC</span>
<span id="cb375-2481"><a href="#cb375-2481" aria-hidden="true" tabindex="-1"></a>ACCG<span class="op">|</span>CGCC</span>
<span id="cb375-2482"><a href="#cb375-2482" aria-hidden="true" tabindex="-1"></a>CCGA<span class="op">|</span>GCCG</span>
<span id="cb375-2483"><a href="#cb375-2483" aria-hidden="true" tabindex="-1"></a>CGAG<span class="op">|</span>CCGG</span>
<span id="cb375-2484"><a href="#cb375-2484" aria-hidden="true" tabindex="-1"></a>GAGC<span class="op">|</span>CGGA</span>
<span id="cb375-2485"><a href="#cb375-2485" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2486"><a href="#cb375-2486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2487"><a href="#cb375-2487" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2488"><a href="#cb375-2488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2489"><a href="#cb375-2489" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2490"><a href="#cb375-2490" aria-hidden="true" tabindex="-1"></a>GACCGAGCGCCGGA</span>
<span id="cb375-2491"><a href="#cb375-2491" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2492"><a href="#cb375-2492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2493"><a href="#cb375-2493" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2494"><a href="#cb375-2494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2495"><a href="#cb375-2495" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2496"><a href="#cb375-2496" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb375-2497"><a href="#cb375-2497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2498"><a href="#cb375-2498" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-2499"><a href="#cb375-2499" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb375-2500"><a href="#cb375-2500" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb375-2501"><a href="#cb375-2501" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (prefix, suffix) <span class="kw">in</span> <span class="bu">enumerate</span>(gapped_patterns):</span>
<span id="cb375-2502"><a href="#cb375-2502" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">!=</span> <span class="bu">len</span>(gapped_patterns) <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb375-2503"><a href="#cb375-2503" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix[<span class="dv">0</span>]</span>
<span id="cb375-2504"><a href="#cb375-2504" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix[<span class="dv">0</span>]</span>
<span id="cb375-2505"><a href="#cb375-2505" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-2506"><a href="#cb375-2506" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix</span>
<span id="cb375-2507"><a href="#cb375-2507" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix</span>
<span id="cb375-2508"><a href="#cb375-2508" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2509"><a href="#cb375-2509" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb375-2510"><a href="#cb375-2510" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb375-2511"><a href="#cb375-2511" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb375-2512"><a href="#cb375-2512" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2513"><a href="#cb375-2513" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb375-2514"><a href="#cb375-2514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2515"><a href="#cb375-2515" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2516"><a href="#cb375-2516" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb375-2517"><a href="#cb375-2517" aria-hidden="true" tabindex="-1"></a><span class="st">GACC|GCGC</span></span>
<span id="cb375-2518"><a href="#cb375-2518" aria-hidden="true" tabindex="-1"></a><span class="st">ACCG|CGCC</span></span>
<span id="cb375-2519"><a href="#cb375-2519" aria-hidden="true" tabindex="-1"></a><span class="st">CCGA|GCCG</span></span>
<span id="cb375-2520"><a href="#cb375-2520" aria-hidden="true" tabindex="-1"></a><span class="st">CGAG|CCGG</span></span>
<span id="cb375-2521"><a href="#cb375-2521" aria-hidden="true" tabindex="-1"></a><span class="st">GAGC|CGGA</span></span>
<span id="cb375-2522"><a href="#cb375-2522" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2523"><a href="#cb375-2523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2524"><a href="#cb375-2524" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-2525"><a href="#cb375-2525" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb375-2526"><a href="#cb375-2526" aria-hidden="true" tabindex="-1"></a>gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb375-2527"><a href="#cb375-2527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2528"><a href="#cb375-2528" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_gapped_patterns(gapped_patterns, k <span class="op">-</span> <span class="dv">1</span>, d))</span>
<span id="cb375-2529"><a href="#cb375-2529" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2530"><a href="#cb375-2530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2531"><a href="#cb375-2531" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate All Maximal Non-Branching Paths in a Graph</span></span>
<span id="cb375-2532"><a href="#cb375-2532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2533"><a href="#cb375-2533" aria-hidden="true" tabindex="-1"></a> Maximal Non<span class="op">-</span>Branching Path Problem. Find <span class="bu">all</span> maximal non<span class="op">-</span>branching paths <span class="kw">in</span> a graph.</span>
<span id="cb375-2534"><a href="#cb375-2534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2535"><a href="#cb375-2535" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;The adjacency <span class="bu">list</span> of a graph whose nodes are integers.</span>
<span id="cb375-2536"><a href="#cb375-2536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2537"><a href="#cb375-2537" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The collection of <span class="bu">all</span> maximal non<span class="op">-</span>branching paths <span class="kw">in</span> the graph.</span>
<span id="cb375-2538"><a href="#cb375-2538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2539"><a href="#cb375-2539" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2540"><a href="#cb375-2540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2541"><a href="#cb375-2541" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2542"><a href="#cb375-2542" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb375-2543"><a href="#cb375-2543" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb375-2544"><a href="#cb375-2544" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">4</span>,<span class="dv">5</span></span>
<span id="cb375-2545"><a href="#cb375-2545" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">7</span></span>
<span id="cb375-2546"><a href="#cb375-2546" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb375-2547"><a href="#cb375-2547" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2548"><a href="#cb375-2548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2549"><a href="#cb375-2549" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2550"><a href="#cb375-2550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2551"><a href="#cb375-2551" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2552"><a href="#cb375-2552" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb375-2553"><a href="#cb375-2553" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">4</span></span>
<span id="cb375-2554"><a href="#cb375-2554" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> <span class="dv">5</span></span>
<span id="cb375-2555"><a href="#cb375-2555" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> <span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">6</span></span>
<span id="cb375-2556"><a href="#cb375-2556" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2557"><a href="#cb375-2557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2558"><a href="#cb375-2558" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2559"><a href="#cb375-2559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2560"><a href="#cb375-2560" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2561"><a href="#cb375-2561" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-2562"><a href="#cb375-2562" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb375-2563"><a href="#cb375-2563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2564"><a href="#cb375-2564" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-2565"><a href="#cb375-2565" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb375-2566"><a href="#cb375-2566" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb375-2567"><a href="#cb375-2567" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb375-2568"><a href="#cb375-2568" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[source] <span class="op">=</span> targets.split(<span class="st">','</span>)</span>
<span id="cb375-2569"><a href="#cb375-2569" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb375-2570"><a href="#cb375-2570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2571"><a href="#cb375-2571" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-2572"><a href="#cb375-2572" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb375-2573"><a href="#cb375-2573" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb375-2574"><a href="#cb375-2574" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb375-2575"><a href="#cb375-2575" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-2576"><a href="#cb375-2576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2577"><a href="#cb375-2577" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb375-2578"><a href="#cb375-2578" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb375-2579"><a href="#cb375-2579" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb375-2580"><a href="#cb375-2580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2581"><a href="#cb375-2581" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb375-2582"><a href="#cb375-2582" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb375-2583"><a href="#cb375-2583" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb375-2584"><a href="#cb375-2584" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(neighbors)]</span>
<span id="cb375-2585"><a href="#cb375-2585" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-2586"><a href="#cb375-2586" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(neighbors)</span>
<span id="cb375-2587"><a href="#cb375-2587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2588"><a href="#cb375-2588" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb375-2589"><a href="#cb375-2589" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb375-2590"><a href="#cb375-2590" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb375-2591"><a href="#cb375-2591" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-2592"><a href="#cb375-2592" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-2593"><a href="#cb375-2593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2594"><a href="#cb375-2594" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb375-2595"><a href="#cb375-2595" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb375-2596"><a href="#cb375-2596" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb375-2597"><a href="#cb375-2597" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-2598"><a href="#cb375-2598" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb375-2599"><a href="#cb375-2599" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb375-2600"><a href="#cb375-2600" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb375-2601"><a href="#cb375-2601" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb375-2602"><a href="#cb375-2602" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb375-2603"><a href="#cb375-2603" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb375-2604"><a href="#cb375-2604" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb375-2605"><a href="#cb375-2605" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb375-2606"><a href="#cb375-2606" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb375-2607"><a href="#cb375-2607" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb375-2608"><a href="#cb375-2608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2609"><a href="#cb375-2609" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb375-2610"><a href="#cb375-2610" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-2611"><a href="#cb375-2611" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb375-2612"><a href="#cb375-2612" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb375-2613"><a href="#cb375-2613" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb375-2614"><a href="#cb375-2614" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb375-2615"><a href="#cb375-2615" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb375-2616"><a href="#cb375-2616" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb375-2617"><a href="#cb375-2617" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb375-2618"><a href="#cb375-2618" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb375-2619"><a href="#cb375-2619" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb375-2620"><a href="#cb375-2620" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb375-2621"><a href="#cb375-2621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2622"><a href="#cb375-2622" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb375-2623"><a href="#cb375-2623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2624"><a href="#cb375-2624" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2625"><a href="#cb375-2625" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb375-2626"><a href="#cb375-2626" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb375-2627"><a href="#cb375-2627" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 4,5</span></span>
<span id="cb375-2628"><a href="#cb375-2628" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 7</span></span>
<span id="cb375-2629"><a href="#cb375-2629" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 6</span></span>
<span id="cb375-2630"><a href="#cb375-2630" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2631"><a href="#cb375-2631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2632"><a href="#cb375-2632" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-2633"><a href="#cb375-2633" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb375-2634"><a href="#cb375-2634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2635"><a href="#cb375-2635" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_maximal_non_branching_paths(adjacency_list)</span>
<span id="cb375-2636"><a href="#cb375-2636" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> result:</span>
<span id="cb375-2637"><a href="#cb375-2637" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">" -&gt; "</span>.join(path))</span>
<span id="cb375-2638"><a href="#cb375-2638" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2639"><a href="#cb375-2639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2640"><a href="#cb375-2640" aria-hidden="true" tabindex="-1"></a><span class="co"># Translate an RNA String into an Amino Acid String</span></span>
<span id="cb375-2641"><a href="#cb375-2641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2642"><a href="#cb375-2642" aria-hidden="true" tabindex="-1"></a>Protein Translation Problem. Translate an&nbsp;[RNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>rna<span class="op">-</span>string<span class="op">/</span>)&nbsp;into an&nbsp;[amino acid string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb375-2643"><a href="#cb375-2643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2644"><a href="#cb375-2644" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An RNA string&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>.</span>
<span id="cb375-2645"><a href="#cb375-2645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2646"><a href="#cb375-2646" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The translation of&nbsp;<span class="op">*</span>Pattern<span class="op">*</span>&nbsp;into an amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb375-2647"><a href="#cb375-2647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2648"><a href="#cb375-2648" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2649"><a href="#cb375-2649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2650"><a href="#cb375-2650" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2651"><a href="#cb375-2651" aria-hidden="true" tabindex="-1"></a>AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</span>
<span id="cb375-2652"><a href="#cb375-2652" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2653"><a href="#cb375-2653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2654"><a href="#cb375-2654" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2655"><a href="#cb375-2655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2656"><a href="#cb375-2656" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2657"><a href="#cb375-2657" aria-hidden="true" tabindex="-1"></a>MAMAPRTEINSTRING</span>
<span id="cb375-2658"><a href="#cb375-2658" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2659"><a href="#cb375-2659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2660"><a href="#cb375-2660" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2661"><a href="#cb375-2661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2662"><a href="#cb375-2662" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2663"><a href="#cb375-2663" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-2664"><a href="#cb375-2664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2665"><a href="#cb375-2665" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-2666"><a href="#cb375-2666" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 코돈을 아미노산으로 변환하는 딕셔너리</span></span>
<span id="cb375-2667"><a href="#cb375-2667" aria-hidden="true" tabindex="-1"></a>    codon_table: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb375-2668"><a href="#cb375-2668" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb375-2669"><a href="#cb375-2669" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb375-2670"><a href="#cb375-2670" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb375-2671"><a href="#cb375-2671" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb375-2672"><a href="#cb375-2672" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb375-2673"><a href="#cb375-2673" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb375-2674"><a href="#cb375-2674" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb375-2675"><a href="#cb375-2675" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb375-2676"><a href="#cb375-2676" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb375-2677"><a href="#cb375-2677" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb375-2678"><a href="#cb375-2678" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb375-2679"><a href="#cb375-2679" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb375-2680"><a href="#cb375-2680" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb375-2681"><a href="#cb375-2681" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb375-2682"><a href="#cb375-2682" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb375-2683"><a href="#cb375-2683" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb375-2684"><a href="#cb375-2684" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-2685"><a href="#cb375-2685" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2686"><a href="#cb375-2686" aria-hidden="true" tabindex="-1"></a>    protein_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-2687"><a href="#cb375-2687" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2688"><a href="#cb375-2688" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 서열을 3개의 뉴클레오티드(코돈)씩 나누어 처리</span></span>
<span id="cb375-2689"><a href="#cb375-2689" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb375-2690"><a href="#cb375-2690" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb375-2691"><a href="#cb375-2691" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-2692"><a href="#cb375-2692" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈이 3개의 뉴클레오티드로 완전하지 않으면 중단</span></span>
<span id="cb375-2693"><a href="#cb375-2693" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb375-2694"><a href="#cb375-2694" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb375-2695"><a href="#cb375-2695" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-2696"><a href="#cb375-2696" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈을 아미노산으로 변환</span></span>
<span id="cb375-2697"><a href="#cb375-2697" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_table.get(codon, <span class="st">''</span>)</span>
<span id="cb375-2698"><a href="#cb375-2698" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-2699"><a href="#cb375-2699" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 종결 코돈('*')을 만나면 번역 중단</span></span>
<span id="cb375-2700"><a href="#cb375-2700" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb375-2701"><a href="#cb375-2701" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb375-2702"><a href="#cb375-2702" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-2703"><a href="#cb375-2703" aria-hidden="true" tabindex="-1"></a>        protein_sequence <span class="op">+=</span> amino_acid</span>
<span id="cb375-2704"><a href="#cb375-2704" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2705"><a href="#cb375-2705" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> protein_sequence</span>
<span id="cb375-2706"><a href="#cb375-2706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2707"><a href="#cb375-2707" aria-hidden="true" tabindex="-1"></a><span class="co"># 입력 RNA 서열</span></span>
<span id="cb375-2708"><a href="#cb375-2708" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2709"><a href="#cb375-2709" aria-hidden="true" tabindex="-1"></a><span class="st">AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</span></span>
<span id="cb375-2710"><a href="#cb375-2710" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2711"><a href="#cb375-2711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2712"><a href="#cb375-2712" aria-hidden="true" tabindex="-1"></a>rna_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span>.join(sample_input.strip().split())</span>
<span id="cb375-2713"><a href="#cb375-2713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2714"><a href="#cb375-2714" aria-hidden="true" tabindex="-1"></a><span class="co"># RNA를 단백질로 번역</span></span>
<span id="cb375-2715"><a href="#cb375-2715" aria-hidden="true" tabindex="-1"></a>protein: <span class="bu">str</span> <span class="op">=</span> translate_rna_to_protein(rna_sequence)</span>
<span id="cb375-2716"><a href="#cb375-2716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2717"><a href="#cb375-2717" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(protein)</span>
<span id="cb375-2718"><a href="#cb375-2718" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2719"><a href="#cb375-2719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2720"><a href="#cb375-2720" aria-hidden="true" tabindex="-1"></a><span class="co"># Find Substrings of a Genome Encoding a Given Amino Acid String</span></span>
<span id="cb375-2721"><a href="#cb375-2721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2722"><a href="#cb375-2722" aria-hidden="true" tabindex="-1"></a>Peptide Encoding Problem, Find substrings of a genome encoding a given amino acid sequence.</span>
<span id="cb375-2723"><a href="#cb375-2723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2724"><a href="#cb375-2724" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[DNA string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;and an&nbsp;[amino acid string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb375-2725"><a href="#cb375-2725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2726"><a href="#cb375-2726" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All substrings of&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;encoding&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;(<span class="cf">if</span> <span class="bu">any</span> such substrings exist).</span>
<span id="cb375-2727"><a href="#cb375-2727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2728"><a href="#cb375-2728" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2729"><a href="#cb375-2729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2730"><a href="#cb375-2730" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2731"><a href="#cb375-2731" aria-hidden="true" tabindex="-1"></a>ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA</span>
<span id="cb375-2732"><a href="#cb375-2732" aria-hidden="true" tabindex="-1"></a>MA</span>
<span id="cb375-2733"><a href="#cb375-2733" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2734"><a href="#cb375-2734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2735"><a href="#cb375-2735" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2736"><a href="#cb375-2736" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2737"><a href="#cb375-2737" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2738"><a href="#cb375-2738" aria-hidden="true" tabindex="-1"></a>ATGGCC</span>
<span id="cb375-2739"><a href="#cb375-2739" aria-hidden="true" tabindex="-1"></a>GGCCAT</span>
<span id="cb375-2740"><a href="#cb375-2740" aria-hidden="true" tabindex="-1"></a>ATGGCC</span>
<span id="cb375-2741"><a href="#cb375-2741" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2742"><a href="#cb375-2742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2743"><a href="#cb375-2743" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2744"><a href="#cb375-2744" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2745"><a href="#cb375-2745" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2746"><a href="#cb375-2746" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-2747"><a href="#cb375-2747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2748"><a href="#cb375-2748" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-2749"><a href="#cb375-2749" aria-hidden="true" tabindex="-1"></a>    codon_to_amino_acid: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb375-2750"><a href="#cb375-2750" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb375-2751"><a href="#cb375-2751" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb375-2752"><a href="#cb375-2752" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb375-2753"><a href="#cb375-2753" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb375-2754"><a href="#cb375-2754" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb375-2755"><a href="#cb375-2755" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb375-2756"><a href="#cb375-2756" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb375-2757"><a href="#cb375-2757" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb375-2758"><a href="#cb375-2758" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb375-2759"><a href="#cb375-2759" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb375-2760"><a href="#cb375-2760" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb375-2761"><a href="#cb375-2761" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb375-2762"><a href="#cb375-2762" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb375-2763"><a href="#cb375-2763" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb375-2764"><a href="#cb375-2764" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb375-2765"><a href="#cb375-2765" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb375-2766"><a href="#cb375-2766" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-2767"><a href="#cb375-2767" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2768"><a href="#cb375-2768" aria-hidden="true" tabindex="-1"></a>    protein_sequence: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb375-2769"><a href="#cb375-2769" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2770"><a href="#cb375-2770" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb375-2771"><a href="#cb375-2771" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb375-2772"><a href="#cb375-2772" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-2773"><a href="#cb375-2773" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb375-2774"><a href="#cb375-2774" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb375-2775"><a href="#cb375-2775" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-2776"><a href="#cb375-2776" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_to_amino_acid.get(codon, <span class="st">''</span>)</span>
<span id="cb375-2777"><a href="#cb375-2777" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-2778"><a href="#cb375-2778" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb375-2779"><a href="#cb375-2779" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb375-2780"><a href="#cb375-2780" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-2781"><a href="#cb375-2781" aria-hidden="true" tabindex="-1"></a>        protein_sequence.append(amino_acid)</span>
<span id="cb375-2782"><a href="#cb375-2782" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2783"><a href="#cb375-2783" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(protein_sequence)</span>
<span id="cb375-2784"><a href="#cb375-2784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2785"><a href="#cb375-2785" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-2786"><a href="#cb375-2786" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb375-2787"><a href="#cb375-2787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2788"><a href="#cb375-2788" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dna_to_rna(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-2789"><a href="#cb375-2789" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence.replace(<span class="st">"T"</span>, <span class="st">"U"</span>)</span>
<span id="cb375-2790"><a href="#cb375-2790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2791"><a href="#cb375-2791" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_peptide_encoding_substrings(dna_sequence: <span class="bu">str</span>, peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-2792"><a href="#cb375-2792" aria-hidden="true" tabindex="-1"></a>    substring_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(peptide) <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb375-2793"><a href="#cb375-2793" aria-hidden="true" tabindex="-1"></a>    encoding_substrings: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb375-2794"><a href="#cb375-2794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2795"><a href="#cb375-2795" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-2796"><a href="#cb375-2796" aria-hidden="true" tabindex="-1"></a>        dna_substring: <span class="bu">str</span> <span class="op">=</span> dna_sequence[i:i <span class="op">+</span> substring_length]</span>
<span id="cb375-2797"><a href="#cb375-2797" aria-hidden="true" tabindex="-1"></a>        reverse_complement_substring: <span class="bu">str</span> <span class="op">=</span> reverse_complement(dna_substring)</span>
<span id="cb375-2798"><a href="#cb375-2798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2799"><a href="#cb375-2799" aria-hidden="true" tabindex="-1"></a>        rna_substring: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(dna_substring)</span>
<span id="cb375-2800"><a href="#cb375-2800" aria-hidden="true" tabindex="-1"></a>        reverse_complement_rna: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(reverse_complement_substring)</span>
<span id="cb375-2801"><a href="#cb375-2801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2802"><a href="#cb375-2802" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (translate_rna_to_protein(rna_substring) <span class="op">==</span> peptide <span class="kw">or</span> </span>
<span id="cb375-2803"><a href="#cb375-2803" aria-hidden="true" tabindex="-1"></a>            translate_rna_to_protein(reverse_complement_rna) <span class="op">==</span> peptide):</span>
<span id="cb375-2804"><a href="#cb375-2804" aria-hidden="true" tabindex="-1"></a>            encoding_substrings.append(dna_substring)</span>
<span id="cb375-2805"><a href="#cb375-2805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2806"><a href="#cb375-2806" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> encoding_substrings</span>
<span id="cb375-2807"><a href="#cb375-2807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2808"><a href="#cb375-2808" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2809"><a href="#cb375-2809" aria-hidden="true" tabindex="-1"></a><span class="st">ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA</span></span>
<span id="cb375-2810"><a href="#cb375-2810" aria-hidden="true" tabindex="-1"></a><span class="st">MA</span></span>
<span id="cb375-2811"><a href="#cb375-2811" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2812"><a href="#cb375-2812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2813"><a href="#cb375-2813" aria-hidden="true" tabindex="-1"></a>dna_sequence, peptide <span class="op">=</span> sample_input.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb375-2814"><a href="#cb375-2814" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> find_peptide_encoding_substrings(dna_sequence, peptide)</span>
<span id="cb375-2815"><a href="#cb375-2815" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(result))</span>
<span id="cb375-2816"><a href="#cb375-2816" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2817"><a href="#cb375-2817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2818"><a href="#cb375-2818" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the Theoretical Spectrum of a Cyclic Peptide</span></span>
<span id="cb375-2819"><a href="#cb375-2819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2820"><a href="#cb375-2820" aria-hidden="true" tabindex="-1"></a> Generating Theoretical Spectrum Problem, Generate the theoretical spectrum of a cyclic peptide.</span>
<span id="cb375-2821"><a href="#cb375-2821" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2822"><a href="#cb375-2822" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb375-2823"><a href="#cb375-2823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2824"><a href="#cb375-2824" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>Cyclospectrum<span class="op">*</span>(<span class="op">*</span>Peptide<span class="op">*</span>).</span>
<span id="cb375-2825"><a href="#cb375-2825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2826"><a href="#cb375-2826" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2827"><a href="#cb375-2827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2828"><a href="#cb375-2828" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2829"><a href="#cb375-2829" aria-hidden="true" tabindex="-1"></a>LEQN</span>
<span id="cb375-2830"><a href="#cb375-2830" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2831"><a href="#cb375-2831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2832"><a href="#cb375-2832" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2833"><a href="#cb375-2833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2834"><a href="#cb375-2834" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2835"><a href="#cb375-2835" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">113</span> <span class="dv">114</span> <span class="dv">128</span> <span class="dv">129</span> <span class="dv">227</span> <span class="dv">242</span> <span class="dv">242</span> <span class="dv">257</span> <span class="dv">355</span> <span class="dv">356</span> <span class="dv">370</span> <span class="dv">371</span> <span class="dv">484</span></span>
<span id="cb375-2836"><a href="#cb375-2836" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2837"><a href="#cb375-2837" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2838"><a href="#cb375-2838" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2839"><a href="#cb375-2839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2840"><a href="#cb375-2840" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2841"><a href="#cb375-2841" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-2842"><a href="#cb375-2842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2843"><a href="#cb375-2843" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-2844"><a href="#cb375-2844" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-2845"><a href="#cb375-2845" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-2846"><a href="#cb375-2846" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-2847"><a href="#cb375-2847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2848"><a href="#cb375-2848" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-2849"><a href="#cb375-2849" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide)</span>
<span id="cb375-2850"><a href="#cb375-2850" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb375-2851"><a href="#cb375-2851" aria-hidden="true" tabindex="-1"></a>    circular_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb375-2852"><a href="#cb375-2852" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2853"><a href="#cb375-2853" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subpeptide_length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb375-2854"><a href="#cb375-2854" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-2855"><a href="#cb375-2855" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> circular_peptide[start_index:start_index <span class="op">+</span> subpeptide_length]</span>
<span id="cb375-2856"><a href="#cb375-2856" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> subpeptide)</span>
<span id="cb375-2857"><a href="#cb375-2857" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb375-2858"><a href="#cb375-2858" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2859"><a href="#cb375-2859" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(spectrum)</span>
<span id="cb375-2860"><a href="#cb375-2860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2861"><a href="#cb375-2861" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2862"><a href="#cb375-2862" aria-hidden="true" tabindex="-1"></a><span class="st">LEQN</span></span>
<span id="cb375-2863"><a href="#cb375-2863" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2864"><a href="#cb375-2864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2865"><a href="#cb375-2865" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb375-2866"><a href="#cb375-2866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2867"><a href="#cb375-2867" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(input_peptide)</span>
<span id="cb375-2868"><a href="#cb375-2868" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb375-2869"><a href="#cb375-2869" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2870"><a href="#cb375-2870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2871"><a href="#cb375-2871" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Number of Peptides of Given Total Mass</span></span>
<span id="cb375-2872"><a href="#cb375-2872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2873"><a href="#cb375-2873" aria-hidden="true" tabindex="-1"></a>Counting Peptides <span class="cf">with</span> Given Mass Problem, Compute the number of peptides of given total mass.</span>
<span id="cb375-2874"><a href="#cb375-2874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2875"><a href="#cb375-2875" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>m<span class="op">*</span>.</span>
<span id="cb375-2876"><a href="#cb375-2876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2877"><a href="#cb375-2877" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The number of linear peptides having integer mass&nbsp;<span class="op">*</span>m<span class="op">*</span>.</span>
<span id="cb375-2878"><a href="#cb375-2878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2879"><a href="#cb375-2879" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2880"><a href="#cb375-2880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2881"><a href="#cb375-2881" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2882"><a href="#cb375-2882" aria-hidden="true" tabindex="-1"></a><span class="dv">1024</span></span>
<span id="cb375-2883"><a href="#cb375-2883" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2884"><a href="#cb375-2884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2885"><a href="#cb375-2885" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2886"><a href="#cb375-2886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2887"><a href="#cb375-2887" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2888"><a href="#cb375-2888" aria-hidden="true" tabindex="-1"></a><span class="dv">14712706211</span></span>
<span id="cb375-2889"><a href="#cb375-2889" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2890"><a href="#cb375-2890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2891"><a href="#cb375-2891" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2892"><a href="#cb375-2892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2893"><a href="#cb375-2893" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2894"><a href="#cb375-2894" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-2895"><a href="#cb375-2895" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb375-2896"><a href="#cb375-2896" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2897"><a href="#cb375-2897" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb375-2898"><a href="#cb375-2898" aria-hidden="true" tabindex="-1"></a>LIGHTEST_AMINO_ACID: <span class="bu">int</span> <span class="op">=</span> <span class="bu">min</span>(AMINO_ACID_MASSES)</span>
<span id="cb375-2899"><a href="#cb375-2899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2900"><a href="#cb375-2900" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_possible_peptides(target_mass: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-2901"><a href="#cb375-2901" aria-hidden="true" tabindex="-1"></a>    peptide_count: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb375-2902"><a href="#cb375-2902" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2903"><a href="#cb375-2903" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_mass <span class="kw">in</span> <span class="bu">range</span>(LIGHTEST_AMINO_ACID, target_mass <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-2904"><a href="#cb375-2904" aria-hidden="true" tabindex="-1"></a>        peptide_count[current_mass] <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES <span class="cf">if</span> amino_acid_mass <span class="op">==</span> current_mass)</span>
<span id="cb375-2905"><a href="#cb375-2905" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-2906"><a href="#cb375-2906" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb375-2907"><a href="#cb375-2907" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_mass <span class="op">&gt;=</span> amino_acid_mass:</span>
<span id="cb375-2908"><a href="#cb375-2908" aria-hidden="true" tabindex="-1"></a>                peptide_count[current_mass] <span class="op">+=</span> peptide_count[current_mass <span class="op">-</span> amino_acid_mass]</span>
<span id="cb375-2909"><a href="#cb375-2909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2910"><a href="#cb375-2910" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide_count[target_mass]</span>
<span id="cb375-2911"><a href="#cb375-2911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2912"><a href="#cb375-2912" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2913"><a href="#cb375-2913" aria-hidden="true" tabindex="-1"></a><span class="st">1024</span></span>
<span id="cb375-2914"><a href="#cb375-2914" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-2915"><a href="#cb375-2915" aria-hidden="true" tabindex="-1"></a>target_peptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(sample_input.strip())</span>
<span id="cb375-2916"><a href="#cb375-2916" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> count_possible_peptides(target_peptide_mass)</span>
<span id="cb375-2917"><a href="#cb375-2917" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-2918"><a href="#cb375-2918" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2919"><a href="#cb375-2919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2920"><a href="#cb375-2920" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Cyclic Peptide with Theoretical Spectrum Matching an Ideal Spectrum</span></span>
<span id="cb375-2921"><a href="#cb375-2921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2922"><a href="#cb375-2922" aria-hidden="true" tabindex="-1"></a>Cyclopeptide Sequencing Problem, Given an ideal experimental spectrum, find a cyclic peptide whose theoretical spectrum matches the experimental spectrum.</span>
<span id="cb375-2923"><a href="#cb375-2923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2924"><a href="#cb375-2924" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of (possibly repeated) integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>&nbsp;corresponding to an ideal experimental spectrum.</span>
<span id="cb375-2925"><a href="#cb375-2925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2926"><a href="#cb375-2926" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;Every amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;such that&nbsp;<span class="op">*</span>Cyclospectrum<span class="op">*</span>(<span class="op">*</span>Peptide<span class="op">*</span>) <span class="op">=</span>&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>&nbsp;(<span class="cf">if</span> such a string exists).</span>
<span id="cb375-2927"><a href="#cb375-2927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2928"><a href="#cb375-2928" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-2929"><a href="#cb375-2929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2930"><a href="#cb375-2930" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2931"><a href="#cb375-2931" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">113</span> <span class="dv">128</span> <span class="dv">186</span> <span class="dv">241</span> <span class="dv">299</span> <span class="dv">314</span> <span class="dv">427</span></span>
<span id="cb375-2932"><a href="#cb375-2932" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2933"><a href="#cb375-2933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2934"><a href="#cb375-2934" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-2935"><a href="#cb375-2935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2936"><a href="#cb375-2936" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2937"><a href="#cb375-2937" aria-hidden="true" tabindex="-1"></a><span class="dv">113</span><span class="op">-</span><span class="dv">128</span><span class="op">-</span><span class="dv">186</span> <span class="dv">113</span><span class="op">-</span><span class="dv">186</span><span class="op">-</span><span class="dv">128</span> <span class="dv">186</span><span class="op">-</span><span class="dv">128</span><span class="op">-</span><span class="dv">113</span> <span class="dv">128</span><span class="op">-</span><span class="dv">186</span><span class="op">-</span><span class="dv">113</span> <span class="dv">186</span><span class="op">-</span><span class="dv">113</span><span class="op">-</span><span class="dv">128</span> <span class="dv">128</span><span class="op">-</span><span class="dv">113</span><span class="op">-</span><span class="dv">186</span></span>
<span id="cb375-2938"><a href="#cb375-2938" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-2939"><a href="#cb375-2939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2940"><a href="#cb375-2940" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-2941"><a href="#cb375-2941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2942"><a href="#cb375-2942" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-2943"><a href="#cb375-2943" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set</span>
<span id="cb375-2944"><a href="#cb375-2944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2945"><a href="#cb375-2945" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb375-2946"><a href="#cb375-2946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2947"><a href="#cb375-2947" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-2948"><a href="#cb375-2948" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb375-2949"><a href="#cb375-2949" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb375-2950"><a href="#cb375-2950" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb375-2951"><a href="#cb375-2951" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-2952"><a href="#cb375-2952" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb375-2953"><a href="#cb375-2953" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb375-2954"><a href="#cb375-2954" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb375-2955"><a href="#cb375-2955" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb375-2956"><a href="#cb375-2956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2957"><a href="#cb375-2957" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-2958"><a href="#cb375-2958" aria-hidden="true" tabindex="-1"></a>    prefix_mass: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-2959"><a href="#cb375-2959" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> peptide:</span>
<span id="cb375-2960"><a href="#cb375-2960" aria-hidden="true" tabindex="-1"></a>        prefix_mass.append(prefix_mass[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> mass)</span>
<span id="cb375-2961"><a href="#cb375-2961" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-2962"><a href="#cb375-2962" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-2963"><a href="#cb375-2963" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-2964"><a href="#cb375-2964" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(prefix_mass[j] <span class="op">-</span> prefix_mass[i])</span>
<span id="cb375-2965"><a href="#cb375-2965" aria-hidden="true" tabindex="-1"></a>    linear_spectrum.sort()</span>
<span id="cb375-2966"><a href="#cb375-2966" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_spectrum</span>
<span id="cb375-2967"><a href="#cb375-2967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2968"><a href="#cb375-2968" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-2969"><a href="#cb375-2969" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-2970"><a href="#cb375-2970" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb375-2971"><a href="#cb375-2971" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb375-2972"><a href="#cb375-2972" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb375-2973"><a href="#cb375-2973" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb375-2974"><a href="#cb375-2974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2975"><a href="#cb375-2975" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb375-2976"><a href="#cb375-2976" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> AMINO_ACID_MASSES[<span class="dv">0</span>]:</span>
<span id="cb375-2977"><a href="#cb375-2977" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb375-2978"><a href="#cb375-2978" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb375-2979"><a href="#cb375-2979" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(mass <span class="kw">in</span> spectrum <span class="cf">for</span> mass <span class="kw">in</span> peptide_spectrum)</span>
<span id="cb375-2980"><a href="#cb375-2980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2981"><a href="#cb375-2981" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb375-2982"><a href="#cb375-2982" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb375-2983"><a href="#cb375-2983" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-2984"><a href="#cb375-2984" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2985"><a href="#cb375-2985" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb375-2986"><a href="#cb375-2986" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb375-2987"><a href="#cb375-2987" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb375-2988"><a href="#cb375-2988" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb375-2989"><a href="#cb375-2989" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb375-2990"><a href="#cb375-2990" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb375-2991"><a href="#cb375-2991" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb375-2992"><a href="#cb375-2992" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb375-2993"><a href="#cb375-2993" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb375-2994"><a href="#cb375-2994" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-2995"><a href="#cb375-2995" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb375-2996"><a href="#cb375-2996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-2997"><a href="#cb375-2997" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-2998"><a href="#cb375-2998" aria-hidden="true" tabindex="-1"></a><span class="st">0 113 128 186 241 299 314 427</span></span>
<span id="cb375-2999"><a href="#cb375-2999" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3000"><a href="#cb375-3000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3001"><a href="#cb375-3001" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb375-3002"><a href="#cb375-3002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3003"><a href="#cb375-3003" aria-hidden="true" tabindex="-1"></a>result: Set[<span class="bu">str</span>] <span class="op">=</span> cyclopeptide_sequencing(input_spectrum)</span>
<span id="cb375-3004"><a href="#cb375-3004" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span>
<span id="cb375-3005"><a href="#cb375-3005" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3006"><a href="#cb375-3006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3007"><a href="#cb375-3007" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Score of a Cyclic Peptide Against a Spectrum</span></span>
<span id="cb375-3008"><a href="#cb375-3008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3009"><a href="#cb375-3009" aria-hidden="true" tabindex="-1"></a>Cyclic Peptide Scoring Problem, Compute the score of a cyclic peptide against a spectrum.</span>
<span id="cb375-3010"><a href="#cb375-3010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3011"><a href="#cb375-3011" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;and a collection of integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb375-3012"><a href="#cb375-3012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3013"><a href="#cb375-3013" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The score of&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;against&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>,&nbsp;<span class="op">*</span>Score<span class="op">*</span>(<span class="op">*</span>Peptide<span class="op">*</span>,&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>).</span>
<span id="cb375-3014"><a href="#cb375-3014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3015"><a href="#cb375-3015" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3016"><a href="#cb375-3016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3017"><a href="#cb375-3017" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3018"><a href="#cb375-3018" aria-hidden="true" tabindex="-1"></a>NQEL</span>
<span id="cb375-3019"><a href="#cb375-3019" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">99</span> <span class="dv">113</span> <span class="dv">114</span> <span class="dv">128</span> <span class="dv">227</span> <span class="dv">257</span> <span class="dv">299</span> <span class="dv">355</span> <span class="dv">356</span> <span class="dv">370</span> <span class="dv">371</span> <span class="dv">484</span></span>
<span id="cb375-3020"><a href="#cb375-3020" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3021"><a href="#cb375-3021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3022"><a href="#cb375-3022" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3023"><a href="#cb375-3023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3024"><a href="#cb375-3024" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3025"><a href="#cb375-3025" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span></span>
<span id="cb375-3026"><a href="#cb375-3026" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3027"><a href="#cb375-3027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3028"><a href="#cb375-3028" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3029"><a href="#cb375-3029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3030"><a href="#cb375-3030" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3031"><a href="#cb375-3031" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-3032"><a href="#cb375-3032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3033"><a href="#cb375-3033" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-3034"><a href="#cb375-3034" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-3035"><a href="#cb375-3035" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-3036"><a href="#cb375-3036" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-3037"><a href="#cb375-3037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3038"><a href="#cb375-3038" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3039"><a href="#cb375-3039" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> peptide)</span>
<span id="cb375-3040"><a href="#cb375-3040" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb375-3041"><a href="#cb375-3041" aria-hidden="true" tabindex="-1"></a>    extended_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb375-3042"><a href="#cb375-3042" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3043"><a href="#cb375-3043" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb375-3044"><a href="#cb375-3044" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-3045"><a href="#cb375-3045" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb375-3046"><a href="#cb375-3046" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> subpeptide)</span>
<span id="cb375-3047"><a href="#cb375-3047" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb375-3048"><a href="#cb375-3048" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3049"><a href="#cb375-3049" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb375-3050"><a href="#cb375-3050" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb375-3051"><a href="#cb375-3051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3052"><a href="#cb375-3052" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-3053"><a href="#cb375-3053" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb375-3054"><a href="#cb375-3054" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-3055"><a href="#cb375-3055" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb375-3056"><a href="#cb375-3056" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3057"><a href="#cb375-3057" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb375-3058"><a href="#cb375-3058" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb375-3059"><a href="#cb375-3059" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3060"><a href="#cb375-3060" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb375-3061"><a href="#cb375-3061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3062"><a href="#cb375-3062" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3063"><a href="#cb375-3063" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb375-3064"><a href="#cb375-3064" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb375-3065"><a href="#cb375-3065" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3066"><a href="#cb375-3066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3067"><a href="#cb375-3067" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-3068"><a href="#cb375-3068" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-3069"><a href="#cb375-3069" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb375-3070"><a href="#cb375-3070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3071"><a href="#cb375-3071" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_score(input_peptide, input_spectrum)</span>
<span id="cb375-3072"><a href="#cb375-3072" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-3073"><a href="#cb375-3073" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3074"><a href="#cb375-3074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3075"><a href="#cb375-3075" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement LeaderboardCyclopeptideSequencing</span></span>
<span id="cb375-3076"><a href="#cb375-3076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3077"><a href="#cb375-3077" aria-hidden="true" tabindex="-1"></a>Implement&nbsp;<span class="op">*</span>LeaderboardCyclopeptideSequencing<span class="op">*</span></span>
<span id="cb375-3078"><a href="#cb375-3078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3079"><a href="#cb375-3079" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>N<span class="op">*</span>&nbsp;and a collection of integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb375-3080"><a href="#cb375-3080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3081"><a href="#cb375-3081" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>LeaderPeptide<span class="op">*</span>&nbsp;after running&nbsp;<span class="op">*</span>LeaderboardCyclopeptideSequencing<span class="op">*</span>(<span class="op">*</span>Spectrum<span class="op">*</span>,&nbsp;<span class="op">*</span>N<span class="op">*</span>).</span>
<span id="cb375-3082"><a href="#cb375-3082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3083"><a href="#cb375-3083" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3084"><a href="#cb375-3084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3085"><a href="#cb375-3085" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3086"><a href="#cb375-3086" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span>
<span id="cb375-3087"><a href="#cb375-3087" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">71</span> <span class="dv">113</span> <span class="dv">129</span> <span class="dv">147</span> <span class="dv">200</span> <span class="dv">218</span> <span class="dv">260</span> <span class="dv">313</span> <span class="dv">331</span> <span class="dv">347</span> <span class="dv">389</span> <span class="dv">460</span></span>
<span id="cb375-3088"><a href="#cb375-3088" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3089"><a href="#cb375-3089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3090"><a href="#cb375-3090" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3091"><a href="#cb375-3091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3092"><a href="#cb375-3092" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3093"><a href="#cb375-3093" aria-hidden="true" tabindex="-1"></a><span class="dv">113</span><span class="op">-</span><span class="dv">147</span><span class="op">-</span><span class="dv">71</span><span class="op">-</span><span class="dv">129</span></span>
<span id="cb375-3094"><a href="#cb375-3094" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3095"><a href="#cb375-3095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3096"><a href="#cb375-3096" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3097"><a href="#cb375-3097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3098"><a href="#cb375-3098" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3099"><a href="#cb375-3099" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Dict</span>
<span id="cb375-3100"><a href="#cb375-3100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3101"><a href="#cb375-3101" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb375-3102"><a href="#cb375-3102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3103"><a href="#cb375-3103" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-3104"><a href="#cb375-3104" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-3105"><a href="#cb375-3105" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb375-3106"><a href="#cb375-3106" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb375-3107"><a href="#cb375-3107" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb375-3108"><a href="#cb375-3108" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb375-3109"><a href="#cb375-3109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3110"><a href="#cb375-3110" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3111"><a href="#cb375-3111" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(peptide)</span>
<span id="cb375-3112"><a href="#cb375-3112" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb375-3113"><a href="#cb375-3113" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb375-3114"><a href="#cb375-3114" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3115"><a href="#cb375-3115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb375-3116"><a href="#cb375-3116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-3117"><a href="#cb375-3117" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb375-3118"><a href="#cb375-3118" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(subpeptide)</span>
<span id="cb375-3119"><a href="#cb375-3119" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb375-3120"><a href="#cb375-3120" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3121"><a href="#cb375-3121" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb375-3122"><a href="#cb375-3122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb375-3123"><a href="#cb375-3123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3124"><a href="#cb375-3124" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb375-3125"><a href="#cb375-3125" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb375-3126"><a href="#cb375-3126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(peptide_spectrum.count(mass) <span class="op">&lt;=</span> spectrum.count(mass) <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(peptide_spectrum))</span>
<span id="cb375-3127"><a href="#cb375-3127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3128"><a href="#cb375-3128" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb375-3129"><a href="#cb375-3129" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-3130"><a href="#cb375-3130" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb375-3131"><a href="#cb375-3131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb375-3132"><a href="#cb375-3132" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb375-3133"><a href="#cb375-3133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb375-3134"><a href="#cb375-3134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb375-3135"><a href="#cb375-3135" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb375-3136"><a href="#cb375-3136" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb375-3137"><a href="#cb375-3137" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb375-3138"><a href="#cb375-3138" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb375-3139"><a href="#cb375-3139" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb375-3140"><a href="#cb375-3140" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb375-3141"><a href="#cb375-3141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3142"><a href="#cb375-3142" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-3143"><a href="#cb375-3143" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb375-3144"><a href="#cb375-3144" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-3145"><a href="#cb375-3145" aria-hidden="true" tabindex="-1"></a>    unique_masses: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb375-3146"><a href="#cb375-3146" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb375-3147"><a href="#cb375-3147" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb375-3148"><a href="#cb375-3148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb375-3149"><a href="#cb375-3149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3150"><a href="#cb375-3150" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-3151"><a href="#cb375-3151" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb375-3152"><a href="#cb375-3152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb375-3153"><a href="#cb375-3153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3154"><a href="#cb375-3154" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-3155"><a href="#cb375-3155" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb375-3156"><a href="#cb375-3156" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb375-3157"><a href="#cb375-3157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3158"><a href="#cb375-3158" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-3159"><a href="#cb375-3159" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="bu">len</span>(sorted_scores) <span class="cf">else</span> sorted_scores[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-3160"><a href="#cb375-3160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3161"><a href="#cb375-3161" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb375-3162"><a href="#cb375-3162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3163"><a href="#cb375-3163" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaderboard_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3164"><a href="#cb375-3164" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb375-3165"><a href="#cb375-3165" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-3166"><a href="#cb375-3166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3167"><a href="#cb375-3167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb375-3168"><a href="#cb375-3168" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard)</span>
<span id="cb375-3169"><a href="#cb375-3169" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb375-3170"><a href="#cb375-3170" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb375-3171"><a href="#cb375-3171" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb375-3172"><a href="#cb375-3172" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb375-3173"><a href="#cb375-3173" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb375-3174"><a href="#cb375-3174" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb375-3175"><a href="#cb375-3175" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb375-3176"><a href="#cb375-3176" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb375-3177"><a href="#cb375-3177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3178"><a href="#cb375-3178" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3179"><a href="#cb375-3179" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb375-3180"><a href="#cb375-3180" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 113 129 147 200 218 260 313 331 347 389 460</span></span>
<span id="cb375-3181"><a href="#cb375-3181" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3182"><a href="#cb375-3182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3183"><a href="#cb375-3183" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-3184"><a href="#cb375-3184" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb375-3185"><a href="#cb375-3185" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb375-3186"><a href="#cb375-3186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3187"><a href="#cb375-3187" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> leaderboard_cyclopeptide_sequencing(spectrum, n)</span>
<span id="cb375-3188"><a href="#cb375-3188" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb375-3189"><a href="#cb375-3189" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3190"><a href="#cb375-3190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3191"><a href="#cb375-3191" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the Convolution of a Spectrum</span></span>
<span id="cb375-3192"><a href="#cb375-3192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3193"><a href="#cb375-3193" aria-hidden="true" tabindex="-1"></a>Spectral Convolution Problem, Compute the convolution of a spectrum.</span>
<span id="cb375-3194"><a href="#cb375-3194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3195"><a href="#cb375-3195" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb375-3196"><a href="#cb375-3196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3197"><a href="#cb375-3197" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The <span class="bu">list</span> of elements <span class="kw">in</span> the convolution of&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>&nbsp;in decreasing order of their multiplicities. If an element has multiplicity&nbsp;<span class="op">*</span>k<span class="op">*</span>, it should appear exactly&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;times.</span>
<span id="cb375-3198"><a href="#cb375-3198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3199"><a href="#cb375-3199" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3200"><a href="#cb375-3200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3201"><a href="#cb375-3201" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3202"><a href="#cb375-3202" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">137</span> <span class="dv">186</span> <span class="dv">323</span></span>
<span id="cb375-3203"><a href="#cb375-3203" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3204"><a href="#cb375-3204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3205"><a href="#cb375-3205" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3206"><a href="#cb375-3206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3207"><a href="#cb375-3207" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3208"><a href="#cb375-3208" aria-hidden="true" tabindex="-1"></a><span class="dv">137</span> <span class="dv">137</span> <span class="dv">186</span> <span class="dv">186</span> <span class="dv">323</span> <span class="dv">49</span></span>
<span id="cb375-3209"><a href="#cb375-3209" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3210"><a href="#cb375-3210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3211"><a href="#cb375-3211" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3212"><a href="#cb375-3212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3213"><a href="#cb375-3213" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3214"><a href="#cb375-3214" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb375-3215"><a href="#cb375-3215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3216"><a href="#cb375-3216" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3217"><a href="#cb375-3217" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb375-3218"><a href="#cb375-3218" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-3219"><a href="#cb375-3219" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3220"><a href="#cb375-3220" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb375-3221"><a href="#cb375-3221" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(spectrum)):</span>
<span id="cb375-3222"><a href="#cb375-3222" aria-hidden="true" tabindex="-1"></a>            mass_difference: <span class="bu">int</span> <span class="op">=</span> spectrum[j] <span class="op">-</span> spectrum[i]</span>
<span id="cb375-3223"><a href="#cb375-3223" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mass_difference <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb375-3224"><a href="#cb375-3224" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(mass_difference)</span>
<span id="cb375-3225"><a href="#cb375-3225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3226"><a href="#cb375-3226" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-3227"><a href="#cb375-3227" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb375-3228"><a href="#cb375-3228" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb375-3229"><a href="#cb375-3229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3230"><a href="#cb375-3230" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict, key<span class="op">=</span>frequency_dict.get, reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-3231"><a href="#cb375-3231" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3232"><a href="#cb375-3232" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-3233"><a href="#cb375-3233" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb375-3234"><a href="#cb375-3234" aria-hidden="true" tabindex="-1"></a>        result.extend([mass] <span class="op">*</span> frequency_dict[mass])</span>
<span id="cb375-3235"><a href="#cb375-3235" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3236"><a href="#cb375-3236" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb375-3237"><a href="#cb375-3237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3238"><a href="#cb375-3238" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3239"><a href="#cb375-3239" aria-hidden="true" tabindex="-1"></a><span class="st">0 137 186 323</span></span>
<span id="cb375-3240"><a href="#cb375-3240" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3241"><a href="#cb375-3241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3242"><a href="#cb375-3242" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb375-3243"><a href="#cb375-3243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3244"><a href="#cb375-3244" aria-hidden="true" tabindex="-1"></a>convolution_result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(input_spectrum)</span>
<span id="cb375-3245"><a href="#cb375-3245" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, convolution_result)))</span>
<span id="cb375-3246"><a href="#cb375-3246" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3247"><a href="#cb375-3247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3248"><a href="#cb375-3248" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement ConvolutionCyclopeptideSequencing</span></span>
<span id="cb375-3249"><a href="#cb375-3249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3250"><a href="#cb375-3250" aria-hidden="true" tabindex="-1"></a>Implement&nbsp;<span class="op">*</span>ConvolutionCyclopeptideSequencing<span class="op">*</span>.</span>
<span id="cb375-3251"><a href="#cb375-3251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3252"><a href="#cb375-3252" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>M<span class="op">*</span>, an integer&nbsp;<span class="op">*</span>N<span class="op">*</span>, <span class="kw">and</span> a collection of (possibly repeated) integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb375-3253"><a href="#cb375-3253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3254"><a href="#cb375-3254" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A cyclic peptide LeaderPeptide <span class="cf">with</span> amino acids taken only <span class="im">from</span> the top&nbsp;<span class="op">*</span>M<span class="op">*</span>&nbsp;elements (<span class="kw">and</span> ties) of the convolution of&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>&nbsp;that fall between <span class="dv">57</span> <span class="kw">and</span> <span class="dv">200</span>, <span class="kw">and</span> where the size of&nbsp;<span class="op">*</span>Leaderboard<span class="op">*</span>&nbsp;is restricted to the top&nbsp;<span class="op">*</span>N<span class="op">*</span>&nbsp;(<span class="kw">and</span> ties).</span>
<span id="cb375-3255"><a href="#cb375-3255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3256"><a href="#cb375-3256" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3257"><a href="#cb375-3257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3258"><a href="#cb375-3258" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3259"><a href="#cb375-3259" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span></span>
<span id="cb375-3260"><a href="#cb375-3260" aria-hidden="true" tabindex="-1"></a><span class="dv">60</span></span>
<span id="cb375-3261"><a href="#cb375-3261" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span> <span class="dv">57</span> <span class="dv">71</span> <span class="dv">99</span> <span class="dv">129</span> <span class="dv">137</span> <span class="dv">170</span> <span class="dv">186</span> <span class="dv">194</span> <span class="dv">208</span> <span class="dv">228</span> <span class="dv">265</span> <span class="dv">285</span> <span class="dv">299</span> <span class="dv">307</span> <span class="dv">323</span> <span class="dv">356</span> <span class="dv">364</span> <span class="dv">394</span> <span class="dv">422</span> <span class="dv">493</span></span>
<span id="cb375-3262"><a href="#cb375-3262" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3263"><a href="#cb375-3263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3264"><a href="#cb375-3264" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3265"><a href="#cb375-3265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3266"><a href="#cb375-3266" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3267"><a href="#cb375-3267" aria-hidden="true" tabindex="-1"></a><span class="dv">99</span><span class="op">-</span><span class="dv">71</span><span class="op">-</span><span class="dv">137</span><span class="op">-</span><span class="dv">57</span><span class="op">-</span><span class="dv">72</span><span class="op">-</span><span class="dv">57</span></span>
<span id="cb375-3268"><a href="#cb375-3268" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3269"><a href="#cb375-3269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3270"><a href="#cb375-3270" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3271"><a href="#cb375-3271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3272"><a href="#cb375-3272" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3273"><a href="#cb375-3273" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-3274"><a href="#cb375-3274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3275"><a href="#cb375-3275" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3276"><a href="#cb375-3276" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb375-3277"><a href="#cb375-3277" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-3278"><a href="#cb375-3278" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb375-3279"><a href="#cb375-3279" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectrum)):</span>
<span id="cb375-3280"><a href="#cb375-3280" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spectrum[j] <span class="op">-</span> spectrum[i] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb375-3281"><a href="#cb375-3281" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(spectrum[j] <span class="op">-</span> spectrum[i])</span>
<span id="cb375-3282"><a href="#cb375-3282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3283"><a href="#cb375-3283" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-3284"><a href="#cb375-3284" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb375-3285"><a href="#cb375-3285" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb375-3286"><a href="#cb375-3286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3287"><a href="#cb375-3287" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> [k <span class="cf">for</span> k, _ <span class="kw">in</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> item: item[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb375-3288"><a href="#cb375-3288" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-3289"><a href="#cb375-3289" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb375-3290"><a href="#cb375-3290" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> [mass] <span class="op">*</span> frequency_dict[mass]</span>
<span id="cb375-3291"><a href="#cb375-3291" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb375-3292"><a href="#cb375-3292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3293"><a href="#cb375-3293" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-3294"><a href="#cb375-3294" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb375-3295"><a href="#cb375-3295" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb375-3296"><a href="#cb375-3296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3297"><a href="#cb375-3297" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-3298"><a href="#cb375-3298" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb375-3299"><a href="#cb375-3299" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb375-3300"><a href="#cb375-3300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3301"><a href="#cb375-3301" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-3302"><a href="#cb375-3302" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-3303"><a href="#cb375-3303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3304"><a href="#cb375-3304" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb375-3305"><a href="#cb375-3305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3306"><a href="#cb375-3306" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3307"><a href="#cb375-3307" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb375-3308"><a href="#cb375-3308" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb375-3309"><a href="#cb375-3309" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb375-3310"><a href="#cb375-3310" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-3311"><a href="#cb375-3311" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb375-3312"><a href="#cb375-3312" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb375-3313"><a href="#cb375-3313" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb375-3314"><a href="#cb375-3314" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb375-3315"><a href="#cb375-3315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3316"><a href="#cb375-3316" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-3317"><a href="#cb375-3317" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb375-3318"><a href="#cb375-3318" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-3319"><a href="#cb375-3319" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb375-3320"><a href="#cb375-3320" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb375-3321"><a href="#cb375-3321" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb375-3322"><a href="#cb375-3322" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb375-3323"><a href="#cb375-3323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3324"><a href="#cb375-3324" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_top_masses(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3325"><a href="#cb375-3325" aria-hidden="true" tabindex="-1"></a>    convolution: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(spectrum)</span>
<span id="cb375-3326"><a href="#cb375-3326" aria-hidden="true" tabindex="-1"></a>    filtered_convolution: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> convolution <span class="cf">if</span> <span class="dv">57</span> <span class="op">&lt;=</span> x <span class="op">&lt;=</span> <span class="dv">200</span>]</span>
<span id="cb375-3327"><a href="#cb375-3327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3328"><a href="#cb375-3328" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-3329"><a href="#cb375-3329" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(filtered_convolution):</span>
<span id="cb375-3330"><a href="#cb375-3330" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> filtered_convolution.count(mass)</span>
<span id="cb375-3331"><a href="#cb375-3331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3332"><a href="#cb375-3332" aria-hidden="true" tabindex="-1"></a>    sorted_elements: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> kv: kv[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-3333"><a href="#cb375-3333" aria-hidden="true" tabindex="-1"></a>    top_masses: List[<span class="bu">int</span>] <span class="op">=</span> [mass <span class="cf">for</span> mass, freq <span class="kw">in</span> sorted_elements <span class="cf">if</span> freq <span class="op">&gt;=</span> sorted_elements[m <span class="op">-</span> <span class="dv">1</span>][<span class="dv">1</span>]]</span>
<span id="cb375-3334"><a href="#cb375-3334" aria-hidden="true" tabindex="-1"></a>    top_masses.sort()</span>
<span id="cb375-3335"><a href="#cb375-3335" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> top_masses</span>
<span id="cb375-3336"><a href="#cb375-3336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3337"><a href="#cb375-3337" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]], masses: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-3338"><a href="#cb375-3338" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-3339"><a href="#cb375-3339" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb375-3340"><a href="#cb375-3340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> masses:</span>
<span id="cb375-3341"><a href="#cb375-3341" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb375-3342"><a href="#cb375-3342" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb375-3343"><a href="#cb375-3343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3344"><a href="#cb375-3344" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convolution_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>, n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3345"><a href="#cb375-3345" aria-hidden="true" tabindex="-1"></a>    masses: List[<span class="bu">int</span>] <span class="op">=</span> find_top_masses(spectrum, m)</span>
<span id="cb375-3346"><a href="#cb375-3346" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb375-3347"><a href="#cb375-3347" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-3348"><a href="#cb375-3348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3349"><a href="#cb375-3349" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb375-3350"><a href="#cb375-3350" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard, masses)</span>
<span id="cb375-3351"><a href="#cb375-3351" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb375-3352"><a href="#cb375-3352" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb375-3353"><a href="#cb375-3353" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb375-3354"><a href="#cb375-3354" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb375-3355"><a href="#cb375-3355" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb375-3356"><a href="#cb375-3356" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb375-3357"><a href="#cb375-3357" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb375-3358"><a href="#cb375-3358" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb375-3359"><a href="#cb375-3359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3360"><a href="#cb375-3360" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3361"><a href="#cb375-3361" aria-hidden="true" tabindex="-1"></a><span class="st">20</span></span>
<span id="cb375-3362"><a href="#cb375-3362" aria-hidden="true" tabindex="-1"></a><span class="st">60</span></span>
<span id="cb375-3363"><a href="#cb375-3363" aria-hidden="true" tabindex="-1"></a><span class="st">57 57 71 99 129 137 170 186 194 208 228 265 285 299 307 323 356 364 394 422 493</span></span>
<span id="cb375-3364"><a href="#cb375-3364" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3365"><a href="#cb375-3365" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-3366"><a href="#cb375-3366" aria-hidden="true" tabindex="-1"></a>m: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb375-3367"><a href="#cb375-3367" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb375-3368"><a href="#cb375-3368" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">2</span>].split()]</span>
<span id="cb375-3369"><a href="#cb375-3369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3370"><a href="#cb375-3370" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> convolution_cyclopeptide_sequencing(spectrum, m, n)</span>
<span id="cb375-3371"><a href="#cb375-3371" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb375-3372"><a href="#cb375-3372" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3373"><a href="#cb375-3373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3374"><a href="#cb375-3374" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the Theoretical Spectrum of a Linear Peptide</span></span>
<span id="cb375-3375"><a href="#cb375-3375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3376"><a href="#cb375-3376" aria-hidden="true" tabindex="-1"></a>Linear Spectrum Problem, Generate the ideal linear spectrum of a peptide.</span>
<span id="cb375-3377"><a href="#cb375-3377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3378"><a href="#cb375-3378" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An&nbsp;[amino acid string](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb375-3379"><a href="#cb375-3379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3380"><a href="#cb375-3380" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The linear spectrum of&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>.</span>
<span id="cb375-3381"><a href="#cb375-3381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3382"><a href="#cb375-3382" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3383"><a href="#cb375-3383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3384"><a href="#cb375-3384" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3385"><a href="#cb375-3385" aria-hidden="true" tabindex="-1"></a>NQEL</span>
<span id="cb375-3386"><a href="#cb375-3386" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3387"><a href="#cb375-3387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3388"><a href="#cb375-3388" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3389"><a href="#cb375-3389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3390"><a href="#cb375-3390" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3391"><a href="#cb375-3391" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">113</span> <span class="dv">114</span> <span class="dv">128</span> <span class="dv">129</span> <span class="dv">242</span> <span class="dv">242</span> <span class="dv">257</span> <span class="dv">370</span> <span class="dv">371</span> <span class="dv">484</span></span>
<span id="cb375-3392"><a href="#cb375-3392" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3393"><a href="#cb375-3393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3394"><a href="#cb375-3394" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3395"><a href="#cb375-3395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3396"><a href="#cb375-3396" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3397"><a href="#cb375-3397" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb375-3398"><a href="#cb375-3398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3399"><a href="#cb375-3399" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-3400"><a href="#cb375-3400" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb375-3401"><a href="#cb375-3401" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb375-3402"><a href="#cb375-3402" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-3403"><a href="#cb375-3403" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-3404"><a href="#cb375-3404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3405"><a href="#cb375-3405" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3406"><a href="#cb375-3406" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-3407"><a href="#cb375-3407" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3408"><a href="#cb375-3408" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb375-3409"><a href="#cb375-3409" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb375-3410"><a href="#cb375-3410" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb375-3411"><a href="#cb375-3411" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3412"><a href="#cb375-3412" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-3413"><a href="#cb375-3413" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3414"><a href="#cb375-3414" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-3415"><a href="#cb375-3415" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3416"><a href="#cb375-3416" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb375-3417"><a href="#cb375-3417" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb375-3418"><a href="#cb375-3418" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3419"><a href="#cb375-3419" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb375-3420"><a href="#cb375-3420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3421"><a href="#cb375-3421" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-3422"><a href="#cb375-3422" aria-hidden="true" tabindex="-1"></a>sample_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">"NQEL"</span></span>
<span id="cb375-3423"><a href="#cb375-3423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3424"><a href="#cb375-3424" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear spectrum</span></span>
<span id="cb375-3425"><a href="#cb375-3425" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(sample_peptide)</span>
<span id="cb375-3426"><a href="#cb375-3426" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb375-3427"><a href="#cb375-3427" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3428"><a href="#cb375-3428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3429"><a href="#cb375-3429" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Score of a Linear Peptide</span></span>
<span id="cb375-3430"><a href="#cb375-3430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3431"><a href="#cb375-3431" aria-hidden="true" tabindex="-1"></a>Linear Peptide Scoring Problem, Compute the score of a linear peptide <span class="cf">with</span> respect to a spectrum.</span>
<span id="cb375-3432"><a href="#cb375-3432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3433"><a href="#cb375-3433" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An amino acid string&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;and a collection of integers&nbsp;<span class="op">*</span>LinearSpectrum<span class="op">*</span>.</span>
<span id="cb375-3434"><a href="#cb375-3434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3435"><a href="#cb375-3435" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The linear score of&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>&nbsp;against&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>,&nbsp;<span class="op">*</span>LinearScore<span class="op">*</span>(<span class="op">*</span>Peptide<span class="op">*</span>,&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>).</span>
<span id="cb375-3436"><a href="#cb375-3436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3437"><a href="#cb375-3437" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3438"><a href="#cb375-3438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3439"><a href="#cb375-3439" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3440"><a href="#cb375-3440" aria-hidden="true" tabindex="-1"></a>NQEL</span>
<span id="cb375-3441"><a href="#cb375-3441" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">99</span> <span class="dv">113</span> <span class="dv">114</span> <span class="dv">128</span> <span class="dv">227</span> <span class="dv">257</span> <span class="dv">299</span> <span class="dv">355</span> <span class="dv">356</span> <span class="dv">370</span> <span class="dv">371</span> <span class="dv">484</span></span>
<span id="cb375-3442"><a href="#cb375-3442" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3443"><a href="#cb375-3443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3444"><a href="#cb375-3444" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3445"><a href="#cb375-3445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3446"><a href="#cb375-3446" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3447"><a href="#cb375-3447" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb375-3448"><a href="#cb375-3448" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3449"><a href="#cb375-3449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3450"><a href="#cb375-3450" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3451"><a href="#cb375-3451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3452"><a href="#cb375-3452" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3453"><a href="#cb375-3453" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb375-3454"><a href="#cb375-3454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3455"><a href="#cb375-3455" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-3456"><a href="#cb375-3456" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb375-3457"><a href="#cb375-3457" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb375-3458"><a href="#cb375-3458" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-3459"><a href="#cb375-3459" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-3460"><a href="#cb375-3460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3461"><a href="#cb375-3461" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3462"><a href="#cb375-3462" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-3463"><a href="#cb375-3463" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3464"><a href="#cb375-3464" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb375-3465"><a href="#cb375-3465" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb375-3466"><a href="#cb375-3466" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb375-3467"><a href="#cb375-3467" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3468"><a href="#cb375-3468" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-3469"><a href="#cb375-3469" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3470"><a href="#cb375-3470" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-3471"><a href="#cb375-3471" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3472"><a href="#cb375-3472" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb375-3473"><a href="#cb375-3473" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb375-3474"><a href="#cb375-3474" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3475"><a href="#cb375-3475" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb375-3476"><a href="#cb375-3476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3477"><a href="#cb375-3477" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-3478"><a href="#cb375-3478" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb375-3479"><a href="#cb375-3479" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-3480"><a href="#cb375-3480" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb375-3481"><a href="#cb375-3481" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3482"><a href="#cb375-3482" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb375-3483"><a href="#cb375-3483" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb375-3484"><a href="#cb375-3484" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3485"><a href="#cb375-3485" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb375-3486"><a href="#cb375-3486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3487"><a href="#cb375-3487" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-3488"><a href="#cb375-3488" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3489"><a href="#cb375-3489" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb375-3490"><a href="#cb375-3490" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb375-3491"><a href="#cb375-3491" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3492"><a href="#cb375-3492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3493"><a href="#cb375-3493" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-3494"><a href="#cb375-3494" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-3495"><a href="#cb375-3495" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb375-3496"><a href="#cb375-3496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3497"><a href="#cb375-3497" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear score</span></span>
<span id="cb375-3498"><a href="#cb375-3498" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_linear_score(input_peptide, input_spectrum)</span>
<span id="cb375-3499"><a href="#cb375-3499" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-3500"><a href="#cb375-3500" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3501"><a href="#cb375-3501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3502"><a href="#cb375-3502" aria-hidden="true" tabindex="-1"></a><span class="co"># Trim a Peptide Leaderboard</span></span>
<span id="cb375-3503"><a href="#cb375-3503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3504"><a href="#cb375-3504" aria-hidden="true" tabindex="-1"></a>Trim Problem, Trim a leaderboard of peptides.</span>
<span id="cb375-3505"><a href="#cb375-3505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3506"><a href="#cb375-3506" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A leaderboard of linear peptides&nbsp;<span class="op">*</span>Leaderboard<span class="op">*</span>, a linear spectrum&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>, <span class="kw">and</span> an integer&nbsp;<span class="op">*</span>N<span class="op">*</span>.</span>
<span id="cb375-3507"><a href="#cb375-3507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3508"><a href="#cb375-3508" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The top&nbsp;<span class="op">*</span>N<span class="op">*</span>&nbsp;peptides from&nbsp;<span class="op">*</span>Leaderboard<span class="op">*</span>&nbsp;scored against&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>. Remember to use&nbsp;<span class="op">*</span>LinearScore<span class="op">*</span>.</span>
<span id="cb375-3509"><a href="#cb375-3509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3510"><a href="#cb375-3510" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3511"><a href="#cb375-3511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3512"><a href="#cb375-3512" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3513"><a href="#cb375-3513" aria-hidden="true" tabindex="-1"></a>LAST ALST TLLT TQAS</span>
<span id="cb375-3514"><a href="#cb375-3514" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">71</span> <span class="dv">87</span> <span class="dv">101</span> <span class="dv">113</span> <span class="dv">158</span> <span class="dv">184</span> <span class="dv">188</span> <span class="dv">259</span> <span class="dv">271</span> <span class="dv">372</span></span>
<span id="cb375-3515"><a href="#cb375-3515" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb375-3516"><a href="#cb375-3516" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3517"><a href="#cb375-3517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3518"><a href="#cb375-3518" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3519"><a href="#cb375-3519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3520"><a href="#cb375-3520" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3521"><a href="#cb375-3521" aria-hidden="true" tabindex="-1"></a>LAST ALST</span>
<span id="cb375-3522"><a href="#cb375-3522" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3523"><a href="#cb375-3523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3524"><a href="#cb375-3524" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3525"><a href="#cb375-3525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3526"><a href="#cb375-3526" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3527"><a href="#cb375-3527" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb375-3528"><a href="#cb375-3528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3529"><a href="#cb375-3529" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-3530"><a href="#cb375-3530" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb375-3531"><a href="#cb375-3531" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb375-3532"><a href="#cb375-3532" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-3533"><a href="#cb375-3533" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-3534"><a href="#cb375-3534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3535"><a href="#cb375-3535" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3536"><a href="#cb375-3536" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-3537"><a href="#cb375-3537" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3538"><a href="#cb375-3538" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb375-3539"><a href="#cb375-3539" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb375-3540"><a href="#cb375-3540" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb375-3541"><a href="#cb375-3541" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3542"><a href="#cb375-3542" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-3543"><a href="#cb375-3543" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3544"><a href="#cb375-3544" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-3545"><a href="#cb375-3545" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3546"><a href="#cb375-3546" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb375-3547"><a href="#cb375-3547" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb375-3548"><a href="#cb375-3548" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3549"><a href="#cb375-3549" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb375-3550"><a href="#cb375-3550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3551"><a href="#cb375-3551" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-3552"><a href="#cb375-3552" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb375-3553"><a href="#cb375-3553" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-3554"><a href="#cb375-3554" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb375-3555"><a href="#cb375-3555" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3556"><a href="#cb375-3556" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb375-3557"><a href="#cb375-3557" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb375-3558"><a href="#cb375-3558" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3559"><a href="#cb375-3559" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb375-3560"><a href="#cb375-3560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3561"><a href="#cb375-3561" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[<span class="bu">str</span>], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-3562"><a href="#cb375-3562" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb375-3563"><a href="#cb375-3563" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb375-3564"><a href="#cb375-3564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3565"><a href="#cb375-3565" aria-hidden="true" tabindex="-1"></a>    peptide_scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-3566"><a href="#cb375-3566" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb375-3567"><a href="#cb375-3567" aria-hidden="true" tabindex="-1"></a>        peptide_scores[i] <span class="op">=</span> calculate_linear_score(peptide, spectrum)</span>
<span id="cb375-3568"><a href="#cb375-3568" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3569"><a href="#cb375-3569" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(peptide_scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-3570"><a href="#cb375-3570" aria-hidden="true" tabindex="-1"></a>    score_threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-3571"><a href="#cb375-3571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3572"><a href="#cb375-3572" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> peptide_scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> score_threshold]</span>
<span id="cb375-3573"><a href="#cb375-3573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3574"><a href="#cb375-3574" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-3575"><a href="#cb375-3575" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3576"><a href="#cb375-3576" aria-hidden="true" tabindex="-1"></a><span class="st">LAST ALST TLLT TQAS</span></span>
<span id="cb375-3577"><a href="#cb375-3577" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 87 101 113 158 184 188 259 271 372</span></span>
<span id="cb375-3578"><a href="#cb375-3578" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb375-3579"><a href="#cb375-3579" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3580"><a href="#cb375-3580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3581"><a href="#cb375-3581" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-3582"><a href="#cb375-3582" aria-hidden="true" tabindex="-1"></a>input_leaderboard: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">0</span>].split()</span>
<span id="cb375-3583"><a href="#cb375-3583" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb375-3584"><a href="#cb375-3584" aria-hidden="true" tabindex="-1"></a>input_n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb375-3585"><a href="#cb375-3585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3586"><a href="#cb375-3586" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> trim_leaderboard(input_leaderboard, input_spectrum, input_n)</span>
<span id="cb375-3587"><a href="#cb375-3587" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span>
<span id="cb375-3588"><a href="#cb375-3588" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3589"><a href="#cb375-3589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3590"><a href="#cb375-3590" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the Turnpike Problem</span></span>
<span id="cb375-3591"><a href="#cb375-3591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3592"><a href="#cb375-3592" aria-hidden="true" tabindex="-1"></a>Turnpike Problem. Given <span class="bu">all</span> pairwise distances between points on a line segment, reconstruct the positions of those points.</span>
<span id="cb375-3593"><a href="#cb375-3593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3594"><a href="#cb375-3594" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of integers&nbsp;<span class="op">*</span>L<span class="op">*</span>.</span>
<span id="cb375-3595"><a href="#cb375-3595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3596"><a href="#cb375-3596" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A set&nbsp;<span class="op">*</span>A<span class="op">*</span>&nbsp;such that $∆A$&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span>L<span class="op">*</span>.</span>
<span id="cb375-3597"><a href="#cb375-3597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3598"><a href="#cb375-3598" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3599"><a href="#cb375-3599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3600"><a href="#cb375-3600" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3601"><a href="#cb375-3601" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="dv">10</span> <span class="op">-</span><span class="dv">8</span> <span class="op">-</span><span class="dv">7</span> <span class="op">-</span><span class="dv">6</span> <span class="op">-</span><span class="dv">5</span> <span class="op">-</span><span class="dv">4</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">2</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">10</span></span>
<span id="cb375-3602"><a href="#cb375-3602" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3603"><a href="#cb375-3603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3604"><a href="#cb375-3604" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3605"><a href="#cb375-3605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3606"><a href="#cb375-3606" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3607"><a href="#cb375-3607" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">7</span> <span class="dv">10</span></span>
<span id="cb375-3608"><a href="#cb375-3608" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3609"><a href="#cb375-3609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3610"><a href="#cb375-3610" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3611"><a href="#cb375-3611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3612"><a href="#cb375-3612" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3613"><a href="#cb375-3613" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Optional</span>
<span id="cb375-3614"><a href="#cb375-3614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3615"><a href="#cb375-3615" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_absolute_differences(set_a: Set[<span class="bu">int</span>], set_b: Set[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3616"><a href="#cb375-3616" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">abs</span>(a <span class="op">-</span> b) <span class="cf">for</span> a <span class="kw">in</span> set_a <span class="cf">for</span> b <span class="kw">in</span> set_b]</span>
<span id="cb375-3617"><a href="#cb375-3617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3618"><a href="#cb375-3618" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_multiset_subset(subset: List[<span class="bu">int</span>], superset: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb375-3619"><a href="#cb375-3619" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(subset.count(elem) <span class="op">&lt;=</span> superset.count(elem) <span class="cf">for</span> elem <span class="kw">in</span> <span class="bu">set</span>(subset))</span>
<span id="cb375-3620"><a href="#cb375-3620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3621"><a href="#cb375-3621" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiset_difference(set_a: List[<span class="bu">int</span>], set_b: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-3622"><a href="#cb375-3622" aria-hidden="true" tabindex="-1"></a>    difference: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-3623"><a href="#cb375-3623" aria-hidden="true" tabindex="-1"></a>    unique_elements: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(set_a)</span>
<span id="cb375-3624"><a href="#cb375-3624" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> elem <span class="kw">in</span> unique_elements:</span>
<span id="cb375-3625"><a href="#cb375-3625" aria-hidden="true" tabindex="-1"></a>        count_difference <span class="op">=</span> set_a.count(elem) <span class="op">-</span> set_b.count(elem)</span>
<span id="cb375-3626"><a href="#cb375-3626" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count_difference <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-3627"><a href="#cb375-3627" aria-hidden="true" tabindex="-1"></a>            difference.extend([elem] <span class="op">*</span> count_difference)</span>
<span id="cb375-3628"><a href="#cb375-3628" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(difference)</span>
<span id="cb375-3629"><a href="#cb375-3629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3630"><a href="#cb375-3630" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> place_elements(distances: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Optional[Set[<span class="bu">int</span>]]:</span>
<span id="cb375-3631"><a href="#cb375-3631" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> distances:</span>
<span id="cb375-3632"><a href="#cb375-3632" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> placed_elements</span>
<span id="cb375-3633"><a href="#cb375-3633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3634"><a href="#cb375-3634" aria-hidden="true" tabindex="-1"></a>    current_distance: <span class="bu">int</span> <span class="op">=</span> distances[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-3635"><a href="#cb375-3635" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3636"><a href="#cb375-3636" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the left</span></span>
<span id="cb375-3637"><a href="#cb375-3637" aria-hidden="true" tabindex="-1"></a>    left_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({current_distance}, placed_elements)</span>
<span id="cb375-3638"><a href="#cb375-3638" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(left_differences, distances):</span>
<span id="cb375-3639"><a href="#cb375-3639" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(current_distance)</span>
<span id="cb375-3640"><a href="#cb375-3640" aria-hidden="true" tabindex="-1"></a>        remaining_distances_left: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, left_differences)</span>
<span id="cb375-3641"><a href="#cb375-3641" aria-hidden="true" tabindex="-1"></a>        left_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_left)</span>
<span id="cb375-3642"><a href="#cb375-3642" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left_result:</span>
<span id="cb375-3643"><a href="#cb375-3643" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> left_result</span>
<span id="cb375-3644"><a href="#cb375-3644" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(current_distance)</span>
<span id="cb375-3645"><a href="#cb375-3645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3646"><a href="#cb375-3646" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the right</span></span>
<span id="cb375-3647"><a href="#cb375-3647" aria-hidden="true" tabindex="-1"></a>    right_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({total_width <span class="op">-</span> current_distance}, placed_elements)</span>
<span id="cb375-3648"><a href="#cb375-3648" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(right_differences, distances):</span>
<span id="cb375-3649"><a href="#cb375-3649" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(total_width <span class="op">-</span> current_distance)</span>
<span id="cb375-3650"><a href="#cb375-3650" aria-hidden="true" tabindex="-1"></a>        remaining_distances_right: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, right_differences)</span>
<span id="cb375-3651"><a href="#cb375-3651" aria-hidden="true" tabindex="-1"></a>        right_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_right)</span>
<span id="cb375-3652"><a href="#cb375-3652" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> right_result:</span>
<span id="cb375-3653"><a href="#cb375-3653" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> right_result</span>
<span id="cb375-3654"><a href="#cb375-3654" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(total_width <span class="op">-</span> current_distance)</span>
<span id="cb375-3655"><a href="#cb375-3655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3656"><a href="#cb375-3656" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb375-3657"><a href="#cb375-3657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3658"><a href="#cb375-3658" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-3659"><a href="#cb375-3659" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3660"><a href="#cb375-3660" aria-hidden="true" tabindex="-1"></a><span class="st">-10 -8 -7 -6 -5 -4 -3 -3 -2 -2 0 0 0 0 0 2 2 3 3 4 5 6 7 8 10</span></span>
<span id="cb375-3661"><a href="#cb375-3661" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3662"><a href="#cb375-3662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3663"><a href="#cb375-3663" aria-hidden="true" tabindex="-1"></a>input_distances: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb375-3664"><a href="#cb375-3664" aria-hidden="true" tabindex="-1"></a>positive_distances: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> input_distances <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb375-3665"><a href="#cb375-3665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3666"><a href="#cb375-3666" aria-hidden="true" tabindex="-1"></a>total_width: <span class="bu">int</span> <span class="op">=</span> positive_distances.pop(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb375-3667"><a href="#cb375-3667" aria-hidden="true" tabindex="-1"></a>placed_elements: Set[<span class="bu">int</span>] <span class="op">=</span> {<span class="dv">0</span>, total_width}</span>
<span id="cb375-3668"><a href="#cb375-3668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3669"><a href="#cb375-3669" aria-hidden="true" tabindex="-1"></a>result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(positive_distances)</span>
<span id="cb375-3670"><a href="#cb375-3670" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, <span class="bu">sorted</span>(result))))</span>
<span id="cb375-3671"><a href="#cb375-3671" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3672"><a href="#cb375-3672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3673"><a href="#cb375-3673" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Minimum Number of Coins Needed to Make Change</span></span>
<span id="cb375-3674"><a href="#cb375-3674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3675"><a href="#cb375-3675" aria-hidden="true" tabindex="-1"></a>The Change Problem, Find the minimum number of coins needed to make change</span>
<span id="cb375-3676"><a href="#cb375-3676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3677"><a href="#cb375-3677" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>money<span class="op">*</span>&nbsp;and an array&nbsp;<span class="op">*</span>Coins<span class="op">*</span>&nbsp;of positive integers.</span>
<span id="cb375-3678"><a href="#cb375-3678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3679"><a href="#cb375-3679" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The minimum number of coins <span class="cf">with</span> denominations&nbsp;<span class="op">*</span>Coins<span class="op">*</span>&nbsp;that changes&nbsp;<span class="op">*</span>money<span class="op">*</span>.</span>
<span id="cb375-3680"><a href="#cb375-3680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3681"><a href="#cb375-3681" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3682"><a href="#cb375-3682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3683"><a href="#cb375-3683" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3684"><a href="#cb375-3684" aria-hidden="true" tabindex="-1"></a><span class="dv">40</span></span>
<span id="cb375-3685"><a href="#cb375-3685" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">25</span>,<span class="dv">50</span></span>
<span id="cb375-3686"><a href="#cb375-3686" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3687"><a href="#cb375-3687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3688"><a href="#cb375-3688" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3689"><a href="#cb375-3689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3690"><a href="#cb375-3690" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3691"><a href="#cb375-3691" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb375-3692"><a href="#cb375-3692" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3693"><a href="#cb375-3693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3694"><a href="#cb375-3694" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3695"><a href="#cb375-3695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3696"><a href="#cb375-3696" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3697"><a href="#cb375-3697" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb375-3698"><a href="#cb375-3698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3699"><a href="#cb375-3699" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> min_coins_for_change(target_amount: <span class="bu">int</span>, available_coins: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-3700"><a href="#cb375-3700" aria-hidden="true" tabindex="-1"></a>    min_coins_needed <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-3701"><a href="#cb375-3701" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_amount <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, target_amount <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3702"><a href="#cb375-3702" aria-hidden="true" tabindex="-1"></a>        min_coins_needed.append(target_amount <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-3703"><a href="#cb375-3703" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> coin <span class="kw">in</span> available_coins:</span>
<span id="cb375-3704"><a href="#cb375-3704" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_amount <span class="op">&gt;=</span> coin:</span>
<span id="cb375-3705"><a href="#cb375-3705" aria-hidden="true" tabindex="-1"></a>                coins_for_current <span class="op">=</span> min_coins_needed[current_amount <span class="op">-</span> coin] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-3706"><a href="#cb375-3706" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> coins_for_current <span class="op">&lt;</span> min_coins_needed[current_amount]:</span>
<span id="cb375-3707"><a href="#cb375-3707" aria-hidden="true" tabindex="-1"></a>                    min_coins_needed[current_amount] <span class="op">=</span> coins_for_current</span>
<span id="cb375-3708"><a href="#cb375-3708" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> min_coins_needed[target_amount]</span>
<span id="cb375-3709"><a href="#cb375-3709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3710"><a href="#cb375-3710" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3711"><a href="#cb375-3711" aria-hidden="true" tabindex="-1"></a><span class="st">40</span></span>
<span id="cb375-3712"><a href="#cb375-3712" aria-hidden="true" tabindex="-1"></a><span class="st">1,5,10,20,25,50</span></span>
<span id="cb375-3713"><a href="#cb375-3713" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3714"><a href="#cb375-3714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3715"><a href="#cb375-3715" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-3716"><a href="#cb375-3716" aria-hidden="true" tabindex="-1"></a>target_amount <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb375-3717"><a href="#cb375-3717" aria-hidden="true" tabindex="-1"></a>available_coins <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split(<span class="st">","</span>)]</span>
<span id="cb375-3718"><a href="#cb375-3718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3719"><a href="#cb375-3719" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(min_coins_for_change(target_amount, available_coins))</span>
<span id="cb375-3720"><a href="#cb375-3720" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3721"><a href="#cb375-3721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3722"><a href="#cb375-3722" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Length of a Longest Path in a Manhattan-like Grid</span></span>
<span id="cb375-3723"><a href="#cb375-3723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3724"><a href="#cb375-3724" aria-hidden="true" tabindex="-1"></a>Length of a Longest Path <span class="kw">in</span> the Manhattan Tourist Problem. Find the length of a longest path <span class="kw">in</span> a rectangular city.</span>
<span id="cb375-3725"><a href="#cb375-3725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3726"><a href="#cb375-3726" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>m<span class="op">*</span>, followed by an&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;× (<span class="op">*</span>m<span class="op">*+</span><span class="dv">1</span>) matrix&nbsp;<span class="op">*</span>Down<span class="op">*</span>&nbsp;and an (<span class="op">*</span>n<span class="op">*+</span><span class="dv">1</span>) ×&nbsp;<span class="op">*</span>m<span class="op">*</span>&nbsp;matrix&nbsp;<span class="op">*</span>Right<span class="op">*</span>. The two matrices are separated by the<span class="st">"-"</span>symbol.</span>
<span id="cb375-3727"><a href="#cb375-3727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3728"><a href="#cb375-3728" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The length of a longest path <span class="im">from</span> source (<span class="dv">0</span>, <span class="dv">0</span>) to sink (<span class="op">*</span>n<span class="op">*</span>,&nbsp;<span class="op">*</span>m<span class="op">*</span>) <span class="kw">in</span> the&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;×&nbsp;<span class="op">*</span>m<span class="op">*</span>&nbsp;rectangular grid whose edges are defined by the matrices&nbsp;<span class="op">*</span>Down<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>Right<span class="op">*</span>.</span>
<span id="cb375-3729"><a href="#cb375-3729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3730"><a href="#cb375-3730" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3731"><a href="#cb375-3731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3732"><a href="#cb375-3732" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3733"><a href="#cb375-3733" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">4</span></span>
<span id="cb375-3734"><a href="#cb375-3734" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">0</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">3</span></span>
<span id="cb375-3735"><a href="#cb375-3735" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">1</span></span>
<span id="cb375-3736"><a href="#cb375-3736" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">1</span></span>
<span id="cb375-3737"><a href="#cb375-3737" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">5</span> <span class="dv">3</span></span>
<span id="cb375-3738"><a href="#cb375-3738" aria-hidden="true" tabindex="-1"></a><span class="op">-</span></span>
<span id="cb375-3739"><a href="#cb375-3739" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">0</span></span>
<span id="cb375-3740"><a href="#cb375-3740" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">2</span></span>
<span id="cb375-3741"><a href="#cb375-3741" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">3</span></span>
<span id="cb375-3742"><a href="#cb375-3742" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">3</span> <span class="dv">0</span> <span class="dv">2</span></span>
<span id="cb375-3743"><a href="#cb375-3743" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span></span>
<span id="cb375-3744"><a href="#cb375-3744" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3745"><a href="#cb375-3745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3746"><a href="#cb375-3746" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3747"><a href="#cb375-3747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3748"><a href="#cb375-3748" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3749"><a href="#cb375-3749" aria-hidden="true" tabindex="-1"></a><span class="dv">34</span></span>
<span id="cb375-3750"><a href="#cb375-3750" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3751"><a href="#cb375-3751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3752"><a href="#cb375-3752" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3753"><a href="#cb375-3753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3754"><a href="#cb375-3754" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3755"><a href="#cb375-3755" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb375-3756"><a href="#cb375-3756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3757"><a href="#cb375-3757" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_manhattan_tourist_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, List[List[<span class="bu">int</span>]], List[List[<span class="bu">int</span>]]]:</span>
<span id="cb375-3758"><a href="#cb375-3758" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_text.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb375-3759"><a href="#cb375-3759" aria-hidden="true" tabindex="-1"></a>    rows, cols <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">0</span>].split())</span>
<span id="cb375-3760"><a href="#cb375-3760" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3761"><a href="#cb375-3761" aria-hidden="true" tabindex="-1"></a>    down_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows)]</span>
<span id="cb375-3762"><a href="#cb375-3762" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows):</span>
<span id="cb375-3763"><a href="#cb375-3763" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb375-3764"><a href="#cb375-3764" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3765"><a href="#cb375-3765" aria-hidden="true" tabindex="-1"></a>            down_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb375-3766"><a href="#cb375-3766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3767"><a href="#cb375-3767" aria-hidden="true" tabindex="-1"></a>    separator_index <span class="op">=</span> rows <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-3768"><a href="#cb375-3768" aria-hidden="true" tabindex="-1"></a>    right_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> cols <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-3769"><a href="#cb375-3769" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3770"><a href="#cb375-3770" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> separator_index <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb375-3771"><a href="#cb375-3771" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols):</span>
<span id="cb375-3772"><a href="#cb375-3772" aria-hidden="true" tabindex="-1"></a>            right_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb375-3773"><a href="#cb375-3773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3774"><a href="#cb375-3774" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rows, cols, down_weights, right_weights</span>
<span id="cb375-3775"><a href="#cb375-3775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3776"><a href="#cb375-3776" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_longest_manhattan_path(rows: <span class="bu">int</span>, cols: <span class="bu">int</span>, down_weights: List[List[<span class="bu">int</span>]], right_weights: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-3777"><a href="#cb375-3777" aria-hidden="true" tabindex="-1"></a>    path_scores <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-3778"><a href="#cb375-3778" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3779"><a href="#cb375-3779" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3780"><a href="#cb375-3780" aria-hidden="true" tabindex="-1"></a>        path_scores[i][<span class="dv">0</span>] <span class="op">=</span> path_scores[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-3781"><a href="#cb375-3781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3782"><a href="#cb375-3782" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3783"><a href="#cb375-3783" aria-hidden="true" tabindex="-1"></a>        path_scores[<span class="dv">0</span>][j] <span class="op">=</span> path_scores[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-3784"><a href="#cb375-3784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3785"><a href="#cb375-3785" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3786"><a href="#cb375-3786" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-3787"><a href="#cb375-3787" aria-hidden="true" tabindex="-1"></a>            path_scores[i][j] <span class="op">=</span> <span class="bu">max</span>(path_scores[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][j],</span>
<span id="cb375-3788"><a href="#cb375-3788" aria-hidden="true" tabindex="-1"></a>                                    path_scores[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[i][j <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb375-3789"><a href="#cb375-3789" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-3790"><a href="#cb375-3790" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_scores[rows][cols]</span>
<span id="cb375-3791"><a href="#cb375-3791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3792"><a href="#cb375-3792" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3793"><a href="#cb375-3793" aria-hidden="true" tabindex="-1"></a><span class="st">4 4</span></span>
<span id="cb375-3794"><a href="#cb375-3794" aria-hidden="true" tabindex="-1"></a><span class="st">1 0 2 4 3</span></span>
<span id="cb375-3795"><a href="#cb375-3795" aria-hidden="true" tabindex="-1"></a><span class="st">4 6 5 2 1</span></span>
<span id="cb375-3796"><a href="#cb375-3796" aria-hidden="true" tabindex="-1"></a><span class="st">4 4 5 2 1</span></span>
<span id="cb375-3797"><a href="#cb375-3797" aria-hidden="true" tabindex="-1"></a><span class="st">5 6 8 5 3</span></span>
<span id="cb375-3798"><a href="#cb375-3798" aria-hidden="true" tabindex="-1"></a><span class="st">-</span></span>
<span id="cb375-3799"><a href="#cb375-3799" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 0</span></span>
<span id="cb375-3800"><a href="#cb375-3800" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 2</span></span>
<span id="cb375-3801"><a href="#cb375-3801" aria-hidden="true" tabindex="-1"></a><span class="st">0 7 3 3</span></span>
<span id="cb375-3802"><a href="#cb375-3802" aria-hidden="true" tabindex="-1"></a><span class="st">3 3 0 2</span></span>
<span id="cb375-3803"><a href="#cb375-3803" aria-hidden="true" tabindex="-1"></a><span class="st">1 3 2 2</span></span>
<span id="cb375-3804"><a href="#cb375-3804" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3805"><a href="#cb375-3805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3806"><a href="#cb375-3806" aria-hidden="true" tabindex="-1"></a>rows, cols, down_weights, right_weights <span class="op">=</span> parse_manhattan_tourist_input(sample_input)</span>
<span id="cb375-3807"><a href="#cb375-3807" aria-hidden="true" tabindex="-1"></a>longest_path_score <span class="op">=</span> calculate_longest_manhattan_path(rows, cols, down_weights, right_weights)</span>
<span id="cb375-3808"><a href="#cb375-3808" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>longest_path_score<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-3809"><a href="#cb375-3809" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3810"><a href="#cb375-3810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3811"><a href="#cb375-3811" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Longest Common Subsequence of Two Strings</span></span>
<span id="cb375-3812"><a href="#cb375-3812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3813"><a href="#cb375-3813" aria-hidden="true" tabindex="-1"></a>Longest Common Subsequence Problem.</span>
<span id="cb375-3814"><a href="#cb375-3814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3815"><a href="#cb375-3815" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two strings.</span>
<span id="cb375-3816"><a href="#cb375-3816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3817"><a href="#cb375-3817" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A longest common subsequence of these strings.</span>
<span id="cb375-3818"><a href="#cb375-3818" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3819"><a href="#cb375-3819" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3820"><a href="#cb375-3820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3821"><a href="#cb375-3821" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3822"><a href="#cb375-3822" aria-hidden="true" tabindex="-1"></a>AACCTTGG</span>
<span id="cb375-3823"><a href="#cb375-3823" aria-hidden="true" tabindex="-1"></a>ACACTGTGA</span>
<span id="cb375-3824"><a href="#cb375-3824" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3825"><a href="#cb375-3825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3826"><a href="#cb375-3826" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3827"><a href="#cb375-3827" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3828"><a href="#cb375-3828" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3829"><a href="#cb375-3829" aria-hidden="true" tabindex="-1"></a>AACTGG</span>
<span id="cb375-3830"><a href="#cb375-3830" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3831"><a href="#cb375-3831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3832"><a href="#cb375-3832" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3833"><a href="#cb375-3833" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3834"><a href="#cb375-3834" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3835"><a href="#cb375-3835" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb375-3836"><a href="#cb375-3836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3837"><a href="#cb375-3837" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_common_subsequence(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-3838"><a href="#cb375-3838" aria-hidden="true" tabindex="-1"></a>    padded_seq1 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence1</span>
<span id="cb375-3839"><a href="#cb375-3839" aria-hidden="true" tabindex="-1"></a>    padded_seq2 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence2</span>
<span id="cb375-3840"><a href="#cb375-3840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3841"><a href="#cb375-3841" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb375-3842"><a href="#cb375-3842" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb375-3843"><a href="#cb375-3843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3844"><a href="#cb375-3844" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb375-3845"><a href="#cb375-3845" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb375-3846"><a href="#cb375-3846" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="cf">if</span> padded_seq1[i] <span class="op">==</span> padded_seq2[j] <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb375-3847"><a href="#cb375-3847" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j], score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>], match_score)</span>
<span id="cb375-3848"><a href="#cb375-3848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3849"><a href="#cb375-3849" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j]:</span>
<span id="cb375-3850"><a href="#cb375-3850" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb375-3851"><a href="#cb375-3851" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb375-3852"><a href="#cb375-3852" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb375-3853"><a href="#cb375-3853" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-3854"><a href="#cb375-3854" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diag"</span></span>
<span id="cb375-3855"><a href="#cb375-3855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3856"><a href="#cb375-3856" aria-hidden="true" tabindex="-1"></a>    lcs <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-3857"><a href="#cb375-3857" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-3858"><a href="#cb375-3858" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-3859"><a href="#cb375-3859" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"diag"</span>:</span>
<span id="cb375-3860"><a href="#cb375-3860" aria-hidden="true" tabindex="-1"></a>            lcs <span class="op">=</span> padded_seq1[i] <span class="op">+</span> lcs</span>
<span id="cb375-3861"><a href="#cb375-3861" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-3862"><a href="#cb375-3862" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-3863"><a href="#cb375-3863" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"left"</span>:</span>
<span id="cb375-3864"><a href="#cb375-3864" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-3865"><a href="#cb375-3865" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-3866"><a href="#cb375-3866" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-3867"><a href="#cb375-3867" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3868"><a href="#cb375-3868" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lcs</span>
<span id="cb375-3869"><a href="#cb375-3869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3870"><a href="#cb375-3870" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3871"><a href="#cb375-3871" aria-hidden="true" tabindex="-1"></a><span class="st">AACCTTGG</span></span>
<span id="cb375-3872"><a href="#cb375-3872" aria-hidden="true" tabindex="-1"></a><span class="st">ACACTGTGA</span></span>
<span id="cb375-3873"><a href="#cb375-3873" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3874"><a href="#cb375-3874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3875"><a href="#cb375-3875" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-3876"><a href="#cb375-3876" aria-hidden="true" tabindex="-1"></a>sequence1 <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-3877"><a href="#cb375-3877" aria-hidden="true" tabindex="-1"></a>sequence2 <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb375-3878"><a href="#cb375-3878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3879"><a href="#cb375-3879" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_common_subsequence(sequence1, sequence2))</span>
<span id="cb375-3880"><a href="#cb375-3880" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3881"><a href="#cb375-3881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3882"><a href="#cb375-3882" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Longest Path in a DAG</span></span>
<span id="cb375-3883"><a href="#cb375-3883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3884"><a href="#cb375-3884" aria-hidden="true" tabindex="-1"></a>Longest Path <span class="kw">in</span> a DAG Problem. Find a longest path between two nodes <span class="kw">in</span> an edge<span class="op">-</span>weighted DAG.</span>
<span id="cb375-3885"><a href="#cb375-3885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3886"><a href="#cb375-3886" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer representing the source node of a graph, followed by an integer representing the sink node of the graph, followed by an edge<span class="op">-</span>weighted graph. The graph <span class="kw">is</span> represented by a modified&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>)&nbsp;in which the notation<span class="st">"0-&gt;1:7"</span>indicates that an edge connects node <span class="dv">0</span> to node <span class="dv">1</span> <span class="cf">with</span> weight <span class="fl">7.</span></span>
<span id="cb375-3887"><a href="#cb375-3887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3888"><a href="#cb375-3888" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The length of a longest path <span class="kw">in</span> the graph, followed by a longest path. (If multiple longest paths exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-3889"><a href="#cb375-3889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3890"><a href="#cb375-3890" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-3891"><a href="#cb375-3891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3892"><a href="#cb375-3892" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3893"><a href="#cb375-3893" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span></span>
<span id="cb375-3894"><a href="#cb375-3894" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-3895"><a href="#cb375-3895" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">1</span>:<span class="dv">7</span></span>
<span id="cb375-3896"><a href="#cb375-3896" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">2</span>:<span class="dv">4</span></span>
<span id="cb375-3897"><a href="#cb375-3897" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">3</span>:<span class="dv">2</span></span>
<span id="cb375-3898"><a href="#cb375-3898" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">1</span></span>
<span id="cb375-3899"><a href="#cb375-3899" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">3</span></span>
<span id="cb375-3900"><a href="#cb375-3900" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3901"><a href="#cb375-3901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3902"><a href="#cb375-3902" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-3903"><a href="#cb375-3903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3904"><a href="#cb375-3904" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3905"><a href="#cb375-3905" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span></span>
<span id="cb375-3906"><a href="#cb375-3906" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb375-3907"><a href="#cb375-3907" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-3908"><a href="#cb375-3908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3909"><a href="#cb375-3909" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-3910"><a href="#cb375-3910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3911"><a href="#cb375-3911" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-3912"><a href="#cb375-3912" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Optional</span>
<span id="cb375-3913"><a href="#cb375-3913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3914"><a href="#cb375-3914" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Node:</span>
<span id="cb375-3915"><a href="#cb375-3915" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, label: <span class="bu">str</span>):</span>
<span id="cb375-3916"><a href="#cb375-3916" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label: <span class="bu">str</span> <span class="op">=</span> label</span>
<span id="cb375-3917"><a href="#cb375-3917" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.parent_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-3918"><a href="#cb375-3918" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.target_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-3919"><a href="#cb375-3919" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.visited: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span></span>
<span id="cb375-3920"><a href="#cb375-3920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3921"><a href="#cb375-3921" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DAG:</span>
<span id="cb375-3922"><a href="#cb375-3922" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb375-3923"><a href="#cb375-3923" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict: Dict[<span class="bu">str</span>, Node] <span class="op">=</span> {}</span>
<span id="cb375-3924"><a href="#cb375-3924" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances: Dict[<span class="bu">str</span>, <span class="bu">float</span>] <span class="op">=</span> {}</span>
<span id="cb375-3925"><a href="#cb375-3925" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack: Dict[<span class="bu">str</span>, Optional[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb375-3926"><a href="#cb375-3926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3927"><a href="#cb375-3927" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>, label: <span class="bu">str</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb375-3928"><a href="#cb375-3928" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb375-3929"><a href="#cb375-3929" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb375-3930"><a href="#cb375-3930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3931"><a href="#cb375-3931" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Node(label)</span>
<span id="cb375-3932"><a href="#cb375-3932" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict[label] <span class="op">=</span> new_node</span>
<span id="cb375-3933"><a href="#cb375-3933" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb375-3934"><a href="#cb375-3934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3935"><a href="#cb375-3935" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_dag(<span class="va">self</span>, adjacency_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-3936"><a href="#cb375-3936" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> adjacency_list:</span>
<span id="cb375-3937"><a href="#cb375-3937" aria-hidden="true" tabindex="-1"></a>            source_label, temp <span class="op">=</span> line.split(<span class="st">"-&gt;"</span>)</span>
<span id="cb375-3938"><a href="#cb375-3938" aria-hidden="true" tabindex="-1"></a>            target_label, weight_str <span class="op">=</span> temp.split(<span class="st">":"</span>)</span>
<span id="cb375-3939"><a href="#cb375-3939" aria-hidden="true" tabindex="-1"></a>            weight <span class="op">=</span> <span class="bu">int</span>(weight_str)</span>
<span id="cb375-3940"><a href="#cb375-3940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3941"><a href="#cb375-3941" aria-hidden="true" tabindex="-1"></a>            source_node <span class="op">=</span> <span class="va">self</span>.add_node(source_label)</span>
<span id="cb375-3942"><a href="#cb375-3942" aria-hidden="true" tabindex="-1"></a>            target_node <span class="op">=</span> <span class="va">self</span>.add_node(target_label)</span>
<span id="cb375-3943"><a href="#cb375-3943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3944"><a href="#cb375-3944" aria-hidden="true" tabindex="-1"></a>            source_node.target_nodes.append((target_node, weight))</span>
<span id="cb375-3945"><a href="#cb375-3945" aria-hidden="true" tabindex="-1"></a>            target_node.parent_nodes.append((source_node, weight))</span>
<span id="cb375-3946"><a href="#cb375-3946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3947"><a href="#cb375-3947" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort_util(<span class="va">self</span>, current_node: Node, sorted_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-3948"><a href="#cb375-3948" aria-hidden="true" tabindex="-1"></a>        current_node.visited <span class="op">=</span> <span class="va">True</span></span>
<span id="cb375-3949"><a href="#cb375-3949" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor, _ <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb375-3950"><a href="#cb375-3950" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> neighbor.visited:</span>
<span id="cb375-3951"><a href="#cb375-3951" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(neighbor, sorted_labels)</span>
<span id="cb375-3952"><a href="#cb375-3952" aria-hidden="true" tabindex="-1"></a>        sorted_labels.insert(<span class="dv">0</span>, current_node.label)</span>
<span id="cb375-3953"><a href="#cb375-3953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3954"><a href="#cb375-3954" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort(<span class="va">self</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-3955"><a href="#cb375-3955" aria-hidden="true" tabindex="-1"></a>        sorted_labels: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb375-3956"><a href="#cb375-3956" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.nodes_dict.values():</span>
<span id="cb375-3957"><a href="#cb375-3957" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> node.visited:</span>
<span id="cb375-3958"><a href="#cb375-3958" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(node, sorted_labels)</span>
<span id="cb375-3959"><a href="#cb375-3959" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sorted_labels</span>
<span id="cb375-3960"><a href="#cb375-3960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3961"><a href="#cb375-3961" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> longest_path(<span class="va">self</span>, source: <span class="bu">str</span>, sink: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-3962"><a href="#cb375-3962" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb375-3963"><a href="#cb375-3963" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.distances[label] <span class="op">=</span> <span class="bu">float</span>(<span class="st">"-inf"</span>)</span>
<span id="cb375-3964"><a href="#cb375-3964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3965"><a href="#cb375-3965" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances[source] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-3966"><a href="#cb375-3966" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack[source] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-3967"><a href="#cb375-3967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3968"><a href="#cb375-3968" aria-hidden="true" tabindex="-1"></a>        topological_order <span class="op">=</span> <span class="va">self</span>.topological_sort()</span>
<span id="cb375-3969"><a href="#cb375-3969" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> topological_order:</span>
<span id="cb375-3970"><a href="#cb375-3970" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb375-3971"><a href="#cb375-3971" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target_node, weight <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb375-3972"><a href="#cb375-3972" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.distances[target_node.label] <span class="op">&lt;</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight:</span>
<span id="cb375-3973"><a href="#cb375-3973" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.distances[target_node.label] <span class="op">=</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight</span>
<span id="cb375-3974"><a href="#cb375-3974" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.backtrack[target_node.label] <span class="op">=</span> label</span>
<span id="cb375-3975"><a href="#cb375-3975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3976"><a href="#cb375-3976" aria-hidden="true" tabindex="-1"></a>        path: List[<span class="bu">str</span>] <span class="op">=</span> [sink]</span>
<span id="cb375-3977"><a href="#cb375-3977" aria-hidden="true" tabindex="-1"></a>        current_label <span class="op">=</span> <span class="va">self</span>.backtrack[sink]</span>
<span id="cb375-3978"><a href="#cb375-3978" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_label <span class="op">!=</span> source:</span>
<span id="cb375-3979"><a href="#cb375-3979" aria-hidden="true" tabindex="-1"></a>            path <span class="op">=</span> [current_label] <span class="op">+</span> path</span>
<span id="cb375-3980"><a href="#cb375-3980" aria-hidden="true" tabindex="-1"></a>            current_label <span class="op">=</span> <span class="va">self</span>.backtrack[current_label]</span>
<span id="cb375-3981"><a href="#cb375-3981" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> [source] <span class="op">+</span> path</span>
<span id="cb375-3982"><a href="#cb375-3982" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.distances[sink], path</span>
<span id="cb375-3983"><a href="#cb375-3983" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3984"><a href="#cb375-3984" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-3985"><a href="#cb375-3985" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-3986"><a href="#cb375-3986" aria-hidden="true" tabindex="-1"></a><span class="st">0</span></span>
<span id="cb375-3987"><a href="#cb375-3987" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-3988"><a href="#cb375-3988" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;1:7</span></span>
<span id="cb375-3989"><a href="#cb375-3989" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;2:4</span></span>
<span id="cb375-3990"><a href="#cb375-3990" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;3:2</span></span>
<span id="cb375-3991"><a href="#cb375-3991" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:1</span></span>
<span id="cb375-3992"><a href="#cb375-3992" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;4:3</span></span>
<span id="cb375-3993"><a href="#cb375-3993" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-3994"><a href="#cb375-3994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-3995"><a href="#cb375-3995" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-3996"><a href="#cb375-3996" aria-hidden="true" tabindex="-1"></a>source_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-3997"><a href="#cb375-3997" aria-hidden="true" tabindex="-1"></a>sink_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb375-3998"><a href="#cb375-3998" aria-hidden="true" tabindex="-1"></a>adjacency_list: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">2</span>:]</span>
<span id="cb375-3999"><a href="#cb375-3999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4000"><a href="#cb375-4000" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> DAG()</span>
<span id="cb375-4001"><a href="#cb375-4001" aria-hidden="true" tabindex="-1"></a>graph.construct_dag(adjacency_list)</span>
<span id="cb375-4002"><a href="#cb375-4002" aria-hidden="true" tabindex="-1"></a>longest_distance, longest_path <span class="op">=</span> graph.longest_path(source_label, sink_label)</span>
<span id="cb375-4003"><a href="#cb375-4003" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_distance)</span>
<span id="cb375-4004"><a href="#cb375-4004" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(longest_path))</span>
<span id="cb375-4005"><a href="#cb375-4005" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4006"><a href="#cb375-4006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4007"><a href="#cb375-4007" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Alignment of Two Strings</span></span>
<span id="cb375-4008"><a href="#cb375-4008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4009"><a href="#cb375-4009" aria-hidden="true" tabindex="-1"></a>Global Alignment Problem. Find the highest<span class="op">-</span>scoring alignment between two strings using a scoring matrix.</span>
<span id="cb375-4010"><a href="#cb375-4010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4011"><a href="#cb375-4011" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb375-4012"><a href="#cb375-4012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4013"><a href="#cb375-4013" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum alignment score of these strings followed by an alignment achieving this maximum score. Use the&nbsp;[BLOSUM62](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>blosum62<span class="op">/</span>)&nbsp;scoring matrix <span class="kw">and</span> indel penalty σ <span class="op">=</span> <span class="fl">5.</span> (If multiple alignments achieving the maximum score exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-4014"><a href="#cb375-4014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4015"><a href="#cb375-4015" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-4016"><a href="#cb375-4016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4017"><a href="#cb375-4017" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4018"><a href="#cb375-4018" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb375-4019"><a href="#cb375-4019" aria-hidden="true" tabindex="-1"></a>MEANLY</span>
<span id="cb375-4020"><a href="#cb375-4020" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4021"><a href="#cb375-4021" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4022"><a href="#cb375-4022" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-4023"><a href="#cb375-4023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4024"><a href="#cb375-4024" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4025"><a href="#cb375-4025" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb375-4026"><a href="#cb375-4026" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb375-4027"><a href="#cb375-4027" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>MEA<span class="op">--</span>N<span class="op">-</span>LY</span>
<span id="cb375-4028"><a href="#cb375-4028" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4029"><a href="#cb375-4029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4030"><a href="#cb375-4030" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-4031"><a href="#cb375-4031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4032"><a href="#cb375-4032" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-4033"><a href="#cb375-4033" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb375-4034"><a href="#cb375-4034" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4035"><a href="#cb375-4035" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-4036"><a href="#cb375-4036" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4037"><a href="#cb375-4037" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4038"><a href="#cb375-4038" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4039"><a href="#cb375-4039" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4040"><a href="#cb375-4040" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4041"><a href="#cb375-4041" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb375-4042"><a href="#cb375-4042" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb375-4043"><a href="#cb375-4043" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4044"><a href="#cb375-4044" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4045"><a href="#cb375-4045" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4046"><a href="#cb375-4046" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4047"><a href="#cb375-4047" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4048"><a href="#cb375-4048" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4049"><a href="#cb375-4049" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4050"><a href="#cb375-4050" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4051"><a href="#cb375-4051" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4052"><a href="#cb375-4052" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4053"><a href="#cb375-4053" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4054"><a href="#cb375-4054" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4055"><a href="#cb375-4055" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4056"><a href="#cb375-4056" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4057"><a href="#cb375-4057" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4058"><a href="#cb375-4058" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4059"><a href="#cb375-4059" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4060"><a href="#cb375-4060" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4061"><a href="#cb375-4061" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4062"><a href="#cb375-4062" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4063"><a href="#cb375-4063" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4064"><a href="#cb375-4064" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4065"><a href="#cb375-4065" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4066"><a href="#cb375-4066" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4067"><a href="#cb375-4067" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4068"><a href="#cb375-4068" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4069"><a href="#cb375-4069" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4070"><a href="#cb375-4070" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4071"><a href="#cb375-4071" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4072"><a href="#cb375-4072" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4073"><a href="#cb375-4073" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4074"><a href="#cb375-4074" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4075"><a href="#cb375-4075" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb375-4076"><a href="#cb375-4076" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4077"><a href="#cb375-4077" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb375-4078"><a href="#cb375-4078" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4079"><a href="#cb375-4079" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4080"><a href="#cb375-4080" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4081"><a href="#cb375-4081" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4082"><a href="#cb375-4082" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4083"><a href="#cb375-4083" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb375-4084"><a href="#cb375-4084" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4085"><a href="#cb375-4085" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4086"><a href="#cb375-4086" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4087"><a href="#cb375-4087" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4088"><a href="#cb375-4088" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4089"><a href="#cb375-4089" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4090"><a href="#cb375-4090" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4091"><a href="#cb375-4091" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4092"><a href="#cb375-4092" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb375-4093"><a href="#cb375-4093" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb375-4094"><a href="#cb375-4094" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4095"><a href="#cb375-4095" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4096"><a href="#cb375-4096" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4097"><a href="#cb375-4097" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4098"><a href="#cb375-4098" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4099"><a href="#cb375-4099" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4100"><a href="#cb375-4100" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4101"><a href="#cb375-4101" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4102"><a href="#cb375-4102" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb375-4103"><a href="#cb375-4103" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4104"><a href="#cb375-4104" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb375-4105"><a href="#cb375-4105" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-4106"><a href="#cb375-4106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4107"><a href="#cb375-4107" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb375-4108"><a href="#cb375-4108" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb375-4109"><a href="#cb375-4109" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb375-4110"><a href="#cb375-4110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4111"><a href="#cb375-4111" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb375-4112"><a href="#cb375-4112" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb375-4113"><a href="#cb375-4113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4114"><a href="#cb375-4114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb375-4115"><a href="#cb375-4115" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> j</span>
<span id="cb375-4116"><a href="#cb375-4116" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb375-4117"><a href="#cb375-4117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4118"><a href="#cb375-4118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb375-4119"><a href="#cb375-4119" aria-hidden="true" tabindex="-1"></a>        score_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> i</span>
<span id="cb375-4120"><a href="#cb375-4120" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb375-4121"><a href="#cb375-4121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4122"><a href="#cb375-4122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb375-4123"><a href="#cb375-4123" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb375-4124"><a href="#cb375-4124" aria-hidden="true" tabindex="-1"></a>            key: Tuple[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> (padded_seq1[i], padded_seq2[j]) <span class="cf">if</span> (padded_seq1[i], padded_seq2[j]) <span class="kw">in</span> BLOSUM62 <span class="cf">else</span> (padded_seq2[j], padded_seq1[i])</span>
<span id="cb375-4125"><a href="#cb375-4125" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> BLOSUM62[key]</span>
<span id="cb375-4126"><a href="#cb375-4126" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb375-4127"><a href="#cb375-4127" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb375-4128"><a href="#cb375-4128" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score)</span>
<span id="cb375-4129"><a href="#cb375-4129" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb375-4130"><a href="#cb375-4130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb375-4131"><a href="#cb375-4131" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb375-4132"><a href="#cb375-4132" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb375-4133"><a href="#cb375-4133" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb375-4134"><a href="#cb375-4134" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-4135"><a href="#cb375-4135" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb375-4136"><a href="#cb375-4136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4137"><a href="#cb375-4137" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-4138"><a href="#cb375-4138" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-4139"><a href="#cb375-4139" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-4140"><a href="#cb375-4140" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-4141"><a href="#cb375-4141" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4142"><a href="#cb375-4142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">!=</span> <span class="dv">0</span> <span class="kw">or</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb375-4143"><a href="#cb375-4143" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb375-4144"><a href="#cb375-4144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb375-4145"><a href="#cb375-4145" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb375-4146"><a href="#cb375-4146" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb375-4147"><a href="#cb375-4147" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4148"><a href="#cb375-4148" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4149"><a href="#cb375-4149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb375-4150"><a href="#cb375-4150" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb375-4151"><a href="#cb375-4151" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb375-4152"><a href="#cb375-4152" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4153"><a href="#cb375-4153" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-4154"><a href="#cb375-4154" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb375-4155"><a href="#cb375-4155" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb375-4156"><a href="#cb375-4156" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4157"><a href="#cb375-4157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4158"><a href="#cb375-4158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score_matrix[<span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>][<span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span>], aligned_seq1, aligned_seq2</span>
<span id="cb375-4159"><a href="#cb375-4159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4160"><a href="#cb375-4160" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-4161"><a href="#cb375-4161" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-4162"><a href="#cb375-4162" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb375-4163"><a href="#cb375-4163" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb375-4164"><a href="#cb375-4164" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-4165"><a href="#cb375-4165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4166"><a href="#cb375-4166" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4167"><a href="#cb375-4167" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-4168"><a href="#cb375-4168" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb375-4169"><a href="#cb375-4169" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb375-4170"><a href="#cb375-4170" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb375-4171"><a href="#cb375-4171" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb375-4172"><a href="#cb375-4172" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> global_alignment(sequence1, sequence2)</span>
<span id="cb375-4173"><a href="#cb375-4173" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb375-4174"><a href="#cb375-4174" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb375-4175"><a href="#cb375-4175" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span>
<span id="cb375-4176"><a href="#cb375-4176" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4177"><a href="#cb375-4177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4178"><a href="#cb375-4178" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Local Alignment of Two Strings</span></span>
<span id="cb375-4179"><a href="#cb375-4179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4180"><a href="#cb375-4180" aria-hidden="true" tabindex="-1"></a>Local Alignment Problem, Find the highest<span class="op">-</span>scoring local alignment between two strings.</span>
<span id="cb375-4181"><a href="#cb375-4181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4182"><a href="#cb375-4182" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb375-4183"><a href="#cb375-4183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4184"><a href="#cb375-4184" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum score of a local alignment of the strings, followed by a local alignment of these strings achieving the maximum score. Use the&nbsp;[PAM250](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>pam250<span class="op">/</span>)&nbsp;scoring matrix <span class="kw">and</span> indel penalty σ <span class="op">=</span> <span class="fl">5.</span> (If multiple local alignments achieving the maximum score exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-4185"><a href="#cb375-4185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4186"><a href="#cb375-4186" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-4187"><a href="#cb375-4187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4188"><a href="#cb375-4188" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4189"><a href="#cb375-4189" aria-hidden="true" tabindex="-1"></a>MEANLY</span>
<span id="cb375-4190"><a href="#cb375-4190" aria-hidden="true" tabindex="-1"></a>PENALTY</span>
<span id="cb375-4191"><a href="#cb375-4191" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4192"><a href="#cb375-4192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4193"><a href="#cb375-4193" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-4194"><a href="#cb375-4194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4195"><a href="#cb375-4195" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4196"><a href="#cb375-4196" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span></span>
<span id="cb375-4197"><a href="#cb375-4197" aria-hidden="true" tabindex="-1"></a>EANL<span class="op">-</span>Y</span>
<span id="cb375-4198"><a href="#cb375-4198" aria-hidden="true" tabindex="-1"></a>ENALTY</span>
<span id="cb375-4199"><a href="#cb375-4199" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4200"><a href="#cb375-4200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4201"><a href="#cb375-4201" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-4202"><a href="#cb375-4202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4203"><a href="#cb375-4203" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-4204"><a href="#cb375-4204" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Optional</span>
<span id="cb375-4205"><a href="#cb375-4205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4206"><a href="#cb375-4206" aria-hidden="true" tabindex="-1"></a>PAM250: Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {</span>
<span id="cb375-4207"><a href="#cb375-4207" aria-hidden="true" tabindex="-1"></a>        <span class="st">'A'</span>: {<span class="st">'A'</span>: <span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb375-4208"><a href="#cb375-4208" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb375-4209"><a href="#cb375-4209" aria-hidden="true" tabindex="-1"></a>          <span class="st">'C'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="dv">12</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">5</span>,</span>
<span id="cb375-4210"><a href="#cb375-4210" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb375-4211"><a href="#cb375-4211" aria-hidden="true" tabindex="-1"></a>          <span class="st">'D'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">4</span>, <span class="st">'E'</span>: <span class="dv">3</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb375-4212"><a href="#cb375-4212" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb375-4213"><a href="#cb375-4213" aria-hidden="true" tabindex="-1"></a>          <span class="st">'E'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">3</span>, <span class="st">'E'</span>: <span class="dv">4</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb375-4214"><a href="#cb375-4214" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb375-4215"><a href="#cb375-4215" aria-hidden="true" tabindex="-1"></a>          <span class="st">'F'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="dv">9</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4216"><a href="#cb375-4216" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">7</span>},</span>
<span id="cb375-4217"><a href="#cb375-4217" aria-hidden="true" tabindex="-1"></a>          <span class="st">'G'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb375-4218"><a href="#cb375-4218" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb375-4219"><a href="#cb375-4219" aria-hidden="true" tabindex="-1"></a>          <span class="st">'H'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">6</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb375-4220"><a href="#cb375-4220" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">3</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb375-4221"><a href="#cb375-4221" aria-hidden="true" tabindex="-1"></a>          <span class="st">'I'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4222"><a href="#cb375-4222" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb375-4223"><a href="#cb375-4223" aria-hidden="true" tabindex="-1"></a>          <span class="st">'K'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb375-4224"><a href="#cb375-4224" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb375-4225"><a href="#cb375-4225" aria-hidden="true" tabindex="-1"></a>          <span class="st">'L'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'F'</span>: <span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="dv">6</span>, <span class="st">'M'</span>: <span class="dv">4</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4226"><a href="#cb375-4226" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb375-4227"><a href="#cb375-4227" aria-hidden="true" tabindex="-1"></a>          <span class="st">'M'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="dv">4</span>, <span class="st">'M'</span>: <span class="dv">6</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4228"><a href="#cb375-4228" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb375-4229"><a href="#cb375-4229" aria-hidden="true" tabindex="-1"></a>          <span class="st">'N'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb375-4230"><a href="#cb375-4230" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb375-4231"><a href="#cb375-4231" aria-hidden="true" tabindex="-1"></a>          <span class="st">'P'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb375-4232"><a href="#cb375-4232" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">6</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb375-4233"><a href="#cb375-4233" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Q'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb375-4234"><a href="#cb375-4234" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">4</span>, <span class="st">'R'</span>: <span class="dv">1</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb375-4235"><a href="#cb375-4235" aria-hidden="true" tabindex="-1"></a>          <span class="st">'R'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb375-4236"><a href="#cb375-4236" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">6</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb375-4237"><a href="#cb375-4237" aria-hidden="true" tabindex="-1"></a>          <span class="st">'S'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb375-4238"><a href="#cb375-4238" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">2</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb375-4239"><a href="#cb375-4239" aria-hidden="true" tabindex="-1"></a>          <span class="st">'T'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="dv">0</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb375-4240"><a href="#cb375-4240" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">3</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb375-4241"><a href="#cb375-4241" aria-hidden="true" tabindex="-1"></a>          <span class="st">'V'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">4</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4242"><a href="#cb375-4242" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb375-4243"><a href="#cb375-4243" aria-hidden="true" tabindex="-1"></a>          <span class="st">'W'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4244"><a href="#cb375-4244" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'W'</span>: <span class="dv">17</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb375-4245"><a href="#cb375-4245" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Y'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'F'</span>: <span class="dv">7</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4246"><a href="#cb375-4246" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">10</span>}}</span>
<span id="cb375-4247"><a href="#cb375-4247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4248"><a href="#cb375-4248" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> local_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb375-4249"><a href="#cb375-4249" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb375-4250"><a href="#cb375-4250" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb375-4251"><a href="#cb375-4251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4252"><a href="#cb375-4252" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb375-4253"><a href="#cb375-4253" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[Optional[<span class="bu">str</span>]]] <span class="op">=</span> [[<span class="va">None</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb375-4254"><a href="#cb375-4254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4255"><a href="#cb375-4255" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb375-4256"><a href="#cb375-4256" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb375-4257"><a href="#cb375-4257" aria-hidden="true" tabindex="-1"></a>            key1: <span class="bu">str</span> <span class="op">=</span> padded_seq1[i] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq2[j]</span>
<span id="cb375-4258"><a href="#cb375-4258" aria-hidden="true" tabindex="-1"></a>            key2: <span class="bu">str</span> <span class="op">=</span> padded_seq2[j] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq1[i]</span>
<span id="cb375-4259"><a href="#cb375-4259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4260"><a href="#cb375-4260" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> PAM250[key1][key2]</span>
<span id="cb375-4261"><a href="#cb375-4261" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb375-4262"><a href="#cb375-4262" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb375-4263"><a href="#cb375-4263" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score, <span class="dv">0</span>)</span>
<span id="cb375-4264"><a href="#cb375-4264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4265"><a href="#cb375-4265" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb375-4266"><a href="#cb375-4266" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb375-4267"><a href="#cb375-4267" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb375-4268"><a href="#cb375-4268" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb375-4269"><a href="#cb375-4269" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> left_score:</span>
<span id="cb375-4270"><a href="#cb375-4270" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb375-4271"><a href="#cb375-4271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4272"><a href="#cb375-4272" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb375-4273"><a href="#cb375-4273" aria-hidden="true" tabindex="-1"></a>    max_i: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-4274"><a href="#cb375-4274" aria-hidden="true" tabindex="-1"></a>    max_j: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-4275"><a href="#cb375-4275" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb375-4276"><a href="#cb375-4276" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb375-4277"><a href="#cb375-4277" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">&gt;</span> max_score:</span>
<span id="cb375-4278"><a href="#cb375-4278" aria-hidden="true" tabindex="-1"></a>                max_score <span class="op">=</span> score_matrix[i][j]</span>
<span id="cb375-4279"><a href="#cb375-4279" aria-hidden="true" tabindex="-1"></a>                max_i, max_j <span class="op">=</span> i, j</span>
<span id="cb375-4280"><a href="#cb375-4280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4281"><a href="#cb375-4281" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> max_i</span>
<span id="cb375-4282"><a href="#cb375-4282" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> max_j</span>
<span id="cb375-4283"><a href="#cb375-4283" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-4284"><a href="#cb375-4284" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-4285"><a href="#cb375-4285" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> backtrack_matrix[i][j] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb375-4286"><a href="#cb375-4286" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb375-4287"><a href="#cb375-4287" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb375-4288"><a href="#cb375-4288" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb375-4289"><a href="#cb375-4289" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb375-4290"><a href="#cb375-4290" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4291"><a href="#cb375-4291" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4292"><a href="#cb375-4292" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb375-4293"><a href="#cb375-4293" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb375-4294"><a href="#cb375-4294" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb375-4295"><a href="#cb375-4295" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4296"><a href="#cb375-4296" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-4297"><a href="#cb375-4297" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb375-4298"><a href="#cb375-4298" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb375-4299"><a href="#cb375-4299" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4300"><a href="#cb375-4300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4301"><a href="#cb375-4301" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb375-4302"><a href="#cb375-4302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4303"><a href="#cb375-4303" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-4304"><a href="#cb375-4304" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-4305"><a href="#cb375-4305" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb375-4306"><a href="#cb375-4306" aria-hidden="true" tabindex="-1"></a><span class="st">PENALTY</span></span>
<span id="cb375-4307"><a href="#cb375-4307" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-4308"><a href="#cb375-4308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4309"><a href="#cb375-4309" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4310"><a href="#cb375-4310" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-4311"><a href="#cb375-4311" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb375-4312"><a href="#cb375-4312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4313"><a href="#cb375-4313" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb375-4314"><a href="#cb375-4314" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb375-4315"><a href="#cb375-4315" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb375-4316"><a href="#cb375-4316" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> local_alignment(sequence1, sequence2)</span>
<span id="cb375-4317"><a href="#cb375-4317" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb375-4318"><a href="#cb375-4318" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb375-4319"><a href="#cb375-4319" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span>
<span id="cb375-4320"><a href="#cb375-4320" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4321"><a href="#cb375-4321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4322"><a href="#cb375-4322" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Edit Distance Between Two Strings</span></span>
<span id="cb375-4323"><a href="#cb375-4323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4324"><a href="#cb375-4324" aria-hidden="true" tabindex="-1"></a>Edit Distance Problem. Find the edit distance between two strings.</span>
<span id="cb375-4325"><a href="#cb375-4325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4326"><a href="#cb375-4326" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb375-4327"><a href="#cb375-4327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4328"><a href="#cb375-4328" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The&nbsp;[edit distance](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>edit<span class="op">-</span>distance<span class="op">/</span>)&nbsp;between these strings.</span>
<span id="cb375-4329"><a href="#cb375-4329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4330"><a href="#cb375-4330" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-4331"><a href="#cb375-4331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4332"><a href="#cb375-4332" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4333"><a href="#cb375-4333" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb375-4334"><a href="#cb375-4334" aria-hidden="true" tabindex="-1"></a>MEANLY</span>
<span id="cb375-4335"><a href="#cb375-4335" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4336"><a href="#cb375-4336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4337"><a href="#cb375-4337" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-4338"><a href="#cb375-4338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4339"><a href="#cb375-4339" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4340"><a href="#cb375-4340" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb375-4341"><a href="#cb375-4341" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4342"><a href="#cb375-4342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4343"><a href="#cb375-4343" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-4344"><a href="#cb375-4344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4345"><a href="#cb375-4345" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-4346"><a href="#cb375-4346" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_edit_distance(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-4347"><a href="#cb375-4347" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> {}</span>
<span id="cb375-4348"><a href="#cb375-4348" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4349"><a href="#cb375-4349" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4350"><a href="#cb375-4350" aria-hidden="true" tabindex="-1"></a>        distance_matrix[target_index, <span class="dv">0</span>] <span class="op">=</span> target_index</span>
<span id="cb375-4351"><a href="#cb375-4351" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4352"><a href="#cb375-4352" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4353"><a href="#cb375-4353" aria-hidden="true" tabindex="-1"></a>        distance_matrix[<span class="dv">0</span>, source_index] <span class="op">=</span> source_index</span>
<span id="cb375-4354"><a href="#cb375-4354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4355"><a href="#cb375-4355" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target)):</span>
<span id="cb375-4356"><a href="#cb375-4356" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source)):</span>
<span id="cb375-4357"><a href="#cb375-4357" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> source[source_index] <span class="op">==</span> target[target_index]:</span>
<span id="cb375-4358"><a href="#cb375-4358" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> distance_matrix[target_index, source_index]</span>
<span id="cb375-4359"><a href="#cb375-4359" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-4360"><a href="#cb375-4360" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> <span class="bu">min</span>([</span>
<span id="cb375-4361"><a href="#cb375-4361" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index],</span>
<span id="cb375-4362"><a href="#cb375-4362" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index],</span>
<span id="cb375-4363"><a href="#cb375-4363" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-4364"><a href="#cb375-4364" aria-hidden="true" tabindex="-1"></a>                ]) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-4365"><a href="#cb375-4365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4366"><a href="#cb375-4366" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_matrix[<span class="bu">len</span>(target), <span class="bu">len</span>(source)]</span>
<span id="cb375-4367"><a href="#cb375-4367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4368"><a href="#cb375-4368" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-4369"><a href="#cb375-4369" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb375-4370"><a href="#cb375-4370" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb375-4371"><a href="#cb375-4371" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-4372"><a href="#cb375-4372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4373"><a href="#cb375-4373" aria-hidden="true" tabindex="-1"></a>source, target <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4374"><a href="#cb375-4374" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_edit_distance(source, target))</span>
<span id="cb375-4375"><a href="#cb375-4375" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4376"><a href="#cb375-4376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4377"><a href="#cb375-4377" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Fitting Alignment of Two Strings</span></span>
<span id="cb375-4378"><a href="#cb375-4378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4379"><a href="#cb375-4379" aria-hidden="true" tabindex="-1"></a>Fitting Alignment Problem. Construct a highest<span class="op">-</span>scoring fitting alignment between two strings.</span>
<span id="cb375-4380"><a href="#cb375-4380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4381"><a href="#cb375-4381" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[DNA strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, where&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;has length at most <span class="dv">10000</span> and&nbsp;<span class="op">*</span>w<span class="op">*</span>&nbsp;has length at most <span class="fl">1000.</span></span>
<span id="cb375-4382"><a href="#cb375-4382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4383"><a href="#cb375-4383" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum score of a fitting alignment of&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, followed by a fitting alignment achieving this maximum score. Use the simple scoring method <span class="kw">in</span> which matches count <span class="op">+</span><span class="dv">1</span> <span class="kw">and</span> both the mismatch <span class="kw">and</span> indel penalties are equal to <span class="fl">1.</span> (If multiple fitting alignments achieving the maximum score exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-4384"><a href="#cb375-4384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4385"><a href="#cb375-4385" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-4386"><a href="#cb375-4386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4387"><a href="#cb375-4387" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4388"><a href="#cb375-4388" aria-hidden="true" tabindex="-1"></a>GTAGGCTTAAGGTTA</span>
<span id="cb375-4389"><a href="#cb375-4389" aria-hidden="true" tabindex="-1"></a>TAGATA</span>
<span id="cb375-4390"><a href="#cb375-4390" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4391"><a href="#cb375-4391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4392"><a href="#cb375-4392" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-4393"><a href="#cb375-4393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4394"><a href="#cb375-4394" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4395"><a href="#cb375-4395" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb375-4396"><a href="#cb375-4396" aria-hidden="true" tabindex="-1"></a>TAGGCTTA</span>
<span id="cb375-4397"><a href="#cb375-4397" aria-hidden="true" tabindex="-1"></a>TAGA<span class="op">--</span>TA</span>
<span id="cb375-4398"><a href="#cb375-4398" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4399"><a href="#cb375-4399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4400"><a href="#cb375-4400" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-4401"><a href="#cb375-4401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4402"><a href="#cb375-4402" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-4403"><a href="#cb375-4403" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb375-4404"><a href="#cb375-4404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4405"><a href="#cb375-4405" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_fitting_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb375-4406"><a href="#cb375-4406" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-4407"><a href="#cb375-4407" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb375-4408"><a href="#cb375-4408" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4409"><a href="#cb375-4409" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4410"><a href="#cb375-4410" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>seq2_index</span>
<span id="cb375-4411"><a href="#cb375-4411" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb375-4412"><a href="#cb375-4412" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4413"><a href="#cb375-4413" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-4414"><a href="#cb375-4414" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb375-4415"><a href="#cb375-4415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4416"><a href="#cb375-4416" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-4417"><a href="#cb375-4417" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb375-4418"><a href="#cb375-4418" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb375-4419"><a href="#cb375-4419" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-4420"><a href="#cb375-4420" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb375-4421"><a href="#cb375-4421" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb375-4422"><a href="#cb375-4422" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb375-4423"><a href="#cb375-4423" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb375-4424"><a href="#cb375-4424" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb375-4425"><a href="#cb375-4425" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb375-4426"><a href="#cb375-4426" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb375-4427"><a href="#cb375-4427" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb375-4428"><a href="#cb375-4428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4429"><a href="#cb375-4429" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[<span class="bu">len</span>(sequence2), i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-4430"><a href="#cb375-4430" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb375-4431"><a href="#cb375-4431" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb375-4432"><a href="#cb375-4432" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> <span class="bu">len</span>(sequence2)</span>
<span id="cb375-4433"><a href="#cb375-4433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4434"><a href="#cb375-4434" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb375-4435"><a href="#cb375-4435" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-4436"><a href="#cb375-4436" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb375-4437"><a href="#cb375-4437" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-4438"><a href="#cb375-4438" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-4439"><a href="#cb375-4439" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-4440"><a href="#cb375-4440" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb375-4441"><a href="#cb375-4441" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-4442"><a href="#cb375-4442" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb375-4443"><a href="#cb375-4443" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-4444"><a href="#cb375-4444" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb375-4445"><a href="#cb375-4445" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb375-4446"><a href="#cb375-4446" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-4447"><a href="#cb375-4447" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-4448"><a href="#cb375-4448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4449"><a href="#cb375-4449" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-4450"><a href="#cb375-4450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4451"><a href="#cb375-4451" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-4452"><a href="#cb375-4452" aria-hidden="true" tabindex="-1"></a><span class="st">GTAGGCTTAAGGTTA</span></span>
<span id="cb375-4453"><a href="#cb375-4453" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATA</span></span>
<span id="cb375-4454"><a href="#cb375-4454" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-4455"><a href="#cb375-4455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4456"><a href="#cb375-4456" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4457"><a href="#cb375-4457" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_fitting_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4458"><a href="#cb375-4458" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4459"><a href="#cb375-4459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4460"><a href="#cb375-4460" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Overlap Alignment of Two Strings</span></span>
<span id="cb375-4461"><a href="#cb375-4461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4462"><a href="#cb375-4462" aria-hidden="true" tabindex="-1"></a>Overlap Alignment Problem. Construct a highest<span class="op">-</span>scoring overlap alignment between two strings.</span>
<span id="cb375-4463"><a href="#cb375-4463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4464"><a href="#cb375-4464" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[protein strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>)&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, each of length at most <span class="fl">1000.</span></span>
<span id="cb375-4465"><a href="#cb375-4465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4466"><a href="#cb375-4466" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The score of an optimal overlap alignment of&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, followed by an alignment of a suffix&nbsp;<span class="op">*</span>v<span class="st">'*&nbsp;of&nbsp;*v*&nbsp;and a prefix&nbsp;*w'</span><span class="op">*</span>&nbsp;of&nbsp;<span class="op">*</span>w<span class="op">*</span>&nbsp;achieving this maximum score. Use an alignment score <span class="kw">in</span> which matches count <span class="op">+</span><span class="dv">1</span> <span class="kw">and</span> both the mismatch <span class="kw">and</span> indel penalties are <span class="fl">2.</span> (If multiple overlap alignments achieving the maximum score exist, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-4467"><a href="#cb375-4467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4468"><a href="#cb375-4468" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-4469"><a href="#cb375-4469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4470"><a href="#cb375-4470" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4471"><a href="#cb375-4471" aria-hidden="true" tabindex="-1"></a>PAWHEAE</span>
<span id="cb375-4472"><a href="#cb375-4472" aria-hidden="true" tabindex="-1"></a>HEAGAWGHEE</span>
<span id="cb375-4473"><a href="#cb375-4473" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4474"><a href="#cb375-4474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4475"><a href="#cb375-4475" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-4476"><a href="#cb375-4476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4477"><a href="#cb375-4477" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4478"><a href="#cb375-4478" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb375-4479"><a href="#cb375-4479" aria-hidden="true" tabindex="-1"></a>HEAE</span>
<span id="cb375-4480"><a href="#cb375-4480" aria-hidden="true" tabindex="-1"></a>HEAG</span>
<span id="cb375-4481"><a href="#cb375-4481" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4482"><a href="#cb375-4482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4483"><a href="#cb375-4483" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-4484"><a href="#cb375-4484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4485"><a href="#cb375-4485" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-4486"><a href="#cb375-4486" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb375-4487"><a href="#cb375-4487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4488"><a href="#cb375-4488" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_overlap_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, mismatch_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">2</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb375-4489"><a href="#cb375-4489" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-4490"><a href="#cb375-4490" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb375-4491"><a href="#cb375-4491" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4492"><a href="#cb375-4492" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4493"><a href="#cb375-4493" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> seq2_index <span class="op">*</span> mismatch_penalty</span>
<span id="cb375-4494"><a href="#cb375-4494" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb375-4495"><a href="#cb375-4495" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4496"><a href="#cb375-4496" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-4497"><a href="#cb375-4497" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb375-4498"><a href="#cb375-4498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4499"><a href="#cb375-4499" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-4500"><a href="#cb375-4500" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb375-4501"><a href="#cb375-4501" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb375-4502"><a href="#cb375-4502" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-4503"><a href="#cb375-4503" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> mismatch_penalty</span>
<span id="cb375-4504"><a href="#cb375-4504" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb375-4505"><a href="#cb375-4505" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb375-4506"><a href="#cb375-4506" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb375-4507"><a href="#cb375-4507" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb375-4508"><a href="#cb375-4508" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb375-4509"><a href="#cb375-4509" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb375-4510"><a href="#cb375-4510" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb375-4511"><a href="#cb375-4511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4512"><a href="#cb375-4512" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[seq2_index, <span class="bu">len</span>(sequence1)] <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-4513"><a href="#cb375-4513" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb375-4514"><a href="#cb375-4514" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb375-4515"><a href="#cb375-4515" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> <span class="bu">len</span>(sequence1)</span>
<span id="cb375-4516"><a href="#cb375-4516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4517"><a href="#cb375-4517" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb375-4518"><a href="#cb375-4518" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-4519"><a href="#cb375-4519" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb375-4520"><a href="#cb375-4520" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-4521"><a href="#cb375-4521" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-4522"><a href="#cb375-4522" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-4523"><a href="#cb375-4523" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb375-4524"><a href="#cb375-4524" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-4525"><a href="#cb375-4525" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb375-4526"><a href="#cb375-4526" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-4527"><a href="#cb375-4527" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb375-4528"><a href="#cb375-4528" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb375-4529"><a href="#cb375-4529" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-4530"><a href="#cb375-4530" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-4531"><a href="#cb375-4531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4532"><a href="#cb375-4532" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-4533"><a href="#cb375-4533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4534"><a href="#cb375-4534" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-4535"><a href="#cb375-4535" aria-hidden="true" tabindex="-1"></a><span class="st">PAWHEAE</span></span>
<span id="cb375-4536"><a href="#cb375-4536" aria-hidden="true" tabindex="-1"></a><span class="st">HEAGAWGHEE</span></span>
<span id="cb375-4537"><a href="#cb375-4537" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-4538"><a href="#cb375-4538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4539"><a href="#cb375-4539" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4540"><a href="#cb375-4540" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_overlap_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4541"><a href="#cb375-4541" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4542"><a href="#cb375-4542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4543"><a href="#cb375-4543" aria-hidden="true" tabindex="-1"></a><span class="co"># Align Two Strings Using Affine Gap Penalties</span></span>
<span id="cb375-4544"><a href="#cb375-4544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4545"><a href="#cb375-4545" aria-hidden="true" tabindex="-1"></a>Alignment <span class="cf">with</span> Affine Gap Penalties Problem. Construct a highest<span class="op">-</span>scoring <span class="kw">global</span> alignment of two strings (<span class="cf">with</span> affine gap penalties).</span>
<span id="cb375-4546"><a href="#cb375-4546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4547"><a href="#cb375-4547" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two amino acid strings&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>&nbsp;(each of length at most <span class="dv">100</span>).</span>
<span id="cb375-4548"><a href="#cb375-4548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4549"><a href="#cb375-4549" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum alignment score between&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>, followed by an alignment of&nbsp;<span class="op">*</span>v<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>w<span class="op">*</span>&nbsp;achieving this maximum score. Use the&nbsp;[BLOSUM62](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>blosum62<span class="op">/</span>)&nbsp;scoring matrix, a gap opening penalty of <span class="dv">11</span>, <span class="kw">and</span> a gap extension penalty of <span class="fl">1.</span></span>
<span id="cb375-4550"><a href="#cb375-4550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4551"><a href="#cb375-4551" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-4552"><a href="#cb375-4552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4553"><a href="#cb375-4553" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4554"><a href="#cb375-4554" aria-hidden="true" tabindex="-1"></a>PRTEINS</span>
<span id="cb375-4555"><a href="#cb375-4555" aria-hidden="true" tabindex="-1"></a>PRTWPSEIN</span>
<span id="cb375-4556"><a href="#cb375-4556" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4557"><a href="#cb375-4557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4558"><a href="#cb375-4558" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-4559"><a href="#cb375-4559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4560"><a href="#cb375-4560" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4561"><a href="#cb375-4561" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb375-4562"><a href="#cb375-4562" aria-hidden="true" tabindex="-1"></a>PRT<span class="op">---</span>EINS</span>
<span id="cb375-4563"><a href="#cb375-4563" aria-hidden="true" tabindex="-1"></a>PRTWPSEIN<span class="op">-</span></span>
<span id="cb375-4564"><a href="#cb375-4564" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4565"><a href="#cb375-4565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4566"><a href="#cb375-4566" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-4567"><a href="#cb375-4567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4568"><a href="#cb375-4568" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-4569"><a href="#cb375-4569" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List, Optional</span>
<span id="cb375-4570"><a href="#cb375-4570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4571"><a href="#cb375-4571" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-4572"><a href="#cb375-4572" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4573"><a href="#cb375-4573" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4574"><a href="#cb375-4574" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4575"><a href="#cb375-4575" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4576"><a href="#cb375-4576" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4577"><a href="#cb375-4577" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb375-4578"><a href="#cb375-4578" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb375-4579"><a href="#cb375-4579" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4580"><a href="#cb375-4580" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4581"><a href="#cb375-4581" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4582"><a href="#cb375-4582" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4583"><a href="#cb375-4583" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4584"><a href="#cb375-4584" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4585"><a href="#cb375-4585" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4586"><a href="#cb375-4586" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4587"><a href="#cb375-4587" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4588"><a href="#cb375-4588" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4589"><a href="#cb375-4589" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4590"><a href="#cb375-4590" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4591"><a href="#cb375-4591" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4592"><a href="#cb375-4592" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4593"><a href="#cb375-4593" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4594"><a href="#cb375-4594" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4595"><a href="#cb375-4595" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4596"><a href="#cb375-4596" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4597"><a href="#cb375-4597" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4598"><a href="#cb375-4598" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4599"><a href="#cb375-4599" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4600"><a href="#cb375-4600" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4601"><a href="#cb375-4601" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4602"><a href="#cb375-4602" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4603"><a href="#cb375-4603" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4604"><a href="#cb375-4604" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4605"><a href="#cb375-4605" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4606"><a href="#cb375-4606" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4607"><a href="#cb375-4607" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4608"><a href="#cb375-4608" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4609"><a href="#cb375-4609" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4610"><a href="#cb375-4610" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4611"><a href="#cb375-4611" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb375-4612"><a href="#cb375-4612" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4613"><a href="#cb375-4613" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb375-4614"><a href="#cb375-4614" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4615"><a href="#cb375-4615" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4616"><a href="#cb375-4616" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4617"><a href="#cb375-4617" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4618"><a href="#cb375-4618" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4619"><a href="#cb375-4619" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb375-4620"><a href="#cb375-4620" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4621"><a href="#cb375-4621" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4622"><a href="#cb375-4622" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4623"><a href="#cb375-4623" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4624"><a href="#cb375-4624" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4625"><a href="#cb375-4625" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4626"><a href="#cb375-4626" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4627"><a href="#cb375-4627" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4628"><a href="#cb375-4628" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb375-4629"><a href="#cb375-4629" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb375-4630"><a href="#cb375-4630" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4631"><a href="#cb375-4631" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4632"><a href="#cb375-4632" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4633"><a href="#cb375-4633" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4634"><a href="#cb375-4634" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4635"><a href="#cb375-4635" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4636"><a href="#cb375-4636" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4637"><a href="#cb375-4637" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4638"><a href="#cb375-4638" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb375-4639"><a href="#cb375-4639" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4640"><a href="#cb375-4640" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb375-4641"><a href="#cb375-4641" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-4642"><a href="#cb375-4642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4643"><a href="#cb375-4643" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert_gap(sequence: <span class="bu">str</span>, position: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-4644"><a href="#cb375-4644" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Insert a gap ('-') into the sequence at the specified position."""</span></span>
<span id="cb375-4645"><a href="#cb375-4645" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[:position] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> sequence[position:]</span>
<span id="cb375-4646"><a href="#cb375-4646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4647"><a href="#cb375-4647" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment_affine(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>, gap_open_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">11</span>, gap_extend_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb375-4648"><a href="#cb375-4648" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-4649"><a href="#cb375-4649" aria-hidden="true" tabindex="-1"></a><span class="st">    Perform global sequence alignment with affine gap penalty.</span></span>
<span id="cb375-4650"><a href="#cb375-4650" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb375-4651"><a href="#cb375-4651" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-4652"><a href="#cb375-4652" aria-hidden="true" tabindex="-1"></a><span class="st">    seq1 (str): First sequence to align</span></span>
<span id="cb375-4653"><a href="#cb375-4653" aria-hidden="true" tabindex="-1"></a><span class="st">    seq2 (str): Second sequence to align</span></span>
<span id="cb375-4654"><a href="#cb375-4654" aria-hidden="true" tabindex="-1"></a><span class="st">    gap_open_penalty (int): Penalty for opening a gap</span></span>
<span id="cb375-4655"><a href="#cb375-4655" aria-hidden="true" tabindex="-1"></a><span class="st">    gap_extend_penalty (int): Penalty for extending a gap</span></span>
<span id="cb375-4656"><a href="#cb375-4656" aria-hidden="true" tabindex="-1"></a><span class="st">    </span></span>
<span id="cb375-4657"><a href="#cb375-4657" aria-hidden="true" tabindex="-1"></a><span class="st">    Returns:</span></span>
<span id="cb375-4658"><a href="#cb375-4658" aria-hidden="true" tabindex="-1"></a><span class="st">    Tuple[int, str, str]: Alignment score and aligned sequences</span></span>
<span id="cb375-4659"><a href="#cb375-4659" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-4660"><a href="#cb375-4660" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> BLOSUM62</span>
<span id="cb375-4661"><a href="#cb375-4661" aria-hidden="true" tabindex="-1"></a>    match_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-4662"><a href="#cb375-4662" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-4663"><a href="#cb375-4663" aria-hidden="true" tabindex="-1"></a>    gap_seq2_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-4664"><a href="#cb375-4664" aria-hidden="true" tabindex="-1"></a>    prev_match: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-4665"><a href="#cb375-4665" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq1: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-4666"><a href="#cb375-4666" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq2: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-4667"><a href="#cb375-4667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4668"><a href="#cb375-4668" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize matrices</span></span>
<span id="cb375-4669"><a href="#cb375-4669" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> match_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> gap_seq2_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-4670"><a href="#cb375-4670" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4671"><a href="#cb375-4671" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb375-4672"><a href="#cb375-4672" aria-hidden="true" tabindex="-1"></a>        match_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb375-4673"><a href="#cb375-4673" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb375-4674"><a href="#cb375-4674" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4675"><a href="#cb375-4675" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb375-4676"><a href="#cb375-4676" aria-hidden="true" tabindex="-1"></a>        match_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb375-4677"><a href="#cb375-4677" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb375-4678"><a href="#cb375-4678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4679"><a href="#cb375-4679" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill matrices</span></span>
<span id="cb375-4680"><a href="#cb375-4680" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4681"><a href="#cb375-4681" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4682"><a href="#cb375-4682" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq1</span></span>
<span id="cb375-4683"><a href="#cb375-4683" aria-hidden="true" tabindex="-1"></a>            gap_seq1_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb375-4684"><a href="#cb375-4684" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb375-4685"><a href="#cb375-4685" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_open_penalty</span>
<span id="cb375-4686"><a href="#cb375-4686" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb375-4687"><a href="#cb375-4687" aria-hidden="true" tabindex="-1"></a>            gap_seq1_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq1_options)</span>
<span id="cb375-4688"><a href="#cb375-4688" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq1[i, j] <span class="op">=</span> gap_seq1_options.index(gap_seq1_score[i, j])</span>
<span id="cb375-4689"><a href="#cb375-4689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4690"><a href="#cb375-4690" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq2</span></span>
<span id="cb375-4691"><a href="#cb375-4691" aria-hidden="true" tabindex="-1"></a>            gap_seq2_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb375-4692"><a href="#cb375-4692" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb375-4693"><a href="#cb375-4693" aria-hidden="true" tabindex="-1"></a>                match_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_open_penalty</span>
<span id="cb375-4694"><a href="#cb375-4694" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb375-4695"><a href="#cb375-4695" aria-hidden="true" tabindex="-1"></a>            gap_seq2_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq2_options)</span>
<span id="cb375-4696"><a href="#cb375-4696" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq2[i, j] <span class="op">=</span> gap_seq2_options.index(gap_seq2_score[i, j])</span>
<span id="cb375-4697"><a href="#cb375-4697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4698"><a href="#cb375-4698" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate match/mismatch score</span></span>
<span id="cb375-4699"><a href="#cb375-4699" aria-hidden="true" tabindex="-1"></a>            blosum_score: <span class="bu">int</span> <span class="op">=</span> scoring_matrix.get((seq1[i<span class="op">-</span><span class="dv">1</span>], seq2[j<span class="op">-</span><span class="dv">1</span>]), scoring_matrix.get((seq2[j<span class="op">-</span><span class="dv">1</span>], seq1[i<span class="op">-</span><span class="dv">1</span>]), <span class="dv">0</span>))</span>
<span id="cb375-4700"><a href="#cb375-4700" aria-hidden="true" tabindex="-1"></a>            match_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb375-4701"><a href="#cb375-4701" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i, j],</span>
<span id="cb375-4702"><a href="#cb375-4702" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> blosum_score,</span>
<span id="cb375-4703"><a href="#cb375-4703" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j]</span>
<span id="cb375-4704"><a href="#cb375-4704" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb375-4705"><a href="#cb375-4705" aria-hidden="true" tabindex="-1"></a>            match_score[i, j] <span class="op">=</span> <span class="bu">max</span>(match_options)</span>
<span id="cb375-4706"><a href="#cb375-4706" aria-hidden="true" tabindex="-1"></a>            prev_match[i, j] <span class="op">=</span> match_options.index(match_score[i, j])</span>
<span id="cb375-4707"><a href="#cb375-4707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4708"><a href="#cb375-4708" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback</span></span>
<span id="cb375-4709"><a href="#cb375-4709" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(seq1), <span class="bu">len</span>(seq2)</span>
<span id="cb375-4710"><a href="#cb375-4710" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> seq1, seq2</span>
<span id="cb375-4711"><a href="#cb375-4711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4712"><a href="#cb375-4712" aria-hidden="true" tabindex="-1"></a>    scores: List[<span class="bu">int</span>] <span class="op">=</span> [gap_seq1_score[i, j], match_score[i, j], gap_seq2_score[i, j]]</span>
<span id="cb375-4713"><a href="#cb375-4713" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">max</span>(scores)</span>
<span id="cb375-4714"><a href="#cb375-4714" aria-hidden="true" tabindex="-1"></a>    current_matrix: <span class="bu">int</span> <span class="op">=</span> scores.index(max_score)</span>
<span id="cb375-4715"><a href="#cb375-4715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4716"><a href="#cb375-4716" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">*</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb375-4717"><a href="#cb375-4717" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_matrix <span class="op">==</span> <span class="dv">0</span>:  <span class="co"># In gap_seq1_score matrix</span></span>
<span id="cb375-4718"><a href="#cb375-4718" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq1[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb375-4719"><a href="#cb375-4719" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-4720"><a href="#cb375-4720" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4721"><a href="#cb375-4721" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, j)</span>
<span id="cb375-4722"><a href="#cb375-4722" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> current_matrix <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># In match_score matrix</span></span>
<span id="cb375-4723"><a href="#cb375-4723" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_match[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb375-4724"><a href="#cb375-4724" aria-hidden="true" tabindex="-1"></a>                i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4725"><a href="#cb375-4725" aria-hidden="true" tabindex="-1"></a>                j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4726"><a href="#cb375-4726" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-4727"><a href="#cb375-4727" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> prev_match[i, j]</span>
<span id="cb375-4728"><a href="#cb375-4728" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># In gap_seq2_score matrix</span></span>
<span id="cb375-4729"><a href="#cb375-4729" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq2[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb375-4730"><a href="#cb375-4730" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-4731"><a href="#cb375-4731" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4732"><a href="#cb375-4732" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, i)</span>
<span id="cb375-4733"><a href="#cb375-4733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4734"><a href="#cb375-4734" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle remaining overhangs</span></span>
<span id="cb375-4735"><a href="#cb375-4735" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-4736"><a href="#cb375-4736" aria-hidden="true" tabindex="-1"></a>        aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, <span class="dv">0</span>)</span>
<span id="cb375-4737"><a href="#cb375-4737" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4738"><a href="#cb375-4738" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-4739"><a href="#cb375-4739" aria-hidden="true" tabindex="-1"></a>        aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, <span class="dv">0</span>)</span>
<span id="cb375-4740"><a href="#cb375-4740" aria-hidden="true" tabindex="-1"></a>        j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-4741"><a href="#cb375-4741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4742"><a href="#cb375-4742" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb375-4743"><a href="#cb375-4743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4744"><a href="#cb375-4744" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb375-4745"><a href="#cb375-4745" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-4746"><a href="#cb375-4746" aria-hidden="true" tabindex="-1"></a><span class="st">PRTEINS</span></span>
<span id="cb375-4747"><a href="#cb375-4747" aria-hidden="true" tabindex="-1"></a><span class="st">PRTWPSEIN</span></span>
<span id="cb375-4748"><a href="#cb375-4748" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-4749"><a href="#cb375-4749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4750"><a href="#cb375-4750" aria-hidden="true" tabindex="-1"></a>seq1, seq2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4751"><a href="#cb375-4751" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_seq1, aligned_seq2 <span class="op">=</span> global_alignment_affine(seq1, seq2)</span>
<span id="cb375-4752"><a href="#cb375-4752" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score, aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4753"><a href="#cb375-4753" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4754"><a href="#cb375-4754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4755"><a href="#cb375-4755" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Middle Edge in an Alignment Graph in Linear Space</span></span>
<span id="cb375-4756"><a href="#cb375-4756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4757"><a href="#cb375-4757" aria-hidden="true" tabindex="-1"></a>Middle Edge <span class="kw">in</span> Linear Space Problem. Find a middle edge <span class="kw">in</span> the alignment graph <span class="kw">in</span> linear space.</span>
<span id="cb375-4758"><a href="#cb375-4758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4759"><a href="#cb375-4759" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb375-4760"><a href="#cb375-4760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4761"><a href="#cb375-4761" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A middle edge <span class="kw">in</span> the alignment graph of these strings, where the optimal path <span class="kw">is</span> defined by the&nbsp;[BLOSUM62](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>blosum62<span class="op">/</span>)&nbsp;scoring matrix <span class="kw">and</span> a linear indel penalty equal to <span class="fl">5.</span> Return the middle edge <span class="kw">in</span> the form<span class="st">"(*i*,&nbsp;*j*) (*k*,&nbsp;*l*)"</span>, where (<span class="op">*</span>i<span class="op">*</span>,&nbsp;<span class="op">*</span>j<span class="op">*</span>) connects to (<span class="op">*</span>k<span class="op">*</span>,&nbsp;<span class="op">*</span>l<span class="op">*</span>).</span>
<span id="cb375-4762"><a href="#cb375-4762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4763"><a href="#cb375-4763" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-4764"><a href="#cb375-4764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4765"><a href="#cb375-4765" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4766"><a href="#cb375-4766" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb375-4767"><a href="#cb375-4767" aria-hidden="true" tabindex="-1"></a>MEASNLY</span>
<span id="cb375-4768"><a href="#cb375-4768" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4769"><a href="#cb375-4769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4770"><a href="#cb375-4770" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-4771"><a href="#cb375-4771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4772"><a href="#cb375-4772" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4773"><a href="#cb375-4773" aria-hidden="true" tabindex="-1"></a>(<span class="dv">4</span>, <span class="dv">3</span>) (<span class="dv">5</span>, <span class="dv">4</span>)</span>
<span id="cb375-4774"><a href="#cb375-4774" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4775"><a href="#cb375-4775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4776"><a href="#cb375-4776" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-4777"><a href="#cb375-4777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4778"><a href="#cb375-4778" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-4779"><a href="#cb375-4779" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb375-4780"><a href="#cb375-4780" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb375-4781"><a href="#cb375-4781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4782"><a href="#cb375-4782" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-4783"><a href="#cb375-4783" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4784"><a href="#cb375-4784" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4785"><a href="#cb375-4785" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4786"><a href="#cb375-4786" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4787"><a href="#cb375-4787" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4788"><a href="#cb375-4788" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb375-4789"><a href="#cb375-4789" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb375-4790"><a href="#cb375-4790" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4791"><a href="#cb375-4791" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4792"><a href="#cb375-4792" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4793"><a href="#cb375-4793" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4794"><a href="#cb375-4794" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4795"><a href="#cb375-4795" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4796"><a href="#cb375-4796" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4797"><a href="#cb375-4797" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4798"><a href="#cb375-4798" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4799"><a href="#cb375-4799" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4800"><a href="#cb375-4800" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4801"><a href="#cb375-4801" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4802"><a href="#cb375-4802" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4803"><a href="#cb375-4803" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4804"><a href="#cb375-4804" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4805"><a href="#cb375-4805" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4806"><a href="#cb375-4806" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4807"><a href="#cb375-4807" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4808"><a href="#cb375-4808" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4809"><a href="#cb375-4809" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4810"><a href="#cb375-4810" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4811"><a href="#cb375-4811" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4812"><a href="#cb375-4812" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4813"><a href="#cb375-4813" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4814"><a href="#cb375-4814" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4815"><a href="#cb375-4815" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4816"><a href="#cb375-4816" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4817"><a href="#cb375-4817" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4818"><a href="#cb375-4818" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4819"><a href="#cb375-4819" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4820"><a href="#cb375-4820" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4821"><a href="#cb375-4821" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4822"><a href="#cb375-4822" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb375-4823"><a href="#cb375-4823" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4824"><a href="#cb375-4824" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb375-4825"><a href="#cb375-4825" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4826"><a href="#cb375-4826" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4827"><a href="#cb375-4827" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4828"><a href="#cb375-4828" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4829"><a href="#cb375-4829" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4830"><a href="#cb375-4830" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb375-4831"><a href="#cb375-4831" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4832"><a href="#cb375-4832" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4833"><a href="#cb375-4833" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4834"><a href="#cb375-4834" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4835"><a href="#cb375-4835" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4836"><a href="#cb375-4836" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4837"><a href="#cb375-4837" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4838"><a href="#cb375-4838" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4839"><a href="#cb375-4839" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb375-4840"><a href="#cb375-4840" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb375-4841"><a href="#cb375-4841" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4842"><a href="#cb375-4842" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4843"><a href="#cb375-4843" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4844"><a href="#cb375-4844" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4845"><a href="#cb375-4845" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4846"><a href="#cb375-4846" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4847"><a href="#cb375-4847" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4848"><a href="#cb375-4848" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4849"><a href="#cb375-4849" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb375-4850"><a href="#cb375-4850" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4851"><a href="#cb375-4851" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb375-4852"><a href="#cb375-4852" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-4853"><a href="#cb375-4853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4854"><a href="#cb375-4854" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb375-4855"><a href="#cb375-4855" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb375-4856"><a href="#cb375-4856" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb375-4857"><a href="#cb375-4857" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb375-4858"><a href="#cb375-4858" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb375-4859"><a href="#cb375-4859" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb375-4860"><a href="#cb375-4860" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb375-4861"><a href="#cb375-4861" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-4862"><a href="#cb375-4862" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4863"><a href="#cb375-4863" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4864"><a href="#cb375-4864" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb375-4865"><a href="#cb375-4865" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb375-4866"><a href="#cb375-4866" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-4867"><a href="#cb375-4867" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb375-4868"><a href="#cb375-4868" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb375-4869"><a href="#cb375-4869" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb375-4870"><a href="#cb375-4870" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb375-4871"><a href="#cb375-4871" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb375-4872"><a href="#cb375-4872" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb375-4873"><a href="#cb375-4873" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb375-4874"><a href="#cb375-4874" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb375-4875"><a href="#cb375-4875" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb375-4876"><a href="#cb375-4876" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb375-4877"><a href="#cb375-4877" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4878"><a href="#cb375-4878" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb375-4879"><a href="#cb375-4879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4880"><a href="#cb375-4880" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb375-4881"><a href="#cb375-4881" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb375-4882"><a href="#cb375-4882" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb375-4883"><a href="#cb375-4883" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb375-4884"><a href="#cb375-4884" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb375-4885"><a href="#cb375-4885" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-4886"><a href="#cb375-4886" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb375-4887"><a href="#cb375-4887" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4888"><a href="#cb375-4888" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb375-4889"><a href="#cb375-4889" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb375-4890"><a href="#cb375-4890" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-4891"><a href="#cb375-4891" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb375-4892"><a href="#cb375-4892" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb375-4893"><a href="#cb375-4893" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-4894"><a href="#cb375-4894" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4895"><a href="#cb375-4895" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb375-4896"><a href="#cb375-4896" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb375-4897"><a href="#cb375-4897" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4898"><a href="#cb375-4898" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb375-4899"><a href="#cb375-4899" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb375-4900"><a href="#cb375-4900" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb375-4901"><a href="#cb375-4901" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb375-4902"><a href="#cb375-4902" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-4903"><a href="#cb375-4903" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb375-4904"><a href="#cb375-4904" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb375-4905"><a href="#cb375-4905" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-4906"><a href="#cb375-4906" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb375-4907"><a href="#cb375-4907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4908"><a href="#cb375-4908" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb375-4909"><a href="#cb375-4909" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-4910"><a href="#cb375-4910" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb375-4911"><a href="#cb375-4911" aria-hidden="true" tabindex="-1"></a><span class="st">MEASNLY</span></span>
<span id="cb375-4912"><a href="#cb375-4912" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-4913"><a href="#cb375-4913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4914"><a href="#cb375-4914" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-4915"><a href="#cb375-4915" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_middle_edge(sequence1, sequence2, BLOSUM62, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb375-4916"><a href="#cb375-4916" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-4917"><a href="#cb375-4917" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4918"><a href="#cb375-4918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4919"><a href="#cb375-4919" aria-hidden="true" tabindex="-1"></a><span class="co"># Align Two Strings Using Linear Space</span></span>
<span id="cb375-4920"><a href="#cb375-4920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4921"><a href="#cb375-4921" aria-hidden="true" tabindex="-1"></a>Global Alignment <span class="kw">in</span> Linear Space Problem. Find the highest<span class="op">-</span>scoring alignment between two strings using a scoring matrix <span class="kw">in</span> linear space.</span>
<span id="cb375-4922"><a href="#cb375-4922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4923"><a href="#cb375-4923" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two&nbsp;<span class="op">**</span><span class="bu">long</span><span class="op">**</span>&nbsp;[amino acid strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>protein<span class="op">-</span>string<span class="op">/</span>)&nbsp;(of length approximately <span class="dv">10</span>,<span class="dv">000</span>).</span>
<span id="cb375-4924"><a href="#cb375-4924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4925"><a href="#cb375-4925" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum alignment score of these strings, followed by an alignment achieving this maximum score. Use the&nbsp;[BLOSUM62](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>blosum62<span class="op">/</span>)&nbsp;scoring matrix <span class="kw">and</span> indel penalty σ <span class="op">=</span> <span class="fl">5.</span></span>
<span id="cb375-4926"><a href="#cb375-4926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4927"><a href="#cb375-4927" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-4928"><a href="#cb375-4928" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4929"><a href="#cb375-4929" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4930"><a href="#cb375-4930" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb375-4931"><a href="#cb375-4931" aria-hidden="true" tabindex="-1"></a>MEANLY</span>
<span id="cb375-4932"><a href="#cb375-4932" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4933"><a href="#cb375-4933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4934"><a href="#cb375-4934" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-4935"><a href="#cb375-4935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4936"><a href="#cb375-4936" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4937"><a href="#cb375-4937" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb375-4938"><a href="#cb375-4938" aria-hidden="true" tabindex="-1"></a>PLEASANTLY</span>
<span id="cb375-4939"><a href="#cb375-4939" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>MEA<span class="op">--</span>N<span class="op">-</span>LY</span>
<span id="cb375-4940"><a href="#cb375-4940" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-4941"><a href="#cb375-4941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4942"><a href="#cb375-4942" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-4943"><a href="#cb375-4943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4944"><a href="#cb375-4944" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-4945"><a href="#cb375-4945" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb375-4946"><a href="#cb375-4946" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb375-4947"><a href="#cb375-4947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-4948"><a href="#cb375-4948" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-4949"><a href="#cb375-4949" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4950"><a href="#cb375-4950" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4951"><a href="#cb375-4951" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4952"><a href="#cb375-4952" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4953"><a href="#cb375-4953" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4954"><a href="#cb375-4954" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb375-4955"><a href="#cb375-4955" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb375-4956"><a href="#cb375-4956" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4957"><a href="#cb375-4957" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4958"><a href="#cb375-4958" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4959"><a href="#cb375-4959" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4960"><a href="#cb375-4960" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4961"><a href="#cb375-4961" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4962"><a href="#cb375-4962" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4963"><a href="#cb375-4963" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4964"><a href="#cb375-4964" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4965"><a href="#cb375-4965" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4966"><a href="#cb375-4966" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4967"><a href="#cb375-4967" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4968"><a href="#cb375-4968" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4969"><a href="#cb375-4969" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4970"><a href="#cb375-4970" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4971"><a href="#cb375-4971" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4972"><a href="#cb375-4972" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4973"><a href="#cb375-4973" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4974"><a href="#cb375-4974" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4975"><a href="#cb375-4975" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4976"><a href="#cb375-4976" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4977"><a href="#cb375-4977" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4978"><a href="#cb375-4978" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4979"><a href="#cb375-4979" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4980"><a href="#cb375-4980" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4981"><a href="#cb375-4981" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4982"><a href="#cb375-4982" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4983"><a href="#cb375-4983" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb375-4984"><a href="#cb375-4984" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4985"><a href="#cb375-4985" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4986"><a href="#cb375-4986" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-4987"><a href="#cb375-4987" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb375-4988"><a href="#cb375-4988" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb375-4989"><a href="#cb375-4989" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4990"><a href="#cb375-4990" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb375-4991"><a href="#cb375-4991" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4992"><a href="#cb375-4992" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4993"><a href="#cb375-4993" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4994"><a href="#cb375-4994" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4995"><a href="#cb375-4995" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-4996"><a href="#cb375-4996" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb375-4997"><a href="#cb375-4997" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-4998"><a href="#cb375-4998" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-4999"><a href="#cb375-4999" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-5000"><a href="#cb375-5000" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-5001"><a href="#cb375-5001" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-5002"><a href="#cb375-5002" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb375-5003"><a href="#cb375-5003" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb375-5004"><a href="#cb375-5004" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb375-5005"><a href="#cb375-5005" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb375-5006"><a href="#cb375-5006" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb375-5007"><a href="#cb375-5007" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-5008"><a href="#cb375-5008" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-5009"><a href="#cb375-5009" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-5010"><a href="#cb375-5010" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-5011"><a href="#cb375-5011" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb375-5012"><a href="#cb375-5012" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-5013"><a href="#cb375-5013" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-5014"><a href="#cb375-5014" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-5015"><a href="#cb375-5015" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb375-5016"><a href="#cb375-5016" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb375-5017"><a href="#cb375-5017" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb375-5018"><a href="#cb375-5018" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-5019"><a href="#cb375-5019" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5020"><a href="#cb375-5020" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb375-5021"><a href="#cb375-5021" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb375-5022"><a href="#cb375-5022" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb375-5023"><a href="#cb375-5023" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb375-5024"><a href="#cb375-5024" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb375-5025"><a href="#cb375-5025" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb375-5026"><a href="#cb375-5026" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb375-5027"><a href="#cb375-5027" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-5028"><a href="#cb375-5028" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5029"><a href="#cb375-5029" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-5030"><a href="#cb375-5030" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb375-5031"><a href="#cb375-5031" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb375-5032"><a href="#cb375-5032" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-5033"><a href="#cb375-5033" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb375-5034"><a href="#cb375-5034" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb375-5035"><a href="#cb375-5035" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb375-5036"><a href="#cb375-5036" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb375-5037"><a href="#cb375-5037" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb375-5038"><a href="#cb375-5038" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb375-5039"><a href="#cb375-5039" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb375-5040"><a href="#cb375-5040" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb375-5041"><a href="#cb375-5041" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb375-5042"><a href="#cb375-5042" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb375-5043"><a href="#cb375-5043" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5044"><a href="#cb375-5044" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb375-5045"><a href="#cb375-5045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5046"><a href="#cb375-5046" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb375-5047"><a href="#cb375-5047" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb375-5048"><a href="#cb375-5048" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb375-5049"><a href="#cb375-5049" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb375-5050"><a href="#cb375-5050" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb375-5051"><a href="#cb375-5051" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-5052"><a href="#cb375-5052" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb375-5053"><a href="#cb375-5053" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5054"><a href="#cb375-5054" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb375-5055"><a href="#cb375-5055" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb375-5056"><a href="#cb375-5056" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-5057"><a href="#cb375-5057" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb375-5058"><a href="#cb375-5058" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb375-5059"><a href="#cb375-5059" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-5060"><a href="#cb375-5060" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5061"><a href="#cb375-5061" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb375-5062"><a href="#cb375-5062" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb375-5063"><a href="#cb375-5063" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5064"><a href="#cb375-5064" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb375-5065"><a href="#cb375-5065" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb375-5066"><a href="#cb375-5066" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb375-5067"><a href="#cb375-5067" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb375-5068"><a href="#cb375-5068" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-5069"><a href="#cb375-5069" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb375-5070"><a href="#cb375-5070" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb375-5071"><a href="#cb375-5071" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5072"><a href="#cb375-5072" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb375-5073"><a href="#cb375-5073" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5074"><a href="#cb375-5074" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_score(</span>
<span id="cb375-5075"><a href="#cb375-5075" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span>,</span>
<span id="cb375-5076"><a href="#cb375-5076" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span>,</span>
<span id="cb375-5077"><a href="#cb375-5077" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb375-5078"><a href="#cb375-5078" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb375-5079"><a href="#cb375-5079" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-5080"><a href="#cb375-5080" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb375-5081"><a href="#cb375-5081" aria-hidden="true" tabindex="-1"></a>        gap_penalty <span class="cf">if</span> aligned_seq1[i] <span class="op">==</span> <span class="st">"-"</span> <span class="kw">or</span> aligned_seq2[i] <span class="op">==</span> <span class="st">"-"</span> <span class="cf">else</span></span>
<span id="cb375-5082"><a href="#cb375-5082" aria-hidden="true" tabindex="-1"></a>        scoring_matrix.get((aligned_seq1[i], aligned_seq2[i]),</span>
<span id="cb375-5083"><a href="#cb375-5083" aria-hidden="true" tabindex="-1"></a>                           scoring_matrix.get((aligned_seq2[i], aligned_seq1[i]), <span class="dv">0</span>))</span>
<span id="cb375-5084"><a href="#cb375-5084" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(aligned_seq1))</span>
<span id="cb375-5085"><a href="#cb375-5085" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-5086"><a href="#cb375-5086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5087"><a href="#cb375-5087" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_alignment_path(</span>
<span id="cb375-5088"><a href="#cb375-5088" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb375-5089"><a href="#cb375-5089" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb375-5090"><a href="#cb375-5090" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb375-5091"><a href="#cb375-5091" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb375-5092"><a href="#cb375-5092" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-5093"><a href="#cb375-5093" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> linear_space_alignment(top: <span class="bu">int</span>, bottom: <span class="bu">int</span>, left: <span class="bu">int</span>, right: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-5094"><a href="#cb375-5094" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left <span class="op">==</span> right:</span>
<span id="cb375-5095"><a href="#cb375-5095" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"↓"</span> <span class="op">*</span> (bottom <span class="op">-</span> top)</span>
<span id="cb375-5096"><a href="#cb375-5096" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> top <span class="op">==</span> bottom:</span>
<span id="cb375-5097"><a href="#cb375-5097" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"→"</span> <span class="op">*</span> (right <span class="op">-</span> left)</span>
<span id="cb375-5098"><a href="#cb375-5098" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-5099"><a href="#cb375-5099" aria-hidden="true" tabindex="-1"></a>            ((i, j), (i2, j2)) <span class="op">=</span> find_middle_edge(</span>
<span id="cb375-5100"><a href="#cb375-5100" aria-hidden="true" tabindex="-1"></a>                sequence1[top:bottom], sequence2[left:right], scoring_matrix, gap_penalty</span>
<span id="cb375-5101"><a href="#cb375-5101" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb375-5102"><a href="#cb375-5102" aria-hidden="true" tabindex="-1"></a>            edge <span class="op">=</span> <span class="st">"↓"</span> <span class="cf">if</span> j <span class="op">==</span> j2 <span class="cf">else</span> <span class="st">"→"</span> <span class="cf">if</span> i <span class="op">==</span> i2 <span class="cf">else</span> <span class="st">"↘"</span></span>
<span id="cb375-5103"><a href="#cb375-5103" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (</span>
<span id="cb375-5104"><a href="#cb375-5104" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(top, i <span class="op">+</span> top, left, j <span class="op">+</span> left) <span class="op">+</span></span>
<span id="cb375-5105"><a href="#cb375-5105" aria-hidden="true" tabindex="-1"></a>                edge <span class="op">+</span></span>
<span id="cb375-5106"><a href="#cb375-5106" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(i2 <span class="op">+</span> top, bottom, j2 <span class="op">+</span> left, right)</span>
<span id="cb375-5107"><a href="#cb375-5107" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb375-5108"><a href="#cb375-5108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5109"><a href="#cb375-5109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_space_alignment(<span class="dv">0</span>, <span class="bu">len</span>(sequence1), <span class="dv">0</span>, <span class="bu">len</span>(sequence2))</span>
<span id="cb375-5110"><a href="#cb375-5110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5111"><a href="#cb375-5111" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_alignment(</span>
<span id="cb375-5112"><a href="#cb375-5112" aria-hidden="true" tabindex="-1"></a>    alignment_path: <span class="bu">str</span>,</span>
<span id="cb375-5113"><a href="#cb375-5113" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb375-5114"><a href="#cb375-5114" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span></span>
<span id="cb375-5115"><a href="#cb375-5115" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb375-5116"><a href="#cb375-5116" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb375-5117"><a href="#cb375-5117" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb375-5118"><a href="#cb375-5118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> direction <span class="kw">in</span> alignment_path:</span>
<span id="cb375-5119"><a href="#cb375-5119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"↘"</span>:</span>
<span id="cb375-5120"><a href="#cb375-5120" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb375-5121"><a href="#cb375-5121" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb375-5122"><a href="#cb375-5122" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-5123"><a href="#cb375-5123" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-5124"><a href="#cb375-5124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"↓"</span>:</span>
<span id="cb375-5125"><a href="#cb375-5125" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb375-5126"><a href="#cb375-5126" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb375-5127"><a href="#cb375-5127" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-5128"><a href="#cb375-5128" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-5129"><a href="#cb375-5129" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb375-5130"><a href="#cb375-5130" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb375-5131"><a href="#cb375-5131" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-5132"><a href="#cb375-5132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> aligned_seq1, aligned_seq2</span>
<span id="cb375-5133"><a href="#cb375-5133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5134"><a href="#cb375-5134" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb375-5135"><a href="#cb375-5135" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-5136"><a href="#cb375-5136" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb375-5137"><a href="#cb375-5137" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb375-5138"><a href="#cb375-5138" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-5139"><a href="#cb375-5139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5140"><a href="#cb375-5140" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-5141"><a href="#cb375-5141" aria-hidden="true" tabindex="-1"></a>scoring_matrix <span class="op">=</span> BLOSUM62</span>
<span id="cb375-5142"><a href="#cb375-5142" aria-hidden="true" tabindex="-1"></a>alignment_path <span class="op">=</span> find_alignment_path(sequence1, sequence2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb375-5143"><a href="#cb375-5143" aria-hidden="true" tabindex="-1"></a>aligned_seq1, aligned_seq2 <span class="op">=</span> construct_alignment(alignment_path, sequence1, sequence2)</span>
<span id="cb375-5144"><a href="#cb375-5144" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_alignment_score(aligned_seq1, aligned_seq2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>))</span>
<span id="cb375-5145"><a href="#cb375-5145" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-5146"><a href="#cb375-5146" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5147"><a href="#cb375-5147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5148"><a href="#cb375-5148" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Multiple Sequence Alignment</span></span>
<span id="cb375-5149"><a href="#cb375-5149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5150"><a href="#cb375-5150" aria-hidden="true" tabindex="-1"></a>Multiple Longest Common Subsequence Problem. Find a longest common subsequence of multiple strings.</span>
<span id="cb375-5151"><a href="#cb375-5151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5152"><a href="#cb375-5152" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Three&nbsp;[DNA strings](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>dna<span class="op">-</span>string<span class="op">/</span>).</span>
<span id="cb375-5153"><a href="#cb375-5153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5154"><a href="#cb375-5154" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The maximum score of a multiple alignment of these three strings, followed by a multiple alignment of the three strings achieving this maximum. Use a scoring function <span class="kw">in</span> which the score of an alignment column <span class="kw">is</span> <span class="dv">1</span> <span class="cf">if</span> <span class="bu">all</span> three symbols are identical <span class="kw">and</span> <span class="dv">0</span> otherwise. (If more than one multiple alignment achieve the maximum, you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-5155"><a href="#cb375-5155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5156"><a href="#cb375-5156" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5157"><a href="#cb375-5157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5158"><a href="#cb375-5158" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5159"><a href="#cb375-5159" aria-hidden="true" tabindex="-1"></a>ATATCCG</span>
<span id="cb375-5160"><a href="#cb375-5160" aria-hidden="true" tabindex="-1"></a>TCCGA</span>
<span id="cb375-5161"><a href="#cb375-5161" aria-hidden="true" tabindex="-1"></a>ATGTACTG</span>
<span id="cb375-5162"><a href="#cb375-5162" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5163"><a href="#cb375-5163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5164"><a href="#cb375-5164" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5165"><a href="#cb375-5165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5166"><a href="#cb375-5166" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5167"><a href="#cb375-5167" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb375-5168"><a href="#cb375-5168" aria-hidden="true" tabindex="-1"></a>ATATCC<span class="op">-</span>G<span class="op">-</span></span>
<span id="cb375-5169"><a href="#cb375-5169" aria-hidden="true" tabindex="-1"></a><span class="op">---</span>TCC<span class="op">-</span>GA</span>
<span id="cb375-5170"><a href="#cb375-5170" aria-hidden="true" tabindex="-1"></a>ATGTACTG<span class="op">-</span></span>
<span id="cb375-5171"><a href="#cb375-5171" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5172"><a href="#cb375-5172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5173"><a href="#cb375-5173" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5174"><a href="#cb375-5174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5175"><a href="#cb375-5175" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5176"><a href="#cb375-5176" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb375-5177"><a href="#cb375-5177" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb375-5178"><a href="#cb375-5178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5179"><a href="#cb375-5179" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the coordinates are non-negative in the alignment matrix</span></span>
<span id="cb375-5180"><a href="#cb375-5180" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid_coordinate(pointer: Tuple[<span class="bu">int</span>, ...], position: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb375-5181"><a href="#cb375-5181" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>([i <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">for</span> i <span class="kw">in</span> get_previous_position(position, pointer)])</span>
<span id="cb375-5182"><a href="#cb375-5182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5183"><a href="#cb375-5183" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the previous position given a current position and a pointer</span></span>
<span id="cb375-5184"><a href="#cb375-5184" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_position(position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, ...]:</span>
<span id="cb375-5185"><a href="#cb375-5185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>([p <span class="op">+</span> d <span class="cf">for</span> p, d <span class="kw">in</span> <span class="bu">zip</span>(position, pointer)])</span>
<span id="cb375-5186"><a href="#cb375-5186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5187"><a href="#cb375-5187" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the score for a given position and pointer</span></span>
<span id="cb375-5188"><a href="#cb375-5188" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(sequences: List[<span class="bu">str</span>], position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-5189"><a href="#cb375-5189" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pointer <span class="op">==</span> (<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb375-5190"><a href="#cb375-5190" aria-hidden="true" tabindex="-1"></a>        bases <span class="op">=</span> [sequences[i][j] <span class="cf">for</span> i, j <span class="kw">in</span> <span class="bu">enumerate</span>(get_previous_position(position, pointer))]</span>
<span id="cb375-5191"><a href="#cb375-5191" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(<span class="bu">all</span>(base <span class="op">==</span> bases[<span class="dv">0</span>] <span class="cf">for</span> base <span class="kw">in</span> bases))</span>
<span id="cb375-5192"><a href="#cb375-5192" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-5193"><a href="#cb375-5193" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb375-5194"><a href="#cb375-5194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5195"><a href="#cb375-5195" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate possible previous cell pointers</span></span>
<span id="cb375-5196"><a href="#cb375-5196" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_moves(dimension: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, ...]]:</span>
<span id="cb375-5197"><a href="#cb375-5197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(product([<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], repeat<span class="op">=</span>dimension))[<span class="dv">1</span>:]</span>
<span id="cb375-5198"><a href="#cb375-5198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5199"><a href="#cb375-5199" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiple_sequence_alignment(sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb375-5200"><a href="#cb375-5200" aria-hidden="true" tabindex="-1"></a>    scores: Dict[Tuple[<span class="bu">int</span>, ...], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-5201"><a href="#cb375-5201" aria-hidden="true" tabindex="-1"></a>    pointers: Dict[Tuple[<span class="bu">int</span>, ...], Tuple[<span class="bu">int</span>, ...]] <span class="op">=</span> {}</span>
<span id="cb375-5202"><a href="#cb375-5202" aria-hidden="true" tabindex="-1"></a>    scores[(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-5203"><a href="#cb375-5203" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5204"><a href="#cb375-5204" aria-hidden="true" tabindex="-1"></a>    ranges <span class="op">=</span> [<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(seq) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> seq <span class="kw">in</span> sequences]</span>
<span id="cb375-5205"><a href="#cb375-5205" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5206"><a href="#cb375-5206" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> position <span class="kw">in</span> product(<span class="op">*</span>ranges):</span>
<span id="cb375-5207"><a href="#cb375-5207" aria-hidden="true" tabindex="-1"></a>        valid_pointers <span class="op">=</span> <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: is_valid_coordinate(x, position), generate_moves(<span class="dv">3</span>)))</span>
<span id="cb375-5208"><a href="#cb375-5208" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> valid_pointers:</span>
<span id="cb375-5209"><a href="#cb375-5209" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb375-5210"><a href="#cb375-5210" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-5211"><a href="#cb375-5211" aria-hidden="true" tabindex="-1"></a>        possible_scores <span class="op">=</span> [scores[get_previous_position(position, ptr)] <span class="op">+</span> calculate_score(sequences, position, ptr) <span class="cf">for</span> ptr <span class="kw">in</span> valid_pointers]</span>
<span id="cb375-5212"><a href="#cb375-5212" aria-hidden="true" tabindex="-1"></a>        scores[position] <span class="op">=</span> <span class="bu">max</span>(possible_scores)</span>
<span id="cb375-5213"><a href="#cb375-5213" aria-hidden="true" tabindex="-1"></a>        pointers[position] <span class="op">=</span> valid_pointers[possible_scores.index(<span class="bu">max</span>(possible_scores))]</span>
<span id="cb375-5214"><a href="#cb375-5214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5215"><a href="#cb375-5215" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to recover alignment</span></span>
<span id="cb375-5216"><a href="#cb375-5216" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> scores[position]</span>
<span id="cb375-5217"><a href="#cb375-5217" aria-hidden="true" tabindex="-1"></a>    aligned_sequences <span class="op">=</span> [<span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>]</span>
<span id="cb375-5218"><a href="#cb375-5218" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5219"><a href="#cb375-5219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">any</span>([x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> position]):</span>
<span id="cb375-5220"><a href="#cb375-5220" aria-hidden="true" tabindex="-1"></a>        pointer <span class="op">=</span> pointers[position]</span>
<span id="cb375-5221"><a href="#cb375-5221" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, seq <span class="kw">in</span> <span class="bu">enumerate</span>(sequences):</span>
<span id="cb375-5222"><a href="#cb375-5222" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[i] <span class="op">+=</span> seq[position[i] <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> pointer[i] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="cf">else</span> <span class="st">"-"</span></span>
<span id="cb375-5223"><a href="#cb375-5223" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> get_previous_position(position, pointer)</span>
<span id="cb375-5224"><a href="#cb375-5224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5225"><a href="#cb375-5225" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (total_score, </span>
<span id="cb375-5226"><a href="#cb375-5226" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">0</span>][::<span class="op">-</span><span class="dv">1</span>], </span>
<span id="cb375-5227"><a href="#cb375-5227" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">1</span>][::<span class="op">-</span><span class="dv">1</span>], </span>
<span id="cb375-5228"><a href="#cb375-5228" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">2</span>][::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb375-5229"><a href="#cb375-5229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5230"><a href="#cb375-5230" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-5231"><a href="#cb375-5231" aria-hidden="true" tabindex="-1"></a><span class="st">ATATCCG</span></span>
<span id="cb375-5232"><a href="#cb375-5232" aria-hidden="true" tabindex="-1"></a><span class="st">TCCGA</span></span>
<span id="cb375-5233"><a href="#cb375-5233" aria-hidden="true" tabindex="-1"></a><span class="st">ATGTACTG</span></span>
<span id="cb375-5234"><a href="#cb375-5234" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-5235"><a href="#cb375-5235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5236"><a href="#cb375-5236" aria-hidden="true" tabindex="-1"></a>sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-5237"><a href="#cb375-5237" aria-hidden="true" tabindex="-1"></a>alignment_score, seq1, seq2, seq3 <span class="op">=</span> multiple_sequence_alignment(sequences)</span>
<span id="cb375-5238"><a href="#cb375-5238" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb375-5239"><a href="#cb375-5239" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq1)</span>
<span id="cb375-5240"><a href="#cb375-5240" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq2)</span>
<span id="cb375-5241"><a href="#cb375-5241" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq3)</span>
<span id="cb375-5242"><a href="#cb375-5242" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5243"><a href="#cb375-5243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5244"><a href="#cb375-5244" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Topological Ordering of a DAG</span></span>
<span id="cb375-5245"><a href="#cb375-5245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5246"><a href="#cb375-5246" aria-hidden="true" tabindex="-1"></a>Topological Ordering Problem. Find a topological ordering of a directed acyclic graph.</span>
<span id="cb375-5247"><a href="#cb375-5247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5248"><a href="#cb375-5248" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;The&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>)&nbsp;of a graph (<span class="cf">with</span> nodes represented by integers).</span>
<span id="cb375-5249"><a href="#cb375-5249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5250"><a href="#cb375-5250" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A topological ordering of this graph.</span>
<span id="cb375-5251"><a href="#cb375-5251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5252"><a href="#cb375-5252" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5253"><a href="#cb375-5253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5254"><a href="#cb375-5254" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5255"><a href="#cb375-5255" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb375-5256"><a href="#cb375-5256" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb375-5257"><a href="#cb375-5257" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="op">-&gt;</span> <span class="dv">2</span></span>
<span id="cb375-5258"><a href="#cb375-5258" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="op">-&gt;</span> <span class="dv">3</span></span>
<span id="cb375-5259"><a href="#cb375-5259" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5260"><a href="#cb375-5260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5261"><a href="#cb375-5261" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5262"><a href="#cb375-5262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5263"><a href="#cb375-5263" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5264"><a href="#cb375-5264" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">3</span></span>
<span id="cb375-5265"><a href="#cb375-5265" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5266"><a href="#cb375-5266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5267"><a href="#cb375-5267" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5268"><a href="#cb375-5268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5269"><a href="#cb375-5269" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5270"><a href="#cb375-5270" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Set</span>
<span id="cb375-5271"><a href="#cb375-5271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5272"><a href="#cb375-5272" aria-hidden="true" tabindex="-1"></a>NodeLabel <span class="op">=</span> <span class="bu">str</span></span>
<span id="cb375-5273"><a href="#cb375-5273" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[NodeLabel, List[NodeLabel]]</span>
<span id="cb375-5274"><a href="#cb375-5274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5275"><a href="#cb375-5275" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_graph(edge_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Graph:</span>
<span id="cb375-5276"><a href="#cb375-5276" aria-hidden="true" tabindex="-1"></a>    graph: Graph <span class="op">=</span> {}</span>
<span id="cb375-5277"><a href="#cb375-5277" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edge_list:</span>
<span id="cb375-5278"><a href="#cb375-5278" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> edge.split(<span class="st">" -&gt; "</span>)</span>
<span id="cb375-5279"><a href="#cb375-5279" aria-hidden="true" tabindex="-1"></a>        target_list <span class="op">=</span> targets.split(<span class="st">","</span>)</span>
<span id="cb375-5280"><a href="#cb375-5280" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb375-5281"><a href="#cb375-5281" aria-hidden="true" tabindex="-1"></a>            graph[source] <span class="op">=</span> []</span>
<span id="cb375-5282"><a href="#cb375-5282" aria-hidden="true" tabindex="-1"></a>        graph[source].extend(target_list)</span>
<span id="cb375-5283"><a href="#cb375-5283" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> target_list:</span>
<span id="cb375-5284"><a href="#cb375-5284" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb375-5285"><a href="#cb375-5285" aria-hidden="true" tabindex="-1"></a>                graph[target] <span class="op">=</span> []</span>
<span id="cb375-5286"><a href="#cb375-5286" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-5287"><a href="#cb375-5287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5288"><a href="#cb375-5288" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> depth_first_search(graph: Graph, node: NodeLabel, visited: Set[NodeLabel], stack: List[NodeLabel]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-5289"><a href="#cb375-5289" aria-hidden="true" tabindex="-1"></a>    visited.add(node)</span>
<span id="cb375-5290"><a href="#cb375-5290" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> graph.get(node, []):</span>
<span id="cb375-5291"><a href="#cb375-5291" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb375-5292"><a href="#cb375-5292" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, neighbor, visited, stack)</span>
<span id="cb375-5293"><a href="#cb375-5293" aria-hidden="true" tabindex="-1"></a>    stack.insert(<span class="dv">0</span>, node)</span>
<span id="cb375-5294"><a href="#cb375-5294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5295"><a href="#cb375-5295" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph: Graph) <span class="op">-&gt;</span> List[NodeLabel]:</span>
<span id="cb375-5296"><a href="#cb375-5296" aria-hidden="true" tabindex="-1"></a>    visited: Set[NodeLabel] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-5297"><a href="#cb375-5297" aria-hidden="true" tabindex="-1"></a>    stack: List[NodeLabel] <span class="op">=</span> []</span>
<span id="cb375-5298"><a href="#cb375-5298" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb375-5299"><a href="#cb375-5299" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb375-5300"><a href="#cb375-5300" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, node, visited, stack)</span>
<span id="cb375-5301"><a href="#cb375-5301" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack</span>
<span id="cb375-5302"><a href="#cb375-5302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5303"><a href="#cb375-5303" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-5304"><a href="#cb375-5304" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_text.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-5305"><a href="#cb375-5305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5306"><a href="#cb375-5306" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb375-5307"><a href="#cb375-5307" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-5308"><a href="#cb375-5308" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb375-5309"><a href="#cb375-5309" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb375-5310"><a href="#cb375-5310" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb375-5311"><a href="#cb375-5311" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 3</span></span>
<span id="cb375-5312"><a href="#cb375-5312" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-5313"><a href="#cb375-5313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5314"><a href="#cb375-5314" aria-hidden="true" tabindex="-1"></a>edge_list <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-5315"><a href="#cb375-5315" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> create_graph(edge_list)</span>
<span id="cb375-5316"><a href="#cb375-5316" aria-hidden="true" tabindex="-1"></a>sorted_nodes <span class="op">=</span> topological_sort(graph)</span>
<span id="cb375-5317"><a href="#cb375-5317" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">", "</span>.join(sorted_nodes))</span>
<span id="cb375-5318"><a href="#cb375-5318" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5319"><a href="#cb375-5319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5320"><a href="#cb375-5320" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GreedySorting to Sort a Permutation by Reversals</span></span>
<span id="cb375-5321"><a href="#cb375-5321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5322"><a href="#cb375-5322" aria-hidden="true" tabindex="-1"></a>Implement&nbsp;<span class="op">*</span>GreedySorting<span class="op">*</span>.</span>
<span id="cb375-5323"><a href="#cb375-5323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5324"><a href="#cb375-5324" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[signed permutation](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>signed<span class="op">-</span>permutation<span class="op">/</span>)&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb375-5325"><a href="#cb375-5325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5326"><a href="#cb375-5326" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The sequence of permutations corresponding to applying&nbsp;<span class="op">*</span>GreedySorting<span class="op">*</span>&nbsp;to&nbsp;<span class="op">*</span>P<span class="op">*</span>, ending <span class="cf">with</span> the identity permutation.</span>
<span id="cb375-5327"><a href="#cb375-5327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5328"><a href="#cb375-5328" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5329"><a href="#cb375-5329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5330"><a href="#cb375-5330" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5331"><a href="#cb375-5331" aria-hidden="true" tabindex="-1"></a>(<span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb375-5332"><a href="#cb375-5332" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5333"><a href="#cb375-5333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5334"><a href="#cb375-5334" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5335"><a href="#cb375-5335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5336"><a href="#cb375-5336" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5337"><a href="#cb375-5337" aria-hidden="true" tabindex="-1"></a>(<span class="op">-</span><span class="dv">1</span> <span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb375-5338"><a href="#cb375-5338" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">2</span>)</span>
<span id="cb375-5339"><a href="#cb375-5339" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">5</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb375-5340"><a href="#cb375-5340" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">5</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb375-5341"><a href="#cb375-5341" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">-</span><span class="dv">4</span> <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb375-5342"><a href="#cb375-5342" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb375-5343"><a href="#cb375-5343" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">+</span><span class="dv">5</span>)</span>
<span id="cb375-5344"><a href="#cb375-5344" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5345"><a href="#cb375-5345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5346"><a href="#cb375-5346" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5347"><a href="#cb375-5347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5348"><a href="#cb375-5348" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5349"><a href="#cb375-5349" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb375-5350"><a href="#cb375-5350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5351"><a href="#cb375-5351" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perform_k_sorting_reversal(permutation: List[<span class="bu">int</span>], k: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5352"><a href="#cb375-5352" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> k</span>
<span id="cb375-5353"><a href="#cb375-5353" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">abs</span>(permutation[j]) <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb375-5354"><a href="#cb375-5354" aria-hidden="true" tabindex="-1"></a>        j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-5355"><a href="#cb375-5355" aria-hidden="true" tabindex="-1"></a>    permutation[k:j<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> [<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">reversed</span>(permutation[k:j<span class="op">+</span><span class="dv">1</span>])]</span>
<span id="cb375-5356"><a href="#cb375-5356" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> permutation</span>
<span id="cb375-5357"><a href="#cb375-5357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5358"><a href="#cb375-5358" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_sorting(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-5359"><a href="#cb375-5359" aria-hidden="true" tabindex="-1"></a>    reversal_sequence: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-5360"><a href="#cb375-5360" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(permutation)):</span>
<span id="cb375-5361"><a href="#cb375-5361" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> permutation[k] <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb375-5362"><a href="#cb375-5362" aria-hidden="true" tabindex="-1"></a>            permutation <span class="op">=</span> perform_k_sorting_reversal(permutation, k)</span>
<span id="cb375-5363"><a href="#cb375-5363" aria-hidden="true" tabindex="-1"></a>            reversal_sequence.append(<span class="bu">list</span>(permutation))</span>
<span id="cb375-5364"><a href="#cb375-5364" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversal_sequence</span>
<span id="cb375-5365"><a href="#cb375-5365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5366"><a href="#cb375-5366" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5367"><a href="#cb375-5367" aria-hidden="true" tabindex="-1"></a>    cleaned_input <span class="op">=</span> input_text.strip().replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb375-5368"><a href="#cb375-5368" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> cleaned_input.split()]</span>
<span id="cb375-5369"><a href="#cb375-5369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5370"><a href="#cb375-5370" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_permutation(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-5371"><a href="#cb375-5371" aria-hidden="true" tabindex="-1"></a>    formatted_elements <span class="op">=</span> [(<span class="st">"+"</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">""</span>) <span class="op">+</span> <span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation]</span>
<span id="cb375-5372"><a href="#cb375-5372" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join(formatted_elements) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb375-5373"><a href="#cb375-5373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5374"><a href="#cb375-5374" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb375-5375"><a href="#cb375-5375" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-5376"><a href="#cb375-5376" aria-hidden="true" tabindex="-1"></a><span class="st">(-3 +4 +1 +5 -2)</span></span>
<span id="cb375-5377"><a href="#cb375-5377" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-5378"><a href="#cb375-5378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5379"><a href="#cb375-5379" aria-hidden="true" tabindex="-1"></a>initial_permutation <span class="op">=</span> parse_permutation(sample_input)</span>
<span id="cb375-5380"><a href="#cb375-5380" aria-hidden="true" tabindex="-1"></a>sorting_sequence <span class="op">=</span> greedy_sorting(initial_permutation)</span>
<span id="cb375-5381"><a href="#cb375-5381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5382"><a href="#cb375-5382" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> permutation <span class="kw">in</span> sorting_sequence:</span>
<span id="cb375-5383"><a href="#cb375-5383" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(format_permutation(permutation))</span>
<span id="cb375-5384"><a href="#cb375-5384" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5385"><a href="#cb375-5385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5386"><a href="#cb375-5386" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Number of Breakpoints in a Permutation</span></span>
<span id="cb375-5387"><a href="#cb375-5387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5388"><a href="#cb375-5388" aria-hidden="true" tabindex="-1"></a>Number of Breakpoints Problem. Find the number of breakpoints <span class="kw">in</span> a permutation.</span>
<span id="cb375-5389"><a href="#cb375-5389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5390"><a href="#cb375-5390" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A&nbsp;[signed permutation](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>signed<span class="op">-</span>permutation<span class="op">/</span>)&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb375-5391"><a href="#cb375-5391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5392"><a href="#cb375-5392" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The number of breakpoints in&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb375-5393"><a href="#cb375-5393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5394"><a href="#cb375-5394" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5395"><a href="#cb375-5395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5396"><a href="#cb375-5396" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5397"><a href="#cb375-5397" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">12</span> <span class="op">-</span><span class="dv">8</span> <span class="op">-</span><span class="dv">7</span> <span class="op">-</span><span class="dv">6</span> <span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">10</span> <span class="op">+</span><span class="dv">9</span> <span class="op">-</span><span class="dv">11</span> <span class="op">+</span><span class="dv">13</span> <span class="op">+</span><span class="dv">14</span>)</span>
<span id="cb375-5398"><a href="#cb375-5398" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5399"><a href="#cb375-5399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5400"><a href="#cb375-5400" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5401"><a href="#cb375-5401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5402"><a href="#cb375-5402" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5403"><a href="#cb375-5403" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb375-5404"><a href="#cb375-5404" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5405"><a href="#cb375-5405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5406"><a href="#cb375-5406" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5407"><a href="#cb375-5407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5408"><a href="#cb375-5408" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5409"><a href="#cb375-5409" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb375-5410"><a href="#cb375-5410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5411"><a href="#cb375-5411" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_breakpoints(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-5412"><a href="#cb375-5412" aria-hidden="true" tabindex="-1"></a>    augmented_permutation <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> permutation <span class="op">+</span> [<span class="bu">max</span>(permutation) <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-5413"><a href="#cb375-5413" aria-hidden="true" tabindex="-1"></a>    breakpoint_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-5414"><a href="#cb375-5414" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5415"><a href="#cb375-5415" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(augmented_permutation) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb375-5416"><a href="#cb375-5416" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> augmented_permutation[i] <span class="op">!=</span> augmented_permutation[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb375-5417"><a href="#cb375-5417" aria-hidden="true" tabindex="-1"></a>            breakpoint_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-5418"><a href="#cb375-5418" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-5419"><a href="#cb375-5419" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> breakpoint_count</span>
<span id="cb375-5420"><a href="#cb375-5420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5421"><a href="#cb375-5421" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-5422"><a href="#cb375-5422" aria-hidden="true" tabindex="-1"></a><span class="st">(+3 +4 +5 -12 -8 -7 -6 +1 +2 +10 +9 -11 +13 +14)</span></span>
<span id="cb375-5423"><a href="#cb375-5423" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-5424"><a href="#cb375-5424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5425"><a href="#cb375-5425" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> sample_input.strip()</span>
<span id="cb375-5426"><a href="#cb375-5426" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> permutation_string.replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb375-5427"><a href="#cb375-5427" aria-hidden="true" tabindex="-1"></a>permutation <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation_string.split()]</span>
<span id="cb375-5428"><a href="#cb375-5428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5429"><a href="#cb375-5429" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_breakpoints(permutation))</span>
<span id="cb375-5430"><a href="#cb375-5430" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5431"><a href="#cb375-5431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5432"><a href="#cb375-5432" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the 2-Break Distance Between a Pair of Genomes</span></span>
<span id="cb375-5433"><a href="#cb375-5433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5434"><a href="#cb375-5434" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-</span>Break Distance Problem. Find the <span class="dv">2</span><span class="op">-</span><span class="cf">break</span> distance between two genomes.</span>
<span id="cb375-5435"><a href="#cb375-5435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5436"><a href="#cb375-5436" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two genomes <span class="cf">with</span> circular chromosomes on the same <span class="bu">set</span> of synteny blocks.</span>
<span id="cb375-5437"><a href="#cb375-5437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5438"><a href="#cb375-5438" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The <span class="dv">2</span><span class="op">-</span><span class="cf">break</span> distance between these two genomes.</span>
<span id="cb375-5439"><a href="#cb375-5439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5440"><a href="#cb375-5440" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5441"><a href="#cb375-5441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5442"><a href="#cb375-5442" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5443"><a href="#cb375-5443" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">+</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span> <span class="op">+</span><span class="dv">5</span> <span class="op">+</span><span class="dv">6</span>)</span>
<span id="cb375-5444"><a href="#cb375-5444" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">6</span> <span class="op">-</span><span class="dv">5</span>)(<span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span>)</span>
<span id="cb375-5445"><a href="#cb375-5445" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5446"><a href="#cb375-5446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5447"><a href="#cb375-5447" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5448"><a href="#cb375-5448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5449"><a href="#cb375-5449" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5450"><a href="#cb375-5450" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb375-5451"><a href="#cb375-5451" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5452"><a href="#cb375-5452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5453"><a href="#cb375-5453" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5454"><a href="#cb375-5454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5455"><a href="#cb375-5455" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5456"><a href="#cb375-5456" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb375-5457"><a href="#cb375-5457" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-5458"><a href="#cb375-5458" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, DefaultDict</span>
<span id="cb375-5459"><a href="#cb375-5459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5460"><a href="#cb375-5460" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-5461"><a href="#cb375-5461" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb375-5462"><a href="#cb375-5462" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-5463"><a href="#cb375-5463" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb375-5464"><a href="#cb375-5464" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb375-5465"><a href="#cb375-5465" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb375-5466"><a href="#cb375-5466" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb375-5467"><a href="#cb375-5467" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb375-5468"><a href="#cb375-5468" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb375-5469"><a href="#cb375-5469" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb375-5470"><a href="#cb375-5470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5471"><a href="#cb375-5471" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb375-5472"><a href="#cb375-5472" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-5473"><a href="#cb375-5473" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string):</span>
<span id="cb375-5474"><a href="#cb375-5474" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb375-5475"><a href="#cb375-5475" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb375-5476"><a href="#cb375-5476" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb375-5477"><a href="#cb375-5477" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb375-5478"><a href="#cb375-5478" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb375-5479"><a href="#cb375-5479" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb375-5480"><a href="#cb375-5480" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb375-5481"><a href="#cb375-5481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5482"><a href="#cb375-5482" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb375-5483"><a href="#cb375-5483" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb375-5484"><a href="#cb375-5484" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb375-5485"><a href="#cb375-5485" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb375-5486"><a href="#cb375-5486" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb375-5487"><a href="#cb375-5487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5488"><a href="#cb375-5488" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_two_break_distance(genomes: List[DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-5489"><a href="#cb375-5489" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(<span class="op">*</span>genomes)</span>
<span id="cb375-5490"><a href="#cb375-5490" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(combined_graph.keys())</span>
<span id="cb375-5491"><a href="#cb375-5491" aria-hidden="true" tabindex="-1"></a>    num_blocks <span class="op">=</span> <span class="bu">len</span>(nodes) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb375-5492"><a href="#cb375-5492" aria-hidden="true" tabindex="-1"></a>    num_components <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-5493"><a href="#cb375-5493" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb375-5494"><a href="#cb375-5494" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), combined_graph)</span>
<span id="cb375-5495"><a href="#cb375-5495" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">-=</span> component</span>
<span id="cb375-5496"><a href="#cb375-5496" aria-hidden="true" tabindex="-1"></a>        num_components <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-5497"><a href="#cb375-5497" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num_blocks <span class="op">-</span> num_components</span>
<span id="cb375-5498"><a href="#cb375-5498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5499"><a href="#cb375-5499" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-5500"><a href="#cb375-5500" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 +3 +4 +5 +6)</span></span>
<span id="cb375-5501"><a href="#cb375-5501" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -3 -6 -5)(+2 -4)</span></span>
<span id="cb375-5502"><a href="#cb375-5502" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-5503"><a href="#cb375-5503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5504"><a href="#cb375-5504" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-5505"><a href="#cb375-5505" aria-hidden="true" tabindex="-1"></a>genomes <span class="op">=</span> [parse_genome_graph(genome_string) <span class="cf">for</span> genome_string <span class="kw">in</span> input_lines]</span>
<span id="cb375-5506"><a href="#cb375-5506" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_two_break_distance(genomes))</span>
<span id="cb375-5507"><a href="#cb375-5507" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5508"><a href="#cb375-5508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5509"><a href="#cb375-5509" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Shortest Transformation of One Genome into Another by 2-Breaks</span></span>
<span id="cb375-5510"><a href="#cb375-5510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5511"><a href="#cb375-5511" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-</span>Break Sorting Problem. Find a shortest transformation of one genome into another by <span class="dv">2</span><span class="op">-</span>breaks.</span>
<span id="cb375-5512"><a href="#cb375-5512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5513"><a href="#cb375-5513" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Two genomes <span class="cf">with</span> circular chromosomes on the same <span class="bu">set</span> of synteny blocks.</span>
<span id="cb375-5514"><a href="#cb375-5514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5515"><a href="#cb375-5515" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The sequence of genomes resulting <span class="im">from</span> applying a shortest sequence of <span class="dv">2</span><span class="op">-</span>breaks transforming one genome into the other.</span>
<span id="cb375-5516"><a href="#cb375-5516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5517"><a href="#cb375-5517" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5518"><a href="#cb375-5518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5519"><a href="#cb375-5519" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5520"><a href="#cb375-5520" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb375-5521"><a href="#cb375-5521" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span> <span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb375-5522"><a href="#cb375-5522" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5523"><a href="#cb375-5523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5524"><a href="#cb375-5524" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5525"><a href="#cb375-5525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5526"><a href="#cb375-5526" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5527"><a href="#cb375-5527" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb375-5528"><a href="#cb375-5528" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb375-5529"><a href="#cb375-5529" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="dv">3</span>)</span>
<span id="cb375-5530"><a href="#cb375-5530" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">+</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span> <span class="op">-</span><span class="dv">3</span>)</span>
<span id="cb375-5531"><a href="#cb375-5531" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5532"><a href="#cb375-5532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5533"><a href="#cb375-5533" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5534"><a href="#cb375-5534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5535"><a href="#cb375-5535" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5536"><a href="#cb375-5536" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb375-5537"><a href="#cb375-5537" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-5538"><a href="#cb375-5538" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Generator, DefaultDict</span>
<span id="cb375-5539"><a href="#cb375-5539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5540"><a href="#cb375-5540" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-5541"><a href="#cb375-5541" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb375-5542"><a href="#cb375-5542" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-5543"><a href="#cb375-5543" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb375-5544"><a href="#cb375-5544" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb375-5545"><a href="#cb375-5545" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb375-5546"><a href="#cb375-5546" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb375-5547"><a href="#cb375-5547" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb375-5548"><a href="#cb375-5548" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb375-5549"><a href="#cb375-5549" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb375-5550"><a href="#cb375-5550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5551"><a href="#cb375-5551" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb375-5552"><a href="#cb375-5552" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-5553"><a href="#cb375-5553" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string):</span>
<span id="cb375-5554"><a href="#cb375-5554" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb375-5555"><a href="#cb375-5555" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb375-5556"><a href="#cb375-5556" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb375-5557"><a href="#cb375-5557" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb375-5558"><a href="#cb375-5558" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb375-5559"><a href="#cb375-5559" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb375-5560"><a href="#cb375-5560" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb375-5561"><a href="#cb375-5561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5562"><a href="#cb375-5562" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb375-5563"><a href="#cb375-5563" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb375-5564"><a href="#cb375-5564" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb375-5565"><a href="#cb375-5565" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb375-5566"><a href="#cb375-5566" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb375-5567"><a href="#cb375-5567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5568"><a href="#cb375-5568" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_perm(perm: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-5569"><a href="#cb375-5569" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> x <span class="kw">in</span> perm]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb375-5570"><a href="#cb375-5570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5571"><a href="#cb375-5571" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_components(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[Set[<span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-5572"><a href="#cb375-5572" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb375-5573"><a href="#cb375-5573" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb375-5574"><a href="#cb375-5574" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), graph)</span>
<span id="cb375-5575"><a href="#cb375-5575" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> component</span>
<span id="cb375-5576"><a href="#cb375-5576" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> component</span>
<span id="cb375-5577"><a href="#cb375-5577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5578"><a href="#cb375-5578" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> non_trivial_cycle_nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>] <span class="op">|</span> <span class="va">None</span>:</span>
<span id="cb375-5579"><a href="#cb375-5579" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> find_components(graph):</span>
<span id="cb375-5580"><a href="#cb375-5580" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(component) <span class="op">&gt;</span> <span class="dv">2</span>:</span>
<span id="cb375-5581"><a href="#cb375-5581" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">list</span>(component)</span>
<span id="cb375-5582"><a href="#cb375-5582" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb375-5583"><a href="#cb375-5583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5584"><a href="#cb375-5584" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_genome_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5585"><a href="#cb375-5585" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb375-5586"><a href="#cb375-5586" aria-hidden="true" tabindex="-1"></a>    visited: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-5587"><a href="#cb375-5587" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb375-5588"><a href="#cb375-5588" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb375-5589"><a href="#cb375-5589" aria-hidden="true" tabindex="-1"></a>        visited.append(current_node)</span>
<span id="cb375-5590"><a href="#cb375-5590" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb375-5591"><a href="#cb375-5591" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">-</span>neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb375-5592"><a href="#cb375-5592" aria-hidden="true" tabindex="-1"></a>                queue.append(<span class="op">-</span>neighbor)</span>
<span id="cb375-5593"><a href="#cb375-5593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb375-5594"><a href="#cb375-5594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5595"><a href="#cb375-5595" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_genome_graph(genome_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-5596"><a href="#cb375-5596" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(genome_graph.keys())</span>
<span id="cb375-5597"><a href="#cb375-5597" aria-hidden="true" tabindex="-1"></a>    components: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-5598"><a href="#cb375-5598" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb375-5599"><a href="#cb375-5599" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_genome_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), genome_graph)</span>
<span id="cb375-5600"><a href="#cb375-5600" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(component)</span>
<span id="cb375-5601"><a href="#cb375-5601" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> component)</span>
<span id="cb375-5602"><a href="#cb375-5602" aria-hidden="true" tabindex="-1"></a>        components.append(component)</span>
<span id="cb375-5603"><a href="#cb375-5603" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join([format_perm(c) <span class="cf">for</span> c <span class="kw">in</span> components])</span>
<span id="cb375-5604"><a href="#cb375-5604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5605"><a href="#cb375-5605" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-5606"><a href="#cb375-5606" aria-hidden="true" tabindex="-1"></a>    graph[node1].append(node2)</span>
<span id="cb375-5607"><a href="#cb375-5607" aria-hidden="true" tabindex="-1"></a>    graph[node2].append(node1)</span>
<span id="cb375-5608"><a href="#cb375-5608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5609"><a href="#cb375-5609" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> del_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-5610"><a href="#cb375-5610" aria-hidden="true" tabindex="-1"></a>    graph[node1].remove(node2)</span>
<span id="cb375-5611"><a href="#cb375-5611" aria-hidden="true" tabindex="-1"></a>    graph[node2].remove(node1)</span>
<span id="cb375-5612"><a href="#cb375-5612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5613"><a href="#cb375-5613" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6d(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-5614"><a href="#cb375-5614" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb375-5615"><a href="#cb375-5615" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb375-5616"><a href="#cb375-5616" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb375-5617"><a href="#cb375-5617" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb375-5618"><a href="#cb375-5618" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> nodes[<span class="dv">0</span>]</span>
<span id="cb375-5619"><a href="#cb375-5619" aria-hidden="true" tabindex="-1"></a>        i2 <span class="op">=</span> genome2[nodes[<span class="dv">0</span>]][<span class="dv">0</span>]</span>
<span id="cb375-5620"><a href="#cb375-5620" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> genome1[j][<span class="dv">0</span>]</span>
<span id="cb375-5621"><a href="#cb375-5621" aria-hidden="true" tabindex="-1"></a>        j2 <span class="op">=</span> genome1[i2][<span class="dv">0</span>]</span>
<span id="cb375-5622"><a href="#cb375-5622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5623"><a href="#cb375-5623" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i, j)</span>
<span id="cb375-5624"><a href="#cb375-5624" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i2, j2)</span>
<span id="cb375-5625"><a href="#cb375-5625" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j, i2)</span>
<span id="cb375-5626"><a href="#cb375-5626" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j2, i)</span>
<span id="cb375-5627"><a href="#cb375-5627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5628"><a href="#cb375-5628" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb375-5629"><a href="#cb375-5629" aria-hidden="true" tabindex="-1"></a>        combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb375-5630"><a href="#cb375-5630" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb375-5631"><a href="#cb375-5631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5632"><a href="#cb375-5632" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-5633"><a href="#cb375-5633" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -2 -3 +4)</span></span>
<span id="cb375-5634"><a href="#cb375-5634" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 -4 -3)</span></span>
<span id="cb375-5635"><a href="#cb375-5635" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-5636"><a href="#cb375-5636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5637"><a href="#cb375-5637" aria-hidden="true" tabindex="-1"></a>genome1, genome2 <span class="op">=</span> [parse_genome_graph(s) <span class="cf">for</span> s <span class="kw">in</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)]</span>
<span id="cb375-5638"><a href="#cb375-5638" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> genome <span class="kw">in</span> ba6d(genome1, genome2):</span>
<span id="cb375-5639"><a href="#cb375-5639" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(genome)</span>
<span id="cb375-5640"><a href="#cb375-5640" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5641"><a href="#cb375-5641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5642"><a href="#cb375-5642" aria-hidden="true" tabindex="-1"></a><span class="co"># Find All Shared k-mers of a Pair of Strings</span></span>
<span id="cb375-5643"><a href="#cb375-5643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5644"><a href="#cb375-5644" aria-hidden="true" tabindex="-1"></a>Shared&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers Problem. Given two strings, find <span class="bu">all</span> their shared k<span class="op">-</span>mers.</span>
<span id="cb375-5645"><a href="#cb375-5645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5646"><a href="#cb375-5646" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and two strings.</span>
<span id="cb375-5647"><a href="#cb375-5647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5648"><a href="#cb375-5648" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All&nbsp;<span class="op">*</span>k<span class="op">*-</span>mers shared by these strings, <span class="kw">in</span> the form of ordered pairs (<span class="op">*</span>x<span class="op">*</span>,&nbsp;<span class="op">*</span>y<span class="op">*</span>) corresponding to starting positions of these k<span class="op">-</span>mers <span class="kw">in</span> the respective strings.</span>
<span id="cb375-5649"><a href="#cb375-5649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5650"><a href="#cb375-5650" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5651"><a href="#cb375-5651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5652"><a href="#cb375-5652" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5653"><a href="#cb375-5653" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb375-5654"><a href="#cb375-5654" aria-hidden="true" tabindex="-1"></a>AAACTCATC</span>
<span id="cb375-5655"><a href="#cb375-5655" aria-hidden="true" tabindex="-1"></a>TTTCAAATC</span>
<span id="cb375-5656"><a href="#cb375-5656" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5657"><a href="#cb375-5657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5658"><a href="#cb375-5658" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5659"><a href="#cb375-5659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5660"><a href="#cb375-5660" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5661"><a href="#cb375-5661" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span>, <span class="dv">4</span>)</span>
<span id="cb375-5662"><a href="#cb375-5662" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb375-5663"><a href="#cb375-5663" aria-hidden="true" tabindex="-1"></a>(<span class="dv">4</span>, <span class="dv">2</span>)</span>
<span id="cb375-5664"><a href="#cb375-5664" aria-hidden="true" tabindex="-1"></a>(<span class="dv">6</span>, <span class="dv">6</span>)</span>
<span id="cb375-5665"><a href="#cb375-5665" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5666"><a href="#cb375-5666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5667"><a href="#cb375-5667" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5668"><a href="#cb375-5668" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5669"><a href="#cb375-5669" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5670"><a href="#cb375-5670" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb375-5671"><a href="#cb375-5671" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb375-5672"><a href="#cb375-5672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5673"><a href="#cb375-5673" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-5674"><a href="#cb375-5674" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb375-5675"><a href="#cb375-5675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5676"><a href="#cb375-5676" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_overlapping_matches(pattern: <span class="bu">str</span>, sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[re.Match]:</span>
<span id="cb375-5677"><a href="#cb375-5677" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> re.finditer(<span class="vs">rf"(?=(</span><span class="sc">{</span>pattern<span class="sc">}</span><span class="vs">))"</span>, sequence)</span>
<span id="cb375-5678"><a href="#cb375-5678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5679"><a href="#cb375-5679" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_shared_kmers(kmer_length: <span class="bu">int</span>, sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-5680"><a href="#cb375-5680" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-5681"><a href="#cb375-5681" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> sequence1[i : (i <span class="op">+</span> kmer_length)]</span>
<span id="cb375-5682"><a href="#cb375-5682" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> current_sequence <span class="kw">in</span> [kmer, reverse_complement(kmer)]:</span>
<span id="cb375-5683"><a href="#cb375-5683" aria-hidden="true" tabindex="-1"></a>            matches <span class="op">=</span> <span class="bu">list</span>(find_overlapping_matches(current_sequence, sequence2))</span>
<span id="cb375-5684"><a href="#cb375-5684" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> match <span class="kw">in</span> matches:</span>
<span id="cb375-5685"><a href="#cb375-5685" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (i, match.start())</span>
<span id="cb375-5686"><a href="#cb375-5686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5687"><a href="#cb375-5687" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb375-5688"><a href="#cb375-5688" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-5689"><a href="#cb375-5689" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb375-5690"><a href="#cb375-5690" aria-hidden="true" tabindex="-1"></a><span class="st">AAACTCATC</span></span>
<span id="cb375-5691"><a href="#cb375-5691" aria-hidden="true" tabindex="-1"></a><span class="st">TTTCAAATC</span></span>
<span id="cb375-5692"><a href="#cb375-5692" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-5693"><a href="#cb375-5693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5694"><a href="#cb375-5694" aria-hidden="true" tabindex="-1"></a>kmer_length, sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-5695"><a href="#cb375-5695" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> match <span class="kw">in</span> find_shared_kmers(<span class="bu">int</span>(kmer_length), sequence1, sequence2):</span>
<span id="cb375-5696"><a href="#cb375-5696" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(match)</span>
<span id="cb375-5697"><a href="#cb375-5697" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5698"><a href="#cb375-5698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5699"><a href="#cb375-5699" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement ChromosomeToCycle</span></span>
<span id="cb375-5700"><a href="#cb375-5700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5701"><a href="#cb375-5701" aria-hidden="true" tabindex="-1"></a>Chromosome To Cycle Problem. Solve the Chromosome To Cycle Problem.</span>
<span id="cb375-5702"><a href="#cb375-5702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5703"><a href="#cb375-5703" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A chromosome&nbsp;<span class="op">*</span>Chromosome<span class="op">*</span>&nbsp;containing&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;synteny blocks.</span>
<span id="cb375-5704"><a href="#cb375-5704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5705"><a href="#cb375-5705" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The sequence&nbsp;<span class="op">*</span>Nodes<span class="op">*</span>&nbsp;of integers between <span class="dv">1</span> <span class="kw">and</span> <span class="dv">2</span><span class="er">_n_</span>&nbsp;resulting <span class="im">from</span> applying ChromosomeToCycle to&nbsp;<span class="op">*</span>Chromosome<span class="op">*</span>.</span>
<span id="cb375-5706"><a href="#cb375-5706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5707"><a href="#cb375-5707" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5708"><a href="#cb375-5708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5709"><a href="#cb375-5709" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5710"><a href="#cb375-5710" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb375-5711"><a href="#cb375-5711" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5712"><a href="#cb375-5712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5713"><a href="#cb375-5713" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5714"><a href="#cb375-5714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5715"><a href="#cb375-5715" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5716"><a href="#cb375-5716" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">8</span>)</span>
<span id="cb375-5717"><a href="#cb375-5717" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5718"><a href="#cb375-5718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5719"><a href="#cb375-5719" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5720"><a href="#cb375-5720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5721"><a href="#cb375-5721" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5722"><a href="#cb375-5722" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb375-5723"><a href="#cb375-5723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5724"><a href="#cb375-5724" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(permutation_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5725"><a href="#cb375-5725" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, permutation_string[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split()))</span>
<span id="cb375-5726"><a href="#cb375-5726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5727"><a href="#cb375-5727" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chromosome_to_cycle(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5728"><a href="#cb375-5728" aria-hidden="true" tabindex="-1"></a>    nodes: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-5729"><a href="#cb375-5729" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gene <span class="kw">in</span> chromosome:</span>
<span id="cb375-5730"><a href="#cb375-5730" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gene <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-5731"><a href="#cb375-5731" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span> gene])</span>
<span id="cb375-5732"><a href="#cb375-5732" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-5733"><a href="#cb375-5733" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene, <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb375-5734"><a href="#cb375-5734" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb375-5735"><a href="#cb375-5735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5736"><a href="#cb375-5736" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_chromosome_to_cycle(chromosome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5737"><a href="#cb375-5737" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome_to_cycle(parse_permutation(chromosome_string))</span>
<span id="cb375-5738"><a href="#cb375-5738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5739"><a href="#cb375-5739" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_cycle(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-5740"><a href="#cb375-5740" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, cycle)) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb375-5741"><a href="#cb375-5741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5742"><a href="#cb375-5742" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(+1 -2 -3 +4)"</span></span>
<span id="cb375-5743"><a href="#cb375-5743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5744"><a href="#cb375-5744" aria-hidden="true" tabindex="-1"></a>chromosome_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb375-5745"><a href="#cb375-5745" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(format_cycle(convert_chromosome_to_cycle(chromosome_string)))</span>
<span id="cb375-5746"><a href="#cb375-5746" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5747"><a href="#cb375-5747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5748"><a href="#cb375-5748" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement CycleToChromosome</span></span>
<span id="cb375-5749"><a href="#cb375-5749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5750"><a href="#cb375-5750" aria-hidden="true" tabindex="-1"></a>Cycle To Chromosome Problem. Solve the Cycle to Chromosome Problem.</span>
<span id="cb375-5751"><a href="#cb375-5751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5752"><a href="#cb375-5752" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence Nodes of integers between <span class="dv">1</span> <span class="kw">and</span> <span class="dv">2</span><span class="er">_n_</span>.</span>
<span id="cb375-5753"><a href="#cb375-5753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5754"><a href="#cb375-5754" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The chromosome&nbsp;<span class="op">*</span>Chromosome<span class="op">*</span>&nbsp;containing&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;synteny blocks resulting <span class="im">from</span> applying CycleToChromosome to&nbsp;<span class="op">*</span>Nodes<span class="op">*</span>.</span>
<span id="cb375-5755"><a href="#cb375-5755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5756"><a href="#cb375-5756" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5757"><a href="#cb375-5757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5758"><a href="#cb375-5758" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5759"><a href="#cb375-5759" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">8</span>)</span>
<span id="cb375-5760"><a href="#cb375-5760" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5761"><a href="#cb375-5761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5762"><a href="#cb375-5762" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5763"><a href="#cb375-5763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5764"><a href="#cb375-5764" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5765"><a href="#cb375-5765" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">+</span><span class="dv">4</span>)</span>
<span id="cb375-5766"><a href="#cb375-5766" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5767"><a href="#cb375-5767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5768"><a href="#cb375-5768" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5769"><a href="#cb375-5769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5770"><a href="#cb375-5770" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5771"><a href="#cb375-5771" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb375-5772"><a href="#cb375-5772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5773"><a href="#cb375-5773" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_cycle(cycle_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5774"><a href="#cb375-5774" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, cycle_string[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split()))</span>
<span id="cb375-5775"><a href="#cb375-5775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5776"><a href="#cb375-5776" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_chromosome(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-5777"><a href="#cb375-5777" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>gene<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb375-5778"><a href="#cb375-5778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5779"><a href="#cb375-5779" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cycle_to_chromosome(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5780"><a href="#cb375-5780" aria-hidden="true" tabindex="-1"></a>    chromosome: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-5781"><a href="#cb375-5781" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j1, j2 <span class="kw">in</span> <span class="bu">zip</span>(cycle[::<span class="dv">2</span>], cycle[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb375-5782"><a href="#cb375-5782" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j1 <span class="op">&lt;</span> j2:</span>
<span id="cb375-5783"><a href="#cb375-5783" aria-hidden="true" tabindex="-1"></a>            chromosome.append(j2 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb375-5784"><a href="#cb375-5784" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-5785"><a href="#cb375-5785" aria-hidden="true" tabindex="-1"></a>            chromosome.append(<span class="op">-</span>j1 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb375-5786"><a href="#cb375-5786" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome</span>
<span id="cb375-5787"><a href="#cb375-5787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5788"><a href="#cb375-5788" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(1 2 4 3 6 5 7 8)"</span></span>
<span id="cb375-5789"><a href="#cb375-5789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5790"><a href="#cb375-5790" aria-hidden="true" tabindex="-1"></a>cycle_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb375-5791"><a href="#cb375-5791" aria-hidden="true" tabindex="-1"></a>chromosome: List[<span class="bu">int</span>] <span class="op">=</span> cycle_to_chromosome(parse_cycle(cycle_string))</span>
<span id="cb375-5792"><a href="#cb375-5792" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(format_chromosome(chromosome))</span>
<span id="cb375-5793"><a href="#cb375-5793" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5794"><a href="#cb375-5794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5795"><a href="#cb375-5795" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement ColoredEdges</span></span>
<span id="cb375-5796"><a href="#cb375-5796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5797"><a href="#cb375-5797" aria-hidden="true" tabindex="-1"></a>Colored Edges Problem. Find the Colored Edges <span class="kw">in</span> a genome.</span>
<span id="cb375-5798"><a href="#cb375-5798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5799"><a href="#cb375-5799" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A genome&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb375-5800"><a href="#cb375-5800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5801"><a href="#cb375-5801" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The collection of colored edges <span class="kw">in</span> the genome graph of&nbsp;<span class="op">*</span>P<span class="op">*</span>&nbsp;in the form (<span class="op">*</span>x<span class="op">*</span>,&nbsp;<span class="op">*</span>y<span class="op">*</span>).</span>
<span id="cb375-5802"><a href="#cb375-5802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5803"><a href="#cb375-5803" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5804"><a href="#cb375-5804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5805"><a href="#cb375-5805" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5806"><a href="#cb375-5806" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span>)(<span class="op">+</span><span class="dv">4</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">6</span>)</span>
<span id="cb375-5807"><a href="#cb375-5807" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5808"><a href="#cb375-5808" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5809"><a href="#cb375-5809" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5810"><a href="#cb375-5810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5811"><a href="#cb375-5811" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5812"><a href="#cb375-5812" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span>, <span class="dv">4</span>), (<span class="dv">3</span>, <span class="dv">6</span>), (<span class="dv">5</span>, <span class="dv">1</span>), (<span class="dv">8</span>, <span class="dv">9</span>), (<span class="dv">10</span>, <span class="dv">12</span>), (<span class="dv">11</span>, <span class="dv">7</span>)</span>
<span id="cb375-5813"><a href="#cb375-5813" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5814"><a href="#cb375-5814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5815"><a href="#cb375-5815" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5816"><a href="#cb375-5816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5817"><a href="#cb375-5817" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5818"><a href="#cb375-5818" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb375-5819"><a href="#cb375-5819" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-5820"><a href="#cb375-5820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5821"><a href="#cb375-5821" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chromosome_to_cycle(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5822"><a href="#cb375-5822" aria-hidden="true" tabindex="-1"></a>    nodes: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-5823"><a href="#cb375-5823" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gene <span class="kw">in</span> chromosome:</span>
<span id="cb375-5824"><a href="#cb375-5824" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gene <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-5825"><a href="#cb375-5825" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span> gene])</span>
<span id="cb375-5826"><a href="#cb375-5826" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-5827"><a href="#cb375-5827" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene, <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb375-5828"><a href="#cb375-5828" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb375-5829"><a href="#cb375-5829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5830"><a href="#cb375-5830" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5831"><a href="#cb375-5831" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split()))</span>
<span id="cb375-5832"><a href="#cb375-5832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5833"><a href="#cb375-5833" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_colored_edges(genome: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-5834"><a href="#cb375-5834" aria-hidden="true" tabindex="-1"></a>    edge_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-5835"><a href="#cb375-5835" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chromosome <span class="kw">in</span> genome:</span>
<span id="cb375-5836"><a href="#cb375-5836" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> chromosome_to_cycle(chromosome)</span>
<span id="cb375-5837"><a href="#cb375-5837" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome)):</span>
<span id="cb375-5838"><a href="#cb375-5838" aria-hidden="true" tabindex="-1"></a>            start_index <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-5839"><a href="#cb375-5839" aria-hidden="true" tabindex="-1"></a>            end_index <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">2</span>) <span class="op">%</span> <span class="bu">len</span>(nodes)</span>
<span id="cb375-5840"><a href="#cb375-5840" aria-hidden="true" tabindex="-1"></a>            edge_dict[nodes[start_index]] <span class="op">=</span> nodes[end_index]</span>
<span id="cb375-5841"><a href="#cb375-5841" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> edge_dict</span>
<span id="cb375-5842"><a href="#cb375-5842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5843"><a href="#cb375-5843" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(+1 -2 -3)(+4 +5 -6)"</span></span>
<span id="cb375-5844"><a href="#cb375-5844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5845"><a href="#cb375-5845" aria-hidden="true" tabindex="-1"></a>genome_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb375-5846"><a href="#cb375-5846" aria-hidden="true" tabindex="-1"></a>genome: List[List[<span class="bu">int</span>]] <span class="op">=</span> [parse_integers(x) <span class="cf">for</span> x <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, genome_string)]</span>
<span id="cb375-5847"><a href="#cb375-5847" aria-hidden="true" tabindex="-1"></a>edges: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> [(k, v) <span class="cf">for</span> k, v <span class="kw">in</span> get_colored_edges(genome).items()]</span>
<span id="cb375-5848"><a href="#cb375-5848" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>edges, sep<span class="op">=</span><span class="st">", "</span>)</span>
<span id="cb375-5849"><a href="#cb375-5849" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5850"><a href="#cb375-5850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5851"><a href="#cb375-5851" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement GraphToGenome</span></span>
<span id="cb375-5852"><a href="#cb375-5852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5853"><a href="#cb375-5853" aria-hidden="true" tabindex="-1"></a>Graph To Genome Problem. Solve the Graph To Genome Problem.</span>
<span id="cb375-5854"><a href="#cb375-5854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5855"><a href="#cb375-5855" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;The colored edges of a genome graph.</span>
<span id="cb375-5856"><a href="#cb375-5856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5857"><a href="#cb375-5857" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A genome corresponding to the genome graph.</span>
<span id="cb375-5858"><a href="#cb375-5858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5859"><a href="#cb375-5859" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5860"><a href="#cb375-5860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5861"><a href="#cb375-5861" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5862"><a href="#cb375-5862" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span>, <span class="dv">4</span>), (<span class="dv">3</span>, <span class="dv">6</span>), (<span class="dv">5</span>, <span class="dv">1</span>), (<span class="dv">7</span>, <span class="dv">9</span>), (<span class="dv">10</span>, <span class="dv">12</span>), (<span class="dv">11</span>, <span class="dv">8</span>)</span>
<span id="cb375-5863"><a href="#cb375-5863" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5864"><a href="#cb375-5864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5865"><a href="#cb375-5865" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5866"><a href="#cb375-5866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5867"><a href="#cb375-5867" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5868"><a href="#cb375-5868" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span>)(<span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="dv">5</span> <span class="op">-</span><span class="dv">6</span>)</span>
<span id="cb375-5869"><a href="#cb375-5869" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5870"><a href="#cb375-5870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5871"><a href="#cb375-5871" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5872"><a href="#cb375-5872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5873"><a href="#cb375-5873" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5874"><a href="#cb375-5874" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb375-5875"><a href="#cb375-5875" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb375-5876"><a href="#cb375-5876" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb375-5877"><a href="#cb375-5877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5878"><a href="#cb375-5878" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_chromosome(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-5879"><a href="#cb375-5879" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>gene<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb375-5880"><a href="#cb375-5880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5881"><a href="#cb375-5881" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cycle_to_chromosome(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5882"><a href="#cb375-5882" aria-hidden="true" tabindex="-1"></a>    chromosome: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-5883"><a href="#cb375-5883" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j1, j2 <span class="kw">in</span> <span class="bu">zip</span>(cycle[::<span class="dv">2</span>], cycle[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb375-5884"><a href="#cb375-5884" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j1 <span class="op">&lt;</span> j2:</span>
<span id="cb375-5885"><a href="#cb375-5885" aria-hidden="true" tabindex="-1"></a>            chromosome.append(j2 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb375-5886"><a href="#cb375-5886" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-5887"><a href="#cb375-5887" aria-hidden="true" tabindex="-1"></a>            chromosome.append(<span class="op">-</span>j1 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb375-5888"><a href="#cb375-5888" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome</span>
<span id="cb375-5889"><a href="#cb375-5889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5890"><a href="#cb375-5890" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5891"><a href="#cb375-5891" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split(<span class="st">", "</span>)))</span>
<span id="cb375-5892"><a href="#cb375-5892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5893"><a href="#cb375-5893" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_first_key(dictionary: Dict) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-5894"><a href="#cb375-5894" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">next</span>(<span class="bu">iter</span>(dictionary.keys()))</span>
<span id="cb375-5895"><a href="#cb375-5895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5896"><a href="#cb375-5896" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a single cycle from colored edges</span></span>
<span id="cb375-5897"><a href="#cb375-5897" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycle(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5898"><a href="#cb375-5898" aria-hidden="true" tabindex="-1"></a>    start: <span class="bu">int</span> <span class="op">=</span> get_first_key(graph)</span>
<span id="cb375-5899"><a href="#cb375-5899" aria-hidden="true" tabindex="-1"></a>    current: <span class="bu">int</span> <span class="op">=</span> start</span>
<span id="cb375-5900"><a href="#cb375-5900" aria-hidden="true" tabindex="-1"></a>    component: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-5901"><a href="#cb375-5901" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-5902"><a href="#cb375-5902" aria-hidden="true" tabindex="-1"></a>        next_node: <span class="bu">int</span> <span class="op">=</span> graph.pop(current)</span>
<span id="cb375-5903"><a href="#cb375-5903" aria-hidden="true" tabindex="-1"></a>        graph.pop(next_node)</span>
<span id="cb375-5904"><a href="#cb375-5904" aria-hidden="true" tabindex="-1"></a>        neighbor: <span class="bu">int</span> <span class="op">=</span> next_node <span class="op">+</span> <span class="dv">1</span> <span class="cf">if</span> next_node <span class="op">%</span> <span class="dv">2</span> <span class="cf">else</span> next_node <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-5905"><a href="#cb375-5905" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="op">==</span> start:</span>
<span id="cb375-5906"><a href="#cb375-5906" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [next_node] <span class="op">+</span> component <span class="op">+</span> [current]</span>
<span id="cb375-5907"><a href="#cb375-5907" aria-hidden="true" tabindex="-1"></a>        component.extend([current, next_node])</span>
<span id="cb375-5908"><a href="#cb375-5908" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> neighbor</span>
<span id="cb375-5909"><a href="#cb375-5909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5910"><a href="#cb375-5910" aria-hidden="true" tabindex="-1"></a><span class="co"># find cycles in colored edges</span></span>
<span id="cb375-5911"><a href="#cb375-5911" aria-hidden="true" tabindex="-1"></a><span class="co"># to do this, we first make each edge "undirected"</span></span>
<span id="cb375-5912"><a href="#cb375-5912" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycles(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> Iterator[List[<span class="bu">int</span>]]:</span>
<span id="cb375-5913"><a href="#cb375-5913" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> copy(graph)</span>
<span id="cb375-5914"><a href="#cb375-5914" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> <span class="bu">list</span>(graph.items()):</span>
<span id="cb375-5915"><a href="#cb375-5915" aria-hidden="true" tabindex="-1"></a>        graph[v] <span class="op">=</span> k</span>
<span id="cb375-5916"><a href="#cb375-5916" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-5917"><a href="#cb375-5917" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> find_node_cycle(graph)</span>
<span id="cb375-5918"><a href="#cb375-5918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5919"><a href="#cb375-5919" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graph_to_genome(genome_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-5920"><a href="#cb375-5920" aria-hidden="true" tabindex="-1"></a>    genome: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-5921"><a href="#cb375-5921" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nodes <span class="kw">in</span> find_node_cycles(genome_graph):</span>
<span id="cb375-5922"><a href="#cb375-5922" aria-hidden="true" tabindex="-1"></a>        genome.append(cycle_to_chromosome(nodes))</span>
<span id="cb375-5923"><a href="#cb375-5923" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome</span>
<span id="cb375-5924"><a href="#cb375-5924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5925"><a href="#cb375-5925" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_edge_string(edge_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-5926"><a href="#cb375-5926" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-5927"><a href="#cb375-5927" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, edge_string):</span>
<span id="cb375-5928"><a href="#cb375-5928" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> parse_integers(x)</span>
<span id="cb375-5929"><a href="#cb375-5929" aria-hidden="true" tabindex="-1"></a>        graph[a] <span class="op">=</span> b</span>
<span id="cb375-5930"><a href="#cb375-5930" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-5931"><a href="#cb375-5931" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5932"><a href="#cb375-5932" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(2, 4), (3, 6), (5, 1), (7, 9), (10, 12), (11, 8)"</span></span>
<span id="cb375-5933"><a href="#cb375-5933" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5934"><a href="#cb375-5934" aria-hidden="true" tabindex="-1"></a>edge_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb375-5935"><a href="#cb375-5935" aria-hidden="true" tabindex="-1"></a>genome_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> parse_edge_string(edge_string)</span>
<span id="cb375-5936"><a href="#cb375-5936" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[format_chromosome(x) <span class="cf">for</span> x <span class="kw">in</span> graph_to_genome(genome_graph)], sep<span class="op">=</span><span class="st">""</span>)</span>
<span id="cb375-5937"><a href="#cb375-5937" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5938"><a href="#cb375-5938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5939"><a href="#cb375-5939" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement 2-BreakOnGenomeGraph</span></span>
<span id="cb375-5940"><a href="#cb375-5940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5941"><a href="#cb375-5941" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-</span>Break On Genome Graph Problem. Solve the <span class="dv">2</span><span class="op">-</span>Break On Genome Graph Problem.</span>
<span id="cb375-5942"><a href="#cb375-5942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5943"><a href="#cb375-5943" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;The colored edges of a genome graph&nbsp;<span class="op">*</span>GenomeGraph<span class="op">*</span>, followed by indices&nbsp;<span class="op">*</span>i<span class="op">*</span>,&nbsp;<span class="op">*</span>i<span class="st">'*,&nbsp;*j*, and&nbsp;*j'</span><span class="op">*</span>.</span>
<span id="cb375-5944"><a href="#cb375-5944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5945"><a href="#cb375-5945" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The colored edges of the genome graph resulting <span class="im">from</span> applying the <span class="dv">2</span><span class="op">-</span><span class="cf">break</span> operation.</span>
<span id="cb375-5946"><a href="#cb375-5946" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5947"><a href="#cb375-5947" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-5948"><a href="#cb375-5948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5949"><a href="#cb375-5949" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5950"><a href="#cb375-5950" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span>, <span class="dv">4</span>), (<span class="dv">3</span>, <span class="dv">8</span>), (<span class="dv">7</span>, <span class="dv">5</span>), (<span class="dv">6</span>, <span class="dv">1</span>)</span>
<span id="cb375-5951"><a href="#cb375-5951" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">8</span></span>
<span id="cb375-5952"><a href="#cb375-5952" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5953"><a href="#cb375-5953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5954"><a href="#cb375-5954" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-5955"><a href="#cb375-5955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5956"><a href="#cb375-5956" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5957"><a href="#cb375-5957" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span>, <span class="dv">4</span>), (<span class="dv">3</span>, <span class="dv">1</span>), (<span class="dv">7</span>, <span class="dv">5</span>), (<span class="dv">6</span>, <span class="dv">8</span>)</span>
<span id="cb375-5958"><a href="#cb375-5958" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-5959"><a href="#cb375-5959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5960"><a href="#cb375-5960" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-5961"><a href="#cb375-5961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5962"><a href="#cb375-5962" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-5963"><a href="#cb375-5963" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb375-5964"><a href="#cb375-5964" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb375-5965"><a href="#cb375-5965" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb375-5966"><a href="#cb375-5966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5967"><a href="#cb375-5967" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_edge_string(edge_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-5968"><a href="#cb375-5968" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-5969"><a href="#cb375-5969" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> match <span class="kw">in</span> re.findall(<span class="vs">r"\((.+?)\)"</span>, edge_string):</span>
<span id="cb375-5970"><a href="#cb375-5970" aria-hidden="true" tabindex="-1"></a>        node1, node2 <span class="op">=</span> parse_integers(match)</span>
<span id="cb375-5971"><a href="#cb375-5971" aria-hidden="true" tabindex="-1"></a>        graph[node1] <span class="op">=</span> node2</span>
<span id="cb375-5972"><a href="#cb375-5972" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-5973"><a href="#cb375-5973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5974"><a href="#cb375-5974" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-5975"><a href="#cb375-5975" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split(<span class="st">", "</span>)))</span>
<span id="cb375-5976"><a href="#cb375-5976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5977"><a href="#cb375-5977" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], edge: Tuple[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-5978"><a href="#cb375-5978" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> edge[<span class="dv">0</span>] <span class="kw">in</span> graph:</span>
<span id="cb375-5979"><a href="#cb375-5979" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">0</span>])</span>
<span id="cb375-5980"><a href="#cb375-5980" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-5981"><a href="#cb375-5981" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">1</span>])</span>
<span id="cb375-5982"><a href="#cb375-5982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5983"><a href="#cb375-5983" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_break_on_genome_graph(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], i: <span class="bu">int</span>, ip: <span class="bu">int</span>, j: <span class="bu">int</span>, jp: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-5984"><a href="#cb375-5984" aria-hidden="true" tabindex="-1"></a>    new_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> copy(graph)</span>
<span id="cb375-5985"><a href="#cb375-5985" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> [(i, ip), (j, jp)]:</span>
<span id="cb375-5986"><a href="#cb375-5986" aria-hidden="true" tabindex="-1"></a>        remove_edge(new_graph, edge)</span>
<span id="cb375-5987"><a href="#cb375-5987" aria-hidden="true" tabindex="-1"></a>    new_graph[i] <span class="op">=</span> j</span>
<span id="cb375-5988"><a href="#cb375-5988" aria-hidden="true" tabindex="-1"></a>    new_graph[ip] <span class="op">=</span> jp</span>
<span id="cb375-5989"><a href="#cb375-5989" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_graph</span>
<span id="cb375-5990"><a href="#cb375-5990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5991"><a href="#cb375-5991" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-5992"><a href="#cb375-5992" aria-hidden="true" tabindex="-1"></a><span class="st">(2, 4), (3, 8), (7, 5), (6, 1)</span></span>
<span id="cb375-5993"><a href="#cb375-5993" aria-hidden="true" tabindex="-1"></a><span class="st">1, 6, 3, 8</span></span>
<span id="cb375-5994"><a href="#cb375-5994" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-5995"><a href="#cb375-5995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-5996"><a href="#cb375-5996" aria-hidden="true" tabindex="-1"></a>edge_string, break_points <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-5997"><a href="#cb375-5997" aria-hidden="true" tabindex="-1"></a>graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> parse_edge_string(edge_string)</span>
<span id="cb375-5998"><a href="#cb375-5998" aria-hidden="true" tabindex="-1"></a>break_points_list: List[<span class="bu">int</span>] <span class="op">=</span> parse_integers(break_points)</span>
<span id="cb375-5999"><a href="#cb375-5999" aria-hidden="true" tabindex="-1"></a>new_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> two_break_on_genome_graph(graph, <span class="op">*</span>break_points_list)</span>
<span id="cb375-6000"><a href="#cb375-6000" aria-hidden="true" tabindex="-1"></a>edges: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> [(k, v) <span class="cf">for</span> k, v <span class="kw">in</span> new_graph.items()]</span>
<span id="cb375-6001"><a href="#cb375-6001" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>edges, sep<span class="op">=</span><span class="st">", "</span>)</span>
<span id="cb375-6002"><a href="#cb375-6002" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6003"><a href="#cb375-6003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6004"><a href="#cb375-6004" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement 2-BreakOnGenome</span></span>
<span id="cb375-6005"><a href="#cb375-6005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6006"><a href="#cb375-6006" aria-hidden="true" tabindex="-1"></a>Implement <span class="dv">2</span><span class="op">-</span>BreakOnGenome. Solve the <span class="dv">2</span><span class="op">-</span>Break On Genome Graph Problem.</span>
<span id="cb375-6007"><a href="#cb375-6007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6008"><a href="#cb375-6008" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A genome&nbsp;<span class="op">*</span>P<span class="op">*</span>, followed by indices&nbsp;<span class="op">*</span>i<span class="op">*</span>,&nbsp;<span class="op">*</span>i<span class="st">'*,&nbsp;*j*, and&nbsp;*j'</span><span class="op">*</span>.</span>
<span id="cb375-6009"><a href="#cb375-6009" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6010"><a href="#cb375-6010" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The genome&nbsp;<span class="op">*</span>P<span class="st">'*&nbsp;resulting from applying the 2-break operation.</span></span>
<span id="cb375-6011"><a href="#cb375-6011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6012"><a href="#cb375-6012" aria-hidden="true" tabindex="-1"></a><span class="er">## Sample Dataset</span></span>
<span id="cb375-6013"><a href="#cb375-6013" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6014"><a href="#cb375-6014" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6015"><a href="#cb375-6015" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="dv">3</span>)</span>
<span id="cb375-6016"><a href="#cb375-6016" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">3</span>, <span class="dv">8</span></span>
<span id="cb375-6017"><a href="#cb375-6017" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6018"><a href="#cb375-6018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6019"><a href="#cb375-6019" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-6020"><a href="#cb375-6020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6021"><a href="#cb375-6021" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6022"><a href="#cb375-6022" aria-hidden="true" tabindex="-1"></a>(<span class="op">+</span><span class="dv">1</span> <span class="op">-</span><span class="dv">2</span>) (<span class="op">-</span><span class="dv">4</span> <span class="op">+</span><span class="dv">3</span>)</span>
<span id="cb375-6023"><a href="#cb375-6023" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6024"><a href="#cb375-6024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6025"><a href="#cb375-6025" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-6026"><a href="#cb375-6026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6027"><a href="#cb375-6027" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-6028"><a href="#cb375-6028" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb375-6029"><a href="#cb375-6029" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb375-6030"><a href="#cb375-6030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6031"><a href="#cb375-6031" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(s: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-6032"><a href="#cb375-6032" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, s[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split()))</span>
<span id="cb375-6033"><a href="#cb375-6033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6034"><a href="#cb375-6034" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_permutation(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-6035"><a href="#cb375-6035" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>gene<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb375-6036"><a href="#cb375-6036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6037"><a href="#cb375-6037" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chromosome_to_cycle(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-6038"><a href="#cb375-6038" aria-hidden="true" tabindex="-1"></a>    nodes: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-6039"><a href="#cb375-6039" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gene <span class="kw">in</span> chromosome:</span>
<span id="cb375-6040"><a href="#cb375-6040" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gene <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-6041"><a href="#cb375-6041" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span> gene])</span>
<span id="cb375-6042"><a href="#cb375-6042" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-6043"><a href="#cb375-6043" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene, <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb375-6044"><a href="#cb375-6044" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb375-6045"><a href="#cb375-6045" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-6046"><a href="#cb375-6046" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> colored_edges(genome: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-6047"><a href="#cb375-6047" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-6048"><a href="#cb375-6048" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chromosome <span class="kw">in</span> genome:</span>
<span id="cb375-6049"><a href="#cb375-6049" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> chromosome_to_cycle(chromosome)</span>
<span id="cb375-6050"><a href="#cb375-6050" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome)):</span>
<span id="cb375-6051"><a href="#cb375-6051" aria-hidden="true" tabindex="-1"></a>            start_index <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-6052"><a href="#cb375-6052" aria-hidden="true" tabindex="-1"></a>            end_index <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">2</span>) <span class="op">%</span> <span class="bu">len</span>(nodes)</span>
<span id="cb375-6053"><a href="#cb375-6053" aria-hidden="true" tabindex="-1"></a>            graph[nodes[start_index]] <span class="op">=</span> nodes[end_index]</span>
<span id="cb375-6054"><a href="#cb375-6054" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-6055"><a href="#cb375-6055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6056"><a href="#cb375-6056" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], edge: Tuple[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-6057"><a href="#cb375-6057" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> edge[<span class="dv">0</span>] <span class="kw">in</span> graph:</span>
<span id="cb375-6058"><a href="#cb375-6058" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">0</span>])</span>
<span id="cb375-6059"><a href="#cb375-6059" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-6060"><a href="#cb375-6060" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">1</span>])</span>
<span id="cb375-6061"><a href="#cb375-6061" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-6062"><a href="#cb375-6062" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_break_on_genome_graph(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], i: <span class="bu">int</span>, ip: <span class="bu">int</span>, j: <span class="bu">int</span>, jp: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-6063"><a href="#cb375-6063" aria-hidden="true" tabindex="-1"></a>    new_graph <span class="op">=</span> copy(graph)</span>
<span id="cb375-6064"><a href="#cb375-6064" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> [(i, ip), (j, jp)]:</span>
<span id="cb375-6065"><a href="#cb375-6065" aria-hidden="true" tabindex="-1"></a>        remove_edge(new_graph, edge)</span>
<span id="cb375-6066"><a href="#cb375-6066" aria-hidden="true" tabindex="-1"></a>    new_graph[i] <span class="op">=</span> j</span>
<span id="cb375-6067"><a href="#cb375-6067" aria-hidden="true" tabindex="-1"></a>    new_graph[ip] <span class="op">=</span> jp</span>
<span id="cb375-6068"><a href="#cb375-6068" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_graph</span>
<span id="cb375-6069"><a href="#cb375-6069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6070"><a href="#cb375-6070" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_first_key(dictionary: Dict) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-6071"><a href="#cb375-6071" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">next</span>(<span class="bu">iter</span>(dictionary.keys()))</span>
<span id="cb375-6072"><a href="#cb375-6072" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-6073"><a href="#cb375-6073" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycle(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-6074"><a href="#cb375-6074" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> get_first_key(graph)</span>
<span id="cb375-6075"><a href="#cb375-6075" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> start</span>
<span id="cb375-6076"><a href="#cb375-6076" aria-hidden="true" tabindex="-1"></a>    component: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-6077"><a href="#cb375-6077" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-6078"><a href="#cb375-6078" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> graph.pop(current)</span>
<span id="cb375-6079"><a href="#cb375-6079" aria-hidden="true" tabindex="-1"></a>        graph.pop(next_node)</span>
<span id="cb375-6080"><a href="#cb375-6080" aria-hidden="true" tabindex="-1"></a>        neighbor <span class="op">=</span> next_node <span class="op">+</span> <span class="dv">1</span> <span class="cf">if</span> next_node <span class="op">%</span> <span class="dv">2</span> <span class="cf">else</span> next_node <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-6081"><a href="#cb375-6081" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="op">==</span> start:</span>
<span id="cb375-6082"><a href="#cb375-6082" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [next_node] <span class="op">+</span> component <span class="op">+</span> [current]</span>
<span id="cb375-6083"><a href="#cb375-6083" aria-hidden="true" tabindex="-1"></a>        component.extend([current, next_node])</span>
<span id="cb375-6084"><a href="#cb375-6084" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> neighbor</span>
<span id="cb375-6085"><a href="#cb375-6085" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-6086"><a href="#cb375-6086" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycles(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> Iterator[List[<span class="bu">int</span>]]:</span>
<span id="cb375-6087"><a href="#cb375-6087" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> copy(graph)</span>
<span id="cb375-6088"><a href="#cb375-6088" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> <span class="bu">list</span>(graph.items()):</span>
<span id="cb375-6089"><a href="#cb375-6089" aria-hidden="true" tabindex="-1"></a>        graph[v] <span class="op">=</span> k</span>
<span id="cb375-6090"><a href="#cb375-6090" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb375-6091"><a href="#cb375-6091" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> find_node_cycle(graph)</span>
<span id="cb375-6092"><a href="#cb375-6092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6093"><a href="#cb375-6093" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cycle_to_chromosome(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-6094"><a href="#cb375-6094" aria-hidden="true" tabindex="-1"></a>    chromosome: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-6095"><a href="#cb375-6095" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j1, j2 <span class="kw">in</span> <span class="bu">zip</span>(cycle[::<span class="dv">2</span>], cycle[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb375-6096"><a href="#cb375-6096" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j1 <span class="op">&lt;</span> j2:</span>
<span id="cb375-6097"><a href="#cb375-6097" aria-hidden="true" tabindex="-1"></a>            chromosome.append(j2 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb375-6098"><a href="#cb375-6098" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-6099"><a href="#cb375-6099" aria-hidden="true" tabindex="-1"></a>            chromosome.append(<span class="op">-</span>j1 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb375-6100"><a href="#cb375-6100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome</span>
<span id="cb375-6101"><a href="#cb375-6101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6102"><a href="#cb375-6102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graph_to_genome(genome_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-6103"><a href="#cb375-6103" aria-hidden="true" tabindex="-1"></a>    genome: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-6104"><a href="#cb375-6104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nodes <span class="kw">in</span> find_node_cycles(genome_graph):</span>
<span id="cb375-6105"><a href="#cb375-6105" aria-hidden="true" tabindex="-1"></a>        genome.append(cycle_to_chromosome(nodes))</span>
<span id="cb375-6106"><a href="#cb375-6106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome</span>
<span id="cb375-6107"><a href="#cb375-6107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6108"><a href="#cb375-6108" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(x: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-6109"><a href="#cb375-6109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, x.split(<span class="st">", "</span>)))</span>
<span id="cb375-6110"><a href="#cb375-6110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6111"><a href="#cb375-6111" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_break_on_genome(chromosome: List[<span class="bu">int</span>], i: <span class="bu">int</span>, ip: <span class="bu">int</span>, j: <span class="bu">int</span>, jp: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-6112"><a href="#cb375-6112" aria-hidden="true" tabindex="-1"></a>    genome_graph <span class="op">=</span> colored_edges([chromosome])</span>
<span id="cb375-6113"><a href="#cb375-6113" aria-hidden="true" tabindex="-1"></a>    genome_graph <span class="op">=</span> two_break_on_genome_graph(genome_graph, i, ip, j, jp)</span>
<span id="cb375-6114"><a href="#cb375-6114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph_to_genome(genome_graph)</span>
<span id="cb375-6115"><a href="#cb375-6115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6116"><a href="#cb375-6116" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-6117"><a href="#cb375-6117" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -2 -4 +3)</span></span>
<span id="cb375-6118"><a href="#cb375-6118" aria-hidden="true" tabindex="-1"></a><span class="st">1, 6, 3, 8</span></span>
<span id="cb375-6119"><a href="#cb375-6119" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-6120"><a href="#cb375-6120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6121"><a href="#cb375-6121" aria-hidden="true" tabindex="-1"></a>genome_str, indices_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-6122"><a href="#cb375-6122" aria-hidden="true" tabindex="-1"></a>genome <span class="op">=</span> parse_permutation(genome_str)</span>
<span id="cb375-6123"><a href="#cb375-6123" aria-hidden="true" tabindex="-1"></a>new_genome <span class="op">=</span> two_break_on_genome(genome, <span class="op">*</span>parse_integers(indices_str))</span>
<span id="cb375-6124"><a href="#cb375-6124" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[format_permutation(x) <span class="cf">for</span> x <span class="kw">in</span> new_genome])</span>
<span id="cb375-6125"><a href="#cb375-6125" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6126"><a href="#cb375-6126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6127"><a href="#cb375-6127" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Distances Between Leaves</span></span>
<span id="cb375-6128"><a href="#cb375-6128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6129"><a href="#cb375-6129" aria-hidden="true" tabindex="-1"></a>Distance Between Leaves Problem. Compute the distances between leaves <span class="kw">in</span> a weighted tree.</span>
<span id="cb375-6130"><a href="#cb375-6130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6131"><a href="#cb375-6131" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;followed by the adjacency <span class="bu">list</span> of a weighted tree with&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;leaves.</span>
<span id="cb375-6132"><a href="#cb375-6132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6133"><a href="#cb375-6133" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A space<span class="op">-</span>separated&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;x&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;(<span class="op">*</span>d__i<span class="op">*</span>,&nbsp;<span class="op">*</span>j<span class="op">*</span>), where&nbsp;<span class="op">*</span>d__i<span class="op">*</span>,&nbsp;<span class="op">*</span>j<span class="op">*</span>&nbsp;is the length of the path between leaves&nbsp;<span class="op">*</span>i<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>j<span class="op">*</span>.</span>
<span id="cb375-6134"><a href="#cb375-6134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6135"><a href="#cb375-6135" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-6136"><a href="#cb375-6136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6137"><a href="#cb375-6137" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6138"><a href="#cb375-6138" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-6139"><a href="#cb375-6139" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">11</span></span>
<span id="cb375-6140"><a href="#cb375-6140" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">2</span></span>
<span id="cb375-6141"><a href="#cb375-6141" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="dv">6</span></span>
<span id="cb375-6142"><a href="#cb375-6142" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="dv">7</span></span>
<span id="cb375-6143"><a href="#cb375-6143" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">0</span>:<span class="dv">11</span></span>
<span id="cb375-6144"><a href="#cb375-6144" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">1</span>:<span class="dv">2</span></span>
<span id="cb375-6145"><a href="#cb375-6145" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="dv">4</span></span>
<span id="cb375-6146"><a href="#cb375-6146" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">4</span></span>
<span id="cb375-6147"><a href="#cb375-6147" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">3</span>:<span class="dv">7</span></span>
<span id="cb375-6148"><a href="#cb375-6148" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">2</span>:<span class="dv">6</span></span>
<span id="cb375-6149"><a href="#cb375-6149" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6150"><a href="#cb375-6150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6151"><a href="#cb375-6151" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-6152"><a href="#cb375-6152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6153"><a href="#cb375-6153" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6154"><a href="#cb375-6154" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   <span class="dv">13</span>  <span class="dv">21</span>  <span class="dv">22</span></span>
<span id="cb375-6155"><a href="#cb375-6155" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="dv">0</span>   <span class="dv">12</span>  <span class="dv">13</span></span>
<span id="cb375-6156"><a href="#cb375-6156" aria-hidden="true" tabindex="-1"></a><span class="dv">21</span>  <span class="dv">12</span>  <span class="dv">0</span>   <span class="dv">13</span></span>
<span id="cb375-6157"><a href="#cb375-6157" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span>  <span class="dv">13</span>  <span class="dv">13</span>  <span class="dv">0</span></span>
<span id="cb375-6158"><a href="#cb375-6158" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6159"><a href="#cb375-6159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6160"><a href="#cb375-6160" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-6161"><a href="#cb375-6161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6162"><a href="#cb375-6162" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-6163"><a href="#cb375-6163" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb375-6164"><a href="#cb375-6164" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-6165"><a href="#cb375-6165" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb375-6166"><a href="#cb375-6166" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> heapq <span class="im">import</span> heappush, heappop</span>
<span id="cb375-6167"><a href="#cb375-6167" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb375-6168"><a href="#cb375-6168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6169"><a href="#cb375-6169" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-6170"><a href="#cb375-6170" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb375-6171"><a href="#cb375-6171" aria-hidden="true" tabindex="-1"></a>    destination_nodes <span class="op">=</span> {edge[<span class="st">"n"</span>] <span class="cf">for</span> edges <span class="kw">in</span> graph.values() <span class="cf">for</span> edge <span class="kw">in</span> edges}</span>
<span id="cb375-6172"><a href="#cb375-6172" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> destination_nodes</span>
<span id="cb375-6173"><a href="#cb375-6173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6174"><a href="#cb375-6174" aria-hidden="true" tabindex="-1"></a><span class="co"># Dijkstra's algorithm to find distance from start to all other nodes</span></span>
<span id="cb375-6175"><a href="#cb375-6175" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes nodes are integers starting at 0!</span></span>
<span id="cb375-6176"><a href="#cb375-6176" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dijkstra(start: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb375-6177"><a href="#cb375-6177" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [inf <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(get_all_nodes(graph)))]</span>
<span id="cb375-6178"><a href="#cb375-6178" aria-hidden="true" tabindex="-1"></a>    distances[start] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-6179"><a href="#cb375-6179" aria-hidden="true" tabindex="-1"></a>    priority_queue: List[Tuple[<span class="bu">float</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-6180"><a href="#cb375-6180" aria-hidden="true" tabindex="-1"></a>    heappush(priority_queue, (<span class="dv">0</span>, start))</span>
<span id="cb375-6181"><a href="#cb375-6181" aria-hidden="true" tabindex="-1"></a>    processed_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-6182"><a href="#cb375-6182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6183"><a href="#cb375-6183" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> priority_queue:</span>
<span id="cb375-6184"><a href="#cb375-6184" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> heappop(priority_queue)[<span class="dv">1</span>]</span>
<span id="cb375-6185"><a href="#cb375-6185" aria-hidden="true" tabindex="-1"></a>        processed_nodes.add(current_node)</span>
<span id="cb375-6186"><a href="#cb375-6186" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb375-6187"><a href="#cb375-6187" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor[<span class="st">"n"</span>] <span class="kw">not</span> <span class="kw">in</span> processed_nodes:</span>
<span id="cb375-6188"><a href="#cb375-6188" aria-hidden="true" tabindex="-1"></a>                distances[neighbor[<span class="st">"n"</span>]] <span class="op">=</span> <span class="bu">min</span>(distances[current_node] <span class="op">+</span> neighbor[<span class="st">"w"</span>], distances[neighbor[<span class="st">"n"</span>]])</span>
<span id="cb375-6189"><a href="#cb375-6189" aria-hidden="true" tabindex="-1"></a>                heappush(priority_queue, (distances[neighbor[<span class="st">"n"</span>]], neighbor[<span class="st">"n"</span>]))</span>
<span id="cb375-6190"><a href="#cb375-6190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6191"><a href="#cb375-6191" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances</span>
<span id="cb375-6192"><a href="#cb375-6192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6193"><a href="#cb375-6193" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_weighted_graph(edges: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb375-6194"><a href="#cb375-6194" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-6195"><a href="#cb375-6195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6196"><a href="#cb375-6196" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb375-6197"><a href="#cb375-6197" aria-hidden="true" tabindex="-1"></a>        from_node, to_node, weight <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, split(<span class="vs">r"\D+"</span>, edge))</span>
<span id="cb375-6198"><a href="#cb375-6198" aria-hidden="true" tabindex="-1"></a>        graph[from_node].append({<span class="st">"n"</span>: to_node, <span class="st">"w"</span>: weight})</span>
<span id="cb375-6199"><a href="#cb375-6199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6200"><a href="#cb375-6200" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-6201"><a href="#cb375-6201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6202"><a href="#cb375-6202" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-6203"><a href="#cb375-6203" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-6204"><a href="#cb375-6204" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;4:11</span></span>
<span id="cb375-6205"><a href="#cb375-6205" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:2</span></span>
<span id="cb375-6206"><a href="#cb375-6206" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;5:6</span></span>
<span id="cb375-6207"><a href="#cb375-6207" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;5:7</span></span>
<span id="cb375-6208"><a href="#cb375-6208" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;0:11</span></span>
<span id="cb375-6209"><a href="#cb375-6209" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;1:2</span></span>
<span id="cb375-6210"><a href="#cb375-6210" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;5:4</span></span>
<span id="cb375-6211"><a href="#cb375-6211" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;4:4</span></span>
<span id="cb375-6212"><a href="#cb375-6212" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;3:7</span></span>
<span id="cb375-6213"><a href="#cb375-6213" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;2:6</span></span>
<span id="cb375-6214"><a href="#cb375-6214" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-6215"><a href="#cb375-6215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6216"><a href="#cb375-6216" aria-hidden="true" tabindex="-1"></a>num_leaves, <span class="op">*</span>edges <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-6217"><a href="#cb375-6217" aria-hidden="true" tabindex="-1"></a>num_leaves <span class="op">=</span> <span class="bu">int</span>(num_leaves)</span>
<span id="cb375-6218"><a href="#cb375-6218" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> parse_weighted_graph(edges)</span>
<span id="cb375-6219"><a href="#cb375-6219" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_leaves):</span>
<span id="cb375-6220"><a href="#cb375-6220" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>dijkstra(i, graph)[:num_leaves])</span>
<span id="cb375-6221"><a href="#cb375-6221" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6222"><a href="#cb375-6222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6223"><a href="#cb375-6223" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute Limb Lengths in a Tree</span></span>
<span id="cb375-6224"><a href="#cb375-6224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6225"><a href="#cb375-6225" aria-hidden="true" tabindex="-1"></a>Limb Length Problem. Find the limb length <span class="cf">for</span> a leaf <span class="kw">in</span> a tree.</span>
<span id="cb375-6226"><a href="#cb375-6226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6227"><a href="#cb375-6227" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>n<span class="op">*</span>, followed by an integer&nbsp;<span class="op">*</span>j<span class="op">*</span>&nbsp;between <span class="dv">0</span> and&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;<span class="op">-</span> <span class="dv">1</span>, followed by a space<span class="op">-</span>separated additive distance matrix&nbsp;<span class="op">*</span>D<span class="op">*</span>&nbsp;(whose elements are integers).</span>
<span id="cb375-6228"><a href="#cb375-6228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6229"><a href="#cb375-6229" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The limb length of the leaf in&nbsp;<span class="op">*</span>Tree<span class="op">*</span>(<span class="op">*</span>D<span class="op">*</span>) corresponding to row&nbsp;<span class="op">*</span>j<span class="op">*</span>&nbsp;of this distance matrix (use&nbsp;[<span class="dv">0</span><span class="op">-</span>based indexing](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span><span class="dv">0</span><span class="op">-</span>based<span class="op">-</span>numbering<span class="op">/</span>)).</span>
<span id="cb375-6230"><a href="#cb375-6230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6231"><a href="#cb375-6231" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-6232"><a href="#cb375-6232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6233"><a href="#cb375-6233" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6234"><a href="#cb375-6234" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-6235"><a href="#cb375-6235" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb375-6236"><a href="#cb375-6236" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   <span class="dv">13</span>  <span class="dv">21</span>  <span class="dv">22</span></span>
<span id="cb375-6237"><a href="#cb375-6237" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="dv">0</span>   <span class="dv">12</span>  <span class="dv">13</span></span>
<span id="cb375-6238"><a href="#cb375-6238" aria-hidden="true" tabindex="-1"></a><span class="dv">21</span>  <span class="dv">12</span>  <span class="dv">0</span>   <span class="dv">13</span></span>
<span id="cb375-6239"><a href="#cb375-6239" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span>  <span class="dv">13</span>  <span class="dv">13</span>  <span class="dv">0</span></span>
<span id="cb375-6240"><a href="#cb375-6240" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6241"><a href="#cb375-6241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6242"><a href="#cb375-6242" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-6243"><a href="#cb375-6243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6244"><a href="#cb375-6244" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6245"><a href="#cb375-6245" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb375-6246"><a href="#cb375-6246" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6247"><a href="#cb375-6247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6248"><a href="#cb375-6248" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-6249"><a href="#cb375-6249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6250"><a href="#cb375-6250" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-6251"><a href="#cb375-6251" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb375-6252"><a href="#cb375-6252" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-6253"><a href="#cb375-6253" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb375-6254"><a href="#cb375-6254" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> heapq <span class="im">import</span> heappush, heappop</span>
<span id="cb375-6255"><a href="#cb375-6255" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb375-6256"><a href="#cb375-6256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6257"><a href="#cb375-6257" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-6258"><a href="#cb375-6258" aria-hidden="true" tabindex="-1"></a>    source_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb375-6259"><a href="#cb375-6259" aria-hidden="true" tabindex="-1"></a>    destination_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> {edge[<span class="st">"to"</span>] <span class="cf">for</span> edges <span class="kw">in</span> graph.values() <span class="cf">for</span> edge <span class="kw">in</span> edges}</span>
<span id="cb375-6260"><a href="#cb375-6260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> destination_nodes</span>
<span id="cb375-6261"><a href="#cb375-6261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6262"><a href="#cb375-6262" aria-hidden="true" tabindex="-1"></a><span class="co"># Dijkstra's algorithm to find distance from start to all other nodes</span></span>
<span id="cb375-6263"><a href="#cb375-6263" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes nodes are integers starting at 0!</span></span>
<span id="cb375-6264"><a href="#cb375-6264" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dijkstra(start: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb375-6265"><a href="#cb375-6265" aria-hidden="true" tabindex="-1"></a>    distances: List[<span class="bu">float</span>] <span class="op">=</span> [inf <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(get_all_nodes(graph)))]</span>
<span id="cb375-6266"><a href="#cb375-6266" aria-hidden="true" tabindex="-1"></a>    distances[start] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-6267"><a href="#cb375-6267" aria-hidden="true" tabindex="-1"></a>    priority_queue: List[Tuple[<span class="bu">float</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-6268"><a href="#cb375-6268" aria-hidden="true" tabindex="-1"></a>    heappush(priority_queue, (<span class="dv">0</span>, start))</span>
<span id="cb375-6269"><a href="#cb375-6269" aria-hidden="true" tabindex="-1"></a>    processed_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-6270"><a href="#cb375-6270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6271"><a href="#cb375-6271" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> priority_queue:</span>
<span id="cb375-6272"><a href="#cb375-6272" aria-hidden="true" tabindex="-1"></a>        current_distance, current_node <span class="op">=</span> heappop(priority_queue)</span>
<span id="cb375-6273"><a href="#cb375-6273" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_node <span class="kw">in</span> processed_nodes:</span>
<span id="cb375-6274"><a href="#cb375-6274" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb375-6275"><a href="#cb375-6275" aria-hidden="true" tabindex="-1"></a>        processed_nodes.add(current_node)</span>
<span id="cb375-6276"><a href="#cb375-6276" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb375-6277"><a href="#cb375-6277" aria-hidden="true" tabindex="-1"></a>            neighbor_node: <span class="bu">int</span> <span class="op">=</span> neighbor[<span class="st">"to"</span>]</span>
<span id="cb375-6278"><a href="#cb375-6278" aria-hidden="true" tabindex="-1"></a>            edge_weight: <span class="bu">int</span> <span class="op">=</span> neighbor[<span class="st">"weight"</span>]</span>
<span id="cb375-6279"><a href="#cb375-6279" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor_node <span class="kw">not</span> <span class="kw">in</span> processed_nodes:</span>
<span id="cb375-6280"><a href="#cb375-6280" aria-hidden="true" tabindex="-1"></a>                new_distance: <span class="bu">float</span> <span class="op">=</span> current_distance <span class="op">+</span> edge_weight</span>
<span id="cb375-6281"><a href="#cb375-6281" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> new_distance <span class="op">&lt;</span> distances[neighbor_node]:</span>
<span id="cb375-6282"><a href="#cb375-6282" aria-hidden="true" tabindex="-1"></a>                    distances[neighbor_node] <span class="op">=</span> new_distance</span>
<span id="cb375-6283"><a href="#cb375-6283" aria-hidden="true" tabindex="-1"></a>                    heappush(priority_queue, (new_distance, neighbor_node))</span>
<span id="cb375-6284"><a href="#cb375-6284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6285"><a href="#cb375-6285" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances</span>
<span id="cb375-6286"><a href="#cb375-6286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6287"><a href="#cb375-6287" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_weighted_graph(edges: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb375-6288"><a href="#cb375-6288" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-6289"><a href="#cb375-6289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6290"><a href="#cb375-6290" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb375-6291"><a href="#cb375-6291" aria-hidden="true" tabindex="-1"></a>        from_node, to_node, weight <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, split(<span class="vs">r"\D+"</span>, edge))</span>
<span id="cb375-6292"><a href="#cb375-6292" aria-hidden="true" tabindex="-1"></a>        graph[from_node].append({<span class="st">"to"</span>: to_node, <span class="st">"weight"</span>: weight})</span>
<span id="cb375-6293"><a href="#cb375-6293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6294"><a href="#cb375-6294" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-6295"><a href="#cb375-6295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6296"><a href="#cb375-6296" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-6297"><a href="#cb375-6297" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-6298"><a href="#cb375-6298" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;4:11</span></span>
<span id="cb375-6299"><a href="#cb375-6299" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:2</span></span>
<span id="cb375-6300"><a href="#cb375-6300" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;5:6</span></span>
<span id="cb375-6301"><a href="#cb375-6301" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;5:7</span></span>
<span id="cb375-6302"><a href="#cb375-6302" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;0:11</span></span>
<span id="cb375-6303"><a href="#cb375-6303" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;1:2</span></span>
<span id="cb375-6304"><a href="#cb375-6304" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;5:4</span></span>
<span id="cb375-6305"><a href="#cb375-6305" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;4:4</span></span>
<span id="cb375-6306"><a href="#cb375-6306" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;3:7</span></span>
<span id="cb375-6307"><a href="#cb375-6307" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;2:6</span></span>
<span id="cb375-6308"><a href="#cb375-6308" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-6309"><a href="#cb375-6309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6310"><a href="#cb375-6310" aria-hidden="true" tabindex="-1"></a>num_leaves, <span class="op">*</span>edges <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-6311"><a href="#cb375-6311" aria-hidden="true" tabindex="-1"></a>num_leaves: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(num_leaves)</span>
<span id="cb375-6312"><a href="#cb375-6312" aria-hidden="true" tabindex="-1"></a>graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> parse_weighted_graph(edges)</span>
<span id="cb375-6313"><a href="#cb375-6313" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_leaves):</span>
<span id="cb375-6314"><a href="#cb375-6314" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>dijkstra(i, graph)[:num_leaves])</span>
<span id="cb375-6315"><a href="#cb375-6315" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6316"><a href="#cb375-6316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6317"><a href="#cb375-6317" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement AdditivePhylogeny</span></span>
<span id="cb375-6318"><a href="#cb375-6318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6319"><a href="#cb375-6319" aria-hidden="true" tabindex="-1"></a>Additive Phylogeny Problem. Construct the simple tree fitting an additive matrix.</span>
<span id="cb375-6320"><a href="#cb375-6320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6321"><a href="#cb375-6321" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;and a tab<span class="op">-</span>delimited&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;x&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;additive matrix.</span>
<span id="cb375-6322"><a href="#cb375-6322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6323"><a href="#cb375-6323" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A weighted adjacency <span class="bu">list</span> <span class="cf">for</span> the simple tree fitting this matrix.</span>
<span id="cb375-6324"><a href="#cb375-6324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6325"><a href="#cb375-6325" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note on formatting<span class="op">**</span>: The adjacency <span class="bu">list</span> must have consecutive integer node labels starting <span class="im">from</span> <span class="fl">0.</span> The&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;leaves must be labeled&nbsp;<span class="op">*</span><span class="dv">0</span>, <span class="dv">1</span>, ..., n<span class="op">-</span><span class="dv">1</span><span class="op">*</span>&nbsp;in order of their appearance <span class="kw">in</span> the distance matrix. Labels <span class="cf">for</span> internal nodes may be labeled <span class="kw">in</span> <span class="bu">any</span> order but must start from&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;and increase consecutively.</span>
<span id="cb375-6326"><a href="#cb375-6326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6327"><a href="#cb375-6327" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-6328"><a href="#cb375-6328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6329"><a href="#cb375-6329" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6330"><a href="#cb375-6330" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-6331"><a href="#cb375-6331" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   <span class="dv">13</span>  <span class="dv">21</span>  <span class="dv">22</span></span>
<span id="cb375-6332"><a href="#cb375-6332" aria-hidden="true" tabindex="-1"></a><span class="dv">13</span>  <span class="dv">0</span>   <span class="dv">12</span>  <span class="dv">13</span></span>
<span id="cb375-6333"><a href="#cb375-6333" aria-hidden="true" tabindex="-1"></a><span class="dv">21</span>  <span class="dv">12</span>  <span class="dv">0</span>   <span class="dv">13</span></span>
<span id="cb375-6334"><a href="#cb375-6334" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span>  <span class="dv">13</span>  <span class="dv">13</span>  <span class="dv">0</span></span>
<span id="cb375-6335"><a href="#cb375-6335" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6336"><a href="#cb375-6336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6337"><a href="#cb375-6337" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-6338"><a href="#cb375-6338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6339"><a href="#cb375-6339" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6340"><a href="#cb375-6340" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">11</span></span>
<span id="cb375-6341"><a href="#cb375-6341" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">2</span></span>
<span id="cb375-6342"><a href="#cb375-6342" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="dv">6</span></span>
<span id="cb375-6343"><a href="#cb375-6343" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="dv">7</span></span>
<span id="cb375-6344"><a href="#cb375-6344" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">0</span>:<span class="dv">11</span></span>
<span id="cb375-6345"><a href="#cb375-6345" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">1</span>:<span class="dv">2</span></span>
<span id="cb375-6346"><a href="#cb375-6346" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="dv">4</span></span>
<span id="cb375-6347"><a href="#cb375-6347" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">2</span>:<span class="dv">6</span></span>
<span id="cb375-6348"><a href="#cb375-6348" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">3</span>:<span class="dv">7</span></span>
<span id="cb375-6349"><a href="#cb375-6349" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="dv">4</span></span>
<span id="cb375-6350"><a href="#cb375-6350" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6351"><a href="#cb375-6351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6352"><a href="#cb375-6352" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-6353"><a href="#cb375-6353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6354"><a href="#cb375-6354" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-6355"><a href="#cb375-6355" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-6356"><a href="#cb375-6356" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Tuple, Generator</span>
<span id="cb375-6357"><a href="#cb375-6357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6358"><a href="#cb375-6358" aria-hidden="true" tabindex="-1"></a><span class="co"># Type aliases for clarity</span></span>
<span id="cb375-6359"><a href="#cb375-6359" aria-hidden="true" tabindex="-1"></a>DistanceMatrix <span class="op">=</span> List[List[<span class="bu">int</span>]]</span>
<span id="cb375-6360"><a href="#cb375-6360" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]</span>
<span id="cb375-6361"><a href="#cb375-6361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6362"><a href="#cb375-6362" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_distance_matrix(lines: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> DistanceMatrix:</span>
<span id="cb375-6363"><a href="#cb375-6363" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Parse integer matrix from set of lines"""</span></span>
<span id="cb375-6364"><a href="#cb375-6364" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split()] <span class="cf">for</span> line <span class="kw">in</span> lines]</span>
<span id="cb375-6365"><a href="#cb375-6365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6366"><a href="#cb375-6366" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_limb_length(distance_matrix: DistanceMatrix, j: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-6367"><a href="#cb375-6367" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Calculate limb length j for distance matrix"""</span></span>
<span id="cb375-6368"><a href="#cb375-6368" aria-hidden="true" tabindex="-1"></a>    min_limb_length <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb375-6369"><a href="#cb375-6369" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(distance_matrix)</span>
<span id="cb375-6370"><a href="#cb375-6370" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb375-6371"><a href="#cb375-6371" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb375-6372"><a href="#cb375-6372" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">!=</span> k <span class="kw">and</span> i <span class="op">!=</span> j:</span>
<span id="cb375-6373"><a href="#cb375-6373" aria-hidden="true" tabindex="-1"></a>                limb_length <span class="op">=</span> (distance_matrix[i][j] <span class="op">+</span> distance_matrix[j][k] <span class="op">-</span> distance_matrix[i][k]) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb375-6374"><a href="#cb375-6374" aria-hidden="true" tabindex="-1"></a>                min_limb_length <span class="op">=</span> <span class="bu">min</span>(limb_length, min_limb_length)</span>
<span id="cb375-6375"><a href="#cb375-6375" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> min_limb_length</span>
<span id="cb375-6376"><a href="#cb375-6376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6377"><a href="#cb375-6377" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Graph) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-6378"><a href="#cb375-6378" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Get all nodes in the graph"""</span></span>
<span id="cb375-6379"><a href="#cb375-6379" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb375-6380"><a href="#cb375-6380" aria-hidden="true" tabindex="-1"></a>    target_nodes <span class="op">=</span> {edge[<span class="st">"n"</span>] <span class="cf">for</span> edges <span class="kw">in</span> graph.values() <span class="cf">for</span> edge <span class="kw">in</span> edges}</span>
<span id="cb375-6381"><a href="#cb375-6381" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> target_nodes</span>
<span id="cb375-6382"><a href="#cb375-6382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6383"><a href="#cb375-6383" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_path(graph: Graph, path: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]], target: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-6384"><a href="#cb375-6384" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Search tree, returning route to target and cumulative distance"""</span></span>
<span id="cb375-6385"><a href="#cb375-6385" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> target <span class="kw">in</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> path]:</span>
<span id="cb375-6386"><a href="#cb375-6386" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> path</span>
<span id="cb375-6387"><a href="#cb375-6387" aria-hidden="true" tabindex="-1"></a>    current_node, current_distance <span class="op">=</span> path[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-6388"><a href="#cb375-6388" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node <span class="kw">in</span> graph:</span>
<span id="cb375-6389"><a href="#cb375-6389" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> graph[current_node]:</span>
<span id="cb375-6390"><a href="#cb375-6390" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> edge[<span class="st">"n"</span>] <span class="kw">not</span> <span class="kw">in</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> path]:</span>
<span id="cb375-6391"><a href="#cb375-6391" aria-hidden="true" tabindex="-1"></a>                new_path <span class="op">=</span> path <span class="op">+</span> [(edge[<span class="st">"n"</span>], current_distance <span class="op">+</span> edge[<span class="st">"w"</span>])]</span>
<span id="cb375-6392"><a href="#cb375-6392" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> <span class="cf">from</span> find_path(graph, new_path, target)</span>
<span id="cb375-6393"><a href="#cb375-6393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6394"><a href="#cb375-6394" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_leaves(distance_matrix: DistanceMatrix, n: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-6395"><a href="#cb375-6395" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Find three leaves i, n, k such that D[i][k] = D[i][n] + D[n][k]"""</span></span>
<span id="cb375-6396"><a href="#cb375-6396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb375-6397"><a href="#cb375-6397" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(distance_matrix)):</span>
<span id="cb375-6398"><a href="#cb375-6398" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> distance_matrix[i][k] <span class="op">==</span> distance_matrix[i][n] <span class="op">+</span> distance_matrix[n][k]:</span>
<span id="cb375-6399"><a href="#cb375-6399" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> i, n, k</span>
<span id="cb375-6400"><a href="#cb375-6400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"No suitable leaves found"</span>)</span>
<span id="cb375-6401"><a href="#cb375-6401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6402"><a href="#cb375-6402" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_node(tree: Graph, i: <span class="bu">int</span>, k: <span class="bu">int</span>, x: <span class="bu">int</span>, n: <span class="bu">int</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb375-6403"><a href="#cb375-6403" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Add node in graph between i and k, distance x from i, labelled n"""</span></span>
<span id="cb375-6404"><a href="#cb375-6404" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">list</span>(find_path(tree, [(i, <span class="dv">0</span>)], k))[<span class="dv">0</span>]</span>
<span id="cb375-6405"><a href="#cb375-6405" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p, node <span class="kw">in</span> <span class="bu">enumerate</span>(path):</span>
<span id="cb375-6406"><a href="#cb375-6406" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node[<span class="dv">1</span>] <span class="op">&gt;</span> x:</span>
<span id="cb375-6407"><a href="#cb375-6407" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb375-6408"><a href="#cb375-6408" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> p <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-6409"><a href="#cb375-6409" aria-hidden="true" tabindex="-1"></a>    i, d1 <span class="op">=</span> path[p]</span>
<span id="cb375-6410"><a href="#cb375-6410" aria-hidden="true" tabindex="-1"></a>    k, d2 <span class="op">=</span> path[p <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-6411"><a href="#cb375-6411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6412"><a href="#cb375-6412" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Delete old edge and add new edges</span></span>
<span id="cb375-6413"><a href="#cb375-6413" aria-hidden="true" tabindex="-1"></a>    tree[i] <span class="op">=</span> [edge <span class="cf">for</span> edge <span class="kw">in</span> tree[i] <span class="cf">if</span> edge[<span class="st">"n"</span>] <span class="op">!=</span> k]</span>
<span id="cb375-6414"><a href="#cb375-6414" aria-hidden="true" tabindex="-1"></a>    tree[i].append({<span class="st">"n"</span>: n, <span class="st">"w"</span>: x <span class="op">-</span> d1})</span>
<span id="cb375-6415"><a href="#cb375-6415" aria-hidden="true" tabindex="-1"></a>    tree.setdefault(n, []).append({<span class="st">"n"</span>: k, <span class="st">"w"</span>: d2 <span class="op">-</span> x})</span>
<span id="cb375-6416"><a href="#cb375-6416" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb375-6417"><a href="#cb375-6417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6418"><a href="#cb375-6418" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> additive_phylogeny(distance_matrix: DistanceMatrix, m: <span class="bu">int</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb375-6419"><a href="#cb375-6419" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(distance_matrix) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-6420"><a href="#cb375-6420" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(distance_matrix) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb375-6421"><a href="#cb375-6421" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-6422"><a href="#cb375-6422" aria-hidden="true" tabindex="-1"></a>        graph[<span class="dv">0</span>].append({<span class="st">"n"</span>: <span class="dv">1</span>, <span class="st">"w"</span>: distance_matrix[<span class="dv">0</span>][<span class="dv">1</span>]})</span>
<span id="cb375-6423"><a href="#cb375-6423" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> graph</span>
<span id="cb375-6424"><a href="#cb375-6424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6425"><a href="#cb375-6425" aria-hidden="true" tabindex="-1"></a>    limb_length <span class="op">=</span> calculate_limb_length(distance_matrix, n)</span>
<span id="cb375-6426"><a href="#cb375-6426" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb375-6427"><a href="#cb375-6427" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">!=</span> n:</span>
<span id="cb375-6428"><a href="#cb375-6428" aria-hidden="true" tabindex="-1"></a>            distance_matrix[j][n] <span class="op">-=</span> limb_length</span>
<span id="cb375-6429"><a href="#cb375-6429" aria-hidden="true" tabindex="-1"></a>            distance_matrix[n][j] <span class="op">=</span> distance_matrix[j][n]</span>
<span id="cb375-6430"><a href="#cb375-6430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6431"><a href="#cb375-6431" aria-hidden="true" tabindex="-1"></a>    i, n, k <span class="op">=</span> find_leaves(distance_matrix, n)</span>
<span id="cb375-6432"><a href="#cb375-6432" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> distance_matrix[i][n]</span>
<span id="cb375-6433"><a href="#cb375-6433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6434"><a href="#cb375-6434" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove row n and column n from distance_matrix</span></span>
<span id="cb375-6435"><a href="#cb375-6435" aria-hidden="true" tabindex="-1"></a>    reduced_matrix <span class="op">=</span> [row[:n] <span class="op">+</span> row[n<span class="op">+</span><span class="dv">1</span>:] <span class="cf">for</span> row <span class="kw">in</span> distance_matrix[:n] <span class="op">+</span> distance_matrix[n<span class="op">+</span><span class="dv">1</span>:]]</span>
<span id="cb375-6436"><a href="#cb375-6436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6437"><a href="#cb375-6437" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> additive_phylogeny(reduced_matrix, m)</span>
<span id="cb375-6438"><a href="#cb375-6438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6439"><a href="#cb375-6439" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Label for new internal node</span></span>
<span id="cb375-6440"><a href="#cb375-6440" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> <span class="bu">max</span>(<span class="bu">max</span>(get_all_nodes(tree)), m <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-6441"><a href="#cb375-6441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6442"><a href="#cb375-6442" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Break an internal edge adding a new node (possibly) and add the new leaf node</span></span>
<span id="cb375-6443"><a href="#cb375-6443" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> add_node(tree, i, k, x, v)</span>
<span id="cb375-6444"><a href="#cb375-6444" aria-hidden="true" tabindex="-1"></a>    tree.setdefault(v, []).append({<span class="st">"n"</span>: n, <span class="st">"w"</span>: limb_length})</span>
<span id="cb375-6445"><a href="#cb375-6445" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb375-6446"><a href="#cb375-6446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6447"><a href="#cb375-6447" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_edges(graph: Graph) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-6448"><a href="#cb375-6448" aria-hidden="true" tabindex="-1"></a>    edges <span class="op">=</span> []</span>
<span id="cb375-6449"><a href="#cb375-6449" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">sorted</span>(graph):</span>
<span id="cb375-6450"><a href="#cb375-6450" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> graph[k]:</span>
<span id="cb375-6451"><a href="#cb375-6451" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>v[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>v[<span class="st">'w'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-6452"><a href="#cb375-6452" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>v[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>v[<span class="st">'w'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-6453"><a href="#cb375-6453" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(edges)</span>
<span id="cb375-6454"><a href="#cb375-6454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6455"><a href="#cb375-6455" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb375-6456"><a href="#cb375-6456" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-6457"><a href="#cb375-6457" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-6458"><a href="#cb375-6458" aria-hidden="true" tabindex="-1"></a><span class="st">0   13  21  22</span></span>
<span id="cb375-6459"><a href="#cb375-6459" aria-hidden="true" tabindex="-1"></a><span class="st">13  0   12  13</span></span>
<span id="cb375-6460"><a href="#cb375-6460" aria-hidden="true" tabindex="-1"></a><span class="st">21  12  0   13</span></span>
<span id="cb375-6461"><a href="#cb375-6461" aria-hidden="true" tabindex="-1"></a><span class="st">22  13  13  0</span></span>
<span id="cb375-6462"><a href="#cb375-6462" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-6463"><a href="#cb375-6463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6464"><a href="#cb375-6464" aria-hidden="true" tabindex="-1"></a>n, <span class="op">*</span>distance_matrix_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-6465"><a href="#cb375-6465" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> parse_distance_matrix(distance_matrix_str)</span>
<span id="cb375-6466"><a href="#cb375-6466" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> additive_phylogeny(distance_matrix, <span class="bu">int</span>(n))</span>
<span id="cb375-6467"><a href="#cb375-6467" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> get_edges(graph):</span>
<span id="cb375-6468"><a href="#cb375-6468" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span>
<span id="cb375-6469"><a href="#cb375-6469" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6470"><a href="#cb375-6470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6471"><a href="#cb375-6471" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement UPGMA</span></span>
<span id="cb375-6472"><a href="#cb375-6472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6473"><a href="#cb375-6473" aria-hidden="true" tabindex="-1"></a>UPGMA Problem. Construct the ultrametric tree resulting <span class="im">from</span> UPGMA.</span>
<span id="cb375-6474"><a href="#cb375-6474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6475"><a href="#cb375-6475" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;followed by a space<span class="op">-</span>delimited&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;x&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;distance matrix.</span>
<span id="cb375-6476"><a href="#cb375-6476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6477"><a href="#cb375-6477" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An adjacency <span class="bu">list</span> <span class="cf">for</span> the ultrametric tree output by&nbsp;<span class="op">**</span>UPGMA<span class="op">**</span>. Weights should be accurate to three decimal places.</span>
<span id="cb375-6478"><a href="#cb375-6478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6479"><a href="#cb375-6479" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note on formatting<span class="op">**</span>: The adjacency <span class="bu">list</span> must have consecutive integer node labels starting <span class="im">from</span> <span class="fl">0.</span> The&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;leaves must be labeled <span class="dv">0</span>, <span class="dv">1</span>, ...,&nbsp;<span class="op">*</span>n<span class="op">*-</span><span class="dv">1</span> <span class="kw">in</span> order of their appearance <span class="kw">in</span> the distance matrix. Labels <span class="cf">for</span> internal nodes may be labeled <span class="kw">in</span> <span class="bu">any</span> order but must start from&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;and increase consecutively.</span>
<span id="cb375-6480"><a href="#cb375-6480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6481"><a href="#cb375-6481" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-6482"><a href="#cb375-6482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6483"><a href="#cb375-6483" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6484"><a href="#cb375-6484" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-6485"><a href="#cb375-6485" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   <span class="dv">20</span>  <span class="dv">17</span>  <span class="dv">11</span></span>
<span id="cb375-6486"><a href="#cb375-6486" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>  <span class="dv">0</span>   <span class="dv">20</span>  <span class="dv">13</span></span>
<span id="cb375-6487"><a href="#cb375-6487" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span>  <span class="dv">20</span>  <span class="dv">0</span>   <span class="dv">10</span></span>
<span id="cb375-6488"><a href="#cb375-6488" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>  <span class="dv">13</span>  <span class="dv">10</span>  <span class="dv">0</span></span>
<span id="cb375-6489"><a href="#cb375-6489" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6490"><a href="#cb375-6490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6491"><a href="#cb375-6491" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-6492"><a href="#cb375-6492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6493"><a href="#cb375-6493" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6494"><a href="#cb375-6494" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="fl">7.000</span></span>
<span id="cb375-6495"><a href="#cb375-6495" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">6</span>:<span class="fl">8.833</span></span>
<span id="cb375-6496"><a href="#cb375-6496" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="fl">5.000</span></span>
<span id="cb375-6497"><a href="#cb375-6497" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="fl">5.000</span></span>
<span id="cb375-6498"><a href="#cb375-6498" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">2</span>:<span class="fl">5.000</span></span>
<span id="cb375-6499"><a href="#cb375-6499" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">3</span>:<span class="fl">5.000</span></span>
<span id="cb375-6500"><a href="#cb375-6500" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="fl">2.000</span></span>
<span id="cb375-6501"><a href="#cb375-6501" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">0</span>:<span class="fl">7.000</span></span>
<span id="cb375-6502"><a href="#cb375-6502" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="fl">2.000</span></span>
<span id="cb375-6503"><a href="#cb375-6503" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">6</span>:<span class="fl">1.833</span></span>
<span id="cb375-6504"><a href="#cb375-6504" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="fl">1.833</span></span>
<span id="cb375-6505"><a href="#cb375-6505" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">1</span>:<span class="fl">8.833</span></span>
<span id="cb375-6506"><a href="#cb375-6506" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6507"><a href="#cb375-6507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6508"><a href="#cb375-6508" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-6509"><a href="#cb375-6509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6510"><a href="#cb375-6510" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-6511"><a href="#cb375-6511" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb375-6512"><a href="#cb375-6512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6513"><a href="#cb375-6513" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_matrix(lines: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-6514"><a href="#cb375-6514" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Parse integer matrix from set of lines"""</span></span>
<span id="cb375-6515"><a href="#cb375-6515" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split()] <span class="cf">for</span> line <span class="kw">in</span> lines]</span>
<span id="cb375-6516"><a href="#cb375-6516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6517"><a href="#cb375-6517" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-6518"><a href="#cb375-6518" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-6519"><a href="#cb375-6519" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb375-6520"><a href="#cb375-6520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6521"><a href="#cb375-6521" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_edges(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-6522"><a href="#cb375-6522" aria-hidden="true" tabindex="-1"></a>    edges <span class="op">=</span> []</span>
<span id="cb375-6523"><a href="#cb375-6523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> <span class="bu">sorted</span>(graph):</span>
<span id="cb375-6524"><a href="#cb375-6524" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> graph[source]:</span>
<span id="cb375-6525"><a href="#cb375-6525" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>source<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>target[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>target[<span class="st">'w'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb375-6526"><a href="#cb375-6526" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>target[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>source<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>target[<span class="st">'w'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb375-6527"><a href="#cb375-6527" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(edges)</span>
<span id="cb375-6528"><a href="#cb375-6528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6529"><a href="#cb375-6529" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> closest(distance_matrix: np.ndarray) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-6530"><a href="#cb375-6530" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Find (first) minimum off diagonal index in an array"""</span></span>
<span id="cb375-6531"><a href="#cb375-6531" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb375-6532"><a href="#cb375-6532" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(distance_matrix, distance_matrix.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-6533"><a href="#cb375-6533" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">divmod</span>(distance_matrix.argmin(), distance_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb375-6534"><a href="#cb375-6534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6535"><a href="#cb375-6535" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> average_ind(distance_matrix: np.ndarray, i: <span class="bu">int</span>, j: <span class="bu">int</span>, size_i: <span class="bu">int</span>, size_j: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-6536"><a href="#cb375-6536" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Replace the ith row/col with the average of the ith and jth and remove the jth"""</span></span>
<span id="cb375-6537"><a href="#cb375-6537" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb375-6538"><a href="#cb375-6538" aria-hidden="true" tabindex="-1"></a>    average <span class="op">=</span> (distance_matrix[i, :] <span class="op">*</span> size_i <span class="op">+</span> distance_matrix[j, :] <span class="op">*</span> size_j) <span class="op">/</span> (size_i <span class="op">+</span> size_j)</span>
<span id="cb375-6539"><a href="#cb375-6539" aria-hidden="true" tabindex="-1"></a>    distance_matrix[i, :] <span class="op">=</span> average</span>
<span id="cb375-6540"><a href="#cb375-6540" aria-hidden="true" tabindex="-1"></a>    distance_matrix[:, i] <span class="op">=</span> average</span>
<span id="cb375-6541"><a href="#cb375-6541" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.delete(distance_matrix, j, <span class="dv">0</span>)</span>
<span id="cb375-6542"><a href="#cb375-6542" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.delete(distance_matrix, j, <span class="dv">1</span>)</span>
<span id="cb375-6543"><a href="#cb375-6543" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(distance_matrix, <span class="dv">0</span>)</span>
<span id="cb375-6544"><a href="#cb375-6544" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_matrix</span>
<span id="cb375-6545"><a href="#cb375-6545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6546"><a href="#cb375-6546" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> upgma(distance_matrix: np.ndarray, num_clusters: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb375-6547"><a href="#cb375-6547" aria-hidden="true" tabindex="-1"></a>    clusters <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, num_clusters))</span>
<span id="cb375-6548"><a href="#cb375-6548" aria-hidden="true" tabindex="-1"></a>    ages: Dict[<span class="bu">int</span>, <span class="bu">float</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="dv">0</span>)  <span class="co"># the "age" of a node</span></span>
<span id="cb375-6549"><a href="#cb375-6549" aria-hidden="true" tabindex="-1"></a>    size: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="dv">1</span>)  <span class="co"># the number of descendants of a node</span></span>
<span id="cb375-6550"><a href="#cb375-6550" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]] <span class="op">=</span> {}  <span class="co"># the graph / tree we're building</span></span>
<span id="cb375-6551"><a href="#cb375-6551" aria-hidden="true" tabindex="-1"></a>    node_label <span class="op">=</span> num_clusters  <span class="co"># a label for internal nodes as we add them</span></span>
<span id="cb375-6552"><a href="#cb375-6552" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-6553"><a href="#cb375-6553" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(clusters) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb375-6554"><a href="#cb375-6554" aria-hidden="true" tabindex="-1"></a>        i, j <span class="op">=</span> closest(distance_matrix)</span>
<span id="cb375-6555"><a href="#cb375-6555" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> clusters[i], clusters[j]</span>
<span id="cb375-6556"><a href="#cb375-6556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6557"><a href="#cb375-6557" aria-hidden="true" tabindex="-1"></a>        tree[node_label] <span class="op">=</span> [</span>
<span id="cb375-6558"><a href="#cb375-6558" aria-hidden="true" tabindex="-1"></a>            {<span class="st">"n"</span>: a, <span class="st">"w"</span>: distance_matrix[i, j] <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> ages[a]},</span>
<span id="cb375-6559"><a href="#cb375-6559" aria-hidden="true" tabindex="-1"></a>            {<span class="st">"n"</span>: b, <span class="st">"w"</span>: distance_matrix[i, j] <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> ages[b]},</span>
<span id="cb375-6560"><a href="#cb375-6560" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb375-6561"><a href="#cb375-6561" aria-hidden="true" tabindex="-1"></a>        size[node_label] <span class="op">=</span> size[a] <span class="op">+</span> size[b]</span>
<span id="cb375-6562"><a href="#cb375-6562" aria-hidden="true" tabindex="-1"></a>        ages[node_label] <span class="op">=</span> distance_matrix[i, j] <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb375-6563"><a href="#cb375-6563" aria-hidden="true" tabindex="-1"></a>        clusters[i] <span class="op">=</span> node_label</span>
<span id="cb375-6564"><a href="#cb375-6564" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> clusters[j]</span>
<span id="cb375-6565"><a href="#cb375-6565" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> average_ind(distance_matrix, <span class="op">*</span>closest(distance_matrix), size[a], size[b])</span>
<span id="cb375-6566"><a href="#cb375-6566" aria-hidden="true" tabindex="-1"></a>        node_label <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-6567"><a href="#cb375-6567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6568"><a href="#cb375-6568" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb375-6569"><a href="#cb375-6569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6570"><a href="#cb375-6570" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-6571"><a href="#cb375-6571" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-6572"><a href="#cb375-6572" aria-hidden="true" tabindex="-1"></a><span class="st">0   20  17  11</span></span>
<span id="cb375-6573"><a href="#cb375-6573" aria-hidden="true" tabindex="-1"></a><span class="st">20  0   20  13</span></span>
<span id="cb375-6574"><a href="#cb375-6574" aria-hidden="true" tabindex="-1"></a><span class="st">17  20  0   10</span></span>
<span id="cb375-6575"><a href="#cb375-6575" aria-hidden="true" tabindex="-1"></a><span class="st">11  13  10  0</span></span>
<span id="cb375-6576"><a href="#cb375-6576" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-6577"><a href="#cb375-6577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6578"><a href="#cb375-6578" aria-hidden="true" tabindex="-1"></a>num_clusters, <span class="op">*</span>distance_data <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-6579"><a href="#cb375-6579" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> np.array(parse_matrix(distance_data), <span class="bu">float</span>)</span>
<span id="cb375-6580"><a href="#cb375-6580" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> upgma(distance_matrix, <span class="bu">int</span>(num_clusters))</span>
<span id="cb375-6581"><a href="#cb375-6581" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> as_edges(graph):</span>
<span id="cb375-6582"><a href="#cb375-6582" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span>
<span id="cb375-6583"><a href="#cb375-6583" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6584"><a href="#cb375-6584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6585"><a href="#cb375-6585" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement the Neighbor Joining Algorithm</span></span>
<span id="cb375-6586"><a href="#cb375-6586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6587"><a href="#cb375-6587" aria-hidden="true" tabindex="-1"></a>Neighbor Joining Problem. Construct the tree resulting <span class="im">from</span> applying the neighbor<span class="op">-</span>joining algorithm to a distance matrix.</span>
<span id="cb375-6588"><a href="#cb375-6588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6589"><a href="#cb375-6589" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>n<span class="op">*</span>, followed by a space<span class="op">-</span>separated&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;x&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;distance matrix.</span>
<span id="cb375-6590"><a href="#cb375-6590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6591"><a href="#cb375-6591" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An adjacency <span class="bu">list</span> <span class="cf">for</span> the tree resulting <span class="im">from</span> applying the neighbor<span class="op">-</span>joining algorithm. Edge<span class="op">-</span>weights should be accurate to two decimal places (they are provided to three decimal places <span class="kw">in</span> the sample output below).</span>
<span id="cb375-6592"><a href="#cb375-6592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6593"><a href="#cb375-6593" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note on formatting<span class="op">**</span>: The adjacency <span class="bu">list</span> must have consecutive integer node labels starting <span class="im">from</span> <span class="fl">0.</span> The&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;leaves must be labeled&nbsp;<span class="op">*</span><span class="dv">0</span>, <span class="dv">1</span>, ..., n<span class="op">-</span><span class="dv">1</span><span class="op">*</span>&nbsp;in order of their appearance <span class="kw">in</span> the distance matrix. Labels <span class="cf">for</span> internal nodes may be labeled <span class="kw">in</span> <span class="bu">any</span> order but must start from&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;and increase consecutively.</span>
<span id="cb375-6594"><a href="#cb375-6594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6595"><a href="#cb375-6595" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-6596"><a href="#cb375-6596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6597"><a href="#cb375-6597" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6598"><a href="#cb375-6598" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-6599"><a href="#cb375-6599" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>   <span class="dv">23</span>  <span class="dv">27</span>  <span class="dv">20</span></span>
<span id="cb375-6600"><a href="#cb375-6600" aria-hidden="true" tabindex="-1"></a><span class="dv">23</span>  <span class="dv">0</span>   <span class="dv">30</span>  <span class="dv">28</span></span>
<span id="cb375-6601"><a href="#cb375-6601" aria-hidden="true" tabindex="-1"></a><span class="dv">27</span>  <span class="dv">30</span>  <span class="dv">0</span>   <span class="dv">30</span></span>
<span id="cb375-6602"><a href="#cb375-6602" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span>  <span class="dv">28</span>  <span class="dv">30</span>  <span class="dv">0</span></span>
<span id="cb375-6603"><a href="#cb375-6603" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6604"><a href="#cb375-6604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6605"><a href="#cb375-6605" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-6606"><a href="#cb375-6606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6607"><a href="#cb375-6607" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6608"><a href="#cb375-6608" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="fl">8.000</span></span>
<span id="cb375-6609"><a href="#cb375-6609" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="fl">13.500</span></span>
<span id="cb375-6610"><a href="#cb375-6610" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="fl">16.500</span></span>
<span id="cb375-6611"><a href="#cb375-6611" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="fl">12.000</span></span>
<span id="cb375-6612"><a href="#cb375-6612" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">5</span>:<span class="fl">2.000</span></span>
<span id="cb375-6613"><a href="#cb375-6613" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">0</span>:<span class="fl">8.000</span></span>
<span id="cb375-6614"><a href="#cb375-6614" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">3</span>:<span class="fl">12.000</span></span>
<span id="cb375-6615"><a href="#cb375-6615" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">1</span>:<span class="fl">13.500</span></span>
<span id="cb375-6616"><a href="#cb375-6616" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">2</span>:<span class="fl">16.500</span></span>
<span id="cb375-6617"><a href="#cb375-6617" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">4</span>:<span class="fl">2.000</span></span>
<span id="cb375-6618"><a href="#cb375-6618" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6619"><a href="#cb375-6619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6620"><a href="#cb375-6620" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-6621"><a href="#cb375-6621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6622"><a href="#cb375-6622" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-6623"><a href="#cb375-6623" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-6624"><a href="#cb375-6624" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union</span>
<span id="cb375-6625"><a href="#cb375-6625" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-6626"><a href="#cb375-6626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6627"><a href="#cb375-6627" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_matrix(lines: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-6628"><a href="#cb375-6628" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Parse integer matrix from set of lines"""</span></span>
<span id="cb375-6629"><a href="#cb375-6629" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split()] <span class="cf">for</span> line <span class="kw">in</span> lines]</span>
<span id="cb375-6630"><a href="#cb375-6630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6631"><a href="#cb375-6631" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_edges(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, Union[<span class="bu">int</span>, <span class="bu">float</span>]]]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-6632"><a href="#cb375-6632" aria-hidden="true" tabindex="-1"></a>    formatted_edges <span class="op">=</span> []</span>
<span id="cb375-6633"><a href="#cb375-6633" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">sorted</span>(tree):</span>
<span id="cb375-6634"><a href="#cb375-6634" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> tree[node]:</span>
<span id="cb375-6635"><a href="#cb375-6635" aria-hidden="true" tabindex="-1"></a>            formatted_edges.append(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>neighbor[<span class="st">'node'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>neighbor[<span class="st">'weight'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb375-6636"><a href="#cb375-6636" aria-hidden="true" tabindex="-1"></a>            formatted_edges.append(<span class="ss">f"</span><span class="sc">{</span>neighbor[<span class="st">'node'</span>]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>neighbor[<span class="st">'weight'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb375-6637"><a href="#cb375-6637" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(formatted_edges)</span>
<span id="cb375-6638"><a href="#cb375-6638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6639"><a href="#cb375-6639" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_closest_pair(distance_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-6640"><a href="#cb375-6640" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Find (first) minimum off-diagonal index in an array"""</span></span>
<span id="cb375-6641"><a href="#cb375-6641" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb375-6642"><a href="#cb375-6642" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(temp_matrix, temp_matrix.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-6643"><a href="#cb375-6643" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">divmod</span>(temp_matrix.argmin(), temp_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb375-6644"><a href="#cb375-6644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6645"><a href="#cb375-6645" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_neighbor_joining_matrix(distance_matrix: np.ndarray, num_nodes: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-6646"><a href="#cb375-6646" aria-hidden="true" tabindex="-1"></a>    nj_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb375-6647"><a href="#cb375-6647" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb375-6648"><a href="#cb375-6648" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb375-6649"><a href="#cb375-6649" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j:</span>
<span id="cb375-6650"><a href="#cb375-6650" aria-hidden="true" tabindex="-1"></a>                nj_matrix[i, j] <span class="op">=</span> (num_nodes <span class="op">-</span> <span class="dv">2</span>) <span class="op">*</span> distance_matrix[i, j] <span class="op">-</span> <span class="bu">sum</span>(distance_matrix[i, :]) <span class="op">-</span> <span class="bu">sum</span>(distance_matrix[j, :])</span>
<span id="cb375-6651"><a href="#cb375-6651" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nj_matrix</span>
<span id="cb375-6652"><a href="#cb375-6652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6653"><a href="#cb375-6653" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> neighbor_joining(distance_matrix: np.ndarray, num_nodes: <span class="bu">int</span>, labels: List[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, Union[<span class="bu">int</span>, <span class="bu">float</span>]]]]:</span>
<span id="cb375-6654"><a href="#cb375-6654" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> labels:</span>
<span id="cb375-6655"><a href="#cb375-6655" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(num_nodes))</span>
<span id="cb375-6656"><a href="#cb375-6656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6657"><a href="#cb375-6657" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> num_nodes <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb375-6658"><a href="#cb375-6658" aria-hidden="true" tabindex="-1"></a>        tree <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-6659"><a href="#cb375-6659" aria-hidden="true" tabindex="-1"></a>        tree[labels[<span class="dv">0</span>]].append({<span class="st">"node"</span>: labels[<span class="dv">1</span>], <span class="st">"weight"</span>: distance_matrix[<span class="dv">0</span>][<span class="dv">1</span>]})</span>
<span id="cb375-6660"><a href="#cb375-6660" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> tree</span>
<span id="cb375-6661"><a href="#cb375-6661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6662"><a href="#cb375-6662" aria-hidden="true" tabindex="-1"></a>    nj_matrix <span class="op">=</span> calculate_neighbor_joining_matrix(distance_matrix, num_nodes)</span>
<span id="cb375-6663"><a href="#cb375-6663" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> find_closest_pair(nj_matrix)</span>
<span id="cb375-6664"><a href="#cb375-6664" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> (<span class="bu">sum</span>(distance_matrix[i, :]) <span class="op">-</span> <span class="bu">sum</span>(distance_matrix[j, :])) <span class="op">/</span> (num_nodes <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb375-6665"><a href="#cb375-6665" aria-hidden="true" tabindex="-1"></a>    limb_i <span class="op">=</span> (distance_matrix[i, j] <span class="op">+</span> delta) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb375-6666"><a href="#cb375-6666" aria-hidden="true" tabindex="-1"></a>    limb_j <span class="op">=</span> (distance_matrix[i, j] <span class="op">-</span> delta) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb375-6667"><a href="#cb375-6667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6668"><a href="#cb375-6668" aria-hidden="true" tabindex="-1"></a>    label_i <span class="op">=</span> labels[i]</span>
<span id="cb375-6669"><a href="#cb375-6669" aria-hidden="true" tabindex="-1"></a>    label_j <span class="op">=</span> labels[j]</span>
<span id="cb375-6670"><a href="#cb375-6670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6671"><a href="#cb375-6671" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.append(distance_matrix, np.zeros((<span class="dv">1</span>, <span class="bu">len</span>(distance_matrix))), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb375-6672"><a href="#cb375-6672" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.append(distance_matrix, np.zeros((<span class="bu">len</span>(distance_matrix), <span class="dv">1</span>)), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb375-6673"><a href="#cb375-6673" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> labels <span class="op">+</span> [<span class="bu">max</span>(labels) <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-6674"><a href="#cb375-6674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6675"><a href="#cb375-6675" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(num_nodes):</span>
<span id="cb375-6676"><a href="#cb375-6676" aria-hidden="true" tabindex="-1"></a>        distance_matrix[k, num_nodes] <span class="op">=</span> (distance_matrix[k, i] <span class="op">+</span> distance_matrix[k, j] <span class="op">-</span> distance_matrix[i, j]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb375-6677"><a href="#cb375-6677" aria-hidden="true" tabindex="-1"></a>        distance_matrix[num_nodes, k] <span class="op">=</span> (distance_matrix[k, i] <span class="op">+</span> distance_matrix[k, j] <span class="op">-</span> distance_matrix[i, j]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb375-6678"><a href="#cb375-6678" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> [j, i]:</span>
<span id="cb375-6679"><a href="#cb375-6679" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> np.delete(distance_matrix, x, <span class="dv">0</span>)</span>
<span id="cb375-6680"><a href="#cb375-6680" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> np.delete(distance_matrix, x, <span class="dv">1</span>)</span>
<span id="cb375-6681"><a href="#cb375-6681" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> labels[x]</span>
<span id="cb375-6682"><a href="#cb375-6682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6683"><a href="#cb375-6683" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> neighbor_joining(distance_matrix, num_nodes <span class="op">-</span> <span class="dv">1</span>, labels)</span>
<span id="cb375-6684"><a href="#cb375-6684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6685"><a href="#cb375-6685" aria-hidden="true" tabindex="-1"></a>    tree[labels[<span class="op">-</span><span class="dv">1</span>]].append({<span class="st">"node"</span>: label_i, <span class="st">"weight"</span>: limb_i})</span>
<span id="cb375-6686"><a href="#cb375-6686" aria-hidden="true" tabindex="-1"></a>    tree[labels[<span class="op">-</span><span class="dv">1</span>]].append({<span class="st">"node"</span>: label_j, <span class="st">"weight"</span>: limb_j})</span>
<span id="cb375-6687"><a href="#cb375-6687" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb375-6688"><a href="#cb375-6688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6689"><a href="#cb375-6689" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-6690"><a href="#cb375-6690" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-6691"><a href="#cb375-6691" aria-hidden="true" tabindex="-1"></a><span class="st">0   23  27  20</span></span>
<span id="cb375-6692"><a href="#cb375-6692" aria-hidden="true" tabindex="-1"></a><span class="st">23  0   30  28</span></span>
<span id="cb375-6693"><a href="#cb375-6693" aria-hidden="true" tabindex="-1"></a><span class="st">27  30  0   30</span></span>
<span id="cb375-6694"><a href="#cb375-6694" aria-hidden="true" tabindex="-1"></a><span class="st">20  28  30  0</span></span>
<span id="cb375-6695"><a href="#cb375-6695" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-6696"><a href="#cb375-6696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6697"><a href="#cb375-6697" aria-hidden="true" tabindex="-1"></a>num_nodes, <span class="op">*</span>distance_matrix <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-6698"><a href="#cb375-6698" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> np.array(parse_matrix(distance_matrix), <span class="bu">float</span>)</span>
<span id="cb375-6699"><a href="#cb375-6699" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> neighbor_joining(distance_matrix, <span class="bu">int</span>(num_nodes))</span>
<span id="cb375-6700"><a href="#cb375-6700" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> format_edges(tree):</span>
<span id="cb375-6701"><a href="#cb375-6701" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span>
<span id="cb375-6702"><a href="#cb375-6702" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6703"><a href="#cb375-6703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6704"><a href="#cb375-6704" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement SmallParsimony</span></span>
<span id="cb375-6705"><a href="#cb375-6705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6706"><a href="#cb375-6706" aria-hidden="true" tabindex="-1"></a>Small Parsimony Problem. Find the most parsimonious labeling of the internal nodes of a rooted tree.</span>
<span id="cb375-6707"><a href="#cb375-6707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6708"><a href="#cb375-6708" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;followed by an adjacency <span class="bu">list</span> <span class="cf">for</span> a rooted binary tree with&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;leaves labeled by DNA strings.</span>
<span id="cb375-6709"><a href="#cb375-6709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6710"><a href="#cb375-6710" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The minimum parsimony score of this tree, followed by the adjacency <span class="bu">list</span> of the tree corresponding to labeling internal nodes by DNA strings <span class="kw">in</span> order to minimize the parsimony score of the tree.</span>
<span id="cb375-6711"><a href="#cb375-6711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6712"><a href="#cb375-6712" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note:<span class="op">**</span>&nbsp;Remember to run&nbsp;<span class="op">**</span>SmallParsimony<span class="op">**</span>&nbsp;on each individual index of the strings at the leaves of the tree.</span>
<span id="cb375-6713"><a href="#cb375-6713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6714"><a href="#cb375-6714" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-6715"><a href="#cb375-6715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6716"><a href="#cb375-6716" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6717"><a href="#cb375-6717" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-6718"><a href="#cb375-6718" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span>CAAATCCC</span>
<span id="cb375-6719"><a href="#cb375-6719" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span>ATTGCGAC</span>
<span id="cb375-6720"><a href="#cb375-6720" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span>CTGCGCTG</span>
<span id="cb375-6721"><a href="#cb375-6721" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span>ATGGACGA</span>
<span id="cb375-6722"><a href="#cb375-6722" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb375-6723"><a href="#cb375-6723" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span><span class="op">-&gt;</span><span class="dv">5</span></span>
<span id="cb375-6724"><a href="#cb375-6724" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6725"><a href="#cb375-6725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6726"><a href="#cb375-6726" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-6727"><a href="#cb375-6727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6728"><a href="#cb375-6728" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6729"><a href="#cb375-6729" aria-hidden="true" tabindex="-1"></a><span class="dv">16</span></span>
<span id="cb375-6730"><a href="#cb375-6730" aria-hidden="true" tabindex="-1"></a>ATAGACAA<span class="op">-&gt;</span>ATAGACAC:<span class="dv">1</span></span>
<span id="cb375-6731"><a href="#cb375-6731" aria-hidden="true" tabindex="-1"></a>ATAGACAC<span class="op">-&gt;</span>ATAGACAA:<span class="dv">1</span></span>
<span id="cb375-6732"><a href="#cb375-6732" aria-hidden="true" tabindex="-1"></a>ATAGACAC<span class="op">-&gt;</span>CAAATCCC:<span class="dv">5</span></span>
<span id="cb375-6733"><a href="#cb375-6733" aria-hidden="true" tabindex="-1"></a>CAAATCCC<span class="op">-&gt;</span>ATAGACAC:<span class="dv">5</span></span>
<span id="cb375-6734"><a href="#cb375-6734" aria-hidden="true" tabindex="-1"></a>ATAGACAC<span class="op">-&gt;</span>ATTGCGAC:<span class="dv">3</span></span>
<span id="cb375-6735"><a href="#cb375-6735" aria-hidden="true" tabindex="-1"></a>ATTGCGAC<span class="op">-&gt;</span>ATAGACAC:<span class="dv">3</span></span>
<span id="cb375-6736"><a href="#cb375-6736" aria-hidden="true" tabindex="-1"></a>ATAGACAA<span class="op">-&gt;</span>ATGGACAA:<span class="dv">1</span></span>
<span id="cb375-6737"><a href="#cb375-6737" aria-hidden="true" tabindex="-1"></a>ATGGACAA<span class="op">-&gt;</span>ATAGACAA:<span class="dv">1</span></span>
<span id="cb375-6738"><a href="#cb375-6738" aria-hidden="true" tabindex="-1"></a>ATGGACAA<span class="op">-&gt;</span>CTGCGCTG:<span class="dv">5</span></span>
<span id="cb375-6739"><a href="#cb375-6739" aria-hidden="true" tabindex="-1"></a>CTGCGCTG<span class="op">-&gt;</span>ATGGACAA:<span class="dv">5</span></span>
<span id="cb375-6740"><a href="#cb375-6740" aria-hidden="true" tabindex="-1"></a>ATGGACAA<span class="op">-&gt;</span>ATGGACGA:<span class="dv">1</span></span>
<span id="cb375-6741"><a href="#cb375-6741" aria-hidden="true" tabindex="-1"></a>ATGGACGA<span class="op">-&gt;</span>ATGGACAA:<span class="dv">1</span></span>
<span id="cb375-6742"><a href="#cb375-6742" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6743"><a href="#cb375-6743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6744"><a href="#cb375-6744" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-6745"><a href="#cb375-6745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6746"><a href="#cb375-6746" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-6747"><a href="#cb375-6747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6748"><a href="#cb375-6748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6749"><a href="#cb375-6749" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6750"><a href="#cb375-6750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6751"><a href="#cb375-6751" aria-hidden="true" tabindex="-1"></a><span class="co"># Adapt SmallParsimony to Unrooted Trees</span></span>
<span id="cb375-6752"><a href="#cb375-6752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6753"><a href="#cb375-6753" aria-hidden="true" tabindex="-1"></a>Small Parsimony <span class="kw">in</span> an Unrooted Tree Problem. Find the most parsimonious labeling of the internal nodes <span class="kw">in</span> an unrooted tree.</span>
<span id="cb375-6754"><a href="#cb375-6754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6755"><a href="#cb375-6755" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An unrooted binary tree <span class="cf">with</span> each leaf labeled by a string of length&nbsp;<span class="op">*</span>m<span class="op">*</span>.</span>
<span id="cb375-6756"><a href="#cb375-6756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6757"><a href="#cb375-6757" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A labeling of <span class="bu">all</span> other nodes of the tree by strings of length&nbsp;<span class="op">*</span>m<span class="op">*</span>&nbsp;that minimizes the parsimony score of the tree.</span>
<span id="cb375-6758"><a href="#cb375-6758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6759"><a href="#cb375-6759" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note on formatting<span class="op">**</span>: Your internal node labelings may differ <span class="im">from</span> the sample provided.</span>
<span id="cb375-6760"><a href="#cb375-6760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6761"><a href="#cb375-6761" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-6762"><a href="#cb375-6762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6763"><a href="#cb375-6763" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6764"><a href="#cb375-6764" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-6765"><a href="#cb375-6765" aria-hidden="true" tabindex="-1"></a>TCGGCCAA<span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb375-6766"><a href="#cb375-6766" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span>TCGGCCAA</span>
<span id="cb375-6767"><a href="#cb375-6767" aria-hidden="true" tabindex="-1"></a>CCTGGCTG<span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb375-6768"><a href="#cb375-6768" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span>CCTGGCTG</span>
<span id="cb375-6769"><a href="#cb375-6769" aria-hidden="true" tabindex="-1"></a>CACAGGAT<span class="op">-&gt;</span><span class="dv">5</span></span>
<span id="cb375-6770"><a href="#cb375-6770" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span>CACAGGAT</span>
<span id="cb375-6771"><a href="#cb375-6771" aria-hidden="true" tabindex="-1"></a>TGAGTACC<span class="op">-&gt;</span><span class="dv">5</span></span>
<span id="cb375-6772"><a href="#cb375-6772" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span>TGAGTACC</span>
<span id="cb375-6773"><a href="#cb375-6773" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">5</span></span>
<span id="cb375-6774"><a href="#cb375-6774" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb375-6775"><a href="#cb375-6775" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6776"><a href="#cb375-6776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6777"><a href="#cb375-6777" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-6778"><a href="#cb375-6778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6779"><a href="#cb375-6779" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6780"><a href="#cb375-6780" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span></span>
<span id="cb375-6781"><a href="#cb375-6781" aria-hidden="true" tabindex="-1"></a>TCGGCCAA<span class="op">-&gt;</span>CCAGGCAC:<span class="dv">4</span></span>
<span id="cb375-6782"><a href="#cb375-6782" aria-hidden="true" tabindex="-1"></a>CCTGGCTG<span class="op">-&gt;</span>CCAGGCAC:<span class="dv">3</span></span>
<span id="cb375-6783"><a href="#cb375-6783" aria-hidden="true" tabindex="-1"></a>TGAGTACC<span class="op">-&gt;</span>CAAGGAAC:<span class="dv">4</span></span>
<span id="cb375-6784"><a href="#cb375-6784" aria-hidden="true" tabindex="-1"></a>CCAGGCAC<span class="op">-&gt;</span>CCTGGCTG:<span class="dv">3</span></span>
<span id="cb375-6785"><a href="#cb375-6785" aria-hidden="true" tabindex="-1"></a>CCAGGCAC<span class="op">-&gt;</span>CAAGGAAC:<span class="dv">2</span></span>
<span id="cb375-6786"><a href="#cb375-6786" aria-hidden="true" tabindex="-1"></a>CCAGGCAC<span class="op">-&gt;</span>TCGGCCAA:<span class="dv">4</span></span>
<span id="cb375-6787"><a href="#cb375-6787" aria-hidden="true" tabindex="-1"></a>CACAGGAT<span class="op">-&gt;</span>CAAGGAAC:<span class="dv">4</span></span>
<span id="cb375-6788"><a href="#cb375-6788" aria-hidden="true" tabindex="-1"></a>CAAGGAAC<span class="op">-&gt;</span>CACAGGAT:<span class="dv">4</span></span>
<span id="cb375-6789"><a href="#cb375-6789" aria-hidden="true" tabindex="-1"></a>CAAGGAAC<span class="op">-&gt;</span>TGAGTACC:<span class="dv">4</span></span>
<span id="cb375-6790"><a href="#cb375-6790" aria-hidden="true" tabindex="-1"></a>CAAGGAAC<span class="op">-&gt;</span>CCAGGCAC:<span class="dv">2</span></span>
<span id="cb375-6791"><a href="#cb375-6791" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6792"><a href="#cb375-6792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6793"><a href="#cb375-6793" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-6794"><a href="#cb375-6794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6795"><a href="#cb375-6795" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-6796"><a href="#cb375-6796" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-6797"><a href="#cb375-6797" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb375-6798"><a href="#cb375-6798" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb375-6799"><a href="#cb375-6799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6800"><a href="#cb375-6800" aria-hidden="true" tabindex="-1"></a><span class="co"># return all nodes of a simple graph</span></span>
<span id="cb375-6801"><a href="#cb375-6801" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-6802"><a href="#cb375-6802" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="bu">list</span>(graph.keys())</span>
<span id="cb375-6803"><a href="#cb375-6803" aria-hidden="true" tabindex="-1"></a>    e <span class="op">=</span> [y <span class="cf">for</span> v <span class="kw">in</span> graph.values() <span class="cf">for</span> y <span class="kw">in</span> v]</span>
<span id="cb375-6804"><a href="#cb375-6804" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(s) <span class="op">|</span> <span class="bu">set</span>(e)</span>
<span id="cb375-6805"><a href="#cb375-6805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6806"><a href="#cb375-6806" aria-hidden="true" tabindex="-1"></a><span class="co"># return all leaves of a simple graph</span></span>
<span id="cb375-6807"><a href="#cb375-6807" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaves(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-6808"><a href="#cb375-6808" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(y <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">list</span>(graph.values()) <span class="cf">for</span> y <span class="kw">in</span> v <span class="cf">if</span> <span class="kw">not</span> graph[y])</span>
<span id="cb375-6809"><a href="#cb375-6809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6810"><a href="#cb375-6810" aria-hidden="true" tabindex="-1"></a><span class="co"># return all root node of a simple graph</span></span>
<span id="cb375-6811"><a href="#cb375-6811" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> root(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-6812"><a href="#cb375-6812" aria-hidden="true" tabindex="-1"></a>    rev <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb375-6813"><a href="#cb375-6813" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> <span class="bu">list</span>(nodes(graph))[<span class="dv">0</span>]</span>
<span id="cb375-6814"><a href="#cb375-6814" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="kw">in</span> rev:</span>
<span id="cb375-6815"><a href="#cb375-6815" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> rev[node]</span>
<span id="cb375-6816"><a href="#cb375-6816" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node</span>
<span id="cb375-6817"><a href="#cb375-6817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6818"><a href="#cb375-6818" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse a simple graph (child points to parent)</span></span>
<span id="cb375-6819"><a href="#cb375-6819" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-6820"><a href="#cb375-6820" aria-hidden="true" tabindex="-1"></a>    rev: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-6821"><a href="#cb375-6821" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb375-6822"><a href="#cb375-6822" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb375-6823"><a href="#cb375-6823" aria-hidden="true" tabindex="-1"></a>            rev[child] <span class="op">=</span> node</span>
<span id="cb375-6824"><a href="#cb375-6824" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rev</span>
<span id="cb375-6825"><a href="#cb375-6825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6826"><a href="#cb375-6826" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">int</span>, <span class="bu">str</span>], Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]:</span>
<span id="cb375-6827"><a href="#cb375-6827" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_string.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb375-6828"><a href="#cb375-6828" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">0</span>])</span>
<span id="cb375-6829"><a href="#cb375-6829" aria-hidden="true" tabindex="-1"></a>    seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb375-6830"><a href="#cb375-6830" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-6831"><a href="#cb375-6831" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, edge <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:n<span class="op">+</span><span class="dv">1</span>]):</span>
<span id="cb375-6832"><a href="#cb375-6832" aria-hidden="true" tabindex="-1"></a>        f, t <span class="op">=</span> edge.rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb375-6833"><a href="#cb375-6833" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(f)].append(i)</span>
<span id="cb375-6834"><a href="#cb375-6834" aria-hidden="true" tabindex="-1"></a>        seqs[i] <span class="op">=</span> t</span>
<span id="cb375-6835"><a href="#cb375-6835" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> lines[n<span class="op">+</span><span class="dv">1</span>:]:</span>
<span id="cb375-6836"><a href="#cb375-6836" aria-hidden="true" tabindex="-1"></a>        f, t <span class="op">=</span> edge.rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb375-6837"><a href="#cb375-6837" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(f)].append(<span class="bu">int</span>(t))</span>
<span id="cb375-6838"><a href="#cb375-6838" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seqs, graph</span>
<span id="cb375-6839"><a href="#cb375-6839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6840"><a href="#cb375-6840" aria-hidden="true" tabindex="-1"></a><span class="co"># print (bidirectional) edges</span></span>
<span id="cb375-6841"><a href="#cb375-6841" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_edges(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>], node: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-6842"><a href="#cb375-6842" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb375-6843"><a href="#cb375-6843" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">in</span> seqs <span class="kw">and</span> child <span class="kw">in</span> seqs:</span>
<span id="cb375-6844"><a href="#cb375-6844" aria-hidden="true" tabindex="-1"></a>            dist <span class="op">=</span> <span class="bu">sum</span>(a <span class="op">!=</span> b <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(seqs[node], seqs[child]))</span>
<span id="cb375-6845"><a href="#cb375-6845" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>seqs[node]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>seqs[child]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>dist<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-6846"><a href="#cb375-6846" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>seqs[child]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>seqs[node]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>dist<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-6847"><a href="#cb375-6847" aria-hidden="true" tabindex="-1"></a>        print_edges(graph, seqs, child)</span>
<span id="cb375-6848"><a href="#cb375-6848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6849"><a href="#cb375-6849" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_position(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>], pos: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb375-6850"><a href="#cb375-6850" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb375-6851"><a href="#cb375-6851" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> nodes(graph) <span class="op">-</span> leaves(graph):</span>
<span id="cb375-6852"><a href="#cb375-6852" aria-hidden="true" tabindex="-1"></a>        chars[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-6853"><a href="#cb375-6853" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves(graph):</span>
<span id="cb375-6854"><a href="#cb375-6854" aria-hidden="true" tabindex="-1"></a>        chars[leaf] <span class="op">=</span> seqs[leaf][pos]</span>
<span id="cb375-6855"><a href="#cb375-6855" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb375-6856"><a href="#cb375-6856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6857"><a href="#cb375-6857" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> traceback(skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]], node: <span class="bu">int</span>, ind: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb375-6858"><a href="#cb375-6858" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb375-6859"><a href="#cb375-6859" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb375-6860"><a href="#cb375-6860" aria-hidden="true" tabindex="-1"></a>    chars[node] <span class="op">=</span> bases[ind]</span>
<span id="cb375-6861"><a href="#cb375-6861" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> skp[node][ind].items():</span>
<span id="cb375-6862"><a href="#cb375-6862" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> k <span class="kw">in</span> skp:</span>
<span id="cb375-6863"><a href="#cb375-6863" aria-hidden="true" tabindex="-1"></a>            chars <span class="op">=</span> chars <span class="op">|</span> traceback(skp, k, v)</span>
<span id="cb375-6864"><a href="#cb375-6864" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb375-6865"><a href="#cb375-6865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6866"><a href="#cb375-6866" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> small_parsimony(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb375-6867"><a href="#cb375-6867" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb375-6868"><a href="#cb375-6868" aria-hidden="true" tabindex="-1"></a>    sk: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}  <span class="co"># minimum parsimony score of the subtree over possible labels</span></span>
<span id="cb375-6869"><a href="#cb375-6869" aria-hidden="true" tabindex="-1"></a>    skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]] <span class="op">=</span> {}  <span class="co"># pointer to selected base for each child over possible labels</span></span>
<span id="cb375-6870"><a href="#cb375-6870" aria-hidden="true" tabindex="-1"></a>    to_process <span class="op">=</span> nodes(graph)</span>
<span id="cb375-6871"><a href="#cb375-6871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6872"><a href="#cb375-6872" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialise leaves</span></span>
<span id="cb375-6873"><a href="#cb375-6873" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves(graph):</span>
<span id="cb375-6874"><a href="#cb375-6874" aria-hidden="true" tabindex="-1"></a>        sk[leaf] <span class="op">=</span> [<span class="dv">0</span> <span class="cf">if</span> chars[leaf] <span class="op">==</span> c <span class="cf">else</span> inf <span class="cf">for</span> c <span class="kw">in</span> bases]</span>
<span id="cb375-6875"><a href="#cb375-6875" aria-hidden="true" tabindex="-1"></a>        to_process.remove(leaf)</span>
<span id="cb375-6876"><a href="#cb375-6876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6877"><a href="#cb375-6877" aria-hidden="true" tabindex="-1"></a>    <span class="co"># iterate over available nodes till all are processed</span></span>
<span id="cb375-6878"><a href="#cb375-6878" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> to_process:</span>
<span id="cb375-6879"><a href="#cb375-6879" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">list</span>(to_process):</span>
<span id="cb375-6880"><a href="#cb375-6880" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(v <span class="kw">in</span> sk <span class="cf">for</span> v <span class="kw">in</span> graph[n]):</span>
<span id="cb375-6881"><a href="#cb375-6881" aria-hidden="true" tabindex="-1"></a>                sk[n], skp[n] <span class="op">=</span> [], []</span>
<span id="cb375-6882"><a href="#cb375-6882" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> bases:</span>
<span id="cb375-6883"><a href="#cb375-6883" aria-hidden="true" tabindex="-1"></a>                    tot <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-6884"><a href="#cb375-6884" aria-hidden="true" tabindex="-1"></a>                    ptr: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-6885"><a href="#cb375-6885" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> d, sk_child <span class="kw">in</span> [(d, sk[d]) <span class="cf">for</span> d <span class="kw">in</span> graph[n]]:</span>
<span id="cb375-6886"><a href="#cb375-6886" aria-hidden="true" tabindex="-1"></a>                        score <span class="op">=</span> []</span>
<span id="cb375-6887"><a href="#cb375-6887" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(bases):</span>
<span id="cb375-6888"><a href="#cb375-6888" aria-hidden="true" tabindex="-1"></a>                            score <span class="op">+=</span> [sk_child[i] <span class="op">+</span> (<span class="dv">0</span> <span class="cf">if</span> c <span class="op">==</span> k <span class="cf">else</span> <span class="dv">1</span>)]</span>
<span id="cb375-6889"><a href="#cb375-6889" aria-hidden="true" tabindex="-1"></a>                        tot <span class="op">+=</span> <span class="bu">min</span>(score)</span>
<span id="cb375-6890"><a href="#cb375-6890" aria-hidden="true" tabindex="-1"></a>                        ptr[d] <span class="op">=</span> score.index(<span class="bu">min</span>(score))</span>
<span id="cb375-6891"><a href="#cb375-6891" aria-hidden="true" tabindex="-1"></a>                    skp[n] <span class="op">+=</span> [ptr]</span>
<span id="cb375-6892"><a href="#cb375-6892" aria-hidden="true" tabindex="-1"></a>                    sk[n] <span class="op">+=</span> [tot]</span>
<span id="cb375-6893"><a href="#cb375-6893" aria-hidden="true" tabindex="-1"></a>                to_process.remove(n)</span>
<span id="cb375-6894"><a href="#cb375-6894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6895"><a href="#cb375-6895" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recover sequence</span></span>
<span id="cb375-6896"><a href="#cb375-6896" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> root(graph)</span>
<span id="cb375-6897"><a href="#cb375-6897" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> <span class="bu">min</span>(sk[node])</span>
<span id="cb375-6898"><a href="#cb375-6898" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score, traceback(skp, node, sk[node].index(score))</span>
<span id="cb375-6899"><a href="#cb375-6899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6900"><a href="#cb375-6900" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6f(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb375-6901"><a href="#cb375-6901" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialise sequences</span></span>
<span id="cb375-6902"><a href="#cb375-6902" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> nodes(graph) <span class="op">-</span> leaves(graph):</span>
<span id="cb375-6903"><a href="#cb375-6903" aria-hidden="true" tabindex="-1"></a>        seqs[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-6904"><a href="#cb375-6904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6905"><a href="#cb375-6905" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-6906"><a href="#cb375-6906" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pos <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="bu">next</span>(<span class="bu">iter</span>(seqs.values())))):</span>
<span id="cb375-6907"><a href="#cb375-6907" aria-hidden="true" tabindex="-1"></a>        chars <span class="op">=</span> extract_position(graph, seqs, pos)</span>
<span id="cb375-6908"><a href="#cb375-6908" aria-hidden="true" tabindex="-1"></a>        score, tbchars <span class="op">=</span> small_parsimony(graph, chars)</span>
<span id="cb375-6909"><a href="#cb375-6909" aria-hidden="true" tabindex="-1"></a>        total_score <span class="op">+=</span> score</span>
<span id="cb375-6910"><a href="#cb375-6910" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k, v <span class="kw">in</span> tbchars.items():</span>
<span id="cb375-6911"><a href="#cb375-6911" aria-hidden="true" tabindex="-1"></a>            seqs[k] <span class="op">+=</span> v</span>
<span id="cb375-6912"><a href="#cb375-6912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6913"><a href="#cb375-6913" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_score, seqs</span>
<span id="cb375-6914"><a href="#cb375-6914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6915"><a href="#cb375-6915" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-6916"><a href="#cb375-6916" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-6917"><a href="#cb375-6917" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;CAAATCCC</span></span>
<span id="cb375-6918"><a href="#cb375-6918" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;ATTGCGAC</span></span>
<span id="cb375-6919"><a href="#cb375-6919" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;CTGCGCTG</span></span>
<span id="cb375-6920"><a href="#cb375-6920" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;ATGGACGA</span></span>
<span id="cb375-6921"><a href="#cb375-6921" aria-hidden="true" tabindex="-1"></a><span class="st">6-&gt;4</span></span>
<span id="cb375-6922"><a href="#cb375-6922" aria-hidden="true" tabindex="-1"></a><span class="st">6-&gt;5</span></span>
<span id="cb375-6923"><a href="#cb375-6923" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-6924"><a href="#cb375-6924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6925"><a href="#cb375-6925" aria-hidden="true" tabindex="-1"></a>seqs, graph <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-6926"><a href="#cb375-6926" aria-hidden="true" tabindex="-1"></a>total_score, seqs <span class="op">=</span> ba6f(graph, seqs)</span>
<span id="cb375-6927"><a href="#cb375-6927" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(total_score)</span>
<span id="cb375-6928"><a href="#cb375-6928" aria-hidden="true" tabindex="-1"></a>print_edges(graph, seqs, root(graph))</span>
<span id="cb375-6929"><a href="#cb375-6929" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6930"><a href="#cb375-6930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6931"><a href="#cb375-6931" aria-hidden="true" tabindex="-1"></a><span class="co"># Adapt SmallParsimony to Unrooted Trees</span></span>
<span id="cb375-6932"><a href="#cb375-6932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6933"><a href="#cb375-6933" aria-hidden="true" tabindex="-1"></a>Small Parsimony <span class="kw">in</span> an Unrooted Tree Problem. Find the most parsimonious labeling of the internal nodes <span class="kw">in</span> an unrooted tree.</span>
<span id="cb375-6934"><a href="#cb375-6934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6935"><a href="#cb375-6935" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An unrooted binary tree <span class="cf">with</span> each leaf labeled by a string of length&nbsp;<span class="op">*</span>m<span class="op">*</span>.</span>
<span id="cb375-6936"><a href="#cb375-6936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6937"><a href="#cb375-6937" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A labeling of <span class="bu">all</span> other nodes of the tree by strings of length&nbsp;<span class="op">*</span>m<span class="op">*</span>&nbsp;that minimizes the parsimony score of the tree.</span>
<span id="cb375-6938"><a href="#cb375-6938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6939"><a href="#cb375-6939" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note on formatting<span class="op">**</span>: Your internal node labelings may differ <span class="im">from</span> the sample provided.</span>
<span id="cb375-6940"><a href="#cb375-6940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6941"><a href="#cb375-6941" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-6942"><a href="#cb375-6942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6943"><a href="#cb375-6943" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6944"><a href="#cb375-6944" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span>
<span id="cb375-6945"><a href="#cb375-6945" aria-hidden="true" tabindex="-1"></a>TCGGCCAA<span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb375-6946"><a href="#cb375-6946" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span>TCGGCCAA</span>
<span id="cb375-6947"><a href="#cb375-6947" aria-hidden="true" tabindex="-1"></a>CCTGGCTG<span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb375-6948"><a href="#cb375-6948" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span>CCTGGCTG</span>
<span id="cb375-6949"><a href="#cb375-6949" aria-hidden="true" tabindex="-1"></a>CACAGGAT<span class="op">-&gt;</span><span class="dv">5</span></span>
<span id="cb375-6950"><a href="#cb375-6950" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span>CACAGGAT</span>
<span id="cb375-6951"><a href="#cb375-6951" aria-hidden="true" tabindex="-1"></a>TGAGTACC<span class="op">-&gt;</span><span class="dv">5</span></span>
<span id="cb375-6952"><a href="#cb375-6952" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span>TGAGTACC</span>
<span id="cb375-6953"><a href="#cb375-6953" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">5</span></span>
<span id="cb375-6954"><a href="#cb375-6954" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span><span class="op">-&gt;</span><span class="dv">4</span></span>
<span id="cb375-6955"><a href="#cb375-6955" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6956"><a href="#cb375-6956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6957"><a href="#cb375-6957" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-6958"><a href="#cb375-6958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6959"><a href="#cb375-6959" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6960"><a href="#cb375-6960" aria-hidden="true" tabindex="-1"></a><span class="dv">17</span></span>
<span id="cb375-6961"><a href="#cb375-6961" aria-hidden="true" tabindex="-1"></a>TCGGCCAA<span class="op">-&gt;</span>CCAGGCAC:<span class="dv">4</span></span>
<span id="cb375-6962"><a href="#cb375-6962" aria-hidden="true" tabindex="-1"></a>CCTGGCTG<span class="op">-&gt;</span>CCAGGCAC:<span class="dv">3</span></span>
<span id="cb375-6963"><a href="#cb375-6963" aria-hidden="true" tabindex="-1"></a>TGAGTACC<span class="op">-&gt;</span>CAAGGAAC:<span class="dv">4</span></span>
<span id="cb375-6964"><a href="#cb375-6964" aria-hidden="true" tabindex="-1"></a>CCAGGCAC<span class="op">-&gt;</span>CCTGGCTG:<span class="dv">3</span></span>
<span id="cb375-6965"><a href="#cb375-6965" aria-hidden="true" tabindex="-1"></a>CCAGGCAC<span class="op">-&gt;</span>CAAGGAAC:<span class="dv">2</span></span>
<span id="cb375-6966"><a href="#cb375-6966" aria-hidden="true" tabindex="-1"></a>CCAGGCAC<span class="op">-&gt;</span>TCGGCCAA:<span class="dv">4</span></span>
<span id="cb375-6967"><a href="#cb375-6967" aria-hidden="true" tabindex="-1"></a>CACAGGAT<span class="op">-&gt;</span>CAAGGAAC:<span class="dv">4</span></span>
<span id="cb375-6968"><a href="#cb375-6968" aria-hidden="true" tabindex="-1"></a>CAAGGAAC<span class="op">-&gt;</span>CACAGGAT:<span class="dv">4</span></span>
<span id="cb375-6969"><a href="#cb375-6969" aria-hidden="true" tabindex="-1"></a>CAAGGAAC<span class="op">-&gt;</span>TGAGTACC:<span class="dv">4</span></span>
<span id="cb375-6970"><a href="#cb375-6970" aria-hidden="true" tabindex="-1"></a>CAAGGAAC<span class="op">-&gt;</span>CCAGGCAC:<span class="dv">2</span></span>
<span id="cb375-6971"><a href="#cb375-6971" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-6972"><a href="#cb375-6972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6973"><a href="#cb375-6973" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-6974"><a href="#cb375-6974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6975"><a href="#cb375-6975" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-6976"><a href="#cb375-6976" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-6977"><a href="#cb375-6977" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple, TextIO</span>
<span id="cb375-6978"><a href="#cb375-6978" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb375-6979"><a href="#cb375-6979" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb375-6980"><a href="#cb375-6980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6981"><a href="#cb375-6981" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-6982"><a href="#cb375-6982" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="bu">list</span>(graph.keys())</span>
<span id="cb375-6983"><a href="#cb375-6983" aria-hidden="true" tabindex="-1"></a>    e <span class="op">=</span> [y <span class="cf">for</span> v <span class="kw">in</span> graph.values() <span class="cf">for</span> y <span class="kw">in</span> v]</span>
<span id="cb375-6984"><a href="#cb375-6984" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(s) <span class="op">|</span> <span class="bu">set</span>(e)</span>
<span id="cb375-6985"><a href="#cb375-6985" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6986"><a href="#cb375-6986" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaves(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-6987"><a href="#cb375-6987" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(y <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">list</span>(graph.values()) <span class="cf">for</span> y <span class="kw">in</span> v <span class="cf">if</span> <span class="kw">not</span> graph[y])</span>
<span id="cb375-6988"><a href="#cb375-6988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6989"><a href="#cb375-6989" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> root(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-6990"><a href="#cb375-6990" aria-hidden="true" tabindex="-1"></a>    rev <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb375-6991"><a href="#cb375-6991" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> <span class="bu">list</span>(nodes(graph))[<span class="dv">0</span>]</span>
<span id="cb375-6992"><a href="#cb375-6992" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="kw">in</span> rev:</span>
<span id="cb375-6993"><a href="#cb375-6993" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> rev[node]</span>
<span id="cb375-6994"><a href="#cb375-6994" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node</span>
<span id="cb375-6995"><a href="#cb375-6995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-6996"><a href="#cb375-6996" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-6997"><a href="#cb375-6997" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb375-6998"><a href="#cb375-6998" aria-hidden="true" tabindex="-1"></a>    target_nodes <span class="op">=</span> {target <span class="cf">for</span> targets <span class="kw">in</span> graph.values() <span class="cf">for</span> target <span class="kw">in</span> targets}</span>
<span id="cb375-6999"><a href="#cb375-6999" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> target_nodes</span>
<span id="cb375-7000"><a href="#cb375-7000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7001"><a href="#cb375-7001" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-7002"><a href="#cb375-7002" aria-hidden="true" tabindex="-1"></a>    reversed_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-7003"><a href="#cb375-7003" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parent, children <span class="kw">in</span> graph.items():</span>
<span id="cb375-7004"><a href="#cb375-7004" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> children:</span>
<span id="cb375-7005"><a href="#cb375-7005" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child] <span class="op">=</span> parent</span>
<span id="cb375-7006"><a href="#cb375-7006" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb375-7007"><a href="#cb375-7007" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7008"><a href="#cb375-7008" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_leaves(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-7009"><a href="#cb375-7009" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {child <span class="cf">for</span> children <span class="kw">in</span> graph.values() <span class="cf">for</span> child <span class="kw">in</span> children <span class="cf">if</span> <span class="kw">not</span> graph[child]}</span>
<span id="cb375-7010"><a href="#cb375-7010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7011"><a href="#cb375-7011" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_root(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-7012"><a href="#cb375-7012" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb375-7013"><a href="#cb375-7013" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(get_all_nodes(graph)))</span>
<span id="cb375-7014"><a href="#cb375-7014" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="kw">in</span> reversed_graph:</span>
<span id="cb375-7015"><a href="#cb375-7015" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> reversed_graph[node]</span>
<span id="cb375-7016"><a href="#cb375-7016" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node</span>
<span id="cb375-7017"><a href="#cb375-7017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7018"><a href="#cb375-7018" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_edges(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>], node: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7019"><a href="#cb375-7019" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb375-7020"><a href="#cb375-7020" aria-hidden="true" tabindex="-1"></a>        distance <span class="op">=</span> <span class="bu">sum</span>(a <span class="op">!=</span> b <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(sequences[node], sequences[child]))</span>
<span id="cb375-7021"><a href="#cb375-7021" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>sequences[node]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>sequences[child]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>distance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-7022"><a href="#cb375-7022" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>sequences[child]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>sequences[node]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>distance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-7023"><a href="#cb375-7023" aria-hidden="true" tabindex="-1"></a>        print_edges(graph, sequences, child)</span>
<span id="cb375-7024"><a href="#cb375-7024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7025"><a href="#cb375-7025" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> root_tree(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7026"><a href="#cb375-7026" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb375-7027"><a href="#cb375-7027" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">in</span> graph[child]:</span>
<span id="cb375-7028"><a href="#cb375-7028" aria-hidden="true" tabindex="-1"></a>            graph[child].remove(node)</span>
<span id="cb375-7029"><a href="#cb375-7029" aria-hidden="true" tabindex="-1"></a>        root_tree(graph, child)</span>
<span id="cb375-7030"><a href="#cb375-7030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7031"><a href="#cb375-7031" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: TextIO) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">int</span>, <span class="bu">str</span>], Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]:</span>
<span id="cb375-7032"><a href="#cb375-7032" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle))</span>
<span id="cb375-7033"><a href="#cb375-7033" aria-hidden="true" tabindex="-1"></a>    sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb375-7034"><a href="#cb375-7034" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-7035"><a href="#cb375-7035" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb375-7036"><a href="#cb375-7036" aria-hidden="true" tabindex="-1"></a>        <span class="bu">next</span>(handle)</span>
<span id="cb375-7037"><a href="#cb375-7037" aria-hidden="true" tabindex="-1"></a>        from_node, to_seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb375-7038"><a href="#cb375-7038" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(from_node)].append(i)</span>
<span id="cb375-7039"><a href="#cb375-7039" aria-hidden="true" tabindex="-1"></a>        sequences[i] <span class="op">=</span> to_seq</span>
<span id="cb375-7040"><a href="#cb375-7040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7041"><a href="#cb375-7041" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> handle.readlines()</span>
<span id="cb375-7042"><a href="#cb375-7042" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">0</span>].rstrip().split(<span class="st">"-&gt;"</span>)[<span class="dv">0</span>])</span>
<span id="cb375-7043"><a href="#cb375-7043" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> lines:</span>
<span id="cb375-7044"><a href="#cb375-7044" aria-hidden="true" tabindex="-1"></a>        from_node, to_node <span class="op">=</span> edge.rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb375-7045"><a href="#cb375-7045" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(from_node)].append(<span class="bu">int</span>(to_node))</span>
<span id="cb375-7046"><a href="#cb375-7046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7047"><a href="#cb375-7047" aria-hidden="true" tabindex="-1"></a>    root_tree(graph, root)</span>
<span id="cb375-7048"><a href="#cb375-7048" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequences, graph</span>
<span id="cb375-7049"><a href="#cb375-7049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7050"><a href="#cb375-7050" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_position(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>], pos: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb375-7051"><a href="#cb375-7051" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb375-7052"><a href="#cb375-7052" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> get_all_nodes(graph) <span class="op">-</span> get_leaves(graph):</span>
<span id="cb375-7053"><a href="#cb375-7053" aria-hidden="true" tabindex="-1"></a>        chars[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-7054"><a href="#cb375-7054" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> get_leaves(graph):</span>
<span id="cb375-7055"><a href="#cb375-7055" aria-hidden="true" tabindex="-1"></a>        chars[leaf] <span class="op">=</span> sequences[leaf][pos]</span>
<span id="cb375-7056"><a href="#cb375-7056" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb375-7057"><a href="#cb375-7057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7058"><a href="#cb375-7058" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6f(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb375-7059"><a href="#cb375-7059" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> get_all_nodes(graph) <span class="op">-</span> get_leaves(graph):</span>
<span id="cb375-7060"><a href="#cb375-7060" aria-hidden="true" tabindex="-1"></a>        sequences[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-7061"><a href="#cb375-7061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7062"><a href="#cb375-7062" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-7063"><a href="#cb375-7063" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pos <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="bu">next</span>(<span class="bu">iter</span>(sequences.values())))):</span>
<span id="cb375-7064"><a href="#cb375-7064" aria-hidden="true" tabindex="-1"></a>        chars <span class="op">=</span> extract_position(graph, sequences, pos)</span>
<span id="cb375-7065"><a href="#cb375-7065" aria-hidden="true" tabindex="-1"></a>        score, tbchars <span class="op">=</span> small_parsimony(graph, chars)</span>
<span id="cb375-7066"><a href="#cb375-7066" aria-hidden="true" tabindex="-1"></a>        total_score <span class="op">+=</span> score</span>
<span id="cb375-7067"><a href="#cb375-7067" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k, v <span class="kw">in</span> tbchars.items():</span>
<span id="cb375-7068"><a href="#cb375-7068" aria-hidden="true" tabindex="-1"></a>            sequences[k] <span class="op">+=</span> v</span>
<span id="cb375-7069"><a href="#cb375-7069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7070"><a href="#cb375-7070" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_score, sequences</span>
<span id="cb375-7071"><a href="#cb375-7071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7072"><a href="#cb375-7072" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> small_parsimony(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb375-7073"><a href="#cb375-7073" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb375-7074"><a href="#cb375-7074" aria-hidden="true" tabindex="-1"></a>    sk: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb375-7075"><a href="#cb375-7075" aria-hidden="true" tabindex="-1"></a>    skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]] <span class="op">=</span> {}</span>
<span id="cb375-7076"><a href="#cb375-7076" aria-hidden="true" tabindex="-1"></a>    to_process <span class="op">=</span> nodes(graph)</span>
<span id="cb375-7077"><a href="#cb375-7077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7078"><a href="#cb375-7078" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves(graph):</span>
<span id="cb375-7079"><a href="#cb375-7079" aria-hidden="true" tabindex="-1"></a>        sk[leaf] <span class="op">=</span> [<span class="dv">0</span> <span class="cf">if</span> chars[leaf] <span class="op">==</span> c <span class="cf">else</span> inf <span class="cf">for</span> c <span class="kw">in</span> bases]</span>
<span id="cb375-7080"><a href="#cb375-7080" aria-hidden="true" tabindex="-1"></a>        to_process.remove(leaf)</span>
<span id="cb375-7081"><a href="#cb375-7081" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7082"><a href="#cb375-7082" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> to_process:</span>
<span id="cb375-7083"><a href="#cb375-7083" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">list</span>(to_process):</span>
<span id="cb375-7084"><a href="#cb375-7084" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(v <span class="kw">in</span> sk <span class="cf">for</span> v <span class="kw">in</span> graph[n]):</span>
<span id="cb375-7085"><a href="#cb375-7085" aria-hidden="true" tabindex="-1"></a>                sk[n], skp[n] <span class="op">=</span> [], []</span>
<span id="cb375-7086"><a href="#cb375-7086" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> bases:</span>
<span id="cb375-7087"><a href="#cb375-7087" aria-hidden="true" tabindex="-1"></a>                    tot <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-7088"><a href="#cb375-7088" aria-hidden="true" tabindex="-1"></a>                    ptr: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-7089"><a href="#cb375-7089" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> d, sk_child <span class="kw">in</span> [(d, sk[d]) <span class="cf">for</span> d <span class="kw">in</span> graph[n]]:</span>
<span id="cb375-7090"><a href="#cb375-7090" aria-hidden="true" tabindex="-1"></a>                        score <span class="op">=</span> []</span>
<span id="cb375-7091"><a href="#cb375-7091" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(bases):</span>
<span id="cb375-7092"><a href="#cb375-7092" aria-hidden="true" tabindex="-1"></a>                            score <span class="op">+=</span> [sk_child[i] <span class="op">+</span> (<span class="dv">0</span> <span class="cf">if</span> c <span class="op">==</span> k <span class="cf">else</span> <span class="dv">1</span>)]</span>
<span id="cb375-7093"><a href="#cb375-7093" aria-hidden="true" tabindex="-1"></a>                        tot <span class="op">+=</span> <span class="bu">min</span>(score)</span>
<span id="cb375-7094"><a href="#cb375-7094" aria-hidden="true" tabindex="-1"></a>                        ptr[d] <span class="op">=</span> score.index(<span class="bu">min</span>(score))</span>
<span id="cb375-7095"><a href="#cb375-7095" aria-hidden="true" tabindex="-1"></a>                    skp[n] <span class="op">+=</span> [ptr]</span>
<span id="cb375-7096"><a href="#cb375-7096" aria-hidden="true" tabindex="-1"></a>                    sk[n] <span class="op">+=</span> [tot]</span>
<span id="cb375-7097"><a href="#cb375-7097" aria-hidden="true" tabindex="-1"></a>                to_process.remove(n)</span>
<span id="cb375-7098"><a href="#cb375-7098" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7099"><a href="#cb375-7099" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> root(graph)</span>
<span id="cb375-7100"><a href="#cb375-7100" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> <span class="bu">min</span>(sk[node])</span>
<span id="cb375-7101"><a href="#cb375-7101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score, traceback(skp, node, sk[node].index(score))</span>
<span id="cb375-7102"><a href="#cb375-7102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7103"><a href="#cb375-7103" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> traceback(skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]], node: <span class="bu">int</span>, ind: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb375-7104"><a href="#cb375-7104" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb375-7105"><a href="#cb375-7105" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb375-7106"><a href="#cb375-7106" aria-hidden="true" tabindex="-1"></a>    chars[node] <span class="op">=</span> bases[ind]</span>
<span id="cb375-7107"><a href="#cb375-7107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> skp[node][ind].items():</span>
<span id="cb375-7108"><a href="#cb375-7108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> k <span class="kw">in</span> skp:</span>
<span id="cb375-7109"><a href="#cb375-7109" aria-hidden="true" tabindex="-1"></a>            chars <span class="op">=</span> chars <span class="op">|</span> traceback(skp, k, v)</span>
<span id="cb375-7110"><a href="#cb375-7110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb375-7111"><a href="#cb375-7111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7112"><a href="#cb375-7112" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-7113"><a href="#cb375-7113" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb375-7114"><a href="#cb375-7114" aria-hidden="true" tabindex="-1"></a><span class="st">TCGGCCAA-&gt;4</span></span>
<span id="cb375-7115"><a href="#cb375-7115" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;TCGGCCAA</span></span>
<span id="cb375-7116"><a href="#cb375-7116" aria-hidden="true" tabindex="-1"></a><span class="st">CCTGGCTG-&gt;4</span></span>
<span id="cb375-7117"><a href="#cb375-7117" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;CCTGGCTG</span></span>
<span id="cb375-7118"><a href="#cb375-7118" aria-hidden="true" tabindex="-1"></a><span class="st">CACAGGAT-&gt;5</span></span>
<span id="cb375-7119"><a href="#cb375-7119" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;CACAGGAT</span></span>
<span id="cb375-7120"><a href="#cb375-7120" aria-hidden="true" tabindex="-1"></a><span class="st">TGAGTACC-&gt;5</span></span>
<span id="cb375-7121"><a href="#cb375-7121" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;TGAGTACC</span></span>
<span id="cb375-7122"><a href="#cb375-7122" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;5</span></span>
<span id="cb375-7123"><a href="#cb375-7123" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;4</span></span>
<span id="cb375-7124"><a href="#cb375-7124" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-7125"><a href="#cb375-7125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7126"><a href="#cb375-7126" aria-hidden="true" tabindex="-1"></a>sequences, graph <span class="op">=</span> parse_input(io.StringIO(sample_input.strip()))</span>
<span id="cb375-7127"><a href="#cb375-7127" aria-hidden="true" tabindex="-1"></a>total_score, sequences <span class="op">=</span> ba6f(graph, sequences)</span>
<span id="cb375-7128"><a href="#cb375-7128" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(total_score)</span>
<span id="cb375-7129"><a href="#cb375-7129" aria-hidden="true" tabindex="-1"></a>print_edges(graph, sequences, find_root(graph))</span>
<span id="cb375-7130"><a href="#cb375-7130" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7131"><a href="#cb375-7131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7132"><a href="#cb375-7132" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement FarthestFirstTraversal</span></span>
<span id="cb375-7133"><a href="#cb375-7133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7134"><a href="#cb375-7134" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>m<span class="op">*</span>&nbsp;followed by a <span class="bu">set</span> of points&nbsp;<span class="op">*</span>Data<span class="op">*</span>&nbsp;in&nbsp;<span class="op">*</span>m<span class="op">*-</span>dimensional space.</span>
<span id="cb375-7135"><a href="#cb375-7135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7136"><a href="#cb375-7136" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A set&nbsp;<span class="op">*</span>Centers<span class="op">*</span>&nbsp;consisting of&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;points (centers) resulting <span class="im">from</span> applying&nbsp;<span class="op">**</span>FarthestFirstTraversal<span class="op">**</span>(<span class="op">*</span>Data<span class="op">*</span>,&nbsp;<span class="op">*</span>k<span class="op">*</span>), where the first point from&nbsp;<span class="op">*</span>Data<span class="op">*</span>&nbsp;is chosen <span class="im">as</span> the first center to initialize the algorithm.</span>
<span id="cb375-7137"><a href="#cb375-7137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7138"><a href="#cb375-7138" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7139"><a href="#cb375-7139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7140"><a href="#cb375-7140" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7141"><a href="#cb375-7141" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">2</span></span>
<span id="cb375-7142"><a href="#cb375-7142" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0</span> <span class="fl">0.0</span></span>
<span id="cb375-7143"><a href="#cb375-7143" aria-hidden="true" tabindex="-1"></a><span class="fl">5.0</span> <span class="fl">5.0</span></span>
<span id="cb375-7144"><a href="#cb375-7144" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0</span> <span class="fl">5.0</span></span>
<span id="cb375-7145"><a href="#cb375-7145" aria-hidden="true" tabindex="-1"></a><span class="fl">1.0</span> <span class="fl">1.0</span></span>
<span id="cb375-7146"><a href="#cb375-7146" aria-hidden="true" tabindex="-1"></a><span class="fl">2.0</span> <span class="fl">2.0</span></span>
<span id="cb375-7147"><a href="#cb375-7147" aria-hidden="true" tabindex="-1"></a><span class="fl">3.0</span> <span class="fl">3.0</span></span>
<span id="cb375-7148"><a href="#cb375-7148" aria-hidden="true" tabindex="-1"></a><span class="fl">1.0</span> <span class="fl">2.0</span></span>
<span id="cb375-7149"><a href="#cb375-7149" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7150"><a href="#cb375-7150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7151"><a href="#cb375-7151" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7152"><a href="#cb375-7152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7153"><a href="#cb375-7153" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7154"><a href="#cb375-7154" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0</span> <span class="fl">0.0</span></span>
<span id="cb375-7155"><a href="#cb375-7155" aria-hidden="true" tabindex="-1"></a><span class="fl">5.0</span> <span class="fl">5.0</span></span>
<span id="cb375-7156"><a href="#cb375-7156" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0</span> <span class="fl">5.0</span></span>
<span id="cb375-7157"><a href="#cb375-7157" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7158"><a href="#cb375-7158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7159"><a href="#cb375-7159" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7160"><a href="#cb375-7160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7161"><a href="#cb375-7161" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7162"><a href="#cb375-7162" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb375-7163"><a href="#cb375-7163" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator, TextIO, TypeVar</span>
<span id="cb375-7164"><a href="#cb375-7164" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb375-7165"><a href="#cb375-7165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7166"><a href="#cb375-7166" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb375-7167"><a href="#cb375-7167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7168"><a href="#cb375-7168" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: TextIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb375-7169"><a href="#cb375-7169" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb375-7170"><a href="#cb375-7170" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb375-7171"><a href="#cb375-7171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7172"><a href="#cb375-7172" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: List[<span class="bu">float</span>], point_b: List[<span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb375-7173"><a href="#cb375-7173" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb375-7174"><a href="#cb375-7174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((coord_a <span class="op">-</span> coord_b) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> coord_a, coord_b <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb375-7175"><a href="#cb375-7175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7176"><a href="#cb375-7176" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_center_distance(data_point: List[<span class="bu">float</span>], center_points: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb375-7177"><a href="#cb375-7177" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Euclidean distance from DataPoint to its closest center"""</span></span>
<span id="cb375-7178"><a href="#cb375-7178" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(euclidean_distance(data_point, center) <span class="cf">for</span> center <span class="kw">in</span> center_points)</span>
<span id="cb375-7179"><a href="#cb375-7179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7180"><a href="#cb375-7180" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> farthest_first_traversal(data_points: List[List[<span class="bu">float</span>]], num_centers: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb375-7181"><a href="#cb375-7181" aria-hidden="true" tabindex="-1"></a>    center_points <span class="op">=</span> [data_points[<span class="dv">0</span>]]</span>
<span id="cb375-7182"><a href="#cb375-7182" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(center_points) <span class="op">&lt;</span> num_centers:</span>
<span id="cb375-7183"><a href="#cb375-7183" aria-hidden="true" tabindex="-1"></a>        distances <span class="op">=</span> [(i, nearest_center_distance(point, center_points)) <span class="cf">for</span> i, point <span class="kw">in</span> <span class="bu">enumerate</span>(data_points)]</span>
<span id="cb375-7184"><a href="#cb375-7184" aria-hidden="true" tabindex="-1"></a>        center_points.append(data_points[<span class="bu">max</span>(distances, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])[<span class="dv">0</span>]])</span>
<span id="cb375-7185"><a href="#cb375-7185" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> center_points</span>
<span id="cb375-7186"><a href="#cb375-7186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7187"><a href="#cb375-7187" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb375-7188"><a href="#cb375-7188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7189"><a href="#cb375-7189" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-7190"><a href="#cb375-7190" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb375-7191"><a href="#cb375-7191" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 0.0</span></span>
<span id="cb375-7192"><a href="#cb375-7192" aria-hidden="true" tabindex="-1"></a><span class="st">5.0 5.0</span></span>
<span id="cb375-7193"><a href="#cb375-7193" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 5.0</span></span>
<span id="cb375-7194"><a href="#cb375-7194" aria-hidden="true" tabindex="-1"></a><span class="st">1.0 1.0</span></span>
<span id="cb375-7195"><a href="#cb375-7195" aria-hidden="true" tabindex="-1"></a><span class="st">2.0 2.0</span></span>
<span id="cb375-7196"><a href="#cb375-7196" aria-hidden="true" tabindex="-1"></a><span class="st">3.0 3.0</span></span>
<span id="cb375-7197"><a href="#cb375-7197" aria-hidden="true" tabindex="-1"></a><span class="st">1.0 2.0</span></span>
<span id="cb375-7198"><a href="#cb375-7198" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-7199"><a href="#cb375-7199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7200"><a href="#cb375-7200" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb375-7201"><a href="#cb375-7201" aria-hidden="true" tabindex="-1"></a>num_centers, dimensions <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb375-7202"><a href="#cb375-7202" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [point <span class="cf">for</span> point <span class="kw">in</span> read_types(file_handle, <span class="bu">float</span>)]</span>
<span id="cb375-7203"><a href="#cb375-7203" aria-hidden="true" tabindex="-1"></a>center_points <span class="op">=</span> farthest_first_traversal(data_points, num_centers)</span>
<span id="cb375-7204"><a href="#cb375-7204" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center <span class="kw">in</span> center_points:</span>
<span id="cb375-7205"><a href="#cb375-7205" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>center)</span>
<span id="cb375-7206"><a href="#cb375-7206" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7207"><a href="#cb375-7207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7208"><a href="#cb375-7208" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Squared Error Distortion</span></span>
<span id="cb375-7209"><a href="#cb375-7209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7210"><a href="#cb375-7210" aria-hidden="true" tabindex="-1"></a>Squared Error Distortion Problem.</span>
<span id="cb375-7211"><a href="#cb375-7211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7212"><a href="#cb375-7212" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>m<span class="op">*</span>, followed by a <span class="bu">set</span> of centers&nbsp;<span class="op">*</span>Centers<span class="op">*</span>&nbsp;and a <span class="bu">set</span> of points&nbsp;<span class="op">*</span>Data<span class="op">*</span>.</span>
<span id="cb375-7213"><a href="#cb375-7213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7214"><a href="#cb375-7214" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The squared error distortion&nbsp;<span class="op">*</span>Distortion<span class="op">*</span>(<span class="op">*</span>Data<span class="op">*</span>,&nbsp;<span class="op">*</span>Centers<span class="op">*</span>).</span>
<span id="cb375-7215"><a href="#cb375-7215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7216"><a href="#cb375-7216" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7217"><a href="#cb375-7217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7218"><a href="#cb375-7218" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7219"><a href="#cb375-7219" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">2</span></span>
<span id="cb375-7220"><a href="#cb375-7220" aria-hidden="true" tabindex="-1"></a><span class="fl">2.31</span> <span class="fl">4.55</span></span>
<span id="cb375-7221"><a href="#cb375-7221" aria-hidden="true" tabindex="-1"></a><span class="fl">5.96</span> <span class="fl">9.08</span></span>
<span id="cb375-7222"><a href="#cb375-7222" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-7223"><a href="#cb375-7223" aria-hidden="true" tabindex="-1"></a><span class="fl">3.42</span> <span class="fl">6.03</span></span>
<span id="cb375-7224"><a href="#cb375-7224" aria-hidden="true" tabindex="-1"></a><span class="fl">6.23</span> <span class="fl">8.25</span></span>
<span id="cb375-7225"><a href="#cb375-7225" aria-hidden="true" tabindex="-1"></a><span class="fl">4.76</span> <span class="fl">1.64</span></span>
<span id="cb375-7226"><a href="#cb375-7226" aria-hidden="true" tabindex="-1"></a><span class="fl">4.47</span> <span class="fl">4.33</span></span>
<span id="cb375-7227"><a href="#cb375-7227" aria-hidden="true" tabindex="-1"></a><span class="fl">3.95</span> <span class="fl">7.61</span></span>
<span id="cb375-7228"><a href="#cb375-7228" aria-hidden="true" tabindex="-1"></a><span class="fl">8.93</span> <span class="fl">2.97</span></span>
<span id="cb375-7229"><a href="#cb375-7229" aria-hidden="true" tabindex="-1"></a><span class="fl">9.74</span> <span class="fl">4.03</span></span>
<span id="cb375-7230"><a href="#cb375-7230" aria-hidden="true" tabindex="-1"></a><span class="fl">1.73</span> <span class="fl">1.28</span></span>
<span id="cb375-7231"><a href="#cb375-7231" aria-hidden="true" tabindex="-1"></a><span class="fl">9.72</span> <span class="fl">5.01</span></span>
<span id="cb375-7232"><a href="#cb375-7232" aria-hidden="true" tabindex="-1"></a><span class="fl">7.27</span> <span class="fl">3.77</span></span>
<span id="cb375-7233"><a href="#cb375-7233" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7234"><a href="#cb375-7234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7235"><a href="#cb375-7235" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7236"><a href="#cb375-7236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7237"><a href="#cb375-7237" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7238"><a href="#cb375-7238" aria-hidden="true" tabindex="-1"></a><span class="fl">18.246</span></span>
<span id="cb375-7239"><a href="#cb375-7239" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7240"><a href="#cb375-7240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7241"><a href="#cb375-7241" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7242"><a href="#cb375-7242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7243"><a href="#cb375-7243" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7244"><a href="#cb375-7244" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb375-7245"><a href="#cb375-7245" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb375-7246"><a href="#cb375-7246" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator, TextIO, TypeVar</span>
<span id="cb375-7247"><a href="#cb375-7247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7248"><a href="#cb375-7248" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb375-7249"><a href="#cb375-7249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7250"><a href="#cb375-7250" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: TextIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb375-7251"><a href="#cb375-7251" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb375-7252"><a href="#cb375-7252" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb375-7253"><a href="#cb375-7253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7254"><a href="#cb375-7254" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: List[<span class="bu">float</span>], point_b: List[<span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb375-7255"><a href="#cb375-7255" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb375-7256"><a href="#cb375-7256" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((coord_a <span class="op">-</span> coord_b) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> coord_a, coord_b <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb375-7257"><a href="#cb375-7257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7258"><a href="#cb375-7258" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_center_distance(data_point: List[<span class="bu">float</span>], center_points: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb375-7259"><a href="#cb375-7259" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Euclidean distance from DataPoint to its closest center"""</span></span>
<span id="cb375-7260"><a href="#cb375-7260" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(euclidean_distance(data_point, center) <span class="cf">for</span> center <span class="kw">in</span> center_points)</span>
<span id="cb375-7261"><a href="#cb375-7261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7262"><a href="#cb375-7262" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_distortion(data_points: List[List[<span class="bu">float</span>]], center_points: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb375-7263"><a href="#cb375-7263" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span> <span class="op">/</span> <span class="bu">len</span>(data_points)) <span class="op">*</span> <span class="bu">sum</span>(nearest_center_distance(point, center_points) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> point <span class="kw">in</span> data_points)</span>
<span id="cb375-7264"><a href="#cb375-7264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7265"><a href="#cb375-7265" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-7266"><a href="#cb375-7266" aria-hidden="true" tabindex="-1"></a><span class="st">2 2</span></span>
<span id="cb375-7267"><a href="#cb375-7267" aria-hidden="true" tabindex="-1"></a><span class="st">2.31 4.55</span></span>
<span id="cb375-7268"><a href="#cb375-7268" aria-hidden="true" tabindex="-1"></a><span class="st">5.96 9.08</span></span>
<span id="cb375-7269"><a href="#cb375-7269" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-7270"><a href="#cb375-7270" aria-hidden="true" tabindex="-1"></a><span class="st">3.42 6.03</span></span>
<span id="cb375-7271"><a href="#cb375-7271" aria-hidden="true" tabindex="-1"></a><span class="st">6.23 8.25</span></span>
<span id="cb375-7272"><a href="#cb375-7272" aria-hidden="true" tabindex="-1"></a><span class="st">4.76 1.64</span></span>
<span id="cb375-7273"><a href="#cb375-7273" aria-hidden="true" tabindex="-1"></a><span class="st">4.47 4.33</span></span>
<span id="cb375-7274"><a href="#cb375-7274" aria-hidden="true" tabindex="-1"></a><span class="st">3.95 7.61</span></span>
<span id="cb375-7275"><a href="#cb375-7275" aria-hidden="true" tabindex="-1"></a><span class="st">8.93 2.97</span></span>
<span id="cb375-7276"><a href="#cb375-7276" aria-hidden="true" tabindex="-1"></a><span class="st">9.74 4.03</span></span>
<span id="cb375-7277"><a href="#cb375-7277" aria-hidden="true" tabindex="-1"></a><span class="st">1.73 1.28</span></span>
<span id="cb375-7278"><a href="#cb375-7278" aria-hidden="true" tabindex="-1"></a><span class="st">9.72 5.01</span></span>
<span id="cb375-7279"><a href="#cb375-7279" aria-hidden="true" tabindex="-1"></a><span class="st">7.27 3.77</span></span>
<span id="cb375-7280"><a href="#cb375-7280" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-7281"><a href="#cb375-7281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7282"><a href="#cb375-7282" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb375-7283"><a href="#cb375-7283" aria-hidden="true" tabindex="-1"></a>num_centers, _ <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb375-7284"><a href="#cb375-7284" aria-hidden="true" tabindex="-1"></a>data_generator <span class="op">=</span> read_types(file_handle, <span class="bu">float</span>)</span>
<span id="cb375-7285"><a href="#cb375-7285" aria-hidden="true" tabindex="-1"></a>center_points <span class="op">=</span> [<span class="bu">next</span>(data_generator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_centers)]</span>
<span id="cb375-7286"><a href="#cb375-7286" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> <span class="bu">next</span>(file_handle)</span>
<span id="cb375-7287"><a href="#cb375-7287" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [point <span class="cf">for</span> point <span class="kw">in</span> data_generator]</span>
<span id="cb375-7288"><a href="#cb375-7288" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">round</span>(calculate_distortion(data_points, center_points), <span class="dv">3</span>))</span>
<span id="cb375-7289"><a href="#cb375-7289" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7290"><a href="#cb375-7290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7291"><a href="#cb375-7291" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement the Lloyd Algorithm for k-Means Clustering</span></span>
<span id="cb375-7292"><a href="#cb375-7292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7293"><a href="#cb375-7293" aria-hidden="true" tabindex="-1"></a>Implement the Lloyd algorithm.</span>
<span id="cb375-7294"><a href="#cb375-7294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7295"><a href="#cb375-7295" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>m<span class="op">*</span>&nbsp;followed by a <span class="bu">set</span> of points&nbsp;<span class="op">*</span>Data<span class="op">*</span>&nbsp;in&nbsp;<span class="op">*</span>m<span class="op">*-</span>dimensional space.</span>
<span id="cb375-7296"><a href="#cb375-7296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7297"><a href="#cb375-7297" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A set&nbsp;<span class="op">*</span>Centers<span class="op">*</span>&nbsp;consisting of&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;points (centers) resulting <span class="im">from</span> applying the Lloyd algorithm to&nbsp;<span class="op">*</span>Data<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>Centers<span class="op">*</span>, where the first&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;points from&nbsp;<span class="op">*</span>Data<span class="op">*</span>&nbsp;are selected <span class="im">as</span> the first&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;centers.</span>
<span id="cb375-7298"><a href="#cb375-7298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7299"><a href="#cb375-7299" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7300"><a href="#cb375-7300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7301"><a href="#cb375-7301" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7302"><a href="#cb375-7302" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">2</span></span>
<span id="cb375-7303"><a href="#cb375-7303" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3</span> <span class="fl">1.1</span></span>
<span id="cb375-7304"><a href="#cb375-7304" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3</span> <span class="fl">0.2</span></span>
<span id="cb375-7305"><a href="#cb375-7305" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span> <span class="fl">2.8</span></span>
<span id="cb375-7306"><a href="#cb375-7306" aria-hidden="true" tabindex="-1"></a><span class="fl">3.0</span> <span class="fl">3.2</span></span>
<span id="cb375-7307"><a href="#cb375-7307" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">0.7</span></span>
<span id="cb375-7308"><a href="#cb375-7308" aria-hidden="true" tabindex="-1"></a><span class="fl">1.4</span> <span class="fl">1.6</span></span>
<span id="cb375-7309"><a href="#cb375-7309" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">1.0</span></span>
<span id="cb375-7310"><a href="#cb375-7310" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">1.1</span></span>
<span id="cb375-7311"><a href="#cb375-7311" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span> <span class="fl">1.5</span></span>
<span id="cb375-7312"><a href="#cb375-7312" aria-hidden="true" tabindex="-1"></a><span class="fl">1.8</span> <span class="fl">2.6</span></span>
<span id="cb375-7313"><a href="#cb375-7313" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">1.3</span></span>
<span id="cb375-7314"><a href="#cb375-7314" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">1.0</span></span>
<span id="cb375-7315"><a href="#cb375-7315" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0</span> <span class="fl">1.9</span></span>
<span id="cb375-7316"><a href="#cb375-7316" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7317"><a href="#cb375-7317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7318"><a href="#cb375-7318" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7319"><a href="#cb375-7319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7320"><a href="#cb375-7320" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7321"><a href="#cb375-7321" aria-hidden="true" tabindex="-1"></a><span class="fl">1.800</span> <span class="fl">2.867</span></span>
<span id="cb375-7322"><a href="#cb375-7322" aria-hidden="true" tabindex="-1"></a><span class="fl">1.060</span> <span class="fl">1.140</span></span>
<span id="cb375-7323"><a href="#cb375-7323" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7324"><a href="#cb375-7324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7325"><a href="#cb375-7325" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7326"><a href="#cb375-7326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7327"><a href="#cb375-7327" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7328"><a href="#cb375-7328" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-7329"><a href="#cb375-7329" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb375-7330"><a href="#cb375-7330" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb375-7331"><a href="#cb375-7331" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, TypeVar, Any</span>
<span id="cb375-7332"><a href="#cb375-7332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7333"><a href="#cb375-7333" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb375-7334"><a href="#cb375-7334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7335"><a href="#cb375-7335" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: io.StringIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb375-7336"><a href="#cb375-7336" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb375-7337"><a href="#cb375-7337" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb375-7338"><a href="#cb375-7338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7339"><a href="#cb375-7339" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: np.ndarray, point_b: np.ndarray) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb375-7340"><a href="#cb375-7340" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb375-7341"><a href="#cb375-7341" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((x <span class="op">-</span> y) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb375-7342"><a href="#cb375-7342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7343"><a href="#cb375-7343" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_center_assignment(data_point: np.ndarray, center_points: List[np.ndarray]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-7344"><a href="#cb375-7344" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Center index that minimises Euclidean distance to point"""</span></span>
<span id="cb375-7345"><a href="#cb375-7345" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [euclidean_distance(data_point, center) <span class="cf">for</span> center <span class="kw">in</span> center_points]</span>
<span id="cb375-7346"><a href="#cb375-7346" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances.index(<span class="bu">min</span>(distances))</span>
<span id="cb375-7347"><a href="#cb375-7347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7348"><a href="#cb375-7348" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_center(data_points: List[np.ndarray], assignments: List[<span class="bu">int</span>], center_index: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-7349"><a href="#cb375-7349" aria-hidden="true" tabindex="-1"></a>    cluster_points <span class="op">=</span> [p <span class="cf">for</span> p, a <span class="kw">in</span> <span class="bu">zip</span>(data_points, assignments) <span class="cf">if</span> a <span class="op">==</span> center_index]</span>
<span id="cb375-7350"><a href="#cb375-7350" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(np.array(cluster_points), axis<span class="op">=</span><span class="dv">0</span>) <span class="cf">if</span> cluster_points <span class="cf">else</span> np.zeros_like(data_points[<span class="dv">0</span>])</span>
<span id="cb375-7351"><a href="#cb375-7351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7352"><a href="#cb375-7352" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> k_means(data_points: List[np.ndarray], num_clusters: <span class="bu">int</span>, max_iterations: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>) <span class="op">-&gt;</span> List[np.ndarray]:</span>
<span id="cb375-7353"><a href="#cb375-7353" aria-hidden="true" tabindex="-1"></a>    center_points <span class="op">=</span> data_points[:num_clusters]</span>
<span id="cb375-7354"><a href="#cb375-7354" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iterations):</span>
<span id="cb375-7355"><a href="#cb375-7355" aria-hidden="true" tabindex="-1"></a>        assignments <span class="op">=</span> [nearest_center_assignment(point, center_points) <span class="cf">for</span> point <span class="kw">in</span> data_points]</span>
<span id="cb375-7356"><a href="#cb375-7356" aria-hidden="true" tabindex="-1"></a>        center_points <span class="op">=</span> [compute_center(data_points, assignments, i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_clusters)]</span>
<span id="cb375-7357"><a href="#cb375-7357" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> center_points</span>
<span id="cb375-7358"><a href="#cb375-7358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7359"><a href="#cb375-7359" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-7360"><a href="#cb375-7360" aria-hidden="true" tabindex="-1"></a><span class="st">2 2</span></span>
<span id="cb375-7361"><a href="#cb375-7361" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 1.1</span></span>
<span id="cb375-7362"><a href="#cb375-7362" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 0.2</span></span>
<span id="cb375-7363"><a href="#cb375-7363" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 2.8</span></span>
<span id="cb375-7364"><a href="#cb375-7364" aria-hidden="true" tabindex="-1"></a><span class="st">3.0 3.2</span></span>
<span id="cb375-7365"><a href="#cb375-7365" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 0.7</span></span>
<span id="cb375-7366"><a href="#cb375-7366" aria-hidden="true" tabindex="-1"></a><span class="st">1.4 1.6</span></span>
<span id="cb375-7367"><a href="#cb375-7367" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb375-7368"><a href="#cb375-7368" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.1</span></span>
<span id="cb375-7369"><a href="#cb375-7369" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 1.5</span></span>
<span id="cb375-7370"><a href="#cb375-7370" aria-hidden="true" tabindex="-1"></a><span class="st">1.8 2.6</span></span>
<span id="cb375-7371"><a href="#cb375-7371" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.3</span></span>
<span id="cb375-7372"><a href="#cb375-7372" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb375-7373"><a href="#cb375-7373" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 1.9</span></span>
<span id="cb375-7374"><a href="#cb375-7374" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-7375"><a href="#cb375-7375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7376"><a href="#cb375-7376" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb375-7377"><a href="#cb375-7377" aria-hidden="true" tabindex="-1"></a>num_clusters, dimensions <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb375-7378"><a href="#cb375-7378" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [np.array(point) <span class="cf">for</span> point <span class="kw">in</span> read_types(file_handle, <span class="bu">float</span>)]</span>
<span id="cb375-7379"><a href="#cb375-7379" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center <span class="kw">in</span> k_means(data_points, num_clusters):</span>
<span id="cb375-7380"><a href="#cb375-7380" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>[<span class="ss">f"</span><span class="sc">{</span>coord<span class="sc">:f}</span><span class="ss">"</span> <span class="cf">for</span> coord <span class="kw">in</span> center])</span>
<span id="cb375-7381"><a href="#cb375-7381" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7382"><a href="#cb375-7382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7383"><a href="#cb375-7383" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement the Soft k-Means Clustering Algorithm</span></span>
<span id="cb375-7384"><a href="#cb375-7384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7385"><a href="#cb375-7385" aria-hidden="true" tabindex="-1"></a>Implement the Soft k<span class="op">-</span>Means Clustering Algorithm.</span>
<span id="cb375-7386"><a href="#cb375-7386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7387"><a href="#cb375-7387" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Integers&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>m<span class="op">*</span>, followed by a stiffness parameter β, followed by a <span class="bu">set</span> of points&nbsp;<span class="op">*</span>Data<span class="op">*</span>&nbsp;in&nbsp;<span class="op">*</span>m<span class="op">*-</span>dimensional space.</span>
<span id="cb375-7388"><a href="#cb375-7388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7389"><a href="#cb375-7389" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A set&nbsp;<span class="op">*</span>Centers<span class="op">*</span>&nbsp;consisting of&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;points (centers) resulting <span class="im">from</span> applying the soft&nbsp;<span class="op">*</span>k<span class="op">*-</span>means clustering algorithm. Select the first&nbsp;<span class="op">*</span>k<span class="op">*</span>&nbsp;points from&nbsp;<span class="op">*</span>Data<span class="op">*</span>&nbsp;as the first centers <span class="cf">for</span> the algorithm <span class="kw">and</span> run the algorithm <span class="cf">for</span> <span class="dv">100</span> steps. Results should be accurate up to three decimal places.</span>
<span id="cb375-7390"><a href="#cb375-7390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7391"><a href="#cb375-7391" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7392"><a href="#cb375-7392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7393"><a href="#cb375-7393" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7394"><a href="#cb375-7394" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">2</span></span>
<span id="cb375-7395"><a href="#cb375-7395" aria-hidden="true" tabindex="-1"></a><span class="fl">2.7</span></span>
<span id="cb375-7396"><a href="#cb375-7396" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3</span> <span class="fl">1.1</span></span>
<span id="cb375-7397"><a href="#cb375-7397" aria-hidden="true" tabindex="-1"></a><span class="fl">1.3</span> <span class="fl">0.2</span></span>
<span id="cb375-7398"><a href="#cb375-7398" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span> <span class="fl">2.8</span></span>
<span id="cb375-7399"><a href="#cb375-7399" aria-hidden="true" tabindex="-1"></a><span class="fl">3.0</span> <span class="fl">3.2</span></span>
<span id="cb375-7400"><a href="#cb375-7400" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">0.7</span></span>
<span id="cb375-7401"><a href="#cb375-7401" aria-hidden="true" tabindex="-1"></a><span class="fl">1.4</span> <span class="fl">1.6</span></span>
<span id="cb375-7402"><a href="#cb375-7402" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">1.0</span></span>
<span id="cb375-7403"><a href="#cb375-7403" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">1.1</span></span>
<span id="cb375-7404"><a href="#cb375-7404" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6</span> <span class="fl">1.5</span></span>
<span id="cb375-7405"><a href="#cb375-7405" aria-hidden="true" tabindex="-1"></a><span class="fl">1.8</span> <span class="fl">2.6</span></span>
<span id="cb375-7406"><a href="#cb375-7406" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">1.3</span></span>
<span id="cb375-7407"><a href="#cb375-7407" aria-hidden="true" tabindex="-1"></a><span class="fl">1.2</span> <span class="fl">1.0</span></span>
<span id="cb375-7408"><a href="#cb375-7408" aria-hidden="true" tabindex="-1"></a><span class="fl">0.0</span> <span class="fl">1.9</span></span>
<span id="cb375-7409"><a href="#cb375-7409" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7410"><a href="#cb375-7410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7411"><a href="#cb375-7411" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7412"><a href="#cb375-7412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7413"><a href="#cb375-7413" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7414"><a href="#cb375-7414" aria-hidden="true" tabindex="-1"></a><span class="fl">1.662</span> <span class="fl">2.623</span></span>
<span id="cb375-7415"><a href="#cb375-7415" aria-hidden="true" tabindex="-1"></a><span class="fl">1.075</span> <span class="fl">1.148</span></span>
<span id="cb375-7416"><a href="#cb375-7416" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7417"><a href="#cb375-7417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7418"><a href="#cb375-7418" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7419"><a href="#cb375-7419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7420"><a href="#cb375-7420" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7421"><a href="#cb375-7421" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-7422"><a href="#cb375-7422" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb375-7423"><a href="#cb375-7423" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb375-7424"><a href="#cb375-7424" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, TypeVar, Any</span>
<span id="cb375-7425"><a href="#cb375-7425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7426"><a href="#cb375-7426" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb375-7427"><a href="#cb375-7427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7428"><a href="#cb375-7428" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: io.StringIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb375-7429"><a href="#cb375-7429" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb375-7430"><a href="#cb375-7430" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb375-7431"><a href="#cb375-7431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7432"><a href="#cb375-7432" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: np.ndarray, point_b: np.ndarray) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb375-7433"><a href="#cb375-7433" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb375-7434"><a href="#cb375-7434" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((x <span class="op">-</span> y) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb375-7435"><a href="#cb375-7435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7436"><a href="#cb375-7436" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partition_function(data_point: np.ndarray, center_points: np.ndarray, beta: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-7437"><a href="#cb375-7437" aria-hidden="true" tabindex="-1"></a>    numerator <span class="op">=</span> [np.exp(<span class="op">-</span>beta <span class="op">*</span> euclidean_distance(data_point, center)) <span class="cf">for</span> center <span class="kw">in</span> center_points]</span>
<span id="cb375-7438"><a href="#cb375-7438" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(numerator) <span class="op">/</span> <span class="bu">sum</span>(numerator)</span>
<span id="cb375-7439"><a href="#cb375-7439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7440"><a href="#cb375-7440" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hidden_matrix(data_points: np.ndarray, center_points: np.ndarray, beta: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-7441"><a href="#cb375-7441" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([partition_function(x, center_points, beta) <span class="cf">for</span> x <span class="kw">in</span> data_points])</span>
<span id="cb375-7442"><a href="#cb375-7442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7443"><a href="#cb375-7443" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_k_means(data_points: List[np.ndarray], num_clusters: <span class="bu">int</span>, beta: <span class="bu">float</span>, max_iterations: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-7444"><a href="#cb375-7444" aria-hidden="true" tabindex="-1"></a>    center_points <span class="op">=</span> np.array(data_points[:num_clusters])</span>
<span id="cb375-7445"><a href="#cb375-7445" aria-hidden="true" tabindex="-1"></a>    data_points <span class="op">=</span> np.array(data_points)</span>
<span id="cb375-7446"><a href="#cb375-7446" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iterations):</span>
<span id="cb375-7447"><a href="#cb375-7447" aria-hidden="true" tabindex="-1"></a>        h_matrix <span class="op">=</span> hidden_matrix(data_points, center_points, beta)</span>
<span id="cb375-7448"><a href="#cb375-7448" aria-hidden="true" tabindex="-1"></a>        center_points <span class="op">=</span> [np.dot(h_matrix[:, i], data_points) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_clusters)]</span>
<span id="cb375-7449"><a href="#cb375-7449" aria-hidden="true" tabindex="-1"></a>        sums <span class="op">=</span> np.<span class="bu">sum</span>(h_matrix, <span class="dv">0</span>)</span>
<span id="cb375-7450"><a href="#cb375-7450" aria-hidden="true" tabindex="-1"></a>        center_points <span class="op">=</span> np.transpose(np.transpose(center_points) <span class="op">/</span> sums)</span>
<span id="cb375-7451"><a href="#cb375-7451" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> center_points</span>
<span id="cb375-7452"><a href="#cb375-7452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7453"><a href="#cb375-7453" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-7454"><a href="#cb375-7454" aria-hidden="true" tabindex="-1"></a><span class="st">2 2</span></span>
<span id="cb375-7455"><a href="#cb375-7455" aria-hidden="true" tabindex="-1"></a><span class="st">2.7</span></span>
<span id="cb375-7456"><a href="#cb375-7456" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 1.1</span></span>
<span id="cb375-7457"><a href="#cb375-7457" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 0.2</span></span>
<span id="cb375-7458"><a href="#cb375-7458" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 2.8</span></span>
<span id="cb375-7459"><a href="#cb375-7459" aria-hidden="true" tabindex="-1"></a><span class="st">3.0 3.2</span></span>
<span id="cb375-7460"><a href="#cb375-7460" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 0.7</span></span>
<span id="cb375-7461"><a href="#cb375-7461" aria-hidden="true" tabindex="-1"></a><span class="st">1.4 1.6</span></span>
<span id="cb375-7462"><a href="#cb375-7462" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb375-7463"><a href="#cb375-7463" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.1</span></span>
<span id="cb375-7464"><a href="#cb375-7464" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 1.5</span></span>
<span id="cb375-7465"><a href="#cb375-7465" aria-hidden="true" tabindex="-1"></a><span class="st">1.8 2.6</span></span>
<span id="cb375-7466"><a href="#cb375-7466" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.3</span></span>
<span id="cb375-7467"><a href="#cb375-7467" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb375-7468"><a href="#cb375-7468" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 1.9</span></span>
<span id="cb375-7469"><a href="#cb375-7469" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-7470"><a href="#cb375-7470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7471"><a href="#cb375-7471" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb375-7472"><a href="#cb375-7472" aria-hidden="true" tabindex="-1"></a>num_clusters, dimensions <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb375-7473"><a href="#cb375-7473" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">float</span>))[<span class="dv">0</span>]</span>
<span id="cb375-7474"><a href="#cb375-7474" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [np.array(point) <span class="cf">for</span> point <span class="kw">in</span> read_types(file_handle, <span class="bu">float</span>)]</span>
<span id="cb375-7475"><a href="#cb375-7475" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center <span class="kw">in</span> soft_k_means(data_points, num_clusters, beta):</span>
<span id="cb375-7476"><a href="#cb375-7476" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>[<span class="ss">f"</span><span class="sc">{</span>coord<span class="sc">:f}</span><span class="ss">"</span> <span class="cf">for</span> coord <span class="kw">in</span> center])</span>
<span id="cb375-7477"><a href="#cb375-7477" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7478"><a href="#cb375-7478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7479"><a href="#cb375-7479" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement Hierarchical Clustering</span></span>
<span id="cb375-7480"><a href="#cb375-7480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7481"><a href="#cb375-7481" aria-hidden="true" tabindex="-1"></a>Implement Hierarchical Clustering.</span>
<span id="cb375-7482"><a href="#cb375-7482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7483"><a href="#cb375-7483" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An integer&nbsp;<span class="op">*</span>n<span class="op">*</span>, followed by an&nbsp;<span class="op">*</span>n_x_n<span class="op">*</span>&nbsp;distance matrix.</span>
<span id="cb375-7484"><a href="#cb375-7484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7485"><a href="#cb375-7485" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The result of applying&nbsp;<span class="op">**</span>HierarchicalClustering<span class="op">**</span>&nbsp;to this distance matrix (using&nbsp;<span class="op">*</span>D<span class="op">*</span>avg), <span class="cf">with</span> each newly created cluster listed on each line.</span>
<span id="cb375-7486"><a href="#cb375-7486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7487"><a href="#cb375-7487" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7488"><a href="#cb375-7488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7489"><a href="#cb375-7489" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7490"><a href="#cb375-7490" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span></span>
<span id="cb375-7491"><a href="#cb375-7491" aria-hidden="true" tabindex="-1"></a><span class="fl">0.00</span> <span class="fl">0.74</span> <span class="fl">0.85</span> <span class="fl">0.54</span> <span class="fl">0.83</span> <span class="fl">0.92</span> <span class="fl">0.89</span></span>
<span id="cb375-7492"><a href="#cb375-7492" aria-hidden="true" tabindex="-1"></a><span class="fl">0.74</span> <span class="fl">0.00</span> <span class="fl">1.59</span> <span class="fl">1.35</span> <span class="fl">1.20</span> <span class="fl">1.48</span> <span class="fl">1.55</span></span>
<span id="cb375-7493"><a href="#cb375-7493" aria-hidden="true" tabindex="-1"></a><span class="fl">0.85</span> <span class="fl">1.59</span> <span class="fl">0.00</span> <span class="fl">0.63</span> <span class="fl">1.13</span> <span class="fl">0.69</span> <span class="fl">0.73</span></span>
<span id="cb375-7494"><a href="#cb375-7494" aria-hidden="true" tabindex="-1"></a><span class="fl">0.54</span> <span class="fl">1.35</span> <span class="fl">0.63</span> <span class="fl">0.00</span> <span class="fl">0.66</span> <span class="fl">0.43</span> <span class="fl">0.88</span></span>
<span id="cb375-7495"><a href="#cb375-7495" aria-hidden="true" tabindex="-1"></a><span class="fl">0.83</span> <span class="fl">1.20</span> <span class="fl">1.13</span> <span class="fl">0.66</span> <span class="fl">0.00</span> <span class="fl">0.72</span> <span class="fl">0.55</span></span>
<span id="cb375-7496"><a href="#cb375-7496" aria-hidden="true" tabindex="-1"></a><span class="fl">0.92</span> <span class="fl">1.48</span> <span class="fl">0.69</span> <span class="fl">0.43</span> <span class="fl">0.72</span> <span class="fl">0.00</span> <span class="fl">0.80</span></span>
<span id="cb375-7497"><a href="#cb375-7497" aria-hidden="true" tabindex="-1"></a><span class="fl">0.89</span> <span class="fl">1.55</span> <span class="fl">0.73</span> <span class="fl">0.88</span> <span class="fl">0.55</span> <span class="fl">0.80</span> <span class="fl">0.00</span></span>
<span id="cb375-7498"><a href="#cb375-7498" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7499"><a href="#cb375-7499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7500"><a href="#cb375-7500" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7501"><a href="#cb375-7501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7502"><a href="#cb375-7502" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7503"><a href="#cb375-7503" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="dv">6</span></span>
<span id="cb375-7504"><a href="#cb375-7504" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">7</span></span>
<span id="cb375-7505"><a href="#cb375-7505" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="dv">4</span> <span class="dv">6</span></span>
<span id="cb375-7506"><a href="#cb375-7506" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">2</span></span>
<span id="cb375-7507"><a href="#cb375-7507" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">6</span></span>
<span id="cb375-7508"><a href="#cb375-7508" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">6</span></span>
<span id="cb375-7509"><a href="#cb375-7509" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7510"><a href="#cb375-7510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7511"><a href="#cb375-7511" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7512"><a href="#cb375-7512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7513"><a href="#cb375-7513" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7514"><a href="#cb375-7514" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-7515"><a href="#cb375-7515" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-7516"><a href="#cb375-7516" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb375-7517"><a href="#cb375-7517" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Generator</span>
<span id="cb375-7518"><a href="#cb375-7518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7519"><a href="#cb375-7519" aria-hidden="true" tabindex="-1"></a><span class="co"># find (first) minimum off diagonal index in an array</span></span>
<span id="cb375-7520"><a href="#cb375-7520" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_closest_pair(distance_matrix: np.ndarray) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-7521"><a href="#cb375-7521" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb375-7522"><a href="#cb375-7522" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(temp_matrix, temp_matrix.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-7523"><a href="#cb375-7523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">divmod</span>(temp_matrix.argmin(), temp_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb375-7524"><a href="#cb375-7524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7525"><a href="#cb375-7525" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> average_distances(distance_matrix: np.ndarray, i: <span class="bu">int</span>, j: <span class="bu">int</span>, size_i: <span class="bu">int</span>, size_j: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-7526"><a href="#cb375-7526" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb375-7527"><a href="#cb375-7527" aria-hidden="true" tabindex="-1"></a>    average <span class="op">=</span> (temp_matrix[i, :] <span class="op">*</span> size_i <span class="op">+</span> temp_matrix[j, :] <span class="op">*</span> size_j) <span class="op">/</span> (size_i <span class="op">+</span> size_j)</span>
<span id="cb375-7528"><a href="#cb375-7528" aria-hidden="true" tabindex="-1"></a>    temp_matrix[i, :] <span class="op">=</span> average</span>
<span id="cb375-7529"><a href="#cb375-7529" aria-hidden="true" tabindex="-1"></a>    temp_matrix[:, i] <span class="op">=</span> average</span>
<span id="cb375-7530"><a href="#cb375-7530" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.delete(temp_matrix, j, <span class="dv">0</span>)</span>
<span id="cb375-7531"><a href="#cb375-7531" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.delete(temp_matrix, j, <span class="dv">1</span>)</span>
<span id="cb375-7532"><a href="#cb375-7532" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(temp_matrix, <span class="dv">0</span>)</span>
<span id="cb375-7533"><a href="#cb375-7533" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> temp_matrix</span>
<span id="cb375-7534"><a href="#cb375-7534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7535"><a href="#cb375-7535" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_descendants(tree: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-7536"><a href="#cb375-7536" aria-hidden="true" tabindex="-1"></a>    queue <span class="op">=</span> [node]</span>
<span id="cb375-7537"><a href="#cb375-7537" aria-hidden="true" tabindex="-1"></a>    descendants <span class="op">=</span> []</span>
<span id="cb375-7538"><a href="#cb375-7538" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb375-7539"><a href="#cb375-7539" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb375-7540"><a href="#cb375-7540" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_node <span class="kw">in</span> tree:</span>
<span id="cb375-7541"><a href="#cb375-7541" aria-hidden="true" tabindex="-1"></a>            queue.extend(tree[current_node])</span>
<span id="cb375-7542"><a href="#cb375-7542" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-7543"><a href="#cb375-7543" aria-hidden="true" tabindex="-1"></a>            descendants.append(current_node)</span>
<span id="cb375-7544"><a href="#cb375-7544" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> descendants</span>
<span id="cb375-7545"><a href="#cb375-7545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7546"><a href="#cb375-7546" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hierarchical_clustering(distance_matrix: np.ndarray, num_elements: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[List[<span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-7547"><a href="#cb375-7547" aria-hidden="true" tabindex="-1"></a>    clusters <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, num_elements <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb375-7548"><a href="#cb375-7548" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb375-7549"><a href="#cb375-7549" aria-hidden="true" tabindex="-1"></a>    cluster_size <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="dv">1</span>)  <span class="co"># the number of descendants of a node</span></span>
<span id="cb375-7550"><a href="#cb375-7550" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> num_elements</span>
<span id="cb375-7551"><a href="#cb375-7551" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(clusters) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb375-7552"><a href="#cb375-7552" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-7553"><a href="#cb375-7553" aria-hidden="true" tabindex="-1"></a>        i, j <span class="op">=</span> find_closest_pair(distance_matrix)</span>
<span id="cb375-7554"><a href="#cb375-7554" aria-hidden="true" tabindex="-1"></a>        cluster_a, cluster_b <span class="op">=</span> clusters[i], clusters[j]</span>
<span id="cb375-7555"><a href="#cb375-7555" aria-hidden="true" tabindex="-1"></a>        tree[next_node] <span class="op">=</span> [cluster_a, cluster_b]</span>
<span id="cb375-7556"><a href="#cb375-7556" aria-hidden="true" tabindex="-1"></a>        cluster_size[next_node] <span class="op">=</span> cluster_size[cluster_a] <span class="op">+</span> cluster_size[cluster_b]</span>
<span id="cb375-7557"><a href="#cb375-7557" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> average_distances(distance_matrix, <span class="op">*</span>find_closest_pair(distance_matrix), cluster_size[cluster_a], cluster_size[cluster_b])</span>
<span id="cb375-7558"><a href="#cb375-7558" aria-hidden="true" tabindex="-1"></a>        clusters[i] <span class="op">=</span> next_node</span>
<span id="cb375-7559"><a href="#cb375-7559" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> clusters[j]</span>
<span id="cb375-7560"><a href="#cb375-7560" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> get_descendants(tree, cluster_a) <span class="op">+</span> get_descendants(tree, cluster_b)</span>
<span id="cb375-7561"><a href="#cb375-7561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7562"><a href="#cb375-7562" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-7563"><a href="#cb375-7563" aria-hidden="true" tabindex="-1"></a><span class="st">7</span></span>
<span id="cb375-7564"><a href="#cb375-7564" aria-hidden="true" tabindex="-1"></a><span class="st">0.00 0.74 0.85 0.54 0.83 0.92 0.89</span></span>
<span id="cb375-7565"><a href="#cb375-7565" aria-hidden="true" tabindex="-1"></a><span class="st">0.74 0.00 1.59 1.35 1.20 1.48 1.55</span></span>
<span id="cb375-7566"><a href="#cb375-7566" aria-hidden="true" tabindex="-1"></a><span class="st">0.85 1.59 0.00 0.63 1.13 0.69 0.73</span></span>
<span id="cb375-7567"><a href="#cb375-7567" aria-hidden="true" tabindex="-1"></a><span class="st">0.54 1.35 0.63 0.00 0.66 0.43 0.88</span></span>
<span id="cb375-7568"><a href="#cb375-7568" aria-hidden="true" tabindex="-1"></a><span class="st">0.83 1.20 1.13 0.66 0.00 0.72 0.55</span></span>
<span id="cb375-7569"><a href="#cb375-7569" aria-hidden="true" tabindex="-1"></a><span class="st">0.92 1.48 0.69 0.43 0.72 0.00 0.80</span></span>
<span id="cb375-7570"><a href="#cb375-7570" aria-hidden="true" tabindex="-1"></a><span class="st">0.89 1.55 0.73 0.88 0.55 0.80 0.00</span></span>
<span id="cb375-7571"><a href="#cb375-7571" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-7572"><a href="#cb375-7572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7573"><a href="#cb375-7573" aria-hidden="true" tabindex="-1"></a>num_elements, <span class="op">*</span>distance_data <span class="op">=</span> io.StringIO(sample_input.strip()).read().splitlines()</span>
<span id="cb375-7574"><a href="#cb375-7574" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> np.array([<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> distance_data])</span>
<span id="cb375-7575"><a href="#cb375-7575" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> step <span class="kw">in</span> hierarchical_clustering(distance_matrix, <span class="bu">int</span>(num_elements)):</span>
<span id="cb375-7576"><a href="#cb375-7576" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>step)</span>
<span id="cb375-7577"><a href="#cb375-7577" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7578"><a href="#cb375-7578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7579"><a href="#cb375-7579" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a Trie from a Collection of Patterns</span></span>
<span id="cb375-7580"><a href="#cb375-7580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7581"><a href="#cb375-7581" aria-hidden="true" tabindex="-1"></a>Trie Construction Problem. Construct a trie on a collection of patterns.</span>
<span id="cb375-7582"><a href="#cb375-7582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7583"><a href="#cb375-7583" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A collection of strings&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb375-7584"><a href="#cb375-7584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7585"><a href="#cb375-7585" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>)&nbsp;corresponding to&nbsp;<span class="op">*</span>Trie<span class="op">*</span>(<span class="op">*</span>Patterns<span class="op">*</span>), <span class="kw">in</span> the following <span class="bu">format</span>. If&nbsp;<span class="op">*</span>Trie<span class="op">*</span>(<span class="op">*</span>Patterns<span class="op">*</span>) has&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;nodes, first label the root <span class="cf">with</span> <span class="dv">1</span> <span class="kw">and</span> then label the remaining nodes <span class="cf">with</span> the integers <span class="dv">2</span> through&nbsp;<span class="op">*</span>n<span class="op">*</span>&nbsp;in <span class="bu">any</span> order you like. Each edge of the adjacency <span class="bu">list</span> of&nbsp;<span class="op">*</span>Trie<span class="op">*</span>(<span class="op">*</span>Patterns<span class="op">*</span>) will be encoded by a triple: the first two members of the triple must be the integers labeling the initial <span class="kw">and</span> terminal nodes of the edge, respectively<span class="op">;</span> the third member of the triple must be the symbol labeling the edge.</span>
<span id="cb375-7586"><a href="#cb375-7586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7587"><a href="#cb375-7587" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7588"><a href="#cb375-7588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7589"><a href="#cb375-7589" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7590"><a href="#cb375-7590" aria-hidden="true" tabindex="-1"></a>ATAGA</span>
<span id="cb375-7591"><a href="#cb375-7591" aria-hidden="true" tabindex="-1"></a>ATC</span>
<span id="cb375-7592"><a href="#cb375-7592" aria-hidden="true" tabindex="-1"></a>GAT</span>
<span id="cb375-7593"><a href="#cb375-7593" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7594"><a href="#cb375-7594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7595"><a href="#cb375-7595" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7596"><a href="#cb375-7596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7597"><a href="#cb375-7597" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7598"><a href="#cb375-7598" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">1</span>:A</span>
<span id="cb375-7599"><a href="#cb375-7599" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="op">-&gt;</span><span class="dv">2</span>:T</span>
<span id="cb375-7600"><a href="#cb375-7600" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">3</span>:A</span>
<span id="cb375-7601"><a href="#cb375-7601" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span><span class="op">-&gt;</span><span class="dv">4</span>:G</span>
<span id="cb375-7602"><a href="#cb375-7602" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span><span class="op">-&gt;</span><span class="dv">5</span>:A</span>
<span id="cb375-7603"><a href="#cb375-7603" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span><span class="op">-&gt;</span><span class="dv">6</span>:C</span>
<span id="cb375-7604"><a href="#cb375-7604" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">7</span>:G</span>
<span id="cb375-7605"><a href="#cb375-7605" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span><span class="op">-&gt;</span><span class="dv">8</span>:A</span>
<span id="cb375-7606"><a href="#cb375-7606" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span><span class="op">-&gt;</span><span class="dv">9</span>:T</span>
<span id="cb375-7607"><a href="#cb375-7607" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7608"><a href="#cb375-7608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7609"><a href="#cb375-7609" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7610"><a href="#cb375-7610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7611"><a href="#cb375-7611" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7612"><a href="#cb375-7612" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> count</span>
<span id="cb375-7613"><a href="#cb375-7613" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Any</span>
<span id="cb375-7614"><a href="#cb375-7614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7615"><a href="#cb375-7615" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Trie:</span>
<span id="cb375-7616"><a href="#cb375-7616" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7617"><a href="#cb375-7617" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.id_generator <span class="op">=</span> count(start<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb375-7618"><a href="#cb375-7618" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.root: Tuple[<span class="bu">int</span>, Dict[<span class="bu">str</span>, Any]] <span class="op">=</span> (<span class="bu">next</span>(<span class="va">self</span>.id_generator), {})</span>
<span id="cb375-7619"><a href="#cb375-7619" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-7620"><a href="#cb375-7620" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> insert(<span class="va">self</span>, sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7621"><a href="#cb375-7621" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> <span class="va">self</span>.root</span>
<span id="cb375-7622"><a href="#cb375-7622" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> character <span class="kw">in</span> sequence:</span>
<span id="cb375-7623"><a href="#cb375-7623" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> character <span class="kw">not</span> <span class="kw">in</span> current_node[<span class="dv">1</span>]:</span>
<span id="cb375-7624"><a href="#cb375-7624" aria-hidden="true" tabindex="-1"></a>                current_node[<span class="dv">1</span>][character] <span class="op">=</span> (<span class="bu">next</span>(<span class="va">self</span>.id_generator), {})</span>
<span id="cb375-7625"><a href="#cb375-7625" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> current_node[<span class="dv">1</span>][character]</span>
<span id="cb375-7626"><a href="#cb375-7626" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb375-7627"><a href="#cb375-7627" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_trie(sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb375-7628"><a href="#cb375-7628" aria-hidden="true" tabindex="-1"></a>    trie <span class="op">=</span> Trie()</span>
<span id="cb375-7629"><a href="#cb375-7629" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> sequences:</span>
<span id="cb375-7630"><a href="#cb375-7630" aria-hidden="true" tabindex="-1"></a>        trie.insert(sequence)</span>
<span id="cb375-7631"><a href="#cb375-7631" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> trie.root</span>
<span id="cb375-7632"><a href="#cb375-7632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7633"><a href="#cb375-7633" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_trie(node: Tuple[<span class="bu">int</span>, Dict[<span class="bu">str</span>, Any]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-7634"><a href="#cb375-7634" aria-hidden="true" tabindex="-1"></a>    formatted_output: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb375-7635"><a href="#cb375-7635" aria-hidden="true" tabindex="-1"></a>    node_id, children <span class="op">=</span> node</span>
<span id="cb375-7636"><a href="#cb375-7636" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char, child_node <span class="kw">in</span> children.items():</span>
<span id="cb375-7637"><a href="#cb375-7637" aria-hidden="true" tabindex="-1"></a>        child_id, _ <span class="op">=</span> child_node</span>
<span id="cb375-7638"><a href="#cb375-7638" aria-hidden="true" tabindex="-1"></a>        formatted_output.append(<span class="ss">f"</span><span class="sc">{</span>node_id<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>child_id<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>char<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-7639"><a href="#cb375-7639" aria-hidden="true" tabindex="-1"></a>        formatted_output.extend(format_trie(child_node))</span>
<span id="cb375-7640"><a href="#cb375-7640" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> formatted_output</span>
<span id="cb375-7641"><a href="#cb375-7641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7642"><a href="#cb375-7642" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-7643"><a href="#cb375-7643" aria-hidden="true" tabindex="-1"></a><span class="st">ATAGA</span></span>
<span id="cb375-7644"><a href="#cb375-7644" aria-hidden="true" tabindex="-1"></a><span class="st">ATC</span></span>
<span id="cb375-7645"><a href="#cb375-7645" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb375-7646"><a href="#cb375-7646" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-7647"><a href="#cb375-7647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7648"><a href="#cb375-7648" aria-hidden="true" tabindex="-1"></a>sequences: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-7649"><a href="#cb375-7649" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7650"><a href="#cb375-7650" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> format_trie(build_trie(sequences)):</span>
<span id="cb375-7651"><a href="#cb375-7651" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span>
<span id="cb375-7652"><a href="#cb375-7652" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7653"><a href="#cb375-7653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7654"><a href="#cb375-7654" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement TrieMatching</span></span>
<span id="cb375-7655"><a href="#cb375-7655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7656"><a href="#cb375-7656" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;and a collection of strings&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb375-7657"><a href="#cb375-7657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7658"><a href="#cb375-7658" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All starting positions in&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;where a string from&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>&nbsp;appears <span class="im">as</span> a substring.</span>
<span id="cb375-7659"><a href="#cb375-7659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7660"><a href="#cb375-7660" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7661"><a href="#cb375-7661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7662"><a href="#cb375-7662" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7663"><a href="#cb375-7663" aria-hidden="true" tabindex="-1"></a>AATCGGGTTCAATCGGGGT</span>
<span id="cb375-7664"><a href="#cb375-7664" aria-hidden="true" tabindex="-1"></a>ATCG</span>
<span id="cb375-7665"><a href="#cb375-7665" aria-hidden="true" tabindex="-1"></a>GGGT</span>
<span id="cb375-7666"><a href="#cb375-7666" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7667"><a href="#cb375-7667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7668"><a href="#cb375-7668" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7669"><a href="#cb375-7669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7670"><a href="#cb375-7670" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7671"><a href="#cb375-7671" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">4</span> <span class="dv">11</span> <span class="dv">15</span></span>
<span id="cb375-7672"><a href="#cb375-7672" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7673"><a href="#cb375-7673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7674"><a href="#cb375-7674" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7675"><a href="#cb375-7675" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7676"><a href="#cb375-7676" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7677"><a href="#cb375-7677" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-7678"><a href="#cb375-7678" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, DefaultDict, Set</span>
<span id="cb375-7679"><a href="#cb375-7679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7680"><a href="#cb375-7680" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-7681"><a href="#cb375-7681" aria-hidden="true" tabindex="-1"></a><span class="st">AATCGGGTTCAATCGGGGT</span></span>
<span id="cb375-7682"><a href="#cb375-7682" aria-hidden="true" tabindex="-1"></a><span class="st">ATCG</span></span>
<span id="cb375-7683"><a href="#cb375-7683" aria-hidden="true" tabindex="-1"></a><span class="st">GGGT</span></span>
<span id="cb375-7684"><a href="#cb375-7684" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-7685"><a href="#cb375-7685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7686"><a href="#cb375-7686" aria-hidden="true" tabindex="-1"></a>sequences: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-7687"><a href="#cb375-7687" aria-hidden="true" tabindex="-1"></a>main_sequence: <span class="bu">str</span> <span class="op">=</span> sequences[<span class="dv">0</span>]</span>
<span id="cb375-7688"><a href="#cb375-7688" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sequences[<span class="dv">1</span>:]</span>
<span id="cb375-7689"><a href="#cb375-7689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7690"><a href="#cb375-7690" aria-hidden="true" tabindex="-1"></a>kmer_positions: DefaultDict[<span class="bu">str</span>, Set[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">set</span>)</span>
<span id="cb375-7691"><a href="#cb375-7691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7692"><a href="#cb375-7692" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(kmers[<span class="dv">0</span>])</span>
<span id="cb375-7693"><a href="#cb375-7693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7694"><a href="#cb375-7694" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(main_sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-7695"><a href="#cb375-7695" aria-hidden="true" tabindex="-1"></a>    current_kmer: <span class="bu">str</span> <span class="op">=</span> main_sequence[start_index:start_index <span class="op">+</span> kmer_length]</span>
<span id="cb375-7696"><a href="#cb375-7696" aria-hidden="true" tabindex="-1"></a>    kmer_positions[current_kmer].add(start_index)</span>
<span id="cb375-7697"><a href="#cb375-7697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7698"><a href="#cb375-7698" aria-hidden="true" tabindex="-1"></a>all_positions: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-7699"><a href="#cb375-7699" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb375-7700"><a href="#cb375-7700" aria-hidden="true" tabindex="-1"></a>    all_positions.update(kmer_positions[kmer])</span>
<span id="cb375-7701"><a href="#cb375-7701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7702"><a href="#cb375-7702" aria-hidden="true" tabindex="-1"></a>sorted_positions: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(all_positions)</span>
<span id="cb375-7703"><a href="#cb375-7703" aria-hidden="true" tabindex="-1"></a>output: <span class="bu">str</span> <span class="op">=</span> <span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, sorted_positions))</span>
<span id="cb375-7704"><a href="#cb375-7704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7705"><a href="#cb375-7705" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(output)</span>
<span id="cb375-7706"><a href="#cb375-7706" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7707"><a href="#cb375-7707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7708"><a href="#cb375-7708" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Suffix Tree of a String</span></span>
<span id="cb375-7709"><a href="#cb375-7709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7710"><a href="#cb375-7710" aria-hidden="true" tabindex="-1"></a>Suffix Tree Construction Problem. Construct the suffix tree of a string.</span>
<span id="cb375-7711"><a href="#cb375-7711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7712"><a href="#cb375-7712" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb375-7713"><a href="#cb375-7713" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7714"><a href="#cb375-7714" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The strings labeling the edges of&nbsp;<span class="op">*</span>SuffixTree<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>). (You may <span class="cf">return</span> these strings <span class="kw">in</span> <span class="bu">any</span> order.)</span>
<span id="cb375-7715"><a href="#cb375-7715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7716"><a href="#cb375-7716" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7717"><a href="#cb375-7717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7718"><a href="#cb375-7718" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7719"><a href="#cb375-7719" aria-hidden="true" tabindex="-1"></a>ATAAATG$</span>
<span id="cb375-7720"><a href="#cb375-7720" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7721"><a href="#cb375-7721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7722"><a href="#cb375-7722" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7723"><a href="#cb375-7723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7724"><a href="#cb375-7724" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7725"><a href="#cb375-7725" aria-hidden="true" tabindex="-1"></a>AAATG$</span>
<span id="cb375-7726"><a href="#cb375-7726" aria-hidden="true" tabindex="-1"></a>G$</span>
<span id="cb375-7727"><a href="#cb375-7727" aria-hidden="true" tabindex="-1"></a>T</span>
<span id="cb375-7728"><a href="#cb375-7728" aria-hidden="true" tabindex="-1"></a>ATG$</span>
<span id="cb375-7729"><a href="#cb375-7729" aria-hidden="true" tabindex="-1"></a>TG$</span>
<span id="cb375-7730"><a href="#cb375-7730" aria-hidden="true" tabindex="-1"></a>A</span>
<span id="cb375-7731"><a href="#cb375-7731" aria-hidden="true" tabindex="-1"></a>A</span>
<span id="cb375-7732"><a href="#cb375-7732" aria-hidden="true" tabindex="-1"></a>AAATG$</span>
<span id="cb375-7733"><a href="#cb375-7733" aria-hidden="true" tabindex="-1"></a>G$</span>
<span id="cb375-7734"><a href="#cb375-7734" aria-hidden="true" tabindex="-1"></a>T</span>
<span id="cb375-7735"><a href="#cb375-7735" aria-hidden="true" tabindex="-1"></a>G$</span>
<span id="cb375-7736"><a href="#cb375-7736" aria-hidden="true" tabindex="-1"></a>$</span>
<span id="cb375-7737"><a href="#cb375-7737" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7738"><a href="#cb375-7738" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7739"><a href="#cb375-7739" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7740"><a href="#cb375-7740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7741"><a href="#cb375-7741" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7742"><a href="#cb375-7742" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Optional</span>
<span id="cb375-7743"><a href="#cb375-7743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7744"><a href="#cb375-7744" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Tree:</span>
<span id="cb375-7745"><a href="#cb375-7745" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Node:</span>
<span id="cb375-7746"><a href="#cb375-7746" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7747"><a href="#cb375-7747" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.label: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7748"><a href="#cb375-7748" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.edges: List[<span class="st">'Tree.Edge'</span>] <span class="op">=</span> []</span>
<span id="cb375-7749"><a href="#cb375-7749" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.indicator: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7750"><a href="#cb375-7750" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.depth: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-7751"><a href="#cb375-7751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7752"><a href="#cb375-7752" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Edge:</span>
<span id="cb375-7753"><a href="#cb375-7753" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7754"><a href="#cb375-7754" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.from_node: Optional[<span class="st">'Tree.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7755"><a href="#cb375-7755" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.target_node: Optional[<span class="st">'Tree.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7756"><a href="#cb375-7756" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.position: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7757"><a href="#cb375-7757" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.length: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7758"><a href="#cb375-7758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7759"><a href="#cb375-7759" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7760"><a href="#cb375-7760" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes: List[Tree.Node] <span class="op">=</span> []</span>
<span id="cb375-7761"><a href="#cb375-7761" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges: List[Tree.Edge] <span class="op">=</span> []</span>
<span id="cb375-7762"><a href="#cb375-7762" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.root: Tree.Node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb375-7763"><a href="#cb375-7763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7764"><a href="#cb375-7764" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb375-7765"><a href="#cb375-7765" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Tree.Node()</span>
<span id="cb375-7766"><a href="#cb375-7766" aria-hidden="true" tabindex="-1"></a>        new_node.label <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.all_nodes)</span>
<span id="cb375-7767"><a href="#cb375-7767" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes.append(new_node)</span>
<span id="cb375-7768"><a href="#cb375-7768" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb375-7769"><a href="#cb375-7769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7770"><a href="#cb375-7770" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(<span class="va">self</span>, from_node: Node, target_node: Node, pos: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Edge:</span>
<span id="cb375-7771"><a href="#cb375-7771" aria-hidden="true" tabindex="-1"></a>        new_edge <span class="op">=</span> Tree.Edge()</span>
<span id="cb375-7772"><a href="#cb375-7772" aria-hidden="true" tabindex="-1"></a>        new_edge.from_node <span class="op">=</span> from_node</span>
<span id="cb375-7773"><a href="#cb375-7773" aria-hidden="true" tabindex="-1"></a>        new_edge.target_node <span class="op">=</span> target_node</span>
<span id="cb375-7774"><a href="#cb375-7774" aria-hidden="true" tabindex="-1"></a>        new_edge.position <span class="op">=</span> pos</span>
<span id="cb375-7775"><a href="#cb375-7775" aria-hidden="true" tabindex="-1"></a>        new_edge.length <span class="op">=</span> length</span>
<span id="cb375-7776"><a href="#cb375-7776" aria-hidden="true" tabindex="-1"></a>        target_node.depth <span class="op">=</span> from_node.depth <span class="op">+</span> length</span>
<span id="cb375-7777"><a href="#cb375-7777" aria-hidden="true" tabindex="-1"></a>        from_node.edges.append(new_edge)</span>
<span id="cb375-7778"><a href="#cb375-7778" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges.append(new_edge)</span>
<span id="cb375-7779"><a href="#cb375-7779" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_edge</span>
<span id="cb375-7780"><a href="#cb375-7780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7781"><a href="#cb375-7781" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> edge_labels(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-7782"><a href="#cb375-7782" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [text[edge.position : edge.position <span class="op">+</span> edge.length] <span class="cf">for</span> edge <span class="kw">in</span> <span class="va">self</span>.all_edges]</span>
<span id="cb375-7783"><a href="#cb375-7783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7784"><a href="#cb375-7784" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> return_ripe_nodes(<span class="va">self</span>) <span class="op">-&gt;</span> List[Node]:</span>
<span id="cb375-7785"><a href="#cb375-7785" aria-hidden="true" tabindex="-1"></a>        ripe_nodes <span class="op">=</span> []</span>
<span id="cb375-7786"><a href="#cb375-7786" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.all_nodes:</span>
<span id="cb375-7787"><a href="#cb375-7787" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> node.indicator <span class="kw">is</span> <span class="va">None</span> <span class="kw">and</span> <span class="bu">all</span>(edge.target_node.indicator <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">for</span> edge <span class="kw">in</span> node.edges):</span>
<span id="cb375-7788"><a href="#cb375-7788" aria-hidden="true" tabindex="-1"></a>                ripe_nodes.append(node)</span>
<span id="cb375-7789"><a href="#cb375-7789" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ripe_nodes</span>
<span id="cb375-7790"><a href="#cb375-7790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7791"><a href="#cb375-7791" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_indicators(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7792"><a href="#cb375-7792" aria-hidden="true" tabindex="-1"></a>        ripe_nodes <span class="op">=</span> <span class="va">self</span>.return_ripe_nodes()</span>
<span id="cb375-7793"><a href="#cb375-7793" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> ripe_nodes:</span>
<span id="cb375-7794"><a href="#cb375-7794" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> node <span class="kw">in</span> ripe_nodes:</span>
<span id="cb375-7795"><a href="#cb375-7795" aria-hidden="true" tabindex="-1"></a>                children_indicators <span class="op">=</span> <span class="bu">set</span>(edge.target_node.indicator <span class="cf">for</span> edge <span class="kw">in</span> node.edges)</span>
<span id="cb375-7796"><a href="#cb375-7796" aria-hidden="true" tabindex="-1"></a>                node.indicator <span class="op">=</span> <span class="st">'*'</span> <span class="cf">if</span> <span class="bu">len</span>(children_indicators) <span class="op">!=</span> <span class="dv">1</span> <span class="cf">else</span> <span class="bu">next</span>(<span class="bu">iter</span>(children_indicators))</span>
<span id="cb375-7797"><a href="#cb375-7797" aria-hidden="true" tabindex="-1"></a>            ripe_nodes <span class="op">=</span> <span class="va">self</span>.return_ripe_nodes()</span>
<span id="cb375-7798"><a href="#cb375-7798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7799"><a href="#cb375-7799" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_suffix_tree(<span class="va">self</span>, trie_node: <span class="st">'Trie.Node'</span>, tree_node: Node, path: List[<span class="st">'Trie.Edge'</span>] <span class="op">=</span> []) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7800"><a href="#cb375-7800" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="bu">len</span>(trie_node.edges) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb375-7801"><a href="#cb375-7801" aria-hidden="true" tabindex="-1"></a>            trie_edge <span class="op">=</span> trie_node.edges[<span class="dv">0</span>]</span>
<span id="cb375-7802"><a href="#cb375-7802" aria-hidden="true" tabindex="-1"></a>            path.append(trie_edge)</span>
<span id="cb375-7803"><a href="#cb375-7803" aria-hidden="true" tabindex="-1"></a>            trie_node <span class="op">=</span> trie_edge.target_node</span>
<span id="cb375-7804"><a href="#cb375-7804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7805"><a href="#cb375-7805" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path:</span>
<span id="cb375-7806"><a href="#cb375-7806" aria-hidden="true" tabindex="-1"></a>            new_tree_node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb375-7807"><a href="#cb375-7807" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.add_edge(tree_node, new_tree_node, path[<span class="dv">0</span>].position, <span class="bu">len</span>(path))</span>
<span id="cb375-7808"><a href="#cb375-7808" aria-hidden="true" tabindex="-1"></a>            tree_node <span class="op">=</span> new_tree_node</span>
<span id="cb375-7809"><a href="#cb375-7809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7810"><a href="#cb375-7810" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> trie_node.edges:</span>
<span id="cb375-7811"><a href="#cb375-7811" aria-hidden="true" tabindex="-1"></a>            tree_node.indicator <span class="op">=</span> trie_node.indicator</span>
<span id="cb375-7812"><a href="#cb375-7812" aria-hidden="true" tabindex="-1"></a>            tree_node.label <span class="op">=</span> trie_node.label</span>
<span id="cb375-7813"><a href="#cb375-7813" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb375-7814"><a href="#cb375-7814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7815"><a href="#cb375-7815" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trie_edge <span class="kw">in</span> trie_node.edges:</span>
<span id="cb375-7816"><a href="#cb375-7816" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.construct_suffix_tree(trie_edge.target_node, tree_node, [trie_edge])</span>
<span id="cb375-7817"><a href="#cb375-7817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7818"><a href="#cb375-7818" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> populate_suffix_tree(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7819"><a href="#cb375-7819" aria-hidden="true" tabindex="-1"></a>        suffix_trie <span class="op">=</span> Trie()</span>
<span id="cb375-7820"><a href="#cb375-7820" aria-hidden="true" tabindex="-1"></a>        suffix_trie.construct_suffix_trie(text)</span>
<span id="cb375-7821"><a href="#cb375-7821" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.construct_suffix_tree(suffix_trie.root, <span class="va">self</span>.root)</span>
<span id="cb375-7822"><a href="#cb375-7822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7823"><a href="#cb375-7823" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Trie:</span>
<span id="cb375-7824"><a href="#cb375-7824" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Node:</span>
<span id="cb375-7825"><a href="#cb375-7825" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7826"><a href="#cb375-7826" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.label: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7827"><a href="#cb375-7827" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.edges: List[<span class="st">'Trie.Edge'</span>] <span class="op">=</span> []</span>
<span id="cb375-7828"><a href="#cb375-7828" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.indicator: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7829"><a href="#cb375-7829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7830"><a href="#cb375-7830" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Edge:</span>
<span id="cb375-7831"><a href="#cb375-7831" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7832"><a href="#cb375-7832" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.from_node: Optional[<span class="st">'Trie.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7833"><a href="#cb375-7833" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.target_node: Optional[<span class="st">'Trie.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7834"><a href="#cb375-7834" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.label: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7835"><a href="#cb375-7835" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.position: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb375-7836"><a href="#cb375-7836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7837"><a href="#cb375-7837" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7838"><a href="#cb375-7838" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes: List[Trie.Node] <span class="op">=</span> []</span>
<span id="cb375-7839"><a href="#cb375-7839" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges: List[Trie.Edge] <span class="op">=</span> []</span>
<span id="cb375-7840"><a href="#cb375-7840" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.root: Trie.Node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb375-7841"><a href="#cb375-7841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7842"><a href="#cb375-7842" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb375-7843"><a href="#cb375-7843" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Trie.Node()</span>
<span id="cb375-7844"><a href="#cb375-7844" aria-hidden="true" tabindex="-1"></a>        new_node.label <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.all_nodes)</span>
<span id="cb375-7845"><a href="#cb375-7845" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes.append(new_node)</span>
<span id="cb375-7846"><a href="#cb375-7846" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb375-7847"><a href="#cb375-7847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7848"><a href="#cb375-7848" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(<span class="va">self</span>, from_node: Node, target_node: Node, label: <span class="bu">str</span>, pos: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Edge:</span>
<span id="cb375-7849"><a href="#cb375-7849" aria-hidden="true" tabindex="-1"></a>        new_edge <span class="op">=</span> Trie.Edge()</span>
<span id="cb375-7850"><a href="#cb375-7850" aria-hidden="true" tabindex="-1"></a>        new_edge.from_node <span class="op">=</span> from_node</span>
<span id="cb375-7851"><a href="#cb375-7851" aria-hidden="true" tabindex="-1"></a>        new_edge.target_node <span class="op">=</span> target_node</span>
<span id="cb375-7852"><a href="#cb375-7852" aria-hidden="true" tabindex="-1"></a>        new_edge.label <span class="op">=</span> label</span>
<span id="cb375-7853"><a href="#cb375-7853" aria-hidden="true" tabindex="-1"></a>        new_edge.position <span class="op">=</span> pos</span>
<span id="cb375-7854"><a href="#cb375-7854" aria-hidden="true" tabindex="-1"></a>        from_node.edges.append(new_edge)</span>
<span id="cb375-7855"><a href="#cb375-7855" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges.append(new_edge)</span>
<span id="cb375-7856"><a href="#cb375-7856" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_edge</span>
<span id="cb375-7857"><a href="#cb375-7857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7858"><a href="#cb375-7858" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_suffix_trie(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-7859"><a href="#cb375-7859" aria-hidden="true" tabindex="-1"></a>        indicator <span class="op">=</span> <span class="st">'#'</span></span>
<span id="cb375-7860"><a href="#cb375-7860" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text)):</span>
<span id="cb375-7861"><a href="#cb375-7861" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> <span class="va">self</span>.root</span>
<span id="cb375-7862"><a href="#cb375-7862" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(text)):</span>
<span id="cb375-7863"><a href="#cb375-7863" aria-hidden="true" tabindex="-1"></a>                current_symbol <span class="op">=</span> text[j]</span>
<span id="cb375-7864"><a href="#cb375-7864" aria-hidden="true" tabindex="-1"></a>                next_node <span class="op">=</span> <span class="bu">next</span>((edge.target_node <span class="cf">for</span> edge <span class="kw">in</span> current_node.edges <span class="cf">if</span> edge.label <span class="op">==</span> current_symbol), <span class="va">None</span>)</span>
<span id="cb375-7865"><a href="#cb375-7865" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> next_node <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb375-7866"><a href="#cb375-7866" aria-hidden="true" tabindex="-1"></a>                    new_node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb375-7867"><a href="#cb375-7867" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.add_edge(current_node, new_node, current_symbol, j)</span>
<span id="cb375-7868"><a href="#cb375-7868" aria-hidden="true" tabindex="-1"></a>                    current_node <span class="op">=</span> new_node</span>
<span id="cb375-7869"><a href="#cb375-7869" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-7870"><a href="#cb375-7870" aria-hidden="true" tabindex="-1"></a>                    current_node <span class="op">=</span> next_node</span>
<span id="cb375-7871"><a href="#cb375-7871" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> current_node.edges:</span>
<span id="cb375-7872"><a href="#cb375-7872" aria-hidden="true" tabindex="-1"></a>                current_node.label <span class="op">=</span> <span class="ss">f'L</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb375-7873"><a href="#cb375-7873" aria-hidden="true" tabindex="-1"></a>                current_node.indicator <span class="op">=</span> indicator</span>
<span id="cb375-7874"><a href="#cb375-7874" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> text[i] <span class="op">==</span> <span class="st">'#'</span>:</span>
<span id="cb375-7875"><a href="#cb375-7875" aria-hidden="true" tabindex="-1"></a>                indicator <span class="op">=</span> <span class="st">'$'</span></span>
<span id="cb375-7876"><a href="#cb375-7876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7877"><a href="#cb375-7877" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"ATAAATG$"</span></span>
<span id="cb375-7878"><a href="#cb375-7878" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb375-7879"><a href="#cb375-7879" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-7880"><a href="#cb375-7880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7881"><a href="#cb375-7881" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> Tree()</span>
<span id="cb375-7882"><a href="#cb375-7882" aria-hidden="true" tabindex="-1"></a>tree.populate_suffix_tree(text)</span>
<span id="cb375-7883"><a href="#cb375-7883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7884"><a href="#cb375-7884" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> tree.edge_labels(text)</span>
<span id="cb375-7885"><a href="#cb375-7885" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(result))</span>
<span id="cb375-7886"><a href="#cb375-7886" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7887"><a href="#cb375-7887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7888"><a href="#cb375-7888" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Longest Repeat in a String</span></span>
<span id="cb375-7889"><a href="#cb375-7889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7890"><a href="#cb375-7890" aria-hidden="true" tabindex="-1"></a>Longest Repeat Problem, Find the longest repeat <span class="kw">in</span> a string.</span>
<span id="cb375-7891"><a href="#cb375-7891" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7892"><a href="#cb375-7892" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb375-7893"><a href="#cb375-7893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7894"><a href="#cb375-7894" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A longest substring of&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;that appears in&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;more than once. (Multiple solutions may exist, <span class="kw">in</span> which case you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-7895"><a href="#cb375-7895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7896"><a href="#cb375-7896" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7897"><a href="#cb375-7897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7898"><a href="#cb375-7898" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7899"><a href="#cb375-7899" aria-hidden="true" tabindex="-1"></a>ATATCGTTTTATCGTT</span>
<span id="cb375-7900"><a href="#cb375-7900" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7901"><a href="#cb375-7901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7902"><a href="#cb375-7902" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7903"><a href="#cb375-7903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7904"><a href="#cb375-7904" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7905"><a href="#cb375-7905" aria-hidden="true" tabindex="-1"></a>TATCGTT</span>
<span id="cb375-7906"><a href="#cb375-7906" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7907"><a href="#cb375-7907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7908"><a href="#cb375-7908" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7909"><a href="#cb375-7909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7910"><a href="#cb375-7910" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7911"><a href="#cb375-7911" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cache</span>
<span id="cb375-7912"><a href="#cb375-7912" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> commonprefix</span>
<span id="cb375-7913"><a href="#cb375-7913" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Generator, Iterator</span>
<span id="cb375-7914"><a href="#cb375-7914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7915"><a href="#cb375-7915" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_edges(graph: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-7916"><a href="#cb375-7916" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key <span class="kw">in</span> graph.keys():</span>
<span id="cb375-7917"><a href="#cb375-7917" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> key</span>
<span id="cb375-7918"><a href="#cb375-7918" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="cf">from</span> get_edges(graph[key])</span>
<span id="cb375-7919"><a href="#cb375-7919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7920"><a href="#cb375-7920" aria-hidden="true" tabindex="-1"></a><span class="at">@cache</span></span>
<span id="cb375-7921"><a href="#cb375-7921" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suffix_tree(sequence: <span class="bu">str</span>, start_positions: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb375-7922"><a href="#cb375-7922" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">str</span>, Dict] <span class="op">=</span> {}</span>
<span id="cb375-7923"><a href="#cb375-7923" aria-hidden="true" tabindex="-1"></a>    unique_bases <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([sequence[start] <span class="cf">for</span> start <span class="kw">in</span> start_positions]))</span>
<span id="cb375-7924"><a href="#cb375-7924" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-7925"><a href="#cb375-7925" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> unique_bases:</span>
<span id="cb375-7926"><a href="#cb375-7926" aria-hidden="true" tabindex="-1"></a>        matching_positions <span class="op">=</span> [start <span class="cf">for</span> start <span class="kw">in</span> start_positions <span class="cf">if</span> sequence[start] <span class="op">==</span> base]</span>
<span id="cb375-7927"><a href="#cb375-7927" aria-hidden="true" tabindex="-1"></a>        subsequences <span class="op">=</span> [sequence[s:] <span class="cf">for</span> s <span class="kw">in</span> matching_positions]</span>
<span id="cb375-7928"><a href="#cb375-7928" aria-hidden="true" tabindex="-1"></a>        common_prefix <span class="op">=</span> commonprefix(subsequences)</span>
<span id="cb375-7929"><a href="#cb375-7929" aria-hidden="true" tabindex="-1"></a>        prefix_length <span class="op">=</span> <span class="bu">len</span>(common_prefix)</span>
<span id="cb375-7930"><a href="#cb375-7930" aria-hidden="true" tabindex="-1"></a>        new_start_positions <span class="op">=</span> [start <span class="op">+</span> prefix_length <span class="cf">for</span> start <span class="kw">in</span> matching_positions <span class="cf">if</span> start <span class="op">+</span> prefix_length <span class="op">&lt;</span> <span class="bu">len</span>(sequence)]</span>
<span id="cb375-7931"><a href="#cb375-7931" aria-hidden="true" tabindex="-1"></a>        tree[common_prefix] <span class="op">=</span> suffix_tree(sequence, <span class="bu">tuple</span>(new_start_positions))</span>
<span id="cb375-7932"><a href="#cb375-7932" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-7933"><a href="#cb375-7933" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb375-7934"><a href="#cb375-7934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7935"><a href="#cb375-7935" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_tree(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb375-7936"><a href="#cb375-7936" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> suffix_tree(sequence, <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="bu">len</span>(sequence))))</span>
<span id="cb375-7937"><a href="#cb375-7937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7938"><a href="#cb375-7938" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> internal_edges(tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb375-7939"><a href="#cb375-7939" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> tree.keys():</span>
<span id="cb375-7940"><a href="#cb375-7940" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">len</span>(tree[node]):</span>
<span id="cb375-7941"><a href="#cb375-7941" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> <span class="st">""</span></span>
<span id="cb375-7942"><a href="#cb375-7942" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child_edge <span class="kw">in</span> internal_edges(tree[node]):</span>
<span id="cb375-7943"><a href="#cb375-7943" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> node <span class="op">+</span> child_edge</span>
<span id="cb375-7944"><a href="#cb375-7944" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7945"><a href="#cb375-7945" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_shared_substring(tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-7946"><a href="#cb375-7946" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(internal_edges(tree), key<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">len</span>(x))</span>
<span id="cb375-7947"><a href="#cb375-7947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7948"><a href="#cb375-7948" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-7949"><a href="#cb375-7949" aria-hidden="true" tabindex="-1"></a><span class="st">ATATCGTTTTATCGTT</span></span>
<span id="cb375-7950"><a href="#cb375-7950" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-7951"><a href="#cb375-7951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7952"><a href="#cb375-7952" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb375-7953"><a href="#cb375-7953" aria-hidden="true" tabindex="-1"></a>suffix_tree <span class="op">=</span> create_suffix_tree(sequence)</span>
<span id="cb375-7954"><a href="#cb375-7954" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_shared_substring(suffix_tree))</span>
<span id="cb375-7955"><a href="#cb375-7955" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7956"><a href="#cb375-7956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7957"><a href="#cb375-7957" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Longest Substring Shared by Two Strings</span></span>
<span id="cb375-7958"><a href="#cb375-7958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7959"><a href="#cb375-7959" aria-hidden="true" tabindex="-1"></a>Longest Shared Substring Problem. Find the longest substring shared by two strings.</span>
<span id="cb375-7960"><a href="#cb375-7960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7961"><a href="#cb375-7961" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Strings&nbsp;_Text_1&nbsp;and&nbsp;_Text_2.</span>
<span id="cb375-7962"><a href="#cb375-7962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7963"><a href="#cb375-7963" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The longest substring that occurs <span class="kw">in</span> both&nbsp;_Text_1&nbsp;and&nbsp;_Text_2. (Multiple solutions may exist, <span class="kw">in</span> which case you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-7964"><a href="#cb375-7964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7965"><a href="#cb375-7965" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-7966"><a href="#cb375-7966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7967"><a href="#cb375-7967" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7968"><a href="#cb375-7968" aria-hidden="true" tabindex="-1"></a>TCGGTAGATTGCGCCCACTC</span>
<span id="cb375-7969"><a href="#cb375-7969" aria-hidden="true" tabindex="-1"></a>AGGGGCTCGCAGTGTAAGAA</span>
<span id="cb375-7970"><a href="#cb375-7970" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7971"><a href="#cb375-7971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7972"><a href="#cb375-7972" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-7973"><a href="#cb375-7973" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7974"><a href="#cb375-7974" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7975"><a href="#cb375-7975" aria-hidden="true" tabindex="-1"></a>AGA</span>
<span id="cb375-7976"><a href="#cb375-7976" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-7977"><a href="#cb375-7977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7978"><a href="#cb375-7978" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-7979"><a href="#cb375-7979" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7980"><a href="#cb375-7980" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-7981"><a href="#cb375-7981" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-7982"><a href="#cb375-7982" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb375-7983"><a href="#cb375-7983" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cache</span>
<span id="cb375-7984"><a href="#cb375-7984" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> commonprefix</span>
<span id="cb375-7985"><a href="#cb375-7985" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple, Generator</span>
<span id="cb375-7986"><a href="#cb375-7986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-7987"><a href="#cb375-7987" aria-hidden="true" tabindex="-1"></a><span class="at">@cache</span></span>
<span id="cb375-7988"><a href="#cb375-7988" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_suffix_tree(sequence: <span class="bu">str</span>, start_positions: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb375-7989"><a href="#cb375-7989" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">str</span>, Dict] <span class="op">=</span> {}</span>
<span id="cb375-7990"><a href="#cb375-7990" aria-hidden="true" tabindex="-1"></a>    unique_bases <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([sequence[start] <span class="cf">for</span> start <span class="kw">in</span> start_positions]))</span>
<span id="cb375-7991"><a href="#cb375-7991" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> unique_bases:</span>
<span id="cb375-7992"><a href="#cb375-7992" aria-hidden="true" tabindex="-1"></a>        matching_positions <span class="op">=</span> [start <span class="cf">for</span> start <span class="kw">in</span> start_positions <span class="cf">if</span> sequence[start] <span class="op">==</span> base]</span>
<span id="cb375-7993"><a href="#cb375-7993" aria-hidden="true" tabindex="-1"></a>        subsequences <span class="op">=</span> [sequence[s:] <span class="cf">for</span> s <span class="kw">in</span> matching_positions]</span>
<span id="cb375-7994"><a href="#cb375-7994" aria-hidden="true" tabindex="-1"></a>        common_prefix <span class="op">=</span> commonprefix(subsequences)</span>
<span id="cb375-7995"><a href="#cb375-7995" aria-hidden="true" tabindex="-1"></a>        prefix_length <span class="op">=</span> <span class="bu">len</span>(common_prefix)</span>
<span id="cb375-7996"><a href="#cb375-7996" aria-hidden="true" tabindex="-1"></a>        new_start_positions <span class="op">=</span> [start <span class="op">+</span> prefix_length <span class="cf">for</span> start <span class="kw">in</span> matching_positions <span class="cf">if</span> start <span class="op">+</span> prefix_length <span class="op">&lt;</span> <span class="bu">len</span>(sequence)]</span>
<span id="cb375-7997"><a href="#cb375-7997" aria-hidden="true" tabindex="-1"></a>        tree[common_prefix] <span class="op">=</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(new_start_positions))</span>
<span id="cb375-7998"><a href="#cb375-7998" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb375-7999"><a href="#cb375-7999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8000"><a href="#cb375-8000" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_tree(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb375-8001"><a href="#cb375-8001" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="bu">len</span>(sequence))))</span>
<span id="cb375-8002"><a href="#cb375-8002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8003"><a href="#cb375-8003" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_graph(suffix_tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb375-8004"><a href="#cb375-8004" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> build_graph_structure(subtree: Dict[<span class="bu">str</span>, Dict], graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], node_id: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-8005"><a href="#cb375-8005" aria-hidden="true" tabindex="-1"></a>        next_node_id <span class="op">=</span> node_id</span>
<span id="cb375-8006"><a href="#cb375-8006" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> <span class="bu">sorted</span>(subtree):</span>
<span id="cb375-8007"><a href="#cb375-8007" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-8008"><a href="#cb375-8008" aria-hidden="true" tabindex="-1"></a>            graph[node_id].append({<span class="st">"n"</span>: next_node_id, <span class="st">"l"</span>: edge})</span>
<span id="cb375-8009"><a href="#cb375-8009" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">=</span> build_graph_structure(subtree[edge], graph, next_node_id)</span>
<span id="cb375-8010"><a href="#cb375-8010" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> next_node_id</span>
<span id="cb375-8011"><a href="#cb375-8011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8012"><a href="#cb375-8012" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-8013"><a href="#cb375-8013" aria-hidden="true" tabindex="-1"></a>    build_graph_structure(suffix_tree, graph, <span class="dv">0</span>)</span>
<span id="cb375-8014"><a href="#cb375-8014" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-8015"><a href="#cb375-8015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8016"><a href="#cb375-8016" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_leaf_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-8017"><a href="#cb375-8017" aria-hidden="true" tabindex="-1"></a>    all_child_nodes <span class="op">=</span> <span class="bu">set</span>(node[<span class="st">"n"</span>] <span class="cf">for</span> nodes <span class="kw">in</span> graph.values() <span class="cf">for</span> node <span class="kw">in</span> nodes)</span>
<span id="cb375-8018"><a href="#cb375-8018" aria-hidden="true" tabindex="-1"></a>    parent_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb375-8019"><a href="#cb375-8019" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_child_nodes <span class="op">-</span> parent_nodes</span>
<span id="cb375-8020"><a href="#cb375-8020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8021"><a href="#cb375-8021" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph_structure(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-8022"><a href="#cb375-8022" aria-hidden="true" tabindex="-1"></a>    reversed_graph: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb375-8023"><a href="#cb375-8023" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parent_node, children <span class="kw">in</span> graph.items():</span>
<span id="cb375-8024"><a href="#cb375-8024" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> children:</span>
<span id="cb375-8025"><a href="#cb375-8025" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child[<span class="st">"n"</span>]] <span class="op">=</span> {<span class="st">"n"</span>: parent_node, <span class="st">"l"</span>: child[<span class="st">"l"</span>]}</span>
<span id="cb375-8026"><a href="#cb375-8026" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb375-8027"><a href="#cb375-8027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8028"><a href="#cb375-8028" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_purple_edges(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-8029"><a href="#cb375-8029" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_purple_edges(node: <span class="bu">int</span>, sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-8030"><a href="#cb375-8030" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> colors[node] <span class="op">==</span> <span class="st">"purple"</span>:</span>
<span id="cb375-8031"><a href="#cb375-8031" aria-hidden="true" tabindex="-1"></a>            has_purple_child <span class="op">=</span> <span class="bu">any</span>(colors[child[<span class="st">"n"</span>]] <span class="op">==</span> <span class="st">"purple"</span> <span class="cf">for</span> child <span class="kw">in</span> tree[node])</span>
<span id="cb375-8032"><a href="#cb375-8032" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> has_purple_child:</span>
<span id="cb375-8033"><a href="#cb375-8033" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> child <span class="kw">in</span> tree[node]:</span>
<span id="cb375-8034"><a href="#cb375-8034" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">yield</span> <span class="cf">from</span> _get_purple_edges(child[<span class="st">"n"</span>], sequence <span class="op">+</span> child[<span class="st">"l"</span>])</span>
<span id="cb375-8035"><a href="#cb375-8035" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-8036"><a href="#cb375-8036" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence</span>
<span id="cb375-8037"><a href="#cb375-8037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8038"><a href="#cb375-8038" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="cf">from</span> _get_purple_edges(<span class="dv">0</span>, <span class="st">""</span>)</span>
<span id="cb375-8039"><a href="#cb375-8039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8040"><a href="#cb375-8040" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_leaf_colors(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb375-8041"><a href="#cb375-8041" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph_structure(tree)</span>
<span id="cb375-8042"><a href="#cb375-8042" aria-hidden="true" tabindex="-1"></a>    colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="va">None</span>)</span>
<span id="cb375-8043"><a href="#cb375-8043" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> find_leaf_nodes(tree):</span>
<span id="cb375-8044"><a href="#cb375-8044" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> reversed_graph[leaf][<span class="st">"l"</span>]</span>
<span id="cb375-8045"><a href="#cb375-8045" aria-hidden="true" tabindex="-1"></a>        match <span class="op">=</span> re.search(<span class="vs">r"([$#])"</span>, edge)</span>
<span id="cb375-8046"><a href="#cb375-8046" aria-hidden="true" tabindex="-1"></a>        colors[leaf] <span class="op">=</span> <span class="st">"red"</span> <span class="cf">if</span> match.group() <span class="op">==</span> <span class="st">"$"</span> <span class="cf">else</span> <span class="st">"blue"</span></span>
<span id="cb375-8047"><a href="#cb375-8047" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb375-8048"><a href="#cb375-8048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8049"><a href="#cb375-8049" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_tree_nodes(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb375-8050"><a href="#cb375-8050" aria-hidden="true" tabindex="-1"></a>    nodes_to_process <span class="op">=</span> <span class="bu">list</span>(tree.keys())</span>
<span id="cb375-8051"><a href="#cb375-8051" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes_to_process:</span>
<span id="cb375-8052"><a href="#cb375-8052" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> nodes_to_process:</span>
<span id="cb375-8053"><a href="#cb375-8053" aria-hidden="true" tabindex="-1"></a>            child_colors <span class="op">=</span> [colors[child[<span class="st">"n"</span>]] <span class="cf">for</span> child <span class="kw">in</span> tree[node]]</span>
<span id="cb375-8054"><a href="#cb375-8054" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(child_colors):</span>
<span id="cb375-8055"><a href="#cb375-8055" aria-hidden="true" tabindex="-1"></a>                unique_colors <span class="op">=</span> <span class="bu">set</span>(child_colors)</span>
<span id="cb375-8056"><a href="#cb375-8056" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> unique_colors <span class="op">==</span> {<span class="st">"red"</span>}:</span>
<span id="cb375-8057"><a href="#cb375-8057" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb375-8058"><a href="#cb375-8058" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> unique_colors <span class="op">==</span> {<span class="st">"blue"</span>}:</span>
<span id="cb375-8059"><a href="#cb375-8059" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb375-8060"><a href="#cb375-8060" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-8061"><a href="#cb375-8061" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"purple"</span></span>
<span id="cb375-8062"><a href="#cb375-8062" aria-hidden="true" tabindex="-1"></a>                nodes_to_process.remove(node)</span>
<span id="cb375-8063"><a href="#cb375-8063" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb375-8064"><a href="#cb375-8064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8065"><a href="#cb375-8065" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_longest_shared_substring(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-8066"><a href="#cb375-8066" aria-hidden="true" tabindex="-1"></a>    combined_sequence <span class="op">=</span> seq1 <span class="op">+</span> <span class="st">"$"</span> <span class="op">+</span> seq2 <span class="op">+</span> <span class="st">"#"</span></span>
<span id="cb375-8067"><a href="#cb375-8067" aria-hidden="true" tabindex="-1"></a>    suffix_tree <span class="op">=</span> create_suffix_tree(combined_sequence)</span>
<span id="cb375-8068"><a href="#cb375-8068" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> convert_to_graph(suffix_tree)</span>
<span id="cb375-8069"><a href="#cb375-8069" aria-hidden="true" tabindex="-1"></a>    initial_colors <span class="op">=</span> initialize_leaf_colors(graph)</span>
<span id="cb375-8070"><a href="#cb375-8070" aria-hidden="true" tabindex="-1"></a>    final_colors <span class="op">=</span> color_tree_nodes(graph, initial_colors)</span>
<span id="cb375-8071"><a href="#cb375-8071" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(get_purple_edges(graph, final_colors), key<span class="op">=</span><span class="bu">len</span>)</span>
<span id="cb375-8072"><a href="#cb375-8072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8073"><a href="#cb375-8073" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-8074"><a href="#cb375-8074" aria-hidden="true" tabindex="-1"></a><span class="st">TCGGTAGATTGCGCCCACTC</span></span>
<span id="cb375-8075"><a href="#cb375-8075" aria-hidden="true" tabindex="-1"></a><span class="st">AGGGGCTCGCAGTGTAAGAA</span></span>
<span id="cb375-8076"><a href="#cb375-8076" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-8077"><a href="#cb375-8077" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-8078"><a href="#cb375-8078" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(find_longest_shared_substring(sequence1, sequence2))</span>
<span id="cb375-8079"><a href="#cb375-8079" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8080"><a href="#cb375-8080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8081"><a href="#cb375-8081" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the Shortest Non-Shared Substring of Two Strings</span></span>
<span id="cb375-8082"><a href="#cb375-8082" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8083"><a href="#cb375-8083" aria-hidden="true" tabindex="-1"></a> Shortest Non<span class="op">-</span>Shared Substring Problem. Find the shortest substring of one string that does <span class="kw">not</span> appear <span class="kw">in</span> another string.</span>
<span id="cb375-8084"><a href="#cb375-8084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8085"><a href="#cb375-8085" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;Strings&nbsp;_Text_1&nbsp;and&nbsp;_Text_2.</span>
<span id="cb375-8086"><a href="#cb375-8086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8087"><a href="#cb375-8087" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The shortest substring of&nbsp;_Text_1&nbsp;that does <span class="kw">not</span> appear in&nbsp;_Text_2. (Multiple solutions may exist, <span class="kw">in</span> which case you may <span class="cf">return</span> <span class="bu">any</span> one.)</span>
<span id="cb375-8088"><a href="#cb375-8088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8089"><a href="#cb375-8089" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8090"><a href="#cb375-8090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8091"><a href="#cb375-8091" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8092"><a href="#cb375-8092" aria-hidden="true" tabindex="-1"></a>CCAAGCTGCTAGAGG</span>
<span id="cb375-8093"><a href="#cb375-8093" aria-hidden="true" tabindex="-1"></a>CATGCTGGGCTGGCT</span>
<span id="cb375-8094"><a href="#cb375-8094" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8095"><a href="#cb375-8095" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8096"><a href="#cb375-8096" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8097"><a href="#cb375-8097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8098"><a href="#cb375-8098" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8099"><a href="#cb375-8099" aria-hidden="true" tabindex="-1"></a>AA</span>
<span id="cb375-8100"><a href="#cb375-8100" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8101"><a href="#cb375-8101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8102"><a href="#cb375-8102" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8103"><a href="#cb375-8103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8104"><a href="#cb375-8104" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8105"><a href="#cb375-8105" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cache</span>
<span id="cb375-8106"><a href="#cb375-8106" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> commonprefix</span>
<span id="cb375-8107"><a href="#cb375-8107" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Set</span>
<span id="cb375-8108"><a href="#cb375-8108" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-8109"><a href="#cb375-8109" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb375-8110"><a href="#cb375-8110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8111"><a href="#cb375-8111" aria-hidden="true" tabindex="-1"></a><span class="at">@cache</span></span>
<span id="cb375-8112"><a href="#cb375-8112" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_suffix_tree(sequence: <span class="bu">str</span>, start_positions: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb375-8113"><a href="#cb375-8113" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">str</span>, Dict] <span class="op">=</span> {}</span>
<span id="cb375-8114"><a href="#cb375-8114" aria-hidden="true" tabindex="-1"></a>    unique_bases <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([sequence[start] <span class="cf">for</span> start <span class="kw">in</span> start_positions]))</span>
<span id="cb375-8115"><a href="#cb375-8115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> unique_bases:</span>
<span id="cb375-8116"><a href="#cb375-8116" aria-hidden="true" tabindex="-1"></a>        matching_positions <span class="op">=</span> [start <span class="cf">for</span> start <span class="kw">in</span> start_positions <span class="cf">if</span> sequence[start] <span class="op">==</span> base]</span>
<span id="cb375-8117"><a href="#cb375-8117" aria-hidden="true" tabindex="-1"></a>        subsequences <span class="op">=</span> [sequence[s:] <span class="cf">for</span> s <span class="kw">in</span> matching_positions]</span>
<span id="cb375-8118"><a href="#cb375-8118" aria-hidden="true" tabindex="-1"></a>        common_prefix <span class="op">=</span> commonprefix(subsequences)</span>
<span id="cb375-8119"><a href="#cb375-8119" aria-hidden="true" tabindex="-1"></a>        prefix_length <span class="op">=</span> <span class="bu">len</span>(common_prefix)</span>
<span id="cb375-8120"><a href="#cb375-8120" aria-hidden="true" tabindex="-1"></a>        new_start_positions <span class="op">=</span> [start <span class="op">+</span> prefix_length <span class="cf">for</span> start <span class="kw">in</span> matching_positions <span class="cf">if</span> start <span class="op">+</span> prefix_length <span class="op">&lt;</span> <span class="bu">len</span>(sequence)]</span>
<span id="cb375-8121"><a href="#cb375-8121" aria-hidden="true" tabindex="-1"></a>        tree[common_prefix] <span class="op">=</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(new_start_positions))</span>
<span id="cb375-8122"><a href="#cb375-8122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb375-8123"><a href="#cb375-8123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8124"><a href="#cb375-8124" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_tree(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb375-8125"><a href="#cb375-8125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="bu">len</span>(sequence))))</span>
<span id="cb375-8126"><a href="#cb375-8126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8127"><a href="#cb375-8127" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_leaf_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb375-8128"><a href="#cb375-8128" aria-hidden="true" tabindex="-1"></a>    all_child_nodes <span class="op">=</span> <span class="bu">set</span>(node[<span class="st">"n"</span>] <span class="cf">for</span> nodes <span class="kw">in</span> graph.values() <span class="cf">for</span> node <span class="kw">in</span> nodes)</span>
<span id="cb375-8129"><a href="#cb375-8129" aria-hidden="true" tabindex="-1"></a>    parent_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb375-8130"><a href="#cb375-8130" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_child_nodes <span class="op">-</span> parent_nodes</span>
<span id="cb375-8131"><a href="#cb375-8131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8132"><a href="#cb375-8132" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph_structure(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-8133"><a href="#cb375-8133" aria-hidden="true" tabindex="-1"></a>    reversed_graph: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb375-8134"><a href="#cb375-8134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parent, children <span class="kw">in</span> graph.items():</span>
<span id="cb375-8135"><a href="#cb375-8135" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> children:</span>
<span id="cb375-8136"><a href="#cb375-8136" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child[<span class="st">"n"</span>]] <span class="op">=</span> {<span class="st">"n"</span>: parent, <span class="st">"l"</span>: child[<span class="st">"l"</span>]}</span>
<span id="cb375-8137"><a href="#cb375-8137" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb375-8138"><a href="#cb375-8138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8139"><a href="#cb375-8139" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_graph(suffix_tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb375-8140"><a href="#cb375-8140" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> build_graph_structure(subtree: Dict[<span class="bu">str</span>, Dict], graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], node_id: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-8141"><a href="#cb375-8141" aria-hidden="true" tabindex="-1"></a>        next_node_id <span class="op">=</span> node_id</span>
<span id="cb375-8142"><a href="#cb375-8142" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> <span class="bu">sorted</span>(subtree):</span>
<span id="cb375-8143"><a href="#cb375-8143" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-8144"><a href="#cb375-8144" aria-hidden="true" tabindex="-1"></a>            graph[node_id].append({<span class="st">"n"</span>: next_node_id, <span class="st">"l"</span>: edge})</span>
<span id="cb375-8145"><a href="#cb375-8145" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">=</span> build_graph_structure(subtree[edge], graph, next_node_id)</span>
<span id="cb375-8146"><a href="#cb375-8146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> next_node_id</span>
<span id="cb375-8147"><a href="#cb375-8147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8148"><a href="#cb375-8148" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-8149"><a href="#cb375-8149" aria-hidden="true" tabindex="-1"></a>    build_graph_structure(suffix_tree, graph, <span class="dv">0</span>)</span>
<span id="cb375-8150"><a href="#cb375-8150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-8151"><a href="#cb375-8151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8152"><a href="#cb375-8152" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_leaf_colors(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb375-8153"><a href="#cb375-8153" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph_structure(tree)</span>
<span id="cb375-8154"><a href="#cb375-8154" aria-hidden="true" tabindex="-1"></a>    colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="va">None</span>)</span>
<span id="cb375-8155"><a href="#cb375-8155" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> find_leaf_nodes(tree):</span>
<span id="cb375-8156"><a href="#cb375-8156" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> reversed_graph[leaf][<span class="st">"l"</span>]</span>
<span id="cb375-8157"><a href="#cb375-8157" aria-hidden="true" tabindex="-1"></a>        match <span class="op">=</span> re.search(<span class="vs">r"([$#])"</span>, edge)</span>
<span id="cb375-8158"><a href="#cb375-8158" aria-hidden="true" tabindex="-1"></a>        colors[leaf] <span class="op">=</span> <span class="st">"red"</span> <span class="cf">if</span> match <span class="kw">and</span> match.group() <span class="op">==</span> <span class="st">"$"</span> <span class="cf">else</span> <span class="st">"blue"</span></span>
<span id="cb375-8159"><a href="#cb375-8159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb375-8160"><a href="#cb375-8160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8161"><a href="#cb375-8161" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_tree_nodes(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb375-8162"><a href="#cb375-8162" aria-hidden="true" tabindex="-1"></a>    nodes_to_process <span class="op">=</span> <span class="bu">list</span>(tree.keys())</span>
<span id="cb375-8163"><a href="#cb375-8163" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes_to_process:</span>
<span id="cb375-8164"><a href="#cb375-8164" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> nodes_to_process[:]:</span>
<span id="cb375-8165"><a href="#cb375-8165" aria-hidden="true" tabindex="-1"></a>            child_colors <span class="op">=</span> [colors[n[<span class="st">"n"</span>]] <span class="cf">for</span> n <span class="kw">in</span> tree[node]]</span>
<span id="cb375-8166"><a href="#cb375-8166" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(child_colors):</span>
<span id="cb375-8167"><a href="#cb375-8167" aria-hidden="true" tabindex="-1"></a>                unique_colors <span class="op">=</span> <span class="bu">set</span>(child_colors)</span>
<span id="cb375-8168"><a href="#cb375-8168" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> unique_colors <span class="op">==</span> {<span class="st">"red"</span>}:</span>
<span id="cb375-8169"><a href="#cb375-8169" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb375-8170"><a href="#cb375-8170" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> unique_colors <span class="op">==</span> {<span class="st">"blue"</span>}:</span>
<span id="cb375-8171"><a href="#cb375-8171" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb375-8172"><a href="#cb375-8172" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-8173"><a href="#cb375-8173" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"purple"</span></span>
<span id="cb375-8174"><a href="#cb375-8174" aria-hidden="true" tabindex="-1"></a>                nodes_to_process.remove(node)</span>
<span id="cb375-8175"><a href="#cb375-8175" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb375-8176"><a href="#cb375-8176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8177"><a href="#cb375-8177" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_non_purple_edges(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]):</span>
<span id="cb375-8178"><a href="#cb375-8178" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _find_non_purple_edges(node: <span class="bu">int</span>, sequence: List[<span class="bu">str</span>], path: List[<span class="bu">int</span>]):</span>
<span id="cb375-8179"><a href="#cb375-8179" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> colors[node] <span class="op">==</span> <span class="st">"purple"</span>:</span>
<span id="cb375-8180"><a href="#cb375-8180" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> child <span class="kw">in</span> tree[node]:</span>
<span id="cb375-8181"><a href="#cb375-8181" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> <span class="cf">from</span> _find_non_purple_edges(child[<span class="st">"n"</span>], sequence <span class="op">+</span> [child[<span class="st">"l"</span>]], path <span class="op">+</span> [node])</span>
<span id="cb375-8182"><a href="#cb375-8182" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-8183"><a href="#cb375-8183" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> colors[node] <span class="op">==</span> <span class="st">"red"</span>:</span>
<span id="cb375-8184"><a href="#cb375-8184" aria-hidden="true" tabindex="-1"></a>                sequence[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> sequence[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-8185"><a href="#cb375-8185" aria-hidden="true" tabindex="-1"></a>                joined_sequence <span class="op">=</span> <span class="st">""</span>.join(sequence)</span>
<span id="cb375-8186"><a href="#cb375-8186" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"#"</span> <span class="kw">not</span> <span class="kw">in</span> joined_sequence <span class="kw">and</span> <span class="st">"$"</span> <span class="kw">not</span> <span class="kw">in</span> joined_sequence:</span>
<span id="cb375-8187"><a href="#cb375-8187" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">yield</span> joined_sequence</span>
<span id="cb375-8188"><a href="#cb375-8188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8189"><a href="#cb375-8189" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="cf">from</span> _find_non_purple_edges(<span class="dv">0</span>, [], [])</span>
<span id="cb375-8190"><a href="#cb375-8190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8191"><a href="#cb375-8191" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_shortest_nonshared_substring(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-8192"><a href="#cb375-8192" aria-hidden="true" tabindex="-1"></a>    combined_sequence <span class="op">=</span> seq1 <span class="op">+</span> <span class="st">"$"</span> <span class="op">+</span> seq2 <span class="op">+</span> <span class="st">"#"</span></span>
<span id="cb375-8193"><a href="#cb375-8193" aria-hidden="true" tabindex="-1"></a>    suffix_tree <span class="op">=</span> create_suffix_tree(combined_sequence)</span>
<span id="cb375-8194"><a href="#cb375-8194" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> convert_to_graph(suffix_tree)</span>
<span id="cb375-8195"><a href="#cb375-8195" aria-hidden="true" tabindex="-1"></a>    initial_colors <span class="op">=</span> initialize_leaf_colors(graph)</span>
<span id="cb375-8196"><a href="#cb375-8196" aria-hidden="true" tabindex="-1"></a>    final_colors <span class="op">=</span> color_tree_nodes(graph, initial_colors)</span>
<span id="cb375-8197"><a href="#cb375-8197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(find_non_purple_edges(graph, final_colors), key<span class="op">=</span><span class="bu">len</span>)</span>
<span id="cb375-8198"><a href="#cb375-8198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8199"><a href="#cb375-8199" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-8200"><a href="#cb375-8200" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGCTGCTAGAGG</span></span>
<span id="cb375-8201"><a href="#cb375-8201" aria-hidden="true" tabindex="-1"></a><span class="st">CATGCTGGGCTGGCT</span></span>
<span id="cb375-8202"><a href="#cb375-8202" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-8203"><a href="#cb375-8203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8204"><a href="#cb375-8204" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-8205"><a href="#cb375-8205" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(find_shortest_nonshared_substring(sequence1, sequence2))</span>
<span id="cb375-8206"><a href="#cb375-8206" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8207"><a href="#cb375-8207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8208"><a href="#cb375-8208" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Suffix Array of a String</span></span>
<span id="cb375-8209"><a href="#cb375-8209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8210"><a href="#cb375-8210" aria-hidden="true" tabindex="-1"></a>Suffix Array Construction Problem. Construct the suffix array of a string.</span>
<span id="cb375-8211"><a href="#cb375-8211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8212"><a href="#cb375-8212" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb375-8213"><a href="#cb375-8213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8214"><a href="#cb375-8214" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>SuffixArray<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>).</span>
<span id="cb375-8215"><a href="#cb375-8215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8216"><a href="#cb375-8216" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8217"><a href="#cb375-8217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8218"><a href="#cb375-8218" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8219"><a href="#cb375-8219" aria-hidden="true" tabindex="-1"></a>AACGATAGCGGTAGA$</span>
<span id="cb375-8220"><a href="#cb375-8220" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8221"><a href="#cb375-8221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8222"><a href="#cb375-8222" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8223"><a href="#cb375-8223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8224"><a href="#cb375-8224" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8225"><a href="#cb375-8225" aria-hidden="true" tabindex="-1"></a><span class="dv">15</span>, <span class="dv">14</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">12</span>, <span class="dv">6</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">8</span>, <span class="dv">13</span>, <span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="dv">10</span>, <span class="dv">11</span>, <span class="dv">5</span></span>
<span id="cb375-8226"><a href="#cb375-8226" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8227"><a href="#cb375-8227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8228"><a href="#cb375-8228" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8229"><a href="#cb375-8229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8230"><a href="#cb375-8230" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8231"><a href="#cb375-8231" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb375-8232"><a href="#cb375-8232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8233"><a href="#cb375-8233" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-8234"><a href="#cb375-8234" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-8235"><a href="#cb375-8235" aria-hidden="true" tabindex="-1"></a><span class="st">    Create a suffix array for the given text.</span></span>
<span id="cb375-8236"><a href="#cb375-8236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8237"><a href="#cb375-8237" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-8238"><a href="#cb375-8238" aria-hidden="true" tabindex="-1"></a><span class="st">    text (str): The input string to create a suffix array for.</span></span>
<span id="cb375-8239"><a href="#cb375-8239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8240"><a href="#cb375-8240" aria-hidden="true" tabindex="-1"></a><span class="st">    Returns:</span></span>
<span id="cb375-8241"><a href="#cb375-8241" aria-hidden="true" tabindex="-1"></a><span class="st">    List[int]: A list of indices representing the suffix array.</span></span>
<span id="cb375-8242"><a href="#cb375-8242" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-8243"><a href="#cb375-8243" aria-hidden="true" tabindex="-1"></a>    suffixes <span class="op">=</span> [(i, text[i:]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))]</span>
<span id="cb375-8244"><a href="#cb375-8244" aria-hidden="true" tabindex="-1"></a>    sorted_suffixes <span class="op">=</span> <span class="bu">sorted</span>(suffixes, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb375-8245"><a href="#cb375-8245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [index <span class="cf">for</span> index, _ <span class="kw">in</span> sorted_suffixes]</span>
<span id="cb375-8246"><a href="#cb375-8246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8247"><a href="#cb375-8247" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"AACGATAGCGGTAGA$"</span></span>
<span id="cb375-8248"><a href="#cb375-8248" aria-hidden="true" tabindex="-1"></a>suffix_array <span class="op">=</span> create_suffix_array(sample_input.strip())</span>
<span id="cb375-8249"><a href="#cb375-8249" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>suffix_array, sep<span class="op">=</span><span class="st">", "</span>)</span>
<span id="cb375-8250"><a href="#cb375-8250" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8251"><a href="#cb375-8251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8252"><a href="#cb375-8252" aria-hidden="true" tabindex="-1"></a><span class="co"># Pattern Matching with the Suffix Array</span></span>
<span id="cb375-8253"><a href="#cb375-8253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8254"><a href="#cb375-8254" aria-hidden="true" tabindex="-1"></a>Multiple Pattern Matching <span class="cf">with</span> the Suffix Array.</span>
<span id="cb375-8255"><a href="#cb375-8255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8256"><a href="#cb375-8256" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;and a collection of strings&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb375-8257"><a href="#cb375-8257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8258"><a href="#cb375-8258" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All starting positions in&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;where a string from&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>&nbsp;appears <span class="im">as</span> a substring.</span>
<span id="cb375-8259"><a href="#cb375-8259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8260"><a href="#cb375-8260" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8261"><a href="#cb375-8261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8262"><a href="#cb375-8262" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8263"><a href="#cb375-8263" aria-hidden="true" tabindex="-1"></a>AATCGGGTTCAATCGGGGT</span>
<span id="cb375-8264"><a href="#cb375-8264" aria-hidden="true" tabindex="-1"></a>ATCG</span>
<span id="cb375-8265"><a href="#cb375-8265" aria-hidden="true" tabindex="-1"></a>GGGT</span>
<span id="cb375-8266"><a href="#cb375-8266" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8267"><a href="#cb375-8267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8268"><a href="#cb375-8268" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8269"><a href="#cb375-8269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8270"><a href="#cb375-8270" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8271"><a href="#cb375-8271" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">4</span> <span class="dv">11</span> <span class="dv">15</span></span>
<span id="cb375-8272"><a href="#cb375-8272" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8273"><a href="#cb375-8273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8274"><a href="#cb375-8274" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8275"><a href="#cb375-8275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8276"><a href="#cb375-8276" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8277"><a href="#cb375-8277" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb375-8278"><a href="#cb375-8278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8279"><a href="#cb375-8279" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-8280"><a href="#cb375-8280" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-8281"><a href="#cb375-8281" aria-hidden="true" tabindex="-1"></a><span class="st">    Create a suffix array for the given text.</span></span>
<span id="cb375-8282"><a href="#cb375-8282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8283"><a href="#cb375-8283" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-8284"><a href="#cb375-8284" aria-hidden="true" tabindex="-1"></a><span class="st">    text (str): The input string to create a suffix array for.</span></span>
<span id="cb375-8285"><a href="#cb375-8285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8286"><a href="#cb375-8286" aria-hidden="true" tabindex="-1"></a><span class="st">    Returns:</span></span>
<span id="cb375-8287"><a href="#cb375-8287" aria-hidden="true" tabindex="-1"></a><span class="st">    List[int]: A list of indices representing the suffix array.</span></span>
<span id="cb375-8288"><a href="#cb375-8288" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-8289"><a href="#cb375-8289" aria-hidden="true" tabindex="-1"></a>    suffixes: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(i, text[i:]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))]</span>
<span id="cb375-8290"><a href="#cb375-8290" aria-hidden="true" tabindex="-1"></a>    sorted_suffixes: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> <span class="bu">sorted</span>(suffixes, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb375-8291"><a href="#cb375-8291" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [index <span class="cf">for</span> index, _ <span class="kw">in</span> sorted_suffixes]</span>
<span id="cb375-8292"><a href="#cb375-8292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8293"><a href="#cb375-8293" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>, suffix_array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-8294"><a href="#cb375-8294" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-8295"><a href="#cb375-8295" aria-hidden="true" tabindex="-1"></a><span class="st">    Find all occurrences of a pattern in the text using the suffix array.</span></span>
<span id="cb375-8296"><a href="#cb375-8296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8297"><a href="#cb375-8297" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-8298"><a href="#cb375-8298" aria-hidden="true" tabindex="-1"></a><span class="st">    text (str): The input text to search in.</span></span>
<span id="cb375-8299"><a href="#cb375-8299" aria-hidden="true" tabindex="-1"></a><span class="st">    pattern (str): The pattern to search for.</span></span>
<span id="cb375-8300"><a href="#cb375-8300" aria-hidden="true" tabindex="-1"></a><span class="st">    suffix_array (List[int]): The suffix array of the text.</span></span>
<span id="cb375-8301"><a href="#cb375-8301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8302"><a href="#cb375-8302" aria-hidden="true" tabindex="-1"></a><span class="st">    Returns:</span></span>
<span id="cb375-8303"><a href="#cb375-8303" aria-hidden="true" tabindex="-1"></a><span class="st">    List[int]: A list of indices where the pattern occurs in the text.</span></span>
<span id="cb375-8304"><a href="#cb375-8304" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-8305"><a href="#cb375-8305" aria-hidden="true" tabindex="-1"></a>    lower_bound: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-8306"><a href="#cb375-8306" aria-hidden="true" tabindex="-1"></a>    upper_bound: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(text)</span>
<span id="cb375-8307"><a href="#cb375-8307" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8308"><a href="#cb375-8308" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> lower_bound <span class="op">&lt;</span> upper_bound:</span>
<span id="cb375-8309"><a href="#cb375-8309" aria-hidden="true" tabindex="-1"></a>        mid_point: <span class="bu">int</span> <span class="op">=</span> (lower_bound <span class="op">+</span> upper_bound) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb375-8310"><a href="#cb375-8310" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pattern <span class="op">&gt;</span> text[suffix_array[mid_point]:][: <span class="bu">len</span>(pattern)]:</span>
<span id="cb375-8311"><a href="#cb375-8311" aria-hidden="true" tabindex="-1"></a>            lower_bound <span class="op">=</span> mid_point <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-8312"><a href="#cb375-8312" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-8313"><a href="#cb375-8313" aria-hidden="true" tabindex="-1"></a>            upper_bound <span class="op">=</span> mid_point</span>
<span id="cb375-8314"><a href="#cb375-8314" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8315"><a href="#cb375-8315" aria-hidden="true" tabindex="-1"></a>    first_occurrence: <span class="bu">int</span> <span class="op">=</span> lower_bound</span>
<span id="cb375-8316"><a href="#cb375-8316" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> <span class="bu">len</span>(text)</span>
<span id="cb375-8317"><a href="#cb375-8317" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8318"><a href="#cb375-8318" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> lower_bound <span class="op">&lt;</span> upper_bound:</span>
<span id="cb375-8319"><a href="#cb375-8319" aria-hidden="true" tabindex="-1"></a>        mid_point: <span class="bu">int</span> <span class="op">=</span> (lower_bound <span class="op">+</span> upper_bound) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb375-8320"><a href="#cb375-8320" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pattern <span class="op">&lt;</span> text[suffix_array[mid_point]:][: <span class="bu">len</span>(pattern)]:</span>
<span id="cb375-8321"><a href="#cb375-8321" aria-hidden="true" tabindex="-1"></a>            upper_bound <span class="op">=</span> mid_point</span>
<span id="cb375-8322"><a href="#cb375-8322" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-8323"><a href="#cb375-8323" aria-hidden="true" tabindex="-1"></a>            lower_bound <span class="op">=</span> mid_point <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-8324"><a href="#cb375-8324" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8325"><a href="#cb375-8325" aria-hidden="true" tabindex="-1"></a>    last_occurrence: <span class="bu">int</span> <span class="op">=</span> upper_bound</span>
<span id="cb375-8326"><a href="#cb375-8326" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8327"><a href="#cb375-8327" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> first_occurrence <span class="op">&gt;</span> last_occurrence:</span>
<span id="cb375-8328"><a href="#cb375-8328" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb375-8329"><a href="#cb375-8329" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-8330"><a href="#cb375-8330" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">range</span>(first_occurrence, last_occurrence))</span>
<span id="cb375-8331"><a href="#cb375-8331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8332"><a href="#cb375-8332" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-8333"><a href="#cb375-8333" aria-hidden="true" tabindex="-1"></a><span class="st">AATCGGGTTCAATCGGGGT</span></span>
<span id="cb375-8334"><a href="#cb375-8334" aria-hidden="true" tabindex="-1"></a><span class="st">ATCG</span></span>
<span id="cb375-8335"><a href="#cb375-8335" aria-hidden="true" tabindex="-1"></a><span class="st">GGGT</span></span>
<span id="cb375-8336"><a href="#cb375-8336" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-8337"><a href="#cb375-8337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8338"><a href="#cb375-8338" aria-hidden="true" tabindex="-1"></a>sequence, <span class="op">*</span>patterns <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-8339"><a href="#cb375-8339" aria-hidden="true" tabindex="-1"></a>suffix_array: List[<span class="bu">int</span>] <span class="op">=</span> create_suffix_array(sequence)</span>
<span id="cb375-8340"><a href="#cb375-8340" aria-hidden="true" tabindex="-1"></a>matching_indices: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-8341"><a href="#cb375-8341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8342"><a href="#cb375-8342" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb375-8343"><a href="#cb375-8343" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index <span class="kw">in</span> find_pattern_occurrences(sequence, pattern, suffix_array):</span>
<span id="cb375-8344"><a href="#cb375-8344" aria-hidden="true" tabindex="-1"></a>        matching_indices.append(suffix_array[index])</span>
<span id="cb375-8345"><a href="#cb375-8345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8346"><a href="#cb375-8346" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(<span class="bu">set</span>(matching_indices)))</span>
<span id="cb375-8347"><a href="#cb375-8347" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8348"><a href="#cb375-8348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8349"><a href="#cb375-8349" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Burrows-Wheeler Transform of a String</span></span>
<span id="cb375-8350"><a href="#cb375-8350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8351"><a href="#cb375-8351" aria-hidden="true" tabindex="-1"></a>Burrows<span class="op">-</span>Wheeler Transform Construction Problem.Construct the Burrows<span class="op">-</span>Wheeler transform of a string.</span>
<span id="cb375-8352"><a href="#cb375-8352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8353"><a href="#cb375-8353" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb375-8354"><a href="#cb375-8354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8355"><a href="#cb375-8355" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>BWT<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>).</span>
<span id="cb375-8356"><a href="#cb375-8356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8357"><a href="#cb375-8357" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8358"><a href="#cb375-8358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8359"><a href="#cb375-8359" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8360"><a href="#cb375-8360" aria-hidden="true" tabindex="-1"></a>GCGTGCCTGGTCA$</span>
<span id="cb375-8361"><a href="#cb375-8361" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8362"><a href="#cb375-8362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8363"><a href="#cb375-8363" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8364"><a href="#cb375-8364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8365"><a href="#cb375-8365" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8366"><a href="#cb375-8366" aria-hidden="true" tabindex="-1"></a>ACTGGCT$TGCGGC</span>
<span id="cb375-8367"><a href="#cb375-8367" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8368"><a href="#cb375-8368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8369"><a href="#cb375-8369" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8370"><a href="#cb375-8370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8371"><a href="#cb375-8371" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8372"><a href="#cb375-8372" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb375-8373"><a href="#cb375-8373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8374"><a href="#cb375-8374" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-8375"><a href="#cb375-8375" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-8376"><a href="#cb375-8376" aria-hidden="true" tabindex="-1"></a><span class="st">    Create a suffix array for the given text.</span></span>
<span id="cb375-8377"><a href="#cb375-8377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8378"><a href="#cb375-8378" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-8379"><a href="#cb375-8379" aria-hidden="true" tabindex="-1"></a><span class="st">    text (str): The input string to create a suffix array for.</span></span>
<span id="cb375-8380"><a href="#cb375-8380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8381"><a href="#cb375-8381" aria-hidden="true" tabindex="-1"></a><span class="st">    Returns:</span></span>
<span id="cb375-8382"><a href="#cb375-8382" aria-hidden="true" tabindex="-1"></a><span class="st">    List[int]: A list of indices representing the suffix array.</span></span>
<span id="cb375-8383"><a href="#cb375-8383" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-8384"><a href="#cb375-8384" aria-hidden="true" tabindex="-1"></a>    suffixes <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">range</span>(<span class="bu">len</span>(text)), key<span class="op">=</span><span class="kw">lambda</span> i: text[i:])</span>
<span id="cb375-8385"><a href="#cb375-8385" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> suffixes</span>
<span id="cb375-8386"><a href="#cb375-8386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8387"><a href="#cb375-8387" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-8388"><a href="#cb375-8388" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-8389"><a href="#cb375-8389" aria-hidden="true" tabindex="-1"></a><span class="st">    Perform the Burrows-Wheeler Transform on the input sequence.</span></span>
<span id="cb375-8390"><a href="#cb375-8390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8391"><a href="#cb375-8391" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-8392"><a href="#cb375-8392" aria-hidden="true" tabindex="-1"></a><span class="st">    sequence (str): The input string to transform.</span></span>
<span id="cb375-8393"><a href="#cb375-8393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8394"><a href="#cb375-8394" aria-hidden="true" tabindex="-1"></a><span class="st">    Returns:</span></span>
<span id="cb375-8395"><a href="#cb375-8395" aria-hidden="true" tabindex="-1"></a><span class="st">    str: The Burrows-Wheeler Transform of the input sequence.</span></span>
<span id="cb375-8396"><a href="#cb375-8396" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-8397"><a href="#cb375-8397" aria-hidden="true" tabindex="-1"></a>    suffix_array <span class="op">=</span> create_suffix_array(sequence)</span>
<span id="cb375-8398"><a href="#cb375-8398" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(sequence[i <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> suffix_array)</span>
<span id="cb375-8399"><a href="#cb375-8399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8400"><a href="#cb375-8400" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"GCGTGCCTGGTCA$"</span></span>
<span id="cb375-8401"><a href="#cb375-8401" aria-hidden="true" tabindex="-1"></a>transformed_sequence <span class="op">=</span> burrows_wheeler_transform(sample_input.strip())</span>
<span id="cb375-8402"><a href="#cb375-8402" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(transformed_sequence)</span>
<span id="cb375-8403"><a href="#cb375-8403" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8404"><a href="#cb375-8404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8405"><a href="#cb375-8405" aria-hidden="true" tabindex="-1"></a><span class="co"># Reconstruct a String from its Burrows-Wheeler Transform</span></span>
<span id="cb375-8406"><a href="#cb375-8406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8407"><a href="#cb375-8407" aria-hidden="true" tabindex="-1"></a>Inverse Burrows<span class="op">-</span>Wheeler Transform Problem. Reconstruct a string <span class="im">from</span> its Burrows<span class="op">-</span>Wheeler transform.</span>
<span id="cb375-8408"><a href="#cb375-8408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8409"><a href="#cb375-8409" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Transform<span class="op">*</span>&nbsp;(<span class="cf">with</span> a single <span class="st">"$"</span> sign).</span>
<span id="cb375-8410"><a href="#cb375-8410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8411"><a href="#cb375-8411" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;such that&nbsp;<span class="op">*</span>BWT<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>) <span class="op">=</span>&nbsp;<span class="op">*</span>Transform<span class="op">*</span>.</span>
<span id="cb375-8412"><a href="#cb375-8412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8413"><a href="#cb375-8413" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8414"><a href="#cb375-8414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8415"><a href="#cb375-8415" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8416"><a href="#cb375-8416" aria-hidden="true" tabindex="-1"></a>TTCCTAACG$A</span>
<span id="cb375-8417"><a href="#cb375-8417" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8418"><a href="#cb375-8418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8419"><a href="#cb375-8419" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8420"><a href="#cb375-8420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8421"><a href="#cb375-8421" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8422"><a href="#cb375-8422" aria-hidden="true" tabindex="-1"></a>TACATCACGT$</span>
<span id="cb375-8423"><a href="#cb375-8423" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8424"><a href="#cb375-8424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8425"><a href="#cb375-8425" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8426"><a href="#cb375-8426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8427"><a href="#cb375-8427" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8428"><a href="#cb375-8428" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-8429"><a href="#cb375-8429" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Generator</span>
<span id="cb375-8430"><a href="#cb375-8430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8431"><a href="#cb375-8431" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> index_characters(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-8432"><a href="#cb375-8432" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-8433"><a href="#cb375-8433" aria-hidden="true" tabindex="-1"></a><span class="st">    Generate each character with its occurrence number in the sequence.</span></span>
<span id="cb375-8434"><a href="#cb375-8434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8435"><a href="#cb375-8435" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-8436"><a href="#cb375-8436" aria-hidden="true" tabindex="-1"></a><span class="st">    sequence (str): The input string to index.</span></span>
<span id="cb375-8437"><a href="#cb375-8437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8438"><a href="#cb375-8438" aria-hidden="true" tabindex="-1"></a><span class="st">    Yields:</span></span>
<span id="cb375-8439"><a href="#cb375-8439" aria-hidden="true" tabindex="-1"></a><span class="st">    Tuple[str, int]: A tuple containing the character and its occurrence number.</span></span>
<span id="cb375-8440"><a href="#cb375-8440" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-8441"><a href="#cb375-8441" aria-hidden="true" tabindex="-1"></a>    char_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb375-8442"><a href="#cb375-8442" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> sequence:</span>
<span id="cb375-8443"><a href="#cb375-8443" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> char, char_counts[char]</span>
<span id="cb375-8444"><a href="#cb375-8444" aria-hidden="true" tabindex="-1"></a>        char_counts[char] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-8445"><a href="#cb375-8445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8446"><a href="#cb375-8446" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform_inverse(bwt_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-8447"><a href="#cb375-8447" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-8448"><a href="#cb375-8448" aria-hidden="true" tabindex="-1"></a><span class="st">    Perform the inverse Burrows-Wheeler Transform on the input sequence.</span></span>
<span id="cb375-8449"><a href="#cb375-8449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8450"><a href="#cb375-8450" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-8451"><a href="#cb375-8451" aria-hidden="true" tabindex="-1"></a><span class="st">    bwt_sequence (str): The Burrows-Wheeler transformed string.</span></span>
<span id="cb375-8452"><a href="#cb375-8452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8453"><a href="#cb375-8453" aria-hidden="true" tabindex="-1"></a><span class="st">    Returns:</span></span>
<span id="cb375-8454"><a href="#cb375-8454" aria-hidden="true" tabindex="-1"></a><span class="st">    str: The original string before BWT.</span></span>
<span id="cb375-8455"><a href="#cb375-8455" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-8456"><a href="#cb375-8456" aria-hidden="true" tabindex="-1"></a>    first_column <span class="op">=</span> <span class="bu">list</span>(index_characters(<span class="bu">sorted</span>(bwt_sequence)))</span>
<span id="cb375-8457"><a href="#cb375-8457" aria-hidden="true" tabindex="-1"></a>    last_column <span class="op">=</span> <span class="bu">list</span>(index_characters(bwt_sequence))</span>
<span id="cb375-8458"><a href="#cb375-8458" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8459"><a href="#cb375-8459" aria-hidden="true" tabindex="-1"></a>    current_char: Tuple[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> (<span class="st">"$"</span>, <span class="dv">0</span>)</span>
<span id="cb375-8460"><a href="#cb375-8460" aria-hidden="true" tabindex="-1"></a>    original_sequence: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb375-8461"><a href="#cb375-8461" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8462"><a href="#cb375-8462" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(bwt_sequence)):</span>
<span id="cb375-8463"><a href="#cb375-8463" aria-hidden="true" tabindex="-1"></a>        current_char <span class="op">=</span> first_column[last_column.index(current_char)]</span>
<span id="cb375-8464"><a href="#cb375-8464" aria-hidden="true" tabindex="-1"></a>        original_sequence.append(current_char[<span class="dv">0</span>])</span>
<span id="cb375-8465"><a href="#cb375-8465" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8466"><a href="#cb375-8466" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(original_sequence)</span>
<span id="cb375-8467"><a href="#cb375-8467" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8468"><a href="#cb375-8468" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"TTCCTAACG$A"</span></span>
<span id="cb375-8469"><a href="#cb375-8469" aria-hidden="true" tabindex="-1"></a>original_sequence <span class="op">=</span> burrows_wheeler_transform_inverse(sample_input.strip())</span>
<span id="cb375-8470"><a href="#cb375-8470" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(original_sequence)</span>
<span id="cb375-8471"><a href="#cb375-8471" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8472"><a href="#cb375-8472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8473"><a href="#cb375-8473" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the Last-to-First Mapping of a String</span></span>
<span id="cb375-8474"><a href="#cb375-8474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8475"><a href="#cb375-8475" aria-hidden="true" tabindex="-1"></a> Last<span class="op">-</span>to<span class="op">-</span>First Mapping Problem.</span>
<span id="cb375-8476"><a href="#cb375-8476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8477"><a href="#cb375-8477" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Transform<span class="op">*</span>&nbsp;and an integer&nbsp;<span class="op">*</span>i<span class="op">*</span>.</span>
<span id="cb375-8478"><a href="#cb375-8478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8479"><a href="#cb375-8479" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The position&nbsp;<span class="op">*</span>LastToFirst<span class="op">*</span>(<span class="op">*</span>i<span class="op">*</span>) in&nbsp;<span class="op">*</span>FirstColumn<span class="op">*</span>&nbsp;in the Burrows<span class="op">-</span>Wheeler matrix if&nbsp;<span class="op">*</span>LastColumn<span class="op">*</span>&nbsp;<span class="op">=</span>&nbsp;<span class="op">*</span>Transform<span class="op">*</span>.</span>
<span id="cb375-8480"><a href="#cb375-8480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8481"><a href="#cb375-8481" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8482"><a href="#cb375-8482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8483"><a href="#cb375-8483" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8484"><a href="#cb375-8484" aria-hidden="true" tabindex="-1"></a>T$GACCA</span>
<span id="cb375-8485"><a href="#cb375-8485" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span>
<span id="cb375-8486"><a href="#cb375-8486" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8487"><a href="#cb375-8487" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8488"><a href="#cb375-8488" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8489"><a href="#cb375-8489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8490"><a href="#cb375-8490" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8491"><a href="#cb375-8491" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb375-8492"><a href="#cb375-8492" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8493"><a href="#cb375-8493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8494"><a href="#cb375-8494" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8495"><a href="#cb375-8495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8496"><a href="#cb375-8496" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8497"><a href="#cb375-8497" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-8498"><a href="#cb375-8498" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Generator</span>
<span id="cb375-8499"><a href="#cb375-8499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8500"><a href="#cb375-8500" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> index_characters(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb375-8501"><a href="#cb375-8501" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-8502"><a href="#cb375-8502" aria-hidden="true" tabindex="-1"></a><span class="st">    Generate each character with its occurrence number in the sequence.</span></span>
<span id="cb375-8503"><a href="#cb375-8503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8504"><a href="#cb375-8504" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-8505"><a href="#cb375-8505" aria-hidden="true" tabindex="-1"></a><span class="st">    sequence (str): The input string to index.</span></span>
<span id="cb375-8506"><a href="#cb375-8506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8507"><a href="#cb375-8507" aria-hidden="true" tabindex="-1"></a><span class="st">    Yields:</span></span>
<span id="cb375-8508"><a href="#cb375-8508" aria-hidden="true" tabindex="-1"></a><span class="st">    Tuple[str, int]: A tuple containing the character and its occurrence number.</span></span>
<span id="cb375-8509"><a href="#cb375-8509" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-8510"><a href="#cb375-8510" aria-hidden="true" tabindex="-1"></a>    char_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb375-8511"><a href="#cb375-8511" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> sequence:</span>
<span id="cb375-8512"><a href="#cb375-8512" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> char, char_counts[char]</span>
<span id="cb375-8513"><a href="#cb375-8513" aria-hidden="true" tabindex="-1"></a>        char_counts[char] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-8514"><a href="#cb375-8514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8515"><a href="#cb375-8515" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> last_to_first_mapping(sequence: <span class="bu">str</span>, index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-8516"><a href="#cb375-8516" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-8517"><a href="#cb375-8517" aria-hidden="true" tabindex="-1"></a><span class="st">    Find the mapping from Last column to First column in the Burrows-Wheeler Transform matrix.</span></span>
<span id="cb375-8518"><a href="#cb375-8518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8519"><a href="#cb375-8519" aria-hidden="true" tabindex="-1"></a><span class="st">    Args:</span></span>
<span id="cb375-8520"><a href="#cb375-8520" aria-hidden="true" tabindex="-1"></a><span class="st">    sequence (str): The input string (Last column of BWT matrix).</span></span>
<span id="cb375-8521"><a href="#cb375-8521" aria-hidden="true" tabindex="-1"></a><span class="st">    index (int): The index in the Last column.</span></span>
<span id="cb375-8522"><a href="#cb375-8522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8523"><a href="#cb375-8523" aria-hidden="true" tabindex="-1"></a><span class="st">    Returns:</span></span>
<span id="cb375-8524"><a href="#cb375-8524" aria-hidden="true" tabindex="-1"></a><span class="st">    int: The corresponding index in the First column.</span></span>
<span id="cb375-8525"><a href="#cb375-8525" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-8526"><a href="#cb375-8526" aria-hidden="true" tabindex="-1"></a>    first_column <span class="op">=</span> <span class="bu">list</span>(index_characters(<span class="bu">sorted</span>(sequence)))</span>
<span id="cb375-8527"><a href="#cb375-8527" aria-hidden="true" tabindex="-1"></a>    last_column <span class="op">=</span> <span class="bu">list</span>(index_characters(sequence))</span>
<span id="cb375-8528"><a href="#cb375-8528" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> first_column.index(last_column[index])</span>
<span id="cb375-8529"><a href="#cb375-8529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8530"><a href="#cb375-8530" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-8531"><a href="#cb375-8531" aria-hidden="true" tabindex="-1"></a><span class="st">T$GACCA</span></span>
<span id="cb375-8532"><a href="#cb375-8532" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb375-8533"><a href="#cb375-8533" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-8534"><a href="#cb375-8534" aria-hidden="true" tabindex="-1"></a>sequence, index_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-8535"><a href="#cb375-8535" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> <span class="bu">int</span>(index_str)</span>
<span id="cb375-8536"><a href="#cb375-8536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8537"><a href="#cb375-8537" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> last_to_first_mapping(sequence.strip(), index)</span>
<span id="cb375-8538"><a href="#cb375-8538" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-8539"><a href="#cb375-8539" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8540"><a href="#cb375-8540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8541"><a href="#cb375-8541" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement BWMatching</span></span>
<span id="cb375-8542"><a href="#cb375-8542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8543"><a href="#cb375-8543" aria-hidden="true" tabindex="-1"></a>Implement. BWMatching.</span>
<span id="cb375-8544"><a href="#cb375-8544" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8545"><a href="#cb375-8545" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>BWT<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>), followed by a collection of strings&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb375-8546"><a href="#cb375-8546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8547"><a href="#cb375-8547" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A <span class="bu">list</span> of integers, where the&nbsp;<span class="op">*</span>i<span class="op">*-</span>th integer corresponds to the number of substring matches of the&nbsp;<span class="op">*</span>i<span class="op">*-</span>th member of&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>&nbsp;in&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb375-8548"><a href="#cb375-8548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8549"><a href="#cb375-8549" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8550"><a href="#cb375-8550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8551"><a href="#cb375-8551" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8552"><a href="#cb375-8552" aria-hidden="true" tabindex="-1"></a>TCCTCTATGAGATCCTATTCTATGAAACCTTCA$GACCAAAATTCTCCGGC</span>
<span id="cb375-8553"><a href="#cb375-8553" aria-hidden="true" tabindex="-1"></a>CCT CAC GAG CAG ATC</span>
<span id="cb375-8554"><a href="#cb375-8554" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8555"><a href="#cb375-8555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8556"><a href="#cb375-8556" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8557"><a href="#cb375-8557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8558"><a href="#cb375-8558" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8559"><a href="#cb375-8559" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span></span>
<span id="cb375-8560"><a href="#cb375-8560" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8561"><a href="#cb375-8561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8562"><a href="#cb375-8562" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8563"><a href="#cb375-8563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8564"><a href="#cb375-8564" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8565"><a href="#cb375-8565" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-8566"><a href="#cb375-8566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8567"><a href="#cb375-8567" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> BWMatching(bwt: <span class="bu">str</span>, patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-8568"><a href="#cb375-8568" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_count_and_first_occurrence(bwt: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]], Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-8569"><a href="#cb375-8569" aria-hidden="true" tabindex="-1"></a>        count: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {char: [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(bwt) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> char <span class="kw">in</span> <span class="bu">set</span>(bwt)}</span>
<span id="cb375-8570"><a href="#cb375-8570" aria-hidden="true" tabindex="-1"></a>        first_occurrence: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb375-8571"><a href="#cb375-8571" aria-hidden="true" tabindex="-1"></a>        sorted_bwt: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">sorted</span>(bwt)</span>
<span id="cb375-8572"><a href="#cb375-8572" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-8573"><a href="#cb375-8573" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(bwt):</span>
<span id="cb375-8574"><a href="#cb375-8574" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> c <span class="kw">in</span> count:</span>
<span id="cb375-8575"><a href="#cb375-8575" aria-hidden="true" tabindex="-1"></a>                count[c][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> count[c][i]</span>
<span id="cb375-8576"><a href="#cb375-8576" aria-hidden="true" tabindex="-1"></a>            count[char][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-8577"><a href="#cb375-8577" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-8578"><a href="#cb375-8578" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sorted_bwt):</span>
<span id="cb375-8579"><a href="#cb375-8579" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="kw">not</span> <span class="kw">in</span> first_occurrence:</span>
<span id="cb375-8580"><a href="#cb375-8580" aria-hidden="true" tabindex="-1"></a>                first_occurrence[char] <span class="op">=</span> i</span>
<span id="cb375-8581"><a href="#cb375-8581" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-8582"><a href="#cb375-8582" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> count, first_occurrence</span>
<span id="cb375-8583"><a href="#cb375-8583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8584"><a href="#cb375-8584" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> count_matches(pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-8585"><a href="#cb375-8585" aria-hidden="true" tabindex="-1"></a>        top: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-8586"><a href="#cb375-8586" aria-hidden="true" tabindex="-1"></a>        bottom: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(bwt) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-8587"><a href="#cb375-8587" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> top <span class="op">&lt;=</span> bottom:</span>
<span id="cb375-8588"><a href="#cb375-8588" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pattern:</span>
<span id="cb375-8589"><a href="#cb375-8589" aria-hidden="true" tabindex="-1"></a>                symbol: <span class="bu">str</span> <span class="op">=</span> pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-8590"><a href="#cb375-8590" aria-hidden="true" tabindex="-1"></a>                pattern <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-8591"><a href="#cb375-8591" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> symbol <span class="kw">in</span> bwt[top:bottom<span class="op">+</span><span class="dv">1</span>]:</span>
<span id="cb375-8592"><a href="#cb375-8592" aria-hidden="true" tabindex="-1"></a>                    top <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count[symbol][top]</span>
<span id="cb375-8593"><a href="#cb375-8593" aria-hidden="true" tabindex="-1"></a>                    bottom <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count[symbol][bottom<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-8594"><a href="#cb375-8594" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-8595"><a href="#cb375-8595" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb375-8596"><a href="#cb375-8596" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-8597"><a href="#cb375-8597" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> bottom <span class="op">-</span> top <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-8598"><a href="#cb375-8598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8599"><a href="#cb375-8599" aria-hidden="true" tabindex="-1"></a>    count, first_occurrence <span class="op">=</span> create_count_and_first_occurrence(bwt)</span>
<span id="cb375-8600"><a href="#cb375-8600" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_matches(pattern) <span class="cf">for</span> pattern <span class="kw">in</span> patterns]</span>
<span id="cb375-8601"><a href="#cb375-8601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8602"><a href="#cb375-8602" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb375-8603"><a href="#cb375-8603" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-8604"><a href="#cb375-8604" aria-hidden="true" tabindex="-1"></a><span class="st">TCCTCTATGAGATCCTATTCTATGAAACCTTCA$GACCAAAATTCTCCGGC</span></span>
<span id="cb375-8605"><a href="#cb375-8605" aria-hidden="true" tabindex="-1"></a><span class="st">CCT CAC GAG CAG ATC</span></span>
<span id="cb375-8606"><a href="#cb375-8606" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-8607"><a href="#cb375-8607" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8608"><a href="#cb375-8608" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-8609"><a href="#cb375-8609" aria-hidden="true" tabindex="-1"></a>bwt: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-8610"><a href="#cb375-8610" aria-hidden="true" tabindex="-1"></a>patterns: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>].split()</span>
<span id="cb375-8611"><a href="#cb375-8611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8612"><a href="#cb375-8612" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the BWMatching algorithm</span></span>
<span id="cb375-8613"><a href="#cb375-8613" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> BWMatching(bwt, patterns)</span>
<span id="cb375-8614"><a href="#cb375-8614" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb375-8615"><a href="#cb375-8615" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8616"><a href="#cb375-8616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8617"><a href="#cb375-8617" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement BetterBWMatching</span></span>
<span id="cb375-8618"><a href="#cb375-8618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8619"><a href="#cb375-8619" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>BWT<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>), followed by a collection of strings&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb375-8620"><a href="#cb375-8620" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8621"><a href="#cb375-8621" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A <span class="bu">list</span> of integers, where the&nbsp;<span class="op">*</span>i<span class="op">*-</span>th integer corresponds to the number of substring matches of the&nbsp;<span class="op">*</span>i<span class="op">*-</span>th member of&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>&nbsp;in&nbsp;<span class="op">*</span>Text<span class="op">*</span>.</span>
<span id="cb375-8622"><a href="#cb375-8622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8623"><a href="#cb375-8623" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8624"><a href="#cb375-8624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8625"><a href="#cb375-8625" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8626"><a href="#cb375-8626" aria-hidden="true" tabindex="-1"></a>GGCGCCGC$TAGTCACACACGCCGTA</span>
<span id="cb375-8627"><a href="#cb375-8627" aria-hidden="true" tabindex="-1"></a>ACC CCG CAG</span>
<span id="cb375-8628"><a href="#cb375-8628" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8629"><a href="#cb375-8629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8630"><a href="#cb375-8630" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8631"><a href="#cb375-8631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8632"><a href="#cb375-8632" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8633"><a href="#cb375-8633" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span></span>
<span id="cb375-8634"><a href="#cb375-8634" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8635"><a href="#cb375-8635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8636"><a href="#cb375-8636" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8637"><a href="#cb375-8637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8638"><a href="#cb375-8638" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8639"><a href="#cb375-8639" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-8640"><a href="#cb375-8640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8641"><a href="#cb375-8641" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> BetterBWMatching(bwt: <span class="bu">str</span>, patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-8642"><a href="#cb375-8642" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preprocess_bwt(bwt: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">str</span>], Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]], Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-8643"><a href="#cb375-8643" aria-hidden="true" tabindex="-1"></a>        first_column: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">sorted</span>(bwt)</span>
<span id="cb375-8644"><a href="#cb375-8644" aria-hidden="true" tabindex="-1"></a>        count: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {char: [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(bwt) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> char <span class="kw">in</span> <span class="bu">set</span>(bwt)}</span>
<span id="cb375-8645"><a href="#cb375-8645" aria-hidden="true" tabindex="-1"></a>        start_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {char: first_column.index(char) <span class="cf">for</span> char <span class="kw">in</span> <span class="bu">set</span>(bwt)}</span>
<span id="cb375-8646"><a href="#cb375-8646" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-8647"><a href="#cb375-8647" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(bwt):</span>
<span id="cb375-8648"><a href="#cb375-8648" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> c <span class="kw">in</span> count:</span>
<span id="cb375-8649"><a href="#cb375-8649" aria-hidden="true" tabindex="-1"></a>                count[c][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> count[c][i]</span>
<span id="cb375-8650"><a href="#cb375-8650" aria-hidden="true" tabindex="-1"></a>            count[char][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-8651"><a href="#cb375-8651" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-8652"><a href="#cb375-8652" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> first_column, count, start_index</span>
<span id="cb375-8653"><a href="#cb375-8653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8654"><a href="#cb375-8654" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> count_occurrences(pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-8655"><a href="#cb375-8655" aria-hidden="true" tabindex="-1"></a>        top: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-8656"><a href="#cb375-8656" aria-hidden="true" tabindex="-1"></a>        bottom: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(bwt) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-8657"><a href="#cb375-8657" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-8658"><a href="#cb375-8658" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> top <span class="op">&lt;=</span> bottom:</span>
<span id="cb375-8659"><a href="#cb375-8659" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pattern:</span>
<span id="cb375-8660"><a href="#cb375-8660" aria-hidden="true" tabindex="-1"></a>                symbol: <span class="bu">str</span> <span class="op">=</span> pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-8661"><a href="#cb375-8661" aria-hidden="true" tabindex="-1"></a>                pattern <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-8662"><a href="#cb375-8662" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> symbol <span class="kw">in</span> bwt[top:bottom<span class="op">+</span><span class="dv">1</span>]:</span>
<span id="cb375-8663"><a href="#cb375-8663" aria-hidden="true" tabindex="-1"></a>                    top <span class="op">=</span> start_index[symbol] <span class="op">+</span> count[symbol][top]</span>
<span id="cb375-8664"><a href="#cb375-8664" aria-hidden="true" tabindex="-1"></a>                    bottom <span class="op">=</span> start_index[symbol] <span class="op">+</span> count[symbol][bottom<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-8665"><a href="#cb375-8665" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-8666"><a href="#cb375-8666" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb375-8667"><a href="#cb375-8667" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-8668"><a href="#cb375-8668" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> bottom <span class="op">-</span> top <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-8669"><a href="#cb375-8669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8670"><a href="#cb375-8670" aria-hidden="true" tabindex="-1"></a>    first_column, count, start_index <span class="op">=</span> preprocess_bwt(bwt)</span>
<span id="cb375-8671"><a href="#cb375-8671" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_occurrences(pattern) <span class="cf">for</span> pattern <span class="kw">in</span> patterns]</span>
<span id="cb375-8672"><a href="#cb375-8672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8673"><a href="#cb375-8673" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb375-8674"><a href="#cb375-8674" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-8675"><a href="#cb375-8675" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGCCGC$TAGTCACACACGCCGTA</span></span>
<span id="cb375-8676"><a href="#cb375-8676" aria-hidden="true" tabindex="-1"></a><span class="st">ACC CCG CAG</span></span>
<span id="cb375-8677"><a href="#cb375-8677" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-8678"><a href="#cb375-8678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8679"><a href="#cb375-8679" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-8680"><a href="#cb375-8680" aria-hidden="true" tabindex="-1"></a>bwt: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-8681"><a href="#cb375-8681" aria-hidden="true" tabindex="-1"></a>patterns: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>].split()</span>
<span id="cb375-8682"><a href="#cb375-8682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8683"><a href="#cb375-8683" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the BetterBWMatching algorithm</span></span>
<span id="cb375-8684"><a href="#cb375-8684" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> BetterBWMatching(bwt, patterns)</span>
<span id="cb375-8685"><a href="#cb375-8685" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span>
<span id="cb375-8686"><a href="#cb375-8686" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8687"><a href="#cb375-8687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8688"><a href="#cb375-8688" aria-hidden="true" tabindex="-1"></a><span class="co"># Find All Occurrences of a Collection of Patterns in a String</span></span>
<span id="cb375-8689"><a href="#cb375-8689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8690"><a href="#cb375-8690" aria-hidden="true" tabindex="-1"></a>Multiple Pattern Matching Problem. Find <span class="bu">all</span> occurrences of a collection of patterns <span class="kw">in</span> a text.</span>
<span id="cb375-8691"><a href="#cb375-8691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8692"><a href="#cb375-8692" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;and a collection of strings&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>.</span>
<span id="cb375-8693"><a href="#cb375-8693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8694"><a href="#cb375-8694" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All starting positions in&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;where a string from&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>&nbsp;appears <span class="im">as</span> a substring.</span>
<span id="cb375-8695"><a href="#cb375-8695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8696"><a href="#cb375-8696" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8697"><a href="#cb375-8697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8698"><a href="#cb375-8698" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8699"><a href="#cb375-8699" aria-hidden="true" tabindex="-1"></a>AATCGGGTTCAATCGGGGT</span>
<span id="cb375-8700"><a href="#cb375-8700" aria-hidden="true" tabindex="-1"></a>ATCG</span>
<span id="cb375-8701"><a href="#cb375-8701" aria-hidden="true" tabindex="-1"></a>GGGT</span>
<span id="cb375-8702"><a href="#cb375-8702" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8703"><a href="#cb375-8703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8704"><a href="#cb375-8704" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8705"><a href="#cb375-8705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8706"><a href="#cb375-8706" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8707"><a href="#cb375-8707" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="dv">4</span> <span class="dv">11</span> <span class="dv">15</span></span>
<span id="cb375-8708"><a href="#cb375-8708" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8709"><a href="#cb375-8709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8710"><a href="#cb375-8710" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8711"><a href="#cb375-8711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8712"><a href="#cb375-8712" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8713"><a href="#cb375-8713" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-8714"><a href="#cb375-8714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8715"><a href="#cb375-8715" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform(text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-8716"><a href="#cb375-8716" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(text)</span>
<span id="cb375-8717"><a href="#cb375-8717" aria-hidden="true" tabindex="-1"></a>    rotations <span class="op">=</span> <span class="bu">sorted</span>([text[i:] <span class="op">+</span> text[:i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)])</span>
<span id="cb375-8718"><a href="#cb375-8718" aria-hidden="true" tabindex="-1"></a>    bwt <span class="op">=</span> <span class="st">''</span>.join([rot[<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> rot <span class="kw">in</span> rotations])</span>
<span id="cb375-8719"><a href="#cb375-8719" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bwt</span>
<span id="cb375-8720"><a href="#cb375-8720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8721"><a href="#cb375-8721" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_checkpoint_array(bwt: <span class="bu">str</span>, checkpoint_interval: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-8722"><a href="#cb375-8722" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(bwt))</span>
<span id="cb375-8723"><a href="#cb375-8723" aria-hidden="true" tabindex="-1"></a>    checkpoint_array <span class="op">=</span> {}</span>
<span id="cb375-8724"><a href="#cb375-8724" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(bwt), checkpoint_interval):</span>
<span id="cb375-8725"><a href="#cb375-8725" aria-hidden="true" tabindex="-1"></a>        checkpoint_array[idx] <span class="op">=</span> {symbol: bwt[:idx].count(symbol) <span class="cf">for</span> symbol <span class="kw">in</span> symbols}</span>
<span id="cb375-8726"><a href="#cb375-8726" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> checkpoint_array</span>
<span id="cb375-8727"><a href="#cb375-8727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8728"><a href="#cb375-8728" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_symbol(checkpoint_array: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]], idx: <span class="bu">int</span>, last_column: <span class="bu">str</span>, symbol: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-8729"><a href="#cb375-8729" aria-hidden="true" tabindex="-1"></a>    checkpoints <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> checkpoint_array.keys() <span class="cf">if</span> x <span class="op">&lt;=</span> idx]</span>
<span id="cb375-8730"><a href="#cb375-8730" aria-hidden="true" tabindex="-1"></a>    nearest_checkpoint <span class="op">=</span> <span class="bu">max</span>(checkpoints)</span>
<span id="cb375-8731"><a href="#cb375-8731" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> checkpoint_array[nearest_checkpoint][symbol]</span>
<span id="cb375-8732"><a href="#cb375-8732" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> last_column[nearest_checkpoint:idx].count(symbol)</span>
<span id="cb375-8733"><a href="#cb375-8733" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count</span>
<span id="cb375-8734"><a href="#cb375-8734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8735"><a href="#cb375-8735" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_partial_suffix_array(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-8736"><a href="#cb375-8736" aria-hidden="true" tabindex="-1"></a>    suffixes <span class="op">=</span> [(text[i:], i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))]</span>
<span id="cb375-8737"><a href="#cb375-8737" aria-hidden="true" tabindex="-1"></a>    sorted_suffixes <span class="op">=</span> <span class="bu">sorted</span>(suffixes)</span>
<span id="cb375-8738"><a href="#cb375-8738" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {i: pos <span class="cf">for</span> i, (_, pos) <span class="kw">in</span> <span class="bu">enumerate</span>(sorted_suffixes) <span class="cf">if</span> pos <span class="op">%</span> k <span class="op">==</span> <span class="dv">0</span>}</span>
<span id="cb375-8739"><a href="#cb375-8739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8740"><a href="#cb375-8740" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiple_pattern_matching(first_occurrence: Dict[<span class="bu">str</span>, <span class="bu">int</span>], last_column: <span class="bu">str</span>, pattern: <span class="bu">str</span>, checkpoint_array: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-8741"><a href="#cb375-8741" aria-hidden="true" tabindex="-1"></a>    top <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-8742"><a href="#cb375-8742" aria-hidden="true" tabindex="-1"></a>    bottom <span class="op">=</span> <span class="bu">len</span>(last_column) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-8743"><a href="#cb375-8743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8744"><a href="#cb375-8744" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> top <span class="op">&lt;=</span> bottom:</span>
<span id="cb375-8745"><a href="#cb375-8745" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pattern:</span>
<span id="cb375-8746"><a href="#cb375-8746" aria-hidden="true" tabindex="-1"></a>            symbol <span class="op">=</span> pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-8747"><a href="#cb375-8747" aria-hidden="true" tabindex="-1"></a>            pattern <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-8748"><a href="#cb375-8748" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> symbol <span class="kw">in</span> last_column[top: bottom <span class="op">+</span> <span class="dv">1</span>]:</span>
<span id="cb375-8749"><a href="#cb375-8749" aria-hidden="true" tabindex="-1"></a>                top <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count_symbol(checkpoint_array, top, last_column, symbol)</span>
<span id="cb375-8750"><a href="#cb375-8750" aria-hidden="true" tabindex="-1"></a>                bottom <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count_symbol(checkpoint_array, bottom <span class="op">+</span> <span class="dv">1</span>, last_column, symbol) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-8751"><a href="#cb375-8751" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-8752"><a href="#cb375-8752" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span></span>
<span id="cb375-8753"><a href="#cb375-8753" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-8754"><a href="#cb375-8754" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> top, bottom</span>
<span id="cb375-8755"><a href="#cb375-8755" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span></span>
<span id="cb375-8756"><a href="#cb375-8756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8757"><a href="#cb375-8757" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_occurrences(text: <span class="bu">str</span>, patterns: List[<span class="bu">str</span>], checkpoint_interval: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-8758"><a href="#cb375-8758" aria-hidden="true" tabindex="-1"></a>    bwt <span class="op">=</span> burrows_wheeler_transform(text <span class="op">+</span> <span class="st">'$'</span>)</span>
<span id="cb375-8759"><a href="#cb375-8759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8760"><a href="#cb375-8760" aria-hidden="true" tabindex="-1"></a>    first_occurrence <span class="op">=</span> {}</span>
<span id="cb375-8761"><a href="#cb375-8761" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">sorted</span>(bwt)):</span>
<span id="cb375-8762"><a href="#cb375-8762" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> symbol <span class="kw">not</span> <span class="kw">in</span> first_occurrence:</span>
<span id="cb375-8763"><a href="#cb375-8763" aria-hidden="true" tabindex="-1"></a>            first_occurrence[symbol] <span class="op">=</span> idx</span>
<span id="cb375-8764"><a href="#cb375-8764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8765"><a href="#cb375-8765" aria-hidden="true" tabindex="-1"></a>    checkpoint_array <span class="op">=</span> create_checkpoint_array(bwt, checkpoint_interval)</span>
<span id="cb375-8766"><a href="#cb375-8766" aria-hidden="true" tabindex="-1"></a>    partial_suffix_array <span class="op">=</span> create_partial_suffix_array(text <span class="op">+</span> <span class="st">'$'</span>, checkpoint_interval)</span>
<span id="cb375-8767"><a href="#cb375-8767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8768"><a href="#cb375-8768" aria-hidden="true" tabindex="-1"></a>    positions <span class="op">=</span> []</span>
<span id="cb375-8769"><a href="#cb375-8769" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb375-8770"><a href="#cb375-8770" aria-hidden="true" tabindex="-1"></a>        top, bottom <span class="op">=</span> multiple_pattern_matching(first_occurrence, bwt, pattern, checkpoint_array)</span>
<span id="cb375-8771"><a href="#cb375-8771" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> top <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb375-8772"><a href="#cb375-8772" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(top, bottom <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-8773"><a href="#cb375-8773" aria-hidden="true" tabindex="-1"></a>                offset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-8774"><a href="#cb375-8774" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> idx <span class="kw">not</span> <span class="kw">in</span> partial_suffix_array:</span>
<span id="cb375-8775"><a href="#cb375-8775" aria-hidden="true" tabindex="-1"></a>                    idx <span class="op">=</span> first_occurrence[bwt[idx]] <span class="op">+</span> count_symbol(checkpoint_array, idx, bwt, bwt[idx])</span>
<span id="cb375-8776"><a href="#cb375-8776" aria-hidden="true" tabindex="-1"></a>                    offset <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-8777"><a href="#cb375-8777" aria-hidden="true" tabindex="-1"></a>                positions.append(partial_suffix_array[idx] <span class="op">+</span> offset)</span>
<span id="cb375-8778"><a href="#cb375-8778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8779"><a href="#cb375-8779" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(positions)</span>
<span id="cb375-8780"><a href="#cb375-8780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8781"><a href="#cb375-8781" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb375-8782"><a href="#cb375-8782" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-8783"><a href="#cb375-8783" aria-hidden="true" tabindex="-1"></a><span class="st">AATCGGGTTCAATCGGGGT</span></span>
<span id="cb375-8784"><a href="#cb375-8784" aria-hidden="true" tabindex="-1"></a><span class="st">ATCG</span></span>
<span id="cb375-8785"><a href="#cb375-8785" aria-hidden="true" tabindex="-1"></a><span class="st">GGGT</span></span>
<span id="cb375-8786"><a href="#cb375-8786" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-8787"><a href="#cb375-8787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8788"><a href="#cb375-8788" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-8789"><a href="#cb375-8789" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-8790"><a href="#cb375-8790" aria-hidden="true" tabindex="-1"></a>patterns <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb375-8791"><a href="#cb375-8791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8792"><a href="#cb375-8792" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_pattern_occurrences(text, patterns)</span>
<span id="cb375-8793"><a href="#cb375-8793" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>.join(<span class="bu">str</span>(pos) <span class="cf">for</span> pos <span class="kw">in</span> result))</span>
<span id="cb375-8794"><a href="#cb375-8794" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8795"><a href="#cb375-8795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8796"><a href="#cb375-8796" aria-hidden="true" tabindex="-1"></a><span class="co"># Find All Approximate Occurrences of a Collection of Patterns in a String</span></span>
<span id="cb375-8797"><a href="#cb375-8797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8798"><a href="#cb375-8798" aria-hidden="true" tabindex="-1"></a>Multiple Approximate Pattern Matching Problem. Find <span class="bu">all</span> approximate occurrences of a collection of patterns <span class="kw">in</span> a text.</span>
<span id="cb375-8799"><a href="#cb375-8799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8800"><a href="#cb375-8800" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>, a collection of strings&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>, <span class="kw">and</span> an integer&nbsp;<span class="op">*</span>d<span class="op">*</span>.</span>
<span id="cb375-8801"><a href="#cb375-8801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8802"><a href="#cb375-8802" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All positions in&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;where a string from&nbsp;<span class="op">*</span>Patterns<span class="op">*</span>&nbsp;appears <span class="im">as</span> a substring <span class="cf">with</span> at most&nbsp;<span class="op">*</span>d<span class="op">*</span>&nbsp;mismatches.</span>
<span id="cb375-8803"><a href="#cb375-8803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8804"><a href="#cb375-8804" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8805"><a href="#cb375-8805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8806"><a href="#cb375-8806" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8807"><a href="#cb375-8807" aria-hidden="true" tabindex="-1"></a>ACATGCTACTTT</span>
<span id="cb375-8808"><a href="#cb375-8808" aria-hidden="true" tabindex="-1"></a>ATT GCC GCTA TATT</span>
<span id="cb375-8809"><a href="#cb375-8809" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb375-8810"><a href="#cb375-8810" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8811"><a href="#cb375-8811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8812"><a href="#cb375-8812" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8813"><a href="#cb375-8813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8814"><a href="#cb375-8814" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8815"><a href="#cb375-8815" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span></span>
<span id="cb375-8816"><a href="#cb375-8816" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8817"><a href="#cb375-8817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8818"><a href="#cb375-8818" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8819"><a href="#cb375-8819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8820"><a href="#cb375-8820" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8821"><a href="#cb375-8821" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-8822"><a href="#cb375-8822" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb375-8823"><a href="#cb375-8823" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Iterator</span>
<span id="cb375-8824"><a href="#cb375-8824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8825"><a href="#cb375-8825" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-8826"><a href="#cb375-8826" aria-hidden="true" tabindex="-1"></a>    suffixes: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {i: text[i:] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))}</span>
<span id="cb375-8827"><a href="#cb375-8827" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(suffixes.keys(), key<span class="op">=</span><span class="kw">lambda</span> x: suffixes[x])</span>
<span id="cb375-8828"><a href="#cb375-8828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8829"><a href="#cb375-8829" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partial_suffix_array(sequence: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-8830"><a href="#cb375-8830" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [(i, x) <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(suffix_array(sequence)) <span class="cf">if</span> x <span class="op">%</span> k <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb375-8831"><a href="#cb375-8831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8832"><a href="#cb375-8832" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-8833"><a href="#cb375-8833" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join(sequence[i <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> suffix_array(sequence))</span>
<span id="cb375-8834"><a href="#cb375-8834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8835"><a href="#cb375-8835" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> accumulate</span>
<span id="cb375-8836"><a href="#cb375-8836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8837"><a href="#cb375-8837" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> first_occurrence(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb375-8838"><a href="#cb375-8838" aria-hidden="true" tabindex="-1"></a>    unique_letters: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(sequence))</span>
<span id="cb375-8839"><a href="#cb375-8839" aria-hidden="true" tabindex="-1"></a>    counts: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(accumulate(sequence.count(x) <span class="cf">for</span> x <span class="kw">in</span> unique_letters))</span>
<span id="cb375-8840"><a href="#cb375-8840" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">dict</span>(<span class="bu">zip</span>(unique_letters, counts))</span>
<span id="cb375-8841"><a href="#cb375-8841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8842"><a href="#cb375-8842" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_symbols(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-8843"><a href="#cb375-8843" aria-hidden="true" tabindex="-1"></a>    count: List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-8844"><a href="#cb375-8844" aria-hidden="true" tabindex="-1"></a>    count.append(defaultdict(<span class="bu">int</span>))</span>
<span id="cb375-8845"><a href="#cb375-8845" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb375-8846"><a href="#cb375-8846" aria-hidden="true" tabindex="-1"></a>        count.append(copy(count[i]))</span>
<span id="cb375-8847"><a href="#cb375-8847" aria-hidden="true" tabindex="-1"></a>        count[i <span class="op">+</span> <span class="dv">1</span>][symbol] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-8848"><a href="#cb375-8848" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count</span>
<span id="cb375-8849"><a href="#cb375-8849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8850"><a href="#cb375-8850" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_location(row: <span class="bu">int</span>, psa: Dict[<span class="bu">int</span>, <span class="bu">int</span>], last_column: <span class="bu">str</span>, fo: Dict[<span class="bu">str</span>, <span class="bu">int</span>], cs: List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-8851"><a href="#cb375-8851" aria-hidden="true" tabindex="-1"></a>    steps: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-8852"><a href="#cb375-8852" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> row <span class="kw">not</span> <span class="kw">in</span> psa:</span>
<span id="cb375-8853"><a href="#cb375-8853" aria-hidden="true" tabindex="-1"></a>        predecessor: <span class="bu">str</span> <span class="op">=</span> last_column[row]</span>
<span id="cb375-8854"><a href="#cb375-8854" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> fo[predecessor] <span class="op">+</span> cs[row][predecessor]</span>
<span id="cb375-8855"><a href="#cb375-8855" aria-hidden="true" tabindex="-1"></a>        steps <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-8856"><a href="#cb375-8856" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> steps <span class="op">+</span> psa[row]</span>
<span id="cb375-8857"><a href="#cb375-8857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8858"><a href="#cb375-8858" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BWMatch:</span>
<span id="cb375-8859"><a href="#cb375-8859" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, sequence: <span class="bu">str</span>, k: <span class="bu">int</span> <span class="op">=</span> <span class="dv">10</span>):</span>
<span id="cb375-8860"><a href="#cb375-8860" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.psa: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> <span class="bu">dict</span>(partial_suffix_array(sequence <span class="op">+</span> <span class="st">"$"</span>, k))</span>
<span id="cb375-8861"><a href="#cb375-8861" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.sequence: <span class="bu">str</span> <span class="op">=</span> burrows_wheeler_transform(sequence <span class="op">+</span> <span class="st">"$"</span>)</span>
<span id="cb375-8862"><a href="#cb375-8862" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fo: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> first_occurrence(<span class="va">self</span>.sequence)</span>
<span id="cb375-8863"><a href="#cb375-8863" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cs: List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> count_symbols(<span class="va">self</span>.sequence)</span>
<span id="cb375-8864"><a href="#cb375-8864" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_mismatches: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-8865"><a href="#cb375-8865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8866"><a href="#cb375-8866" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update(<span class="va">self</span>, pointers: Tuple[<span class="bu">int</span>, <span class="bu">int</span>], x: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb375-8867"><a href="#cb375-8867" aria-hidden="true" tabindex="-1"></a>        top, bottom <span class="op">=</span> pointers</span>
<span id="cb375-8868"><a href="#cb375-8868" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="va">self</span>.fo[x] <span class="op">+</span> <span class="va">self</span>.cs[top][x], <span class="va">self</span>.fo[x] <span class="op">+</span> <span class="va">self</span>.cs[bottom <span class="op">+</span> <span class="dv">1</span>][x] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb375-8869"><a href="#cb375-8869" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8870"><a href="#cb375-8870" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> bwm(<span class="va">self</span>, pattern: <span class="bu">str</span>, pointers: Tuple[<span class="bu">int</span>, <span class="bu">int</span>], mismatch_count: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-8871"><a href="#cb375-8871" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> pattern:</span>
<span id="cb375-8872"><a href="#cb375-8872" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">range</span>(pointers[<span class="dv">0</span>], pointers[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb375-8873"><a href="#cb375-8873" aria-hidden="true" tabindex="-1"></a>        matches: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-8874"><a href="#cb375-8874" aria-hidden="true" tabindex="-1"></a>        pattern, symbol <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>], pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-8875"><a href="#cb375-8875" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> symbol <span class="kw">in</span> <span class="va">self</span>.sequence[pointers[<span class="dv">0</span>] : pointers[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>]:</span>
<span id="cb375-8876"><a href="#cb375-8876" aria-hidden="true" tabindex="-1"></a>            matches <span class="op">+=</span> <span class="va">self</span>.bwm(pattern, <span class="va">self</span>.update(pointers, symbol), mismatch_count)</span>
<span id="cb375-8877"><a href="#cb375-8877" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mismatch_count <span class="op">&lt;</span> <span class="va">self</span>.max_mismatches:</span>
<span id="cb375-8878"><a href="#cb375-8878" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mismatch <span class="kw">in</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]:</span>
<span id="cb375-8879"><a href="#cb375-8879" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> mismatch <span class="op">!=</span> symbol:</span>
<span id="cb375-8880"><a href="#cb375-8880" aria-hidden="true" tabindex="-1"></a>                    matches <span class="op">+=</span> <span class="va">self</span>.bwm(pattern, <span class="va">self</span>.update(pointers, mismatch), mismatch_count <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-8881"><a href="#cb375-8881" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> matches</span>
<span id="cb375-8882"><a href="#cb375-8882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8883"><a href="#cb375-8883" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> match_patterns(<span class="va">self</span>, patterns: List[<span class="bu">str</span>], max_mismatches: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb375-8884"><a href="#cb375-8884" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_mismatches <span class="op">=</span> max_mismatches</span>
<span id="cb375-8885"><a href="#cb375-8885" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb375-8886"><a href="#cb375-8886" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> match <span class="kw">in</span> <span class="va">self</span>.bwm(pattern, (<span class="dv">0</span>, <span class="bu">len</span>(<span class="va">self</span>.sequence) <span class="op">-</span> <span class="dv">1</span>), <span class="dv">0</span>):</span>
<span id="cb375-8887"><a href="#cb375-8887" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> find_location(match, <span class="va">self</span>.psa, <span class="va">self</span>.sequence, <span class="va">self</span>.fo, <span class="va">self</span>.cs)</span>
<span id="cb375-8888"><a href="#cb375-8888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8889"><a href="#cb375-8889" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-8890"><a href="#cb375-8890" aria-hidden="true" tabindex="-1"></a><span class="st">ACATGCTACTTT</span></span>
<span id="cb375-8891"><a href="#cb375-8891" aria-hidden="true" tabindex="-1"></a><span class="st">ATT GCC GCTA TATT</span></span>
<span id="cb375-8892"><a href="#cb375-8892" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb375-8893"><a href="#cb375-8893" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-8894"><a href="#cb375-8894" aria-hidden="true" tabindex="-1"></a>sequence, patterns, mismatches <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-8895"><a href="#cb375-8895" aria-hidden="true" tabindex="-1"></a>patterns: List[<span class="bu">str</span>] <span class="op">=</span> patterns.split()</span>
<span id="cb375-8896"><a href="#cb375-8896" aria-hidden="true" tabindex="-1"></a>mismatches: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(mismatches)</span>
<span id="cb375-8897"><a href="#cb375-8897" aria-hidden="true" tabindex="-1"></a>matcher: BWMatch <span class="op">=</span> BWMatch(sequence)</span>
<span id="cb375-8898"><a href="#cb375-8898" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(matcher.match_patterns(patterns, mismatches)))</span>
<span id="cb375-8899"><a href="#cb375-8899" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8900"><a href="#cb375-8900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8901"><a href="#cb375-8901" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement TreeColoring</span></span>
<span id="cb375-8902"><a href="#cb375-8902" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8903"><a href="#cb375-8903" aria-hidden="true" tabindex="-1"></a>Tree Coloring Problem. Color the internal nodes of a suffix tree given colors of the leaves.</span>
<span id="cb375-8904"><a href="#cb375-8904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8905"><a href="#cb375-8905" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;An&nbsp;[adjacency <span class="bu">list</span>](https:<span class="op">//</span>rosalind.info<span class="op">/</span>glossary<span class="op">/</span>adjacency<span class="op">-</span><span class="bu">list</span><span class="op">/</span>), followed by color labels <span class="cf">for</span> leaf nodes.</span>
<span id="cb375-8906"><a href="#cb375-8906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8907"><a href="#cb375-8907" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;Color labels <span class="cf">for</span> <span class="bu">all</span> nodes, <span class="kw">in</span> <span class="bu">any</span> order.</span>
<span id="cb375-8908"><a href="#cb375-8908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8909"><a href="#cb375-8909" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-8910"><a href="#cb375-8910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8911"><a href="#cb375-8911" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8912"><a href="#cb375-8912" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="op">-&gt;</span> {}</span>
<span id="cb375-8913"><a href="#cb375-8913" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="op">-&gt;</span> {}</span>
<span id="cb375-8914"><a href="#cb375-8914" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span> <span class="op">-&gt;</span> <span class="dv">0</span>,<span class="dv">1</span></span>
<span id="cb375-8915"><a href="#cb375-8915" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span> <span class="op">-&gt;</span> {}</span>
<span id="cb375-8916"><a href="#cb375-8916" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="op">-&gt;</span> {}</span>
<span id="cb375-8917"><a href="#cb375-8917" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="op">-&gt;</span> <span class="dv">3</span>,<span class="dv">2</span></span>
<span id="cb375-8918"><a href="#cb375-8918" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span> <span class="op">-&gt;</span> {}</span>
<span id="cb375-8919"><a href="#cb375-8919" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span> <span class="op">-&gt;</span> <span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span></span>
<span id="cb375-8920"><a href="#cb375-8920" aria-hidden="true" tabindex="-1"></a><span class="op">-</span></span>
<span id="cb375-8921"><a href="#cb375-8921" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>: red</span>
<span id="cb375-8922"><a href="#cb375-8922" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>: red</span>
<span id="cb375-8923"><a href="#cb375-8923" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>: blue</span>
<span id="cb375-8924"><a href="#cb375-8924" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>: blue</span>
<span id="cb375-8925"><a href="#cb375-8925" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>: red</span>
<span id="cb375-8926"><a href="#cb375-8926" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8927"><a href="#cb375-8927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8928"><a href="#cb375-8928" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-8929"><a href="#cb375-8929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8930"><a href="#cb375-8930" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8931"><a href="#cb375-8931" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>: red</span>
<span id="cb375-8932"><a href="#cb375-8932" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>: red</span>
<span id="cb375-8933"><a href="#cb375-8933" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>: red</span>
<span id="cb375-8934"><a href="#cb375-8934" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>: blue</span>
<span id="cb375-8935"><a href="#cb375-8935" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>: blue</span>
<span id="cb375-8936"><a href="#cb375-8936" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>: purple</span>
<span id="cb375-8937"><a href="#cb375-8937" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>: red</span>
<span id="cb375-8938"><a href="#cb375-8938" aria-hidden="true" tabindex="-1"></a><span class="dv">7</span>: purple</span>
<span id="cb375-8939"><a href="#cb375-8939" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-8940"><a href="#cb375-8940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8941"><a href="#cb375-8941" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-8942"><a href="#cb375-8942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8943"><a href="#cb375-8943" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-8944"><a href="#cb375-8944" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-8945"><a href="#cb375-8945" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb375-8946"><a href="#cb375-8946" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Union, TextIO</span>
<span id="cb375-8947"><a href="#cb375-8947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8948"><a href="#cb375-8948" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_tree(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], node_colors: Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]]:</span>
<span id="cb375-8949"><a href="#cb375-8949" aria-hidden="true" tabindex="-1"></a>    uncolored_nodes <span class="op">=</span> <span class="bu">list</span>(tree.keys())</span>
<span id="cb375-8950"><a href="#cb375-8950" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> uncolored_nodes:</span>
<span id="cb375-8951"><a href="#cb375-8951" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(uncolored_nodes):  <span class="co"># Create a copy of uncolored_nodes to iterate over</span></span>
<span id="cb375-8952"><a href="#cb375-8952" aria-hidden="true" tabindex="-1"></a>            child_colors <span class="op">=</span> [node_colors[child[<span class="st">"n"</span>]] <span class="cf">for</span> child <span class="kw">in</span> tree[node] <span class="cf">if</span> node_colors[child[<span class="st">"n"</span>]] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>]</span>
<span id="cb375-8953"><a href="#cb375-8953" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(child_colors) <span class="op">==</span> <span class="bu">len</span>(tree[node]):  <span class="co"># Check if all children are colored</span></span>
<span id="cb375-8954"><a href="#cb375-8954" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">all</span>(color <span class="op">==</span> <span class="st">"red"</span> <span class="cf">for</span> color <span class="kw">in</span> child_colors):</span>
<span id="cb375-8955"><a href="#cb375-8955" aria-hidden="true" tabindex="-1"></a>                    node_colors[node] <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb375-8956"><a href="#cb375-8956" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="bu">all</span>(color <span class="op">==</span> <span class="st">"blue"</span> <span class="cf">for</span> color <span class="kw">in</span> child_colors):</span>
<span id="cb375-8957"><a href="#cb375-8957" aria-hidden="true" tabindex="-1"></a>                    node_colors[node] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb375-8958"><a href="#cb375-8958" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-8959"><a href="#cb375-8959" aria-hidden="true" tabindex="-1"></a>                    node_colors[node] <span class="op">=</span> <span class="st">"purple"</span></span>
<span id="cb375-8960"><a href="#cb375-8960" aria-hidden="true" tabindex="-1"></a>                uncolored_nodes.remove(node)</span>
<span id="cb375-8961"><a href="#cb375-8961" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node_colors</span>
<span id="cb375-8962"><a href="#cb375-8962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8963"><a href="#cb375-8963" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: Union[<span class="bu">str</span>, TextIO]) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]]]:</span>
<span id="cb375-8964"><a href="#cb375-8964" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(input_data, <span class="bu">str</span>):</span>
<span id="cb375-8965"><a href="#cb375-8965" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="kw">in</span> input_data:</span>
<span id="cb375-8966"><a href="#cb375-8966" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If input_data contains newlines, treat it as a string input</span></span>
<span id="cb375-8967"><a href="#cb375-8967" aria-hidden="true" tabindex="-1"></a>            file_obj <span class="op">=</span> io.StringIO(input_data)</span>
<span id="cb375-8968"><a href="#cb375-8968" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-8969"><a href="#cb375-8969" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Otherwise, treat it as a filename</span></span>
<span id="cb375-8970"><a href="#cb375-8970" aria-hidden="true" tabindex="-1"></a>            file_obj <span class="op">=</span> <span class="bu">open</span>(input_data)</span>
<span id="cb375-8971"><a href="#cb375-8971" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">isinstance</span>(input_data, TextIO):</span>
<span id="cb375-8972"><a href="#cb375-8972" aria-hidden="true" tabindex="-1"></a>        file_obj <span class="op">=</span> input_data</span>
<span id="cb375-8973"><a href="#cb375-8973" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-8974"><a href="#cb375-8974" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Input must be a filename, a string, or a file-like object"</span>)</span>
<span id="cb375-8975"><a href="#cb375-8975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8976"><a href="#cb375-8976" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-8977"><a href="#cb375-8977" aria-hidden="true" tabindex="-1"></a>    node_colors: Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="va">None</span>)</span>
<span id="cb375-8978"><a href="#cb375-8978" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8979"><a href="#cb375-8979" aria-hidden="true" tabindex="-1"></a>    parsing_tree <span class="op">=</span> <span class="va">True</span></span>
<span id="cb375-8980"><a href="#cb375-8980" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_obj:</span>
<span id="cb375-8981"><a href="#cb375-8981" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> line.strip()</span>
<span id="cb375-8982"><a href="#cb375-8982" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb375-8983"><a href="#cb375-8983" aria-hidden="true" tabindex="-1"></a>            parsing_tree <span class="op">=</span> <span class="va">False</span></span>
<span id="cb375-8984"><a href="#cb375-8984" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb375-8985"><a href="#cb375-8985" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb375-8986"><a href="#cb375-8986" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> parsing_tree:</span>
<span id="cb375-8987"><a href="#cb375-8987" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">" -&gt; "</span> <span class="kw">in</span> line:</span>
<span id="cb375-8988"><a href="#cb375-8988" aria-hidden="true" tabindex="-1"></a>                parent, children <span class="op">=</span> line.split(<span class="st">" -&gt; "</span>)</span>
<span id="cb375-8989"><a href="#cb375-8989" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> children <span class="op">!=</span> <span class="st">"</span><span class="sc">{}</span><span class="st">"</span>:</span>
<span id="cb375-8990"><a href="#cb375-8990" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> child <span class="kw">in</span> children.split(<span class="st">","</span>):</span>
<span id="cb375-8991"><a href="#cb375-8991" aria-hidden="true" tabindex="-1"></a>                        tree[<span class="bu">int</span>(parent)].append({<span class="st">"n"</span>: <span class="bu">int</span>(child)})</span>
<span id="cb375-8992"><a href="#cb375-8992" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-8993"><a href="#cb375-8993" aria-hidden="true" tabindex="-1"></a>            node, color <span class="op">=</span> line.split(<span class="st">": "</span>)</span>
<span id="cb375-8994"><a href="#cb375-8994" aria-hidden="true" tabindex="-1"></a>            node_colors[<span class="bu">int</span>(node)] <span class="op">=</span> color</span>
<span id="cb375-8995"><a href="#cb375-8995" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-8996"><a href="#cb375-8996" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(input_data, <span class="bu">str</span>) <span class="kw">and</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="kw">not</span> <span class="kw">in</span> input_data:</span>
<span id="cb375-8997"><a href="#cb375-8997" aria-hidden="true" tabindex="-1"></a>        file_obj.close()</span>
<span id="cb375-8998"><a href="#cb375-8998" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-8999"><a href="#cb375-8999" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree, node_colors</span>
<span id="cb375-9000"><a href="#cb375-9000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9001"><a href="#cb375-9001" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-9002"><a href="#cb375-9002" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; </span><span class="sc">{}</span></span>
<span id="cb375-9003"><a href="#cb375-9003" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; </span><span class="sc">{}</span></span>
<span id="cb375-9004"><a href="#cb375-9004" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 0,1</span></span>
<span id="cb375-9005"><a href="#cb375-9005" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; </span><span class="sc">{}</span></span>
<span id="cb375-9006"><a href="#cb375-9006" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; </span><span class="sc">{}</span></span>
<span id="cb375-9007"><a href="#cb375-9007" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 3,2</span></span>
<span id="cb375-9008"><a href="#cb375-9008" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; </span><span class="sc">{}</span></span>
<span id="cb375-9009"><a href="#cb375-9009" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 4,5,6</span></span>
<span id="cb375-9010"><a href="#cb375-9010" aria-hidden="true" tabindex="-1"></a><span class="st">-</span></span>
<span id="cb375-9011"><a href="#cb375-9011" aria-hidden="true" tabindex="-1"></a><span class="st">0: red</span></span>
<span id="cb375-9012"><a href="#cb375-9012" aria-hidden="true" tabindex="-1"></a><span class="st">1: red</span></span>
<span id="cb375-9013"><a href="#cb375-9013" aria-hidden="true" tabindex="-1"></a><span class="st">3: blue</span></span>
<span id="cb375-9014"><a href="#cb375-9014" aria-hidden="true" tabindex="-1"></a><span class="st">4: blue</span></span>
<span id="cb375-9015"><a href="#cb375-9015" aria-hidden="true" tabindex="-1"></a><span class="st">6: red</span></span>
<span id="cb375-9016"><a href="#cb375-9016" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-9017"><a href="#cb375-9017" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9018"><a href="#cb375-9018" aria-hidden="true" tabindex="-1"></a>tree, node_colors <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb375-9019"><a href="#cb375-9019" aria-hidden="true" tabindex="-1"></a>colored_tree <span class="op">=</span> color_tree(tree, node_colors)</span>
<span id="cb375-9020"><a href="#cb375-9020" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node <span class="kw">in</span> <span class="bu">sorted</span>(colored_tree.keys()):</span>
<span id="cb375-9021"><a href="#cb375-9021" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>colored_tree[node]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-9022"><a href="#cb375-9022" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9023"><a href="#cb375-9023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9024"><a href="#cb375-9024" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Partial Suffix Array of a String</span></span>
<span id="cb375-9025"><a href="#cb375-9025" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9026"><a href="#cb375-9026" aria-hidden="true" tabindex="-1"></a>Partial Suffix Array Construction Problem. Construct the partial suffix array of a string.</span>
<span id="cb375-9027"><a href="#cb375-9027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9028"><a href="#cb375-9028" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>&nbsp;and a positive integer&nbsp;<span class="op">*</span>K<span class="op">*</span>.</span>
<span id="cb375-9029"><a href="#cb375-9029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9030"><a href="#cb375-9030" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>SuffixArray__K<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>), <span class="kw">in</span> the form of a <span class="bu">list</span> of ordered pairs (<span class="op">*</span>i<span class="op">*</span>,&nbsp;<span class="op">*</span>SuffixArray<span class="op">*</span>(<span class="op">*</span>i<span class="op">*</span>)) <span class="cf">for</span> <span class="bu">all</span> nonempty entries <span class="kw">in</span> the partial suffix array.</span>
<span id="cb375-9031"><a href="#cb375-9031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9032"><a href="#cb375-9032" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-9033"><a href="#cb375-9033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9034"><a href="#cb375-9034" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9035"><a href="#cb375-9035" aria-hidden="true" tabindex="-1"></a>PANAMABANANAS$</span>
<span id="cb375-9036"><a href="#cb375-9036" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb375-9037"><a href="#cb375-9037" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9038"><a href="#cb375-9038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9039"><a href="#cb375-9039" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-9040"><a href="#cb375-9040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9041"><a href="#cb375-9041" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9042"><a href="#cb375-9042" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>,<span class="dv">5</span></span>
<span id="cb375-9043"><a href="#cb375-9043" aria-hidden="true" tabindex="-1"></a><span class="dv">11</span>,<span class="dv">10</span></span>
<span id="cb375-9044"><a href="#cb375-9044" aria-hidden="true" tabindex="-1"></a><span class="dv">12</span>,<span class="dv">0</span></span>
<span id="cb375-9045"><a href="#cb375-9045" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9046"><a href="#cb375-9046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9047"><a href="#cb375-9047" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-9048"><a href="#cb375-9048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9049"><a href="#cb375-9049" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-9050"><a href="#cb375-9050" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-9051"><a href="#cb375-9051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9052"><a href="#cb375-9052" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-9053"><a href="#cb375-9053" aria-hidden="true" tabindex="-1"></a>    suffixes: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {i: text[i:] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))}</span>
<span id="cb375-9054"><a href="#cb375-9054" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(suffixes.keys(), key<span class="op">=</span><span class="kw">lambda</span> x: suffixes[x])</span>
<span id="cb375-9055"><a href="#cb375-9055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9056"><a href="#cb375-9056" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partial_suffix_array(sequence: <span class="bu">str</span>, step: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-9057"><a href="#cb375-9057" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [(index, position) <span class="cf">for</span> index, position <span class="kw">in</span> <span class="bu">enumerate</span>(suffix_array(sequence)) <span class="cf">if</span> position <span class="op">%</span> step <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb375-9058"><a href="#cb375-9058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9059"><a href="#cb375-9059" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-9060"><a href="#cb375-9060" aria-hidden="true" tabindex="-1"></a><span class="st">PANAMABANANAS$</span></span>
<span id="cb375-9061"><a href="#cb375-9061" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb375-9062"><a href="#cb375-9062" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-9063"><a href="#cb375-9063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9064"><a href="#cb375-9064" aria-hidden="true" tabindex="-1"></a>sequence, step_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-9065"><a href="#cb375-9065" aria-hidden="true" tabindex="-1"></a>step: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(step_str)</span>
<span id="cb375-9066"><a href="#cb375-9066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9067"><a href="#cb375-9067" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> entry <span class="kw">in</span> partial_suffix_array(sequence, step):</span>
<span id="cb375-9068"><a href="#cb375-9068" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>entry, sep<span class="op">=</span><span class="st">","</span>)</span>
<span id="cb375-9069"><a href="#cb375-9069" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9070"><a href="#cb375-9070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9071"><a href="#cb375-9071" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a Suffix Tree from a Suffix Array</span></span>
<span id="cb375-9072"><a href="#cb375-9072" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9073"><a href="#cb375-9073" aria-hidden="true" tabindex="-1"></a>Suffix Tree Construction <span class="im">from</span> Suffix Array Problem. Construct a suffix tree <span class="im">from</span> the suffix array <span class="kw">and</span> LCP array of a string.</span>
<span id="cb375-9074"><a href="#cb375-9074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9075"><a href="#cb375-9075" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>Text<span class="op">*</span>,&nbsp;<span class="op">*</span>SuffixArray<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>), and&nbsp;<span class="op">*</span>LCP<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>).</span>
<span id="cb375-9076"><a href="#cb375-9076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9077"><a href="#cb375-9077" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The strings labeling the edges of&nbsp;<span class="op">*</span>SuffixTree<span class="op">*</span>(<span class="op">*</span>Text<span class="op">*</span>). (You may <span class="cf">return</span> these strings <span class="kw">in</span> <span class="bu">any</span> order.)</span>
<span id="cb375-9078"><a href="#cb375-9078" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9079"><a href="#cb375-9079" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-9080"><a href="#cb375-9080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9081"><a href="#cb375-9081" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9082"><a href="#cb375-9082" aria-hidden="true" tabindex="-1"></a>GTAGT$</span>
<span id="cb375-9083"><a href="#cb375-9083" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">1</span></span>
<span id="cb375-9084"><a href="#cb375-9084" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span></span>
<span id="cb375-9085"><a href="#cb375-9085" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9086"><a href="#cb375-9086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9087"><a href="#cb375-9087" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-9088"><a href="#cb375-9088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9089"><a href="#cb375-9089" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9090"><a href="#cb375-9090" aria-hidden="true" tabindex="-1"></a>$</span>
<span id="cb375-9091"><a href="#cb375-9091" aria-hidden="true" tabindex="-1"></a>$</span>
<span id="cb375-9092"><a href="#cb375-9092" aria-hidden="true" tabindex="-1"></a>$</span>
<span id="cb375-9093"><a href="#cb375-9093" aria-hidden="true" tabindex="-1"></a>AGT$</span>
<span id="cb375-9094"><a href="#cb375-9094" aria-hidden="true" tabindex="-1"></a>AGT$</span>
<span id="cb375-9095"><a href="#cb375-9095" aria-hidden="true" tabindex="-1"></a>AGT$</span>
<span id="cb375-9096"><a href="#cb375-9096" aria-hidden="true" tabindex="-1"></a>GT</span>
<span id="cb375-9097"><a href="#cb375-9097" aria-hidden="true" tabindex="-1"></a>T</span>
<span id="cb375-9098"><a href="#cb375-9098" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9099"><a href="#cb375-9099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9100"><a href="#cb375-9100" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-9101"><a href="#cb375-9101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9102"><a href="#cb375-9102" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-9103"><a href="#cb375-9103" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Union</span>
<span id="cb375-9104"><a href="#cb375-9104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9105"><a href="#cb375-9105" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Node:</span>
<span id="cb375-9106"><a href="#cb375-9106" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, parent: Union[<span class="bu">int</span>, <span class="bu">str</span>, <span class="va">None</span>] <span class="op">=</span> <span class="va">None</span>, label: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span>):</span>
<span id="cb375-9107"><a href="#cb375-9107" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.parent: Union[<span class="bu">int</span>, <span class="bu">str</span>, <span class="va">None</span>] <span class="op">=</span> parent</span>
<span id="cb375-9108"><a href="#cb375-9108" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label: <span class="bu">str</span> <span class="op">=</span> label</span>
<span id="cb375-9109"><a href="#cb375-9109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9110"><a href="#cb375-9110" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_depth(tree: Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node], node: Union[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-9111"><a href="#cb375-9111" aria-hidden="true" tabindex="-1"></a>    <span class="st">"""</span></span>
<span id="cb375-9112"><a href="#cb375-9112" aria-hidden="true" tabindex="-1"></a><span class="st">    Calculate the length of the concatenation of all path labels from the root to node</span></span>
<span id="cb375-9113"><a href="#cb375-9113" aria-hidden="true" tabindex="-1"></a><span class="st">    """</span></span>
<span id="cb375-9114"><a href="#cb375-9114" aria-hidden="true" tabindex="-1"></a>    depth: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(tree[node].label)</span>
<span id="cb375-9115"><a href="#cb375-9115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> tree[node].parent <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb375-9116"><a href="#cb375-9116" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> tree[node].parent</span>
<span id="cb375-9117"><a href="#cb375-9117" aria-hidden="true" tabindex="-1"></a>        depth <span class="op">+=</span> <span class="bu">len</span>(tree[node].label)</span>
<span id="cb375-9118"><a href="#cb375-9118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> depth</span>
<span id="cb375-9119"><a href="#cb375-9119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9120"><a href="#cb375-9120" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_suffix_tree(text: <span class="bu">str</span>, suffix_array: List[<span class="bu">int</span>], lcp_array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node]:</span>
<span id="cb375-9121"><a href="#cb375-9121" aria-hidden="true" tabindex="-1"></a>    tree: Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node] <span class="op">=</span> {<span class="op">-</span><span class="dv">1</span>: Node()}</span>
<span id="cb375-9122"><a href="#cb375-9122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9123"><a href="#cb375-9123" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text)):</span>
<span id="cb375-9124"><a href="#cb375-9124" aria-hidden="true" tabindex="-1"></a>        current_node: <span class="bu">int</span> <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-9125"><a href="#cb375-9125" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> tree[current_node].parent <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> calculate_depth(tree, current_node) <span class="op">&gt;</span> lcp_array[i]:</span>
<span id="cb375-9126"><a href="#cb375-9126" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> tree[current_node].parent</span>
<span id="cb375-9127"><a href="#cb375-9127" aria-hidden="true" tabindex="-1"></a>        current_depth: <span class="bu">int</span> <span class="op">=</span> calculate_depth(tree, current_node)</span>
<span id="cb375-9128"><a href="#cb375-9128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9129"><a href="#cb375-9129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> lcp_array[i] <span class="op">==</span> current_depth:</span>
<span id="cb375-9130"><a href="#cb375-9130" aria-hidden="true" tabindex="-1"></a>            tree[i] <span class="op">=</span> Node(current_node, text[suffix_array[i] <span class="op">+</span> lcp_array[i]:])</span>
<span id="cb375-9131"><a href="#cb375-9131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-9132"><a href="#cb375-9132" aria-hidden="true" tabindex="-1"></a>            temp_node: <span class="bu">int</span> <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-9133"><a href="#cb375-9133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> tree[temp_node].parent <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> tree[temp_node].parent <span class="op">!=</span> current_node:</span>
<span id="cb375-9134"><a href="#cb375-9134" aria-hidden="true" tabindex="-1"></a>                temp_node <span class="op">=</span> tree[temp_node].parent</span>
<span id="cb375-9135"><a href="#cb375-9135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9136"><a href="#cb375-9136" aria-hidden="true" tabindex="-1"></a>            new_node_key: <span class="bu">str</span> <span class="op">=</span> <span class="ss">f"y</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb375-9137"><a href="#cb375-9137" aria-hidden="true" tabindex="-1"></a>            tree[new_node_key] <span class="op">=</span> Node(current_node, text[suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> current_depth : suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> lcp_array[i]])</span>
<span id="cb375-9138"><a href="#cb375-9138" aria-hidden="true" tabindex="-1"></a>            tree[temp_node] <span class="op">=</span> Node(new_node_key, text[suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> lcp_array[i] : suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> calculate_depth(tree, temp_node)])</span>
<span id="cb375-9139"><a href="#cb375-9139" aria-hidden="true" tabindex="-1"></a>            tree[i] <span class="op">=</span> Node(new_node_key, text[suffix_array[i] <span class="op">+</span> lcp_array[i]:])</span>
<span id="cb375-9140"><a href="#cb375-9140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9141"><a href="#cb375-9141" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> tree[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-9142"><a href="#cb375-9142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb375-9143"><a href="#cb375-9143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9144"><a href="#cb375-9144" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-9145"><a href="#cb375-9145" aria-hidden="true" tabindex="-1"></a><span class="st">GTAGT$</span></span>
<span id="cb375-9146"><a href="#cb375-9146" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2, 3, 0, 4, 1</span></span>
<span id="cb375-9147"><a href="#cb375-9147" aria-hidden="true" tabindex="-1"></a><span class="st">0, 0, 0, 2, 0, 1</span></span>
<span id="cb375-9148"><a href="#cb375-9148" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-9149"><a href="#cb375-9149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9150"><a href="#cb375-9150" aria-hidden="true" tabindex="-1"></a>text, suffix_array_str, lcp_array_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-9151"><a href="#cb375-9151" aria-hidden="true" tabindex="-1"></a>suffix_array: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> suffix_array_str.split(<span class="st">", "</span>)]</span>
<span id="cb375-9152"><a href="#cb375-9152" aria-hidden="true" tabindex="-1"></a>lcp_array: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> lcp_array_str.split(<span class="st">", "</span>)]</span>
<span id="cb375-9153"><a href="#cb375-9153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9154"><a href="#cb375-9154" aria-hidden="true" tabindex="-1"></a>suffix_tree: Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node] <span class="op">=</span> construct_suffix_tree(text, suffix_array, lcp_array)</span>
<span id="cb375-9155"><a href="#cb375-9155" aria-hidden="true" tabindex="-1"></a>labels: List[<span class="bu">str</span>] <span class="op">=</span> [suffix_tree[key].label <span class="cf">for</span> key <span class="kw">in</span> suffix_tree.keys()]</span>
<span id="cb375-9156"><a href="#cb375-9156" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(labels), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-9157"><a href="#cb375-9157" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9158"><a href="#cb375-9158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9159"><a href="#cb375-9159" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of a Hidden Path</span></span>
<span id="cb375-9160"><a href="#cb375-9160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9161"><a href="#cb375-9161" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A hidden path $π$ followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>&nbsp;and transition matrix&nbsp;<span class="op">*</span>Transition<span class="op">*</span>&nbsp;of an HMM ($Σ$,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb375-9162"><a href="#cb375-9162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9163"><a href="#cb375-9163" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The probability of this path, $Pr(π)$. You may assume that initial probabilities are equal.</span>
<span id="cb375-9164"><a href="#cb375-9164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9165"><a href="#cb375-9165" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-9166"><a href="#cb375-9166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9167"><a href="#cb375-9167" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9168"><a href="#cb375-9168" aria-hidden="true" tabindex="-1"></a>AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span>
<span id="cb375-9169"><a href="#cb375-9169" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9170"><a href="#cb375-9170" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb375-9171"><a href="#cb375-9171" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9172"><a href="#cb375-9172" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb375-9173"><a href="#cb375-9173" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.194</span>   <span class="fl">0.806</span></span>
<span id="cb375-9174"><a href="#cb375-9174" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.273</span>   <span class="fl">0.727</span></span>
<span id="cb375-9175"><a href="#cb375-9175" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9176"><a href="#cb375-9176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9177"><a href="#cb375-9177" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-9178"><a href="#cb375-9178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9179"><a href="#cb375-9179" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9180"><a href="#cb375-9180" aria-hidden="true" tabindex="-1"></a><span class="fl">5.01732865318e-19</span></span>
<span id="cb375-9181"><a href="#cb375-9181" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9182"><a href="#cb375-9182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9183"><a href="#cb375-9183" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-9184"><a href="#cb375-9184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9185"><a href="#cb375-9185" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-9186"><a href="#cb375-9186" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb375-9187"><a href="#cb375-9187" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-9188"><a href="#cb375-9188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9189"><a href="#cb375-9189" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hidden_path_data(input_lines):</span>
<span id="cb375-9190"><a href="#cb375-9190" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb375-9191"><a href="#cb375-9191" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb375-9192"><a href="#cb375-9192" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb375-9193"><a href="#cb375-9193" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb375-9194"><a href="#cb375-9194" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb375-9195"><a href="#cb375-9195" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9196"><a href="#cb375-9196" aria-hidden="true" tabindex="-1"></a>    transition_probabilities <span class="op">=</span> {}</span>
<span id="cb375-9197"><a href="#cb375-9197" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb375-9198"><a href="#cb375-9198" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb375-9199"><a href="#cb375-9199" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb375-9200"><a href="#cb375-9200" aria-hidden="true" tabindex="-1"></a>            current_state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb375-9201"><a href="#cb375-9201" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> next_state, probability <span class="kw">in</span> <span class="bu">zip</span>(states, row_data[<span class="dv">1</span>:]):</span>
<span id="cb375-9202"><a href="#cb375-9202" aria-hidden="true" tabindex="-1"></a>                transition_probabilities[(current_state, next_state)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb375-9203"><a href="#cb375-9203" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9204"><a href="#cb375-9204" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hidden_path, transition_probabilities</span>
<span id="cb375-9205"><a href="#cb375-9205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9206"><a href="#cb375-9206" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hidden_path_probability(hidden_path, transition_probabilities):</span>
<span id="cb375-9207"><a href="#cb375-9207" aria-hidden="true" tabindex="-1"></a>    initial_probability <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb375-9208"><a href="#cb375-9208" aria-hidden="true" tabindex="-1"></a>    path_probability <span class="op">=</span> initial_probability <span class="op">*</span> prod(</span>
<span id="cb375-9209"><a href="#cb375-9209" aria-hidden="true" tabindex="-1"></a>        transition_probabilities[state_pair] </span>
<span id="cb375-9210"><a href="#cb375-9210" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> state_pair <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, hidden_path[<span class="dv">1</span>:])</span>
<span id="cb375-9211"><a href="#cb375-9211" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb375-9212"><a href="#cb375-9212" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_probability</span>
<span id="cb375-9213"><a href="#cb375-9213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9214"><a href="#cb375-9214" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-9215"><a href="#cb375-9215" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span></span>
<span id="cb375-9216"><a href="#cb375-9216" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9217"><a href="#cb375-9217" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb375-9218"><a href="#cb375-9218" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9219"><a href="#cb375-9219" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb375-9220"><a href="#cb375-9220" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.194   0.806</span></span>
<span id="cb375-9221"><a href="#cb375-9221" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.273   0.727</span></span>
<span id="cb375-9222"><a href="#cb375-9222" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-9223"><a href="#cb375-9223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9224"><a href="#cb375-9224" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb375-9225"><a href="#cb375-9225" aria-hidden="true" tabindex="-1"></a>hidden_path, transition_probabilities <span class="op">=</span> parse_hidden_path_data(input_lines)</span>
<span id="cb375-9226"><a href="#cb375-9226" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_hidden_path_probability(hidden_path, transition_probabilities)</span>
<span id="cb375-9227"><a href="#cb375-9227" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span>
<span id="cb375-9228"><a href="#cb375-9228" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9229"><a href="#cb375-9229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9230"><a href="#cb375-9230" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of an Outcome Given a Hidden Path</span></span>
<span id="cb375-9231"><a href="#cb375-9231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9232"><a href="#cb375-9232" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>x<span class="op">*</span>, followed by the alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>&nbsp;from which&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;was constructed, followed by a hidden path&nbsp;<span class="op">*</span>π<span class="op">*</span>, followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>&nbsp;and emission matrix&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;of an HMM (<span class="op">*</span>Σ<span class="op">*</span>,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb375-9233"><a href="#cb375-9233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9234"><a href="#cb375-9234" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The conditional probability $Pr(x<span class="op">|</span>π)$ that string&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;will be emitted by the HMM given the hidden path&nbsp;<span class="op">*</span>π<span class="op">*</span>.</span>
<span id="cb375-9235"><a href="#cb375-9235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9236"><a href="#cb375-9236" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-9237"><a href="#cb375-9237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9238"><a href="#cb375-9238" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9239"><a href="#cb375-9239" aria-hidden="true" tabindex="-1"></a>xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span>
<span id="cb375-9240"><a href="#cb375-9240" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9241"><a href="#cb375-9241" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb375-9242"><a href="#cb375-9242" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9243"><a href="#cb375-9243" aria-hidden="true" tabindex="-1"></a>BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span>
<span id="cb375-9244"><a href="#cb375-9244" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9245"><a href="#cb375-9245" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb375-9246"><a href="#cb375-9246" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9247"><a href="#cb375-9247" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb375-9248"><a href="#cb375-9248" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.612</span>   <span class="fl">0.314</span>   <span class="fl">0.074</span> </span>
<span id="cb375-9249"><a href="#cb375-9249" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.346</span>   <span class="fl">0.317</span>   <span class="fl">0.336</span></span>
<span id="cb375-9250"><a href="#cb375-9250" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9251"><a href="#cb375-9251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9252"><a href="#cb375-9252" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-9253"><a href="#cb375-9253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9254"><a href="#cb375-9254" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9255"><a href="#cb375-9255" aria-hidden="true" tabindex="-1"></a><span class="fl">1.93157070893e-28</span></span>
<span id="cb375-9256"><a href="#cb375-9256" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9257"><a href="#cb375-9257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9258"><a href="#cb375-9258" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-9259"><a href="#cb375-9259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9260"><a href="#cb375-9260" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-9261"><a href="#cb375-9261" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb375-9262"><a href="#cb375-9262" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-9263"><a href="#cb375-9263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9264"><a href="#cb375-9264" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_emission_data(input_lines):</span>
<span id="cb375-9265"><a href="#cb375-9265" aria-hidden="true" tabindex="-1"></a>    emission_sequence <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb375-9266"><a href="#cb375-9266" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb375-9267"><a href="#cb375-9267" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb375-9268"><a href="#cb375-9268" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb375-9269"><a href="#cb375-9269" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb375-9270"><a href="#cb375-9270" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb375-9271"><a href="#cb375-9271" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb375-9272"><a href="#cb375-9272" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb375-9273"><a href="#cb375-9273" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb375-9274"><a href="#cb375-9274" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9275"><a href="#cb375-9275" aria-hidden="true" tabindex="-1"></a>    emission_probabilities <span class="op">=</span> {}</span>
<span id="cb375-9276"><a href="#cb375-9276" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb375-9277"><a href="#cb375-9277" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb375-9278"><a href="#cb375-9278" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb375-9279"><a href="#cb375-9279" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb375-9280"><a href="#cb375-9280" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> symbol, probability <span class="kw">in</span> <span class="bu">zip</span>(symbols, row_data[<span class="dv">1</span>:]):</span>
<span id="cb375-9281"><a href="#cb375-9281" aria-hidden="true" tabindex="-1"></a>                emission_probabilities[(state, symbol)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb375-9282"><a href="#cb375-9282" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9283"><a href="#cb375-9283" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emission_sequence, hidden_path, emission_probabilities</span>
<span id="cb375-9284"><a href="#cb375-9284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9285"><a href="#cb375-9285" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities):</span>
<span id="cb375-9286"><a href="#cb375-9286" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prod(emission_probabilities[state_symbol] <span class="cf">for</span> state_symbol <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, emission_sequence))</span>
<span id="cb375-9287"><a href="#cb375-9287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9288"><a href="#cb375-9288" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-9289"><a href="#cb375-9289" aria-hidden="true" tabindex="-1"></a><span class="st">xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span></span>
<span id="cb375-9290"><a href="#cb375-9290" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9291"><a href="#cb375-9291" aria-hidden="true" tabindex="-1"></a><span class="st">x y z</span></span>
<span id="cb375-9292"><a href="#cb375-9292" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9293"><a href="#cb375-9293" aria-hidden="true" tabindex="-1"></a><span class="st">BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span></span>
<span id="cb375-9294"><a href="#cb375-9294" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9295"><a href="#cb375-9295" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb375-9296"><a href="#cb375-9296" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9297"><a href="#cb375-9297" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb375-9298"><a href="#cb375-9298" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.612   0.314   0.074 </span></span>
<span id="cb375-9299"><a href="#cb375-9299" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.346   0.317   0.336</span></span>
<span id="cb375-9300"><a href="#cb375-9300" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-9301"><a href="#cb375-9301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9302"><a href="#cb375-9302" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb375-9303"><a href="#cb375-9303" aria-hidden="true" tabindex="-1"></a>emission_sequence, hidden_path, emission_probabilities <span class="op">=</span> parse_emission_data(input_lines)</span>
<span id="cb375-9304"><a href="#cb375-9304" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities)</span>
<span id="cb375-9305"><a href="#cb375-9305" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span>
<span id="cb375-9306"><a href="#cb375-9306" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9307"><a href="#cb375-9307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9308"><a href="#cb375-9308" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement the Viterbi Algorithm</span></span>
<span id="cb375-9309"><a href="#cb375-9309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9310"><a href="#cb375-9310" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>x<span class="op">*</span>, followed by the alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>&nbsp;from which&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;was constructed, followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>, transition matrix&nbsp;<span class="op">*</span>Transition<span class="op">*</span>, <span class="kw">and</span> emission matrix&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;of an HMM (<span class="op">*</span>Σ<span class="op">*</span>,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb375-9311"><a href="#cb375-9311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9312"><a href="#cb375-9312" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A path that maximizes the (unconditional) probability Pr(<span class="op">*</span>x<span class="op">*</span>,&nbsp;<span class="op">*</span>π<span class="op">*</span>) over <span class="bu">all</span> possible paths&nbsp;<span class="op">*</span>π<span class="op">*</span>.</span>
<span id="cb375-9313"><a href="#cb375-9313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9314"><a href="#cb375-9314" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-9315"><a href="#cb375-9315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9316"><a href="#cb375-9316" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9317"><a href="#cb375-9317" aria-hidden="true" tabindex="-1"></a>xyxzzxyxyy</span>
<span id="cb375-9318"><a href="#cb375-9318" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9319"><a href="#cb375-9319" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb375-9320"><a href="#cb375-9320" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9321"><a href="#cb375-9321" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb375-9322"><a href="#cb375-9322" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9323"><a href="#cb375-9323" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb375-9324"><a href="#cb375-9324" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.641</span>   <span class="fl">0.359</span></span>
<span id="cb375-9325"><a href="#cb375-9325" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.729</span>   <span class="fl">0.271</span></span>
<span id="cb375-9326"><a href="#cb375-9326" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9327"><a href="#cb375-9327" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb375-9328"><a href="#cb375-9328" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.117</span>   <span class="fl">0.691</span>   <span class="fl">0.192</span>   </span>
<span id="cb375-9329"><a href="#cb375-9329" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.097</span>   <span class="fl">0.42</span>    <span class="fl">0.483</span></span>
<span id="cb375-9330"><a href="#cb375-9330" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9331"><a href="#cb375-9331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9332"><a href="#cb375-9332" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-9333"><a href="#cb375-9333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9334"><a href="#cb375-9334" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9335"><a href="#cb375-9335" aria-hidden="true" tabindex="-1"></a>AAABBAAAAA</span>
<span id="cb375-9336"><a href="#cb375-9336" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9337"><a href="#cb375-9337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9338"><a href="#cb375-9338" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-9339"><a href="#cb375-9339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9340"><a href="#cb375-9340" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-9341"><a href="#cb375-9341" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-9342"><a href="#cb375-9342" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb375-9343"><a href="#cb375-9343" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb375-9344"><a href="#cb375-9344" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-9345"><a href="#cb375-9345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9346"><a href="#cb375-9346" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb375-9347"><a href="#cb375-9347" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb375-9348"><a href="#cb375-9348" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9349"><a href="#cb375-9349" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb375-9350"><a href="#cb375-9350" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9351"><a href="#cb375-9351" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb375-9352"><a href="#cb375-9352" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9353"><a href="#cb375-9353" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9354"><a href="#cb375-9354" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-9355"><a href="#cb375-9355" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb375-9356"><a href="#cb375-9356" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb375-9357"><a href="#cb375-9357" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb375-9358"><a href="#cb375-9358" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb375-9359"><a href="#cb375-9359" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-9360"><a href="#cb375-9360" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9361"><a href="#cb375-9361" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9362"><a href="#cb375-9362" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-9363"><a href="#cb375-9363" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb375-9364"><a href="#cb375-9364" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb375-9365"><a href="#cb375-9365" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb375-9366"><a href="#cb375-9366" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb375-9367"><a href="#cb375-9367" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-9368"><a href="#cb375-9368" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9369"><a href="#cb375-9369" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb375-9370"><a href="#cb375-9370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9371"><a href="#cb375-9371" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-9372"><a href="#cb375-9372" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> <span class="bu">len</span>(states)</span>
<span id="cb375-9373"><a href="#cb375-9373" aria-hidden="true" tabindex="-1"></a>    sequence_length <span class="op">=</span> <span class="bu">len</span>(sequence)</span>
<span id="cb375-9374"><a href="#cb375-9374" aria-hidden="true" tabindex="-1"></a>    viterbi_matrix <span class="op">=</span> np.zeros((sequence_length, num_states))</span>
<span id="cb375-9375"><a href="#cb375-9375" aria-hidden="true" tabindex="-1"></a>    backpointer <span class="op">=</span> np.zeros((sequence_length, num_states), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb375-9376"><a href="#cb375-9376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9377"><a href="#cb375-9377" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the first column of the viterbi matrix</span></span>
<span id="cb375-9378"><a href="#cb375-9378" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-9379"><a href="#cb375-9379" aria-hidden="true" tabindex="-1"></a>        viterbi_matrix[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> num_states)</span>
<span id="cb375-9380"><a href="#cb375-9380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9381"><a href="#cb375-9381" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill in the rest of the viterbi matrix</span></span>
<span id="cb375-9382"><a href="#cb375-9382" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, sequence_length):</span>
<span id="cb375-9383"><a href="#cb375-9383" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-9384"><a href="#cb375-9384" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> [</span>
<span id="cb375-9385"><a href="#cb375-9385" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[previous_state, current_state]) <span class="op">+</span> </span>
<span id="cb375-9386"><a href="#cb375-9386" aria-hidden="true" tabindex="-1"></a>                log(emission_matrix[current_state, sequence[t]]) <span class="op">+</span> </span>
<span id="cb375-9387"><a href="#cb375-9387" aria-hidden="true" tabindex="-1"></a>                viterbi_matrix[t<span class="op">-</span><span class="dv">1</span>, k]</span>
<span id="cb375-9388"><a href="#cb375-9388" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb375-9389"><a href="#cb375-9389" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb375-9390"><a href="#cb375-9390" aria-hidden="true" tabindex="-1"></a>            max_prob_index <span class="op">=</span> probabilities.index(<span class="bu">max</span>(probabilities))</span>
<span id="cb375-9391"><a href="#cb375-9391" aria-hidden="true" tabindex="-1"></a>            backpointer[t, j] <span class="op">=</span> max_prob_index</span>
<span id="cb375-9392"><a href="#cb375-9392" aria-hidden="true" tabindex="-1"></a>            viterbi_matrix[t, j] <span class="op">=</span> <span class="bu">max</span>(probabilities)</span>
<span id="cb375-9393"><a href="#cb375-9393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9394"><a href="#cb375-9394" aria-hidden="true" tabindex="-1"></a>    best_path_index <span class="op">=</span> np.argmax(viterbi_matrix[<span class="op">-</span><span class="dv">1</span>, :])</span>
<span id="cb375-9395"><a href="#cb375-9395" aria-hidden="true" tabindex="-1"></a>    best_path <span class="op">=</span> states[best_path_index]</span>
<span id="cb375-9396"><a href="#cb375-9396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(sequence_length <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb375-9397"><a href="#cb375-9397" aria-hidden="true" tabindex="-1"></a>        best_path_index <span class="op">=</span> backpointer[t, best_path_index]</span>
<span id="cb375-9398"><a href="#cb375-9398" aria-hidden="true" tabindex="-1"></a>        best_path <span class="op">=</span> states[best_path_index] <span class="op">+</span> best_path</span>
<span id="cb375-9399"><a href="#cb375-9399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9400"><a href="#cb375-9400" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_path</span>
<span id="cb375-9401"><a href="#cb375-9401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9402"><a href="#cb375-9402" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb375-9403"><a href="#cb375-9403" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-9404"><a href="#cb375-9404" aria-hidden="true" tabindex="-1"></a><span class="st">xyxzzxyxyy</span></span>
<span id="cb375-9405"><a href="#cb375-9405" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9406"><a href="#cb375-9406" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb375-9407"><a href="#cb375-9407" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9408"><a href="#cb375-9408" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb375-9409"><a href="#cb375-9409" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9410"><a href="#cb375-9410" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb375-9411"><a href="#cb375-9411" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.641   0.359</span></span>
<span id="cb375-9412"><a href="#cb375-9412" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.729   0.271</span></span>
<span id="cb375-9413"><a href="#cb375-9413" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9414"><a href="#cb375-9414" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb375-9415"><a href="#cb375-9415" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.117   0.691   0.192   </span></span>
<span id="cb375-9416"><a href="#cb375-9416" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.097   0.42    0.483</span></span>
<span id="cb375-9417"><a href="#cb375-9417" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-9418"><a href="#cb375-9418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9419"><a href="#cb375-9419" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb375-9420"><a href="#cb375-9420" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb375-9421"><a href="#cb375-9421" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb375-9422"><a href="#cb375-9422" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-9423"><a href="#cb375-9423" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9424"><a href="#cb375-9424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9425"><a href="#cb375-9425" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of a String Emitted by an HMM</span></span>
<span id="cb375-9426"><a href="#cb375-9426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9427"><a href="#cb375-9427" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>x<span class="op">*</span>, followed by the alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>&nbsp;from which&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;was constructed, followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>, transition matrix&nbsp;<span class="op">*</span>Transition<span class="op">*</span>, <span class="kw">and</span> emission matrix&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;of an HMM (<span class="op">*</span>Σ<span class="op">*</span>,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb375-9428"><a href="#cb375-9428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9429"><a href="#cb375-9429" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The probability Pr(<span class="op">*</span>x<span class="op">*</span>) that the HMM emits&nbsp;<span class="op">*</span>x<span class="op">*</span>.</span>
<span id="cb375-9430"><a href="#cb375-9430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9431"><a href="#cb375-9431" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-9432"><a href="#cb375-9432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9433"><a href="#cb375-9433" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9434"><a href="#cb375-9434" aria-hidden="true" tabindex="-1"></a>xzyyzzyzyy</span>
<span id="cb375-9435"><a href="#cb375-9435" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9436"><a href="#cb375-9436" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb375-9437"><a href="#cb375-9437" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9438"><a href="#cb375-9438" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb375-9439"><a href="#cb375-9439" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9440"><a href="#cb375-9440" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb375-9441"><a href="#cb375-9441" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.303</span>   <span class="fl">0.697</span> </span>
<span id="cb375-9442"><a href="#cb375-9442" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.831</span>   <span class="fl">0.169</span> </span>
<span id="cb375-9443"><a href="#cb375-9443" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9444"><a href="#cb375-9444" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb375-9445"><a href="#cb375-9445" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.533</span>   <span class="fl">0.065</span>   <span class="fl">0.402</span> </span>
<span id="cb375-9446"><a href="#cb375-9446" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.342</span>   <span class="fl">0.334</span>   <span class="fl">0.324</span></span>
<span id="cb375-9447"><a href="#cb375-9447" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9448"><a href="#cb375-9448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9449"><a href="#cb375-9449" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-9450"><a href="#cb375-9450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9451"><a href="#cb375-9451" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9452"><a href="#cb375-9452" aria-hidden="true" tabindex="-1"></a><span class="fl">1.1005510319694847e-06</span></span>
<span id="cb375-9453"><a href="#cb375-9453" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9454"><a href="#cb375-9454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9455"><a href="#cb375-9455" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-9456"><a href="#cb375-9456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9457"><a href="#cb375-9457" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-9458"><a href="#cb375-9458" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-9459"><a href="#cb375-9459" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-9460"><a href="#cb375-9460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9461"><a href="#cb375-9461" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator):</span>
<span id="cb375-9462"><a href="#cb375-9462" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb375-9463"><a href="#cb375-9463" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9464"><a href="#cb375-9464" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb375-9465"><a href="#cb375-9465" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9466"><a href="#cb375-9466" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb375-9467"><a href="#cb375-9467" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9468"><a href="#cb375-9468" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9469"><a href="#cb375-9469" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-9470"><a href="#cb375-9470" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb375-9471"><a href="#cb375-9471" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb375-9472"><a href="#cb375-9472" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb375-9473"><a href="#cb375-9473" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb375-9474"><a href="#cb375-9474" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-9475"><a href="#cb375-9475" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9476"><a href="#cb375-9476" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9477"><a href="#cb375-9477" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-9478"><a href="#cb375-9478" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb375-9479"><a href="#cb375-9479" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb375-9480"><a href="#cb375-9480" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb375-9481"><a href="#cb375-9481" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb375-9482"><a href="#cb375-9482" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-9483"><a href="#cb375-9483" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-9484"><a href="#cb375-9484" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb375-9485"><a href="#cb375-9485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9486"><a href="#cb375-9486" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix):</span>
<span id="cb375-9487"><a href="#cb375-9487" aria-hidden="true" tabindex="-1"></a>    probability_matrix <span class="op">=</span> np.ones((<span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(states)))</span>
<span id="cb375-9488"><a href="#cb375-9488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9489"><a href="#cb375-9489" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-9490"><a href="#cb375-9490" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>, i] <span class="op">=</span> emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states)</span>
<span id="cb375-9491"><a href="#cb375-9491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9492"><a href="#cb375-9492" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb375-9493"><a href="#cb375-9493" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-9494"><a href="#cb375-9494" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb375-9495"><a href="#cb375-9495" aria-hidden="true" tabindex="-1"></a>                transition_matrix[previous_state, current_state] <span class="op">*</span> </span>
<span id="cb375-9496"><a href="#cb375-9496" aria-hidden="true" tabindex="-1"></a>                emission_matrix[current_state, emission] <span class="op">*</span> </span>
<span id="cb375-9497"><a href="#cb375-9497" aria-hidden="true" tabindex="-1"></a>                probability_matrix[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb375-9498"><a href="#cb375-9498" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb375-9499"><a href="#cb375-9499" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb375-9500"><a href="#cb375-9500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9501"><a href="#cb375-9501" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(probability_matrix[i, :])</span>
<span id="cb375-9502"><a href="#cb375-9502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9503"><a href="#cb375-9503" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-9504"><a href="#cb375-9504" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzzyzyy</span></span>
<span id="cb375-9505"><a href="#cb375-9505" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9506"><a href="#cb375-9506" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb375-9507"><a href="#cb375-9507" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9508"><a href="#cb375-9508" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb375-9509"><a href="#cb375-9509" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9510"><a href="#cb375-9510" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb375-9511"><a href="#cb375-9511" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.303   0.697 </span></span>
<span id="cb375-9512"><a href="#cb375-9512" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.831   0.169 </span></span>
<span id="cb375-9513"><a href="#cb375-9513" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9514"><a href="#cb375-9514" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb375-9515"><a href="#cb375-9515" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.533   0.065   0.402 </span></span>
<span id="cb375-9516"><a href="#cb375-9516" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.342   0.334   0.324</span></span>
<span id="cb375-9517"><a href="#cb375-9517" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-9518"><a href="#cb375-9518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9519"><a href="#cb375-9519" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb375-9520"><a href="#cb375-9520" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb375-9521"><a href="#cb375-9521" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb375-9522"><a href="#cb375-9522" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span>
<span id="cb375-9523"><a href="#cb375-9523" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9524"><a href="#cb375-9524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9525"><a href="#cb375-9525" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a Profile HMM</span></span>
<span id="cb375-9526"><a href="#cb375-9526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9527"><a href="#cb375-9527" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A threshold&nbsp;<span class="op">*</span>θ<span class="op">*</span>, followed by an alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>, followed by a multiple alignment&nbsp;<span class="op">*</span>Alignment<span class="op">*</span>&nbsp;whose strings are formed from&nbsp;<span class="op">*</span>Σ<span class="op">*</span>.</span>
<span id="cb375-9528"><a href="#cb375-9528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9529"><a href="#cb375-9529" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The transition <span class="kw">and</span> emission probabilities of the profile HMM&nbsp;<span class="op">*</span>HMM<span class="op">*</span>(<span class="op">*</span>Alignment<span class="op">*</span>,&nbsp;<span class="op">*</span>θ<span class="op">*</span>).</span>
<span id="cb375-9530"><a href="#cb375-9530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9531"><a href="#cb375-9531" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-9532"><a href="#cb375-9532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9533"><a href="#cb375-9533" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9534"><a href="#cb375-9534" aria-hidden="true" tabindex="-1"></a><span class="fl">0.289</span></span>
<span id="cb375-9535"><a href="#cb375-9535" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9536"><a href="#cb375-9536" aria-hidden="true" tabindex="-1"></a>A   B   C   D   E</span>
<span id="cb375-9537"><a href="#cb375-9537" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9538"><a href="#cb375-9538" aria-hidden="true" tabindex="-1"></a>EBA</span>
<span id="cb375-9539"><a href="#cb375-9539" aria-hidden="true" tabindex="-1"></a>EBD</span>
<span id="cb375-9540"><a href="#cb375-9540" aria-hidden="true" tabindex="-1"></a>EB<span class="op">-</span></span>
<span id="cb375-9541"><a href="#cb375-9541" aria-hidden="true" tabindex="-1"></a>EED</span>
<span id="cb375-9542"><a href="#cb375-9542" aria-hidden="true" tabindex="-1"></a>EBD</span>
<span id="cb375-9543"><a href="#cb375-9543" aria-hidden="true" tabindex="-1"></a>EBE</span>
<span id="cb375-9544"><a href="#cb375-9544" aria-hidden="true" tabindex="-1"></a>E<span class="op">-</span>D</span>
<span id="cb375-9545"><a href="#cb375-9545" aria-hidden="true" tabindex="-1"></a>EBD</span>
<span id="cb375-9546"><a href="#cb375-9546" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9547"><a href="#cb375-9547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9548"><a href="#cb375-9548" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-9549"><a href="#cb375-9549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9550"><a href="#cb375-9550" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9551"><a href="#cb375-9551" aria-hidden="true" tabindex="-1"></a>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E</span>
<span id="cb375-9552"><a href="#cb375-9552" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span> <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9553"><a href="#cb375-9553" aria-hidden="true" tabindex="-1"></a>I0  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9554"><a href="#cb375-9554" aria-hidden="true" tabindex="-1"></a>M1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.875</span>   <span class="fl">0.125</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9555"><a href="#cb375-9555" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9556"><a href="#cb375-9556" aria-hidden="true" tabindex="-1"></a>I1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9557"><a href="#cb375-9557" aria-hidden="true" tabindex="-1"></a>M2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.857</span>   <span class="fl">0.143</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9558"><a href="#cb375-9558" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span> <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9559"><a href="#cb375-9559" aria-hidden="true" tabindex="-1"></a>I2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9560"><a href="#cb375-9560" aria-hidden="true" tabindex="-1"></a>M3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span></span>
<span id="cb375-9561"><a href="#cb375-9561" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span></span>
<span id="cb375-9562"><a href="#cb375-9562" aria-hidden="true" tabindex="-1"></a>I3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9563"><a href="#cb375-9563" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9564"><a href="#cb375-9564" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9565"><a href="#cb375-9565" aria-hidden="true" tabindex="-1"></a>    A   B   C   D   E</span>
<span id="cb375-9566"><a href="#cb375-9566" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9567"><a href="#cb375-9567" aria-hidden="true" tabindex="-1"></a>I0  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9568"><a href="#cb375-9568" aria-hidden="true" tabindex="-1"></a>M1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">1.0</span></span>
<span id="cb375-9569"><a href="#cb375-9569" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9570"><a href="#cb375-9570" aria-hidden="true" tabindex="-1"></a>I1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9571"><a href="#cb375-9571" aria-hidden="true" tabindex="-1"></a>M2  <span class="dv">0</span>   <span class="fl">0.857</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.143</span></span>
<span id="cb375-9572"><a href="#cb375-9572" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9573"><a href="#cb375-9573" aria-hidden="true" tabindex="-1"></a>I2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9574"><a href="#cb375-9574" aria-hidden="true" tabindex="-1"></a>M3  <span class="fl">0.143</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.714</span>   <span class="fl">0.143</span></span>
<span id="cb375-9575"><a href="#cb375-9575" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9576"><a href="#cb375-9576" aria-hidden="true" tabindex="-1"></a>I3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9577"><a href="#cb375-9577" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9578"><a href="#cb375-9578" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9579"><a href="#cb375-9579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9580"><a href="#cb375-9580" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-9581"><a href="#cb375-9581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9582"><a href="#cb375-9582" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-9583"><a href="#cb375-9583" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-9584"><a href="#cb375-9584" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-9585"><a href="#cb375-9585" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb375-9586"><a href="#cb375-9586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9587"><a href="#cb375-9587" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb375-9588"><a href="#cb375-9588" aria-hidden="true" tabindex="-1"></a>    threshold <span class="op">=</span> <span class="bu">float</span>(<span class="bu">next</span>(input_iterator).rstrip())</span>
<span id="cb375-9589"><a href="#cb375-9589" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9590"><a href="#cb375-9590" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb375-9591"><a href="#cb375-9591" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-9592"><a href="#cb375-9592" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_iterator])</span>
<span id="cb375-9593"><a href="#cb375-9593" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, alphabet, alignment</span>
<span id="cb375-9594"><a href="#cb375-9594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9595"><a href="#cb375-9595" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-9596"><a href="#cb375-9596" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb375-9597"><a href="#cb375-9597" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-9598"><a href="#cb375-9598" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-9599"><a href="#cb375-9599" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb375-9600"><a href="#cb375-9600" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9601"><a href="#cb375-9601" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9602"><a href="#cb375-9602" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb375-9603"><a href="#cb375-9603" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-9604"><a href="#cb375-9604" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb375-9605"><a href="#cb375-9605" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb375-9606"><a href="#cb375-9606" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb375-9607"><a href="#cb375-9607" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb375-9608"><a href="#cb375-9608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9609"><a href="#cb375-9609" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9610"><a href="#cb375-9610" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb375-9611"><a href="#cb375-9611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9612"><a href="#cb375-9612" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-9613"><a href="#cb375-9613" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-9614"><a href="#cb375-9614" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb375-9615"><a href="#cb375-9615" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb375-9616"><a href="#cb375-9616" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-9617"><a href="#cb375-9617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9618"><a href="#cb375-9618" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probabilities(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-9619"><a href="#cb375-9619" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-9620"><a href="#cb375-9620" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb375-9621"><a href="#cb375-9621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9622"><a href="#cb375-9622" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probabilities(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-9623"><a href="#cb375-9623" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-9624"><a href="#cb375-9624" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb375-9625"><a href="#cb375-9625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9626"><a href="#cb375-9626" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-9627"><a href="#cb375-9627" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb375-9628"><a href="#cb375-9628" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-9629"><a href="#cb375-9629" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb375-9630"><a href="#cb375-9630" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb375-9631"><a href="#cb375-9631" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb375-9632"><a href="#cb375-9632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9633"><a href="#cb375-9633" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9634"><a href="#cb375-9634" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-9635"><a href="#cb375-9635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9636"><a href="#cb375-9636" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9637"><a href="#cb375-9637" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-9638"><a href="#cb375-9638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9639"><a href="#cb375-9639" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb375-9640"><a href="#cb375-9640" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb375-9641"><a href="#cb375-9641" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb375-9642"><a href="#cb375-9642" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb375-9643"><a href="#cb375-9643" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb375-9644"><a href="#cb375-9644" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb375-9645"><a href="#cb375-9645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9646"><a href="#cb375-9646" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb375-9647"><a href="#cb375-9647" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-9648"><a href="#cb375-9648" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb375-9649"><a href="#cb375-9649" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb375-9650"><a href="#cb375-9650" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb375-9651"><a href="#cb375-9651" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9652"><a href="#cb375-9652" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb375-9653"><a href="#cb375-9653" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb375-9654"><a href="#cb375-9654" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-9655"><a href="#cb375-9655" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb375-9656"><a href="#cb375-9656" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9657"><a href="#cb375-9657" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb375-9658"><a href="#cb375-9658" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-9659"><a href="#cb375-9659" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb375-9660"><a href="#cb375-9660" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb375-9661"><a href="#cb375-9661" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9662"><a href="#cb375-9662" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb375-9663"><a href="#cb375-9663" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb375-9664"><a href="#cb375-9664" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9665"><a href="#cb375-9665" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9666"><a href="#cb375-9666" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9667"><a href="#cb375-9667" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb375-9668"><a href="#cb375-9668" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb375-9669"><a href="#cb375-9669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9670"><a href="#cb375-9670" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb375-9671"><a href="#cb375-9671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9672"><a href="#cb375-9672" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-9673"><a href="#cb375-9673" aria-hidden="true" tabindex="-1"></a><span class="st">0.289</span></span>
<span id="cb375-9674"><a href="#cb375-9674" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9675"><a href="#cb375-9675" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb375-9676"><a href="#cb375-9676" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9677"><a href="#cb375-9677" aria-hidden="true" tabindex="-1"></a><span class="st">EBA</span></span>
<span id="cb375-9678"><a href="#cb375-9678" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb375-9679"><a href="#cb375-9679" aria-hidden="true" tabindex="-1"></a><span class="st">EB-</span></span>
<span id="cb375-9680"><a href="#cb375-9680" aria-hidden="true" tabindex="-1"></a><span class="st">EED</span></span>
<span id="cb375-9681"><a href="#cb375-9681" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb375-9682"><a href="#cb375-9682" aria-hidden="true" tabindex="-1"></a><span class="st">EBE</span></span>
<span id="cb375-9683"><a href="#cb375-9683" aria-hidden="true" tabindex="-1"></a><span class="st">E-D</span></span>
<span id="cb375-9684"><a href="#cb375-9684" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb375-9685"><a href="#cb375-9685" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-9686"><a href="#cb375-9686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9687"><a href="#cb375-9687" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb375-9688"><a href="#cb375-9688" aria-hidden="true" tabindex="-1"></a>threshold, alphabet, alignment <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb375-9689"><a href="#cb375-9689" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb375-9690"><a href="#cb375-9690" aria-hidden="true" tabindex="-1"></a>print_transition_probabilities(transition_probs)</span>
<span id="cb375-9691"><a href="#cb375-9691" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb375-9692"><a href="#cb375-9692" aria-hidden="true" tabindex="-1"></a>print_emission_probabilities(emission_probs, alphabet)</span>
<span id="cb375-9693"><a href="#cb375-9693" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9694"><a href="#cb375-9694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9695"><a href="#cb375-9695" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct a Profile HMM with Pseudocounts</span></span>
<span id="cb375-9696"><a href="#cb375-9696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9697"><a href="#cb375-9697" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A threshold&nbsp;<span class="op">*</span>θ<span class="op">*</span>&nbsp;and a pseudocount&nbsp;<span class="op">*</span>σ<span class="op">*</span>, followed by an alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>, followed by a multiple alignment&nbsp;<span class="op">*</span>Alignment<span class="op">*</span>&nbsp;whose strings are formed from&nbsp;<span class="op">*</span>Σ<span class="op">*</span>.</span>
<span id="cb375-9698"><a href="#cb375-9698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9699"><a href="#cb375-9699" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The transition <span class="kw">and</span> emission probabilities of the profile HMM&nbsp;<span class="op">*</span>HMM<span class="op">*</span>(<span class="op">*</span>Alignment<span class="op">*</span>,&nbsp;<span class="op">*</span>θ<span class="op">*</span>,&nbsp;<span class="op">*</span>σ<span class="op">*</span>).</span>
<span id="cb375-9700"><a href="#cb375-9700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9701"><a href="#cb375-9701" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-9702"><a href="#cb375-9702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9703"><a href="#cb375-9703" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9704"><a href="#cb375-9704" aria-hidden="true" tabindex="-1"></a><span class="fl">0.358</span>   <span class="fl">0.01</span></span>
<span id="cb375-9705"><a href="#cb375-9705" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9706"><a href="#cb375-9706" aria-hidden="true" tabindex="-1"></a>A   B   C   D   E</span>
<span id="cb375-9707"><a href="#cb375-9707" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9708"><a href="#cb375-9708" aria-hidden="true" tabindex="-1"></a>ADA</span>
<span id="cb375-9709"><a href="#cb375-9709" aria-hidden="true" tabindex="-1"></a>ADA</span>
<span id="cb375-9710"><a href="#cb375-9710" aria-hidden="true" tabindex="-1"></a>AAA</span>
<span id="cb375-9711"><a href="#cb375-9711" aria-hidden="true" tabindex="-1"></a>ADC</span>
<span id="cb375-9712"><a href="#cb375-9712" aria-hidden="true" tabindex="-1"></a><span class="op">-</span>DA</span>
<span id="cb375-9713"><a href="#cb375-9713" aria-hidden="true" tabindex="-1"></a>D<span class="op">-</span>A</span>
<span id="cb375-9714"><a href="#cb375-9714" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9715"><a href="#cb375-9715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9716"><a href="#cb375-9716" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-9717"><a href="#cb375-9717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9718"><a href="#cb375-9718" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9719"><a href="#cb375-9719" aria-hidden="true" tabindex="-1"></a>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E</span>
<span id="cb375-9720"><a href="#cb375-9720" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.819</span>   <span class="fl">0.172</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9721"><a href="#cb375-9721" aria-hidden="true" tabindex="-1"></a>I0  <span class="dv">0</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9722"><a href="#cb375-9722" aria-hidden="true" tabindex="-1"></a>M1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.786</span>   <span class="fl">0.204</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9723"><a href="#cb375-9723" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.981</span>   <span class="fl">0.01</span>    <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9724"><a href="#cb375-9724" aria-hidden="true" tabindex="-1"></a>I1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9725"><a href="#cb375-9725" aria-hidden="true" tabindex="-1"></a>M2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.981</span>   <span class="fl">0.01</span>    <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9726"><a href="#cb375-9726" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.981</span>   <span class="fl">0.01</span>    <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9727"><a href="#cb375-9727" aria-hidden="true" tabindex="-1"></a>I2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9728"><a href="#cb375-9728" aria-hidden="true" tabindex="-1"></a>M3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.01</span>    <span class="fl">0.99</span></span>
<span id="cb375-9729"><a href="#cb375-9729" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.5</span> <span class="fl">0.5</span></span>
<span id="cb375-9730"><a href="#cb375-9730" aria-hidden="true" tabindex="-1"></a>I3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="fl">0.5</span> <span class="fl">0.5</span></span>
<span id="cb375-9731"><a href="#cb375-9731" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9732"><a href="#cb375-9732" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9733"><a href="#cb375-9733" aria-hidden="true" tabindex="-1"></a>    A   B   C   D   E</span>
<span id="cb375-9734"><a href="#cb375-9734" aria-hidden="true" tabindex="-1"></a>S   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9735"><a href="#cb375-9735" aria-hidden="true" tabindex="-1"></a>I0  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb375-9736"><a href="#cb375-9736" aria-hidden="true" tabindex="-1"></a>M1  <span class="fl">0.771</span>   <span class="fl">0.01</span>    <span class="fl">0.01</span>    <span class="fl">0.2</span> <span class="fl">0.01</span></span>
<span id="cb375-9737"><a href="#cb375-9737" aria-hidden="true" tabindex="-1"></a>D1  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9738"><a href="#cb375-9738" aria-hidden="true" tabindex="-1"></a>I1  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb375-9739"><a href="#cb375-9739" aria-hidden="true" tabindex="-1"></a>M2  <span class="fl">0.2</span> <span class="fl">0.01</span>    <span class="fl">0.01</span>    <span class="fl">0.771</span>   <span class="fl">0.01</span></span>
<span id="cb375-9740"><a href="#cb375-9740" aria-hidden="true" tabindex="-1"></a>D2  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9741"><a href="#cb375-9741" aria-hidden="true" tabindex="-1"></a>I2  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb375-9742"><a href="#cb375-9742" aria-hidden="true" tabindex="-1"></a>M3  <span class="fl">0.803</span>   <span class="fl">0.01</span>    <span class="fl">0.168</span>   <span class="fl">0.01</span>    <span class="fl">0.01</span></span>
<span id="cb375-9743"><a href="#cb375-9743" aria-hidden="true" tabindex="-1"></a>D3  <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9744"><a href="#cb375-9744" aria-hidden="true" tabindex="-1"></a>I3  <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span> <span class="fl">0.2</span></span>
<span id="cb375-9745"><a href="#cb375-9745" aria-hidden="true" tabindex="-1"></a>E   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span>   <span class="dv">0</span></span>
<span id="cb375-9746"><a href="#cb375-9746" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9747"><a href="#cb375-9747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9748"><a href="#cb375-9748" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-9749"><a href="#cb375-9749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9750"><a href="#cb375-9750" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-9751"><a href="#cb375-9751" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-9752"><a href="#cb375-9752" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-9753"><a href="#cb375-9753" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb375-9754"><a href="#cb375-9754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9755"><a href="#cb375-9755" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9756"><a href="#cb375-9756" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb375-9757"><a href="#cb375-9757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9758"><a href="#cb375-9758" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9759"><a href="#cb375-9759" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb375-9760"><a href="#cb375-9760" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-9761"><a href="#cb375-9761" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb375-9762"><a href="#cb375-9762" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb375-9763"><a href="#cb375-9763" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb375-9764"><a href="#cb375-9764" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb375-9765"><a href="#cb375-9765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9766"><a href="#cb375-9766" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-9767"><a href="#cb375-9767" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-9768"><a href="#cb375-9768" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb375-9769"><a href="#cb375-9769" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb375-9770"><a href="#cb375-9770" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-9771"><a href="#cb375-9771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9772"><a href="#cb375-9772" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probs(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-9773"><a href="#cb375-9773" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-9774"><a href="#cb375-9774" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb375-9775"><a href="#cb375-9775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9776"><a href="#cb375-9776" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probs(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-9777"><a href="#cb375-9777" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-9778"><a href="#cb375-9778" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb375-9779"><a href="#cb375-9779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9780"><a href="#cb375-9780" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-9781"><a href="#cb375-9781" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb375-9782"><a href="#cb375-9782" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-9783"><a href="#cb375-9783" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb375-9784"><a href="#cb375-9784" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb375-9785"><a href="#cb375-9785" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb375-9786"><a href="#cb375-9786" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9787"><a href="#cb375-9787" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9788"><a href="#cb375-9788" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-9789"><a href="#cb375-9789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9790"><a href="#cb375-9790" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9791"><a href="#cb375-9791" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-9792"><a href="#cb375-9792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9793"><a href="#cb375-9793" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-9794"><a href="#cb375-9794" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb375-9795"><a href="#cb375-9795" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-9796"><a href="#cb375-9796" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-9797"><a href="#cb375-9797" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb375-9798"><a href="#cb375-9798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9799"><a href="#cb375-9799" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb375-9800"><a href="#cb375-9800" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb375-9801"><a href="#cb375-9801" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb375-9802"><a href="#cb375-9802" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb375-9803"><a href="#cb375-9803" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb375-9804"><a href="#cb375-9804" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb375-9805"><a href="#cb375-9805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9806"><a href="#cb375-9806" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb375-9807"><a href="#cb375-9807" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-9808"><a href="#cb375-9808" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb375-9809"><a href="#cb375-9809" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb375-9810"><a href="#cb375-9810" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb375-9811"><a href="#cb375-9811" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9812"><a href="#cb375-9812" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb375-9813"><a href="#cb375-9813" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb375-9814"><a href="#cb375-9814" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-9815"><a href="#cb375-9815" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb375-9816"><a href="#cb375-9816" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9817"><a href="#cb375-9817" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb375-9818"><a href="#cb375-9818" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-9819"><a href="#cb375-9819" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb375-9820"><a href="#cb375-9820" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb375-9821"><a href="#cb375-9821" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9822"><a href="#cb375-9822" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb375-9823"><a href="#cb375-9823" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb375-9824"><a href="#cb375-9824" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9825"><a href="#cb375-9825" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9826"><a href="#cb375-9826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9827"><a href="#cb375-9827" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb375-9828"><a href="#cb375-9828" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb375-9829"><a href="#cb375-9829" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9830"><a href="#cb375-9830" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb375-9831"><a href="#cb375-9831" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9832"><a href="#cb375-9832" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb375-9833"><a href="#cb375-9833" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_handle).rstrip().split())</span>
<span id="cb375-9834"><a href="#cb375-9834" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb375-9835"><a href="#cb375-9835" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_handle).split()</span>
<span id="cb375-9836"><a href="#cb375-9836" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb375-9837"><a href="#cb375-9837" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_handle])</span>
<span id="cb375-9838"><a href="#cb375-9838" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, pseudocount, alphabet, alignment</span>
<span id="cb375-9839"><a href="#cb375-9839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9840"><a href="#cb375-9840" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_transition_pseudocounts(transition_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9841"><a href="#cb375-9841" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-9842"><a href="#cb375-9842" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9843"><a href="#cb375-9843" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9844"><a href="#cb375-9844" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb375-9845"><a href="#cb375-9845" aria-hidden="true" tabindex="-1"></a>        transition_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span> : i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">5</span>, (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span> : (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9846"><a href="#cb375-9846" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(transition_matrix)</span>
<span id="cb375-9847"><a href="#cb375-9847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9848"><a href="#cb375-9848" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_emission_pseudocounts(emission_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9849"><a href="#cb375-9849" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-9850"><a href="#cb375-9850" aria-hidden="true" tabindex="-1"></a>    emission_matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9851"><a href="#cb375-9851" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb375-9852"><a href="#cb375-9852" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9853"><a href="#cb375-9853" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9854"><a href="#cb375-9854" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(emission_matrix)</span>
<span id="cb375-9855"><a href="#cb375-9855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9856"><a href="#cb375-9856" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_pseudocount_profile_hmm(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb375-9857"><a href="#cb375-9857" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb375-9858"><a href="#cb375-9858" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_transition_pseudocounts(transition_probs, pseudocount)</span>
<span id="cb375-9859"><a href="#cb375-9859" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_emission_pseudocounts(emission_probs, pseudocount)</span>
<span id="cb375-9860"><a href="#cb375-9860" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb375-9861"><a href="#cb375-9861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9862"><a href="#cb375-9862" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-9863"><a href="#cb375-9863" aria-hidden="true" tabindex="-1"></a><span class="st">0.358   0.01</span></span>
<span id="cb375-9864"><a href="#cb375-9864" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9865"><a href="#cb375-9865" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb375-9866"><a href="#cb375-9866" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-9867"><a href="#cb375-9867" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb375-9868"><a href="#cb375-9868" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb375-9869"><a href="#cb375-9869" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb375-9870"><a href="#cb375-9870" aria-hidden="true" tabindex="-1"></a><span class="st">ADC</span></span>
<span id="cb375-9871"><a href="#cb375-9871" aria-hidden="true" tabindex="-1"></a><span class="st">-DA</span></span>
<span id="cb375-9872"><a href="#cb375-9872" aria-hidden="true" tabindex="-1"></a><span class="st">D-A</span></span>
<span id="cb375-9873"><a href="#cb375-9873" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-9874"><a href="#cb375-9874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9875"><a href="#cb375-9875" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb375-9876"><a href="#cb375-9876" aria-hidden="true" tabindex="-1"></a>threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb375-9877"><a href="#cb375-9877" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_pseudocount_profile_hmm(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb375-9878"><a href="#cb375-9878" aria-hidden="true" tabindex="-1"></a>print_transition_probs(transition_probs)</span>
<span id="cb375-9879"><a href="#cb375-9879" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb375-9880"><a href="#cb375-9880" aria-hidden="true" tabindex="-1"></a>print_emission_probs(emission_probs, alphabet)</span>
<span id="cb375-9881"><a href="#cb375-9881" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9882"><a href="#cb375-9882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9883"><a href="#cb375-9883" aria-hidden="true" tabindex="-1"></a><span class="co"># Perform a Multiple Sequence Alignment with a Profile HMM</span></span>
<span id="cb375-9884"><a href="#cb375-9884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9885"><a href="#cb375-9885" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string Text, a multiple alignment Alignment, a threshold θ, <span class="kw">and</span> a pseudocount σ.</span>
<span id="cb375-9886"><a href="#cb375-9886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9887"><a href="#cb375-9887" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An optimal hidden path emitting Text <span class="kw">in</span> HMM(Alignment,θ,σ).</span>
<span id="cb375-9888"><a href="#cb375-9888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9889"><a href="#cb375-9889" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-9890"><a href="#cb375-9890" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9891"><a href="#cb375-9891" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9892"><a href="#cb375-9892" aria-hidden="true" tabindex="-1"></a>AEFDFDC</span>
<span id="cb375-9893"><a href="#cb375-9893" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9894"><a href="#cb375-9894" aria-hidden="true" tabindex="-1"></a><span class="fl">0.4</span> <span class="fl">0.01</span></span>
<span id="cb375-9895"><a href="#cb375-9895" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9896"><a href="#cb375-9896" aria-hidden="true" tabindex="-1"></a>A   B   C   D   E   F</span>
<span id="cb375-9897"><a href="#cb375-9897" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-9898"><a href="#cb375-9898" aria-hidden="true" tabindex="-1"></a>ACDEFACADF</span>
<span id="cb375-9899"><a href="#cb375-9899" aria-hidden="true" tabindex="-1"></a>AFDA<span class="op">---</span>CCF</span>
<span id="cb375-9900"><a href="#cb375-9900" aria-hidden="true" tabindex="-1"></a>A<span class="op">--</span>EFD<span class="op">-</span>FDC</span>
<span id="cb375-9901"><a href="#cb375-9901" aria-hidden="true" tabindex="-1"></a>ACAEF<span class="op">--</span>A<span class="op">-</span>C</span>
<span id="cb375-9902"><a href="#cb375-9902" aria-hidden="true" tabindex="-1"></a>ADDEFAAADF</span>
<span id="cb375-9903"><a href="#cb375-9903" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9904"><a href="#cb375-9904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9905"><a href="#cb375-9905" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-9906"><a href="#cb375-9906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9907"><a href="#cb375-9907" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9908"><a href="#cb375-9908" aria-hidden="true" tabindex="-1"></a>M1 D2 D3 M4 M5 I5 M6 M7 M8</span>
<span id="cb375-9909"><a href="#cb375-9909" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-9910"><a href="#cb375-9910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9911"><a href="#cb375-9911" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-9912"><a href="#cb375-9912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9913"><a href="#cb375-9913" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-9914"><a href="#cb375-9914" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-9915"><a href="#cb375-9915" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-9916"><a href="#cb375-9916" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator</span>
<span id="cb375-9917"><a href="#cb375-9917" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-9918"><a href="#cb375-9918" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf, log</span>
<span id="cb375-9919"><a href="#cb375-9919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9920"><a href="#cb375-9920" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-9921"><a href="#cb375-9921" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb375-9922"><a href="#cb375-9922" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-9923"><a href="#cb375-9923" aria-hidden="true" tabindex="-1"></a>        labels.extend([<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>])</span>
<span id="cb375-9924"><a href="#cb375-9924" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb375-9925"><a href="#cb375-9925" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb375-9926"><a href="#cb375-9926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9927"><a href="#cb375-9927" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9928"><a href="#cb375-9928" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb375-9929"><a href="#cb375-9929" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-9930"><a href="#cb375-9930" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb375-9931"><a href="#cb375-9931" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb375-9932"><a href="#cb375-9932" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb375-9933"><a href="#cb375-9933" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb375-9934"><a href="#cb375-9934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9935"><a href="#cb375-9935" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9936"><a href="#cb375-9936" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb375-9937"><a href="#cb375-9937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9938"><a href="#cb375-9938" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9939"><a href="#cb375-9939" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-9940"><a href="#cb375-9940" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9941"><a href="#cb375-9941" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(num_states: <span class="bu">int</span>, num_symbols: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9942"><a href="#cb375-9942" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_symbols), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-9943"><a href="#cb375-9943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9944"><a href="#cb375-9944" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_index(state_num: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-9945"><a href="#cb375-9945" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb375-9946"><a href="#cb375-9946" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (state_num <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb375-9947"><a href="#cb375-9947" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-9948"><a href="#cb375-9948" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> state_num <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb375-9949"><a href="#cb375-9949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9950"><a href="#cb375-9950" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb375-9951"><a href="#cb375-9951" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb375-9952"><a href="#cb375-9952" aria-hidden="true" tabindex="-1"></a>    valid_length <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb375-9953"><a href="#cb375-9953" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_length <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb375-9954"><a href="#cb375-9954" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_length)</span>
<span id="cb375-9955"><a href="#cb375-9955" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_length, <span class="bu">len</span>(alphabet))</span>
<span id="cb375-9956"><a href="#cb375-9956" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9957"><a href="#cb375-9957" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb375-9958"><a href="#cb375-9958" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-9959"><a href="#cb375-9959" aria-hidden="true" tabindex="-1"></a>        valid_col_count <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb375-9960"><a href="#cb375-9960" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb375-9961"><a href="#cb375-9961" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[col]:</span>
<span id="cb375-9962"><a href="#cb375-9962" aria-hidden="true" tabindex="-1"></a>                valid_col_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9963"><a href="#cb375-9963" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb375-9964"><a href="#cb375-9964" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"del"</span>)</span>
<span id="cb375-9965"><a href="#cb375-9965" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-9966"><a href="#cb375-9966" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"match"</span>)</span>
<span id="cb375-9967"><a href="#cb375-9967" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9968"><a href="#cb375-9968" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb375-9969"><a href="#cb375-9969" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-9970"><a href="#cb375-9970" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb375-9971"><a href="#cb375-9971" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"ins"</span>)</span>
<span id="cb375-9972"><a href="#cb375-9972" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9973"><a href="#cb375-9973" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb375-9974"><a href="#cb375-9974" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb375-9975"><a href="#cb375-9975" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9976"><a href="#cb375-9976" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-9977"><a href="#cb375-9977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9978"><a href="#cb375-9978" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb375-9979"><a href="#cb375-9979" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb375-9980"><a href="#cb375-9980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9981"><a href="#cb375-9981" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb375-9982"><a href="#cb375-9982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9983"><a href="#cb375-9983" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_transitions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9984"><a href="#cb375-9984" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-9985"><a href="#cb375-9985" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9986"><a href="#cb375-9986" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9987"><a href="#cb375-9987" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb375-9988"><a href="#cb375-9988" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>:i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">5</span>, (i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>:(i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9989"><a href="#cb375-9989" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb375-9990"><a href="#cb375-9990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9991"><a href="#cb375-9991" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_emissions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-9992"><a href="#cb375-9992" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-9993"><a href="#cb375-9993" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9994"><a href="#cb375-9994" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb375-9995"><a href="#cb375-9995" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9996"><a href="#cb375-9996" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb375-9997"><a href="#cb375-9997" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb375-9998"><a href="#cb375-9998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-9999"><a href="#cb375-9999" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm_with_pseudocounts(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb375-10000"><a href="#cb375-10000" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb375-10001"><a href="#cb375-10001" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_pseudocounts_to_transitions(transition_probs, pseudocount)</span>
<span id="cb375-10002"><a href="#cb375-10002" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_pseudocounts_to_emissions(emission_probs, pseudocount)</span>
<span id="cb375-10003"><a href="#cb375-10003" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb375-10004"><a href="#cb375-10004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10005"><a href="#cb375-10005" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input_data(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb375-10006"><a href="#cb375-10006" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb375-10007"><a href="#cb375-10007" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-10008"><a href="#cb375-10008" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_iterator).rstrip().split())</span>
<span id="cb375-10009"><a href="#cb375-10009" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-10010"><a href="#cb375-10010" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb375-10011"><a href="#cb375-10011" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb375-10012"><a href="#cb375-10012" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(x.strip()) <span class="cf">for</span> x <span class="kw">in</span> input_iterator])</span>
<span id="cb375-10013"><a href="#cb375-10013" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, threshold, pseudocount, alphabet, alignment</span>
<span id="cb375-10014"><a href="#cb375-10014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10015"><a href="#cb375-10015" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_transition_probs_to_dict(matrix: np.ndarray) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb375-10016"><a href="#cb375-10016" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb375-10017"><a href="#cb375-10017" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-10018"><a href="#cb375-10018" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb375-10019"><a href="#cb375-10019" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb375-10020"><a href="#cb375-10020" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb375-10021"><a href="#cb375-10021" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb375-10022"><a href="#cb375-10022" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb375-10023"><a href="#cb375-10023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10024"><a href="#cb375-10024" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_emission_probs_to_dict(matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb375-10025"><a href="#cb375-10025" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb375-10026"><a href="#cb375-10026" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-10027"><a href="#cb375-10027" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb375-10028"><a href="#cb375-10028" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb375-10029"><a href="#cb375-10029" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(alphabet):</span>
<span id="cb375-10030"><a href="#cb375-10030" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], symbol] <span class="op">=</span> matrix[i][j]</span>
<span id="cb375-10031"><a href="#cb375-10031" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb375-10032"><a href="#cb375-10032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10033"><a href="#cb375-10033" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_hmm_graph(transition_probs: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb375-10034"><a href="#cb375-10034" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10035"><a href="#cb375-10035" aria-hidden="true" tabindex="-1"></a>        graph[source].append({<span class="st">"node"</span>: target, <span class="st">"weight"</span>: transition_probs[source, target]})</span>
<span id="cb375-10036"><a href="#cb375-10036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10037"><a href="#cb375-10037" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-10038"><a href="#cb375-10038" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target <span class="kw">in</span> [<span class="st">"I0"</span>, <span class="st">"M1"</span>, <span class="st">"D1"</span>]:</span>
<span id="cb375-10039"><a href="#cb375-10039" aria-hidden="true" tabindex="-1"></a>        add_edge(<span class="st">"S"</span>, target)</span>
<span id="cb375-10040"><a href="#cb375-10040" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb375-10041"><a href="#cb375-10041" aria-hidden="true" tabindex="-1"></a>        source <span class="op">=</span> <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb375-10042"><a href="#cb375-10042" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [source, <span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb375-10043"><a href="#cb375-10043" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb375-10044"><a href="#cb375-10044" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states):</span>
<span id="cb375-10045"><a href="#cb375-10045" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb375-10046"><a href="#cb375-10046" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb375-10047"><a href="#cb375-10047" aria-hidden="true" tabindex="-1"></a>                add_edge(source, target)</span>
<span id="cb375-10048"><a href="#cb375-10048" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb375-10049"><a href="#cb375-10049" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="st">"E"</span>]:</span>
<span id="cb375-10050"><a href="#cb375-10050" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb375-10051"><a href="#cb375-10051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10052"><a href="#cb375-10052" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-10053"><a href="#cb375-10053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10054"><a href="#cb375-10054" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_topological_order(num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-10055"><a href="#cb375-10055" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"S"</span>, <span class="dv">0</span>)</span>
<span id="cb375-10056"><a href="#cb375-10056" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb375-10057"><a href="#cb375-10057" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="ss">f"D</span><span class="sc">{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)</span>
<span id="cb375-10058"><a href="#cb375-10058" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(seq_length):</span>
<span id="cb375-10059"><a href="#cb375-10059" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="st">"I0"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-10060"><a href="#cb375-10060" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb375-10061"><a href="#cb375-10061" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> state_type <span class="kw">in</span> [<span class="st">"M"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>]:</span>
<span id="cb375-10062"><a href="#cb375-10062" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (<span class="ss">f"</span><span class="sc">{</span>state_type<span class="sc">}{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-10063"><a href="#cb375-10063" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"E"</span>, seq_length <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-10064"><a href="#cb375-10064" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10065"><a href="#cb375-10065" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_nodes(current_node: <span class="bu">str</span>, current_col: <span class="bu">int</span>, num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb375-10066"><a href="#cb375-10066" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"E"</span>:</span>
<span id="cb375-10067"><a href="#cb375-10067" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length)]</span>
<span id="cb375-10068"><a href="#cb375-10068" aria-hidden="true" tabindex="-1"></a>    state_num <span class="op">=</span> <span class="bu">int</span>(current_node[<span class="dv">1</span>:])</span>
<span id="cb375-10069"><a href="#cb375-10069" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb375-10070"><a href="#cb375-10070" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)]</span>
<span id="cb375-10071"><a href="#cb375-10071" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"I0"</span>:</span>
<span id="cb375-10072"><a href="#cb375-10072" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb375-10073"><a href="#cb375-10073" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"M1"</span>:</span>
<span id="cb375-10074"><a href="#cb375-10074" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb375-10075"><a href="#cb375-10075" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"I"</span>:</span>
<span id="cb375-10076"><a href="#cb375-10076" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb375-10077"><a href="#cb375-10077" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"M"</span>:</span>
<span id="cb375-10078"><a href="#cb375-10078" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb375-10079"><a href="#cb375-10079" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"D"</span>:</span>
<span id="cb375-10080"><a href="#cb375-10080" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"I0"</span>, current_col)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col)]</span>
<span id="cb375-10081"><a href="#cb375-10081" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-10082"><a href="#cb375-10082" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Unhandled node: </span><span class="sc">{</span>current_node<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-10083"><a href="#cb375-10083" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb375-10084"><a href="#cb375-10084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10085"><a href="#cb375-10085" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplify_graph(graph: Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">float</span>]]:</span>
<span id="cb375-10086"><a href="#cb375-10086" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {k: {x[<span class="st">"node"</span>]: x[<span class="st">"weight"</span>] <span class="cf">for</span> x <span class="kw">in</span> v} <span class="cf">for</span> k, v <span class="kw">in</span> graph.items()}</span>
<span id="cb375-10087"><a href="#cb375-10087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10088"><a href="#cb375-10088" aria-hidden="true" tabindex="-1"></a><span class="co"># Main execution</span></span>
<span id="cb375-10089"><a href="#cb375-10089" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input):</span>
<span id="cb375-10090"><a href="#cb375-10090" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb375-10091"><a href="#cb375-10091" aria-hidden="true" tabindex="-1"></a>    sequence, threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input_data(input_lines)</span>
<span id="cb375-10092"><a href="#cb375-10092" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm_with_pseudocounts(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb375-10093"><a href="#cb375-10093" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (transition_probs.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb375-10094"><a href="#cb375-10094" aria-hidden="true" tabindex="-1"></a>    transition_probs_dict <span class="op">=</span> convert_transition_probs_to_dict(transition_probs)</span>
<span id="cb375-10095"><a href="#cb375-10095" aria-hidden="true" tabindex="-1"></a>    emission_probs_dict <span class="op">=</span> convert_emission_probs_to_dict(emission_probs, alphabet)</span>
<span id="cb375-10096"><a href="#cb375-10096" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10097"><a href="#cb375-10097" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> build_hmm_graph(transition_probs_dict, num_states)</span>
<span id="cb375-10098"><a href="#cb375-10098" aria-hidden="true" tabindex="-1"></a>    topological_order <span class="op">=</span> generate_topological_order(num_states, <span class="bu">len</span>(sequence))</span>
<span id="cb375-10099"><a href="#cb375-10099" aria-hidden="true" tabindex="-1"></a>    simplified_graph <span class="op">=</span> simplify_graph(graph)</span>
<span id="cb375-10100"><a href="#cb375-10100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10101"><a href="#cb375-10101" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dynamic programming to find the most probable path</span></span>
<span id="cb375-10102"><a href="#cb375-10102" aria-hidden="true" tabindex="-1"></a>    previous_node <span class="op">=</span> <span class="bu">next</span>(topological_order)</span>
<span id="cb375-10103"><a href="#cb375-10103" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {previous_node: <span class="dv">0</span>}</span>
<span id="cb375-10104"><a href="#cb375-10104" aria-hidden="true" tabindex="-1"></a>    backpointers <span class="op">=</span> {previous_node: (<span class="va">None</span>, <span class="va">None</span>)}</span>
<span id="cb375-10105"><a href="#cb375-10105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10106"><a href="#cb375-10106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_node, current_col <span class="kw">in</span> topological_order:</span>
<span id="cb375-10107"><a href="#cb375-10107" aria-hidden="true" tabindex="-1"></a>        backpointers[(current_node, current_col)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-10108"><a href="#cb375-10108" aria-hidden="true" tabindex="-1"></a>        scores[(current_node, current_col)] <span class="op">=</span> <span class="op">-</span>inf</span>
<span id="cb375-10109"><a href="#cb375-10109" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> prev_node, prev_col <span class="kw">in</span> get_previous_nodes(current_node, current_col, num_states, <span class="bu">len</span>(sequence)):</span>
<span id="cb375-10110"><a href="#cb375-10110" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_col <span class="op">&lt;</span> current_col <span class="kw">and</span> current_node <span class="op">!=</span> <span class="st">"E"</span>:</span>
<span id="cb375-10111"><a href="#cb375-10111" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> emission_probs_dict[current_node, sequence[current_col <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb375-10112"><a href="#cb375-10112" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-10113"><a href="#cb375-10113" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-10114"><a href="#cb375-10114" aria-hidden="true" tabindex="-1"></a>            log_prob <span class="op">=</span> log(simplified_graph[prev_node][current_node]) <span class="op">+</span> log(emission_prob) <span class="op">+</span> scores[(prev_node, prev_col)]</span>
<span id="cb375-10115"><a href="#cb375-10115" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> log_prob <span class="op">&gt;</span> scores[(current_node, current_col)]:</span>
<span id="cb375-10116"><a href="#cb375-10116" aria-hidden="true" tabindex="-1"></a>                scores[(current_node, current_col)] <span class="op">=</span> log_prob</span>
<span id="cb375-10117"><a href="#cb375-10117" aria-hidden="true" tabindex="-1"></a>                backpointers[(current_node, current_col)] <span class="op">=</span> (prev_node, prev_col)</span>
<span id="cb375-10118"><a href="#cb375-10118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10119"><a href="#cb375-10119" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to find the path</span></span>
<span id="cb375-10120"><a href="#cb375-10120" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> []</span>
<span id="cb375-10121"><a href="#cb375-10121" aria-hidden="true" tabindex="-1"></a>    position <span class="op">=</span> (<span class="st">"E"</span>, <span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb375-10122"><a href="#cb375-10122" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> position[<span class="dv">0</span>]:</span>
<span id="cb375-10123"><a href="#cb375-10123" aria-hidden="true" tabindex="-1"></a>        path.append(backpointers[position][<span class="dv">0</span>])</span>
<span id="cb375-10124"><a href="#cb375-10124" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> backpointers[position]</span>
<span id="cb375-10125"><a href="#cb375-10125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10126"><a href="#cb375-10126" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>path[::<span class="op">-</span><span class="dv">1</span>][<span class="dv">2</span>:])</span>
<span id="cb375-10127"><a href="#cb375-10127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10128"><a href="#cb375-10128" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-10129"><a href="#cb375-10129" aria-hidden="true" tabindex="-1"></a><span class="st">AEFDFDC</span></span>
<span id="cb375-10130"><a href="#cb375-10130" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10131"><a href="#cb375-10131" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.01</span></span>
<span id="cb375-10132"><a href="#cb375-10132" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10133"><a href="#cb375-10133" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E   F</span></span>
<span id="cb375-10134"><a href="#cb375-10134" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10135"><a href="#cb375-10135" aria-hidden="true" tabindex="-1"></a><span class="st">ACDEFACADF</span></span>
<span id="cb375-10136"><a href="#cb375-10136" aria-hidden="true" tabindex="-1"></a><span class="st">AFDA---CCF</span></span>
<span id="cb375-10137"><a href="#cb375-10137" aria-hidden="true" tabindex="-1"></a><span class="st">A--EFD-FDC</span></span>
<span id="cb375-10138"><a href="#cb375-10138" aria-hidden="true" tabindex="-1"></a><span class="st">ACAEF--A-C</span></span>
<span id="cb375-10139"><a href="#cb375-10139" aria-hidden="true" tabindex="-1"></a><span class="st">ADDEFAAADF</span></span>
<span id="cb375-10140"><a href="#cb375-10140" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-10141"><a href="#cb375-10141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10142"><a href="#cb375-10142" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb375-10143"><a href="#cb375-10143" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10144"><a href="#cb375-10144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10145"><a href="#cb375-10145" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the Parameters of an HMM</span></span>
<span id="cb375-10146"><a href="#cb375-10146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10147"><a href="#cb375-10147" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of emitted symbols x <span class="op">=</span> x1... xn <span class="kw">in</span> an alphabet ∑ <span class="kw">and</span> a path $π <span class="op">=</span> π_1... π_n$ generated by a k<span class="op">-</span>state HMM <span class="cf">with</span> unknown transition <span class="kw">and</span> emission probabilities.</span>
<span id="cb375-10148"><a href="#cb375-10148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10149"><a href="#cb375-10149" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A matrix of transition probabilities Transition <span class="kw">and</span> a matrix of emission probabilities Emission that maximize $Pr(x,π)$ over <span class="bu">all</span> possible matrices of transition <span class="kw">and</span> emission probabilities.</span>
<span id="cb375-10150"><a href="#cb375-10150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10151"><a href="#cb375-10151" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-10152"><a href="#cb375-10152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10153"><a href="#cb375-10153" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10154"><a href="#cb375-10154" aria-hidden="true" tabindex="-1"></a>yzzzyxzxxx</span>
<span id="cb375-10155"><a href="#cb375-10155" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10156"><a href="#cb375-10156" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb375-10157"><a href="#cb375-10157" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10158"><a href="#cb375-10158" aria-hidden="true" tabindex="-1"></a>BBABABABAB</span>
<span id="cb375-10159"><a href="#cb375-10159" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10160"><a href="#cb375-10160" aria-hidden="true" tabindex="-1"></a>A   B   C</span>
<span id="cb375-10161"><a href="#cb375-10161" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10162"><a href="#cb375-10162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10163"><a href="#cb375-10163" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-10164"><a href="#cb375-10164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10165"><a href="#cb375-10165" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10166"><a href="#cb375-10166" aria-hidden="true" tabindex="-1"></a>A   B   C</span>
<span id="cb375-10167"><a href="#cb375-10167" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.0</span> <span class="fl">1.0</span> <span class="fl">0.0</span></span>
<span id="cb375-10168"><a href="#cb375-10168" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.8</span> <span class="fl">0.2</span> <span class="fl">0.0</span></span>
<span id="cb375-10169"><a href="#cb375-10169" aria-hidden="true" tabindex="-1"></a>C   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span></span>
<span id="cb375-10170"><a href="#cb375-10170" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10171"><a href="#cb375-10171" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb375-10172"><a href="#cb375-10172" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.25</span>    <span class="fl">0.25</span>    <span class="fl">0.5</span></span>
<span id="cb375-10173"><a href="#cb375-10173" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.5</span> <span class="fl">0.167</span>   <span class="fl">0.333</span></span>
<span id="cb375-10174"><a href="#cb375-10174" aria-hidden="true" tabindex="-1"></a>C   <span class="fl">0.333</span>   <span class="fl">0.333</span>   <span class="fl">0.333</span></span>
<span id="cb375-10175"><a href="#cb375-10175" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10176"><a href="#cb375-10176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10177"><a href="#cb375-10177" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-10178"><a href="#cb375-10178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10179"><a href="#cb375-10179" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-10180"><a href="#cb375-10180" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-10181"><a href="#cb375-10181" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-10182"><a href="#cb375-10182" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator, Union</span>
<span id="cb375-10183"><a href="#cb375-10183" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-10184"><a href="#cb375-10184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10185"><a href="#cb375-10185" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10186"><a href="#cb375-10186" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb375-10187"><a href="#cb375-10187" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-10188"><a href="#cb375-10188" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb375-10189"><a href="#cb375-10189" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb375-10190"><a href="#cb375-10190" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb375-10191"><a href="#cb375-10191" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb375-10192"><a href="#cb375-10192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10193"><a href="#cb375-10193" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10194"><a href="#cb375-10194" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb375-10195"><a href="#cb375-10195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10196"><a href="#cb375-10196" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10197"><a href="#cb375-10197" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-10198"><a href="#cb375-10198" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb375-10199"><a href="#cb375-10199" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb375-10200"><a href="#cb375-10200" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-10201"><a href="#cb375-10201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10202"><a href="#cb375-10202" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], <span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb375-10203"><a href="#cb375-10203" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb375-10204"><a href="#cb375-10204" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10205"><a href="#cb375-10205" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb375-10206"><a href="#cb375-10206" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10207"><a href="#cb375-10207" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb375-10208"><a href="#cb375-10208" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10209"><a href="#cb375-10209" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb375-10210"><a href="#cb375-10210" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, alphabet, path, states</span>
<span id="cb375-10211"><a href="#cb375-10211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10212"><a href="#cb375-10212" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_dict(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb375-10213"><a href="#cb375-10213" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb375-10214"><a href="#cb375-10214" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb375-10215"><a href="#cb375-10215" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">1</span>]):</span>
<span id="cb375-10216"><a href="#cb375-10216" aria-hidden="true" tabindex="-1"></a>            result[row_labels[i], column_labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb375-10217"><a href="#cb375-10217" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb375-10218"><a href="#cb375-10218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10219"><a href="#cb375-10219" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb375-10220"><a href="#cb375-10220" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-10221"><a href="#cb375-10221" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_state, next_state <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb375-10222"><a href="#cb375-10222" aria-hidden="true" tabindex="-1"></a>        transition_matrix[states.index(current_state)][states.index(next_state)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-10223"><a href="#cb375-10223" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> normalize_matrix(transition_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb375-10224"><a href="#cb375-10224" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb375-10225"><a href="#cb375-10225" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(transition_matrix, states, states)</span>
<span id="cb375-10226"><a href="#cb375-10226" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-10227"><a href="#cb375-10227" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> transition_matrix</span>
<span id="cb375-10228"><a href="#cb375-10228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10229"><a href="#cb375-10229" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb375-10230"><a href="#cb375-10230" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-10231"><a href="#cb375-10231" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> state, symbol <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb375-10232"><a href="#cb375-10232" aria-hidden="true" tabindex="-1"></a>        emission_matrix[states.index(state)][alphabet.index(symbol)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-10233"><a href="#cb375-10233" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> normalize_matrix(emission_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb375-10234"><a href="#cb375-10234" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb375-10235"><a href="#cb375-10235" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(emission_matrix, states, alphabet)</span>
<span id="cb375-10236"><a href="#cb375-10236" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb375-10237"><a href="#cb375-10237" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> emission_matrix</span>
<span id="cb375-10238"><a href="#cb375-10238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10239"><a href="#cb375-10239" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10240"><a href="#cb375-10240" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb375-10241"><a href="#cb375-10241" aria-hidden="true" tabindex="-1"></a>    sequence, alphabet, path, states <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb375-10242"><a href="#cb375-10242" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states)</span>
<span id="cb375-10243"><a href="#cb375-10243" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states)</span>
<span id="cb375-10244"><a href="#cb375-10244" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, states, states)</span>
<span id="cb375-10245"><a href="#cb375-10245" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb375-10246"><a href="#cb375-10246" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, states, alphabet)</span>
<span id="cb375-10247"><a href="#cb375-10247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10248"><a href="#cb375-10248" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-10249"><a href="#cb375-10249" aria-hidden="true" tabindex="-1"></a><span class="st">yzzzyxzxxx</span></span>
<span id="cb375-10250"><a href="#cb375-10250" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10251"><a href="#cb375-10251" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb375-10252"><a href="#cb375-10252" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10253"><a href="#cb375-10253" aria-hidden="true" tabindex="-1"></a><span class="st">BBABABABAB</span></span>
<span id="cb375-10254"><a href="#cb375-10254" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10255"><a href="#cb375-10255" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C</span></span>
<span id="cb375-10256"><a href="#cb375-10256" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-10257"><a href="#cb375-10257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10258"><a href="#cb375-10258" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb375-10259"><a href="#cb375-10259" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10260"><a href="#cb375-10260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10261"><a href="#cb375-10261" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement Viterbi Learning</span></span>
<span id="cb375-10262"><a href="#cb375-10262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10263"><a href="#cb375-10263" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of emitted symbols&nbsp;$x<span class="op">=</span>x_1... x_n$&nbsp;in an alphabet&nbsp;<span class="op">*</span>A<span class="op">*</span>, generated by a&nbsp;<span class="op">*</span>k<span class="op">*-</span>state HMM <span class="cf">with</span> unknown transition <span class="kw">and</span> emission probabilities, initial&nbsp;<span class="op">*</span>Transition<span class="op">*</span>&nbsp;and&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;matrices <span class="kw">and</span> a number of iterations&nbsp;<span class="op">*</span>i<span class="op">*</span>.</span>
<span id="cb375-10264"><a href="#cb375-10264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10265"><a href="#cb375-10265" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A matrix of transition probabilities&nbsp;<span class="op">*</span>Transition<span class="op">*</span>&nbsp;and a matrix of emission probabilities&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;that maximizes $Pr(x,π)$ over <span class="bu">all</span> possible transition <span class="kw">and</span> emission matrices <span class="kw">and</span> over <span class="bu">all</span> hidden paths&nbsp;<span class="op">*</span>π<span class="op">*</span>.</span>
<span id="cb375-10266"><a href="#cb375-10266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10267"><a href="#cb375-10267" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-10268"><a href="#cb375-10268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10269"><a href="#cb375-10269" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10270"><a href="#cb375-10270" aria-hidden="true" tabindex="-1"></a><span class="dv">100</span></span>
<span id="cb375-10271"><a href="#cb375-10271" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10272"><a href="#cb375-10272" aria-hidden="true" tabindex="-1"></a>xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span>
<span id="cb375-10273"><a href="#cb375-10273" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10274"><a href="#cb375-10274" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb375-10275"><a href="#cb375-10275" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10276"><a href="#cb375-10276" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb375-10277"><a href="#cb375-10277" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10278"><a href="#cb375-10278" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb375-10279"><a href="#cb375-10279" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.582</span>   <span class="fl">0.418</span></span>
<span id="cb375-10280"><a href="#cb375-10280" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.272</span>   <span class="fl">0.728</span></span>
<span id="cb375-10281"><a href="#cb375-10281" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10282"><a href="#cb375-10282" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb375-10283"><a href="#cb375-10283" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.129</span>   <span class="fl">0.35</span>    <span class="fl">0.52</span></span>
<span id="cb375-10284"><a href="#cb375-10284" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.422</span>   <span class="fl">0.151</span>   <span class="fl">0.426</span></span>
<span id="cb375-10285"><a href="#cb375-10285" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10286"><a href="#cb375-10286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10287"><a href="#cb375-10287" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-10288"><a href="#cb375-10288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10289"><a href="#cb375-10289" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10290"><a href="#cb375-10290" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb375-10291"><a href="#cb375-10291" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.875</span>   <span class="fl">0.125</span></span>
<span id="cb375-10292"><a href="#cb375-10292" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.011</span>   <span class="fl">0.989</span></span>
<span id="cb375-10293"><a href="#cb375-10293" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10294"><a href="#cb375-10294" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb375-10295"><a href="#cb375-10295" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.0</span> <span class="fl">0.75</span>    <span class="fl">0.25</span></span>
<span id="cb375-10296"><a href="#cb375-10296" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.402</span>   <span class="fl">0.174</span>   <span class="fl">0.424</span></span>
<span id="cb375-10297"><a href="#cb375-10297" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10298"><a href="#cb375-10298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10299"><a href="#cb375-10299" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-10300"><a href="#cb375-10300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10301"><a href="#cb375-10301" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-10302"><a href="#cb375-10302" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-10303"><a href="#cb375-10303" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb375-10304"><a href="#cb375-10304" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-10305"><a href="#cb375-10305" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb375-10306"><a href="#cb375-10306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10307"><a href="#cb375-10307" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-10308"><a href="#cb375-10308" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)))</span>
<span id="cb375-10309"><a href="#cb375-10309" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb375-10310"><a href="#cb375-10310" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10311"><a href="#cb375-10311" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10312"><a href="#cb375-10312" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states))</span>
<span id="cb375-10313"><a href="#cb375-10313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10314"><a href="#cb375-10314" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb375-10315"><a href="#cb375-10315" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10316"><a href="#cb375-10316" aria-hidden="true" tabindex="-1"></a>            opt <span class="op">=</span> [</span>
<span id="cb375-10317"><a href="#cb375-10317" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[prev, state]) <span class="op">+</span> log(emission_matrix[state, emission]) <span class="op">+</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb375-10318"><a href="#cb375-10318" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb375-10319"><a href="#cb375-10319" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb375-10320"><a href="#cb375-10320" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> opt.index(<span class="bu">max</span>(opt))</span>
<span id="cb375-10321"><a href="#cb375-10321" aria-hidden="true" tabindex="-1"></a>            ptr[i, j] <span class="op">=</span> p</span>
<span id="cb375-10322"><a href="#cb375-10322" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">max</span>(opt)</span>
<span id="cb375-10323"><a href="#cb375-10323" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> np.argmax(mat[i, :])</span>
<span id="cb375-10324"><a href="#cb375-10324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10325"><a href="#cb375-10325" aria-hidden="true" tabindex="-1"></a>    state_sequence <span class="op">=</span> states[ind]</span>
<span id="cb375-10326"><a href="#cb375-10326" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-10327"><a href="#cb375-10327" aria-hidden="true" tabindex="-1"></a>        state_sequence <span class="op">=</span> states[ptr[i, ind]] <span class="op">+</span> state_sequence</span>
<span id="cb375-10328"><a href="#cb375-10328" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> ptr[i, ind]</span>
<span id="cb375-10329"><a href="#cb375-10329" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-10330"><a href="#cb375-10330" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> state_sequence</span>
<span id="cb375-10331"><a href="#cb375-10331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10332"><a href="#cb375-10332" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10333"><a href="#cb375-10333" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-10334"><a href="#cb375-10334" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb375-10335"><a href="#cb375-10335" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb375-10336"><a href="#cb375-10336" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-10337"><a href="#cb375-10337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10338"><a href="#cb375-10338" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, min_val: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1e-16</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10339"><a href="#cb375-10339" aria-hidden="true" tabindex="-1"></a>    normalized <span class="op">=</span> matrix <span class="op">/</span> matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-10340"><a href="#cb375-10340" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros:</span>
<span id="cb375-10341"><a href="#cb375-10341" aria-hidden="true" tabindex="-1"></a>        normalized[normalized <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> min_val</span>
<span id="cb375-10342"><a href="#cb375-10342" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalized</span>
<span id="cb375-10343"><a href="#cb375-10343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10344"><a href="#cb375-10344" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb375-10345"><a href="#cb375-10345" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-10346"><a href="#cb375-10346" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb375-10347"><a href="#cb375-10347" aria-hidden="true" tabindex="-1"></a>        tmat[states.index(a)][states.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-10348"><a href="#cb375-10348" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> normalize_matrix(tmat)</span>
<span id="cb375-10349"><a href="#cb375-10349" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb375-10350"><a href="#cb375-10350" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], states[j]): tmat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states))}</span>
<span id="cb375-10351"><a href="#cb375-10351" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tmat</span>
<span id="cb375-10352"><a href="#cb375-10352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10353"><a href="#cb375-10353" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb375-10354"><a href="#cb375-10354" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-10355"><a href="#cb375-10355" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb375-10356"><a href="#cb375-10356" aria-hidden="true" tabindex="-1"></a>        emat[states.index(a)][alphabet.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-10357"><a href="#cb375-10357" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> normalize_matrix(emat)</span>
<span id="cb375-10358"><a href="#cb375-10358" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb375-10359"><a href="#cb375-10359" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], alphabet[j]): emat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(alphabet))}</span>
<span id="cb375-10360"><a href="#cb375-10360" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emat</span>
<span id="cb375-10361"><a href="#cb375-10361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10362"><a href="#cb375-10362" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10363"><a href="#cb375-10363" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(column_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-10364"><a href="#cb375-10364" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb375-10365"><a href="#cb375-10365" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(column_labels):</span>
<span id="cb375-10366"><a href="#cb375-10366" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb375-10367"><a href="#cb375-10367" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, column_labels)</span>
<span id="cb375-10368"><a href="#cb375-10368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10369"><a href="#cb375-10369" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: StringIO) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb375-10370"><a href="#cb375-10370" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb375-10371"><a href="#cb375-10371" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10372"><a href="#cb375-10372" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb375-10373"><a href="#cb375-10373" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10374"><a href="#cb375-10374" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb375-10375"><a href="#cb375-10375" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10376"><a href="#cb375-10376" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb375-10377"><a href="#cb375-10377" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10378"><a href="#cb375-10378" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-10379"><a href="#cb375-10379" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb375-10380"><a href="#cb375-10380" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb375-10381"><a href="#cb375-10381" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb375-10382"><a href="#cb375-10382" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb375-10383"><a href="#cb375-10383" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-10384"><a href="#cb375-10384" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10385"><a href="#cb375-10385" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-10386"><a href="#cb375-10386" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb375-10387"><a href="#cb375-10387" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb375-10388"><a href="#cb375-10388" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb375-10389"><a href="#cb375-10389" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb375-10390"><a href="#cb375-10390" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-10391"><a href="#cb375-10391" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, sequence, states, alphabet, transition_matrix, emission_matrix</span>
<span id="cb375-10392"><a href="#cb375-10392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10393"><a href="#cb375-10393" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10394"><a href="#cb375-10394" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb375-10395"><a href="#cb375-10395" aria-hidden="true" tabindex="-1"></a>    niter, sequence, states, alphabet, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb375-10396"><a href="#cb375-10396" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb375-10397"><a href="#cb375-10397" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb375-10398"><a href="#cb375-10398" aria-hidden="true" tabindex="-1"></a>        transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-10399"><a href="#cb375-10399" aria-hidden="true" tabindex="-1"></a>        emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-10400"><a href="#cb375-10400" aria-hidden="true" tabindex="-1"></a>    print_dict(transition_matrix, states, states)</span>
<span id="cb375-10401"><a href="#cb375-10401" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb375-10402"><a href="#cb375-10402" aria-hidden="true" tabindex="-1"></a>    print_dict(emission_matrix, states, alphabet)</span>
<span id="cb375-10403"><a href="#cb375-10403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10404"><a href="#cb375-10404" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-10405"><a href="#cb375-10405" aria-hidden="true" tabindex="-1"></a><span class="st">100</span></span>
<span id="cb375-10406"><a href="#cb375-10406" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10407"><a href="#cb375-10407" aria-hidden="true" tabindex="-1"></a><span class="st">xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span></span>
<span id="cb375-10408"><a href="#cb375-10408" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10409"><a href="#cb375-10409" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb375-10410"><a href="#cb375-10410" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10411"><a href="#cb375-10411" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb375-10412"><a href="#cb375-10412" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10413"><a href="#cb375-10413" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb375-10414"><a href="#cb375-10414" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.582   0.418</span></span>
<span id="cb375-10415"><a href="#cb375-10415" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.272   0.728</span></span>
<span id="cb375-10416"><a href="#cb375-10416" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10417"><a href="#cb375-10417" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb375-10418"><a href="#cb375-10418" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.129   0.35    0.52</span></span>
<span id="cb375-10419"><a href="#cb375-10419" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.422   0.151   0.426</span></span>
<span id="cb375-10420"><a href="#cb375-10420" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-10421"><a href="#cb375-10421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10422"><a href="#cb375-10422" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb375-10423"><a href="#cb375-10423" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10424"><a href="#cb375-10424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10425"><a href="#cb375-10425" aria-hidden="true" tabindex="-1"></a><span class="co"># Solve the Soft Decoding Problem</span></span>
<span id="cb375-10426"><a href="#cb375-10426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10427"><a href="#cb375-10427" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A string&nbsp;<span class="op">*</span>x<span class="op">*</span>, followed by the alphabet&nbsp;<span class="op">*</span>Σ<span class="op">*</span>&nbsp;from which&nbsp;<span class="op">*</span>x<span class="op">*</span>&nbsp;was constructed, followed by the states&nbsp;<span class="op">*</span>States<span class="op">*</span>, transition matrix&nbsp;<span class="op">*</span>Transition<span class="op">*</span>, <span class="kw">and</span> emission matrix&nbsp;<span class="op">*</span>Emission<span class="op">*</span>&nbsp;of an HMM (<span class="op">*</span>Σ<span class="op">*</span>,&nbsp;<span class="op">*</span>States<span class="op">*</span>,&nbsp;<span class="op">*</span>Transition<span class="op">*</span>,&nbsp;<span class="op">*</span>Emission<span class="op">*</span>).</span>
<span id="cb375-10428"><a href="#cb375-10428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10429"><a href="#cb375-10429" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The probability $Pr(π_i<span class="op">=</span>k<span class="op">|</span>x)$ that the HMM was <span class="kw">in</span> state k at step i (<span class="cf">for</span> each state k <span class="kw">and</span> each step i).</span>
<span id="cb375-10430"><a href="#cb375-10430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10431"><a href="#cb375-10431" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-10432"><a href="#cb375-10432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10433"><a href="#cb375-10433" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10434"><a href="#cb375-10434" aria-hidden="true" tabindex="-1"></a>zyxxxxyxzz</span>
<span id="cb375-10435"><a href="#cb375-10435" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10436"><a href="#cb375-10436" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb375-10437"><a href="#cb375-10437" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10438"><a href="#cb375-10438" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb375-10439"><a href="#cb375-10439" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10440"><a href="#cb375-10440" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb375-10441"><a href="#cb375-10441" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.911</span>   <span class="fl">0.089</span></span>
<span id="cb375-10442"><a href="#cb375-10442" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.228</span>   <span class="fl">0.772</span></span>
<span id="cb375-10443"><a href="#cb375-10443" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10444"><a href="#cb375-10444" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb375-10445"><a href="#cb375-10445" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.356</span>   <span class="fl">0.191</span>   <span class="fl">0.453</span> </span>
<span id="cb375-10446"><a href="#cb375-10446" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.04</span>    <span class="fl">0.467</span>   <span class="fl">0.493</span></span>
<span id="cb375-10447"><a href="#cb375-10447" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10448"><a href="#cb375-10448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10449"><a href="#cb375-10449" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-10450"><a href="#cb375-10450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10451"><a href="#cb375-10451" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10452"><a href="#cb375-10452" aria-hidden="true" tabindex="-1"></a>A   B </span>
<span id="cb375-10453"><a href="#cb375-10453" aria-hidden="true" tabindex="-1"></a><span class="fl">0.5438</span>  <span class="fl">0.4562</span> </span>
<span id="cb375-10454"><a href="#cb375-10454" aria-hidden="true" tabindex="-1"></a><span class="fl">0.6492</span>  <span class="fl">0.3508</span> </span>
<span id="cb375-10455"><a href="#cb375-10455" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9647</span>  <span class="fl">0.0353</span> </span>
<span id="cb375-10456"><a href="#cb375-10456" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9936</span>  <span class="fl">0.0064</span> </span>
<span id="cb375-10457"><a href="#cb375-10457" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9957</span>  <span class="fl">0.0043</span> </span>
<span id="cb375-10458"><a href="#cb375-10458" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9891</span>  <span class="fl">0.0109</span> </span>
<span id="cb375-10459"><a href="#cb375-10459" aria-hidden="true" tabindex="-1"></a><span class="fl">0.9154</span>  <span class="fl">0.0846</span> </span>
<span id="cb375-10460"><a href="#cb375-10460" aria-hidden="true" tabindex="-1"></a><span class="fl">0.964</span>   <span class="fl">0.036</span> </span>
<span id="cb375-10461"><a href="#cb375-10461" aria-hidden="true" tabindex="-1"></a><span class="fl">0.8737</span>  <span class="fl">0.1263</span> </span>
<span id="cb375-10462"><a href="#cb375-10462" aria-hidden="true" tabindex="-1"></a><span class="fl">0.8167</span>  <span class="fl">0.1833</span></span>
<span id="cb375-10463"><a href="#cb375-10463" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10464"><a href="#cb375-10464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10465"><a href="#cb375-10465" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-10466"><a href="#cb375-10466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10467"><a href="#cb375-10467" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-10468"><a href="#cb375-10468" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb375-10469"><a href="#cb375-10469" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-10470"><a href="#cb375-10470" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-10471"><a href="#cb375-10471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10472"><a href="#cb375-10472" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb375-10473"><a href="#cb375-10473" aria-hidden="true" tabindex="-1"></a>    seq: <span class="bu">str</span> <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb375-10474"><a href="#cb375-10474" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10475"><a href="#cb375-10475" aria-hidden="true" tabindex="-1"></a>    alphabet: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb375-10476"><a href="#cb375-10476" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10477"><a href="#cb375-10477" aria-hidden="true" tabindex="-1"></a>    states: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb375-10478"><a href="#cb375-10478" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10479"><a href="#cb375-10479" aria-hidden="true" tabindex="-1"></a>    lines: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-10480"><a href="#cb375-10480" aria-hidden="true" tabindex="-1"></a>    tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb375-10481"><a href="#cb375-10481" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb375-10482"><a href="#cb375-10482" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb375-10483"><a href="#cb375-10483" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb375-10484"><a href="#cb375-10484" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-10485"><a href="#cb375-10485" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10486"><a href="#cb375-10486" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-10487"><a href="#cb375-10487" aria-hidden="true" tabindex="-1"></a>    emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb375-10488"><a href="#cb375-10488" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb375-10489"><a href="#cb375-10489" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb375-10490"><a href="#cb375-10490" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb375-10491"><a href="#cb375-10491" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-10492"><a href="#cb375-10492" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq, states, tmat, emat</span>
<span id="cb375-10493"><a href="#cb375-10493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10494"><a href="#cb375-10494" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10495"><a href="#cb375-10495" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb375-10496"><a href="#cb375-10496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10497"><a href="#cb375-10497" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10498"><a href="#cb375-10498" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb375-10499"><a href="#cb375-10499" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb375-10500"><a href="#cb375-10500" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10501"><a href="#cb375-10501" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb375-10502"><a href="#cb375-10502" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb375-10503"><a href="#cb375-10503" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb375-10504"><a href="#cb375-10504" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb375-10505"><a href="#cb375-10505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10506"><a href="#cb375-10506" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb375-10507"><a href="#cb375-10507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10508"><a href="#cb375-10508" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10509"><a href="#cb375-10509" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb375-10510"><a href="#cb375-10510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10511"><a href="#cb375-10511" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb375-10512"><a href="#cb375-10512" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10513"><a href="#cb375-10513" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb375-10514"><a href="#cb375-10514" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb375-10515"><a href="#cb375-10515" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb375-10516"><a href="#cb375-10516" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb375-10517"><a href="#cb375-10517" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb375-10518"><a href="#cb375-10518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10519"><a href="#cb375-10519" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10520"><a href="#cb375-10520" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb375-10521"><a href="#cb375-10521" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb375-10522"><a href="#cb375-10522" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-10523"><a href="#cb375-10523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb375-10524"><a href="#cb375-10524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10525"><a href="#cb375-10525" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10526"><a href="#cb375-10526" aria-hidden="true" tabindex="-1"></a>    input_lines: Iterator[<span class="bu">str</span>] <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb375-10527"><a href="#cb375-10527" aria-hidden="true" tabindex="-1"></a>    seq, states, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb375-10528"><a href="#cb375-10528" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> soft_decode(seq, states, tmat, emat)</span>
<span id="cb375-10529"><a href="#cb375-10529" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>states, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-10530"><a href="#cb375-10530" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> r <span class="kw">in</span> np.<span class="bu">round</span>(tot, <span class="dv">4</span>):</span>
<span id="cb375-10531"><a href="#cb375-10531" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-10532"><a href="#cb375-10532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10533"><a href="#cb375-10533" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-10534"><a href="#cb375-10534" aria-hidden="true" tabindex="-1"></a><span class="st">zyxxxxyxzz</span></span>
<span id="cb375-10535"><a href="#cb375-10535" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10536"><a href="#cb375-10536" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb375-10537"><a href="#cb375-10537" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10538"><a href="#cb375-10538" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb375-10539"><a href="#cb375-10539" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10540"><a href="#cb375-10540" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb375-10541"><a href="#cb375-10541" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.911   0.089</span></span>
<span id="cb375-10542"><a href="#cb375-10542" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.228   0.772</span></span>
<span id="cb375-10543"><a href="#cb375-10543" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10544"><a href="#cb375-10544" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb375-10545"><a href="#cb375-10545" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.356   0.191   0.453 </span></span>
<span id="cb375-10546"><a href="#cb375-10546" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.04    0.467   0.493</span></span>
<span id="cb375-10547"><a href="#cb375-10547" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-10548"><a href="#cb375-10548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10549"><a href="#cb375-10549" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb375-10550"><a href="#cb375-10550" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10551"><a href="#cb375-10551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10552"><a href="#cb375-10552" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement Baum-Welch Learning</span></span>
<span id="cb375-10553"><a href="#cb375-10553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10554"><a href="#cb375-10554" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A sequence of emitted symbols $x<span class="op">=</span>x_1...x_n$ <span class="kw">in</span> an alphabet A, generated by a k<span class="op">-</span>state HMM <span class="cf">with</span> unknown transition <span class="kw">and</span> emission probabilities, initial Transition <span class="kw">and</span> Emission matrices <span class="kw">and</span> a number of iterations I.</span>
<span id="cb375-10555"><a href="#cb375-10555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10556"><a href="#cb375-10556" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A matrix of transition probabilities Transition <span class="kw">and</span> a matrix of emission probabilities Emission that maximizes $Pr(x,π)$ over <span class="bu">all</span> possible transition <span class="kw">and</span> emission matrices <span class="kw">and</span> over <span class="bu">all</span> hidden paths π.</span>
<span id="cb375-10557"><a href="#cb375-10557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10558"><a href="#cb375-10558" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-10559"><a href="#cb375-10559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10560"><a href="#cb375-10560" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10561"><a href="#cb375-10561" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span>
<span id="cb375-10562"><a href="#cb375-10562" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10563"><a href="#cb375-10563" aria-hidden="true" tabindex="-1"></a>xzyyzyzyxy</span>
<span id="cb375-10564"><a href="#cb375-10564" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10565"><a href="#cb375-10565" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb375-10566"><a href="#cb375-10566" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10567"><a href="#cb375-10567" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb375-10568"><a href="#cb375-10568" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10569"><a href="#cb375-10569" aria-hidden="true" tabindex="-1"></a>    A   B</span>
<span id="cb375-10570"><a href="#cb375-10570" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.019</span>   <span class="fl">0.981</span> </span>
<span id="cb375-10571"><a href="#cb375-10571" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.668</span>   <span class="fl">0.332</span> </span>
<span id="cb375-10572"><a href="#cb375-10572" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10573"><a href="#cb375-10573" aria-hidden="true" tabindex="-1"></a>x   y   z</span>
<span id="cb375-10574"><a href="#cb375-10574" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.175</span>   <span class="fl">0.003</span>   <span class="fl">0.821</span> </span>
<span id="cb375-10575"><a href="#cb375-10575" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.196</span>   <span class="fl">0.512</span>   <span class="fl">0.293</span></span>
<span id="cb375-10576"><a href="#cb375-10576" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10577"><a href="#cb375-10577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10578"><a href="#cb375-10578" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-10579"><a href="#cb375-10579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10580"><a href="#cb375-10580" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10581"><a href="#cb375-10581" aria-hidden="true" tabindex="-1"></a>A   B</span>
<span id="cb375-10582"><a href="#cb375-10582" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.000</span>   <span class="fl">1.000</span>   </span>
<span id="cb375-10583"><a href="#cb375-10583" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.786</span>   <span class="fl">0.214</span>   </span>
<span id="cb375-10584"><a href="#cb375-10584" aria-hidden="true" tabindex="-1"></a><span class="op">--------</span></span>
<span id="cb375-10585"><a href="#cb375-10585" aria-hidden="true" tabindex="-1"></a>    x   y   z</span>
<span id="cb375-10586"><a href="#cb375-10586" aria-hidden="true" tabindex="-1"></a>A   <span class="fl">0.242</span>   <span class="fl">0.000</span>   <span class="fl">0.758</span>   </span>
<span id="cb375-10587"><a href="#cb375-10587" aria-hidden="true" tabindex="-1"></a>B   <span class="fl">0.172</span>   <span class="fl">0.828</span>   <span class="fl">0.000</span></span>
<span id="cb375-10588"><a href="#cb375-10588" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10589"><a href="#cb375-10589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10590"><a href="#cb375-10590" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-10591"><a href="#cb375-10591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10592"><a href="#cb375-10592" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-10593"><a href="#cb375-10593" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb375-10594"><a href="#cb375-10594" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb375-10595"><a href="#cb375-10595" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb375-10596"><a href="#cb375-10596" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-10597"><a href="#cb375-10597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10598"><a href="#cb375-10598" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10599"><a href="#cb375-10599" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-10600"><a href="#cb375-10600" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb375-10601"><a href="#cb375-10601" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb375-10602"><a href="#cb375-10602" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb375-10603"><a href="#cb375-10603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10604"><a href="#cb375-10604" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10605"><a href="#cb375-10605" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(col_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-10606"><a href="#cb375-10606" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb375-10607"><a href="#cb375-10607" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(col_labels):</span>
<span id="cb375-10608"><a href="#cb375-10608" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb375-10609"><a href="#cb375-10609" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, col_labels)</span>
<span id="cb375-10610"><a href="#cb375-10610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10611"><a href="#cb375-10611" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb375-10612"><a href="#cb375-10612" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb375-10613"><a href="#cb375-10613" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10614"><a href="#cb375-10614" aria-hidden="true" tabindex="-1"></a>    seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb375-10615"><a href="#cb375-10615" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10616"><a href="#cb375-10616" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb375-10617"><a href="#cb375-10617" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10618"><a href="#cb375-10618" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb375-10619"><a href="#cb375-10619" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10620"><a href="#cb375-10620" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-10621"><a href="#cb375-10621" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> {</span>
<span id="cb375-10622"><a href="#cb375-10622" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb375-10623"><a href="#cb375-10623" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb375-10624"><a href="#cb375-10624" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb375-10625"><a href="#cb375-10625" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-10626"><a href="#cb375-10626" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb375-10627"><a href="#cb375-10627" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb375-10628"><a href="#cb375-10628" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> {</span>
<span id="cb375-10629"><a href="#cb375-10629" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb375-10630"><a href="#cb375-10630" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb375-10631"><a href="#cb375-10631" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb375-10632"><a href="#cb375-10632" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb375-10633"><a href="#cb375-10633" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, seq, states, alphabet, tmat, emat</span>
<span id="cb375-10634"><a href="#cb375-10634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10635"><a href="#cb375-10635" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10636"><a href="#cb375-10636" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb375-10637"><a href="#cb375-10637" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10638"><a href="#cb375-10638" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb375-10639"><a href="#cb375-10639" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb375-10640"><a href="#cb375-10640" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10641"><a href="#cb375-10641" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb375-10642"><a href="#cb375-10642" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb375-10643"><a href="#cb375-10643" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb375-10644"><a href="#cb375-10644" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb375-10645"><a href="#cb375-10645" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb375-10646"><a href="#cb375-10646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10647"><a href="#cb375-10647" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10648"><a href="#cb375-10648" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb375-10649"><a href="#cb375-10649" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb375-10650"><a href="#cb375-10650" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10651"><a href="#cb375-10651" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb375-10652"><a href="#cb375-10652" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb375-10653"><a href="#cb375-10653" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb375-10654"><a href="#cb375-10654" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb375-10655"><a href="#cb375-10655" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb375-10656"><a href="#cb375-10656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10657"><a href="#cb375-10657" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10658"><a href="#cb375-10658" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb375-10659"><a href="#cb375-10659" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb375-10660"><a href="#cb375-10660" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-10661"><a href="#cb375-10661" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb375-10662"><a href="#cb375-10662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10663"><a href="#cb375-10663" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_dict(x: np.ndarray, r: List[<span class="bu">str</span>], c: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb375-10664"><a href="#cb375-10664" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb375-10665"><a href="#cb375-10665" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">0</span>]):</span>
<span id="cb375-10666"><a href="#cb375-10666" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">1</span>]):</span>
<span id="cb375-10667"><a href="#cb375-10667" aria-hidden="true" tabindex="-1"></a>            g[r[i], c[j]] <span class="op">=</span> x[i][j]</span>
<span id="cb375-10668"><a href="#cb375-10668" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g</span>
<span id="cb375-10669"><a href="#cb375-10669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10670"><a href="#cb375-10670" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_pi2(seq: <span class="bu">str</span>, fwd: np.ndarray, bak: np.ndarray, tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], states: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb375-10671"><a href="#cb375-10671" aria-hidden="true" tabindex="-1"></a>    rep_mat <span class="op">=</span> np.zeros((fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-10672"><a href="#cb375-10672" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb375-10673"><a href="#cb375-10673" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, s1 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10674"><a href="#cb375-10674" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k, s2 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb375-10675"><a href="#cb375-10675" aria-hidden="true" tabindex="-1"></a>                weight <span class="op">=</span> tmat[s1, s2] <span class="op">*</span> emat[s2, seq[i <span class="op">+</span> <span class="dv">1</span>]]</span>
<span id="cb375-10676"><a href="#cb375-10676" aria-hidden="true" tabindex="-1"></a>                rep_mat[i, j, k] <span class="op">=</span> (</span>
<span id="cb375-10677"><a href="#cb375-10677" aria-hidden="true" tabindex="-1"></a>                    fwd[i, j] <span class="op">*</span> bak[i <span class="op">+</span> <span class="dv">1</span>, k] <span class="op">*</span> weight <span class="op">/</span> <span class="bu">sum</span>(fwd[i, :] <span class="op">*</span> bak[i, :])</span>
<span id="cb375-10678"><a href="#cb375-10678" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb375-10679"><a href="#cb375-10679" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rep_mat</span>
<span id="cb375-10680"><a href="#cb375-10680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10681"><a href="#cb375-10681" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_tmat(seq: <span class="bu">str</span>, st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb375-10682"><a href="#cb375-10682" aria-hidden="true" tabindex="-1"></a>    fwd <span class="op">=</span> forward(seq, st, tmat, emat)</span>
<span id="cb375-10683"><a href="#cb375-10683" aria-hidden="true" tabindex="-1"></a>    bak <span class="op">=</span> backward(seq, st, tmat, emat)</span>
<span id="cb375-10684"><a href="#cb375-10684" aria-hidden="true" tabindex="-1"></a>    pi2 <span class="op">=</span> estimate_pi2(seq, fwd, bak, tmat, emat, st)</span>
<span id="cb375-10685"><a href="#cb375-10685" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> np.<span class="bu">sum</span>(pi2, <span class="dv">0</span>)</span>
<span id="cb375-10686"><a href="#cb375-10686" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> tmat_new <span class="op">/</span> np.<span class="bu">sum</span>(tmat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-10687"><a href="#cb375-10687" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(tmat_new, st, st)</span>
<span id="cb375-10688"><a href="#cb375-10688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10689"><a href="#cb375-10689" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emat(seq: <span class="bu">str</span>, al: List[<span class="bu">str</span>], st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb375-10690"><a href="#cb375-10690" aria-hidden="true" tabindex="-1"></a>    pi1 <span class="op">=</span> soft_decode(seq, st, tmat, emat)</span>
<span id="cb375-10691"><a href="#cb375-10691" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> np.zeros((<span class="bu">len</span>(st), <span class="bu">len</span>(al)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb375-10692"><a href="#cb375-10692" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(al):</span>
<span id="cb375-10693"><a href="#cb375-10693" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> np.array(<span class="bu">list</span>(seq)) <span class="op">==</span> emission</span>
<span id="cb375-10694"><a href="#cb375-10694" aria-hidden="true" tabindex="-1"></a>        emat_new[:, i] <span class="op">=</span> np.<span class="bu">sum</span>(pi1[ind, :], <span class="dv">0</span>)</span>
<span id="cb375-10695"><a href="#cb375-10695" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> emat_new <span class="op">/</span> np.<span class="bu">sum</span>(emat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb375-10696"><a href="#cb375-10696" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(emat_new, st, al)</span>
<span id="cb375-10697"><a href="#cb375-10697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10698"><a href="#cb375-10698" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-10699"><a href="#cb375-10699" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb375-10700"><a href="#cb375-10700" aria-hidden="true" tabindex="-1"></a>    niter, seq, st, al, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb375-10701"><a href="#cb375-10701" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb375-10702"><a href="#cb375-10702" aria-hidden="true" tabindex="-1"></a>        tmat2 <span class="op">=</span> estimate_tmat(seq, st, tmat, emat)</span>
<span id="cb375-10703"><a href="#cb375-10703" aria-hidden="true" tabindex="-1"></a>        emat2 <span class="op">=</span> estimate_emat(seq, al, st, tmat, emat)</span>
<span id="cb375-10704"><a href="#cb375-10704" aria-hidden="true" tabindex="-1"></a>        emat, tmat <span class="op">=</span> emat2, tmat2</span>
<span id="cb375-10705"><a href="#cb375-10705" aria-hidden="true" tabindex="-1"></a>    print_dict(tmat, st, st)</span>
<span id="cb375-10706"><a href="#cb375-10706" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb375-10707"><a href="#cb375-10707" aria-hidden="true" tabindex="-1"></a>    print_dict(emat, st, al)</span>
<span id="cb375-10708"><a href="#cb375-10708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10709"><a href="#cb375-10709" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-10710"><a href="#cb375-10710" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb375-10711"><a href="#cb375-10711" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10712"><a href="#cb375-10712" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzyzyxy</span></span>
<span id="cb375-10713"><a href="#cb375-10713" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10714"><a href="#cb375-10714" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb375-10715"><a href="#cb375-10715" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10716"><a href="#cb375-10716" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb375-10717"><a href="#cb375-10717" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10718"><a href="#cb375-10718" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb375-10719"><a href="#cb375-10719" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.019   0.981 </span></span>
<span id="cb375-10720"><a href="#cb375-10720" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.668   0.332 </span></span>
<span id="cb375-10721"><a href="#cb375-10721" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb375-10722"><a href="#cb375-10722" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb375-10723"><a href="#cb375-10723" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.175   0.003   0.821 </span></span>
<span id="cb375-10724"><a href="#cb375-10724" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.196   0.512   0.293</span></span>
<span id="cb375-10725"><a href="#cb375-10725" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-10726"><a href="#cb375-10726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10727"><a href="#cb375-10727" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span>
<span id="cb375-10728"><a href="#cb375-10728" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10729"><a href="#cb375-10729" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10730"><a href="#cb375-10730" aria-hidden="true" tabindex="-1"></a><span class="co"># Construct the Graph of a Spectrum</span></span>
<span id="cb375-10731"><a href="#cb375-10731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10732"><a href="#cb375-10732" aria-hidden="true" tabindex="-1"></a>Spectrum Graph Construction. Construct the graph of a spectrum.</span>
<span id="cb375-10733"><a href="#cb375-10733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10734"><a href="#cb375-10734" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A space<span class="op">-</span>delimited <span class="bu">list</span> of integers&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb375-10735"><a href="#cb375-10735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10736"><a href="#cb375-10736" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;<span class="op">*</span>Graph(Spectrum)<span class="op">*</span>.</span>
<span id="cb375-10737"><a href="#cb375-10737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10738"><a href="#cb375-10738" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb375-10739"><a href="#cb375-10739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10740"><a href="#cb375-10740" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-10741"><a href="#cb375-10741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10742"><a href="#cb375-10742" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10743"><a href="#cb375-10743" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span> <span class="dv">71</span> <span class="dv">154</span> <span class="dv">185</span> <span class="dv">301</span> <span class="dv">332</span> <span class="dv">415</span> <span class="dv">429</span> <span class="dv">486</span></span>
<span id="cb375-10744"><a href="#cb375-10744" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10745"><a href="#cb375-10745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10746"><a href="#cb375-10746" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-10747"><a href="#cb375-10747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10748"><a href="#cb375-10748" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10749"><a href="#cb375-10749" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">57</span>:G</span>
<span id="cb375-10750"><a href="#cb375-10750" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">-&gt;</span><span class="dv">71</span>:A</span>
<span id="cb375-10751"><a href="#cb375-10751" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span><span class="op">-&gt;</span><span class="dv">154</span>:P</span>
<span id="cb375-10752"><a href="#cb375-10752" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span><span class="op">-&gt;</span><span class="dv">185</span>:K</span>
<span id="cb375-10753"><a href="#cb375-10753" aria-hidden="true" tabindex="-1"></a><span class="dv">71</span><span class="op">-&gt;</span><span class="dv">185</span>:N</span>
<span id="cb375-10754"><a href="#cb375-10754" aria-hidden="true" tabindex="-1"></a><span class="dv">154</span><span class="op">-&gt;</span><span class="dv">301</span>:F</span>
<span id="cb375-10755"><a href="#cb375-10755" aria-hidden="true" tabindex="-1"></a><span class="dv">185</span><span class="op">-&gt;</span><span class="dv">332</span>:F</span>
<span id="cb375-10756"><a href="#cb375-10756" aria-hidden="true" tabindex="-1"></a><span class="dv">301</span><span class="op">-&gt;</span><span class="dv">415</span>:N</span>
<span id="cb375-10757"><a href="#cb375-10757" aria-hidden="true" tabindex="-1"></a><span class="dv">301</span><span class="op">-&gt;</span><span class="dv">429</span>:K</span>
<span id="cb375-10758"><a href="#cb375-10758" aria-hidden="true" tabindex="-1"></a><span class="dv">332</span><span class="op">-&gt;</span><span class="dv">429</span>:P</span>
<span id="cb375-10759"><a href="#cb375-10759" aria-hidden="true" tabindex="-1"></a><span class="dv">415</span><span class="op">-&gt;</span><span class="dv">486</span>:A</span>
<span id="cb375-10760"><a href="#cb375-10760" aria-hidden="true" tabindex="-1"></a><span class="dv">429</span><span class="op">-&gt;</span><span class="dv">486</span>:G</span>
<span id="cb375-10761"><a href="#cb375-10761" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10762"><a href="#cb375-10762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10763"><a href="#cb375-10763" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-10764"><a href="#cb375-10764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10765"><a href="#cb375-10765" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-10766"><a href="#cb375-10766" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb375-10767"><a href="#cb375-10767" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, DefaultDict</span>
<span id="cb375-10768"><a href="#cb375-10768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10769"><a href="#cb375-10769" aria-hidden="true" tabindex="-1"></a><span class="co"># Amino acid weights dictionary</span></span>
<span id="cb375-10770"><a href="#cb375-10770" aria-hidden="true" tabindex="-1"></a>amino_acid_weights: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-10771"><a href="#cb375-10771" aria-hidden="true" tabindex="-1"></a>    <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'V'</span>: <span class="dv">99</span>,</span>
<span id="cb375-10772"><a href="#cb375-10772" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>,</span>
<span id="cb375-10773"><a href="#cb375-10773" aria-hidden="true" tabindex="-1"></a>    <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-10774"><a href="#cb375-10774" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'W'</span>: <span class="dv">186</span></span>
<span id="cb375-10775"><a href="#cb375-10775" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-10776"><a href="#cb375-10776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10777"><a href="#cb375-10777" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectrum_graph(masses: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb375-10778"><a href="#cb375-10778" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reverse mapping of weights to amino acids</span></span>
<span id="cb375-10779"><a href="#cb375-10779" aria-hidden="true" tabindex="-1"></a>    weight_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {weight: aa <span class="cf">for</span> aa, weight <span class="kw">in</span> amino_acid_weights.items()}</span>
<span id="cb375-10780"><a href="#cb375-10780" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-10781"><a href="#cb375-10781" aria-hidden="true" tabindex="-1"></a>    graph: DefaultDict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb375-10782"><a href="#cb375-10782" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-10783"><a href="#cb375-10783" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create graph based on mass differences</span></span>
<span id="cb375-10784"><a href="#cb375-10784" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(masses)):</span>
<span id="cb375-10785"><a href="#cb375-10785" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(masses)):</span>
<span id="cb375-10786"><a href="#cb375-10786" aria-hidden="true" tabindex="-1"></a>            difference: <span class="bu">int</span> <span class="op">=</span> masses[j] <span class="op">-</span> masses[i]</span>
<span id="cb375-10787"><a href="#cb375-10787" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> difference <span class="kw">in</span> weight_to_amino_acid:</span>
<span id="cb375-10788"><a href="#cb375-10788" aria-hidden="true" tabindex="-1"></a>                graph[masses[i]].append({<span class="st">"n"</span>: masses[j], <span class="st">"l"</span>: weight_to_amino_acid[difference]})</span>
<span id="cb375-10789"><a href="#cb375-10789" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb375-10790"><a href="#cb375-10790" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb375-10791"><a href="#cb375-10791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10792"><a href="#cb375-10792" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb375-10793"><a href="#cb375-10793" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"57 71 154 185 301 332 415 429 486"</span></span>
<span id="cb375-10794"><a href="#cb375-10794" aria-hidden="true" tabindex="-1"></a>masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, sample_input.split()))</span>
<span id="cb375-10795"><a href="#cb375-10795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10796"><a href="#cb375-10796" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the spectrum graph</span></span>
<span id="cb375-10797"><a href="#cb375-10797" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_mass, edges <span class="kw">in</span> spectrum_graph(masses).items():</span>
<span id="cb375-10798"><a href="#cb375-10798" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb375-10799"><a href="#cb375-10799" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>start_mass<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>edge[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>edge[<span class="st">'l'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb375-10800"><a href="#cb375-10800" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10801"><a href="#cb375-10801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10802"><a href="#cb375-10802" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement DecodingIdealSpectrum</span></span>
<span id="cb375-10803"><a href="#cb375-10803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10804"><a href="#cb375-10804" aria-hidden="true" tabindex="-1"></a>Decoding an Ideal Spectrum Problem. Reconstruct a peptide <span class="im">from</span> its ideal spectrum.</span>
<span id="cb375-10805"><a href="#cb375-10805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10806"><a href="#cb375-10806" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A space<span class="op">-</span>delimited <span class="bu">list</span> of integers,&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb375-10807"><a href="#cb375-10807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10808"><a href="#cb375-10808" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;An amino acid string <span class="cf">with</span> an ideal spectrum that matches&nbsp;<span class="op">*</span>Spectrum<span class="op">*</span>.</span>
<span id="cb375-10809"><a href="#cb375-10809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10810"><a href="#cb375-10810" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb375-10811"><a href="#cb375-10811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10812"><a href="#cb375-10812" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-10813"><a href="#cb375-10813" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10814"><a href="#cb375-10814" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10815"><a href="#cb375-10815" aria-hidden="true" tabindex="-1"></a><span class="dv">57</span> <span class="dv">71</span> <span class="dv">154</span> <span class="dv">185</span> <span class="dv">301</span> <span class="dv">332</span> <span class="dv">415</span> <span class="dv">429</span> <span class="dv">486</span></span>
<span id="cb375-10816"><a href="#cb375-10816" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10817"><a href="#cb375-10817" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10818"><a href="#cb375-10818" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-10819"><a href="#cb375-10819" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10820"><a href="#cb375-10820" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10821"><a href="#cb375-10821" aria-hidden="true" tabindex="-1"></a>GPFNA</span>
<span id="cb375-10822"><a href="#cb375-10822" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10823"><a href="#cb375-10823" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10824"><a href="#cb375-10824" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-10825"><a href="#cb375-10825" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10826"><a href="#cb375-10826" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-10827"><a href="#cb375-10827" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb375-10828"><a href="#cb375-10828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10829"><a href="#cb375-10829" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-10830"><a href="#cb375-10830" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-10831"><a href="#cb375-10831" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-10832"><a href="#cb375-10832" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-10833"><a href="#cb375-10833" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> amino_acid_masses.items()}</span>
<span id="cb375-10834"><a href="#cb375-10834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10835"><a href="#cb375-10835" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10836"><a href="#cb375-10836" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_spectrum_graph(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb375-10837"><a href="#cb375-10837" aria-hidden="true" tabindex="-1"></a>    adjacency_list: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-10838"><a href="#cb375-10838" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum)):</span>
<span id="cb375-10839"><a href="#cb375-10839" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectrum)):</span>
<span id="cb375-10840"><a href="#cb375-10840" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spectrum[j] <span class="op">-</span> spectrum[i] <span class="kw">in</span> mass_to_amino_acid.keys():</span>
<span id="cb375-10841"><a href="#cb375-10841" aria-hidden="true" tabindex="-1"></a>                adjacency_list.append([spectrum[i], spectrum[j], mass_to_amino_acid[spectrum[j] <span class="op">-</span> spectrum[i]]])</span>
<span id="cb375-10842"><a href="#cb375-10842" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb375-10843"><a href="#cb375-10843" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10844"><a href="#cb375-10844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10845"><a href="#cb375-10845" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_ideal_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-10846"><a href="#cb375-10846" aria-hidden="true" tabindex="-1"></a>    prefix_mass: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-10847"><a href="#cb375-10847" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-10848"><a href="#cb375-10848" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">=</span> prefix_mass[i] <span class="op">+</span> amino_acid_masses[peptide[i]]</span>
<span id="cb375-10849"><a href="#cb375-10849" aria-hidden="true" tabindex="-1"></a>        prefix_mass.append(temp)</span>
<span id="cb375-10850"><a href="#cb375-10850" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-10851"><a href="#cb375-10851" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-10852"><a href="#cb375-10852" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-10853"><a href="#cb375-10853" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(prefix_mass[j] <span class="op">-</span> prefix_mass[i])</span>
<span id="cb375-10854"><a href="#cb375-10854" aria-hidden="true" tabindex="-1"></a>    linear_spectrum.sort()</span>
<span id="cb375-10855"><a href="#cb375-10855" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_spectrum</span>
<span id="cb375-10856"><a href="#cb375-10856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10857"><a href="#cb375-10857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10858"><a href="#cb375-10858" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_paths(adjacency_list: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb375-10859"><a href="#cb375-10859" aria-hidden="true" tabindex="-1"></a>    node: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-10860"><a href="#cb375-10860" aria-hidden="true" tabindex="-1"></a>    peptide_list: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb375-10861"><a href="#cb375-10861" aria-hidden="true" tabindex="-1"></a>    tmp_edges: List[List[List[<span class="bu">int</span>]]] <span class="op">=</span> []</span>
<span id="cb375-10862"><a href="#cb375-10862" aria-hidden="true" tabindex="-1"></a>    peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span></span>
<span id="cb375-10863"><a href="#cb375-10863" aria-hidden="true" tabindex="-1"></a>    tmp_peps: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb375-10864"><a href="#cb375-10864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10865"><a href="#cb375-10865" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">any</span>([<span class="bu">len</span>(x) <span class="op">!=</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> tmp_edges]) <span class="kw">or</span> <span class="bu">len</span>(tmp_edges) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb375-10866"><a href="#cb375-10866" aria-hidden="true" tabindex="-1"></a>        next_edges: List[List[<span class="bu">int</span>]] <span class="op">=</span> [e <span class="cf">for</span> e <span class="kw">in</span> adjacency_list <span class="cf">if</span> e[<span class="dv">0</span>] <span class="op">==</span> node]</span>
<span id="cb375-10867"><a href="#cb375-10867" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(next_edges) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb375-10868"><a href="#cb375-10868" aria-hidden="true" tabindex="-1"></a>            tmp <span class="op">=</span> next_edges[<span class="dv">1</span>:]</span>
<span id="cb375-10869"><a href="#cb375-10869" aria-hidden="true" tabindex="-1"></a>            tmp_edges.append(tmp)</span>
<span id="cb375-10870"><a href="#cb375-10870" aria-hidden="true" tabindex="-1"></a>            tmp_peps.append(peptide)</span>
<span id="cb375-10871"><a href="#cb375-10871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10872"><a href="#cb375-10872" aria-hidden="true" tabindex="-1"></a>        next_edge <span class="op">=</span> next_edges[<span class="dv">0</span>]</span>
<span id="cb375-10873"><a href="#cb375-10873" aria-hidden="true" tabindex="-1"></a>        peptide <span class="op">+=</span> next_edge[<span class="dv">2</span>]</span>
<span id="cb375-10874"><a href="#cb375-10874" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> next_edge[<span class="dv">1</span>]</span>
<span id="cb375-10875"><a href="#cb375-10875" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10876"><a href="#cb375-10876" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>([e <span class="cf">for</span> e <span class="kw">in</span> adjacency_list <span class="cf">if</span> e[<span class="dv">0</span>] <span class="op">==</span> node]) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb375-10877"><a href="#cb375-10877" aria-hidden="true" tabindex="-1"></a>            tmp <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> tmp_edges <span class="cf">if</span> <span class="bu">len</span>(x) <span class="op">!=</span> <span class="dv">0</span>][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-10878"><a href="#cb375-10878" aria-hidden="true" tabindex="-1"></a>            next_edge <span class="op">=</span> tmp.pop()</span>
<span id="cb375-10879"><a href="#cb375-10879" aria-hidden="true" tabindex="-1"></a>            node <span class="op">=</span> next_edge[<span class="dv">1</span>]</span>
<span id="cb375-10880"><a href="#cb375-10880" aria-hidden="true" tabindex="-1"></a>            peptide_list.append(peptide)</span>
<span id="cb375-10881"><a href="#cb375-10881" aria-hidden="true" tabindex="-1"></a>            tmp_pep <span class="op">=</span> tmp_peps.pop()</span>
<span id="cb375-10882"><a href="#cb375-10882" aria-hidden="true" tabindex="-1"></a>            peptide <span class="op">=</span> tmp_pep <span class="op">+</span> next_edge[<span class="dv">2</span>]</span>
<span id="cb375-10883"><a href="#cb375-10883" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10884"><a href="#cb375-10884" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide_list</span>
<span id="cb375-10885"><a href="#cb375-10885" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10886"><a href="#cb375-10886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10887"><a href="#cb375-10887" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> decode_ideal_spectrum(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-10888"><a href="#cb375-10888" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> create_spectrum_graph(spectrum)</span>
<span id="cb375-10889"><a href="#cb375-10889" aria-hidden="true" tabindex="-1"></a>    all_paths <span class="op">=</span> find_paths(adjacency_list)</span>
<span id="cb375-10890"><a href="#cb375-10890" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> all_paths:</span>
<span id="cb375-10891"><a href="#cb375-10891" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">set</span>(spectrum).issubset(calculate_ideal_spectrum(peptide)):</span>
<span id="cb375-10892"><a href="#cb375-10892" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> peptide</span>
<span id="cb375-10893"><a href="#cb375-10893" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10894"><a href="#cb375-10894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10895"><a href="#cb375-10895" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-10896"><a href="#cb375-10896" aria-hidden="true" tabindex="-1"></a><span class="st">57 71 154 185 301 332 415 429 486</span></span>
<span id="cb375-10897"><a href="#cb375-10897" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-10898"><a href="#cb375-10898" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10899"><a href="#cb375-10899" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(s) <span class="cf">for</span> s <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb375-10900"><a href="#cb375-10900" aria-hidden="true" tabindex="-1"></a>spectrum <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> spectrum</span>
<span id="cb375-10901"><a href="#cb375-10901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10902"><a href="#cb375-10902" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(decode_ideal_spectrum(spectrum))</span>
<span id="cb375-10903"><a href="#cb375-10903" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10904"><a href="#cb375-10904" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10905"><a href="#cb375-10905" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert a Peptide into a Peptide Vector</span></span>
<span id="cb375-10906"><a href="#cb375-10906" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10907"><a href="#cb375-10907" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A peptide&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb375-10908"><a href="#cb375-10908" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10909"><a href="#cb375-10909" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;The peptide vector of&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb375-10910"><a href="#cb375-10910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10911"><a href="#cb375-10911" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb375-10912"><a href="#cb375-10912" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10913"><a href="#cb375-10913" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-10914"><a href="#cb375-10914" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10915"><a href="#cb375-10915" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10916"><a href="#cb375-10916" aria-hidden="true" tabindex="-1"></a>XZZXX</span>
<span id="cb375-10917"><a href="#cb375-10917" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10918"><a href="#cb375-10918" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10919"><a href="#cb375-10919" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-10920"><a href="#cb375-10920" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10921"><a href="#cb375-10921" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10922"><a href="#cb375-10922" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span></span>
<span id="cb375-10923"><a href="#cb375-10923" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10924"><a href="#cb375-10924" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10925"><a href="#cb375-10925" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-10926"><a href="#cb375-10926" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10927"><a href="#cb375-10927" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-10928"><a href="#cb375-10928" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-10929"><a href="#cb375-10929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10930"><a href="#cb375-10930" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-10931"><a href="#cb375-10931" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>,</span>
<span id="cb375-10932"><a href="#cb375-10932" aria-hidden="true" tabindex="-1"></a>    <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span></span>
<span id="cb375-10933"><a href="#cb375-10933" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-10934"><a href="#cb375-10934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10935"><a href="#cb375-10935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10936"><a href="#cb375-10936" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_peptide_vector(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-10937"><a href="#cb375-10937" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb375-10938"><a href="#cb375-10938" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-10939"><a href="#cb375-10939" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> peptide[:i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb375-10940"><a href="#cb375-10940" aria-hidden="true" tabindex="-1"></a>        mass <span class="op">=</span> <span class="bu">sum</span>(amino_acid_masses[aa] <span class="cf">for</span> aa <span class="kw">in</span> prefix)</span>
<span id="cb375-10941"><a href="#cb375-10941" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(mass)</span>
<span id="cb375-10942"><a href="#cb375-10942" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10943"><a href="#cb375-10943" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-10944"><a href="#cb375-10944" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses:</span>
<span id="cb375-10945"><a href="#cb375-10945" aria-hidden="true" tabindex="-1"></a>        vector[mass <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-10946"><a href="#cb375-10946" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vector</span>
<span id="cb375-10947"><a href="#cb375-10947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10948"><a href="#cb375-10948" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10949"><a href="#cb375-10949" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-10950"><a href="#cb375-10950" aria-hidden="true" tabindex="-1"></a><span class="st">XZZXX</span></span>
<span id="cb375-10951"><a href="#cb375-10951" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-10952"><a href="#cb375-10952" aria-hidden="true" tabindex="-1"></a>peptide: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb375-10953"><a href="#cb375-10953" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>.join(<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> create_peptide_vector(peptide)))</span>
<span id="cb375-10954"><a href="#cb375-10954" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10955"><a href="#cb375-10955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10956"><a href="#cb375-10956" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert a Peptide Vector into a Peptide</span></span>
<span id="cb375-10957"><a href="#cb375-10957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10958"><a href="#cb375-10958" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A space<span class="op">-</span>delimited binary vector&nbsp;<span class="op">*</span>P<span class="op">*</span>.</span>
<span id="cb375-10959"><a href="#cb375-10959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10960"><a href="#cb375-10960" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A peptide whose binary peptide vector matches&nbsp;<span class="op">*</span>P<span class="op">*</span>. For masses <span class="cf">with</span> more than one amino acid, <span class="bu">any</span> choice may be used.</span>
<span id="cb375-10961"><a href="#cb375-10961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10962"><a href="#cb375-10962" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb375-10963"><a href="#cb375-10963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10964"><a href="#cb375-10964" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-10965"><a href="#cb375-10965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10966"><a href="#cb375-10966" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10967"><a href="#cb375-10967" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span></span>
<span id="cb375-10968"><a href="#cb375-10968" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10969"><a href="#cb375-10969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10970"><a href="#cb375-10970" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-10971"><a href="#cb375-10971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10972"><a href="#cb375-10972" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10973"><a href="#cb375-10973" aria-hidden="true" tabindex="-1"></a>XZZXX</span>
<span id="cb375-10974"><a href="#cb375-10974" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-10975"><a href="#cb375-10975" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10976"><a href="#cb375-10976" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-10977"><a href="#cb375-10977" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10978"><a href="#cb375-10978" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-10979"><a href="#cb375-10979" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-10980"><a href="#cb375-10980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10981"><a href="#cb375-10981" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-10982"><a href="#cb375-10982" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-10983"><a href="#cb375-10983" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-10984"><a href="#cb375-10984" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-10985"><a href="#cb375-10985" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> amino_acid_masses.items()}</span>
<span id="cb375-10986"><a href="#cb375-10986" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid[<span class="dv">4</span>] <span class="op">=</span> <span class="st">'X'</span></span>
<span id="cb375-10987"><a href="#cb375-10987" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid[<span class="dv">5</span>] <span class="op">=</span> <span class="st">'Z'</span></span>
<span id="cb375-10988"><a href="#cb375-10988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10989"><a href="#cb375-10989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10990"><a href="#cb375-10990" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_peptide_vector_to_sequence(vector: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-10991"><a href="#cb375-10991" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [i <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(vector) <span class="cf">if</span> v <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb375-10992"><a href="#cb375-10992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10993"><a href="#cb375-10993" aria-hidden="true" tabindex="-1"></a>    peptide: <span class="bu">str</span> <span class="op">=</span> mass_to_amino_acid[prefix_masses[<span class="dv">0</span>]]</span>
<span id="cb375-10994"><a href="#cb375-10994" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(prefix_masses)):</span>
<span id="cb375-10995"><a href="#cb375-10995" aria-hidden="true" tabindex="-1"></a>        mass <span class="op">=</span> prefix_masses[i] <span class="op">-</span> prefix_masses[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-10996"><a href="#cb375-10996" aria-hidden="true" tabindex="-1"></a>        peptide <span class="op">+=</span> mass_to_amino_acid[mass]</span>
<span id="cb375-10997"><a href="#cb375-10997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-10998"><a href="#cb375-10998" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide</span>
<span id="cb375-10999"><a href="#cb375-10999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11000"><a href="#cb375-11000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11001"><a href="#cb375-11001" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-11002"><a href="#cb375-11002" aria-hidden="true" tabindex="-1"></a><span class="st">0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1</span></span>
<span id="cb375-11003"><a href="#cb375-11003" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-11004"><a href="#cb375-11004" aria-hidden="true" tabindex="-1"></a>vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb375-11005"><a href="#cb375-11005" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11006"><a href="#cb375-11006" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(convert_peptide_vector_to_sequence(vector))</span>
<span id="cb375-11007"><a href="#cb375-11007" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11008"><a href="#cb375-11008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11009"><a href="#cb375-11009" aria-hidden="true" tabindex="-1"></a><span class="co"># Sequence a Peptide</span></span>
<span id="cb375-11010"><a href="#cb375-11010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11011"><a href="#cb375-11011" aria-hidden="true" tabindex="-1"></a>Peptide Sequencing Problem. Given a spectral vector S, find a peptide vector <span class="cf">with</span> maximum score against S.</span>
<span id="cb375-11012"><a href="#cb375-11012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11013"><a href="#cb375-11013" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A space<span class="op">-</span>delimited spectral vector&nbsp;<span class="op">*</span>S<span class="op">*</span>.</span>
<span id="cb375-11014"><a href="#cb375-11014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11015"><a href="#cb375-11015" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A peptide <span class="cf">with</span> maximum score against&nbsp;<span class="op">*</span>S<span class="op">*</span>. For masses <span class="cf">with</span> more than one amino acid, <span class="bu">any</span> choice may be used.</span>
<span id="cb375-11016"><a href="#cb375-11016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11017"><a href="#cb375-11017" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb375-11018"><a href="#cb375-11018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11019"><a href="#cb375-11019" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-11020"><a href="#cb375-11020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11021"><a href="#cb375-11021" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11022"><a href="#cb375-11022" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">4</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">1</span> <span class="op">-</span><span class="dv">7</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">3</span> <span class="op">-</span><span class="dv">8</span> <span class="dv">0</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">0</span></span>
<span id="cb375-11023"><a href="#cb375-11023" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11024"><a href="#cb375-11024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11025"><a href="#cb375-11025" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-11026"><a href="#cb375-11026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11027"><a href="#cb375-11027" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11028"><a href="#cb375-11028" aria-hidden="true" tabindex="-1"></a>XZZXX</span>
<span id="cb375-11029"><a href="#cb375-11029" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11030"><a href="#cb375-11030" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11031"><a href="#cb375-11031" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-11032"><a href="#cb375-11032" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11033"><a href="#cb375-11033" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-11034"><a href="#cb375-11034" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb375-11035"><a href="#cb375-11035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11036"><a href="#cb375-11036" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-11037"><a href="#cb375-11037" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-11038"><a href="#cb375-11038" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-11039"><a href="#cb375-11039" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-11040"><a href="#cb375-11040" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> amino_acid_masses.items()}</span>
<span id="cb375-11041"><a href="#cb375-11041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11042"><a href="#cb375-11042" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11043"><a href="#cb375-11043" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sequence_peptide(spectral_vector: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-11044"><a href="#cb375-11044" aria-hidden="true" tabindex="-1"></a>    spectral_vector <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> spectral_vector</span>
<span id="cb375-11045"><a href="#cb375-11045" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11046"><a href="#cb375-11046" aria-hidden="true" tabindex="-1"></a>    adjacency_list: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-11047"><a href="#cb375-11047" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb375-11048"><a href="#cb375-11048" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectral_vector)):</span>
<span id="cb375-11049"><a href="#cb375-11049" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (j <span class="op">-</span> i) <span class="kw">in</span> mass_to_amino_acid.keys():</span>
<span id="cb375-11050"><a href="#cb375-11050" aria-hidden="true" tabindex="-1"></a>                adjacency_list.append([i, j])</span>
<span id="cb375-11051"><a href="#cb375-11051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11052"><a href="#cb375-11052" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">int</span>, List[List[Union[<span class="bu">int</span>, <span class="bu">str</span>]]]] <span class="op">=</span> {}</span>
<span id="cb375-11053"><a href="#cb375-11053" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb375-11054"><a href="#cb375-11054" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectral_vector)):</span>
<span id="cb375-11055"><a href="#cb375-11055" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (j <span class="op">-</span> i) <span class="kw">in</span> mass_to_amino_acid.keys():</span>
<span id="cb375-11056"><a href="#cb375-11056" aria-hidden="true" tabindex="-1"></a>                edge <span class="op">=</span> [i, mass_to_amino_acid[j <span class="op">-</span> i]]</span>
<span id="cb375-11057"><a href="#cb375-11057" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> j <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb375-11058"><a href="#cb375-11058" aria-hidden="true" tabindex="-1"></a>                    adjacency_dict[j] <span class="op">=</span> [edge]</span>
<span id="cb375-11059"><a href="#cb375-11059" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb375-11060"><a href="#cb375-11060" aria-hidden="true" tabindex="-1"></a>                    adjacency_dict[j].append(edge)</span>
<span id="cb375-11061"><a href="#cb375-11061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11062"><a href="#cb375-11062" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, List[Union[<span class="bu">float</span>, <span class="bu">str</span>]]] <span class="op">=</span> {<span class="dv">0</span>: [<span class="dv">0</span>, <span class="st">'-'</span>]}</span>
<span id="cb375-11063"><a href="#cb375-11063" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> adjacency_dict.keys():</span>
<span id="cb375-11064"><a href="#cb375-11064" aria-hidden="true" tabindex="-1"></a>        scores[node] <span class="op">=</span> [<span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'-'</span>]</span>
<span id="cb375-11065"><a href="#cb375-11065" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> adjacency_dict[node]</span>
<span id="cb375-11066"><a href="#cb375-11066" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb375-11067"><a href="#cb375-11067" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> edge[<span class="dv">0</span>] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb375-11068"><a href="#cb375-11068" aria-hidden="true" tabindex="-1"></a>                scores[edge[<span class="dv">0</span>]] <span class="op">=</span> [<span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'-'</span>]</span>
<span id="cb375-11069"><a href="#cb375-11069" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11070"><a href="#cb375-11070" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> adjacency_dict.keys():</span>
<span id="cb375-11071"><a href="#cb375-11071" aria-hidden="true" tabindex="-1"></a>        max_score: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb375-11072"><a href="#cb375-11072" aria-hidden="true" tabindex="-1"></a>        best_edge: Union[<span class="bu">str</span>, List[Union[<span class="bu">int</span>, <span class="bu">str</span>]]] <span class="op">=</span> <span class="st">'-'</span></span>
<span id="cb375-11073"><a href="#cb375-11073" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> parent <span class="kw">in</span> adjacency_dict[node]:</span>
<span id="cb375-11074"><a href="#cb375-11074" aria-hidden="true" tabindex="-1"></a>            score <span class="op">=</span> scores[parent[<span class="dv">0</span>]][<span class="dv">0</span>]</span>
<span id="cb375-11075"><a href="#cb375-11075" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score <span class="op">&gt;</span> max_score:</span>
<span id="cb375-11076"><a href="#cb375-11076" aria-hidden="true" tabindex="-1"></a>                max_score <span class="op">=</span> score</span>
<span id="cb375-11077"><a href="#cb375-11077" aria-hidden="true" tabindex="-1"></a>                best_edge <span class="op">=</span> parent</span>
<span id="cb375-11078"><a href="#cb375-11078" aria-hidden="true" tabindex="-1"></a>        scores[node] <span class="op">=</span> [max_score <span class="op">+</span> spectral_vector[node], best_edge]</span>
<span id="cb375-11079"><a href="#cb375-11079" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11080"><a href="#cb375-11080" aria-hidden="true" tabindex="-1"></a>    node: <span class="bu">int</span> <span class="op">=</span> <span class="bu">list</span>(scores.keys())[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-11081"><a href="#cb375-11081" aria-hidden="true" tabindex="-1"></a>    peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span></span>
<span id="cb375-11082"><a href="#cb375-11082" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb375-11083"><a href="#cb375-11083" aria-hidden="true" tabindex="-1"></a>        peptide <span class="op">=</span> scores[node][<span class="dv">1</span>][<span class="dv">1</span>] <span class="op">+</span> peptide</span>
<span id="cb375-11084"><a href="#cb375-11084" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> scores[node][<span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb375-11085"><a href="#cb375-11085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11086"><a href="#cb375-11086" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide</span>
<span id="cb375-11087"><a href="#cb375-11087" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11088"><a href="#cb375-11088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11089"><a href="#cb375-11089" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-11090"><a href="#cb375-11090" aria-hidden="true" tabindex="-1"></a><span class="st">0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 0</span></span>
<span id="cb375-11091"><a href="#cb375-11091" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-11092"><a href="#cb375-11092" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11093"><a href="#cb375-11093" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.split()]</span>
<span id="cb375-11094"><a href="#cb375-11094" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11095"><a href="#cb375-11095" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sequence_peptide(spectral_vector))</span>
<span id="cb375-11096"><a href="#cb375-11096" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11097"><a href="#cb375-11097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11098"><a href="#cb375-11098" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Peptide in a Proteome against a Spectrum</span></span>
<span id="cb375-11099"><a href="#cb375-11099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11100"><a href="#cb375-11100" aria-hidden="true" tabindex="-1"></a>Peptide Identification Problem. Find a peptide <span class="im">from</span> a proteome <span class="cf">with</span> maximum score against a spectrum.</span>
<span id="cb375-11101"><a href="#cb375-11101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11102"><a href="#cb375-11102" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A space<span class="op">-</span>delimited spectral vector&nbsp;<span class="op">*</span>S<span class="op">*</span>&nbsp;and an amino acid string&nbsp;<span class="op">*</span>Proteome<span class="op">*</span>.</span>
<span id="cb375-11103"><a href="#cb375-11103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11104"><a href="#cb375-11104" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;A peptide in&nbsp;<span class="op">*</span>Proteome<span class="op">*</span>&nbsp;with maximum score against&nbsp;<span class="op">*</span>S<span class="op">*</span>.</span>
<span id="cb375-11105"><a href="#cb375-11105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11106"><a href="#cb375-11106" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb375-11107"><a href="#cb375-11107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11108"><a href="#cb375-11108" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-11109"><a href="#cb375-11109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11110"><a href="#cb375-11110" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11111"><a href="#cb375-11111" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">4</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">1</span> <span class="op">-</span><span class="dv">7</span> <span class="dv">6</span> <span class="dv">5</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">9</span> <span class="dv">3</span> <span class="op">-</span><span class="dv">8</span> <span class="dv">0</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">8</span></span>
<span id="cb375-11112"><a href="#cb375-11112" aria-hidden="true" tabindex="-1"></a>XZZXZXXXZXZZXZXXZ</span>
<span id="cb375-11113"><a href="#cb375-11113" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11114"><a href="#cb375-11114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11115"><a href="#cb375-11115" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-11116"><a href="#cb375-11116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11117"><a href="#cb375-11117" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11118"><a href="#cb375-11118" aria-hidden="true" tabindex="-1"></a>ZXZXX</span>
<span id="cb375-11119"><a href="#cb375-11119" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11120"><a href="#cb375-11120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11121"><a href="#cb375-11121" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-11122"><a href="#cb375-11122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11123"><a href="#cb375-11123" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-11124"><a href="#cb375-11124" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-11125"><a href="#cb375-11125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11126"><a href="#cb375-11126" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-11127"><a href="#cb375-11127" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-11128"><a href="#cb375-11128" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>,</span>
<span id="cb375-11129"><a href="#cb375-11129" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span>  <span class="co"># Added 'X' and 'Z' with arbitrary masses</span></span>
<span id="cb375-11130"><a href="#cb375-11130" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-11131"><a href="#cb375-11131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11132"><a href="#cb375-11132" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_peptide_vector(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-11133"><a href="#cb375-11133" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-11134"><a href="#cb375-11134" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb375-11135"><a href="#cb375-11135" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> amino_acid_masses[amino_acid])</span>
<span id="cb375-11136"><a href="#cb375-11136" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-11137"><a href="#cb375-11137" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses[<span class="dv">1</span>:]:</span>
<span id="cb375-11138"><a href="#cb375-11138" aria-hidden="true" tabindex="-1"></a>        vector[mass <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-11139"><a href="#cb375-11139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vector</span>
<span id="cb375-11140"><a href="#cb375-11140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11141"><a href="#cb375-11141" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> identify_peptide(spectral_vector: List[<span class="bu">int</span>], proteome: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-11142"><a href="#cb375-11142" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">float</span>(<span class="st">'-inf'</span>)</span>
<span id="cb375-11143"><a href="#cb375-11143" aria-hidden="true" tabindex="-1"></a>    best_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb375-11144"><a href="#cb375-11144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11145"><a href="#cb375-11145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(proteome)):</span>
<span id="cb375-11146"><a href="#cb375-11146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(proteome) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11147"><a href="#cb375-11147" aria-hidden="true" tabindex="-1"></a>            peptide: <span class="bu">str</span> <span class="op">=</span> proteome[i:j]</span>
<span id="cb375-11148"><a href="#cb375-11148" aria-hidden="true" tabindex="-1"></a>            peptide_vector: List[<span class="bu">int</span>] <span class="op">=</span> create_peptide_vector(peptide)</span>
<span id="cb375-11149"><a href="#cb375-11149" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb375-11150"><a href="#cb375-11150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">&gt;</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb375-11151"><a href="#cb375-11151" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb375-11152"><a href="#cb375-11152" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb375-11153"><a href="#cb375-11153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">==</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb375-11154"><a href="#cb375-11154" aria-hidden="true" tabindex="-1"></a>                score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">sum</span>(s <span class="op">*</span> v <span class="cf">for</span> s, v <span class="kw">in</span> <span class="bu">zip</span>(spectral_vector, peptide_vector))</span>
<span id="cb375-11155"><a href="#cb375-11155" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> score <span class="op">&gt;</span> max_score:</span>
<span id="cb375-11156"><a href="#cb375-11156" aria-hidden="true" tabindex="-1"></a>                    max_score <span class="op">=</span> score</span>
<span id="cb375-11157"><a href="#cb375-11157" aria-hidden="true" tabindex="-1"></a>                    best_peptide <span class="op">=</span> peptide</span>
<span id="cb375-11158"><a href="#cb375-11158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11159"><a href="#cb375-11159" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_peptide</span>
<span id="cb375-11160"><a href="#cb375-11160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11161"><a href="#cb375-11161" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-11162"><a href="#cb375-11162" aria-hidden="true" tabindex="-1"></a><span class="st">0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 8</span></span>
<span id="cb375-11163"><a href="#cb375-11163" aria-hidden="true" tabindex="-1"></a><span class="st">XZZXZXXXZXZZXZXXZ</span></span>
<span id="cb375-11164"><a href="#cb375-11164" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-11165"><a href="#cb375-11165" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-11166"><a href="#cb375-11166" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">0</span>].strip().split()]</span>
<span id="cb375-11167"><a href="#cb375-11167" aria-hidden="true" tabindex="-1"></a>proteome: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>].strip()</span>
<span id="cb375-11168"><a href="#cb375-11168" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(identify_peptide(spectral_vector, proteome))</span>
<span id="cb375-11169"><a href="#cb375-11169" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11170"><a href="#cb375-11170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11171"><a href="#cb375-11171" aria-hidden="true" tabindex="-1"></a><span class="co"># Implement PSMSearch</span></span>
<span id="cb375-11172"><a href="#cb375-11172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11173"><a href="#cb375-11173" aria-hidden="true" tabindex="-1"></a>PSM Search Problem. Identify Peptide<span class="op">-</span>Spectrum Matches by matching spectra against a proteome.</span>
<span id="cb375-11174"><a href="#cb375-11174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11175"><a href="#cb375-11175" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A <span class="bu">set</span> of space<span class="op">-</span>delimited spectral vectors&nbsp;<span class="op">*</span>SpectralVectors<span class="op">*</span>, an amino acid string&nbsp;<span class="op">*</span>Proteome<span class="op">*</span>, <span class="kw">and</span> a score threshold&nbsp;<span class="op">*</span>T<span class="op">*</span>.</span>
<span id="cb375-11176"><a href="#cb375-11176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11177"><a href="#cb375-11177" aria-hidden="true" tabindex="-1"></a>Return:&nbsp;All unique Peptide<span class="op">-</span>Spectrum Matches scoring at least <span class="im">as</span> high as&nbsp;<span class="op">*</span>T<span class="op">*</span>.</span>
<span id="cb375-11178"><a href="#cb375-11178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11179"><a href="#cb375-11179" aria-hidden="true" tabindex="-1"></a>Note: For this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X: <span class="dv">4</span>, Z: <span class="fl">5.</span></span>
<span id="cb375-11180"><a href="#cb375-11180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11181"><a href="#cb375-11181" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-11182"><a href="#cb375-11182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11183"><a href="#cb375-11183" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11184"><a href="#cb375-11184" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="dv">1</span> <span class="dv">5</span> <span class="op">-</span><span class="dv">4</span> <span class="dv">5</span> <span class="dv">3</span> <span class="op">-</span><span class="dv">1</span> <span class="op">-</span><span class="dv">4</span> <span class="dv">5</span> <span class="op">-</span><span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">4</span> <span class="op">-</span><span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span></span>
<span id="cb375-11185"><a href="#cb375-11185" aria-hidden="true" tabindex="-1"></a><span class="op">-</span><span class="dv">4</span> <span class="dv">2</span> <span class="op">-</span><span class="dv">2</span> <span class="op">-</span><span class="dv">4</span> <span class="dv">4</span> <span class="op">-</span><span class="dv">5</span> <span class="op">-</span><span class="dv">1</span> <span class="dv">4</span> <span class="op">-</span><span class="dv">1</span> <span class="dv">2</span> <span class="dv">5</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">2</span> <span class="op">-</span><span class="dv">3</span></span>
<span id="cb375-11186"><a href="#cb375-11186" aria-hidden="true" tabindex="-1"></a>XXXZXZXXZXZXXXZXXZX</span>
<span id="cb375-11187"><a href="#cb375-11187" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span></span>
<span id="cb375-11188"><a href="#cb375-11188" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11189"><a href="#cb375-11189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11190"><a href="#cb375-11190" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-11191"><a href="#cb375-11191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11192"><a href="#cb375-11192" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11193"><a href="#cb375-11193" aria-hidden="true" tabindex="-1"></a>XZXZ</span>
<span id="cb375-11194"><a href="#cb375-11194" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11195"><a href="#cb375-11195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11196"><a href="#cb375-11196" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-11197"><a href="#cb375-11197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11198"><a href="#cb375-11198" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-11199"><a href="#cb375-11199" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb375-11200"><a href="#cb375-11200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11201"><a href="#cb375-11201" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-11202"><a href="#cb375-11202" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-11203"><a href="#cb375-11203" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>,</span>
<span id="cb375-11204"><a href="#cb375-11204" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span>  <span class="co"># Added 'X' and 'Z' with arbitrary masses</span></span>
<span id="cb375-11205"><a href="#cb375-11205" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-11206"><a href="#cb375-11206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11207"><a href="#cb375-11207" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_number(n: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb375-11208"><a href="#cb375-11208" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb375-11209"><a href="#cb375-11209" aria-hidden="true" tabindex="-1"></a>        <span class="bu">float</span>(n)</span>
<span id="cb375-11210"><a href="#cb375-11210" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb375-11211"><a href="#cb375-11211" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb375-11212"><a href="#cb375-11212" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb375-11213"><a href="#cb375-11213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11214"><a href="#cb375-11214" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_peptide_vector(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb375-11215"><a href="#cb375-11215" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-11216"><a href="#cb375-11216" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb375-11217"><a href="#cb375-11217" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> amino_acid_masses[amino_acid])</span>
<span id="cb375-11218"><a href="#cb375-11218" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb375-11219"><a href="#cb375-11219" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses[<span class="dv">1</span>:]:</span>
<span id="cb375-11220"><a href="#cb375-11220" aria-hidden="true" tabindex="-1"></a>        vector[mass <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb375-11221"><a href="#cb375-11221" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vector</span>
<span id="cb375-11222"><a href="#cb375-11222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11223"><a href="#cb375-11223" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> identify_peptide(spectral_vector: List[<span class="bu">int</span>], proteome: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>]:</span>
<span id="cb375-11224"><a href="#cb375-11224" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">float</span>(<span class="st">'-inf'</span>)</span>
<span id="cb375-11225"><a href="#cb375-11225" aria-hidden="true" tabindex="-1"></a>    best_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span></span>
<span id="cb375-11226"><a href="#cb375-11226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11227"><a href="#cb375-11227" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(proteome)):</span>
<span id="cb375-11228"><a href="#cb375-11228" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(proteome) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11229"><a href="#cb375-11229" aria-hidden="true" tabindex="-1"></a>            peptide: <span class="bu">str</span> <span class="op">=</span> proteome[i:j]</span>
<span id="cb375-11230"><a href="#cb375-11230" aria-hidden="true" tabindex="-1"></a>            peptide_vector: List[<span class="bu">int</span>] <span class="op">=</span> create_peptide_vector(peptide)</span>
<span id="cb375-11231"><a href="#cb375-11231" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb375-11232"><a href="#cb375-11232" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">&gt;</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb375-11233"><a href="#cb375-11233" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb375-11234"><a href="#cb375-11234" aria-hidden="true" tabindex="-1"></a>            </span>
<span id="cb375-11235"><a href="#cb375-11235" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">==</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb375-11236"><a href="#cb375-11236" aria-hidden="true" tabindex="-1"></a>                score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">sum</span>(s <span class="op">*</span> v <span class="cf">for</span> s, v <span class="kw">in</span> <span class="bu">zip</span>(spectral_vector, peptide_vector))</span>
<span id="cb375-11237"><a href="#cb375-11237" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> score <span class="op">&gt;</span> max_score:</span>
<span id="cb375-11238"><a href="#cb375-11238" aria-hidden="true" tabindex="-1"></a>                    max_score <span class="op">=</span> score</span>
<span id="cb375-11239"><a href="#cb375-11239" aria-hidden="true" tabindex="-1"></a>                    best_peptide <span class="op">=</span> peptide</span>
<span id="cb375-11240"><a href="#cb375-11240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11241"><a href="#cb375-11241" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_peptide, max_score</span>
<span id="cb375-11242"><a href="#cb375-11242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11243"><a href="#cb375-11243" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> search_peptide_spectrum_matches(spectral_vectors: List[List[<span class="bu">int</span>]], proteome: <span class="bu">str</span>, threshold: <span class="bu">float</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb375-11244"><a href="#cb375-11244" aria-hidden="true" tabindex="-1"></a>    psm_set: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb375-11245"><a href="#cb375-11245" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vector <span class="kw">in</span> spectral_vectors:</span>
<span id="cb375-11246"><a href="#cb375-11246" aria-hidden="true" tabindex="-1"></a>        peptide, score <span class="op">=</span> identify_peptide(vector, proteome)</span>
<span id="cb375-11247"><a href="#cb375-11247" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&gt;=</span> threshold:</span>
<span id="cb375-11248"><a href="#cb375-11248" aria-hidden="true" tabindex="-1"></a>            psm_set.add(peptide)</span>
<span id="cb375-11249"><a href="#cb375-11249" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> psm_set</span>
<span id="cb375-11250"><a href="#cb375-11250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11251"><a href="#cb375-11251" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-11252"><a href="#cb375-11252" aria-hidden="true" tabindex="-1"></a><span class="st">-1 5 -4 5 3 -1 -4 5 -1 0 0 4 -1 0 1 4 4 4</span></span>
<span id="cb375-11253"><a href="#cb375-11253" aria-hidden="true" tabindex="-1"></a><span class="st">-4 2 -2 -4 4 -5 -1 4 -1 2 5 -3 -1 3 2 -3</span></span>
<span id="cb375-11254"><a href="#cb375-11254" aria-hidden="true" tabindex="-1"></a><span class="st">XXXZXZXXZXZXXXZXXZX</span></span>
<span id="cb375-11255"><a href="#cb375-11255" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb375-11256"><a href="#cb375-11256" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-11257"><a href="#cb375-11257" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-11258"><a href="#cb375-11258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11259"><a href="#cb375-11259" aria-hidden="true" tabindex="-1"></a>spectral_vectors: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb375-11260"><a href="#cb375-11260" aria-hidden="true" tabindex="-1"></a>idx: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-11261"><a href="#cb375-11261" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> idx <span class="op">&lt;</span> <span class="bu">len</span>(input_lines) <span class="kw">and</span> (is_number(input_lines[idx][<span class="dv">0</span>]) <span class="kw">or</span> is_number(input_lines[idx][:<span class="dv">2</span>])):</span>
<span id="cb375-11262"><a href="#cb375-11262" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[idx].strip().split()]</span>
<span id="cb375-11263"><a href="#cb375-11263" aria-hidden="true" tabindex="-1"></a>    spectral_vectors.append(vector)</span>
<span id="cb375-11264"><a href="#cb375-11264" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb375-11265"><a href="#cb375-11265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11266"><a href="#cb375-11266" aria-hidden="true" tabindex="-1"></a>proteome: <span class="bu">str</span> <span class="op">=</span> input_lines[idx].strip()</span>
<span id="cb375-11267"><a href="#cb375-11267" aria-hidden="true" tabindex="-1"></a>threshold: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[idx <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb375-11268"><a href="#cb375-11268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11269"><a href="#cb375-11269" aria-hidden="true" tabindex="-1"></a>result: Set[<span class="bu">str</span>] <span class="op">=</span> search_peptide_spectrum_matches(spectral_vectors, proteome, threshold)</span>
<span id="cb375-11270"><a href="#cb375-11270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11271"><a href="#cb375-11271" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> peptide <span class="kw">in</span> result:</span>
<span id="cb375-11272"><a href="#cb375-11272" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(peptide)</span>
<span id="cb375-11273"><a href="#cb375-11273" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11274"><a href="#cb375-11274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11275"><a href="#cb375-11275" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Size of a Spectral Dictionary</span></span>
<span id="cb375-11276"><a href="#cb375-11276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11277"><a href="#cb375-11277" aria-hidden="true" tabindex="-1"></a>Size of Spectral Dictionary Problem. Find the size of the spectral dictionary <span class="cf">for</span> a given spectrum <span class="kw">and</span> score threshold.</span>
<span id="cb375-11278"><a href="#cb375-11278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11279"><a href="#cb375-11279" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A spectral vector&nbsp;<span class="op">*</span>Spectrum<span class="st">'*, an integer&nbsp;*threshold*, and an integer&nbsp;*max_score*.</span></span>
<span id="cb375-11280"><a href="#cb375-11280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11281"><a href="#cb375-11281" aria-hidden="true" tabindex="-1"></a><span class="er">Return:&nbsp;The size of the dictionary&nbsp;*Dictionary__threshold*</span>(<span class="op">*</span>Spectrum<span class="st">'*).</span></span>
<span id="cb375-11282"><a href="#cb375-11282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11283"><a href="#cb375-11283" aria-hidden="true" tabindex="-1"></a><span class="er">&gt; **Note:**&nbsp;Use the provided&nbsp;*max_score*&nbsp;for the height of your table. Your answer should be the number of peptides whose score is at least&nbsp;*threshold*&nbsp;and at most&nbsp;*max_score*.</span></span>
<span id="cb375-11284"><a href="#cb375-11284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11285"><a href="#cb375-11285" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb375-11286"><a href="#cb375-11286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11287"><a href="#cb375-11287" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-11288"><a href="#cb375-11288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11289"><a href="#cb375-11289" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11290"><a href="#cb375-11290" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="op">-</span><span class="dv">4</span> <span class="dv">5</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">1</span> <span class="op">-</span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">3</span></span>
<span id="cb375-11291"><a href="#cb375-11291" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb375-11292"><a href="#cb375-11292" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb375-11293"><a href="#cb375-11293" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11294"><a href="#cb375-11294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11295"><a href="#cb375-11295" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-11296"><a href="#cb375-11296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11297"><a href="#cb375-11297" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11298"><a href="#cb375-11298" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span></span>
<span id="cb375-11299"><a href="#cb375-11299" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11300"><a href="#cb375-11300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11301"><a href="#cb375-11301" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-11302"><a href="#cb375-11302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11303"><a href="#cb375-11303" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-11304"><a href="#cb375-11304" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-11305"><a href="#cb375-11305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11306"><a href="#cb375-11306" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-11307"><a href="#cb375-11307" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-11308"><a href="#cb375-11308" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-11309"><a href="#cb375-11309" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-11310"><a href="#cb375-11310" aria-hidden="true" tabindex="-1"></a>mass_values: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">list</span>(amino_acid_masses.values())</span>
<span id="cb375-11311"><a href="#cb375-11311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11312"><a href="#cb375-11312" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectral_dictionary_size(spectral_vector: List[<span class="bu">int</span>], threshold: <span class="bu">int</span>, max_score: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb375-11313"><a href="#cb375-11313" aria-hidden="true" tabindex="-1"></a>    vector_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(spectral_vector)</span>
<span id="cb375-11314"><a href="#cb375-11314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11315"><a href="#cb375-11315" aria-hidden="true" tabindex="-1"></a>    size_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> {<span class="dv">0</span>: {<span class="dv">0</span>: <span class="dv">1</span>}}</span>
<span id="cb375-11316"><a href="#cb375-11316" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11317"><a href="#cb375-11317" aria-hidden="true" tabindex="-1"></a>        size_matrix[<span class="dv">0</span>][t] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-11318"><a href="#cb375-11318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11319"><a href="#cb375-11319" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vector_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11320"><a href="#cb375-11320" aria-hidden="true" tabindex="-1"></a>        size_matrix[i] <span class="op">=</span> {}</span>
<span id="cb375-11321"><a href="#cb375-11321" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11322"><a href="#cb375-11322" aria-hidden="true" tabindex="-1"></a>            size_matrix[i][t] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-11323"><a href="#cb375-11323" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mass <span class="kw">in</span> mass_values:</span>
<span id="cb375-11324"><a href="#cb375-11324" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (i <span class="op">-</span> mass) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&lt;=</span> max_score:</span>
<span id="cb375-11325"><a href="#cb375-11325" aria-hidden="true" tabindex="-1"></a>                    size_matrix[i][t] <span class="op">+=</span> size_matrix[i <span class="op">-</span> mass][t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb375-11326"><a href="#cb375-11326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11327"><a href="#cb375-11327" aria-hidden="true" tabindex="-1"></a>    final_size: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(size_matrix[vector_length][t] <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(threshold, max_score <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb375-11328"><a href="#cb375-11328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11329"><a href="#cb375-11329" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> final_size</span>
<span id="cb375-11330"><a href="#cb375-11330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11331"><a href="#cb375-11331" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-11332"><a href="#cb375-11332" aria-hidden="true" tabindex="-1"></a><span class="st">4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3</span></span>
<span id="cb375-11333"><a href="#cb375-11333" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb375-11334"><a href="#cb375-11334" aria-hidden="true" tabindex="-1"></a><span class="st">8</span></span>
<span id="cb375-11335"><a href="#cb375-11335" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-11336"><a href="#cb375-11336" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-11337"><a href="#cb375-11337" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">0</span>].strip().split()]</span>
<span id="cb375-11338"><a href="#cb375-11338" aria-hidden="true" tabindex="-1"></a>threshold: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb375-11339"><a href="#cb375-11339" aria-hidden="true" tabindex="-1"></a>max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb375-11340"><a href="#cb375-11340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11341"><a href="#cb375-11341" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_spectral_dictionary_size(spectral_vector, threshold, max_score))</span>
<span id="cb375-11342"><a href="#cb375-11342" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11343"><a href="#cb375-11343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11344"><a href="#cb375-11344" aria-hidden="true" tabindex="-1"></a><span class="co"># Compute the Probability of a Spectral Dictionary</span></span>
<span id="cb375-11345"><a href="#cb375-11345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11346"><a href="#cb375-11346" aria-hidden="true" tabindex="-1"></a>Probability of Spectral Dictionary Problem. Find the probability of the spectral dictionary <span class="cf">for</span> a given spectrum <span class="kw">and</span> score threshold.</span>
<span id="cb375-11347"><a href="#cb375-11347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11348"><a href="#cb375-11348" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A spectral vector&nbsp;<span class="op">*</span>Spectrum<span class="st">'*, an integer&nbsp;*threshold*, and an integer&nbsp;*max_score*.</span></span>
<span id="cb375-11349"><a href="#cb375-11349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11350"><a href="#cb375-11350" aria-hidden="true" tabindex="-1"></a><span class="er">Return:&nbsp;The probability of the dictionary&nbsp;*Dictionary__threshold*</span>(<span class="op">*</span>Spectrum<span class="st">'*).</span></span>
<span id="cb375-11351"><a href="#cb375-11351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11352"><a href="#cb375-11352" aria-hidden="true" tabindex="-1"></a><span class="er">&gt; **Note:**&nbsp;Use the provided&nbsp;*max_score*&nbsp;for the height of your table.</span></span>
<span id="cb375-11353"><a href="#cb375-11353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11354"><a href="#cb375-11354" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;</span> <span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb375-11355"><a href="#cb375-11355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11356"><a href="#cb375-11356" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-11357"><a href="#cb375-11357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11358"><a href="#cb375-11358" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11359"><a href="#cb375-11359" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="op">-</span><span class="dv">4</span> <span class="dv">5</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">1</span> <span class="op">-</span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">3</span></span>
<span id="cb375-11360"><a href="#cb375-11360" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span>
<span id="cb375-11361"><a href="#cb375-11361" aria-hidden="true" tabindex="-1"></a><span class="dv">8</span></span>
<span id="cb375-11362"><a href="#cb375-11362" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11363"><a href="#cb375-11363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11364"><a href="#cb375-11364" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-11365"><a href="#cb375-11365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11366"><a href="#cb375-11366" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11367"><a href="#cb375-11367" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span></span>
<span id="cb375-11368"><a href="#cb375-11368" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11369"><a href="#cb375-11369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11370"><a href="#cb375-11370" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-11371"><a href="#cb375-11371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11372"><a href="#cb375-11372" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-11373"><a href="#cb375-11373" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-11374"><a href="#cb375-11374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11375"><a href="#cb375-11375" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-11376"><a href="#cb375-11376" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-11377"><a href="#cb375-11377" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb375-11378"><a href="#cb375-11378" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-11379"><a href="#cb375-11379" aria-hidden="true" tabindex="-1"></a>mass_values: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">list</span>(amino_acid_masses.values())</span>
<span id="cb375-11380"><a href="#cb375-11380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11381"><a href="#cb375-11381" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectral_dictionary_probability(spectral_vector: List[<span class="bu">int</span>], threshold: <span class="bu">int</span>, max_score: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb375-11382"><a href="#cb375-11382" aria-hidden="true" tabindex="-1"></a>    vector_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(spectral_vector)</span>
<span id="cb375-11383"><a href="#cb375-11383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11384"><a href="#cb375-11384" aria-hidden="true" tabindex="-1"></a>    probability_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">float</span>]] <span class="op">=</span> {<span class="dv">0</span>: {<span class="dv">0</span>: <span class="fl">1.0</span>}}</span>
<span id="cb375-11385"><a href="#cb375-11385" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11386"><a href="#cb375-11386" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>][t] <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb375-11387"><a href="#cb375-11387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11388"><a href="#cb375-11388" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vector_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11389"><a href="#cb375-11389" aria-hidden="true" tabindex="-1"></a>        probability_matrix[i] <span class="op">=</span> {}</span>
<span id="cb375-11390"><a href="#cb375-11390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11391"><a href="#cb375-11391" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i][t] <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb375-11392"><a href="#cb375-11392" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mass <span class="kw">in</span> mass_values:</span>
<span id="cb375-11393"><a href="#cb375-11393" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (i <span class="op">-</span> mass) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&lt;=</span> max_score:</span>
<span id="cb375-11394"><a href="#cb375-11394" aria-hidden="true" tabindex="-1"></a>                    probability_matrix[i][t] <span class="op">+=</span> probability_matrix[i <span class="op">-</span> mass][t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb375-11395"><a href="#cb375-11395" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i][t] <span class="op">/=</span> <span class="dv">20</span></span>
<span id="cb375-11396"><a href="#cb375-11396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11397"><a href="#cb375-11397" aria-hidden="true" tabindex="-1"></a>    final_probability: <span class="bu">float</span> <span class="op">=</span> <span class="bu">sum</span>(probability_matrix[vector_length][t] <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(threshold, max_score <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb375-11398"><a href="#cb375-11398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11399"><a href="#cb375-11399" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> final_probability</span>
<span id="cb375-11400"><a href="#cb375-11400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11401"><a href="#cb375-11401" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-11402"><a href="#cb375-11402" aria-hidden="true" tabindex="-1"></a><span class="st">4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3</span></span>
<span id="cb375-11403"><a href="#cb375-11403" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb375-11404"><a href="#cb375-11404" aria-hidden="true" tabindex="-1"></a><span class="st">8</span></span>
<span id="cb375-11405"><a href="#cb375-11405" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-11406"><a href="#cb375-11406" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-11407"><a href="#cb375-11407" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">0</span>].strip().split()]</span>
<span id="cb375-11408"><a href="#cb375-11408" aria-hidden="true" tabindex="-1"></a>threshold: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb375-11409"><a href="#cb375-11409" aria-hidden="true" tabindex="-1"></a>max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb375-11410"><a href="#cb375-11410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11411"><a href="#cb375-11411" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_spectral_dictionary_probability(spectral_vector, threshold, max_score))</span>
<span id="cb375-11412"><a href="#cb375-11412" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11413"><a href="#cb375-11413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11414"><a href="#cb375-11414" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a Highest-Scoring Modified Peptide against a Spectrum</span></span>
<span id="cb375-11415"><a href="#cb375-11415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11416"><a href="#cb375-11416" aria-hidden="true" tabindex="-1"></a>Spectral Alignment Problem. Given a peptide <span class="kw">and</span> a spectral vector, find a modified variant of this peptide that maximizes the peptide<span class="op">-</span>spectrum score among <span class="bu">all</span> variants of the peptides <span class="cf">with</span> up to k modifications.</span>
<span id="cb375-11417"><a href="#cb375-11417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11418"><a href="#cb375-11418" aria-hidden="true" tabindex="-1"></a>Given:&nbsp;A peptide&nbsp;<span class="op">*</span>Peptide<span class="op">*</span>, a spectral vector&nbsp;<span class="op">*</span>Spectrum<span class="st">'*, and an integer&nbsp;*k*.</span></span>
<span id="cb375-11419"><a href="#cb375-11419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11420"><a href="#cb375-11420" aria-hidden="true" tabindex="-1"></a><span class="er">Return:&nbsp;A peptide&nbsp;*Peptide'*&nbsp;related to&nbsp;*Peptide*&nbsp;by up to&nbsp;*k*&nbsp;modifications with maximal score against&nbsp;*Spectrum'*&nbsp;out of all possibilities.</span></span>
<span id="cb375-11421"><a href="#cb375-11421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11422"><a href="#cb375-11422" aria-hidden="true" tabindex="-1"></a><span class="op">**</span>Note:<span class="op">**</span>&nbsp;In this chapter, <span class="bu">all</span> dataset problems implicitly use the standard integer<span class="op">-</span>valued mass table <span class="cf">for</span> the regular twenty amino acids. Examples sometimes use imaginary amino acids X <span class="kw">and</span> Z having respective integer masses <span class="dv">4</span> <span class="kw">and</span> <span class="fl">5.</span></span>
<span id="cb375-11423"><a href="#cb375-11423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11424"><a href="#cb375-11424" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Dataset</span></span>
<span id="cb375-11425"><a href="#cb375-11425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11426"><a href="#cb375-11426" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11427"><a href="#cb375-11427" aria-hidden="true" tabindex="-1"></a>XXZ</span>
<span id="cb375-11428"><a href="#cb375-11428" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="op">-</span><span class="dv">4</span> <span class="dv">5</span> <span class="op">-</span><span class="dv">3</span> <span class="op">-</span><span class="dv">1</span> <span class="op">-</span><span class="dv">1</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">1</span> <span class="dv">3</span></span>
<span id="cb375-11429"><a href="#cb375-11429" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span>
<span id="cb375-11430"><a href="#cb375-11430" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11431"><a href="#cb375-11431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11432"><a href="#cb375-11432" aria-hidden="true" tabindex="-1"></a><span class="co">## Sample Output</span></span>
<span id="cb375-11433"><a href="#cb375-11433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11434"><a href="#cb375-11434" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11435"><a href="#cb375-11435" aria-hidden="true" tabindex="-1"></a>XX(<span class="op">-</span><span class="dv">1</span>)Z(<span class="op">+</span><span class="dv">2</span>)</span>
<span id="cb375-11436"><a href="#cb375-11436" aria-hidden="true" tabindex="-1"></a>```</span>
<span id="cb375-11437"><a href="#cb375-11437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11438"><a href="#cb375-11438" aria-hidden="true" tabindex="-1"></a><span class="co">## Solution</span></span>
<span id="cb375-11439"><a href="#cb375-11439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11440"><a href="#cb375-11440" aria-hidden="true" tabindex="-1"></a>```python</span>
<span id="cb375-11441"><a href="#cb375-11441" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb375-11442"><a href="#cb375-11442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11443"><a href="#cb375-11443" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb375-11444"><a href="#cb375-11444" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb375-11445"><a href="#cb375-11445" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>,</span>
<span id="cb375-11446"><a href="#cb375-11446" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span>  <span class="co"># Added 'X' and 'Z' with arbitrary masses</span></span>
<span id="cb375-11447"><a href="#cb375-11447" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb375-11448"><a href="#cb375-11448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11449"><a href="#cb375-11449" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_score_matrix(score_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">float</span>]]], prefix_masses: List[<span class="bu">int</span>], spectral_vector: List[<span class="bu">int</span>], max_k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb375-11450"><a href="#cb375-11450" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">2</span>, max_k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11451"><a href="#cb375-11451" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> t <span class="op">==</span> <span class="op">-</span><span class="dv">2</span>:</span>
<span id="cb375-11452"><a href="#cb375-11452" aria-hidden="true" tabindex="-1"></a>            formatted_vector <span class="op">=</span> [<span class="bu">str</span>(x).rjust(<span class="dv">3</span>) <span class="cf">for</span> x <span class="kw">in</span> spectral_vector]</span>
<span id="cb375-11453"><a href="#cb375-11453" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'   '</span>, <span class="op">*</span>formatted_vector)</span>
<span id="cb375-11454"><a href="#cb375-11454" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb375-11455"><a href="#cb375-11455" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb375-11456"><a href="#cb375-11456" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> t <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb375-11457"><a href="#cb375-11457" aria-hidden="true" tabindex="-1"></a>            header <span class="op">=</span> [<span class="bu">str</span>(i).rjust(<span class="dv">3</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector))]</span>
<span id="cb375-11458"><a href="#cb375-11458" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'   '</span>, <span class="op">*</span>header)</span>
<span id="cb375-11459"><a href="#cb375-11459" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-11460"><a href="#cb375-11460" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses:</span>
<span id="cb375-11461"><a href="#cb375-11461" aria-hidden="true" tabindex="-1"></a>                row <span class="op">=</span> []</span>
<span id="cb375-11462"><a href="#cb375-11462" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">1</span>, <span class="bu">len</span>(spectral_vector)):</span>
<span id="cb375-11463"><a href="#cb375-11463" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> j <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb375-11464"><a href="#cb375-11464" aria-hidden="true" tabindex="-1"></a>                        row.append(<span class="ss">f"</span><span class="sc">{</span>mass<span class="sc">:&gt;3}</span><span class="ss"> "</span>)</span>
<span id="cb375-11465"><a href="#cb375-11465" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb375-11466"><a href="#cb375-11466" aria-hidden="true" tabindex="-1"></a>                        score <span class="op">=</span> score_matrix[mass][j][t]</span>
<span id="cb375-11467"><a href="#cb375-11467" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> score <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1e5</span>:</span>
<span id="cb375-11468"><a href="#cb375-11468" aria-hidden="true" tabindex="-1"></a>                            score <span class="op">=</span> <span class="st">'XX'</span></span>
<span id="cb375-11469"><a href="#cb375-11469" aria-hidden="true" tabindex="-1"></a>                        row.append(<span class="ss">f"</span><span class="sc">{</span>score<span class="sc">:&gt;3}</span><span class="ss">"</span>)</span>
<span id="cb375-11470"><a href="#cb375-11470" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">' '</span>.join(row))</span>
<span id="cb375-11471"><a href="#cb375-11471" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb375-11472"><a href="#cb375-11472" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb375-11473"><a href="#cb375-11473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11474"><a href="#cb375-11474" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectral_alignment(peptide: <span class="bu">str</span>, spectral_vector: List[<span class="bu">int</span>], max_k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb375-11475"><a href="#cb375-11475" aria-hidden="true" tabindex="-1"></a>    spectral_vector.insert(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb375-11476"><a href="#cb375-11476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11477"><a href="#cb375-11477" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate prefix masses</span></span>
<span id="cb375-11478"><a href="#cb375-11478" aria-hidden="true" tabindex="-1"></a>    prefix_masses <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb375-11479"><a href="#cb375-11479" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb375-11480"><a href="#cb375-11480" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> peptide[:i <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb375-11481"><a href="#cb375-11481" aria-hidden="true" tabindex="-1"></a>        mass <span class="op">=</span> <span class="bu">sum</span>(amino_acid_masses[aa] <span class="cf">for</span> aa <span class="kw">in</span> prefix)</span>
<span id="cb375-11482"><a href="#cb375-11482" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(mass)</span>
<span id="cb375-11483"><a href="#cb375-11483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11484"><a href="#cb375-11484" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create diff array</span></span>
<span id="cb375-11485"><a href="#cb375-11485" aria-hidden="true" tabindex="-1"></a>    mass_differences <span class="op">=</span> {}</span>
<span id="cb375-11486"><a href="#cb375-11486" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(prefix_masses)):</span>
<span id="cb375-11487"><a href="#cb375-11487" aria-hidden="true" tabindex="-1"></a>        mass_differences[prefix_masses[i]] <span class="op">=</span> prefix_masses[i] <span class="op">-</span> prefix_masses[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb375-11488"><a href="#cb375-11488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11489"><a href="#cb375-11489" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize scores</span></span>
<span id="cb375-11490"><a href="#cb375-11490" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">float</span>]]] <span class="op">=</span> {}</span>
<span id="cb375-11491"><a href="#cb375-11491" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses:</span>
<span id="cb375-11492"><a href="#cb375-11492" aria-hidden="true" tabindex="-1"></a>        score_matrix[mass] <span class="op">=</span> {}</span>
<span id="cb375-11493"><a href="#cb375-11493" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb375-11494"><a href="#cb375-11494" aria-hidden="true" tabindex="-1"></a>            score_matrix[mass][j] <span class="op">=</span> {t: <span class="op">-</span><span class="bu">float</span>(<span class="st">"inf"</span>) <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_k <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb375-11495"><a href="#cb375-11495" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-11496"><a href="#cb375-11496" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11497"><a href="#cb375-11497" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate scores</span></span>
<span id="cb375-11498"><a href="#cb375-11498" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses[<span class="dv">1</span>:]:</span>
<span id="cb375-11499"><a href="#cb375-11499" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb375-11500"><a href="#cb375-11500" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11501"><a href="#cb375-11501" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (t <span class="op">==</span> <span class="dv">0</span>) <span class="kw">and</span> (mass <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (j <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>):</span>
<span id="cb375-11502"><a href="#cb375-11502" aria-hidden="true" tabindex="-1"></a>                    score_matrix[mass][j][t] <span class="op">=</span> spectral_vector[j] <span class="op">+</span> score_matrix[mass <span class="op">-</span> mass_differences[mass]][j <span class="op">-</span> mass_differences[mass]][t]</span>
<span id="cb375-11503"><a href="#cb375-11503" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> (t <span class="op">&gt;</span> <span class="dv">0</span>) <span class="kw">and</span> (mass <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (j <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>):</span>
<span id="cb375-11504"><a href="#cb375-11504" aria-hidden="true" tabindex="-1"></a>                    score_matrix[mass][j][t] <span class="op">=</span> spectral_vector[j] <span class="op">+</span> <span class="bu">max</span>(score_matrix[mass <span class="op">-</span> mass_differences[mass]][j <span class="op">-</span> mass_differences[mass]][t], </span>
<span id="cb375-11505"><a href="#cb375-11505" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="bu">max</span>(score_matrix[mass <span class="op">-</span> mass_differences[mass]][j_star][t <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> j_star <span class="kw">in</span> <span class="bu">range</span>(j)))</span>
<span id="cb375-11506"><a href="#cb375-11506" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> (t <span class="op">&gt;</span> <span class="dv">0</span>) <span class="kw">and</span> (mass <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (j <span class="op">&gt;</span> <span class="dv">0</span>):</span>
<span id="cb375-11507"><a href="#cb375-11507" aria-hidden="true" tabindex="-1"></a>                    score_matrix[mass][j][t] <span class="op">=</span> spectral_vector[j] <span class="op">+</span> <span class="bu">max</span>(score_matrix[mass <span class="op">-</span> mass_differences[mass]][j_star][t <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> j_star <span class="kw">in</span> <span class="bu">range</span>(j))</span>
<span id="cb375-11508"><a href="#cb375-11508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11509"><a href="#cb375-11509" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find max score layer</span></span>
<span id="cb375-11510"><a href="#cb375-11510" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="op">-</span><span class="bu">float</span>(<span class="st">"inf"</span>)</span>
<span id="cb375-11511"><a href="#cb375-11511" aria-hidden="true" tabindex="-1"></a>    max_layer <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb375-11512"><a href="#cb375-11512" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb375-11513"><a href="#cb375-11513" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> score_matrix[prefix_masses[<span class="op">-</span><span class="dv">1</span>]][<span class="bu">len</span>(spectral_vector) <span class="op">-</span> <span class="dv">1</span>][t]</span>
<span id="cb375-11514"><a href="#cb375-11514" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;</span> max_score:</span>
<span id="cb375-11515"><a href="#cb375-11515" aria-hidden="true" tabindex="-1"></a>            max_score <span class="op">=</span> current_score</span>
<span id="cb375-11516"><a href="#cb375-11516" aria-hidden="true" tabindex="-1"></a>            max_layer <span class="op">=</span> t</span>
<span id="cb375-11517"><a href="#cb375-11517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11518"><a href="#cb375-11518" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Backtrace</span></span>
<span id="cb375-11519"><a href="#cb375-11519" aria-hidden="true" tabindex="-1"></a>    layer <span class="op">=</span> max_layer</span>
<span id="cb375-11520"><a href="#cb375-11520" aria-hidden="true" tabindex="-1"></a>    column_index <span class="op">=</span> <span class="bu">len</span>(spectral_vector) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb375-11521"><a href="#cb375-11521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11522"><a href="#cb375-11522" aria-hidden="true" tabindex="-1"></a>    result_peptide <span class="op">=</span> <span class="st">''</span></span>
<span id="cb375-11523"><a href="#cb375-11523" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide), <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb375-11524"><a href="#cb375-11524" aria-hidden="true" tabindex="-1"></a>        pre_mass <span class="op">=</span> prefix_masses[i]</span>
<span id="cb375-11525"><a href="#cb375-11525" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (column_index <span class="op">-</span> mass_differences[pre_mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (</span>
<span id="cb375-11526"><a href="#cb375-11526" aria-hidden="true" tabindex="-1"></a>                score_matrix[pre_mass][column_index][layer] <span class="op">==</span> spectral_vector[column_index] <span class="op">+</span> score_matrix[pre_mass <span class="op">-</span> mass_differences[pre_mass]][column_index <span class="op">-</span> mass_differences[pre_mass]][layer]):</span>
<span id="cb375-11527"><a href="#cb375-11527" aria-hidden="true" tabindex="-1"></a>            column_index <span class="op">-=</span> mass_differences[pre_mass]</span>
<span id="cb375-11528"><a href="#cb375-11528" aria-hidden="true" tabindex="-1"></a>            result_peptide <span class="op">=</span> peptide[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> result_peptide</span>
<span id="cb375-11529"><a href="#cb375-11529" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb375-11530"><a href="#cb375-11530" aria-hidden="true" tabindex="-1"></a>            temp_scores <span class="op">=</span> [score_matrix[pre_mass <span class="op">-</span> mass_differences[pre_mass]][j_star][layer <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> j_star <span class="kw">in</span> <span class="bu">range</span>(column_index)]</span>
<span id="cb375-11531"><a href="#cb375-11531" aria-hidden="true" tabindex="-1"></a>            idx_max_score <span class="op">=</span> temp_scores.index(<span class="bu">max</span>(temp_scores))</span>
<span id="cb375-11532"><a href="#cb375-11532" aria-hidden="true" tabindex="-1"></a>            modification_amount <span class="op">=</span> column_index <span class="op">-</span> idx_max_score <span class="op">-</span> mass_differences[pre_mass]</span>
<span id="cb375-11533"><a href="#cb375-11533" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> modification_amount <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb375-11534"><a href="#cb375-11534" aria-hidden="true" tabindex="-1"></a>                result_peptide <span class="op">=</span> peptide[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="st">'(+'</span> <span class="op">+</span> <span class="bu">str</span>(modification_amount) <span class="op">+</span> <span class="st">')'</span> <span class="op">+</span> result_peptide</span>
<span id="cb375-11535"><a href="#cb375-11535" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb375-11536"><a href="#cb375-11536" aria-hidden="true" tabindex="-1"></a>                result_peptide <span class="op">=</span> peptide[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="st">'('</span> <span class="op">+</span> <span class="bu">str</span>(modification_amount) <span class="op">+</span> <span class="st">')'</span> <span class="op">+</span> result_peptide</span>
<span id="cb375-11537"><a href="#cb375-11537" aria-hidden="true" tabindex="-1"></a>            column_index <span class="op">=</span> idx_max_score</span>
<span id="cb375-11538"><a href="#cb375-11538" aria-hidden="true" tabindex="-1"></a>            layer <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb375-11539"><a href="#cb375-11539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11540"><a href="#cb375-11540" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result_peptide</span>
<span id="cb375-11541"><a href="#cb375-11541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11542"><a href="#cb375-11542" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb375-11543"><a href="#cb375-11543" aria-hidden="true" tabindex="-1"></a><span class="st">XXZ</span></span>
<span id="cb375-11544"><a href="#cb375-11544" aria-hidden="true" tabindex="-1"></a><span class="st">4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3</span></span>
<span id="cb375-11545"><a href="#cb375-11545" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb375-11546"><a href="#cb375-11546" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb375-11547"><a href="#cb375-11547" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb375-11548"><a href="#cb375-11548" aria-hidden="true" tabindex="-1"></a>peptide_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb375-11549"><a href="#cb375-11549" aria-hidden="true" tabindex="-1"></a>spectral_vector_values: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].strip().split()]</span>
<span id="cb375-11550"><a href="#cb375-11550" aria-hidden="true" tabindex="-1"></a>max_k_value: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb375-11551"><a href="#cb375-11551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb375-11552"><a href="#cb375-11552" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spectral_alignment(peptide_sequence, spectral_vector_values, max_k_value))</span>
<span id="cb375-11553"><a href="#cb375-11553" aria-hidden="true" tabindex="-1"></a>```</span></code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Proudly served by <a href="https://pages.github.com/">github pages</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This blog is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>