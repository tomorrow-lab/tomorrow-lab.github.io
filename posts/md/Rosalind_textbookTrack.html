<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.33">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Taeyoon Kim">
<meta name="dcterms.date" content="2024-09-28">

<title>Rosalind Textbook track 문제풀이 – tomorrow-lab</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../.././static/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-6de03c230f317df06710ae72f811cd41.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-968f167028037f77ea7374a8a9b321e2.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-6de03c230f317df06710ae72f811cd41.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-406820b4c2a393f327d85a420d57510d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-780e9400721330a0ce32a7ca13ebdec7.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/bootstrap/bootstrap-406820b4c2a393f327d85a420d57510d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-31EWCYNR0V"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-31EWCYNR0V', { 'anonymize_ip': true});
</script>
<style>html{ scroll-behavior: smooth; }</style>
<meta name="google-site-verification" content="z2S1Xqj9hfJiC31aNGCnOA1gYpL_8MoZpPI2avrWMvg">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Rosalind Textbook track 문제풀이 – tomorrow-lab">
<meta property="og:description" content="The future of scientific discovery lies at the convergence of computational power and biological complexity. Our mission is to provide a platform where enthusiasts, researchers, and professionals can learn about and contribute to the rapidly evolving fields of bioinformatics, computational biology, and systems biology.">
<meta property="og:image" content="https://tomorrow-lab.github.io/posts/md/Rosalind_textbookTrack.png">
<meta property="og:site_name" content="tomorrow-lab">
<meta property="og:image:height" content="320">
<meta property="og:image:width" content="640">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../.././static/logo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">tomorrow-lab</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://partrita.github.io"> <i class="bi bi-exclamation-triangle" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/partrita"> <i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar"><div class="quarto-margin-header"><div class="margin-header-item">
<div style="margin-top: 30px; margin-bottom: 20px;">
    <a href="https://substack.com/@tomorrowlab">
        <img alt="Static Badge" src="https://img.shields.io/badge/EHOTTL%40substack_-FF6719?link=https%3A%2F%2Fsubstack.com%2F%40tomorrowlab">
    </a>
    <a href="https://pixi.sh">
        <img src="https://img.shields.io/endpoint?url=https://raw.githubusercontent.com/prefix-dev/pixi/main/assets/badge/v0.json" alt="Pixi Badge">
    </a>
    <!-- <script async src="https://eocampaign1.com/form/2616a818-1ef8-11ef-b372-4587d096212f.js" data-form="2616a818-1ef8-11ef-b372-4587d096212f"></script> -->
</div>

</div></div>
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#compute-the-number-of-times-a-pattern-appears-in-a-text" id="toc-compute-the-number-of-times-a-pattern-appears-in-a-text" class="nav-link active" data-scroll-target="#compute-the-number-of-times-a-pattern-appears-in-a-text"><span class="header-section-number">0.1</span> Compute the Number of Times a Pattern Appears in a Text</a></li>
  <li><a href="#sample-dataset" id="toc-sample-dataset" class="nav-link" data-scroll-target="#sample-dataset"><span class="header-section-number">0.2</span> Sample Dataset</a></li>
  <li><a href="#sample-output" id="toc-sample-output" class="nav-link" data-scroll-target="#sample-output"><span class="header-section-number">0.3</span> Sample Output</a></li>
  <li><a href="#solution" id="toc-solution" class="nav-link" data-scroll-target="#solution"><span class="header-section-number">0.4</span> Solution</a></li>
  <li><a href="#find-the-most-frequent-words-in-a-string" id="toc-find-the-most-frequent-words-in-a-string" class="nav-link" data-scroll-target="#find-the-most-frequent-words-in-a-string"><span class="header-section-number">1</span> Find the Most Frequent Words in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-1" id="toc-sample-dataset-1" class="nav-link" data-scroll-target="#sample-dataset-1"><span class="header-section-number">1.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-1" id="toc-sample-output-1" class="nav-link" data-scroll-target="#sample-output-1"><span class="header-section-number">1.2</span> Sample Output</a></li>
  <li><a href="#solution-1" id="toc-solution-1" class="nav-link" data-scroll-target="#solution-1"><span class="header-section-number">1.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-reverse-complement-of-a-string" id="toc-find-the-reverse-complement-of-a-string" class="nav-link" data-scroll-target="#find-the-reverse-complement-of-a-string"><span class="header-section-number">2</span> Find the Reverse Complement of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-2" id="toc-sample-dataset-2" class="nav-link" data-scroll-target="#sample-dataset-2"><span class="header-section-number">2.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-2" id="toc-sample-output-2" class="nav-link" data-scroll-target="#sample-output-2"><span class="header-section-number">2.2</span> Sample Output</a></li>
  <li><a href="#solution-2" id="toc-solution-2" class="nav-link" data-scroll-target="#solution-2"><span class="header-section-number">2.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-occurrences-of-a-pattern-in-a-string" id="toc-find-all-occurrences-of-a-pattern-in-a-string" class="nav-link" data-scroll-target="#find-all-occurrences-of-a-pattern-in-a-string"><span class="header-section-number">3</span> Find All Occurrences of a Pattern in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-3" id="toc-sample-dataset-3" class="nav-link" data-scroll-target="#sample-dataset-3"><span class="header-section-number">3.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-3" id="toc-sample-output-3" class="nav-link" data-scroll-target="#sample-output-3"><span class="header-section-number">3.2</span> Sample Output</a></li>
  <li><a href="#solution-3" id="toc-solution-3" class="nav-link" data-scroll-target="#solution-3"><span class="header-section-number">3.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-patterns-forming-clumps-in-a-string" id="toc-find-patterns-forming-clumps-in-a-string" class="nav-link" data-scroll-target="#find-patterns-forming-clumps-in-a-string"><span class="header-section-number">4</span> Find Patterns Forming Clumps in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-4" id="toc-sample-dataset-4" class="nav-link" data-scroll-target="#sample-dataset-4"><span class="header-section-number">4.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-4" id="toc-sample-output-4" class="nav-link" data-scroll-target="#sample-output-4"><span class="header-section-number">4.2</span> Sample Output</a></li>
  <li><a href="#solution-4" id="toc-solution-4" class="nav-link" data-scroll-target="#solution-4"><span class="header-section-number">4.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-position-in-a-genome-minimizing-the-skew" id="toc-find-a-position-in-a-genome-minimizing-the-skew" class="nav-link" data-scroll-target="#find-a-position-in-a-genome-minimizing-the-skew"><span class="header-section-number">5</span> Find a Position in a Genome Minimizing the Skew</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-5" id="toc-sample-dataset-5" class="nav-link" data-scroll-target="#sample-dataset-5"><span class="header-section-number">5.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-5" id="toc-sample-output-5" class="nav-link" data-scroll-target="#sample-output-5"><span class="header-section-number">5.2</span> Sample Output</a></li>
  <li><a href="#solution-5" id="toc-solution-5" class="nav-link" data-scroll-target="#solution-5"><span class="header-section-number">5.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-hamming-distance-between-two-strings" id="toc-compute-the-hamming-distance-between-two-strings" class="nav-link" data-scroll-target="#compute-the-hamming-distance-between-two-strings"><span class="header-section-number">6</span> Compute the Hamming Distance Between Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-6" id="toc-sample-dataset-6" class="nav-link" data-scroll-target="#sample-dataset-6"><span class="header-section-number">6.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-6" id="toc-sample-output-6" class="nav-link" data-scroll-target="#sample-output-6"><span class="header-section-number">6.2</span> Sample Output</a></li>
  <li><a href="#solution-6" id="toc-solution-6" class="nav-link" data-scroll-target="#solution-6"><span class="header-section-number">6.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-approximate-occurrences-of-a-pattern-in-a-string" id="toc-find-all-approximate-occurrences-of-a-pattern-in-a-string" class="nav-link" data-scroll-target="#find-all-approximate-occurrences-of-a-pattern-in-a-string"><span class="header-section-number">7</span> Find All Approximate Occurrences of a Pattern in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-7" id="toc-sample-dataset-7" class="nav-link" data-scroll-target="#sample-dataset-7"><span class="header-section-number">7.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-7" id="toc-sample-output-7" class="nav-link" data-scroll-target="#sample-output-7"><span class="header-section-number">7.2</span> Sample Output</a></li>
  <li><a href="#solution-7" id="toc-solution-7" class="nav-link" data-scroll-target="#solution-7"><span class="header-section-number">7.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-most-frequent-words-with-mismatches-in-a-string" id="toc-find-the-most-frequent-words-with-mismatches-in-a-string" class="nav-link" data-scroll-target="#find-the-most-frequent-words-with-mismatches-in-a-string"><span class="header-section-number">8</span> Find the Most Frequent Words with Mismatches in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-8" id="toc-sample-dataset-8" class="nav-link" data-scroll-target="#sample-dataset-8"><span class="header-section-number">8.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-8" id="toc-sample-output-8" class="nav-link" data-scroll-target="#sample-output-8"><span class="header-section-number">8.2</span> Sample Output</a></li>
  <li><a href="#solution-8" id="toc-solution-8" class="nav-link" data-scroll-target="#solution-8"><span class="header-section-number">8.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-frequent-words-with-mismatches-and-reverse-complements" id="toc-find-frequent-words-with-mismatches-and-reverse-complements" class="nav-link" data-scroll-target="#find-frequent-words-with-mismatches-and-reverse-complements"><span class="header-section-number">9</span> Find Frequent Words with Mismatches and Reverse Complements</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-9" id="toc-sample-dataset-9" class="nav-link" data-scroll-target="#sample-dataset-9"><span class="header-section-number">9.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-9" id="toc-sample-output-9" class="nav-link" data-scroll-target="#sample-output-9"><span class="header-section-number">9.2</span> Sample Output</a></li>
  <li><a href="#solution-9" id="toc-solution-9" class="nav-link" data-scroll-target="#solution-9"><span class="header-section-number">9.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-frequency-array-of-a-string" id="toc-generate-the-frequency-array-of-a-string" class="nav-link" data-scroll-target="#generate-the-frequency-array-of-a-string"><span class="header-section-number">10</span> Generate the Frequency Array of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-10" id="toc-sample-dataset-10" class="nav-link" data-scroll-target="#sample-dataset-10"><span class="header-section-number">10.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-10" id="toc-sample-output-10" class="nav-link" data-scroll-target="#sample-output-10"><span class="header-section-number">10.2</span> Sample Output</a></li>
  <li><a href="#solution-10" id="toc-solution-10" class="nav-link" data-scroll-target="#solution-10"><span class="header-section-number">10.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-patterntonumber" id="toc-implement-patterntonumber" class="nav-link" data-scroll-target="#implement-patterntonumber"><span class="header-section-number">11</span> Implement PatternToNumber</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-11" id="toc-sample-dataset-11" class="nav-link" data-scroll-target="#sample-dataset-11"><span class="header-section-number">11.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-11" id="toc-sample-output-11" class="nav-link" data-scroll-target="#sample-output-11"><span class="header-section-number">11.2</span> Sample Output</a></li>
  <li><a href="#solution-11" id="toc-solution-11" class="nav-link" data-scroll-target="#solution-11"><span class="header-section-number">11.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-numbertopattern" id="toc-implement-numbertopattern" class="nav-link" data-scroll-target="#implement-numbertopattern"><span class="header-section-number">12</span> Implement NumberToPattern</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-12" id="toc-sample-dataset-12" class="nav-link" data-scroll-target="#sample-dataset-12"><span class="header-section-number">12.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-12" id="toc-sample-output-12" class="nav-link" data-scroll-target="#sample-output-12"><span class="header-section-number">12.2</span> Sample Output</a></li>
  <li><a href="#solution-12" id="toc-solution-12" class="nav-link" data-scroll-target="#solution-12"><span class="header-section-number">12.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-d-neighborhood-of-a-string" id="toc-generate-the-d-neighborhood-of-a-string" class="nav-link" data-scroll-target="#generate-the-d-neighborhood-of-a-string"><span class="header-section-number">13</span> Generate the d-Neighborhood of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-13" id="toc-sample-dataset-13" class="nav-link" data-scroll-target="#sample-dataset-13"><span class="header-section-number">13.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-13" id="toc-sample-output-13" class="nav-link" data-scroll-target="#sample-output-13"><span class="header-section-number">13.2</span> Sample Output</a></li>
  <li><a href="#solution-13" id="toc-solution-13" class="nav-link" data-scroll-target="#solution-13"><span class="header-section-number">13.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-motifenumeration" id="toc-implement-motifenumeration" class="nav-link" data-scroll-target="#implement-motifenumeration"><span class="header-section-number">14</span> Implement MotifEnumeration</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-14" id="toc-sample-dataset-14" class="nav-link" data-scroll-target="#sample-dataset-14"><span class="header-section-number">14.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-14" id="toc-sample-output-14" class="nav-link" data-scroll-target="#sample-output-14"><span class="header-section-number">14.2</span> Sample Output</a></li>
  <li><a href="#solution-14" id="toc-solution-14" class="nav-link" data-scroll-target="#solution-14"><span class="header-section-number">14.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-median-string" id="toc-find-a-median-string" class="nav-link" data-scroll-target="#find-a-median-string"><span class="header-section-number">15</span> Find a Median String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-15" id="toc-sample-dataset-15" class="nav-link" data-scroll-target="#sample-dataset-15"><span class="header-section-number">15.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-15" id="toc-sample-output-15" class="nav-link" data-scroll-target="#sample-output-15"><span class="header-section-number">15.2</span> Sample Output</a></li>
  <li><a href="#solution-15" id="toc-solution-15" class="nav-link" data-scroll-target="#solution-15"><span class="header-section-number">15.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-profile-most-probable-k-mer-in-a-string" id="toc-find-a-profile-most-probable-k-mer-in-a-string" class="nav-link" data-scroll-target="#find-a-profile-most-probable-k-mer-in-a-string"><span class="header-section-number">16</span> Find a Profile-most Probable k-mer in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-16" id="toc-sample-dataset-16" class="nav-link" data-scroll-target="#sample-dataset-16"><span class="header-section-number">16.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-16" id="toc-sample-output-16" class="nav-link" data-scroll-target="#sample-output-16"><span class="header-section-number">16.2</span> Sample Output</a></li>
  <li><a href="#solution-16" id="toc-solution-16" class="nav-link" data-scroll-target="#solution-16"><span class="header-section-number">16.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedymotifsearch" id="toc-implement-greedymotifsearch" class="nav-link" data-scroll-target="#implement-greedymotifsearch"><span class="header-section-number">17</span> Implement GreedyMotifSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-17" id="toc-sample-dataset-17" class="nav-link" data-scroll-target="#sample-dataset-17"><span class="header-section-number">17.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-17" id="toc-sample-output-17" class="nav-link" data-scroll-target="#sample-output-17"><span class="header-section-number">17.2</span> Sample Output</a></li>
  <li><a href="#solution-17" id="toc-solution-17" class="nav-link" data-scroll-target="#solution-17"><span class="header-section-number">17.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedymotifsearch-with-pseudocounts" id="toc-implement-greedymotifsearch-with-pseudocounts" class="nav-link" data-scroll-target="#implement-greedymotifsearch-with-pseudocounts"><span class="header-section-number">18</span> Implement GreedyMotifSearch with Pseudocounts</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-18" id="toc-sample-dataset-18" class="nav-link" data-scroll-target="#sample-dataset-18"><span class="header-section-number">18.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-18" id="toc-sample-output-18" class="nav-link" data-scroll-target="#sample-output-18"><span class="header-section-number">18.2</span> Sample Output</a></li>
  <li><a href="#solution-18" id="toc-solution-18" class="nav-link" data-scroll-target="#solution-18"><span class="header-section-number">18.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-randomizedmotifsearch" id="toc-implement-randomizedmotifsearch" class="nav-link" data-scroll-target="#implement-randomizedmotifsearch"><span class="header-section-number">19</span> Implement RandomizedMotifSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-19" id="toc-sample-dataset-19" class="nav-link" data-scroll-target="#sample-dataset-19"><span class="header-section-number">19.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-19" id="toc-sample-output-19" class="nav-link" data-scroll-target="#sample-output-19"><span class="header-section-number">19.2</span> Sample Output</a></li>
  <li><a href="#solution-19" id="toc-solution-19" class="nav-link" data-scroll-target="#solution-19"><span class="header-section-number">19.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-gibbssampler" id="toc-implement-gibbssampler" class="nav-link" data-scroll-target="#implement-gibbssampler"><span class="header-section-number">20</span> Implement GibbsSampler</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-20" id="toc-sample-dataset-20" class="nav-link" data-scroll-target="#sample-dataset-20"><span class="header-section-number">20.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-20" id="toc-sample-output-20" class="nav-link" data-scroll-target="#sample-output-20"><span class="header-section-number">20.2</span> Sample Output</a></li>
  <li><a href="#solution-20" id="toc-solution-20" class="nav-link" data-scroll-target="#solution-20"><span class="header-section-number">20.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-distancebetweenpatternandstrings" id="toc-implement-distancebetweenpatternandstrings" class="nav-link" data-scroll-target="#implement-distancebetweenpatternandstrings"><span class="header-section-number">21</span> Implement DistanceBetweenPatternAndStrings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-21" id="toc-sample-dataset-21" class="nav-link" data-scroll-target="#sample-dataset-21"><span class="header-section-number">21.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-21" id="toc-sample-output-21" class="nav-link" data-scroll-target="#sample-output-21"><span class="header-section-number">21.2</span> Sample Output</a></li>
  <li><a href="#solution-21" id="toc-solution-21" class="nav-link" data-scroll-target="#solution-21"><span class="header-section-number">21.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-k-mer-composition-of-a-string" id="toc-generate-the-k-mer-composition-of-a-string" class="nav-link" data-scroll-target="#generate-the-k-mer-composition-of-a-string"><span class="header-section-number">22</span> Generate the k-mer Composition of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-22" id="toc-sample-dataset-22" class="nav-link" data-scroll-target="#sample-dataset-22"><span class="header-section-number">22.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-22" id="toc-sample-output-22" class="nav-link" data-scroll-target="#sample-output-22"><span class="header-section-number">22.2</span> Sample Output</a></li>
  <li><a href="#solution-22" id="toc-solution-22" class="nav-link" data-scroll-target="#solution-22"><span class="header-section-number">22.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-genome-path" id="toc-reconstruct-a-string-from-its-genome-path" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-genome-path"><span class="header-section-number">23</span> Reconstruct a String from its Genome Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-23" id="toc-sample-dataset-23" class="nav-link" data-scroll-target="#sample-dataset-23"><span class="header-section-number">23.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-23" id="toc-sample-output-23" class="nav-link" data-scroll-target="#sample-output-23"><span class="header-section-number">23.2</span> Sample Output</a></li>
  <li><a href="#solution-23" id="toc-solution-23" class="nav-link" data-scroll-target="#solution-23"><span class="header-section-number">23.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-overlap-graph-of-a-collection-of-k-mers" id="toc-construct-the-overlap-graph-of-a-collection-of-k-mers" class="nav-link" data-scroll-target="#construct-the-overlap-graph-of-a-collection-of-k-mers"><span class="header-section-number">24</span> Construct the Overlap Graph of a Collection of k-mers</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-24" id="toc-sample-dataset-24" class="nav-link" data-scroll-target="#sample-dataset-24"><span class="header-section-number">24.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-24" id="toc-sample-output-24" class="nav-link" data-scroll-target="#sample-output-24"><span class="header-section-number">24.2</span> Sample Output</a></li>
  <li><a href="#solution-24" id="toc-solution-24" class="nav-link" data-scroll-target="#solution-24"><span class="header-section-number">24.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-de-bruijn-graph-of-a-string" id="toc-construct-the-de-bruijn-graph-of-a-string" class="nav-link" data-scroll-target="#construct-the-de-bruijn-graph-of-a-string"><span class="header-section-number">25</span> Construct the De Bruijn Graph of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-25" id="toc-sample-dataset-25" class="nav-link" data-scroll-target="#sample-dataset-25"><span class="header-section-number">25.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-25" id="toc-sample-output-25" class="nav-link" data-scroll-target="#sample-output-25"><span class="header-section-number">25.2</span> Sample Output</a></li>
  <li><a href="#solution-25" id="toc-solution-25" class="nav-link" data-scroll-target="#solution-25"><span class="header-section-number">25.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-de-bruijn-graph-of-a-collection-of-k-mers" id="toc-construct-the-de-bruijn-graph-of-a-collection-of-k-mers" class="nav-link" data-scroll-target="#construct-the-de-bruijn-graph-of-a-collection-of-k-mers"><span class="header-section-number">26</span> Construct the De Bruijn Graph of a Collection of k-mers</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-26" id="toc-sample-dataset-26" class="nav-link" data-scroll-target="#sample-dataset-26"><span class="header-section-number">26.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-26" id="toc-sample-output-26" class="nav-link" data-scroll-target="#sample-output-26"><span class="header-section-number">26.2</span> Sample Output</a></li>
  <li><a href="#solution-26" id="toc-solution-26" class="nav-link" data-scroll-target="#solution-26"><span class="header-section-number">26.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-an-eulerian-cycle-in-a-graph" id="toc-find-an-eulerian-cycle-in-a-graph" class="nav-link" data-scroll-target="#find-an-eulerian-cycle-in-a-graph"><span class="header-section-number">27</span> Find an Eulerian Cycle in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-27" id="toc-sample-dataset-27" class="nav-link" data-scroll-target="#sample-dataset-27"><span class="header-section-number">27.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-27" id="toc-sample-output-27" class="nav-link" data-scroll-target="#sample-output-27"><span class="header-section-number">27.2</span> Sample Output</a></li>
  <li><a href="#solution-27" id="toc-solution-27" class="nav-link" data-scroll-target="#solution-27"><span class="header-section-number">27.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-an-eulerian-path-in-a-graph" id="toc-find-an-eulerian-path-in-a-graph" class="nav-link" data-scroll-target="#find-an-eulerian-path-in-a-graph"><span class="header-section-number">28</span> Find an Eulerian Path in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-28" id="toc-sample-dataset-28" class="nav-link" data-scroll-target="#sample-dataset-28"><span class="header-section-number">28.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-28" id="toc-sample-output-28" class="nav-link" data-scroll-target="#sample-output-28"><span class="header-section-number">28.2</span> Sample Output</a></li>
  <li><a href="#solution-28" id="toc-solution-28" class="nav-link" data-scroll-target="#solution-28"><span class="header-section-number">28.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-k-mer-composition" id="toc-reconstruct-a-string-from-its-k-mer-composition" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-k-mer-composition"><span class="header-section-number">29</span> Reconstruct a String from its k-mer Composition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-29" id="toc-sample-dataset-29" class="nav-link" data-scroll-target="#sample-dataset-29"><span class="header-section-number">29.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-29" id="toc-sample-output-29" class="nav-link" data-scroll-target="#sample-output-29"><span class="header-section-number">29.2</span> Sample Output</a></li>
  <li><a href="#solution-29" id="toc-solution-29" class="nav-link" data-scroll-target="#solution-29"><span class="header-section-number">29.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-k-universal-circular-string" id="toc-find-a-k-universal-circular-string" class="nav-link" data-scroll-target="#find-a-k-universal-circular-string"><span class="header-section-number">30</span> Find a k-Universal Circular String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-30" id="toc-sample-dataset-30" class="nav-link" data-scroll-target="#sample-dataset-30"><span class="header-section-number">30.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-30" id="toc-sample-output-30" class="nav-link" data-scroll-target="#sample-output-30"><span class="header-section-number">30.2</span> Sample Output</a></li>
  <li><a href="#solution-30" id="toc-solution-30" class="nav-link" data-scroll-target="#solution-30"><span class="header-section-number">30.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-paired-composition" id="toc-reconstruct-a-string-from-its-paired-composition" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-paired-composition"><span class="header-section-number">31</span> Reconstruct a String from its Paired Composition</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-31" id="toc-sample-dataset-31" class="nav-link" data-scroll-target="#sample-dataset-31"><span class="header-section-number">31.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-31" id="toc-sample-output-31" class="nav-link" data-scroll-target="#sample-output-31"><span class="header-section-number">31.2</span> Sample Output</a></li>
  <li><a href="#solution-31" id="toc-solution-31" class="nav-link" data-scroll-target="#solution-31"><span class="header-section-number">31.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-contigs-from-a-collection-of-reads" id="toc-generate-contigs-from-a-collection-of-reads" class="nav-link" data-scroll-target="#generate-contigs-from-a-collection-of-reads"><span class="header-section-number">32</span> Generate Contigs from a Collection of Reads</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-32" id="toc-sample-dataset-32" class="nav-link" data-scroll-target="#sample-dataset-32"><span class="header-section-number">32.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-32" id="toc-sample-output-32" class="nav-link" data-scroll-target="#sample-output-32"><span class="header-section-number">32.2</span> Sample Output</a></li>
  <li><a href="#solution-32" id="toc-solution-32" class="nav-link" data-scroll-target="#solution-32"><span class="header-section-number">32.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-string-spelled-by-a-gapped-genome-path" id="toc-construct-a-string-spelled-by-a-gapped-genome-path" class="nav-link" data-scroll-target="#construct-a-string-spelled-by-a-gapped-genome-path"><span class="header-section-number">33</span> Construct a String Spelled by a Gapped Genome Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-33" id="toc-sample-dataset-33" class="nav-link" data-scroll-target="#sample-dataset-33"><span class="header-section-number">33.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-33" id="toc-sample-output-33" class="nav-link" data-scroll-target="#sample-output-33"><span class="header-section-number">33.2</span> Sample Output</a></li>
  <li><a href="#solution-33" id="toc-solution-33" class="nav-link" data-scroll-target="#solution-33"><span class="header-section-number">33.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-all-maximal-non-branching-paths-in-a-graph" id="toc-generate-all-maximal-non-branching-paths-in-a-graph" class="nav-link" data-scroll-target="#generate-all-maximal-non-branching-paths-in-a-graph"><span class="header-section-number">34</span> Generate All Maximal Non-Branching Paths in a Graph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-34" id="toc-sample-dataset-34" class="nav-link" data-scroll-target="#sample-dataset-34"><span class="header-section-number">34.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-34" id="toc-sample-output-34" class="nav-link" data-scroll-target="#sample-output-34"><span class="header-section-number">34.2</span> Sample Output</a></li>
  <li><a href="#solution-34" id="toc-solution-34" class="nav-link" data-scroll-target="#solution-34"><span class="header-section-number">34.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#translate-an-rna-string-into-an-amino-acid-string" id="toc-translate-an-rna-string-into-an-amino-acid-string" class="nav-link" data-scroll-target="#translate-an-rna-string-into-an-amino-acid-string"><span class="header-section-number">35</span> Translate an RNA String into an Amino Acid String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-35" id="toc-sample-dataset-35" class="nav-link" data-scroll-target="#sample-dataset-35"><span class="header-section-number">35.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-35" id="toc-sample-output-35" class="nav-link" data-scroll-target="#sample-output-35"><span class="header-section-number">35.2</span> Sample Output</a></li>
  <li><a href="#solution-35" id="toc-solution-35" class="nav-link" data-scroll-target="#solution-35"><span class="header-section-number">35.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-substrings-of-a-genome-encoding-a-given-amino-acid-string" id="toc-find-substrings-of-a-genome-encoding-a-given-amino-acid-string" class="nav-link" data-scroll-target="#find-substrings-of-a-genome-encoding-a-given-amino-acid-string"><span class="header-section-number">36</span> Find Substrings of a Genome Encoding a Given Amino Acid String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-36" id="toc-sample-dataset-36" class="nav-link" data-scroll-target="#sample-dataset-36"><span class="header-section-number">36.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-36" id="toc-sample-output-36" class="nav-link" data-scroll-target="#sample-output-36"><span class="header-section-number">36.2</span> Sample Output</a></li>
  <li><a href="#solution-36" id="toc-solution-36" class="nav-link" data-scroll-target="#solution-36"><span class="header-section-number">36.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-theoretical-spectrum-of-a-cyclic-peptide" id="toc-generate-the-theoretical-spectrum-of-a-cyclic-peptide" class="nav-link" data-scroll-target="#generate-the-theoretical-spectrum-of-a-cyclic-peptide"><span class="header-section-number">37</span> Generate the Theoretical Spectrum of a Cyclic Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-37" id="toc-sample-dataset-37" class="nav-link" data-scroll-target="#sample-dataset-37"><span class="header-section-number">37.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-37" id="toc-sample-output-37" class="nav-link" data-scroll-target="#sample-output-37"><span class="header-section-number">37.2</span> Sample Output</a></li>
  <li><a href="#solution-37" id="toc-solution-37" class="nav-link" data-scroll-target="#solution-37"><span class="header-section-number">37.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-number-of-peptides-of-given-total-mass" id="toc-compute-the-number-of-peptides-of-given-total-mass" class="nav-link" data-scroll-target="#compute-the-number-of-peptides-of-given-total-mass"><span class="header-section-number">38</span> Compute the Number of Peptides of Given Total Mass</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-38" id="toc-sample-dataset-38" class="nav-link" data-scroll-target="#sample-dataset-38"><span class="header-section-number">38.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-38" id="toc-sample-output-38" class="nav-link" data-scroll-target="#sample-output-38"><span class="header-section-number">38.2</span> Sample Output</a></li>
  <li><a href="#solution-38" id="toc-solution-38" class="nav-link" data-scroll-target="#solution-38"><span class="header-section-number">38.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum" id="toc-find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum" class="nav-link" data-scroll-target="#find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum"><span class="header-section-number">39</span> Find a Cyclic Peptide with Theoretical Spectrum Matching an Ideal Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-39" id="toc-sample-dataset-39" class="nav-link" data-scroll-target="#sample-dataset-39"><span class="header-section-number">39.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-39" id="toc-sample-output-39" class="nav-link" data-scroll-target="#sample-output-39"><span class="header-section-number">39.2</span> Sample Output</a></li>
  <li><a href="#solution-39" id="toc-solution-39" class="nav-link" data-scroll-target="#solution-39"><span class="header-section-number">39.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-score-of-a-cyclic-peptide-against-a-spectrum" id="toc-compute-the-score-of-a-cyclic-peptide-against-a-spectrum" class="nav-link" data-scroll-target="#compute-the-score-of-a-cyclic-peptide-against-a-spectrum"><span class="header-section-number">40</span> Compute the Score of a Cyclic Peptide Against a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-40" id="toc-sample-dataset-40" class="nav-link" data-scroll-target="#sample-dataset-40"><span class="header-section-number">40.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-40" id="toc-sample-output-40" class="nav-link" data-scroll-target="#sample-output-40"><span class="header-section-number">40.2</span> Sample Output</a></li>
  <li><a href="#solution-40" id="toc-solution-40" class="nav-link" data-scroll-target="#solution-40"><span class="header-section-number">40.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-leaderboardcyclopeptidesequencing" id="toc-implement-leaderboardcyclopeptidesequencing" class="nav-link" data-scroll-target="#implement-leaderboardcyclopeptidesequencing"><span class="header-section-number">41</span> Implement LeaderboardCyclopeptideSequencing</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-41" id="toc-sample-dataset-41" class="nav-link" data-scroll-target="#sample-dataset-41"><span class="header-section-number">41.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-41" id="toc-sample-output-41" class="nav-link" data-scroll-target="#sample-output-41"><span class="header-section-number">41.2</span> Sample Output</a></li>
  <li><a href="#solution-41" id="toc-solution-41" class="nav-link" data-scroll-target="#solution-41"><span class="header-section-number">41.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-convolution-of-a-spectrum" id="toc-generate-the-convolution-of-a-spectrum" class="nav-link" data-scroll-target="#generate-the-convolution-of-a-spectrum"><span class="header-section-number">42</span> Generate the Convolution of a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-42" id="toc-sample-dataset-42" class="nav-link" data-scroll-target="#sample-dataset-42"><span class="header-section-number">42.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-42" id="toc-sample-output-42" class="nav-link" data-scroll-target="#sample-output-42"><span class="header-section-number">42.2</span> Sample Output</a></li>
  <li><a href="#solution-42" id="toc-solution-42" class="nav-link" data-scroll-target="#solution-42"><span class="header-section-number">42.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-convolutioncyclopeptidesequencing" id="toc-implement-convolutioncyclopeptidesequencing" class="nav-link" data-scroll-target="#implement-convolutioncyclopeptidesequencing"><span class="header-section-number">43</span> Implement ConvolutionCyclopeptideSequencing</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-43" id="toc-sample-dataset-43" class="nav-link" data-scroll-target="#sample-dataset-43"><span class="header-section-number">43.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-43" id="toc-sample-output-43" class="nav-link" data-scroll-target="#sample-output-43"><span class="header-section-number">43.2</span> Sample Output</a></li>
  <li><a href="#solution-43" id="toc-solution-43" class="nav-link" data-scroll-target="#solution-43"><span class="header-section-number">43.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-theoretical-spectrum-of-a-linear-peptide" id="toc-generate-the-theoretical-spectrum-of-a-linear-peptide" class="nav-link" data-scroll-target="#generate-the-theoretical-spectrum-of-a-linear-peptide"><span class="header-section-number">44</span> Generate the Theoretical Spectrum of a Linear Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-44" id="toc-sample-dataset-44" class="nav-link" data-scroll-target="#sample-dataset-44"><span class="header-section-number">44.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-44" id="toc-sample-output-44" class="nav-link" data-scroll-target="#sample-output-44"><span class="header-section-number">44.2</span> Sample Output</a></li>
  <li><a href="#solution-44" id="toc-solution-44" class="nav-link" data-scroll-target="#solution-44"><span class="header-section-number">44.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-score-of-a-linear-peptide" id="toc-compute-the-score-of-a-linear-peptide" class="nav-link" data-scroll-target="#compute-the-score-of-a-linear-peptide"><span class="header-section-number">45</span> Compute the Score of a Linear Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-45" id="toc-sample-dataset-45" class="nav-link" data-scroll-target="#sample-dataset-45"><span class="header-section-number">45.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-45" id="toc-sample-output-45" class="nav-link" data-scroll-target="#sample-output-45"><span class="header-section-number">45.2</span> Sample Output</a></li>
  <li><a href="#solution-45" id="toc-solution-45" class="nav-link" data-scroll-target="#solution-45"><span class="header-section-number">45.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#trim-a-peptide-leaderboard" id="toc-trim-a-peptide-leaderboard" class="nav-link" data-scroll-target="#trim-a-peptide-leaderboard"><span class="header-section-number">46</span> Trim a Peptide Leaderboard</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-46" id="toc-sample-dataset-46" class="nav-link" data-scroll-target="#sample-dataset-46"><span class="header-section-number">46.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-46" id="toc-sample-output-46" class="nav-link" data-scroll-target="#sample-output-46"><span class="header-section-number">46.2</span> Sample Output</a></li>
  <li><a href="#solution-46" id="toc-solution-46" class="nav-link" data-scroll-target="#solution-46"><span class="header-section-number">46.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#solve-the-turnpike-problem" id="toc-solve-the-turnpike-problem" class="nav-link" data-scroll-target="#solve-the-turnpike-problem"><span class="header-section-number">47</span> Solve the Turnpike Problem</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-47" id="toc-sample-dataset-47" class="nav-link" data-scroll-target="#sample-dataset-47"><span class="header-section-number">47.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-47" id="toc-sample-output-47" class="nav-link" data-scroll-target="#sample-output-47"><span class="header-section-number">47.2</span> Sample Output</a></li>
  <li><a href="#solution-47" id="toc-solution-47" class="nav-link" data-scroll-target="#solution-47"><span class="header-section-number">47.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-minimum-number-of-coins-needed-to-make-change" id="toc-find-the-minimum-number-of-coins-needed-to-make-change" class="nav-link" data-scroll-target="#find-the-minimum-number-of-coins-needed-to-make-change"><span class="header-section-number">48</span> Find the Minimum Number of Coins Needed to Make Change</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-48" id="toc-sample-dataset-48" class="nav-link" data-scroll-target="#sample-dataset-48"><span class="header-section-number">48.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-48" id="toc-sample-output-48" class="nav-link" data-scroll-target="#sample-output-48"><span class="header-section-number">48.2</span> Sample Output</a></li>
  <li><a href="#solution-48" id="toc-solution-48" class="nav-link" data-scroll-target="#solution-48"><span class="header-section-number">48.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-length-of-a-longest-path-in-a-manhattan-like-grid" id="toc-find-the-length-of-a-longest-path-in-a-manhattan-like-grid" class="nav-link" data-scroll-target="#find-the-length-of-a-longest-path-in-a-manhattan-like-grid"><span class="header-section-number">49</span> Find the Length of a Longest Path in a Manhattan-like Grid</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-49" id="toc-sample-dataset-49" class="nav-link" data-scroll-target="#sample-dataset-49"><span class="header-section-number">49.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-49" id="toc-sample-output-49" class="nav-link" data-scroll-target="#sample-output-49"><span class="header-section-number">49.2</span> Sample Output</a></li>
  <li><a href="#solution-49" id="toc-solution-49" class="nav-link" data-scroll-target="#solution-49"><span class="header-section-number">49.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-longest-common-subsequence-of-two-strings" id="toc-find-a-longest-common-subsequence-of-two-strings" class="nav-link" data-scroll-target="#find-a-longest-common-subsequence-of-two-strings"><span class="header-section-number">50</span> Find a Longest Common Subsequence of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-50" id="toc-sample-dataset-50" class="nav-link" data-scroll-target="#sample-dataset-50"><span class="header-section-number">50.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-50" id="toc-sample-output-50" class="nav-link" data-scroll-target="#sample-output-50"><span class="header-section-number">50.2</span> Sample Output</a></li>
  <li><a href="#solution-50" id="toc-solution-50" class="nav-link" data-scroll-target="#solution-50"><span class="header-section-number">50.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-longest-path-in-a-dag" id="toc-find-the-longest-path-in-a-dag" class="nav-link" data-scroll-target="#find-the-longest-path-in-a-dag"><span class="header-section-number">51</span> Find the Longest Path in a DAG</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-51" id="toc-sample-dataset-51" class="nav-link" data-scroll-target="#sample-dataset-51"><span class="header-section-number">51.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-51" id="toc-sample-output-51" class="nav-link" data-scroll-target="#sample-output-51"><span class="header-section-number">51.2</span> Sample Output</a></li>
  <li><a href="#solution-51" id="toc-solution-51" class="nav-link" data-scroll-target="#solution-51"><span class="header-section-number">51.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-alignment-of-two-strings" id="toc-find-a-highest-scoring-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-alignment-of-two-strings"><span class="header-section-number">52</span> Find a Highest-Scoring Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-52" id="toc-sample-dataset-52" class="nav-link" data-scroll-target="#sample-dataset-52"><span class="header-section-number">52.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-52" id="toc-sample-output-52" class="nav-link" data-scroll-target="#sample-output-52"><span class="header-section-number">52.2</span> Sample Output</a></li>
  <li><a href="#solution-52" id="toc-solution-52" class="nav-link" data-scroll-target="#solution-52"><span class="header-section-number">52.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-local-alignment-of-two-strings" id="toc-find-a-highest-scoring-local-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-local-alignment-of-two-strings"><span class="header-section-number">53</span> Find a Highest-Scoring Local Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-53" id="toc-sample-dataset-53" class="nav-link" data-scroll-target="#sample-dataset-53"><span class="header-section-number">53.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-53" id="toc-sample-output-53" class="nav-link" data-scroll-target="#sample-output-53"><span class="header-section-number">53.2</span> Sample Output</a></li>
  <li><a href="#solution-53" id="toc-solution-53" class="nav-link" data-scroll-target="#solution-53"><span class="header-section-number">53.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-edit-distance-between-two-strings" id="toc-compute-the-edit-distance-between-two-strings" class="nav-link" data-scroll-target="#compute-the-edit-distance-between-two-strings"><span class="header-section-number">54</span> Compute the Edit Distance Between Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-54" id="toc-sample-dataset-54" class="nav-link" data-scroll-target="#sample-dataset-54"><span class="header-section-number">54.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-54" id="toc-sample-output-54" class="nav-link" data-scroll-target="#sample-output-54"><span class="header-section-number">54.2</span> Sample Output</a></li>
  <li><a href="#solution-54" id="toc-solution-54" class="nav-link" data-scroll-target="#solution-54"><span class="header-section-number">54.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-fitting-alignment-of-two-strings" id="toc-find-a-highest-scoring-fitting-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-fitting-alignment-of-two-strings"><span class="header-section-number">55</span> Find a Highest-Scoring Fitting Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-55" id="toc-sample-dataset-55" class="nav-link" data-scroll-target="#sample-dataset-55"><span class="header-section-number">55.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-55" id="toc-sample-output-55" class="nav-link" data-scroll-target="#sample-output-55"><span class="header-section-number">55.2</span> Sample Output</a></li>
  <li><a href="#solution-55" id="toc-solution-55" class="nav-link" data-scroll-target="#solution-55"><span class="header-section-number">55.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-overlap-alignment-of-two-strings" id="toc-find-a-highest-scoring-overlap-alignment-of-two-strings" class="nav-link" data-scroll-target="#find-a-highest-scoring-overlap-alignment-of-two-strings"><span class="header-section-number">56</span> Find a Highest-Scoring Overlap Alignment of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-56" id="toc-sample-dataset-56" class="nav-link" data-scroll-target="#sample-dataset-56"><span class="header-section-number">56.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-56" id="toc-sample-output-56" class="nav-link" data-scroll-target="#sample-output-56"><span class="header-section-number">56.2</span> Sample Output</a></li>
  <li><a href="#solution-56" id="toc-solution-56" class="nav-link" data-scroll-target="#solution-56"><span class="header-section-number">56.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#align-two-strings-using-affine-gap-penalties" id="toc-align-two-strings-using-affine-gap-penalties" class="nav-link" data-scroll-target="#align-two-strings-using-affine-gap-penalties"><span class="header-section-number">57</span> Align Two Strings Using Affine Gap Penalties</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-57" id="toc-sample-dataset-57" class="nav-link" data-scroll-target="#sample-dataset-57"><span class="header-section-number">57.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-57" id="toc-sample-output-57" class="nav-link" data-scroll-target="#sample-output-57"><span class="header-section-number">57.2</span> Sample Output</a></li>
  <li><a href="#solution-57" id="toc-solution-57" class="nav-link" data-scroll-target="#solution-57"><span class="header-section-number">57.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-middle-edge-in-an-alignment-graph-in-linear-space" id="toc-find-a-middle-edge-in-an-alignment-graph-in-linear-space" class="nav-link" data-scroll-target="#find-a-middle-edge-in-an-alignment-graph-in-linear-space"><span class="header-section-number">58</span> Find a Middle Edge in an Alignment Graph in Linear Space</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-58" id="toc-sample-dataset-58" class="nav-link" data-scroll-target="#sample-dataset-58"><span class="header-section-number">58.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-58" id="toc-sample-output-58" class="nav-link" data-scroll-target="#sample-output-58"><span class="header-section-number">58.2</span> Sample Output</a></li>
  <li><a href="#solution-58" id="toc-solution-58" class="nav-link" data-scroll-target="#solution-58"><span class="header-section-number">58.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#align-two-strings-using-linear-space" id="toc-align-two-strings-using-linear-space" class="nav-link" data-scroll-target="#align-two-strings-using-linear-space"><span class="header-section-number">59</span> Align Two Strings Using Linear Space</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-59" id="toc-sample-dataset-59" class="nav-link" data-scroll-target="#sample-dataset-59"><span class="header-section-number">59.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-59" id="toc-sample-output-59" class="nav-link" data-scroll-target="#sample-output-59"><span class="header-section-number">59.2</span> Sample Output</a></li>
  <li><a href="#solution-59" id="toc-solution-59" class="nav-link" data-scroll-target="#solution-59"><span class="header-section-number">59.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-multiple-sequence-alignment" id="toc-find-a-highest-scoring-multiple-sequence-alignment" class="nav-link" data-scroll-target="#find-a-highest-scoring-multiple-sequence-alignment"><span class="header-section-number">60</span> Find a Highest-Scoring Multiple Sequence Alignment</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-60" id="toc-sample-dataset-60" class="nav-link" data-scroll-target="#sample-dataset-60"><span class="header-section-number">60.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-60" id="toc-sample-output-60" class="nav-link" data-scroll-target="#sample-output-60"><span class="header-section-number">60.2</span> Sample Output</a></li>
  <li><a href="#solution-60" id="toc-solution-60" class="nav-link" data-scroll-target="#solution-60"><span class="header-section-number">60.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-topological-ordering-of-a-dag" id="toc-find-a-topological-ordering-of-a-dag" class="nav-link" data-scroll-target="#find-a-topological-ordering-of-a-dag"><span class="header-section-number">61</span> Find a Topological Ordering of a DAG</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-61" id="toc-sample-dataset-61" class="nav-link" data-scroll-target="#sample-dataset-61"><span class="header-section-number">61.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-61" id="toc-sample-output-61" class="nav-link" data-scroll-target="#sample-output-61"><span class="header-section-number">61.2</span> Sample Output</a></li>
  <li><a href="#solution-61" id="toc-solution-61" class="nav-link" data-scroll-target="#solution-61"><span class="header-section-number">61.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-greedysorting-to-sort-a-permutation-by-reversals" id="toc-implement-greedysorting-to-sort-a-permutation-by-reversals" class="nav-link" data-scroll-target="#implement-greedysorting-to-sort-a-permutation-by-reversals"><span class="header-section-number">62</span> Implement GreedySorting to Sort a Permutation by Reversals</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-62" id="toc-sample-dataset-62" class="nav-link" data-scroll-target="#sample-dataset-62"><span class="header-section-number">62.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-62" id="toc-sample-output-62" class="nav-link" data-scroll-target="#sample-output-62"><span class="header-section-number">62.2</span> Sample Output</a></li>
  <li><a href="#solution-62" id="toc-solution-62" class="nav-link" data-scroll-target="#solution-62"><span class="header-section-number">62.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-number-of-breakpoints-in-a-permutation" id="toc-compute-the-number-of-breakpoints-in-a-permutation" class="nav-link" data-scroll-target="#compute-the-number-of-breakpoints-in-a-permutation"><span class="header-section-number">63</span> Compute the Number of Breakpoints in a Permutation</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-63" id="toc-sample-dataset-63" class="nav-link" data-scroll-target="#sample-dataset-63"><span class="header-section-number">63.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-63" id="toc-sample-output-63" class="nav-link" data-scroll-target="#sample-output-63"><span class="header-section-number">63.2</span> Sample Output</a></li>
  <li><a href="#solution-63" id="toc-solution-63" class="nav-link" data-scroll-target="#solution-63"><span class="header-section-number">63.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-2-break-distance-between-a-pair-of-genomes" id="toc-compute-the-2-break-distance-between-a-pair-of-genomes" class="nav-link" data-scroll-target="#compute-the-2-break-distance-between-a-pair-of-genomes"><span class="header-section-number">64</span> Compute the 2-Break Distance Between a Pair of Genomes</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-64" id="toc-sample-dataset-64" class="nav-link" data-scroll-target="#sample-dataset-64"><span class="header-section-number">64.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-64" id="toc-sample-output-64" class="nav-link" data-scroll-target="#sample-output-64"><span class="header-section-number">64.2</span> Sample Output</a></li>
  <li><a href="#solution-64" id="toc-solution-64" class="nav-link" data-scroll-target="#solution-64"><span class="header-section-number">64.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks" id="toc-find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks" class="nav-link" data-scroll-target="#find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks"><span class="header-section-number">65</span> Find a Shortest Transformation of One Genome into Another by 2-Breaks</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-65" id="toc-sample-dataset-65" class="nav-link" data-scroll-target="#sample-dataset-65"><span class="header-section-number">65.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-65" id="toc-sample-output-65" class="nav-link" data-scroll-target="#sample-output-65"><span class="header-section-number">65.2</span> Sample Output</a></li>
  <li><a href="#solution-65" id="toc-solution-65" class="nav-link" data-scroll-target="#solution-65"><span class="header-section-number">65.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-shared-k-mers-of-a-pair-of-strings" id="toc-find-all-shared-k-mers-of-a-pair-of-strings" class="nav-link" data-scroll-target="#find-all-shared-k-mers-of-a-pair-of-strings"><span class="header-section-number">66</span> Find All Shared k-mers of a Pair of Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-66" id="toc-sample-dataset-66" class="nav-link" data-scroll-target="#sample-dataset-66"><span class="header-section-number">66.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-66" id="toc-sample-output-66" class="nav-link" data-scroll-target="#sample-output-66"><span class="header-section-number">66.2</span> Sample Output</a></li>
  <li><a href="#solution-66" id="toc-solution-66" class="nav-link" data-scroll-target="#solution-66"><span class="header-section-number">66.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-chromosometocycle" id="toc-implement-chromosometocycle" class="nav-link" data-scroll-target="#implement-chromosometocycle"><span class="header-section-number">67</span> Implement ChromosomeToCycle</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-67" id="toc-sample-dataset-67" class="nav-link" data-scroll-target="#sample-dataset-67"><span class="header-section-number">67.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-67" id="toc-sample-output-67" class="nav-link" data-scroll-target="#sample-output-67"><span class="header-section-number">67.2</span> Sample Output</a></li>
  <li><a href="#solution-67" id="toc-solution-67" class="nav-link" data-scroll-target="#solution-67"><span class="header-section-number">67.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-cycletochromosome" id="toc-implement-cycletochromosome" class="nav-link" data-scroll-target="#implement-cycletochromosome"><span class="header-section-number">68</span> Implement CycleToChromosome</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-68" id="toc-sample-dataset-68" class="nav-link" data-scroll-target="#sample-dataset-68"><span class="header-section-number">68.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-68" id="toc-sample-output-68" class="nav-link" data-scroll-target="#sample-output-68"><span class="header-section-number">68.2</span> Sample Output</a></li>
  <li><a href="#solution-68" id="toc-solution-68" class="nav-link" data-scroll-target="#solution-68"><span class="header-section-number">68.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-colorededges" id="toc-implement-colorededges" class="nav-link" data-scroll-target="#implement-colorededges"><span class="header-section-number">69</span> Implement ColoredEdges</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-69" id="toc-sample-dataset-69" class="nav-link" data-scroll-target="#sample-dataset-69"><span class="header-section-number">69.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-69" id="toc-sample-output-69" class="nav-link" data-scroll-target="#sample-output-69"><span class="header-section-number">69.2</span> Sample Output</a></li>
  <li><a href="#solution-69" id="toc-solution-69" class="nav-link" data-scroll-target="#solution-69"><span class="header-section-number">69.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-graphtogenome" id="toc-implement-graphtogenome" class="nav-link" data-scroll-target="#implement-graphtogenome"><span class="header-section-number">70</span> Implement GraphToGenome</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-70" id="toc-sample-dataset-70" class="nav-link" data-scroll-target="#sample-dataset-70"><span class="header-section-number">70.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-70" id="toc-sample-output-70" class="nav-link" data-scroll-target="#sample-output-70"><span class="header-section-number">70.2</span> Sample Output</a></li>
  <li><a href="#solution-70" id="toc-solution-70" class="nav-link" data-scroll-target="#solution-70"><span class="header-section-number">70.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-2-breakongenomegraph" id="toc-implement-2-breakongenomegraph" class="nav-link" data-scroll-target="#implement-2-breakongenomegraph"><span class="header-section-number">71</span> Implement 2-BreakOnGenomeGraph</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-71" id="toc-sample-dataset-71" class="nav-link" data-scroll-target="#sample-dataset-71"><span class="header-section-number">71.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-71" id="toc-sample-output-71" class="nav-link" data-scroll-target="#sample-output-71"><span class="header-section-number">71.2</span> Sample Output</a></li>
  <li><a href="#solution-71" id="toc-solution-71" class="nav-link" data-scroll-target="#solution-71"><span class="header-section-number">71.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-2-breakongenome" id="toc-implement-2-breakongenome" class="nav-link" data-scroll-target="#implement-2-breakongenome"><span class="header-section-number">72</span> Implement 2-BreakOnGenome</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-72" id="toc-sample-dataset-72" class="nav-link" data-scroll-target="#sample-dataset-72"><span class="header-section-number">72.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-72" id="toc-sample-output-72" class="nav-link" data-scroll-target="#sample-output-72"><span class="header-section-number">72.2</span> Sample Output</a></li>
  <li><a href="#solution-72" id="toc-solution-72" class="nav-link" data-scroll-target="#solution-72"><span class="header-section-number">72.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-distances-between-leaves" id="toc-compute-distances-between-leaves" class="nav-link" data-scroll-target="#compute-distances-between-leaves"><span class="header-section-number">73</span> Compute Distances Between Leaves</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-73" id="toc-sample-dataset-73" class="nav-link" data-scroll-target="#sample-dataset-73"><span class="header-section-number">73.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-73" id="toc-sample-output-73" class="nav-link" data-scroll-target="#sample-output-73"><span class="header-section-number">73.2</span> Sample Output</a></li>
  <li><a href="#solution-73" id="toc-solution-73" class="nav-link" data-scroll-target="#solution-73"><span class="header-section-number">73.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-limb-lengths-in-a-tree" id="toc-compute-limb-lengths-in-a-tree" class="nav-link" data-scroll-target="#compute-limb-lengths-in-a-tree"><span class="header-section-number">74</span> Compute Limb Lengths in a Tree</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-74" id="toc-sample-dataset-74" class="nav-link" data-scroll-target="#sample-dataset-74"><span class="header-section-number">74.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-74" id="toc-sample-output-74" class="nav-link" data-scroll-target="#sample-output-74"><span class="header-section-number">74.2</span> Sample Output</a></li>
  <li><a href="#solution-74" id="toc-solution-74" class="nav-link" data-scroll-target="#solution-74"><span class="header-section-number">74.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-additivephylogeny" id="toc-implement-additivephylogeny" class="nav-link" data-scroll-target="#implement-additivephylogeny"><span class="header-section-number">75</span> Implement AdditivePhylogeny</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-75" id="toc-sample-dataset-75" class="nav-link" data-scroll-target="#sample-dataset-75"><span class="header-section-number">75.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-75" id="toc-sample-output-75" class="nav-link" data-scroll-target="#sample-output-75"><span class="header-section-number">75.2</span> Sample Output</a></li>
  <li><a href="#solution-75" id="toc-solution-75" class="nav-link" data-scroll-target="#solution-75"><span class="header-section-number">75.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-upgma" id="toc-implement-upgma" class="nav-link" data-scroll-target="#implement-upgma"><span class="header-section-number">76</span> Implement UPGMA</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-76" id="toc-sample-dataset-76" class="nav-link" data-scroll-target="#sample-dataset-76"><span class="header-section-number">76.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-76" id="toc-sample-output-76" class="nav-link" data-scroll-target="#sample-output-76"><span class="header-section-number">76.2</span> Sample Output</a></li>
  <li><a href="#solution-76" id="toc-solution-76" class="nav-link" data-scroll-target="#solution-76"><span class="header-section-number">76.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-neighbor-joining-algorithm" id="toc-implement-the-neighbor-joining-algorithm" class="nav-link" data-scroll-target="#implement-the-neighbor-joining-algorithm"><span class="header-section-number">77</span> Implement the Neighbor Joining Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-77" id="toc-sample-dataset-77" class="nav-link" data-scroll-target="#sample-dataset-77"><span class="header-section-number">77.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-77" id="toc-sample-output-77" class="nav-link" data-scroll-target="#sample-output-77"><span class="header-section-number">77.2</span> Sample Output</a></li>
  <li><a href="#solution-77" id="toc-solution-77" class="nav-link" data-scroll-target="#solution-77"><span class="header-section-number">77.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-smallparsimony" id="toc-implement-smallparsimony" class="nav-link" data-scroll-target="#implement-smallparsimony"><span class="header-section-number">78</span> Implement SmallParsimony</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-78" id="toc-sample-dataset-78" class="nav-link" data-scroll-target="#sample-dataset-78"><span class="header-section-number">78.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-78" id="toc-sample-output-78" class="nav-link" data-scroll-target="#sample-output-78"><span class="header-section-number">78.2</span> Sample Output</a></li>
  <li><a href="#solution-78" id="toc-solution-78" class="nav-link" data-scroll-target="#solution-78"><span class="header-section-number">78.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#adapt-smallparsimony-to-unrooted-trees" id="toc-adapt-smallparsimony-to-unrooted-trees" class="nav-link" data-scroll-target="#adapt-smallparsimony-to-unrooted-trees"><span class="header-section-number">79</span> Adapt SmallParsimony to Unrooted Trees</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-79" id="toc-sample-dataset-79" class="nav-link" data-scroll-target="#sample-dataset-79"><span class="header-section-number">79.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-79" id="toc-sample-output-79" class="nav-link" data-scroll-target="#sample-output-79"><span class="header-section-number">79.2</span> Sample Output</a></li>
  <li><a href="#solution-79" id="toc-solution-79" class="nav-link" data-scroll-target="#solution-79"><span class="header-section-number">79.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#adapt-smallparsimony-to-unrooted-trees-1" id="toc-adapt-smallparsimony-to-unrooted-trees-1" class="nav-link" data-scroll-target="#adapt-smallparsimony-to-unrooted-trees-1"><span class="header-section-number">80</span> Adapt SmallParsimony to Unrooted Trees</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-80" id="toc-sample-dataset-80" class="nav-link" data-scroll-target="#sample-dataset-80"><span class="header-section-number">80.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-80" id="toc-sample-output-80" class="nav-link" data-scroll-target="#sample-output-80"><span class="header-section-number">80.2</span> Sample Output</a></li>
  <li><a href="#solution-80" id="toc-solution-80" class="nav-link" data-scroll-target="#solution-80"><span class="header-section-number">80.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-farthestfirsttraversal" id="toc-implement-farthestfirsttraversal" class="nav-link" data-scroll-target="#implement-farthestfirsttraversal"><span class="header-section-number">81</span> Implement FarthestFirstTraversal</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-81" id="toc-sample-dataset-81" class="nav-link" data-scroll-target="#sample-dataset-81"><span class="header-section-number">81.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-81" id="toc-sample-output-81" class="nav-link" data-scroll-target="#sample-output-81"><span class="header-section-number">81.2</span> Sample Output</a></li>
  <li><a href="#solution-81" id="toc-solution-81" class="nav-link" data-scroll-target="#solution-81"><span class="header-section-number">81.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-squared-error-distortion" id="toc-compute-the-squared-error-distortion" class="nav-link" data-scroll-target="#compute-the-squared-error-distortion"><span class="header-section-number">82</span> Compute the Squared Error Distortion</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-82" id="toc-sample-dataset-82" class="nav-link" data-scroll-target="#sample-dataset-82"><span class="header-section-number">82.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-82" id="toc-sample-output-82" class="nav-link" data-scroll-target="#sample-output-82"><span class="header-section-number">82.2</span> Sample Output</a></li>
  <li><a href="#solution-82" id="toc-solution-82" class="nav-link" data-scroll-target="#solution-82"><span class="header-section-number">82.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-lloyd-algorithm-for-k-means-clustering" id="toc-implement-the-lloyd-algorithm-for-k-means-clustering" class="nav-link" data-scroll-target="#implement-the-lloyd-algorithm-for-k-means-clustering"><span class="header-section-number">83</span> Implement the Lloyd Algorithm for k-Means Clustering</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-83" id="toc-sample-dataset-83" class="nav-link" data-scroll-target="#sample-dataset-83"><span class="header-section-number">83.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-83" id="toc-sample-output-83" class="nav-link" data-scroll-target="#sample-output-83"><span class="header-section-number">83.2</span> Sample Output</a></li>
  <li><a href="#solution-83" id="toc-solution-83" class="nav-link" data-scroll-target="#solution-83"><span class="header-section-number">83.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-soft-k-means-clustering-algorithm" id="toc-implement-the-soft-k-means-clustering-algorithm" class="nav-link" data-scroll-target="#implement-the-soft-k-means-clustering-algorithm"><span class="header-section-number">84</span> Implement the Soft k-Means Clustering Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-84" id="toc-sample-dataset-84" class="nav-link" data-scroll-target="#sample-dataset-84"><span class="header-section-number">84.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-84" id="toc-sample-output-84" class="nav-link" data-scroll-target="#sample-output-84"><span class="header-section-number">84.2</span> Sample Output</a></li>
  <li><a href="#solution-84" id="toc-solution-84" class="nav-link" data-scroll-target="#solution-84"><span class="header-section-number">84.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-hierarchical-clustering" id="toc-implement-hierarchical-clustering" class="nav-link" data-scroll-target="#implement-hierarchical-clustering"><span class="header-section-number">85</span> Implement Hierarchical Clustering</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-85" id="toc-sample-dataset-85" class="nav-link" data-scroll-target="#sample-dataset-85"><span class="header-section-number">85.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-85" id="toc-sample-output-85" class="nav-link" data-scroll-target="#sample-output-85"><span class="header-section-number">85.2</span> Sample Output</a></li>
  <li><a href="#solution-85" id="toc-solution-85" class="nav-link" data-scroll-target="#solution-85"><span class="header-section-number">85.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-trie-from-a-collection-of-patterns" id="toc-construct-a-trie-from-a-collection-of-patterns" class="nav-link" data-scroll-target="#construct-a-trie-from-a-collection-of-patterns"><span class="header-section-number">86</span> Construct a Trie from a Collection of Patterns</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-86" id="toc-sample-dataset-86" class="nav-link" data-scroll-target="#sample-dataset-86"><span class="header-section-number">86.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-86" id="toc-sample-output-86" class="nav-link" data-scroll-target="#sample-output-86"><span class="header-section-number">86.2</span> Sample Output</a></li>
  <li><a href="#solution-86" id="toc-solution-86" class="nav-link" data-scroll-target="#solution-86"><span class="header-section-number">86.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-triematching" id="toc-implement-triematching" class="nav-link" data-scroll-target="#implement-triematching"><span class="header-section-number">87</span> Implement TrieMatching</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-87" id="toc-sample-dataset-87" class="nav-link" data-scroll-target="#sample-dataset-87"><span class="header-section-number">87.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-87" id="toc-sample-output-87" class="nav-link" data-scroll-target="#sample-output-87"><span class="header-section-number">87.2</span> Sample Output</a></li>
  <li><a href="#solution-87" id="toc-solution-87" class="nav-link" data-scroll-target="#solution-87"><span class="header-section-number">87.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-suffix-tree-of-a-string" id="toc-construct-the-suffix-tree-of-a-string" class="nav-link" data-scroll-target="#construct-the-suffix-tree-of-a-string"><span class="header-section-number">88</span> Construct the Suffix Tree of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-88" id="toc-sample-dataset-88" class="nav-link" data-scroll-target="#sample-dataset-88"><span class="header-section-number">88.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-88" id="toc-sample-output-88" class="nav-link" data-scroll-target="#sample-output-88"><span class="header-section-number">88.2</span> Sample Output</a></li>
  <li><a href="#solution-88" id="toc-solution-88" class="nav-link" data-scroll-target="#solution-88"><span class="header-section-number">88.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-longest-repeat-in-a-string" id="toc-find-the-longest-repeat-in-a-string" class="nav-link" data-scroll-target="#find-the-longest-repeat-in-a-string"><span class="header-section-number">89</span> Find the Longest Repeat in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-89" id="toc-sample-dataset-89" class="nav-link" data-scroll-target="#sample-dataset-89"><span class="header-section-number">89.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-89" id="toc-sample-output-89" class="nav-link" data-scroll-target="#sample-output-89"><span class="header-section-number">89.2</span> Sample Output</a></li>
  <li><a href="#solution-89" id="toc-solution-89" class="nav-link" data-scroll-target="#solution-89"><span class="header-section-number">89.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-longest-substring-shared-by-two-strings" id="toc-find-the-longest-substring-shared-by-two-strings" class="nav-link" data-scroll-target="#find-the-longest-substring-shared-by-two-strings"><span class="header-section-number">90</span> Find the Longest Substring Shared by Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-90" id="toc-sample-dataset-90" class="nav-link" data-scroll-target="#sample-dataset-90"><span class="header-section-number">90.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-90" id="toc-sample-output-90" class="nav-link" data-scroll-target="#sample-output-90"><span class="header-section-number">90.2</span> Sample Output</a></li>
  <li><a href="#solution-90" id="toc-solution-90" class="nav-link" data-scroll-target="#solution-90"><span class="header-section-number">90.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-the-shortest-non-shared-substring-of-two-strings" id="toc-find-the-shortest-non-shared-substring-of-two-strings" class="nav-link" data-scroll-target="#find-the-shortest-non-shared-substring-of-two-strings"><span class="header-section-number">91</span> Find the Shortest Non-Shared Substring of Two Strings</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-91" id="toc-sample-dataset-91" class="nav-link" data-scroll-target="#sample-dataset-91"><span class="header-section-number">91.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-91" id="toc-sample-output-91" class="nav-link" data-scroll-target="#sample-output-91"><span class="header-section-number">91.2</span> Sample Output</a></li>
  <li><a href="#solution-91" id="toc-solution-91" class="nav-link" data-scroll-target="#solution-91"><span class="header-section-number">91.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-suffix-array-of-a-string" id="toc-construct-the-suffix-array-of-a-string" class="nav-link" data-scroll-target="#construct-the-suffix-array-of-a-string"><span class="header-section-number">92</span> Construct the Suffix Array of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-92" id="toc-sample-dataset-92" class="nav-link" data-scroll-target="#sample-dataset-92"><span class="header-section-number">92.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-92" id="toc-sample-output-92" class="nav-link" data-scroll-target="#sample-output-92"><span class="header-section-number">92.2</span> Sample Output</a></li>
  <li><a href="#solution-92" id="toc-solution-92" class="nav-link" data-scroll-target="#solution-92"><span class="header-section-number">92.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#pattern-matching-with-the-suffix-array" id="toc-pattern-matching-with-the-suffix-array" class="nav-link" data-scroll-target="#pattern-matching-with-the-suffix-array"><span class="header-section-number">93</span> Pattern Matching with the Suffix Array</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-93" id="toc-sample-dataset-93" class="nav-link" data-scroll-target="#sample-dataset-93"><span class="header-section-number">93.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-93" id="toc-sample-output-93" class="nav-link" data-scroll-target="#sample-output-93"><span class="header-section-number">93.2</span> Sample Output</a></li>
  <li><a href="#solution-93" id="toc-solution-93" class="nav-link" data-scroll-target="#solution-93"><span class="header-section-number">93.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-burrows-wheeler-transform-of-a-string" id="toc-construct-the-burrows-wheeler-transform-of-a-string" class="nav-link" data-scroll-target="#construct-the-burrows-wheeler-transform-of-a-string"><span class="header-section-number">94</span> Construct the Burrows-Wheeler Transform of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-94" id="toc-sample-dataset-94" class="nav-link" data-scroll-target="#sample-dataset-94"><span class="header-section-number">94.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-94" id="toc-sample-output-94" class="nav-link" data-scroll-target="#sample-output-94"><span class="header-section-number">94.2</span> Sample Output</a></li>
  <li><a href="#solution-94" id="toc-solution-94" class="nav-link" data-scroll-target="#solution-94"><span class="header-section-number">94.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#reconstruct-a-string-from-its-burrows-wheeler-transform" id="toc-reconstruct-a-string-from-its-burrows-wheeler-transform" class="nav-link" data-scroll-target="#reconstruct-a-string-from-its-burrows-wheeler-transform"><span class="header-section-number">95</span> Reconstruct a String from its Burrows-Wheeler Transform</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-95" id="toc-sample-dataset-95" class="nav-link" data-scroll-target="#sample-dataset-95"><span class="header-section-number">95.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-95" id="toc-sample-output-95" class="nav-link" data-scroll-target="#sample-output-95"><span class="header-section-number">95.2</span> Sample Output</a></li>
  <li><a href="#solution-95" id="toc-solution-95" class="nav-link" data-scroll-target="#solution-95"><span class="header-section-number">95.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#generate-the-last-to-first-mapping-of-a-string" id="toc-generate-the-last-to-first-mapping-of-a-string" class="nav-link" data-scroll-target="#generate-the-last-to-first-mapping-of-a-string"><span class="header-section-number">96</span> Generate the Last-to-First Mapping of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-96" id="toc-sample-dataset-96" class="nav-link" data-scroll-target="#sample-dataset-96"><span class="header-section-number">96.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-96" id="toc-sample-output-96" class="nav-link" data-scroll-target="#sample-output-96"><span class="header-section-number">96.2</span> Sample Output</a></li>
  <li><a href="#solution-96" id="toc-solution-96" class="nav-link" data-scroll-target="#solution-96"><span class="header-section-number">96.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-bwmatching" id="toc-implement-bwmatching" class="nav-link" data-scroll-target="#implement-bwmatching"><span class="header-section-number">97</span> Implement BWMatching</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-97" id="toc-sample-dataset-97" class="nav-link" data-scroll-target="#sample-dataset-97"><span class="header-section-number">97.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-97" id="toc-sample-output-97" class="nav-link" data-scroll-target="#sample-output-97"><span class="header-section-number">97.2</span> Sample Output</a></li>
  <li><a href="#solution-97" id="toc-solution-97" class="nav-link" data-scroll-target="#solution-97"><span class="header-section-number">97.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-betterbwmatching" id="toc-implement-betterbwmatching" class="nav-link" data-scroll-target="#implement-betterbwmatching"><span class="header-section-number">98</span> Implement BetterBWMatching</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-98" id="toc-sample-dataset-98" class="nav-link" data-scroll-target="#sample-dataset-98"><span class="header-section-number">98.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-98" id="toc-sample-output-98" class="nav-link" data-scroll-target="#sample-output-98"><span class="header-section-number">98.2</span> Sample Output</a></li>
  <li><a href="#solution-98" id="toc-solution-98" class="nav-link" data-scroll-target="#solution-98"><span class="header-section-number">98.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-occurrences-of-a-collection-of-patterns-in-a-string" id="toc-find-all-occurrences-of-a-collection-of-patterns-in-a-string" class="nav-link" data-scroll-target="#find-all-occurrences-of-a-collection-of-patterns-in-a-string"><span class="header-section-number">99</span> Find All Occurrences of a Collection of Patterns in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-99" id="toc-sample-dataset-99" class="nav-link" data-scroll-target="#sample-dataset-99"><span class="header-section-number">99.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-99" id="toc-sample-output-99" class="nav-link" data-scroll-target="#sample-output-99"><span class="header-section-number">99.2</span> Sample Output</a></li>
  <li><a href="#solution-99" id="toc-solution-99" class="nav-link" data-scroll-target="#solution-99"><span class="header-section-number">99.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-all-approximate-occurrences-of-a-collection-of-patterns-in-a-string" id="toc-find-all-approximate-occurrences-of-a-collection-of-patterns-in-a-string" class="nav-link" data-scroll-target="#find-all-approximate-occurrences-of-a-collection-of-patterns-in-a-string"><span class="header-section-number">100</span> Find All Approximate Occurrences of a Collection of Patterns in a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-100" id="toc-sample-dataset-100" class="nav-link" data-scroll-target="#sample-dataset-100"><span class="header-section-number">100.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-100" id="toc-sample-output-100" class="nav-link" data-scroll-target="#sample-output-100"><span class="header-section-number">100.2</span> Sample Output</a></li>
  <li><a href="#solution-100" id="toc-solution-100" class="nav-link" data-scroll-target="#solution-100"><span class="header-section-number">100.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-treecoloring" id="toc-implement-treecoloring" class="nav-link" data-scroll-target="#implement-treecoloring"><span class="header-section-number">101</span> Implement TreeColoring</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-101" id="toc-sample-dataset-101" class="nav-link" data-scroll-target="#sample-dataset-101"><span class="header-section-number">101.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-101" id="toc-sample-output-101" class="nav-link" data-scroll-target="#sample-output-101"><span class="header-section-number">101.2</span> Sample Output</a></li>
  <li><a href="#solution-101" id="toc-solution-101" class="nav-link" data-scroll-target="#solution-101"><span class="header-section-number">101.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-partial-suffix-array-of-a-string" id="toc-construct-the-partial-suffix-array-of-a-string" class="nav-link" data-scroll-target="#construct-the-partial-suffix-array-of-a-string"><span class="header-section-number">102</span> Construct the Partial Suffix Array of a String</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-102" id="toc-sample-dataset-102" class="nav-link" data-scroll-target="#sample-dataset-102"><span class="header-section-number">102.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-102" id="toc-sample-output-102" class="nav-link" data-scroll-target="#sample-output-102"><span class="header-section-number">102.2</span> Sample Output</a></li>
  <li><a href="#solution-102" id="toc-solution-102" class="nav-link" data-scroll-target="#solution-102"><span class="header-section-number">102.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-suffix-tree-from-a-suffix-array" id="toc-construct-a-suffix-tree-from-a-suffix-array" class="nav-link" data-scroll-target="#construct-a-suffix-tree-from-a-suffix-array"><span class="header-section-number">103</span> Construct a Suffix Tree from a Suffix Array</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-103" id="toc-sample-dataset-103" class="nav-link" data-scroll-target="#sample-dataset-103"><span class="header-section-number">103.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-103" id="toc-sample-output-103" class="nav-link" data-scroll-target="#sample-output-103"><span class="header-section-number">103.2</span> Sample Output</a></li>
  <li><a href="#solution-103" id="toc-solution-103" class="nav-link" data-scroll-target="#solution-103"><span class="header-section-number">103.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-hidden-path" id="toc-compute-the-probability-of-a-hidden-path" class="nav-link" data-scroll-target="#compute-the-probability-of-a-hidden-path"><span class="header-section-number">104</span> Compute the Probability of a Hidden Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-104" id="toc-sample-dataset-104" class="nav-link" data-scroll-target="#sample-dataset-104"><span class="header-section-number">104.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-104" id="toc-sample-output-104" class="nav-link" data-scroll-target="#sample-output-104"><span class="header-section-number">104.2</span> Sample Output</a></li>
  <li><a href="#solution-104" id="toc-solution-104" class="nav-link" data-scroll-target="#solution-104"><span class="header-section-number">104.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-an-outcome-given-a-hidden-path" id="toc-compute-the-probability-of-an-outcome-given-a-hidden-path" class="nav-link" data-scroll-target="#compute-the-probability-of-an-outcome-given-a-hidden-path"><span class="header-section-number">105</span> Compute the Probability of an Outcome Given a Hidden Path</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-105" id="toc-sample-dataset-105" class="nav-link" data-scroll-target="#sample-dataset-105"><span class="header-section-number">105.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-105" id="toc-sample-output-105" class="nav-link" data-scroll-target="#sample-output-105"><span class="header-section-number">105.2</span> Sample Output</a></li>
  <li><a href="#solution-105" id="toc-solution-105" class="nav-link" data-scroll-target="#solution-105"><span class="header-section-number">105.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-the-viterbi-algorithm" id="toc-implement-the-viterbi-algorithm" class="nav-link" data-scroll-target="#implement-the-viterbi-algorithm"><span class="header-section-number">106</span> Implement the Viterbi Algorithm</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-106" id="toc-sample-dataset-106" class="nav-link" data-scroll-target="#sample-dataset-106"><span class="header-section-number">106.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-106" id="toc-sample-output-106" class="nav-link" data-scroll-target="#sample-output-106"><span class="header-section-number">106.2</span> Sample Output</a></li>
  <li><a href="#solution-106" id="toc-solution-106" class="nav-link" data-scroll-target="#solution-106"><span class="header-section-number">106.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-string-emitted-by-an-hmm" id="toc-compute-the-probability-of-a-string-emitted-by-an-hmm" class="nav-link" data-scroll-target="#compute-the-probability-of-a-string-emitted-by-an-hmm"><span class="header-section-number">107</span> Compute the Probability of a String Emitted by an HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-107" id="toc-sample-dataset-107" class="nav-link" data-scroll-target="#sample-dataset-107"><span class="header-section-number">107.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-107" id="toc-sample-output-107" class="nav-link" data-scroll-target="#sample-output-107"><span class="header-section-number">107.2</span> Sample Output</a></li>
  <li><a href="#solution-107" id="toc-solution-107" class="nav-link" data-scroll-target="#solution-107"><span class="header-section-number">107.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-profile-hmm" id="toc-construct-a-profile-hmm" class="nav-link" data-scroll-target="#construct-a-profile-hmm"><span class="header-section-number">108</span> Construct a Profile HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-108" id="toc-sample-dataset-108" class="nav-link" data-scroll-target="#sample-dataset-108"><span class="header-section-number">108.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-108" id="toc-sample-output-108" class="nav-link" data-scroll-target="#sample-output-108"><span class="header-section-number">108.2</span> Sample Output</a></li>
  <li><a href="#solution-108" id="toc-solution-108" class="nav-link" data-scroll-target="#solution-108"><span class="header-section-number">108.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-a-profile-hmm-with-pseudocounts" id="toc-construct-a-profile-hmm-with-pseudocounts" class="nav-link" data-scroll-target="#construct-a-profile-hmm-with-pseudocounts"><span class="header-section-number">109</span> Construct a Profile HMM with Pseudocounts</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-109" id="toc-sample-dataset-109" class="nav-link" data-scroll-target="#sample-dataset-109"><span class="header-section-number">109.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-109" id="toc-sample-output-109" class="nav-link" data-scroll-target="#sample-output-109"><span class="header-section-number">109.2</span> Sample Output</a></li>
  <li><a href="#solution-109" id="toc-solution-109" class="nav-link" data-scroll-target="#solution-109"><span class="header-section-number">109.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#perform-a-multiple-sequence-alignment-with-a-profile-hmm" id="toc-perform-a-multiple-sequence-alignment-with-a-profile-hmm" class="nav-link" data-scroll-target="#perform-a-multiple-sequence-alignment-with-a-profile-hmm"><span class="header-section-number">110</span> Perform a Multiple Sequence Alignment with a Profile HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-110" id="toc-sample-dataset-110" class="nav-link" data-scroll-target="#sample-dataset-110"><span class="header-section-number">110.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-110" id="toc-sample-output-110" class="nav-link" data-scroll-target="#sample-output-110"><span class="header-section-number">110.2</span> Sample Output</a></li>
  <li><a href="#solution-110" id="toc-solution-110" class="nav-link" data-scroll-target="#solution-110"><span class="header-section-number">110.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#estimate-the-parameters-of-an-hmm" id="toc-estimate-the-parameters-of-an-hmm" class="nav-link" data-scroll-target="#estimate-the-parameters-of-an-hmm"><span class="header-section-number">111</span> Estimate the Parameters of an HMM</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-111" id="toc-sample-dataset-111" class="nav-link" data-scroll-target="#sample-dataset-111"><span class="header-section-number">111.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-111" id="toc-sample-output-111" class="nav-link" data-scroll-target="#sample-output-111"><span class="header-section-number">111.2</span> Sample Output</a></li>
  <li><a href="#solution-111" id="toc-solution-111" class="nav-link" data-scroll-target="#solution-111"><span class="header-section-number">111.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-viterbi-learning" id="toc-implement-viterbi-learning" class="nav-link" data-scroll-target="#implement-viterbi-learning"><span class="header-section-number">112</span> Implement Viterbi Learning</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-112" id="toc-sample-dataset-112" class="nav-link" data-scroll-target="#sample-dataset-112"><span class="header-section-number">112.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-112" id="toc-sample-output-112" class="nav-link" data-scroll-target="#sample-output-112"><span class="header-section-number">112.2</span> Sample Output</a></li>
  <li><a href="#solution-112" id="toc-solution-112" class="nav-link" data-scroll-target="#solution-112"><span class="header-section-number">112.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#solve-the-soft-decoding-problem" id="toc-solve-the-soft-decoding-problem" class="nav-link" data-scroll-target="#solve-the-soft-decoding-problem"><span class="header-section-number">113</span> Solve the Soft Decoding Problem</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-113" id="toc-sample-dataset-113" class="nav-link" data-scroll-target="#sample-dataset-113"><span class="header-section-number">113.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-113" id="toc-sample-output-113" class="nav-link" data-scroll-target="#sample-output-113"><span class="header-section-number">113.2</span> Sample Output</a></li>
  <li><a href="#solution-113" id="toc-solution-113" class="nav-link" data-scroll-target="#solution-113"><span class="header-section-number">113.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-baum-welch-learning" id="toc-implement-baum-welch-learning" class="nav-link" data-scroll-target="#implement-baum-welch-learning"><span class="header-section-number">114</span> Implement Baum-Welch Learning</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-114" id="toc-sample-dataset-114" class="nav-link" data-scroll-target="#sample-dataset-114"><span class="header-section-number">114.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-114" id="toc-sample-output-114" class="nav-link" data-scroll-target="#sample-output-114"><span class="header-section-number">114.2</span> Sample Output</a></li>
  <li><a href="#solution-114" id="toc-solution-114" class="nav-link" data-scroll-target="#solution-114"><span class="header-section-number">114.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#construct-the-graph-of-a-spectrum" id="toc-construct-the-graph-of-a-spectrum" class="nav-link" data-scroll-target="#construct-the-graph-of-a-spectrum"><span class="header-section-number">115</span> Construct the Graph of a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-115" id="toc-sample-dataset-115" class="nav-link" data-scroll-target="#sample-dataset-115"><span class="header-section-number">115.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-115" id="toc-sample-output-115" class="nav-link" data-scroll-target="#sample-output-115"><span class="header-section-number">115.2</span> Sample Output</a></li>
  <li><a href="#solution-115" id="toc-solution-115" class="nav-link" data-scroll-target="#solution-115"><span class="header-section-number">115.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-decodingidealspectrum" id="toc-implement-decodingidealspectrum" class="nav-link" data-scroll-target="#implement-decodingidealspectrum"><span class="header-section-number">116</span> Implement DecodingIdealSpectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-116" id="toc-sample-dataset-116" class="nav-link" data-scroll-target="#sample-dataset-116"><span class="header-section-number">116.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-116" id="toc-sample-output-116" class="nav-link" data-scroll-target="#sample-output-116"><span class="header-section-number">116.2</span> Sample Output</a></li>
  <li><a href="#solution-116" id="toc-solution-116" class="nav-link" data-scroll-target="#solution-116"><span class="header-section-number">116.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#convert-a-peptide-into-a-peptide-vector" id="toc-convert-a-peptide-into-a-peptide-vector" class="nav-link" data-scroll-target="#convert-a-peptide-into-a-peptide-vector"><span class="header-section-number">117</span> Convert a Peptide into a Peptide Vector</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-117" id="toc-sample-dataset-117" class="nav-link" data-scroll-target="#sample-dataset-117"><span class="header-section-number">117.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-117" id="toc-sample-output-117" class="nav-link" data-scroll-target="#sample-output-117"><span class="header-section-number">117.2</span> Sample Output</a></li>
  <li><a href="#solution-117" id="toc-solution-117" class="nav-link" data-scroll-target="#solution-117"><span class="header-section-number">117.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#convert-a-peptide-vector-into-a-peptide" id="toc-convert-a-peptide-vector-into-a-peptide" class="nav-link" data-scroll-target="#convert-a-peptide-vector-into-a-peptide"><span class="header-section-number">118</span> Convert a Peptide Vector into a Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-118" id="toc-sample-dataset-118" class="nav-link" data-scroll-target="#sample-dataset-118"><span class="header-section-number">118.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-118" id="toc-sample-output-118" class="nav-link" data-scroll-target="#sample-output-118"><span class="header-section-number">118.2</span> Sample Output</a></li>
  <li><a href="#solution-118" id="toc-solution-118" class="nav-link" data-scroll-target="#solution-118"><span class="header-section-number">118.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#sequence-a-peptide" id="toc-sequence-a-peptide" class="nav-link" data-scroll-target="#sequence-a-peptide"><span class="header-section-number">119</span> Sequence a Peptide</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-119" id="toc-sample-dataset-119" class="nav-link" data-scroll-target="#sample-dataset-119"><span class="header-section-number">119.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-119" id="toc-sample-output-119" class="nav-link" data-scroll-target="#sample-output-119"><span class="header-section-number">119.2</span> Sample Output</a></li>
  <li><a href="#solution-119" id="toc-solution-119" class="nav-link" data-scroll-target="#solution-119"><span class="header-section-number">119.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-peptide-in-a-proteome-against-a-spectrum" id="toc-find-a-highest-scoring-peptide-in-a-proteome-against-a-spectrum" class="nav-link" data-scroll-target="#find-a-highest-scoring-peptide-in-a-proteome-against-a-spectrum"><span class="header-section-number">120</span> Find a Highest-Scoring Peptide in a Proteome against a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-120" id="toc-sample-dataset-120" class="nav-link" data-scroll-target="#sample-dataset-120"><span class="header-section-number">120.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-120" id="toc-sample-output-120" class="nav-link" data-scroll-target="#sample-output-120"><span class="header-section-number">120.2</span> Sample Output</a></li>
  <li><a href="#solution-120" id="toc-solution-120" class="nav-link" data-scroll-target="#solution-120"><span class="header-section-number">120.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#implement-psmsearch" id="toc-implement-psmsearch" class="nav-link" data-scroll-target="#implement-psmsearch"><span class="header-section-number">121</span> Implement PSMSearch</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-121" id="toc-sample-dataset-121" class="nav-link" data-scroll-target="#sample-dataset-121"><span class="header-section-number">121.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-121" id="toc-sample-output-121" class="nav-link" data-scroll-target="#sample-output-121"><span class="header-section-number">121.2</span> Sample Output</a></li>
  <li><a href="#solution-121" id="toc-solution-121" class="nav-link" data-scroll-target="#solution-121"><span class="header-section-number">121.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-size-of-a-spectral-dictionary" id="toc-compute-the-size-of-a-spectral-dictionary" class="nav-link" data-scroll-target="#compute-the-size-of-a-spectral-dictionary"><span class="header-section-number">122</span> Compute the Size of a Spectral Dictionary</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-122" id="toc-sample-dataset-122" class="nav-link" data-scroll-target="#sample-dataset-122"><span class="header-section-number">122.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-122" id="toc-sample-output-122" class="nav-link" data-scroll-target="#sample-output-122"><span class="header-section-number">122.2</span> Sample Output</a></li>
  <li><a href="#solution-122" id="toc-solution-122" class="nav-link" data-scroll-target="#solution-122"><span class="header-section-number">122.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#compute-the-probability-of-a-spectral-dictionary" id="toc-compute-the-probability-of-a-spectral-dictionary" class="nav-link" data-scroll-target="#compute-the-probability-of-a-spectral-dictionary"><span class="header-section-number">123</span> Compute the Probability of a Spectral Dictionary</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-123" id="toc-sample-dataset-123" class="nav-link" data-scroll-target="#sample-dataset-123"><span class="header-section-number">123.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-123" id="toc-sample-output-123" class="nav-link" data-scroll-target="#sample-output-123"><span class="header-section-number">123.2</span> Sample Output</a></li>
  <li><a href="#solution-123" id="toc-solution-123" class="nav-link" data-scroll-target="#solution-123"><span class="header-section-number">123.3</span> Solution</a></li>
  </ul></li>
  <li><a href="#find-a-highest-scoring-modified-peptide-against-a-spectrum" id="toc-find-a-highest-scoring-modified-peptide-against-a-spectrum" class="nav-link" data-scroll-target="#find-a-highest-scoring-modified-peptide-against-a-spectrum"><span class="header-section-number">124</span> Find a Highest-Scoring Modified Peptide against a Spectrum</a>
  <ul class="collapse">
  <li><a href="#sample-dataset-124" id="toc-sample-dataset-124" class="nav-link" data-scroll-target="#sample-dataset-124"><span class="header-section-number">124.1</span> Sample Dataset</a></li>
  <li><a href="#sample-output-124" id="toc-sample-output-124" class="nav-link" data-scroll-target="#sample-output-124"><span class="header-section-number">124.2</span> Sample Output</a></li>
  <li><a href="#solution-124" id="toc-solution-124" class="nav-link" data-scroll-target="#solution-124"><span class="header-section-number">124.3</span> Solution</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Rosalind Textbook track 문제풀이</h1>
  <div class="quarto-categories">
    <div class="quarto-category">Python</div>
    <div class="quarto-category">Rosalind</div>
    <div class="quarto-category">Bioinformatics</div>
    <div class="quarto-category">Tip</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Taeyoon Kim </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">September 28, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">August 15, 2025</p>
    </div>
  </div>
    
  </div>
  


</header>


<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="Rosalind_textbookTrack.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="Rosalind_textbookTrack.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
<p>Phillip Compeau 와 Pavel Pevzner 가 쓴 책 “<a href="https://www.bioinformaticsalgorithms.org/">능동적 접근 방식의 생물정보학 알고리즘</a>” 에서 제공되는 연습 문제 모음입니다.</p>
<p><a href="https://rosalind.info/">Rosalind</a> 는 <a href="http://projecteuler.net/">프로젝트 오일러</a>, <a href="http://code.google.com/codejam">구글 코드 잼</a> 에서 영감을 얻었습니다. 이 프로젝트의 이름은 DNA 이중나선을 발견하는 데 기여한 <a href="http://en.wikipedia.org/wiki/Rosalind_Franklin">로잘린드 프랭클린</a> 에서 따왔습니다. Rosalind 는 프로그래밍 실력을 키우고자 하는 생물학자와 분자생물학의 계산 문제를 접해본 적이 없는 프로그래머들에게 도움이 될 것입니다.</p>
<section id="compute-the-number-of-times-a-pattern-appears-in-a-text" class="level2" data-number="0.1">
<h2 data-number="0.1" class="anchored" data-anchor-id="compute-the-number-of-times-a-pattern-appears-in-a-text"><span class="header-section-number">0.1</span> Compute the Number of Times a Pattern Appears in a Text</h2>
<p>This is the first problem in a collection of”code challenges”to accompany&nbsp;<a href="http://bioinformaticsalgorithms.org/">Bioinformatics Algorithms: An Active-Learning Approach</a>&nbsp;by Phillip Compeau &amp; Pavel Pevzner.</p>
<p>A&nbsp;<a href="https://rosalind.info/glossary/k-mer/">k-mer</a>&nbsp;is a&nbsp;<a href="https://rosalind.info/glossary/string/">string</a>&nbsp;of length&nbsp;<em>k</em>. We define&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>) as the number of times that a&nbsp;<em>k</em>-mer&nbsp;<em>Pattern</em>&nbsp;appears as a&nbsp;<a href="https://rosalind.info/glossary/substring/">substring</a>&nbsp;of&nbsp;<em>Text</em>.</p>
<p>For example, We note that&nbsp;<span class="math inline">\(Count(CGATATATCCATAGCGATATATCCATAG,ATAATA)\)</span> is equal to 3 (not 2) since we should account for overlapping occurrences of&nbsp;<em>Pattern</em>&nbsp;in&nbsp;<em>Text</em>.</p>
<p>Given:&nbsp;{DNA strings}}&nbsp;<em>Text</em>&nbsp;and&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>).</p>
</section>
<section id="sample-dataset" class="level2" data-number="0.2">
<h2 data-number="0.2" class="anchored" data-anchor-id="sample-dataset"><span class="header-section-number">0.2</span> Sample Dataset</h2>
<pre><code>GCGCG
GCG</code></pre>
</section>
<section id="sample-output" class="level2" data-number="0.3">
<h2 data-number="0.3" class="anchored" data-anchor-id="sample-output"><span class="header-section-number">0.3</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution" class="level2" data-number="0.4">
<h2 data-number="0.4" class="anchored" data-anchor-id="solution"><span class="header-section-number">0.4</span> Solution</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i:i <span class="op">+</span> size]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count how many times the pattern occurs in the text."""</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="st">GCGCG</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="st">GCG</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>text, pattern <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the count of pattern occurrences in text</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_pattern_occurrences(text, pattern))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="find-the-most-frequent-words-in-a-string" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Find the Most Frequent Words in a String</h1>
<p>We say that&nbsp;<em>Pattern</em>&nbsp;is a&nbsp;<strong>most frequent&nbsp;k-mer</strong>&nbsp;in&nbsp;<em>Text</em>&nbsp;if it maximizes&nbsp;<em>Count</em>(<em>Text</em>,&nbsp;<em>Pattern</em>) among all&nbsp;<a href="https://rosalind.info/glossary/k-mer/">k-mers</a>. For example,“ACTAT”is a most frequent 5-mer in”ACAACTATGCATCACTATCGGGAACTATCCT”, and”ATA”is a most frequent 3-mer of”CGATATATCCATAG”.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;All most frequent&nbsp;<em>k</em>-mers in&nbsp;<em>Text</em>&nbsp;(in any order).</p>
<section id="sample-dataset-1" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="sample-dataset-1"><span class="header-section-number">1.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4</code></pre>
</section>
<section id="sample-output-1" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="sample-output-1"><span class="header-section-number">1.2</span> Sample Output</h2>
<pre><code>CATG GCAT</code></pre>
</section>
<section id="solution-1" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="solution-1"><span class="header-section-number">1.3</span> Solution</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Count occurrences of each k-mer in the text."""</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(text, k):</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> most_frequent_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find the most frequent k-mers."""</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into text and pattern size</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>text, k <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="bu">int</span>(k)</span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Find and print the most frequent k-mers</span></span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>most_frequent <span class="op">=</span> most_frequent_kmers(count_kmers(text, k))</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-reverse-complement-of-a-string" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Find the Reverse Complement of a String</h1>
<p>Find the reverse complement of a DNA string.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<span class="math inline">\(\overline{Pattern}\)</span>, the reverse complement of&nbsp;<em>Pattern</em>.</p>
<section id="sample-dataset-2" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="sample-dataset-2"><span class="header-section-number">2.1</span> Sample Dataset</h2>
<pre><code>AAAACCCGGT</code></pre>
</section>
<section id="sample-output-2" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="sample-output-2"><span class="header-section-number">2.2</span> Sample Output</h2>
<pre><code>ACCGGGTTTT</code></pre>
</section>
<section id="solution-2" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="solution-2"><span class="header-section-number">2.3</span> Solution</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Return the reverse complement of a DNA sequence."""</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a><span class="st">AAAACCCGGT</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the reverse complement</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip().split()[<span class="dv">0</span>]</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reverse_complement(sequence))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-occurrences-of-a-pattern-in-a-string" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Find All Occurrences of a Pattern in a String</h1>
<p>Pattern Matching Problem, Find all occurrences of a pattern in a string.</p>
<p>Given:&nbsp;Strings&nbsp;<em>Pattern</em>&nbsp;and&nbsp;<em>Genome</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Genome</em>&nbsp;where&nbsp;<em>Pattern</em>&nbsp;appears as a substring. Use&nbsp;<a href="https://rosalind.info/glossary/0-based-numbering/">0-based indexing</a>.</p>
<section id="sample-dataset-3" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sample-dataset-3"><span class="header-section-number">3.1</span> Sample Dataset</h2>
<pre><code>ATAT
GATATATGCATATACTT</code></pre>
</section>
<section id="sample-output-3" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="sample-output-3"><span class="header-section-number">3.2</span> Sample Output</h2>
<pre><code>1 3 9</code></pre>
</section>
<section id="solution-3" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="solution-3"><span class="header-section-number">3.3</span> Solution</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Generator</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_indices(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Yield starting indices where the pattern is found in the text."""</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, <span class="bu">len</span>(pattern))):</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> substring <span class="op">==</span> pattern:</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> i</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a><span class="st">ATAT</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="st">GATATATGCATATACTT</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into pattern and text</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>pattern, text <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Print indices where the pattern is found</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_pattern_indices(text, pattern))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-patterns-forming-clumps-in-a-string" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Find Patterns Forming Clumps in a String</h1>
<p>Clump Finding Problem, Find patterns forming clumps in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Genome</em>, and integers&nbsp;<em>k</em>,&nbsp;<em>L</em>, and&nbsp;<em>t</em>.</p>
<p>Return:&nbsp;All distinct&nbsp;<em>k</em>-mers forming (<em>L</em>,&nbsp;<em>t</em>)-clumps in&nbsp;<em>Genome</em>.</p>
<section id="sample-dataset-4" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="sample-dataset-4"><span class="header-section-number">4.1</span> Sample Dataset</h2>
<pre><code>CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC
5 75 4</code></pre>
</section>
<section id="sample-output-4" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="sample-output-4"><span class="header-section-number">4.2</span> Sample Output</h2>
<pre><code>CGACA GAAGA AATGT</code></pre>
</section>
<section id="solution-4" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="solution-4"><span class="header-section-number">4.3</span> Solution</h2>
<div class="sourceCode" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Generate all substrings of a given size from the text."""</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [text[i:i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_kmers(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions of k-length kmers within the text."""</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>    kmer_positions <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(text, k)):</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>        kmer_positions[substring].append(i)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_positions</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> has_clump(positions: List[<span class="bu">int</span>], L: <span class="bu">int</span>, t: <span class="bu">int</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Check if a given array of kmers at positions forms a clump of t within L."""</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(positions) <span class="op">-</span> t <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (positions[i <span class="op">+</span> t <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> k <span class="op">-</span> positions[i]) <span class="op">&lt;=</span> L:</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="st">CGGACTCGACAGATGTGAAGAAATGTGAAGACTGAGTGAAGAGAAGAGGAAACACGACACGACATTGCGACATAATGTACGAATGTAATGTGCCTATGGC</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="st">5 75 4</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Split input into sequence and parameters</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>seq, params <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>k, L, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Find kmers and print those forming clumps</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>kmers <span class="op">=</span> find_kmers(seq, k)</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>clumps <span class="op">=</span> [kmer <span class="cf">for</span> kmer <span class="kw">in</span> kmers <span class="cf">if</span> has_clump(kmers[kmer], L, t, k)]</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>clumps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-position-in-a-genome-minimizing-the-skew" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Find a Position in a Genome Minimizing the Skew</h1>
<p>Minimum Skew Problem, Find a position in a genome minimizing the skew.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Genome</em>.</p>
<p>Return:&nbsp;All integer(s)&nbsp;<em>i</em>&nbsp;minimizing&nbsp;<em>Skew</em>(*Prefix__i<em>&nbsp;(</em>Text<em>)) over all values of&nbsp;</em>i<em>&nbsp;(from 0 to |</em>Genome*|).</p>
<section id="sample-dataset-5" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sample-dataset-5"><span class="header-section-number">5.1</span> Sample Dataset</h2>
<pre><code>CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</code></pre>
</section>
<section id="sample-output-5" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sample-output-5"><span class="header-section-number">5.2</span> Sample Output</h2>
<pre><code>53 97</code></pre>
</section>
<section id="solution-5" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="solution-5"><span class="header-section-number">5.3</span> Solution</h2>
<div class="sourceCode" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Generator</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minima(seq: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">int</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find positions with the minimum skew in a DNA sequence."""</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    skew <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> {<span class="st">"G"</span>: <span class="dv">1</span>, <span class="st">"C"</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"T"</span>: <span class="dv">0</span>}</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(seq):</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>        skew.append(skew[i] <span class="op">+</span> delta[nucleotide])</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    min_skew <span class="op">=</span> <span class="bu">min</span>(skew)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (i <span class="cf">for</span> i, value <span class="kw">in</span> <span class="bu">enumerate</span>(skew) <span class="cf">if</span> value <span class="op">==</span> min_skew)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a><span class="st">CCTATCGGTGGATTAGCATGTCCCTGTACGTTTCGCCGCGAACTAGTTCACACGGCTTGATGGCAAATGGTTTTTCCGGCGACCGTAATCGTCCACCGAG</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Process the input and print the positions with minimum skew</span></span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_minima(sequence))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-hamming-distance-between-two-strings" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Compute the Hamming Distance Between Two Strings</h1>
<p>Hamming Distance Problem, Compute the Hamming distance between two DNA strings.</p>
<p>Given:&nbsp;Two DNA strings.</p>
<p>Return:&nbsp;An integer value representing the Hamming distance.</p>
<section id="sample-dataset-6" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="sample-dataset-6"><span class="header-section-number">6.1</span> Sample Dataset</h2>
<pre><code>GGGCCGTTGGT
GGACCGTTGAC</code></pre>
</section>
<section id="sample-output-6" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="sample-output-6"><span class="header-section-number">6.2</span> Sample Output</h2>
<pre><code>3</code></pre>
</section>
<section id="solution-6" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="solution-6"><span class="header-section-number">6.3</span> Solution</h2>
<div class="sourceCode" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> zip_longest</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> zip_longest(sequence1, sequence2, fillvalue<span class="op">=</span><span class="va">None</span>))</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_dna_sequences(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>(input_string.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>))</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>Sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCCGTTGGT</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="st">GGACCGTTGAC</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>dna_sequence1, dna_sequence2 <span class="op">=</span> parse_dna_sequences(Sample_input)</span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>hamming_distance <span class="op">=</span> calculate_hamming_distance(dna_sequence1, dna_sequence2)</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(hamming_distance)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-approximate-occurrences-of-a-pattern-in-a-string" class="level1" data-number="7">
<h1 data-number="7"><span class="header-section-number">7</span> Find All Approximate Occurrences of a Pattern in a String</h1>
<p>Approximate Pattern Matching Problem, Find all approximate occurrences of a pattern in a string.</p>
<p>Given:&nbsp;Strings&nbsp;<em>Pattern</em>&nbsp;and&nbsp;<em>Text</em>&nbsp;along with an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All starting positions where&nbsp;<em>Pattern</em>&nbsp;appears as a substring of&nbsp;<em>Text</em>&nbsp;with at most&nbsp;<em>d</em>&nbsp;mismatches.</p>
<section id="sample-dataset-7" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="sample-dataset-7"><span class="header-section-number">7.1</span> Sample Dataset</h2>
<pre><code>ATTCTGGA
CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC
3</code></pre>
</section>
<section id="sample-output-7" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="sample-output-7"><span class="header-section-number">7.2</span> Sample Output</h2>
<pre><code>6 7 26 27 78</code></pre>
</section>
<section id="solution-7" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="solution-7"><span class="header-section-number">7.3</span> Solution</h2>
<div class="sourceCode" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_approximate_matches(pattern: <span class="bu">str</span>, genome: <span class="bu">str</span>, max_mismatch: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    pattern_length <span class="op">=</span> <span class="bu">len</span>(pattern)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (position <span class="cf">for</span> position, substring <span class="kw">in</span> <span class="bu">enumerate</span>(generate_substrings(genome, pattern_length))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_mismatch)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    pattern, genome, max_mismatch_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> pattern, genome, <span class="bu">int</span>(max_mismatch_str)</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a><span class="st">ATTCTGGA</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCGAATCCAGAACGCATTCCCATATTTCGGGACCACTGGCCTCCACGGTACGGACGTCAATCAAATGCCTAGCGGCTTGTGGTTTCTCCTACGCTCC</span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>pattern, genome, max_mismatch <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>match_positions <span class="op">=</span> <span class="bu">list</span>(find_approximate_matches(pattern, genome, max_mismatch))</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>match_positions)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-most-frequent-words-with-mismatches-in-a-string" class="level1" data-number="8">
<h1 data-number="8"><span class="header-section-number">8</span> Find the Most Frequent Words with Mismatches in a String</h1>
<p>Frequent Words with Mismatches Problem, Find the most frequent k-mers with mismatches in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;as well as integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All most frequent&nbsp;<em>k</em>-mers with up to&nbsp;<em>d</em>&nbsp;mismatches in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-8" class="level2" data-number="8.1">
<h2 data-number="8.1" class="anchored" data-anchor-id="sample-dataset-8"><span class="header-section-number">8.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4 1</code></pre>
</section>
<section id="sample-output-8" class="level2" data-number="8.2">
<h2 data-number="8.2" class="anchored" data-anchor-id="sample-output-8"><span class="header-section-number">8.2</span> Sample Output</h2>
<pre><code>ATGC ATGT GATG</code></pre>
</section>
<section id="solution-8" class="level2" data-number="8.3">
<h2 data-number="8.3" class="anchored" data-anchor-id="solution-8"><span class="header-section-number">8.3</span> Solution</h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna_sequence: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna_sequence[i:i <span class="op">+</span> substring_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna_sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna_sequence, kmer_length):</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(observed_kmers: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(observed_kmers[observed_kmer]</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> observed_kmer <span class="kw">in</span> observed_kmers</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a>observed_kmers <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(observed_kmers, max_mismatches, kmer_length))</span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>most_frequent_kmers <span class="op">=</span> find_most_frequent(approximate_kmer_counts)</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>most_frequent_kmers)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-frequent-words-with-mismatches-and-reverse-complements" class="level1" data-number="9">
<h1 data-number="9"><span class="header-section-number">9</span> Find Frequent Words with Mismatches and Reverse Complements</h1>
<p>Frequent Words with Mismatches and Reverse Complements Problem. Find the most frequent k-mers (with mismatches and reverse complements) in a DNA string.</p>
<p>Given:&nbsp;A DNA string&nbsp;<em>Text</em>&nbsp;as well as integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All&nbsp;<em>k</em>-mers&nbsp;<em>Pattern</em>&nbsp;maximizing the sum&nbsp;*Count__d<em>(</em>Text<em>,&nbsp;<span class="math inline">\(Pattern\)</span>) +&nbsp;</em>Count__d<em>(</em>Text<em>,&nbsp;<span class="math inline">\(\overline{Pattern}\)</span>}) over all possible&nbsp;</em>k*-mers.</p>
<section id="sample-dataset-9" class="level2" data-number="9.1">
<h2 data-number="9.1" class="anchored" data-anchor-id="sample-dataset-9"><span class="header-section-number">9.1</span> Sample Dataset</h2>
<pre><code>ACGTTGCATGTCGCATGATGCATGAGAGCT
4 1</code></pre>
</section>
<section id="sample-output-9" class="level2" data-number="9.2">
<h2 data-number="9.2" class="anchored" data-anchor-id="sample-output-9"><span class="header-section-number">9.2</span> Sample Output</h2>
<pre><code>ATGT ACAT</code></pre>
</section>
<section id="solution-9" class="level2" data-number="9.3">
<h2 data-number="9.3" class="anchored" data-anchor-id="solution-9"><span class="header-section-number">9.3</span> Solution</h2>
<div class="sourceCode" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Iterator, Tuple</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(dna: <span class="bu">str</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (dna[i:i <span class="op">+</span> length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna) <span class="op">-</span> length <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_kmers(dna: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>    kmer_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(dna, kmer_length):</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>        kmer_counts[kmer] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> kmer_counts</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_frequent(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>    max_count <span class="op">=</span> <span class="bu">max</span>(kmer_counts.values())</span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [kmer <span class="cf">for</span> kmer, count <span class="kw">in</span> kmer_counts.items() <span class="cf">if</span> count <span class="op">==</span> max_count]</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_all_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_all_kmers(kmer_length):</span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts</span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>        count <span class="op">+=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>                     <span class="cf">if</span> hamming_distance(reverse_complement(potential_kmer), observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>    dna_sequence, params <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>    kmer_length, max_mismatches <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, params.split())</span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence, kmer_length, max_mismatches</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a><span class="st">ACGTTGCATGTCGCATGATGCATGAGAGCT</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a><span class="st">4 1</span></span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, max_mismatches <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>kmer_counts <span class="op">=</span> count_kmers(dna_sequence, kmer_length)</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>approximate_kmer_counts <span class="op">=</span> <span class="bu">dict</span>(count_approximate_kmers(kmer_counts, max_mismatches, kmer_length))</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>find_most_frequent(approximate_kmer_counts))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-frequency-array-of-a-string" class="level1" data-number="10">
<h1 data-number="10"><span class="header-section-number">10</span> Generate the Frequency Array of a String</h1>
<p>Computing a Frequency Array, Generate the frequency array of a DNA string.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;The frequency array of&nbsp;<em>k</em>-mers in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-10" class="level2" data-number="10.1">
<h2 data-number="10.1" class="anchored" data-anchor-id="sample-dataset-10"><span class="header-section-number">10.1</span> Sample Dataset</h2>
<pre><code>ACGCGGCTCTGAAA
2</code></pre>
</section>
<section id="sample-output-10" class="level2" data-number="10.2">
<h2 data-number="10.2" class="anchored" data-anchor-id="sample-output-10"><span class="header-section-number">10.2</span> Sample Output</h2>
<pre><code>2 1 0 0 0 0 2 2 1 2 1 0 0 1 1 0</code></pre>
</section>
<section id="solution-10" class="level2" data-number="10.3">
<h2 data-number="10.3" class="anchored" data-anchor-id="solution-10"><span class="header-section-number">10.3</span> Solution</h2>
<div class="sourceCode" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict, Tuple</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, size: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (text[i : i <span class="op">+</span> size] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> size <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(pattern <span class="op">==</span> substring <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(s1: <span class="bu">str</span>, s2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(s1, s2))</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(k: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(bases) <span class="cf">for</span> bases <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>k))</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-16"><a href="#cb33-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_approximate_kmers(kmer_counts: Dict[<span class="bu">str</span>, <span class="bu">int</span>], max_mismatches: <span class="bu">int</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb33-17"><a href="#cb33-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> potential_kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb33-18"><a href="#cb33-18" aria-hidden="true" tabindex="-1"></a>        count <span class="op">=</span> <span class="bu">sum</span>(kmer_counts[observed_kmer] <span class="cf">for</span> observed_kmer <span class="kw">in</span> kmer_counts</span>
<span id="cb33-19"><a href="#cb33-19" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> calculate_hamming_distance(potential_kmer, observed_kmer) <span class="op">&lt;=</span> max_mismatches)</span>
<span id="cb33-20"><a href="#cb33-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb33-21"><a href="#cb33-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> (potential_kmer, count)</span>
<span id="cb33-22"><a href="#cb33-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-23"><a href="#cb33-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_frequencies(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb33-24"><a href="#cb33-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_pattern_occurrences(sequence, kmer) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length)]</span>
<span id="cb33-25"><a href="#cb33-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-26"><a href="#cb33-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb33-27"><a href="#cb33-27" aria-hidden="true" tabindex="-1"></a>    sequence, kmer_length <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb33-28"><a href="#cb33-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(kmer_length)</span>
<span id="cb33-29"><a href="#cb33-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-30"><a href="#cb33-30" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb33-31"><a href="#cb33-31" aria-hidden="true" tabindex="-1"></a><span class="st">ACGCGGCTCTGAAA</span></span>
<span id="cb33-32"><a href="#cb33-32" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb33-33"><a href="#cb33-33" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb33-34"><a href="#cb33-34" aria-hidden="true" tabindex="-1"></a>sequence, kmer_length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb33-35"><a href="#cb33-35" aria-hidden="true" tabindex="-1"></a>kmer_frequencies <span class="op">=</span> calculate_kmer_frequencies(sequence, kmer_length)</span>
<span id="cb33-36"><a href="#cb33-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>kmer_frequencies</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-patterntonumber" class="level1" data-number="11">
<h1 data-number="11"><span class="header-section-number">11</span> Implement PatternToNumber</h1>
<p>Implement PatternToNumber, Convert a DNA string to a number.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;<em>PatternToNumber</em>(<em>Pattern</em>).</p>
<section id="sample-dataset-11" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sample-dataset-11"><span class="header-section-number">11.1</span> Sample Dataset</h2>
<pre><code>AGT</code></pre>
</section>
<section id="sample-output-11" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sample-output-11"><span class="header-section-number">11.2</span> Sample Output</h2>
<pre><code>11</code></pre>
</section>
<section id="solution-11" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="solution-11"><span class="header-section-number">11.3</span> Solution</h2>
<div class="sourceCode" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_nucleotide_to_number_map() <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_nucleotide_to_number(nucleotide: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotide_map[nucleotide]</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_dna_pattern_to_number(dna_pattern: <span class="bu">str</span>, nucleotide_map: Dict[<span class="bu">str</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> dna_pattern:</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="dv">4</span> <span class="op">*</span> convert_dna_pattern_to_number(dna_pattern[:<span class="op">-</span><span class="dv">1</span>], nucleotide_map) <span class="op">+</span> convert_nucleotide_to_number(dna_pattern[<span class="op">-</span><span class="dv">1</span>], nucleotide_map)</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_data.strip()</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a><span class="st">AGT</span></span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>nucleotide_map <span class="op">=</span> create_nucleotide_to_number_map()</span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> convert_dna_pattern_to_number(dna_pattern, nucleotide_map)</span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-numbertopattern" class="level1" data-number="12">
<h1 data-number="12"><span class="header-section-number">12</span> Implement NumberToPattern</h1>
<p>Implement NumberToPattern, Convert an integer to its corresponding DNA string.</p>
<p>Given:&nbsp;Integers&nbsp;<em>index</em>&nbsp;and&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;<em>NumberToPattern</em>(<em>index</em>,&nbsp;<em>k</em>).</p>
<section id="sample-dataset-12" class="level2" data-number="12.1">
<h2 data-number="12.1" class="anchored" data-anchor-id="sample-dataset-12"><span class="header-section-number">12.1</span> Sample Dataset</h2>
<pre><code>45
4</code></pre>
</section>
<section id="sample-output-12" class="level2" data-number="12.2">
<h2 data-number="12.2" class="anchored" data-anchor-id="sample-output-12"><span class="header-section-number">12.2</span> Sample Output</h2>
<pre><code>AGTC</code></pre>
</section>
<section id="solution-12" class="level2" data-number="12.3">
<h2 data-number="12.3" class="anchored" data-anchor-id="solution-12"><span class="header-section-number">12.3</span> Solution</h2>
<div class="sourceCode" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_nucleotide(index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nucleotides[index]</span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> number_to_dna_pattern(index: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> length <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> number_to_nucleotide(index)</span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>    quotient, remainder <span class="op">=</span> <span class="bu">divmod</span>(index, <span class="dv">4</span>)</span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> number_to_dna_pattern(quotient, length <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> number_to_nucleotide(remainder)</span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a>    index_str, length_str <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">int</span>(index_str), <span class="bu">int</span>(length_str)</span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="st">45</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a>index, length <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a>dna_pattern <span class="op">=</span> number_to_dna_pattern(index, length)</span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(dna_pattern)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-d-neighborhood-of-a-string" class="level1" data-number="13">
<h1 data-number="13"><span class="header-section-number">13</span> Generate the d-Neighborhood of a String</h1>
<p>Generate the d-Neighborhood of a String Find all the neighbors of a pattern.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>&nbsp;and an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;The collection of strings&nbsp;<em>Neighbors</em>(<em>Pattern</em>,&nbsp;<em>d</em>).</p>
<section id="sample-dataset-13" class="level2" data-number="13.1">
<h2 data-number="13.1" class="anchored" data-anchor-id="sample-dataset-13"><span class="header-section-number">13.1</span> Sample Dataset</h2>
<pre><code>ACG
1</code></pre>
</section>
<section id="sample-output-13" class="level2" data-number="13.2">
<h2 data-number="13.2" class="anchored" data-anchor-id="sample-output-13"><span class="header-section-number">13.2</span> Sample Output</h2>
<pre><code>CCG
TCG
GCG
AAG
ATG
AGG
ACA
ACC
ACT
ACG</code></pre>
</section>
<section id="solution-13" class="level2" data-number="13.3">
<h2 data-number="13.3" class="anchored" data-anchor-id="solution-13"><span class="header-section-number">13.3</span> Solution</h2>
<div class="sourceCode" id="cb42"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Set, List, Tuple, Iterator</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_immediate_neighbors(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, current_base <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> new_base <span class="kw">in</span> nucleotides:</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> new_base <span class="op">!=</span> current_base:</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence[:i] <span class="op">+</span> new_base <span class="op">+</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:]</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    neighbors <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>    suffix_neighbors <span class="op">=</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance)</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> suffix <span class="kw">in</span> suffix_neighbors:</span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], suffix) <span class="op">&lt;</span> max_distance:</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>            neighbors.update(base <span class="op">+</span> suffix <span class="cf">for</span> base <span class="kw">in</span> nucleotides)</span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>            neighbors.add(sequence[<span class="dv">0</span>] <span class="op">+</span> suffix)</span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbors</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>    sequence, distance <span class="op">=</span> input_data.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, <span class="bu">int</span>(distance)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a><span class="st">ACG</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>sequence, max_distance <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>neighbor_sequences <span class="op">=</span> generate_neighbors(sequence, max_distance)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(neighbor_sequences), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-motifenumeration" class="level1" data-number="14">
<h1 data-number="14"><span class="header-section-number">14</span> Implement MotifEnumeration</h1>
<p>Implanted Motif Problem. Implement MotifEnumeration (shown above) to find all (k, d)-motifs in a collection of strings.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;All (<em>k</em>,&nbsp;<em>d</em>)-motifs in&nbsp;<em>Dna</em>.</p>
<section id="sample-dataset-14" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="sample-dataset-14"><span class="header-section-number">14.1</span> Sample Dataset</h2>
<pre><code>3 1
ATTTGGC
TGCCTTA
CGGTATC
GAAAATT</code></pre>
</section>
<section id="sample-output-14" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="sample-output-14"><span class="header-section-number">14.2</span> Sample Output</h2>
<pre><code>ATA ATT GTT TTT</code></pre>
</section>
<section id="solution-14" class="level2" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="solution-14"><span class="header-section-number">14.3</span> Solution</h2>
<div class="sourceCode" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Iterator</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(c1 <span class="op">!=</span> c2 <span class="cf">for</span> c1, c2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_neighbors(sequence: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>, <span class="st">"C"</span>]</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> max_distance <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {sequence}</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(sequence) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">set</span>(nucleotides)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>    neighbor_set <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> generate_neighbors(sequence[<span class="dv">1</span>:], max_distance):</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_hamming_distance(sequence[<span class="dv">1</span>:], neighbor) <span class="op">&lt;</span> max_distance:</span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>                neighbor_set.add(nucleotide <span class="op">+</span> neighbor)</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a>            neighbor_set.add(sequence[<span class="dv">0</span>] <span class="op">+</span> neighbor)</span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> neighbor_set</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_kmers(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(kmer <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length))</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> contains_approximate_match(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">any</span>(calculate_hamming_distance(substring, pattern) <span class="op">&lt;=</span> max_distance</span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>               <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> enumerate_motifs(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, max_distance: <span class="bu">int</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a>    motif_patterns <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> get_all_kmers(dna_sequences, kmer_length):</span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor_kmer <span class="kw">in</span> generate_neighbors(kmer, max_distance):</span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(contains_approximate_match(neighbor_kmer, sequence, max_distance) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences):</span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>                motif_patterns.add(neighbor_kmer)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> motif_patterns</span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a><span class="st">3 1</span></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="st">ATTTGGC</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a><span class="st">TGCCTTA</span></span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="st">CGGTATC</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="st">GAAAATT</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a>input_params, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a>kmer_length, max_distance <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_params.split())</span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(enumerate_motifs(dna_sequences, kmer_length, max_distance)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-median-string" class="level1" data-number="15">
<h1 data-number="15"><span class="header-section-number">15</span> Find a Median String</h1>
<p>Median String Problem, Find a median string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>k</em>-mer&nbsp;<em>Pattern</em>&nbsp;that minimizes&nbsp;<em>d</em>(<em>Pattern</em>,&nbsp;<em>Dna</em>) over all&nbsp;<em>k</em>-mers&nbsp;<em>Pattern</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-15" class="level2" data-number="15.1">
<h2 data-number="15.1" class="anchored" data-anchor-id="sample-dataset-15"><span class="header-section-number">15.1</span> Sample Dataset</h2>
<pre><code>3
AAATTGACGCAT
GACGACCACGTT
CGTCAGCGCCTG
GCTGAGCACCGG
AGTACGGGACAG</code></pre>
</section>
<section id="sample-output-15" class="level2" data-number="15.2">
<h2 data-number="15.2" class="anchored" data-anchor-id="sample-output-15"><span class="header-section-number">15.2</span> Sample Output</h2>
<pre><code>ACG</code></pre>
</section>
<section id="solution-15" class="level2" data-number="15.3">
<h2 data-number="15.3" class="anchored" data-anchor-id="solution-15"><span class="header-section-number">15.3</span> Solution</h2>
<div class="sourceCode" id="cb48"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="st">""</span>.join(nucleotides) <span class="cf">for</span> nucleotides <span class="kw">in</span> product(<span class="st">"ACGT"</span>, repeat<span class="op">=</span>kmer_length))</span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb48-13"><a href="#cb48-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(nucleotide1 <span class="op">!=</span> nucleotide2 <span class="cf">for</span> nucleotide1, nucleotide2 <span class="kw">in</span> <span class="bu">zip</span>(sequence1, sequence2))</span>
<span id="cb48-14"><a href="#cb48-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-15"><a href="#cb48-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb48-16"><a href="#cb48-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(substring, pattern) <span class="cf">for</span> substring <span class="kw">in</span> generate_substrings(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb48-17"><a href="#cb48-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-18"><a href="#cb48-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_total_distance(pattern: <span class="bu">str</span>, dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb48-19"><a href="#cb48-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, sequence) <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences)</span>
<span id="cb48-20"><a href="#cb48-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-21"><a href="#cb48-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_median_string(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb48-22"><a href="#cb48-22" aria-hidden="true" tabindex="-1"></a>    min_distance <span class="op">=</span> math.inf</span>
<span id="cb48-23"><a href="#cb48-23" aria-hidden="true" tabindex="-1"></a>    median_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb48-24"><a href="#cb48-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-25"><a href="#cb48-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(kmer_length):</span>
<span id="cb48-26"><a href="#cb48-26" aria-hidden="true" tabindex="-1"></a>        current_distance <span class="op">=</span> calculate_total_distance(kmer, dna_sequences)</span>
<span id="cb48-27"><a href="#cb48-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_distance <span class="op">&lt;</span> min_distance:</span>
<span id="cb48-28"><a href="#cb48-28" aria-hidden="true" tabindex="-1"></a>            min_distance <span class="op">=</span> current_distance</span>
<span id="cb48-29"><a href="#cb48-29" aria-hidden="true" tabindex="-1"></a>            median_kmer <span class="op">=</span> kmer</span>
<span id="cb48-30"><a href="#cb48-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-31"><a href="#cb48-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> median_kmer</span>
<span id="cb48-32"><a href="#cb48-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-33"><a href="#cb48-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb48-34"><a href="#cb48-34" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb48-35"><a href="#cb48-35" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb48-36"><a href="#cb48-36" aria-hidden="true" tabindex="-1"></a><span class="st">AAATTGACGCAT</span></span>
<span id="cb48-37"><a href="#cb48-37" aria-hidden="true" tabindex="-1"></a><span class="st">GACGACCACGTT</span></span>
<span id="cb48-38"><a href="#cb48-38" aria-hidden="true" tabindex="-1"></a><span class="st">CGTCAGCGCCTG</span></span>
<span id="cb48-39"><a href="#cb48-39" aria-hidden="true" tabindex="-1"></a><span class="st">GCTGAGCACCGG</span></span>
<span id="cb48-40"><a href="#cb48-40" aria-hidden="true" tabindex="-1"></a><span class="st">AGTACGGGACAG</span></span>
<span id="cb48-41"><a href="#cb48-41" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb48-42"><a href="#cb48-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-43"><a href="#cb48-43" aria-hidden="true" tabindex="-1"></a>kmer_length, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb48-44"><a href="#cb48-44" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_median_string(dna_sequences, <span class="bu">int</span>(kmer_length))</span>
<span id="cb48-45"><a href="#cb48-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-profile-most-probable-k-mer-in-a-string" class="level1" data-number="16">
<h1 data-number="16"><span class="header-section-number">16</span> Find a Profile-most Probable k-mer in a String</h1>
<p>Profile-most Probable&nbsp;<em>k</em>-mer Problem, Find a Profile-most probable k-mer in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>, an integer&nbsp;<em>k</em>, and a 4 ×&nbsp;<em>k</em>&nbsp;matrix&nbsp;<em>Profile</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-16" class="level2" data-number="16.1">
<h2 data-number="16.1" class="anchored" data-anchor-id="sample-dataset-16"><span class="header-section-number">16.1</span> Sample Dataset</h2>
<pre><code>ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT
5
0.2 0.2 0.3 0.2 0.3
0.4 0.3 0.1 0.5 0.1
0.3 0.3 0.5 0.2 0.4
0.1 0.2 0.1 0.1 0.2</code></pre>
</section>
<section id="sample-output-16" class="level2" data-number="16.2">
<h2 data-number="16.2" class="anchored" data-anchor-id="sample-output-16"><span class="header-section-number">16.2</span> Sample Output</h2>
<pre><code>CCGAG</code></pre>
</section>
<section id="solution-16" class="level2" data-number="16.3">
<h2 data-number="16.3" class="anchored" data-anchor-id="solution-16"><span class="header-section-number">16.3</span> Solution</h2>
<div class="sourceCode" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_substrings(text: <span class="bu">str</span>, substring_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> text[i : i <span class="op">+</span> substring_length]</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_profile_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile_matrix: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>    nucleotide_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>    max_probability <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer <span class="op">=</span> <span class="st">""</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_substrings(sequence, kmer_length):</span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>        kmer_probability <span class="op">=</span> math.prod(profile_matrix[nucleotide_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="st">ACCTGTTTATTGCCTAAGTTCCGAACAAACCCAATATAGCCCGAGGGCCT</span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="st">0.2 0.2 0.3 0.2 0.3</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.3 0.1 0.5 0.1</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="st">0.3 0.3 0.5 0.2 0.4</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="st">0.1 0.2 0.1 0.1 0.2</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a>dna_sequence, kmer_length, <span class="op">*</span>profile_rows <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a>profile_matrix <span class="op">=</span> [<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> profile_rows]</span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_profile_most_probable_kmer(dna_sequence, <span class="bu">int</span>(kmer_length), profile_matrix)</span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedymotifsearch" class="level1" data-number="17">
<h1 data-number="17"><span class="header-section-number">17</span> Implement GreedyMotifSearch</h1>
<p>Implement, GreedyMotifSearch.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection of strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GreedyMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>). If at any step you find more than one&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in a given string, use the one occurring first.</p>
<section id="sample-dataset-17" class="level2" data-number="17.1">
<h2 data-number="17.1" class="anchored" data-anchor-id="sample-dataset-17"><span class="header-section-number">17.1</span> Sample Dataset</h2>
<pre><code>3 5
GGCGTTCAGGCA
AAGAATCAGTCA
CAAGGAGTTCGC
CACGTCAATCAC
CAATAATATTCG</code></pre>
</section>
<section id="sample-output-17" class="level2" data-number="17.2">
<h2 data-number="17.2" class="anchored" data-anchor-id="sample-output-17"><span class="header-section-number">17.2</span> Sample Output</h2>
<pre><code>CAG
CAG
CAA
CAA
CAA</code></pre>
</section>
<section id="solution-17" class="level2" data-number="17.3">
<h2 data-number="17.3" class="anchored" data-anchor-id="solution-17"><span class="header-section-number">17.3</span> Solution</h2>
<div class="sourceCode" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>    max_probability: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a>    most_probable_kmer: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length):</span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a>        kmer_probability: <span class="bu">float</span> <span class="op">=</span> math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> kmer_probability <span class="op">&gt;</span> max_probability:</span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a>            max_probability <span class="op">=</span> kmer_probability</span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a>            most_probable_kmer <span class="op">=</span> kmer</span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> most_probable_kmer</span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(sequences: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a>    profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> [[] <span class="cf">for</span> _ <span class="kw">in</span> nucleotides]</span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(nucleotides):</span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a>        profile[i] <span class="op">=</span> [</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> sequences) <span class="op">+</span> pseudocount) <span class="op">/</span> <span class="bu">len</span>(sequences)</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequences[<span class="dv">0</span>]))</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>])):</span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a>        column: List[<span class="bu">str</span>] <span class="op">=</span> [motif[i] <span class="cf">for</span> motif <span class="kw">in</span> motifs]</span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>        most_common: <span class="bu">str</span> <span class="op">=</span> Counter(column).most_common()[<span class="dv">0</span>][<span class="dv">0</span>]</span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">sum</span>(nucleotide <span class="op">!=</span> most_common <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb54-41"><a href="#cb54-41" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [seq[:kmer_length] <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb54-42"><a href="#cb54-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(dna_sequences)):</span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a>            current_profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount<span class="op">=</span>pseudocount)</span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(dna_sequences[i], kmer_length, current_profile))</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb54-54"><a href="#cb54-54" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb54-55"><a href="#cb54-55" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a>ints, <span class="op">*</span>dna <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>k, t <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, ints.split())</span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna, k)</span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedymotifsearch-with-pseudocounts" class="level1" data-number="18">
<h1 data-number="18"><span class="header-section-number">18</span> Implement GreedyMotifSearch with Pseudocounts</h1>
<p>Implement.&nbsp;<em>GreedyMotifSearch</em>&nbsp;with Pseudocounts.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection of strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GreedyMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>) with pseudocounts. If at any step you find more than one&nbsp;<em>Profile</em>-most probable&nbsp;<em>k</em>-mer in a given string, use the one occurring first.</p>
<section id="sample-dataset-18" class="level2" data-number="18.1">
<h2 data-number="18.1" class="anchored" data-anchor-id="sample-dataset-18"><span class="header-section-number">18.1</span> Sample Dataset</h2>
<pre><code>3 5
GGCGTTCAGGCA
AAGAATCAGTCA
CAAGGAGTTCGC
CACGTCAATCAC
CAATAATATTCG</code></pre>
</section>
<section id="sample-output-18" class="level2" data-number="18.2">
<h2 data-number="18.2" class="anchored" data-anchor-id="sample-output-18"><span class="header-section-number">18.2</span> Sample Output</h2>
<pre><code>TTC
ATC
TTC
ATC
TTC</code></pre>
</section>
<section id="solution-18" class="level2" data-number="18.3">
<h2 data-number="18.3" class="anchored" data-anchor-id="solution-18"><span class="header-section-number">18.3</span> Solution</h2>
<div class="sourceCode" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator, List, Dict</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb57-13"><a href="#cb57-13" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][position]</span>
<span id="cb57-14"><a href="#cb57-14" aria-hidden="true" tabindex="-1"></a>                                   <span class="cf">for</span> position, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb57-15"><a href="#cb57-15" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-16"><a href="#cb57-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-17"><a href="#cb57-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb57-18"><a href="#cb57-18" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb57-19"><a href="#cb57-19" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb57-20"><a href="#cb57-20" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb57-21"><a href="#cb57-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-22"><a href="#cb57-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb57-23"><a href="#cb57-23" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> motif_count</span>
<span id="cb57-24"><a href="#cb57-24" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb57-25"><a href="#cb57-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb57-26"><a href="#cb57-26" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb57-27"><a href="#cb57-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-28"><a href="#cb57-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb57-29"><a href="#cb57-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb57-30"><a href="#cb57-30" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb57-31"><a href="#cb57-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb57-32"><a href="#cb57-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb57-33"><a href="#cb57-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-34"><a href="#cb57-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb57-35"><a href="#cb57-35" aria-hidden="true" tabindex="-1"></a>    best_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [sequence[:kmer_length] <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences]</span>
<span id="cb57-36"><a href="#cb57-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-37"><a href="#cb57-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequences[<span class="dv">0</span>], kmer_length):</span>
<span id="cb57-38"><a href="#cb57-38" aria-hidden="true" tabindex="-1"></a>        current_motifs: List[<span class="bu">str</span>] <span class="op">=</span> [kmer]</span>
<span id="cb57-39"><a href="#cb57-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> sequence <span class="kw">in</span> dna_sequences[<span class="dv">1</span>:]:</span>
<span id="cb57-40"><a href="#cb57-40" aria-hidden="true" tabindex="-1"></a>            profile: List[List[<span class="bu">float</span>]] <span class="op">=</span> create_profile(current_motifs, pseudocount)</span>
<span id="cb57-41"><a href="#cb57-41" aria-hidden="true" tabindex="-1"></a>            current_motifs.append(find_most_probable_kmer(sequence, kmer_length, profile))</span>
<span id="cb57-42"><a href="#cb57-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-43"><a href="#cb57-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(current_motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb57-44"><a href="#cb57-44" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> current_motifs</span>
<span id="cb57-45"><a href="#cb57-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-46"><a href="#cb57-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb57-47"><a href="#cb57-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-48"><a href="#cb57-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb57-49"><a href="#cb57-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb57-50"><a href="#cb57-50" aria-hidden="true" tabindex="-1"></a><span class="st">3 5</span></span>
<span id="cb57-51"><a href="#cb57-51" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGTTCAGGCA</span></span>
<span id="cb57-52"><a href="#cb57-52" aria-hidden="true" tabindex="-1"></a><span class="st">AAGAATCAGTCA</span></span>
<span id="cb57-53"><a href="#cb57-53" aria-hidden="true" tabindex="-1"></a><span class="st">CAAGGAGTTCGC</span></span>
<span id="cb57-54"><a href="#cb57-54" aria-hidden="true" tabindex="-1"></a><span class="st">CACGTCAATCAC</span></span>
<span id="cb57-55"><a href="#cb57-55" aria-hidden="true" tabindex="-1"></a><span class="st">CAATAATATTCG</span></span>
<span id="cb57-56"><a href="#cb57-56" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb57-57"><a href="#cb57-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-58"><a href="#cb57-58" aria-hidden="true" tabindex="-1"></a>k_value, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb57-59"><a href="#cb57-59" aria-hidden="true" tabindex="-1"></a>k_value <span class="op">=</span> <span class="bu">int</span>(k_value)</span>
<span id="cb57-60"><a href="#cb57-60" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> greedy_motif_search(dna_sequences, k_value, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb57-61"><a href="#cb57-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-randomizedmotifsearch" class="level1" data-number="19">
<h1 data-number="19"><span class="header-section-number">19</span> Implement RandomizedMotifSearch</h1>
<p>Implement&nbsp;<em>RandomizedMotifSearch</em>.</p>
<p>Given:&nbsp;Positive integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>t</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;A collection&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>RandomizedMotifSearch</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>) 1000 times. Remember to use pseudocounts!</p>
<section id="sample-dataset-19" class="level2" data-number="19.1">
<h2 data-number="19.1" class="anchored" data-anchor-id="sample-dataset-19"><span class="header-section-number">19.1</span> Sample Dataset</h2>
<pre><code>8 5
CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA
GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG
TAGTACCGAGACCGAAAGAAGTATACAGGCGT
TAGATCAAGTTTCAGGTGCACGTCGGTGAACC
AATCCACCAGCTCCACGTGCAATGTTGGCCTA</code></pre>
</section>
<section id="sample-output-19" class="level2" data-number="19.2">
<h2 data-number="19.2" class="anchored" data-anchor-id="sample-output-19"><span class="header-section-number">19.2</span> Sample Output</h2>
<pre><code>AACGGCCA
AAGTGCCA
TAGTACCG
AAGTTTCA
ACGTGCAA</code></pre>
</section>
<section id="solution-19" class="level2" data-number="19.3">
<h2 data-number="19.3" class="anchored" data-anchor-id="solution-19"><span class="header-section-number">19.3</span> Solution</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Callable</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> randint</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [sequence[i:i<span class="op">+</span>kmer_length] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_most_probable_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb60-11"><a href="#cb60-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(</span>
<span id="cb60-12"><a href="#cb60-12" aria-hidden="true" tabindex="-1"></a>        generate_kmers(sequence, kmer_length),</span>
<span id="cb60-13"><a href="#cb60-13" aria-hidden="true" tabindex="-1"></a>        key<span class="op">=</span><span class="kw">lambda</span> kmer: math.prod(profile[nucleotide_to_index[nucleotide]][j] <span class="cf">for</span> j, nucleotide <span class="kw">in</span> <span class="bu">enumerate</span>(kmer))</span>
<span id="cb60-14"><a href="#cb60-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-15"><a href="#cb60-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-16"><a href="#cb60-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb60-17"><a href="#cb60-17" aria-hidden="true" tabindex="-1"></a>    nucleotides <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb60-18"><a href="#cb60-18" aria-hidden="true" tabindex="-1"></a>    profile <span class="op">=</span> []</span>
<span id="cb60-19"><a href="#cb60-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides:</span>
<span id="cb60-20"><a href="#cb60-20" aria-hidden="true" tabindex="-1"></a>        profile.append([</span>
<span id="cb60-21"><a href="#cb60-21" aria-hidden="true" tabindex="-1"></a>            (<span class="bu">sum</span>(seq[j] <span class="op">==</span> nucleotide <span class="cf">for</span> seq <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (<span class="bu">len</span>(motifs) <span class="op">+</span> <span class="dv">4</span> <span class="op">*</span> pseudocount)</span>
<span id="cb60-22"><a href="#cb60-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(motifs[<span class="dv">0</span>]))</span>
<span id="cb60-23"><a href="#cb60-23" aria-hidden="true" tabindex="-1"></a>        ])</span>
<span id="cb60-24"><a href="#cb60-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> profile</span>
<span id="cb60-25"><a href="#cb60-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-26"><a href="#cb60-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb60-27"><a href="#cb60-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb60-28"><a href="#cb60-28" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb60-29"><a href="#cb60-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb60-30"><a href="#cb60-30" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb60-31"><a href="#cb60-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-32"><a href="#cb60-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb60-33"><a href="#cb60-33" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb60-34"><a href="#cb60-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start : start <span class="op">+</span> kmer_length]</span>
<span id="cb60-35"><a href="#cb60-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-36"><a href="#cb60-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_motifs(profile: List[List[<span class="bu">float</span>]], dna_sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb60-37"><a href="#cb60-37" aria-hidden="true" tabindex="-1"></a>    kmer_length <span class="op">=</span> <span class="bu">len</span>(profile[<span class="dv">0</span>])</span>
<span id="cb60-38"><a href="#cb60-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [find_most_probable_kmer(seq, kmer_length, profile) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb60-39"><a href="#cb60-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-40"><a href="#cb60-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> randomized_motif_search(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb60-41"><a href="#cb60-41" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb60-42"><a href="#cb60-42" aria-hidden="true" tabindex="-1"></a>    best_score <span class="op">=</span> math.inf</span>
<span id="cb60-43"><a href="#cb60-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-44"><a href="#cb60-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="va">True</span>:</span>
<span id="cb60-45"><a href="#cb60-45" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs, pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb60-46"><a href="#cb60-46" aria-hidden="true" tabindex="-1"></a>        motifs <span class="op">=</span> find_motifs(profile, dna_sequences)</span>
<span id="cb60-47"><a href="#cb60-47" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> calculate_score(motifs)</span>
<span id="cb60-48"><a href="#cb60-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-49"><a href="#cb60-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;=</span> best_score:</span>
<span id="cb60-50"><a href="#cb60-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> best_score, motifs</span>
<span id="cb60-51"><a href="#cb60-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-52"><a href="#cb60-52" aria-hidden="true" tabindex="-1"></a>        best_score <span class="op">=</span> current_score</span>
<span id="cb60-53"><a href="#cb60-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-54"><a href="#cb60-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb60-55"><a href="#cb60-55" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb60-56"><a href="#cb60-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-57"><a href="#cb60-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb60-58"><a href="#cb60-58" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb60-59"><a href="#cb60-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb60-60"><a href="#cb60-60" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb60-61"><a href="#cb60-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-62"><a href="#cb60-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb60-63"><a href="#cb60-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-64"><a href="#cb60-64" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb60-65"><a href="#cb60-65" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb60-66"><a href="#cb60-66" aria-hidden="true" tabindex="-1"></a><span class="st">8 5</span></span>
<span id="cb60-67"><a href="#cb60-67" aria-hidden="true" tabindex="-1"></a><span class="st">CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA</span></span>
<span id="cb60-68"><a href="#cb60-68" aria-hidden="true" tabindex="-1"></a><span class="st">GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG</span></span>
<span id="cb60-69"><a href="#cb60-69" aria-hidden="true" tabindex="-1"></a><span class="st">TAGTACCGAGACCGAAAGAAGTATACAGGCGT</span></span>
<span id="cb60-70"><a href="#cb60-70" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATCAAGTTTCAGGTGCACGTCGGTGAACC</span></span>
<span id="cb60-71"><a href="#cb60-71" aria-hidden="true" tabindex="-1"></a><span class="st">AATCCACCAGCTCCACGTGCAATGTTGGCCTA</span></span>
<span id="cb60-72"><a href="#cb60-72" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb60-73"><a href="#cb60-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-74"><a href="#cb60-74" aria-hidden="true" tabindex="-1"></a>kmer_length, _, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb60-75"><a href="#cb60-75" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb60-76"><a href="#cb60-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-77"><a href="#cb60-77" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(randomized_motif_search, <span class="dv">1000</span>, dna_sequences, kmer_length)</span>
<span id="cb60-78"><a href="#cb60-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-gibbssampler" class="level1" data-number="20">
<h1 data-number="20"><span class="header-section-number">20</span> Implement GibbsSampler</h1>
<p>Implement,&nbsp;<em>GibbsSampler</em>.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>,&nbsp;<em>t</em>, and&nbsp;<em>N</em>, followed by a collection of strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;The strings&nbsp;<em>BestMotifs</em>&nbsp;resulting from running&nbsp;<em>GibbsSampler</em>(<em>Dna</em>,&nbsp;<em>k</em>,&nbsp;<em>t</em>,&nbsp;<em>N</em>) with 20 random starts. Remember to use pseudocounts!</p>
<section id="sample-dataset-20" class="level2" data-number="20.1">
<h2 data-number="20.1" class="anchored" data-anchor-id="sample-dataset-20"><span class="header-section-number">20.1</span> Sample Dataset</h2>
<pre><code>8 5 100
CGCCCCTCTCGGGGGTGTTCAGTAAACGGCCA
GGGCGAGGTATGTGTAAGTGCCAAGGTGCCAG
TAGTACCGAGACCGAAAGAAGTATACAGGCGT
TAGATCAAGTTTCAGGTGCACGTCGGTGAACC
AATCCACCAGCTCCACGTGCAATGTTGGCCTA</code></pre>
</section>
<section id="sample-output-20" class="level2" data-number="20.2">
<h2 data-number="20.2" class="anchored" data-anchor-id="sample-output-20"><span class="header-section-number">20.2</span> Sample Output</h2>
<pre><code>TCTCGGGG
CCAAGGTG
TACAGGCG
TTCAGGTG
TCCACGTG</code></pre>
</section>
<section id="solution-20" class="level2" data-number="20.3">
<h2 data-number="20.3" class="anchored" data-anchor-id="solution-20"><span class="header-section-number">20.3</span> Solution</h2>
<div class="sourceCode" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, Tuple, Callable</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> Counter</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> random</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_profile(motifs: List[<span class="bu">str</span>], pseudocount: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>    nucleotides: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]</span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>    motif_count: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs)</span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>    motif_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(motifs[<span class="dv">0</span>])</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a>        [(<span class="bu">sum</span>(motif[position] <span class="op">==</span> nucleotide <span class="cf">for</span> motif <span class="kw">in</span> motifs) <span class="op">+</span> pseudocount) <span class="op">/</span> (motif_count <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>pseudocount)</span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>         <span class="cf">for</span> position <span class="kw">in</span> <span class="bu">range</span>(motif_length)]</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> nucleotide <span class="kw">in</span> nucleotides</span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(motifs: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>        <span class="bu">sum</span>(nucleotide <span class="op">!=</span> Counter(column).most_common(<span class="dv">1</span>)[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> nucleotide <span class="kw">in</span> column)</span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> column <span class="kw">in</span> <span class="bu">zip</span>(<span class="op">*</span>motifs)</span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb63-28"><a href="#cb63-28" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length)</span>
<span id="cb63-29"><a href="#cb63-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb63-30"><a href="#cb63-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-31"><a href="#cb63-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_best_motifs(search_function: Callable, iterations: <span class="bu">int</span>, <span class="op">*</span>args) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb63-32"><a href="#cb63-32" aria-hidden="true" tabindex="-1"></a>    best_score, best_motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb63-33"><a href="#cb63-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(iterations <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb63-34"><a href="#cb63-34" aria-hidden="true" tabindex="-1"></a>        score, motifs <span class="op">=</span> search_function(<span class="op">*</span>args)</span>
<span id="cb63-35"><a href="#cb63-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&lt;</span> best_score:</span>
<span id="cb63-36"><a href="#cb63-36" aria-hidden="true" tabindex="-1"></a>            best_score, best_motifs <span class="op">=</span> score, motifs</span>
<span id="cb63-37"><a href="#cb63-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_motifs</span>
<span id="cb63-38"><a href="#cb63-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-39"><a href="#cb63-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_kmer_probabilities(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb63-40"><a href="#cb63-40" aria-hidden="true" tabindex="-1"></a>    nucleotide_to_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {<span class="st">"A"</span>: <span class="dv">0</span>, <span class="st">"C"</span>: <span class="dv">1</span>, <span class="st">"G"</span>: <span class="dv">2</span>, <span class="st">"T"</span>: <span class="dv">3</span>}</span>
<span id="cb63-41"><a href="#cb63-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [</span>
<span id="cb63-42"><a href="#cb63-42" aria-hidden="true" tabindex="-1"></a>        math.prod(profile[nucleotide_to_index[kmer[j]]][j] <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(kmer_length))</span>
<span id="cb63-43"><a href="#cb63-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(sequence, kmer_length)</span>
<span id="cb63-44"><a href="#cb63-44" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb63-45"><a href="#cb63-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-46"><a href="#cb63-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> select_random_kmer(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>, profile: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb63-47"><a href="#cb63-47" aria-hidden="true" tabindex="-1"></a>    probabilities <span class="op">=</span> calculate_kmer_probabilities(sequence, kmer_length, profile)</span>
<span id="cb63-48"><a href="#cb63-48" aria-hidden="true" tabindex="-1"></a>    start_index <span class="op">=</span> random.choices(<span class="bu">range</span>(<span class="bu">len</span>(probabilities)), probabilities)[<span class="dv">0</span>]</span>
<span id="cb63-49"><a href="#cb63-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[start_index : start_index <span class="op">+</span> kmer_length]</span>
<span id="cb63-50"><a href="#cb63-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-51"><a href="#cb63-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gibbs_sampler(dna_sequences: List[<span class="bu">str</span>], kmer_length: <span class="bu">int</span>, num_iterations: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb63-52"><a href="#cb63-52" aria-hidden="true" tabindex="-1"></a>    motifs <span class="op">=</span> [generate_random_kmer(seq, kmer_length) <span class="cf">for</span> seq <span class="kw">in</span> dna_sequences]</span>
<span id="cb63-53"><a href="#cb63-53" aria-hidden="true" tabindex="-1"></a>    best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb63-54"><a href="#cb63-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_iterations):</span>
<span id="cb63-55"><a href="#cb63-55" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> random.randint(<span class="dv">0</span>, <span class="bu">len</span>(dna_sequences) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb63-56"><a href="#cb63-56" aria-hidden="true" tabindex="-1"></a>        profile <span class="op">=</span> create_profile(motifs[:i] <span class="op">+</span> motifs[i <span class="op">+</span> <span class="dv">1</span> :], pseudocount<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb63-57"><a href="#cb63-57" aria-hidden="true" tabindex="-1"></a>        motifs[i] <span class="op">=</span> select_random_kmer(dna_sequences[i], kmer_length, profile)</span>
<span id="cb63-58"><a href="#cb63-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> calculate_score(motifs) <span class="op">&lt;</span> calculate_score(best_motifs):</span>
<span id="cb63-59"><a href="#cb63-59" aria-hidden="true" tabindex="-1"></a>            best_motifs <span class="op">=</span> motifs.copy()</span>
<span id="cb63-60"><a href="#cb63-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> calculate_score(best_motifs), best_motifs</span>
<span id="cb63-61"><a href="#cb63-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-62"><a href="#cb63-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb63-63"><a href="#cb63-63" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb63-64"><a href="#cb63-64" aria-hidden="true" tabindex="-1"></a><span class="st">8 5 100</span></span>
<span id="cb63-65"><a href="#cb63-65" aria-hidden="true" tabindex="-1"></a><span class="st">TCTCGGGG</span></span>
<span id="cb63-66"><a href="#cb63-66" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGGTG</span></span>
<span id="cb63-67"><a href="#cb63-67" aria-hidden="true" tabindex="-1"></a><span class="st">TACAGGCG</span></span>
<span id="cb63-68"><a href="#cb63-68" aria-hidden="true" tabindex="-1"></a><span class="st">TTCAGGTG</span></span>
<span id="cb63-69"><a href="#cb63-69" aria-hidden="true" tabindex="-1"></a><span class="st">TCCACGTG</span></span>
<span id="cb63-70"><a href="#cb63-70" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb63-71"><a href="#cb63-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-72"><a href="#cb63-72" aria-hidden="true" tabindex="-1"></a>kmer_length, num_sequences, num_iterations, <span class="op">*</span>dna_sequences <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb63-73"><a href="#cb63-73" aria-hidden="true" tabindex="-1"></a>kmer_length <span class="op">=</span> <span class="bu">int</span>(kmer_length)</span>
<span id="cb63-74"><a href="#cb63-74" aria-hidden="true" tabindex="-1"></a>num_iterations <span class="op">=</span> <span class="bu">int</span>(num_iterations)</span>
<span id="cb63-75"><a href="#cb63-75" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_best_motifs(gibbs_sampler, <span class="dv">20</span>, dna_sequences, kmer_length, num_iterations)</span>
<span id="cb63-76"><a href="#cb63-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>result, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-distancebetweenpatternandstrings" class="level1" data-number="21">
<h1 data-number="21"><span class="header-section-number">21</span> Implement DistanceBetweenPatternAndStrings</h1>
<p>Compute DistanceBetweenPatternAndStrings. <em>Find the distance between a pattern and a set of strings.</em>.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Pattern</em>&nbsp;and a collection of DNA strings&nbsp;<em>Dna</em>.</p>
<p>Return:&nbsp;<em>DistanceBetweenPatternAndStrings</em>(<em>Pattern</em>,&nbsp;<em>Dna</em>).</p>
<section id="sample-dataset-21" class="level2" data-number="21.1">
<h2 data-number="21.1" class="anchored" data-anchor-id="sample-dataset-21"><span class="header-section-number">21.1</span> Sample Dataset</h2>
<pre><code>AAA
TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</code></pre>
</section>
<section id="sample-output-21" class="level2" data-number="21.2">
<h2 data-number="21.2" class="anchored" data-anchor-id="sample-output-21"><span class="header-section-number">21.2</span> Sample Output</h2>
<pre><code>5</code></pre>
</section>
<section id="solution-21" class="level2" data-number="21.3">
<h2 data-number="21.3" class="anchored" data-anchor-id="solution-21"><span class="header-section-number">21.3</span> Solution</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i : i <span class="op">+</span> kmer_length]</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hamming_distance(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(base1 <span class="op">!=</span> base2 <span class="cf">for</span> base1, base2 <span class="kw">in</span> <span class="bu">zip</span>(seq1, seq2))</span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_minimum_distance(pattern: <span class="bu">str</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(calculate_hamming_distance(kmer, pattern) <span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(text, <span class="bu">len</span>(pattern)))</span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_pattern_distance_to_strings(pattern: <span class="bu">str</span>, dna_strings: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(find_minimum_distance(pattern, dna_string) <span class="cf">for</span> dna_string <span class="kw">in</span> dna_strings)</span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb66-18"><a href="#cb66-18" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb66-19"><a href="#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb66-20"><a href="#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="st">TTACCTTAAC GATATCTGTC ACGGCGTTCG CCCTAAAGAG CGTCAGAGGT</span></span>
<span id="cb66-21"><a href="#cb66-21" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb66-22"><a href="#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="#cb66-23" aria-hidden="true" tabindex="-1"></a>pattern, dna_strings_raw <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb66-24"><a href="#cb66-24" aria-hidden="true" tabindex="-1"></a>dna_strings <span class="op">=</span> dna_strings_raw.split()</span>
<span id="cb66-25"><a href="#cb66-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-26"><a href="#cb66-26" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_pattern_distance_to_strings(pattern, dna_strings)</span>
<span id="cb66-27"><a href="#cb66-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-k-mer-composition-of-a-string" class="level1" data-number="22">
<h1 data-number="22"><span class="header-section-number">22</span> Generate the k-mer Composition of a String</h1>
<p>String Composition Problem, Generate the k-mer composition of a string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;*Composition__k<em>(</em>Text<em>) (the&nbsp;</em>k*-mers can be provided in any order).</p>
<section id="sample-dataset-22" class="level2" data-number="22.1">
<h2 data-number="22.1" class="anchored" data-anchor-id="sample-dataset-22"><span class="header-section-number">22.1</span> Sample Dataset</h2>
<pre><code>5
CAATCCAAC</code></pre>
</section>
<section id="sample-output-22" class="level2" data-number="22.2">
<h2 data-number="22.2" class="anchored" data-anchor-id="sample-output-22"><span class="header-section-number">22.2</span> Sample Output</h2>
<pre><code>CAATC
AATCC
ATCCA
TCCAA
CCAAC</code></pre>
</section>
<section id="solution-22" class="level2" data-number="22.3">
<h2 data-number="22.3" class="anchored" data-anchor-id="solution-22"><span class="header-section-number">22.3</span> Solution</h2>
<div class="sourceCode" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Iterator</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_kmers(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> sequence[i:i <span class="op">+</span> kmer_length]</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="st">CAATCCAAC</span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>input_lines: <span class="bu">list</span>[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> generate_kmers(dna_sequence, kmer_length):</span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(kmer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-genome-path" class="level1" data-number="23">
<h1 data-number="23"><span class="header-section-number">23</span> Reconstruct a String from its Genome Path</h1>
<p>String Spelled by a Genome Path Problem, Find the string spelled by a genome path.</p>
<p>Given:&nbsp;A sequence of&nbsp;<em>k</em>-mers&nbsp;<em>Pattern1,…, Patternn</em>&nbsp;such that the last&nbsp;<em>k - 1</em>&nbsp;symbols of&nbsp;<em>Patterni</em>&nbsp;are equal to the first&nbsp;<em>k - 1</em>&nbsp;symbols of&nbsp;<em>Patterni+1</em>&nbsp;for&nbsp;<em>i</em>&nbsp;from 1 to n-1.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;of length&nbsp;<em>k+n-1</em>&nbsp;where the&nbsp;<em>i</em>-th&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>&nbsp;is equal to&nbsp;<em>Patterni</em>&nbsp;for all&nbsp;<em>i</em>.</p>
<section id="sample-dataset-23" class="level2" data-number="23.1">
<h2 data-number="23.1" class="anchored" data-anchor-id="sample-dataset-23"><span class="header-section-number">23.1</span> Sample Dataset</h2>
<pre><code>ACCGA
CCGAA
CGAAG
GAAGC
AAGCT</code></pre>
</section>
<section id="sample-output-23" class="level2" data-number="23.2">
<h2 data-number="23.2" class="anchored" data-anchor-id="sample-output-23"><span class="header-section-number">23.2</span> Sample Output</h2>
<pre><code>ACCGAAGCT</code></pre>
</section>
<section id="solution-23" class="level2" data-number="23.3">
<h2 data-number="23.3" class="anchored" data-anchor-id="solution-23"><span class="header-section-number">23.3</span> Solution</h2>
<div class="sourceCode" id="cb72"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_dna_sequence(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>    reconstructed_sequence: <span class="bu">str</span> <span class="op">=</span> kmers[<span class="dv">0</span>]</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(kmers)):</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>        reconstructed_sequence <span class="op">+=</span> kmers[i][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_sequence</span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a><span class="st">ACCGA</span></span>
<span id="cb72-11"><a href="#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="st">CCGAA</span></span>
<span id="cb72-12"><a href="#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="st">CGAAG</span></span>
<span id="cb72-13"><a href="#cb72-13" aria-hidden="true" tabindex="-1"></a><span class="st">GAAGC</span></span>
<span id="cb72-14"><a href="#cb72-14" aria-hidden="true" tabindex="-1"></a><span class="st">AAGCT</span></span>
<span id="cb72-15"><a href="#cb72-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb72-16"><a href="#cb72-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-17"><a href="#cb72-17" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb72-18"><a href="#cb72-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_dna_sequence(kmer_list))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-overlap-graph-of-a-collection-of-k-mers" class="level1" data-number="24">
<h1 data-number="24"><span class="header-section-number">24</span> Construct the Overlap Graph of a Collection of k-mers</h1>
<p>Overlap Graph Problem, Construct the overlap graph of a collection of k-mers.</p>
<p>Given:&nbsp;A collection&nbsp;<em>Patterns</em>&nbsp;of&nbsp;<em>k</em>-mers.</p>
<p>Return:&nbsp;The overlap graph&nbsp;<em>Overlap</em>(<em>Patterns</em>), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-24" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="sample-dataset-24"><span class="header-section-number">24.1</span> Sample Dataset</h2>
<pre><code>ATGCG
GCATG
CATGC
AGGCA
GGCAT</code></pre>
</section>
<section id="sample-output-24" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="sample-output-24"><span class="header-section-number">24.2</span> Sample Output</h2>
<pre><code>GCATG -&gt; CATGC
CATGC -&gt; ATGCG
AGGCA -&gt; GGCAT
GGCAT -&gt; GCATG</code></pre>
</section>
<section id="solution-24" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="solution-24"><span class="header-section-number">24.3</span> Solution</h2>
<div class="sourceCode" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> overlap_graph(patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">tuple</span>[<span class="bu">str</span>, <span class="bu">str</span>]]:</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>    adj_list <span class="op">=</span> []</span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(patterns)):</span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j <span class="kw">and</span> patterns[i][<span class="dv">1</span>:] <span class="op">==</span> patterns[j][:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>                adj_list.append((patterns[i], patterns[j]))</span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adj_list</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="st">ATGCG</span></span>
<span id="cb75-13"><a href="#cb75-13" aria-hidden="true" tabindex="-1"></a><span class="st">GCATG</span></span>
<span id="cb75-14"><a href="#cb75-14" aria-hidden="true" tabindex="-1"></a><span class="st">CATGC</span></span>
<span id="cb75-15"><a href="#cb75-15" aria-hidden="true" tabindex="-1"></a><span class="st">AGGCA</span></span>
<span id="cb75-16"><a href="#cb75-16" aria-hidden="true" tabindex="-1"></a><span class="st">GGCAT</span></span>
<span id="cb75-17"><a href="#cb75-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb75-18"><a href="#cb75-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-19"><a href="#cb75-19" aria-hidden="true" tabindex="-1"></a>Patterns: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb75-20"><a href="#cb75-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-21"><a href="#cb75-21" aria-hidden="true" tabindex="-1"></a>adj_list <span class="op">=</span> overlap_graph(Patterns)</span>
<span id="cb75-22"><a href="#cb75-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> adj_list:</span>
<span id="cb75-23"><a href="#cb75-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>edge[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span>edge[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-de-bruijn-graph-of-a-string" class="level1" data-number="25">
<h1 data-number="25"><span class="header-section-number">25</span> Construct the De Bruijn Graph of a String</h1>
<p>De Bruijn Graph from a String Problem. Construct the de Bruijn graph of a string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and a string&nbsp;<em>Text</em>.</p>
<p>Return:*DeBruijn__k<em>(</em>Text*), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-25" class="level2" data-number="25.1">
<h2 data-number="25.1" class="anchored" data-anchor-id="sample-dataset-25"><span class="header-section-number">25.1</span> Sample Dataset</h2>
<pre><code>4
AAGATTCTCTAC</code></pre>
</section>
<section id="sample-output-25" class="level2" data-number="25.2">
<h2 data-number="25.2" class="anchored" data-anchor-id="sample-output-25"><span class="header-section-number">25.2</span> Sample Output</h2>
<pre><code>AAG -&gt; AGA
AGA -&gt; GAT
ATT -&gt; TTC
CTA -&gt; TAC
CTC -&gt; TCT
GAT -&gt; ATT
TCT -&gt; CTA,CTC
TTC -&gt; TCT</code></pre>
</section>
<section id="solution-25" class="level2" data-number="25.3">
<h2 data-number="25.3" class="anchored" data-anchor-id="solution-25"><span class="header-section-number">25.3</span> Solution</h2>
<div class="sourceCode" id="cb78"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> OrderedDict</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, OrderedDict <span class="im">as</span> OrderedDictType</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(sequence: <span class="bu">str</span>, kmer_length: <span class="bu">int</span>) <span class="op">-&gt;</span> OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]]:</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>    adjacency_list: OrderedDictType[<span class="bu">str</span>, Set[<span class="bu">str</span>]] <span class="op">=</span> OrderedDict()</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">2</span>):</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>        adjacency_list[sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> sequence[i:i <span class="op">+</span> kmer_length <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> sequence[i <span class="op">+</span> <span class="dv">1</span>:i <span class="op">+</span> kmer_length]</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a>        adjacency_list[prefix].add(suffix)</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a><span class="st">AAGATTCTCTAC</span></span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a>dna_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(dna_sequence, kmer_length)</span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> neighbors:</span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-de-bruijn-graph-of-a-collection-of-k-mers" class="level1" data-number="26">
<h1 data-number="26"><span class="header-section-number">26</span> Construct the De Bruijn Graph of a Collection of k-mers</h1>
<p>De Bruijn Graph from&nbsp;<em>k</em>-mers Problem. Construct the de Bruijn graph from a collection of k-mers.</p>
<p>Given:&nbsp;A collection of&nbsp;<em>k</em>-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;The de Bruijn graph&nbsp;<em>DeBruijn</em>(<em>Patterns</em>), in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<section id="sample-dataset-26" class="level2" data-number="26.1">
<h2 data-number="26.1" class="anchored" data-anchor-id="sample-dataset-26"><span class="header-section-number">26.1</span> Sample Dataset</h2>
<pre><code>GAGG
CAGG
GGGG
GGGA
CAGG
AGGG
GGAG</code></pre>
</section>
<section id="sample-output-26" class="level2" data-number="26.2">
<h2 data-number="26.2" class="anchored" data-anchor-id="sample-output-26"><span class="header-section-number">26.2</span> Sample Output</h2>
<pre><code>GAG -&gt; AGG
CAG -&gt; AGG,AGG
GGG -&gt; GGG,GGA
AGG -&gt; GGG
GGA -&gt; GAG</code></pre>
</section>
<section id="solution-26" class="level2" data-number="26.3">
<h2 data-number="26.3" class="anchored" data-anchor-id="solution-26"><span class="header-section-number">26.3</span> Solution</h2>
<div class="sourceCode" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>    adjacency_list: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_list:</span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>            adjacency_list[prefix].append(suffix)</span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="st">GAGG</span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="st">GGGG</span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="st">GGGA</span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="st">CAGG</span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="st">AGGG</span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="st">GGAG</span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a>kmer_list: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmer_list)</span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node, neighbors <span class="kw">in</span> adjacency_list.items():</span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss"> -&gt; </span><span class="sc">{</span><span class="st">','</span><span class="sc">.</span>join(neighbors)<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-an-eulerian-cycle-in-a-graph" class="level1" data-number="27">
<h1 data-number="27"><span class="header-section-number">27</span> Find an Eulerian Cycle in a Graph</h1>
<p>Eulerian Cycle Problem, Find an Eulerian cycle in a graph.</p>
<p>Given:&nbsp;An Eulerian directed graph, in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<p>Return:&nbsp;An&nbsp;<a href="https://rosalind.info/glossary/eulerian-cycle/">Eulerian cycle</a>&nbsp;in this graph.</p>
<section id="sample-dataset-27" class="level2" data-number="27.1">
<h2 data-number="27.1" class="anchored" data-anchor-id="sample-dataset-27"><span class="header-section-number">27.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; 3
1 -&gt; 0
2 -&gt; 1,6
3 -&gt; 2
4 -&gt; 2
5 -&gt; 4
6 -&gt; 5,8
7 -&gt; 9
8 -&gt; 7
9 -&gt; 6</code></pre>
</section>
<section id="sample-output-27" class="level2" data-number="27.2">
<h2 data-number="27.2" class="anchored" data-anchor-id="sample-output-27"><span class="header-section-number">27.2</span> Sample Output</h2>
<pre><code>6-&gt;8-&gt;7-&gt;9-&gt;6-&gt;5-&gt;4-&gt;2-&gt;1-&gt;0-&gt;3-&gt;2-&gt;6</code></pre>
</section>
<section id="solution-27" class="level2" data-number="27.3">
<h2 data-number="27.3" class="anchored" data-anchor-id="solution-27"><span class="header-section-number">27.3</span> Solution</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_list_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> element <span class="kw">in</span> adjacency_list_text:</span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, element)</span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Form a cycle by randomly walking in the graph</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Form new_cycle by traversing cycle (starting at new_start) and then randomly walking</span></span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb84-52"><a href="#cb84-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-53"><a href="#cb84-53" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb84-54"><a href="#cb84-54" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 3</span></span>
<span id="cb84-55"><a href="#cb84-55" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 0</span></span>
<span id="cb84-56"><a href="#cb84-56" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1,6</span></span>
<span id="cb84-57"><a href="#cb84-57" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 2</span></span>
<span id="cb84-58"><a href="#cb84-58" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb84-59"><a href="#cb84-59" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 4</span></span>
<span id="cb84-60"><a href="#cb84-60" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 5,8</span></span>
<span id="cb84-61"><a href="#cb84-61" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 9</span></span>
<span id="cb84-62"><a href="#cb84-62" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 7</span></span>
<span id="cb84-63"><a href="#cb84-63" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb84-64"><a href="#cb84-64" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb84-65"><a href="#cb84-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-66"><a href="#cb84-66" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb84-67"><a href="#cb84-67" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb84-68"><a href="#cb84-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-69"><a href="#cb84-69" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_cycle(adjacency_list)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-an-eulerian-path-in-a-graph" class="level1" data-number="28">
<h1 data-number="28"><span class="header-section-number">28</span> Find an Eulerian Path in a Graph</h1>
<p>Eulerian Path Problem, Find an Eulerian path in a graph.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/directed-graph/">directed graph</a>&nbsp;that contains an Eulerian path, where the graph is given in the form of an&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>.</p>
<p>Return:&nbsp;An Eulerian path in this graph.</p>
<section id="sample-dataset-28" class="level2" data-number="28.1">
<h2 data-number="28.1" class="anchored" data-anchor-id="sample-dataset-28"><span class="header-section-number">28.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; 2
1 -&gt; 3
2 -&gt; 1
3 -&gt; 0,4
6 -&gt; 3,7
7 -&gt; 8
8 -&gt; 9
9 -&gt; 6</code></pre>
</section>
<section id="sample-output-28" class="level2" data-number="28.2">
<h2 data-number="28.2" class="anchored" data-anchor-id="sample-output-28"><span class="header-section-number">28.2</span> Sample Output</h2>
<pre><code>6-&gt;7-&gt;8-&gt;9-&gt;6-&gt;3-&gt;0-&gt;2-&gt;1-&gt;3-&gt;4</code></pre>
</section>
<section id="solution-28" class="level2" data-number="28.3">
<h2 data-number="28.3" class="anchored" data-anchor-id="solution-28"><span class="header-section-number">28.3</span> Solution</h2>
<div class="sourceCode" id="cb87"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>        node, neighbors <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[node] <span class="op">=</span> neighbors.split(<span class="st">','</span>)</span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb87-39"><a href="#cb87-39" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb87-40"><a href="#cb87-40" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb87-41"><a href="#cb87-41" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb87-42"><a href="#cb87-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb87-43"><a href="#cb87-43" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb87-44"><a href="#cb87-44" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb87-45"><a href="#cb87-45" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb87-46"><a href="#cb87-46" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb87-47"><a href="#cb87-47" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb87-48"><a href="#cb87-48" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb87-49"><a href="#cb87-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb87-50"><a href="#cb87-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-51"><a href="#cb87-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb87-52"><a href="#cb87-52" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb87-53"><a href="#cb87-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb87-54"><a href="#cb87-54" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb87-55"><a href="#cb87-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb87-56"><a href="#cb87-56" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb87-57"><a href="#cb87-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-58"><a href="#cb87-58" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb87-59"><a href="#cb87-59" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb87-60"><a href="#cb87-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-61"><a href="#cb87-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb87-62"><a href="#cb87-62" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb87-63"><a href="#cb87-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb87-64"><a href="#cb87-64" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb87-65"><a href="#cb87-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-66"><a href="#cb87-66" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb87-67"><a href="#cb87-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb87-68"><a href="#cb87-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb87-69"><a href="#cb87-69" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb87-70"><a href="#cb87-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-71"><a href="#cb87-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb87-72"><a href="#cb87-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-73"><a href="#cb87-73" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb87-74"><a href="#cb87-74" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; 2</span></span>
<span id="cb87-75"><a href="#cb87-75" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 3</span></span>
<span id="cb87-76"><a href="#cb87-76" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 1</span></span>
<span id="cb87-77"><a href="#cb87-77" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 0,4</span></span>
<span id="cb87-78"><a href="#cb87-78" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 3,7</span></span>
<span id="cb87-79"><a href="#cb87-79" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 8</span></span>
<span id="cb87-80"><a href="#cb87-80" aria-hidden="true" tabindex="-1"></a><span class="st">8 -&gt; 9</span></span>
<span id="cb87-81"><a href="#cb87-81" aria-hidden="true" tabindex="-1"></a><span class="st">9 -&gt; 6</span></span>
<span id="cb87-82"><a href="#cb87-82" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb87-83"><a href="#cb87-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-84"><a href="#cb87-84" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb87-85"><a href="#cb87-85" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb87-86"><a href="#cb87-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-87"><a href="#cb87-87" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(find_eulerian_path(adjacency_list)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-k-mer-composition" class="level1" data-number="29">
<h1 data-number="29"><span class="header-section-number">29</span> Reconstruct a String from its k-mer Composition</h1>
<p>String Reconstruction Problem. Reconstruct a string from its k-mer composition.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;followed by a list of&nbsp;<em>k</em>-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;with&nbsp;<em>k</em>-mer composition equal to&nbsp;<em>Patterns</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-29" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="sample-dataset-29"><span class="header-section-number">29.1</span> Sample Dataset</h2>
<pre><code>4
CTTA
ACCA
TACC
GGCT
GCTT
TTAC</code></pre>
</section>
<section id="sample-output-29" class="level2" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="sample-output-29"><span class="header-section-number">29.2</span> Sample Output</h2>
<pre><code>GGCTTACCA</code></pre>
</section>
<section id="solution-29" class="level2" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="solution-29"><span class="header-section-number">29.3</span> Solution</h2>
<div class="sourceCode" id="cb90"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb90-14"><a href="#cb90-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-15"><a href="#cb90-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb90-16"><a href="#cb90-16" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb90-17"><a href="#cb90-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb90-18"><a href="#cb90-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb90-19"><a href="#cb90-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb90-20"><a href="#cb90-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-21"><a href="#cb90-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb90-22"><a href="#cb90-22" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb90-23"><a href="#cb90-23" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb90-24"><a href="#cb90-24" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb90-25"><a href="#cb90-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-26"><a href="#cb90-26" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb90-27"><a href="#cb90-27" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb90-28"><a href="#cb90-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb90-29"><a href="#cb90-29" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb90-30"><a href="#cb90-30" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb90-31"><a href="#cb90-31" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb90-32"><a href="#cb90-32" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb90-33"><a href="#cb90-33" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb90-34"><a href="#cb90-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-35"><a href="#cb90-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb90-36"><a href="#cb90-36" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb90-37"><a href="#cb90-37" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb90-38"><a href="#cb90-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-39"><a href="#cb90-39" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb90-40"><a href="#cb90-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-41"><a href="#cb90-41" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb90-42"><a href="#cb90-42" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb90-43"><a href="#cb90-43" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb90-44"><a href="#cb90-44" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb90-45"><a href="#cb90-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb90-46"><a href="#cb90-46" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb90-47"><a href="#cb90-47" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb90-48"><a href="#cb90-48" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb90-49"><a href="#cb90-49" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb90-50"><a href="#cb90-50" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb90-51"><a href="#cb90-51" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb90-52"><a href="#cb90-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb90-53"><a href="#cb90-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-54"><a href="#cb90-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb90-55"><a href="#cb90-55" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb90-56"><a href="#cb90-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb90-57"><a href="#cb90-57" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb90-58"><a href="#cb90-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb90-59"><a href="#cb90-59" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb90-60"><a href="#cb90-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-61"><a href="#cb90-61" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb90-62"><a href="#cb90-62" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb90-63"><a href="#cb90-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-64"><a href="#cb90-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb90-65"><a href="#cb90-65" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb90-66"><a href="#cb90-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb90-67"><a href="#cb90-67" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb90-68"><a href="#cb90-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-69"><a href="#cb90-69" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb90-70"><a href="#cb90-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb90-71"><a href="#cb90-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb90-72"><a href="#cb90-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb90-73"><a href="#cb90-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-74"><a href="#cb90-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb90-75"><a href="#cb90-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-76"><a href="#cb90-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb90-77"><a href="#cb90-77" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb90-78"><a href="#cb90-78" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(adjacency_list)</span>
<span id="cb90-79"><a href="#cb90-79" aria-hidden="true" tabindex="-1"></a>    reconstructed_string <span class="op">=</span> path[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-80"><a href="#cb90-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> path:</span>
<span id="cb90-81"><a href="#cb90-81" aria-hidden="true" tabindex="-1"></a>        reconstructed_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb90-82"><a href="#cb90-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reconstructed_string</span>
<span id="cb90-83"><a href="#cb90-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-84"><a href="#cb90-84" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb90-85"><a href="#cb90-85" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb90-86"><a href="#cb90-86" aria-hidden="true" tabindex="-1"></a><span class="st">CTTA</span></span>
<span id="cb90-87"><a href="#cb90-87" aria-hidden="true" tabindex="-1"></a><span class="st">ACCA</span></span>
<span id="cb90-88"><a href="#cb90-88" aria-hidden="true" tabindex="-1"></a><span class="st">TACC</span></span>
<span id="cb90-89"><a href="#cb90-89" aria-hidden="true" tabindex="-1"></a><span class="st">GGCT</span></span>
<span id="cb90-90"><a href="#cb90-90" aria-hidden="true" tabindex="-1"></a><span class="st">GCTT</span></span>
<span id="cb90-91"><a href="#cb90-91" aria-hidden="true" tabindex="-1"></a><span class="st">TTAC</span></span>
<span id="cb90-92"><a href="#cb90-92" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb90-93"><a href="#cb90-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-94"><a href="#cb90-94" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb90-95"><a href="#cb90-95" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb90-96"><a href="#cb90-96" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb90-97"><a href="#cb90-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-98"><a href="#cb90-98" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string(kmers))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-k-universal-circular-string" class="level1" data-number="30">
<h1 data-number="30"><span class="header-section-number">30</span> Find a k-Universal Circular String</h1>
<p><em>k</em>-Universal Circular String Problem. Find a k-universal circular binary string.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;A&nbsp;<em>k</em>-universal circular string. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-30" class="level2" data-number="30.1">
<h2 data-number="30.1" class="anchored" data-anchor-id="sample-dataset-30"><span class="header-section-number">30.1</span> Sample Dataset</h2>
<p><code>4</code></p>
</section>
<section id="sample-output-30" class="level2" data-number="30.2">
<h2 data-number="30.2" class="anchored" data-anchor-id="sample-output-30"><span class="header-section-number">30.2</span> Sample Output</h2>
<pre><code>1111010010110000</code></pre>
</section>
<section id="solution-30" class="level2" data-number="30.3">
<h2 data-number="30.3" class="anchored" data-anchor-id="solution-30"><span class="header-section-number">30.3</span> Solution</h2>
<div class="sourceCode" id="cb92"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a>        suffix <span class="op">=</span> kmer[<span class="dv">1</span>:]</span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix] <span class="op">=</span> [suffix]</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a>            adjacency_dict[prefix].append(suffix)</span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-21"><a href="#cb92-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb92-22"><a href="#cb92-22" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb92-23"><a href="#cb92-23" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb92-24"><a href="#cb92-24" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb92-25"><a href="#cb92-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-26"><a href="#cb92-26" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb92-27"><a href="#cb92-27" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb92-28"><a href="#cb92-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb92-29"><a href="#cb92-29" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb92-30"><a href="#cb92-30" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb92-31"><a href="#cb92-31" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb92-32"><a href="#cb92-32" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb92-33"><a href="#cb92-33" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb92-34"><a href="#cb92-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-35"><a href="#cb92-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb92-36"><a href="#cb92-36" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb92-37"><a href="#cb92-37" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb92-38"><a href="#cb92-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-39"><a href="#cb92-39" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb92-40"><a href="#cb92-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-41"><a href="#cb92-41" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb92-42"><a href="#cb92-42" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb92-43"><a href="#cb92-43" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb92-44"><a href="#cb92-44" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb92-45"><a href="#cb92-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb92-46"><a href="#cb92-46" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb92-47"><a href="#cb92-47" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb92-48"><a href="#cb92-48" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb92-49"><a href="#cb92-49" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb92-50"><a href="#cb92-50" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb92-51"><a href="#cb92-51" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb92-52"><a href="#cb92-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb92-53"><a href="#cb92-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-54"><a href="#cb92-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_k_universal_circular_string(k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb92-55"><a href="#cb92-55" aria-hidden="true" tabindex="-1"></a>    kmers: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb92-56"><a href="#cb92-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">2</span> <span class="op">**</span> k):</span>
<span id="cb92-57"><a href="#cb92-57" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> <span class="bu">format</span>(i, <span class="ss">f'0</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">b'</span>)</span>
<span id="cb92-58"><a href="#cb92-58" aria-hidden="true" tabindex="-1"></a>        kmers.append(kmer)</span>
<span id="cb92-59"><a href="#cb92-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-60"><a href="#cb92-60" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb92-61"><a href="#cb92-61" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(adjacency_list)</span>
<span id="cb92-62"><a href="#cb92-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-63"><a href="#cb92-63" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> cycle[:<span class="bu">len</span>(cycle) <span class="op">-</span> k <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb92-64"><a href="#cb92-64" aria-hidden="true" tabindex="-1"></a>    circular_string <span class="op">=</span> cycle[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb92-65"><a href="#cb92-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> cycle:</span>
<span id="cb92-66"><a href="#cb92-66" aria-hidden="true" tabindex="-1"></a>        circular_string <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb92-67"><a href="#cb92-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> circular_string</span>
<span id="cb92-68"><a href="#cb92-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-69"><a href="#cb92-69" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb92-70"><a href="#cb92-70" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb92-71"><a href="#cb92-71" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb92-72"><a href="#cb92-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-73"><a href="#cb92-73" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb92-74"><a href="#cb92-74" aria-hidden="true" tabindex="-1"></a>k: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb92-75"><a href="#cb92-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-76"><a href="#cb92-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(generate_k_universal_circular_string(k))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-paired-composition" class="level1" data-number="31">
<h1 data-number="31"><span class="header-section-number">31</span> Reconstruct a String from its Paired Composition</h1>
<p>String Reconstruction from Read-Pairs Problem. Reconstruct a string from its paired composition.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>d</em>&nbsp;followed by a collection of paired&nbsp;<em>k</em>-mers&nbsp;<em>PairedReads</em>.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;with (<em>k</em>,&nbsp;<em>d</em>)-mer composition equal to&nbsp;<em>PairedReads</em>. (If multiple answers exist, you may return any one.)</p>
<section id="sample-dataset-31" class="level2" data-number="31.1">
<h2 data-number="31.1" class="anchored" data-anchor-id="sample-dataset-31"><span class="header-section-number">31.1</span> Sample Dataset</h2>
<pre><code>4 2
GAGA|TTGA
TCGT|GATG
CGTG|ATGT
TGGT|TGAG
GTGA|TGTT
GTGG|GTGA
TGAG|GTTG
GGTC|GAGA
GTCG|AGAT</code></pre>
</section>
<section id="sample-output-31" class="level2" data-number="31.2">
<h2 data-number="31.2" class="anchored" data-anchor-id="sample-output-31"><span class="header-section-number">31.2</span> Sample Output</h2>
<pre><code>GTGGTCGTGAGATGTTGA</code></pre>
</section>
<section id="solution-31" class="level2" data-number="31.3">
<h2 data-number="31.3" class="anchored" data-anchor-id="solution-31"><span class="header-section-number">31.3</span> Solution</h2>
<div class="sourceCode" id="cb95"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sys</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> random <span class="im">import</span> choice</span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb95-10"><a href="#cb95-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb95-11"><a href="#cb95-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-12"><a href="#cb95-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_cycle(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb95-13"><a href="#cb95-13" aria-hidden="true" tabindex="-1"></a>    start_node, edges <span class="op">=</span> choice(<span class="bu">list</span>(graph.items()))</span>
<span id="cb95-14"><a href="#cb95-14" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> choice(edges)</span>
<span id="cb95-15"><a href="#cb95-15" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> remove_edge(graph, start_node, next_node)</span>
<span id="cb95-16"><a href="#cb95-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-17"><a href="#cb95-17" aria-hidden="true" tabindex="-1"></a>    cycle: List[<span class="bu">str</span>] <span class="op">=</span> [start_node, next_node]</span>
<span id="cb95-18"><a href="#cb95-18" aria-hidden="true" tabindex="-1"></a>    current_node <span class="op">=</span> next_node</span>
<span id="cb95-19"><a href="#cb95-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb95-20"><a href="#cb95-20" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> graph[current_node]</span>
<span id="cb95-21"><a href="#cb95-21" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(edges)</span>
<span id="cb95-22"><a href="#cb95-22" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb95-23"><a href="#cb95-23" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb95-24"><a href="#cb95-24" aria-hidden="true" tabindex="-1"></a>        cycle.append(current_node)</span>
<span id="cb95-25"><a href="#cb95-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-26"><a href="#cb95-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb95-27"><a href="#cb95-27" aria-hidden="true" tabindex="-1"></a>        potential_starts: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(idx, node) <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle) <span class="cf">if</span> node <span class="kw">in</span> graph]</span>
<span id="cb95-28"><a href="#cb95-28" aria-hidden="true" tabindex="-1"></a>        idx, new_start <span class="op">=</span> choice(potential_starts)</span>
<span id="cb95-29"><a href="#cb95-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-30"><a href="#cb95-30" aria-hidden="true" tabindex="-1"></a>        new_cycle <span class="op">=</span> cycle[idx:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb95-31"><a href="#cb95-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-32"><a href="#cb95-32" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> choice(graph[new_start])</span>
<span id="cb95-33"><a href="#cb95-33" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, new_start, next_node)</span>
<span id="cb95-34"><a href="#cb95-34" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> next_node</span>
<span id="cb95-35"><a href="#cb95-35" aria-hidden="true" tabindex="-1"></a>        new_cycle.append(current_node)</span>
<span id="cb95-36"><a href="#cb95-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> new_start:</span>
<span id="cb95-37"><a href="#cb95-37" aria-hidden="true" tabindex="-1"></a>            edges <span class="op">=</span> graph[current_node]</span>
<span id="cb95-38"><a href="#cb95-38" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> choice(edges)</span>
<span id="cb95-39"><a href="#cb95-39" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb95-40"><a href="#cb95-40" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb95-41"><a href="#cb95-41" aria-hidden="true" tabindex="-1"></a>            new_cycle.append(current_node)</span>
<span id="cb95-42"><a href="#cb95-42" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> new_cycle</span>
<span id="cb95-43"><a href="#cb95-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle</span>
<span id="cb95-44"><a href="#cb95-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-45"><a href="#cb95-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_eulerian_path(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb95-46"><a href="#cb95-46" aria-hidden="true" tabindex="-1"></a>    degree_differences: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb95-47"><a href="#cb95-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb95-48"><a href="#cb95-48" aria-hidden="true" tabindex="-1"></a>        degree_differences[source] <span class="op">=</span> degree_differences.get(source, <span class="dv">0</span>) <span class="op">+</span> <span class="bu">len</span>(targets)</span>
<span id="cb95-49"><a href="#cb95-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb95-50"><a href="#cb95-50" aria-hidden="true" tabindex="-1"></a>            degree_differences[target] <span class="op">=</span> degree_differences.get(target, <span class="dv">0</span>) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb95-51"><a href="#cb95-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-52"><a href="#cb95-52" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb95-53"><a href="#cb95-53" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> [node <span class="cf">for</span> node, diff <span class="kw">in</span> degree_differences.items() <span class="cf">if</span> diff <span class="op">==</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb95-54"><a href="#cb95-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-55"><a href="#cb95-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> start_node <span class="kw">in</span> graph:</span>
<span id="cb95-56"><a href="#cb95-56" aria-hidden="true" tabindex="-1"></a>        graph[start_node].append(end_node)</span>
<span id="cb95-57"><a href="#cb95-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb95-58"><a href="#cb95-58" aria-hidden="true" tabindex="-1"></a>        graph[start_node] <span class="op">=</span> [end_node]</span>
<span id="cb95-59"><a href="#cb95-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-60"><a href="#cb95-60" aria-hidden="true" tabindex="-1"></a>    cycle <span class="op">=</span> find_eulerian_cycle(graph)</span>
<span id="cb95-61"><a href="#cb95-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, node <span class="kw">in</span> <span class="bu">enumerate</span>(cycle):</span>
<span id="cb95-62"><a href="#cb95-62" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="op">==</span> start_node <span class="kw">and</span> cycle[(idx <span class="op">+</span> <span class="dv">1</span>) <span class="op">%</span> <span class="bu">len</span>(cycle)] <span class="op">==</span> end_node:</span>
<span id="cb95-63"><a href="#cb95-63" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> cycle[idx <span class="op">+</span> <span class="dv">1</span>:] <span class="op">+</span> cycle[<span class="dv">1</span>:idx <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb95-64"><a href="#cb95-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-65"><a href="#cb95-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> cycle  <span class="co"># This should never happen if the input is valid</span></span>
<span id="cb95-66"><a href="#cb95-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-67"><a href="#cb95-67" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph_paired_reads(paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]]:</span>
<span id="cb95-68"><a href="#cb95-68" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb95-69"><a href="#cb95-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pair <span class="kw">in</span> paired_reads:</span>
<span id="cb95-70"><a href="#cb95-70" aria-hidden="true" tabindex="-1"></a>        graph[(pair[<span class="dv">0</span>][:<span class="op">-</span><span class="dv">1</span>], pair[<span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>])].append((pair[<span class="dv">0</span>][<span class="dv">1</span>:], pair[<span class="dv">1</span>][<span class="dv">1</span>:]))</span>
<span id="cb95-71"><a href="#cb95-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb95-72"><a href="#cb95-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-73"><a href="#cb95-73" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> string_spelled_by_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb95-74"><a href="#cb95-74" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">0</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb95-75"><a href="#cb95-75" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span>.join(pattern[<span class="dv">1</span>][<span class="dv">0</span>] <span class="cf">for</span> pattern <span class="kw">in</span> gapped_patterns[:<span class="op">-</span><span class="dv">1</span>]) <span class="op">+</span> gapped_patterns[<span class="op">-</span><span class="dv">1</span>][<span class="dv">1</span>]</span>
<span id="cb95-76"><a href="#cb95-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-77"><a href="#cb95-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb95-78"><a href="#cb95-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb95-79"><a href="#cb95-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb95-80"><a href="#cb95-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb95-81"><a href="#cb95-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-82"><a href="#cb95-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_read_pairs(k: <span class="bu">int</span>, d: <span class="bu">int</span>, paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb95-83"><a href="#cb95-83" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph_paired_reads(paired_reads)</span>
<span id="cb95-84"><a href="#cb95-84" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> find_eulerian_path(graph)</span>
<span id="cb95-85"><a href="#cb95-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> string_spelled_by_gapped_patterns(path, k <span class="op">-</span> <span class="dv">1</span>, d)</span>
<span id="cb95-86"><a href="#cb95-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-87"><a href="#cb95-87" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb95-88"><a href="#cb95-88" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb95-89"><a href="#cb95-89" aria-hidden="true" tabindex="-1"></a><span class="st">GAGA|TTGA</span></span>
<span id="cb95-90"><a href="#cb95-90" aria-hidden="true" tabindex="-1"></a><span class="st">TCGT|GATG</span></span>
<span id="cb95-91"><a href="#cb95-91" aria-hidden="true" tabindex="-1"></a><span class="st">CGTG|ATGT</span></span>
<span id="cb95-92"><a href="#cb95-92" aria-hidden="true" tabindex="-1"></a><span class="st">TGGT|TGAG</span></span>
<span id="cb95-93"><a href="#cb95-93" aria-hidden="true" tabindex="-1"></a><span class="st">GTGA|TGTT</span></span>
<span id="cb95-94"><a href="#cb95-94" aria-hidden="true" tabindex="-1"></a><span class="st">GTGG|GTGA</span></span>
<span id="cb95-95"><a href="#cb95-95" aria-hidden="true" tabindex="-1"></a><span class="st">TGAG|GTTG</span></span>
<span id="cb95-96"><a href="#cb95-96" aria-hidden="true" tabindex="-1"></a><span class="st">GGTC|GAGA</span></span>
<span id="cb95-97"><a href="#cb95-97" aria-hidden="true" tabindex="-1"></a><span class="st">GTCG|AGAT</span></span>
<span id="cb95-98"><a href="#cb95-98" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb95-99"><a href="#cb95-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-100"><a href="#cb95-100" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb95-101"><a href="#cb95-101" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb95-102"><a href="#cb95-102" aria-hidden="true" tabindex="-1"></a>paired_reads: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb95-103"><a href="#cb95-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-104"><a href="#cb95-104" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_read_pairs(k, d, paired_reads))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-contigs-from-a-collection-of-reads" class="level1" data-number="32">
<h1 data-number="32"><span class="header-section-number">32</span> Generate Contigs from a Collection of Reads</h1>
<p>Contig Generation Problem. Generate the contigs from a collection of reads (with imperfect coverage).</p>
<p>Given:&nbsp;A collection of k-mers&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All contigs in&nbsp;<em>DeBruijn(Patterns)</em>. (You may return the strings in any order.)</p>
<section id="sample-dataset-32" class="level2" data-number="32.1">
<h2 data-number="32.1" class="anchored" data-anchor-id="sample-dataset-32"><span class="header-section-number">32.1</span> Sample Dataset</h2>
<pre><code>ATG
ATG
TGT
TGG
CAT
GGA
GAT
AGA</code></pre>
</section>
<section id="sample-output-32" class="level2" data-number="32.2">
<h2 data-number="32.2" class="anchored" data-anchor-id="sample-output-32"><span class="header-section-number">32.2</span> Sample Output</h2>
<pre><code>AGA ATG ATG CAT GAT TGGA TGT</code></pre>
</section>
<section id="solution-32" class="level2" data-number="32.3">
<h2 data-number="32.3" class="anchored" data-anchor-id="solution-32"><span class="header-section-number">32.3</span> Solution</h2>
<div class="sourceCode" id="cb98"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_de_bruijn_graph(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>        prefix, suffix <span class="op">=</span> kmer[:<span class="op">-</span><span class="dv">1</span>], kmer[<span class="dv">1</span>:]</span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[prefix].append(suffix)</span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source, targets <span class="kw">in</span> graph.items():</span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(targets)]</span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb98-26"><a href="#cb98-26" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[source][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(targets)</span>
<span id="cb98-27"><a href="#cb98-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-28"><a href="#cb98-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> targets:</span>
<span id="cb98-29"><a href="#cb98-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb98-30"><a href="#cb98-30" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb98-31"><a href="#cb98-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb98-32"><a href="#cb98-32" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[target][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb98-33"><a href="#cb98-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-34"><a href="#cb98-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb98-35"><a href="#cb98-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb98-36"><a href="#cb98-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb98-37"><a href="#cb98-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb98-38"><a href="#cb98-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb98-39"><a href="#cb98-39" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb98-40"><a href="#cb98-40" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb98-41"><a href="#cb98-41" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb98-42"><a href="#cb98-42" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb98-43"><a href="#cb98-43" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb98-44"><a href="#cb98-44" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb98-45"><a href="#cb98-45" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb98-46"><a href="#cb98-46" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb98-47"><a href="#cb98-47" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb98-48"><a href="#cb98-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-49"><a href="#cb98-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb98-50"><a href="#cb98-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb98-51"><a href="#cb98-51" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb98-52"><a href="#cb98-52" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb98-53"><a href="#cb98-53" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb98-54"><a href="#cb98-54" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb98-55"><a href="#cb98-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb98-56"><a href="#cb98-56" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb98-57"><a href="#cb98-57" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb98-58"><a href="#cb98-58" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb98-59"><a href="#cb98-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb98-60"><a href="#cb98-60" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb98-61"><a href="#cb98-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-62"><a href="#cb98-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb98-63"><a href="#cb98-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-64"><a href="#cb98-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_contigs(kmers: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb98-65"><a href="#cb98-65" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> construct_de_bruijn_graph(kmers)</span>
<span id="cb98-66"><a href="#cb98-66" aria-hidden="true" tabindex="-1"></a>    paths <span class="op">=</span> find_maximal_non_branching_paths(graph)</span>
<span id="cb98-67"><a href="#cb98-67" aria-hidden="true" tabindex="-1"></a>    contigs: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb98-68"><a href="#cb98-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> path <span class="kw">in</span> paths:</span>
<span id="cb98-69"><a href="#cb98-69" aria-hidden="true" tabindex="-1"></a>        contig <span class="op">=</span> path[<span class="dv">0</span>]</span>
<span id="cb98-70"><a href="#cb98-70" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> path[<span class="dv">1</span>:]:</span>
<span id="cb98-71"><a href="#cb98-71" aria-hidden="true" tabindex="-1"></a>            contig <span class="op">+=</span> node[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb98-72"><a href="#cb98-72" aria-hidden="true" tabindex="-1"></a>        contigs.append(contig)</span>
<span id="cb98-73"><a href="#cb98-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> contigs</span>
<span id="cb98-74"><a href="#cb98-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-75"><a href="#cb98-75" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb98-76"><a href="#cb98-76" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb98-77"><a href="#cb98-77" aria-hidden="true" tabindex="-1"></a><span class="st">ATG</span></span>
<span id="cb98-78"><a href="#cb98-78" aria-hidden="true" tabindex="-1"></a><span class="st">TGT</span></span>
<span id="cb98-79"><a href="#cb98-79" aria-hidden="true" tabindex="-1"></a><span class="st">TGG</span></span>
<span id="cb98-80"><a href="#cb98-80" aria-hidden="true" tabindex="-1"></a><span class="st">CAT</span></span>
<span id="cb98-81"><a href="#cb98-81" aria-hidden="true" tabindex="-1"></a><span class="st">GGA</span></span>
<span id="cb98-82"><a href="#cb98-82" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb98-83"><a href="#cb98-83" aria-hidden="true" tabindex="-1"></a><span class="st">AGA</span></span>
<span id="cb98-84"><a href="#cb98-84" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb98-85"><a href="#cb98-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-86"><a href="#cb98-86" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb98-87"><a href="#cb98-87" aria-hidden="true" tabindex="-1"></a>contigs <span class="op">=</span> generate_contigs(kmers)</span>
<span id="cb98-88"><a href="#cb98-88" aria-hidden="true" tabindex="-1"></a>contigs.sort()</span>
<span id="cb98-89"><a href="#cb98-89" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(contigs))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-string-spelled-by-a-gapped-genome-path" class="level1" data-number="33">
<h1 data-number="33"><span class="header-section-number">33</span> Construct a String Spelled by a Gapped Genome Path</h1>
<p>Gapped Genome Path String Problem. Reconstruct a string from a sequence of (k,d)-mers corresponding to a path in a paired de Bruijn graph.</p>
<p>Given:&nbsp;A sequence of&nbsp;<em>(k, d)</em>-mers (<em>a1|b1</em>),…, (<em>an|bn</em>) such that&nbsp;<em>Suffix(ai|bi) = Prefix(ai+1|bi+1)</em>&nbsp;for all&nbsp;<em>i</em>&nbsp;from 1 to n-1.</p>
<p>Return:&nbsp;A string&nbsp;<em>Text</em>&nbsp;where the&nbsp;<em>i</em>-th&nbsp;<em>k</em>-mer in&nbsp;<em>Text</em>&nbsp;is equal to&nbsp;<em>Suffix(ai|bi)</em>&nbsp;for all&nbsp;<em>i</em>&nbsp;from 1 to n, if such a string exists.</p>
<section id="sample-dataset-33" class="level2" data-number="33.1">
<h2 data-number="33.1" class="anchored" data-anchor-id="sample-dataset-33"><span class="header-section-number">33.1</span> Sample Dataset</h2>
<pre><code>4 2
GACC|GCGC
ACCG|CGCC
CCGA|GCCG
CGAG|CCGG
GAGC|CGGA</code></pre>
</section>
<section id="sample-output-33" class="level2" data-number="33.2">
<h2 data-number="33.2" class="anchored" data-anchor-id="sample-output-33"><span class="header-section-number">33.2</span> Sample Output</h2>
<pre><code>GACCGAGCGCCGGA</code></pre>
</section>
<section id="solution-33" class="level2" data-number="33.3">
<h2 data-number="33.3" class="anchored" data-anchor-id="solution-33"><span class="header-section-number">33.3</span> Solution</h2>
<div class="sourceCode" id="cb101"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reconstruct_string_from_gapped_patterns(gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]], k: <span class="bu">int</span>, d: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>    prefix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>    suffix_string <span class="op">=</span> <span class="st">''</span></span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, (prefix, suffix) <span class="kw">in</span> <span class="bu">enumerate</span>(gapped_patterns):</span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> i <span class="op">!=</span> <span class="bu">len</span>(gapped_patterns) <span class="op">-</span> <span class="dv">1</span>:</span>
<span id="cb101-8"><a href="#cb101-8" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix[<span class="dv">0</span>]</span>
<span id="cb101-9"><a href="#cb101-9" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix[<span class="dv">0</span>]</span>
<span id="cb101-10"><a href="#cb101-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb101-11"><a href="#cb101-11" aria-hidden="true" tabindex="-1"></a>            prefix_string <span class="op">+=</span> prefix</span>
<span id="cb101-12"><a href="#cb101-12" aria-hidden="true" tabindex="-1"></a>            suffix_string <span class="op">+=</span> suffix</span>
<span id="cb101-13"><a href="#cb101-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-14"><a href="#cb101-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(k <span class="op">+</span> d <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(prefix_string)):</span>
<span id="cb101-15"><a href="#cb101-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> prefix_string[i] <span class="op">!=</span> suffix_string[i <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb101-16"><a href="#cb101-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"-1"</span></span>
<span id="cb101-17"><a href="#cb101-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-18"><a href="#cb101-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prefix_string <span class="op">+</span> suffix_string[<span class="bu">len</span>(suffix_string) <span class="op">-</span> k <span class="op">-</span> d <span class="op">-</span> <span class="dv">1</span>:]</span>
<span id="cb101-19"><a href="#cb101-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-20"><a href="#cb101-20" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb101-21"><a href="#cb101-21" aria-hidden="true" tabindex="-1"></a><span class="st">4 2</span></span>
<span id="cb101-22"><a href="#cb101-22" aria-hidden="true" tabindex="-1"></a><span class="st">GACC|GCGC</span></span>
<span id="cb101-23"><a href="#cb101-23" aria-hidden="true" tabindex="-1"></a><span class="st">ACCG|CGCC</span></span>
<span id="cb101-24"><a href="#cb101-24" aria-hidden="true" tabindex="-1"></a><span class="st">CCGA|GCCG</span></span>
<span id="cb101-25"><a href="#cb101-25" aria-hidden="true" tabindex="-1"></a><span class="st">CGAG|CCGG</span></span>
<span id="cb101-26"><a href="#cb101-26" aria-hidden="true" tabindex="-1"></a><span class="st">GAGC|CGGA</span></span>
<span id="cb101-27"><a href="#cb101-27" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb101-28"><a href="#cb101-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-29"><a href="#cb101-29" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb101-30"><a href="#cb101-30" aria-hidden="true" tabindex="-1"></a>k, d <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, input_lines[<span class="dv">0</span>].split())</span>
<span id="cb101-31"><a href="#cb101-31" aria-hidden="true" tabindex="-1"></a>gapped_patterns: List[Tuple[<span class="bu">str</span>, <span class="bu">str</span>]] <span class="op">=</span> [<span class="bu">tuple</span>(line.split(<span class="st">"|"</span>)) <span class="cf">for</span> line <span class="kw">in</span> input_lines[<span class="dv">1</span>:]]</span>
<span id="cb101-32"><a href="#cb101-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-33"><a href="#cb101-33" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(reconstruct_string_from_gapped_patterns(gapped_patterns, k <span class="op">-</span> <span class="dv">1</span>, d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-all-maximal-non-branching-paths-in-a-graph" class="level1" data-number="34">
<h1 data-number="34"><span class="header-section-number">34</span> Generate All Maximal Non-Branching Paths in a Graph</h1>
<p>Maximal Non-Branching Path Problem. Find all maximal non-branching paths in a graph.</p>
<p>Given:&nbsp;The adjacency list of a graph whose nodes are integers.</p>
<p>Return:&nbsp;The collection of all maximal non-branching paths in the graph.</p>
<section id="sample-dataset-34" class="level2" data-number="34.1">
<h2 data-number="34.1" class="anchored" data-anchor-id="sample-dataset-34"><span class="header-section-number">34.1</span> Sample Dataset</h2>
<pre><code>1 -&gt; 2
2 -&gt; 3
3 -&gt; 4,5
6 -&gt; 7
7 -&gt; 6</code></pre>
</section>
<section id="sample-output-34" class="level2" data-number="34.2">
<h2 data-number="34.2" class="anchored" data-anchor-id="sample-output-34"><span class="header-section-number">34.2</span> Sample Output</h2>
<pre><code>1 -&gt; 2 -&gt; 3
3 -&gt; 4
3 -&gt; 5
6 -&gt; 7 -&gt; 6</code></pre>
</section>
<section id="solution-34" class="level2" data-number="34.3">
<h2 data-number="34.3" class="anchored" data-anchor-id="solution-34"><span class="header-section-number">34.3</span> Solution</h2>
<div class="sourceCode" id="cb104"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_adjacency_list(adjacency_text: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> adjacency_text:</span>
<span id="cb104-7"><a href="#cb104-7" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> split(<span class="st">' -&gt; '</span>, line)</span>
<span id="cb104-8"><a href="#cb104-8" aria-hidden="true" tabindex="-1"></a>        adjacency_dict[source] <span class="op">=</span> targets.split(<span class="st">','</span>)</span>
<span id="cb104-9"><a href="#cb104-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_dict</span>
<span id="cb104-10"><a href="#cb104-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-11"><a href="#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]], source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb104-12"><a href="#cb104-12" aria-hidden="true" tabindex="-1"></a>    graph[source].remove(target)</span>
<span id="cb104-13"><a href="#cb104-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> graph[source]:</span>
<span id="cb104-14"><a href="#cb104-14" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> graph[source]</span>
<span id="cb104-15"><a href="#cb104-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb104-16"><a href="#cb104-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-17"><a href="#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_maximal_non_branching_paths(graph: Dict[<span class="bu">str</span>, List[<span class="bu">str</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">str</span>]]:</span>
<span id="cb104-18"><a href="#cb104-18" aria-hidden="true" tabindex="-1"></a>    paths: List[List[<span class="bu">str</span>]] <span class="op">=</span> []</span>
<span id="cb104-19"><a href="#cb104-19" aria-hidden="true" tabindex="-1"></a>    in_out_degrees: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb104-20"><a href="#cb104-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-21"><a href="#cb104-21" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate in and out degrees</span></span>
<span id="cb104-22"><a href="#cb104-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node, neighbors <span class="kw">in</span> graph.items():</span>
<span id="cb104-23"><a href="#cb104-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb104-24"><a href="#cb104-24" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">len</span>(neighbors)]</span>
<span id="cb104-25"><a href="#cb104-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb104-26"><a href="#cb104-26" aria-hidden="true" tabindex="-1"></a>            in_out_degrees[node][<span class="dv">1</span>] <span class="op">+=</span> <span class="bu">len</span>(neighbors)</span>
<span id="cb104-27"><a href="#cb104-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-28"><a href="#cb104-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> neighbors:</span>
<span id="cb104-29"><a href="#cb104-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> in_out_degrees:</span>
<span id="cb104-30"><a href="#cb104-30" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor] <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">0</span>]</span>
<span id="cb104-31"><a href="#cb104-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb104-32"><a href="#cb104-32" aria-hidden="true" tabindex="-1"></a>                in_out_degrees[neighbor][<span class="dv">0</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb104-33"><a href="#cb104-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-34"><a href="#cb104-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find all non-branching paths</span></span>
<span id="cb104-35"><a href="#cb104-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(in_out_degrees):</span>
<span id="cb104-36"><a href="#cb104-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> in_out_degrees[node] <span class="op">!=</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb104-37"><a href="#cb104-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> in_out_degrees[node][<span class="dv">1</span>] <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb104-38"><a href="#cb104-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> node <span class="kw">in</span> graph:</span>
<span id="cb104-39"><a href="#cb104-39" aria-hidden="true" tabindex="-1"></a>                    next_node <span class="op">=</span> graph[node][<span class="dv">0</span>]</span>
<span id="cb104-40"><a href="#cb104-40" aria-hidden="true" tabindex="-1"></a>                    non_branching_path <span class="op">=</span> [node, next_node]</span>
<span id="cb104-41"><a href="#cb104-41" aria-hidden="true" tabindex="-1"></a>                    graph <span class="op">=</span> remove_edge(graph, node, next_node)</span>
<span id="cb104-42"><a href="#cb104-42" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">while</span> in_out_degrees[next_node] <span class="op">==</span> [<span class="dv">1</span>, <span class="dv">1</span>]:</span>
<span id="cb104-43"><a href="#cb104-43" aria-hidden="true" tabindex="-1"></a>                        following_node <span class="op">=</span> graph[next_node][<span class="dv">0</span>]</span>
<span id="cb104-44"><a href="#cb104-44" aria-hidden="true" tabindex="-1"></a>                        non_branching_path.append(following_node)</span>
<span id="cb104-45"><a href="#cb104-45" aria-hidden="true" tabindex="-1"></a>                        graph <span class="op">=</span> remove_edge(graph, next_node, following_node)</span>
<span id="cb104-46"><a href="#cb104-46" aria-hidden="true" tabindex="-1"></a>                        next_node <span class="op">=</span> following_node</span>
<span id="cb104-47"><a href="#cb104-47" aria-hidden="true" tabindex="-1"></a>                    paths.append(non_branching_path)</span>
<span id="cb104-48"><a href="#cb104-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-49"><a href="#cb104-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find isolated cycles</span></span>
<span id="cb104-50"><a href="#cb104-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb104-51"><a href="#cb104-51" aria-hidden="true" tabindex="-1"></a>        start_node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(graph))</span>
<span id="cb104-52"><a href="#cb104-52" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> graph[start_node][<span class="dv">0</span>]</span>
<span id="cb104-53"><a href="#cb104-53" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> remove_edge(graph, start_node, current_node)</span>
<span id="cb104-54"><a href="#cb104-54" aria-hidden="true" tabindex="-1"></a>        cycle <span class="op">=</span> [start_node, current_node]</span>
<span id="cb104-55"><a href="#cb104-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_node <span class="op">!=</span> start_node:</span>
<span id="cb104-56"><a href="#cb104-56" aria-hidden="true" tabindex="-1"></a>            next_node <span class="op">=</span> graph[current_node][<span class="dv">0</span>]</span>
<span id="cb104-57"><a href="#cb104-57" aria-hidden="true" tabindex="-1"></a>            cycle.append(next_node)</span>
<span id="cb104-58"><a href="#cb104-58" aria-hidden="true" tabindex="-1"></a>            graph <span class="op">=</span> remove_edge(graph, current_node, next_node)</span>
<span id="cb104-59"><a href="#cb104-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> next_node</span>
<span id="cb104-60"><a href="#cb104-60" aria-hidden="true" tabindex="-1"></a>        paths.append(cycle)</span>
<span id="cb104-61"><a href="#cb104-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-62"><a href="#cb104-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> paths</span>
<span id="cb104-63"><a href="#cb104-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-64"><a href="#cb104-64" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb104-65"><a href="#cb104-65" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb104-66"><a href="#cb104-66" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb104-67"><a href="#cb104-67" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; 4,5</span></span>
<span id="cb104-68"><a href="#cb104-68" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; 7</span></span>
<span id="cb104-69"><a href="#cb104-69" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 6</span></span>
<span id="cb104-70"><a href="#cb104-70" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb104-71"><a href="#cb104-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-72"><a href="#cb104-72" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb104-73"><a href="#cb104-73" aria-hidden="true" tabindex="-1"></a>adjacency_list <span class="op">=</span> parse_adjacency_list(input_lines)</span>
<span id="cb104-74"><a href="#cb104-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-75"><a href="#cb104-75" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_maximal_non_branching_paths(adjacency_list)</span>
<span id="cb104-76"><a href="#cb104-76" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> path <span class="kw">in</span> result:</span>
<span id="cb104-77"><a href="#cb104-77" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">" -&gt; "</span>.join(path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="translate-an-rna-string-into-an-amino-acid-string" class="level1" data-number="35">
<h1 data-number="35"><span class="header-section-number">35</span> Translate an RNA String into an Amino Acid String</h1>
<p>Protein Translation Problem. Translate an&nbsp;<a href="https://rosalind.info/glossary/rna-string/">RNA string</a>&nbsp;into an&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>.</p>
<p>Given:&nbsp;An RNA string&nbsp;<em>Pattern</em>.</p>
<p>Return:&nbsp;The translation of&nbsp;<em>Pattern</em>&nbsp;into an amino acid string&nbsp;<em>Peptide</em>.</p>
<section id="sample-dataset-35" class="level2" data-number="35.1">
<h2 data-number="35.1" class="anchored" data-anchor-id="sample-dataset-35"><span class="header-section-number">35.1</span> Sample Dataset</h2>
<pre><code>AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</code></pre>
</section>
<section id="sample-output-35" class="level2" data-number="35.2">
<h2 data-number="35.2" class="anchored" data-anchor-id="sample-output-35"><span class="header-section-number">35.2</span> Sample Output</h2>
<pre><code>MAMAPRTEINSTRING</code></pre>
</section>
<section id="solution-35" class="level2" data-number="35.3">
<h2 data-number="35.3" class="anchored" data-anchor-id="solution-35"><span class="header-section-number">35.3</span> Solution</h2>
<div class="sourceCode" id="cb107"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 코돈을 아미노산으로 변환하는 딕셔너리</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>    codon_table: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-24"><a href="#cb107-24" aria-hidden="true" tabindex="-1"></a>    protein_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb107-25"><a href="#cb107-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-26"><a href="#cb107-26" aria-hidden="true" tabindex="-1"></a>    <span class="co"># RNA 서열을 3개의 뉴클레오티드(코돈)씩 나누어 처리</span></span>
<span id="cb107-27"><a href="#cb107-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb107-28"><a href="#cb107-28" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb107-29"><a href="#cb107-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-30"><a href="#cb107-30" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈이 3개의 뉴클레오티드로 완전하지 않으면 중단</span></span>
<span id="cb107-31"><a href="#cb107-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb107-32"><a href="#cb107-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb107-33"><a href="#cb107-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-34"><a href="#cb107-34" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 코돈을 아미노산으로 변환</span></span>
<span id="cb107-35"><a href="#cb107-35" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_table.get(codon, <span class="st">''</span>)</span>
<span id="cb107-36"><a href="#cb107-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-37"><a href="#cb107-37" aria-hidden="true" tabindex="-1"></a>        <span class="co"># 종결 코돈('*')을 만나면 번역 중단</span></span>
<span id="cb107-38"><a href="#cb107-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb107-39"><a href="#cb107-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb107-40"><a href="#cb107-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-41"><a href="#cb107-41" aria-hidden="true" tabindex="-1"></a>        protein_sequence <span class="op">+=</span> amino_acid</span>
<span id="cb107-42"><a href="#cb107-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-43"><a href="#cb107-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> protein_sequence</span>
<span id="cb107-44"><a href="#cb107-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-45"><a href="#cb107-45" aria-hidden="true" tabindex="-1"></a><span class="co"># 입력 RNA 서열</span></span>
<span id="cb107-46"><a href="#cb107-46" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb107-47"><a href="#cb107-47" aria-hidden="true" tabindex="-1"></a><span class="st">AUGGCCAUGGCGCCCAGAACUGAGAUCAAUAGUACCCGUAUUAACGGGUGA</span></span>
<span id="cb107-48"><a href="#cb107-48" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb107-49"><a href="#cb107-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-50"><a href="#cb107-50" aria-hidden="true" tabindex="-1"></a>rna_sequence: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span>.join(sample_input.strip().split())</span>
<span id="cb107-51"><a href="#cb107-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-52"><a href="#cb107-52" aria-hidden="true" tabindex="-1"></a><span class="co"># RNA를 단백질로 번역</span></span>
<span id="cb107-53"><a href="#cb107-53" aria-hidden="true" tabindex="-1"></a>protein: <span class="bu">str</span> <span class="op">=</span> translate_rna_to_protein(rna_sequence)</span>
<span id="cb107-54"><a href="#cb107-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-55"><a href="#cb107-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(protein)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-substrings-of-a-genome-encoding-a-given-amino-acid-string" class="level1" data-number="36">
<h1 data-number="36"><span class="header-section-number">36</span> Find Substrings of a Genome Encoding a Given Amino Acid String</h1>
<p>Peptide Encoding Problem, Find substrings of a genome encoding a given amino acid sequence.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA string</a>&nbsp;<em>Text</em>&nbsp;and an&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>&nbsp;<em>Peptide</em>.</p>
<p>Return:&nbsp;All substrings of&nbsp;<em>Text</em>&nbsp;encoding&nbsp;<em>Peptide</em>&nbsp;(if any such substrings exist).</p>
<section id="sample-dataset-36" class="level2" data-number="36.1">
<h2 data-number="36.1" class="anchored" data-anchor-id="sample-dataset-36"><span class="header-section-number">36.1</span> Sample Dataset</h2>
<pre><code>ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA
MA</code></pre>
</section>
<section id="sample-output-36" class="level2" data-number="36.2">
<h2 data-number="36.2" class="anchored" data-anchor-id="sample-output-36"><span class="header-section-number">36.2</span> Sample Output</h2>
<pre><code>ATGGCC
GGCCAT
ATGGCC</code></pre>
</section>
<section id="solution-36" class="level2" data-number="36.3">
<h2 data-number="36.3" class="anchored" data-anchor-id="solution-36"><span class="header-section-number">36.3</span> Solution</h2>
<div class="sourceCode" id="cb110"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> translate_rna_to_protein(rna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>    codon_to_amino_acid: Dict[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> {</span>
<span id="cb110-5"><a href="#cb110-5" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UUU'</span>: <span class="st">'F'</span>, <span class="st">'UUC'</span>: <span class="st">'F'</span>, <span class="st">'UUA'</span>: <span class="st">'L'</span>, <span class="st">'UUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb110-6"><a href="#cb110-6" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UCU'</span>: <span class="st">'S'</span>, <span class="st">'UCC'</span>: <span class="st">'S'</span>, <span class="st">'UCA'</span>: <span class="st">'S'</span>, <span class="st">'UCG'</span>: <span class="st">'S'</span>,</span>
<span id="cb110-7"><a href="#cb110-7" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UAU'</span>: <span class="st">'Y'</span>, <span class="st">'UAC'</span>: <span class="st">'Y'</span>, <span class="st">'UAA'</span>: <span class="st">'*'</span>, <span class="st">'UAG'</span>: <span class="st">'*'</span>,</span>
<span id="cb110-8"><a href="#cb110-8" aria-hidden="true" tabindex="-1"></a>        <span class="st">'UGU'</span>: <span class="st">'C'</span>, <span class="st">'UGC'</span>: <span class="st">'C'</span>, <span class="st">'UGA'</span>: <span class="st">'*'</span>, <span class="st">'UGG'</span>: <span class="st">'W'</span>,</span>
<span id="cb110-9"><a href="#cb110-9" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CUU'</span>: <span class="st">'L'</span>, <span class="st">'CUC'</span>: <span class="st">'L'</span>, <span class="st">'CUA'</span>: <span class="st">'L'</span>, <span class="st">'CUG'</span>: <span class="st">'L'</span>,</span>
<span id="cb110-10"><a href="#cb110-10" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CCU'</span>: <span class="st">'P'</span>, <span class="st">'CCC'</span>: <span class="st">'P'</span>, <span class="st">'CCA'</span>: <span class="st">'P'</span>, <span class="st">'CCG'</span>: <span class="st">'P'</span>,</span>
<span id="cb110-11"><a href="#cb110-11" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CAU'</span>: <span class="st">'H'</span>, <span class="st">'CAC'</span>: <span class="st">'H'</span>, <span class="st">'CAA'</span>: <span class="st">'Q'</span>, <span class="st">'CAG'</span>: <span class="st">'Q'</span>,</span>
<span id="cb110-12"><a href="#cb110-12" aria-hidden="true" tabindex="-1"></a>        <span class="st">'CGU'</span>: <span class="st">'R'</span>, <span class="st">'CGC'</span>: <span class="st">'R'</span>, <span class="st">'CGA'</span>: <span class="st">'R'</span>, <span class="st">'CGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb110-13"><a href="#cb110-13" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AUU'</span>: <span class="st">'I'</span>, <span class="st">'AUC'</span>: <span class="st">'I'</span>, <span class="st">'AUA'</span>: <span class="st">'I'</span>, <span class="st">'AUG'</span>: <span class="st">'M'</span>,</span>
<span id="cb110-14"><a href="#cb110-14" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ACU'</span>: <span class="st">'T'</span>, <span class="st">'ACC'</span>: <span class="st">'T'</span>, <span class="st">'ACA'</span>: <span class="st">'T'</span>, <span class="st">'ACG'</span>: <span class="st">'T'</span>,</span>
<span id="cb110-15"><a href="#cb110-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AAU'</span>: <span class="st">'N'</span>, <span class="st">'AAC'</span>: <span class="st">'N'</span>, <span class="st">'AAA'</span>: <span class="st">'K'</span>, <span class="st">'AAG'</span>: <span class="st">'K'</span>,</span>
<span id="cb110-16"><a href="#cb110-16" aria-hidden="true" tabindex="-1"></a>        <span class="st">'AGU'</span>: <span class="st">'S'</span>, <span class="st">'AGC'</span>: <span class="st">'S'</span>, <span class="st">'AGA'</span>: <span class="st">'R'</span>, <span class="st">'AGG'</span>: <span class="st">'R'</span>,</span>
<span id="cb110-17"><a href="#cb110-17" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GUU'</span>: <span class="st">'V'</span>, <span class="st">'GUC'</span>: <span class="st">'V'</span>, <span class="st">'GUA'</span>: <span class="st">'V'</span>, <span class="st">'GUG'</span>: <span class="st">'V'</span>,</span>
<span id="cb110-18"><a href="#cb110-18" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GCU'</span>: <span class="st">'A'</span>, <span class="st">'GCC'</span>: <span class="st">'A'</span>, <span class="st">'GCA'</span>: <span class="st">'A'</span>, <span class="st">'GCG'</span>: <span class="st">'A'</span>,</span>
<span id="cb110-19"><a href="#cb110-19" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GAU'</span>: <span class="st">'D'</span>, <span class="st">'GAC'</span>: <span class="st">'D'</span>, <span class="st">'GAA'</span>: <span class="st">'E'</span>, <span class="st">'GAG'</span>: <span class="st">'E'</span>,</span>
<span id="cb110-20"><a href="#cb110-20" aria-hidden="true" tabindex="-1"></a>        <span class="st">'GGU'</span>: <span class="st">'G'</span>, <span class="st">'GGC'</span>: <span class="st">'G'</span>, <span class="st">'GGA'</span>: <span class="st">'G'</span>, <span class="st">'GGG'</span>: <span class="st">'G'</span></span>
<span id="cb110-21"><a href="#cb110-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb110-22"><a href="#cb110-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-23"><a href="#cb110-23" aria-hidden="true" tabindex="-1"></a>    protein_sequence: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb110-24"><a href="#cb110-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-25"><a href="#cb110-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(rna_sequence), <span class="dv">3</span>):</span>
<span id="cb110-26"><a href="#cb110-26" aria-hidden="true" tabindex="-1"></a>        codon: <span class="bu">str</span> <span class="op">=</span> rna_sequence[i:i<span class="op">+</span><span class="dv">3</span>]</span>
<span id="cb110-27"><a href="#cb110-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-28"><a href="#cb110-28" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(codon) <span class="op">!=</span> <span class="dv">3</span>:</span>
<span id="cb110-29"><a href="#cb110-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb110-30"><a href="#cb110-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-31"><a href="#cb110-31" aria-hidden="true" tabindex="-1"></a>        amino_acid: <span class="bu">str</span> <span class="op">=</span> codon_to_amino_acid.get(codon, <span class="st">''</span>)</span>
<span id="cb110-32"><a href="#cb110-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-33"><a href="#cb110-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> amino_acid <span class="op">==</span> <span class="st">'*'</span>:</span>
<span id="cb110-34"><a href="#cb110-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb110-35"><a href="#cb110-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-36"><a href="#cb110-36" aria-hidden="true" tabindex="-1"></a>        protein_sequence.append(amino_acid)</span>
<span id="cb110-37"><a href="#cb110-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-38"><a href="#cb110-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(protein_sequence)</span>
<span id="cb110-39"><a href="#cb110-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-40"><a href="#cb110-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb110-41"><a href="#cb110-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb110-42"><a href="#cb110-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-43"><a href="#cb110-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dna_to_rna(dna_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb110-44"><a href="#cb110-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> dna_sequence.replace(<span class="st">"T"</span>, <span class="st">"U"</span>)</span>
<span id="cb110-45"><a href="#cb110-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-46"><a href="#cb110-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_peptide_encoding_substrings(dna_sequence: <span class="bu">str</span>, peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb110-47"><a href="#cb110-47" aria-hidden="true" tabindex="-1"></a>    substring_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(peptide) <span class="op">*</span> <span class="dv">3</span></span>
<span id="cb110-48"><a href="#cb110-48" aria-hidden="true" tabindex="-1"></a>    encoding_substrings: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb110-49"><a href="#cb110-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-50"><a href="#cb110-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(dna_sequence) <span class="op">-</span> substring_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb110-51"><a href="#cb110-51" aria-hidden="true" tabindex="-1"></a>        dna_substring: <span class="bu">str</span> <span class="op">=</span> dna_sequence[i:i <span class="op">+</span> substring_length]</span>
<span id="cb110-52"><a href="#cb110-52" aria-hidden="true" tabindex="-1"></a>        reverse_complement_substring: <span class="bu">str</span> <span class="op">=</span> reverse_complement(dna_substring)</span>
<span id="cb110-53"><a href="#cb110-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-54"><a href="#cb110-54" aria-hidden="true" tabindex="-1"></a>        rna_substring: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(dna_substring)</span>
<span id="cb110-55"><a href="#cb110-55" aria-hidden="true" tabindex="-1"></a>        reverse_complement_rna: <span class="bu">str</span> <span class="op">=</span> dna_to_rna(reverse_complement_substring)</span>
<span id="cb110-56"><a href="#cb110-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-57"><a href="#cb110-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (translate_rna_to_protein(rna_substring) <span class="op">==</span> peptide <span class="kw">or</span></span>
<span id="cb110-58"><a href="#cb110-58" aria-hidden="true" tabindex="-1"></a>            translate_rna_to_protein(reverse_complement_rna) <span class="op">==</span> peptide):</span>
<span id="cb110-59"><a href="#cb110-59" aria-hidden="true" tabindex="-1"></a>            encoding_substrings.append(dna_substring)</span>
<span id="cb110-60"><a href="#cb110-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-61"><a href="#cb110-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> encoding_substrings</span>
<span id="cb110-62"><a href="#cb110-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-63"><a href="#cb110-63" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb110-64"><a href="#cb110-64" aria-hidden="true" tabindex="-1"></a><span class="st">ATGGCCATGGCCCCCAGAACTGAGATCAATAGTACCCGTATTAACGGGTGA</span></span>
<span id="cb110-65"><a href="#cb110-65" aria-hidden="true" tabindex="-1"></a><span class="st">MA</span></span>
<span id="cb110-66"><a href="#cb110-66" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb110-67"><a href="#cb110-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-68"><a href="#cb110-68" aria-hidden="true" tabindex="-1"></a>dna_sequence, peptide <span class="op">=</span> sample_input.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb110-69"><a href="#cb110-69" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> find_peptide_encoding_substrings(dna_sequence, peptide)</span>
<span id="cb110-70"><a href="#cb110-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-theoretical-spectrum-of-a-cyclic-peptide" class="level1" data-number="37">
<h1 data-number="37"><span class="header-section-number">37</span> Generate the Theoretical Spectrum of a Cyclic Peptide</h1>
<p>Generating Theoretical Spectrum Problem, Generate the theoretical spectrum of a cyclic peptide.</p>
<p>Given:&nbsp;An amino acid string&nbsp;<em>Peptide</em>.</p>
<p>Return:&nbsp;<em>Cyclospectrum</em>(<em>Peptide</em>).</p>
<section id="sample-dataset-37" class="level2" data-number="37.1">
<h2 data-number="37.1" class="anchored" data-anchor-id="sample-dataset-37"><span class="header-section-number">37.1</span> Sample Dataset</h2>
<pre><code>LEQN</code></pre>
</section>
<section id="sample-output-37" class="level2" data-number="37.2">
<h2 data-number="37.2" class="anchored" data-anchor-id="sample-output-37"><span class="header-section-number">37.2</span> Sample Output</h2>
<pre><code>0 113 114 128 129 227 242 242 257 355 356 370 371 484</code></pre>
</section>
<section id="solution-37" class="level2" data-number="37.3">
<h2 data-number="37.3" class="anchored" data-anchor-id="solution-37"><span class="header-section-number">37.3</span> Solution</h2>
<div class="sourceCode" id="cb113"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb113-5"><a href="#cb113-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb113-6"><a href="#cb113-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb113-7"><a href="#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="#cb113-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb113-9"><a href="#cb113-9" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide)</span>
<span id="cb113-10"><a href="#cb113-10" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb113-11"><a href="#cb113-11" aria-hidden="true" tabindex="-1"></a>    circular_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb113-12"><a href="#cb113-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-13"><a href="#cb113-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> subpeptide_length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb113-14"><a href="#cb113-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb113-15"><a href="#cb113-15" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> circular_peptide[start_index:start_index <span class="op">+</span> subpeptide_length]</span>
<span id="cb113-16"><a href="#cb113-16" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[amino_acid] <span class="cf">for</span> amino_acid <span class="kw">in</span> subpeptide)</span>
<span id="cb113-17"><a href="#cb113-17" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb113-18"><a href="#cb113-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-19"><a href="#cb113-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(spectrum)</span>
<span id="cb113-20"><a href="#cb113-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-21"><a href="#cb113-21" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb113-22"><a href="#cb113-22" aria-hidden="true" tabindex="-1"></a><span class="st">LEQN</span></span>
<span id="cb113-23"><a href="#cb113-23" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb113-24"><a href="#cb113-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-25"><a href="#cb113-25" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb113-26"><a href="#cb113-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-27"><a href="#cb113-27" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(input_peptide)</span>
<span id="cb113-28"><a href="#cb113-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-number-of-peptides-of-given-total-mass" class="level1" data-number="38">
<h1 data-number="38"><span class="header-section-number">38</span> Compute the Number of Peptides of Given Total Mass</h1>
<p>Counting Peptides with Given Mass Problem, Compute the number of peptides of given total mass.</p>
<p>Given:&nbsp;An integer&nbsp;<em>m</em>.</p>
<p>Return:&nbsp;The number of linear peptides having integer mass&nbsp;<em>m</em>.</p>
<section id="sample-dataset-38" class="level2" data-number="38.1">
<h2 data-number="38.1" class="anchored" data-anchor-id="sample-dataset-38"><span class="header-section-number">38.1</span> Sample Dataset</h2>
<pre><code>1024</code></pre>
</section>
<section id="sample-output-38" class="level2" data-number="38.2">
<h2 data-number="38.2" class="anchored" data-anchor-id="sample-output-38"><span class="header-section-number">38.2</span> Sample Output</h2>
<pre><code>14712706211</code></pre>
</section>
<section id="solution-38" class="level2" data-number="38.3">
<h2 data-number="38.3" class="anchored" data-anchor-id="solution-38"><span class="header-section-number">38.3</span> Solution</h2>
<div class="sourceCode" id="cb116"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a>LIGHTEST_AMINO_ACID: <span class="bu">int</span> <span class="op">=</span> <span class="bu">min</span>(AMINO_ACID_MASSES)</span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_possible_peptides(target_mass: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a>    peptide_count: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_mass <span class="kw">in</span> <span class="bu">range</span>(LIGHTEST_AMINO_ACID, target_mass <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>        peptide_count[current_mass] <span class="op">=</span> <span class="bu">sum</span>(<span class="dv">1</span> <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES <span class="cf">if</span> amino_acid_mass <span class="op">==</span> current_mass)</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> amino_acid_mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_mass <span class="op">&gt;=</span> amino_acid_mass:</span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a>                peptide_count[current_mass] <span class="op">+=</span> peptide_count[current_mass <span class="op">-</span> amino_acid_mass]</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide_count[target_mass]</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-19"><a href="#cb116-19" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb116-20"><a href="#cb116-20" aria-hidden="true" tabindex="-1"></a><span class="st">1024</span></span>
<span id="cb116-21"><a href="#cb116-21" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb116-22"><a href="#cb116-22" aria-hidden="true" tabindex="-1"></a>target_peptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(sample_input.strip())</span>
<span id="cb116-23"><a href="#cb116-23" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> count_possible_peptides(target_peptide_mass)</span>
<span id="cb116-24"><a href="#cb116-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-cyclic-peptide-with-theoretical-spectrum-matching-an-ideal-spectrum" class="level1" data-number="39">
<h1 data-number="39"><span class="header-section-number">39</span> Find a Cyclic Peptide with Theoretical Spectrum Matching an Ideal Spectrum</h1>
<p>Cyclopeptide Sequencing Problem, Given an ideal experimental spectrum, find a cyclic peptide whose theoretical spectrum matches the experimental spectrum.</p>
<p>Given:&nbsp;A collection of (possibly repeated) integers&nbsp;<em>Spectrum</em>&nbsp;corresponding to an ideal experimental spectrum.</p>
<p>Return:&nbsp;Every amino acid string&nbsp;<em>Peptide</em>&nbsp;such that&nbsp;<em>Cyclospectrum</em>(<em>Peptide</em>) =&nbsp;<em>Spectrum</em>&nbsp;(if such a string exists).</p>
<section id="sample-dataset-39" class="level2" data-number="39.1">
<h2 data-number="39.1" class="anchored" data-anchor-id="sample-dataset-39"><span class="header-section-number">39.1</span> Sample Dataset</h2>
<pre><code>0 113 128 186 241 299 314 427</code></pre>
</section>
<section id="sample-output-39" class="level2" data-number="39.2">
<h2 data-number="39.2" class="anchored" data-anchor-id="sample-output-39"><span class="header-section-number">39.2</span> Sample Output</h2>
<pre><code>113-128-186 113-186-128 186-128-113 128-186-113 186-113-128 128-113-186</code></pre>
</section>
<section id="solution-39" class="level2" data-number="39.3">
<h2 data-number="39.3" class="anchored" data-anchor-id="solution-39"><span class="header-section-number">39.3</span> Solution</h2>
<div class="sourceCode" id="cb119"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>    prefix_mass: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> peptide:</span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>        prefix_mass.append(prefix_mass[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> mass)</span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb119-20"><a href="#cb119-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb119-21"><a href="#cb119-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb119-22"><a href="#cb119-22" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(prefix_mass[j] <span class="op">-</span> prefix_mass[i])</span>
<span id="cb119-23"><a href="#cb119-23" aria-hidden="true" tabindex="-1"></a>    linear_spectrum.sort()</span>
<span id="cb119-24"><a href="#cb119-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_spectrum</span>
<span id="cb119-25"><a href="#cb119-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-26"><a href="#cb119-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb119-27"><a href="#cb119-27" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb119-28"><a href="#cb119-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb119-29"><a href="#cb119-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb119-30"><a href="#cb119-30" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb119-31"><a href="#cb119-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb119-32"><a href="#cb119-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-33"><a href="#cb119-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb119-34"><a href="#cb119-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>] <span class="op">-</span> AMINO_ACID_MASSES[<span class="dv">0</span>]:</span>
<span id="cb119-35"><a href="#cb119-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb119-36"><a href="#cb119-36" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb119-37"><a href="#cb119-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(mass <span class="kw">in</span> spectrum <span class="cf">for</span> mass <span class="kw">in</span> peptide_spectrum)</span>
<span id="cb119-38"><a href="#cb119-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-39"><a href="#cb119-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb119-40"><a href="#cb119-40" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb119-41"><a href="#cb119-41" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb119-42"><a href="#cb119-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-43"><a href="#cb119-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb119-44"><a href="#cb119-44" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb119-45"><a href="#cb119-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb119-46"><a href="#cb119-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb119-47"><a href="#cb119-47" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb119-48"><a href="#cb119-48" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb119-49"><a href="#cb119-49" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb119-50"><a href="#cb119-50" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb119-51"><a href="#cb119-51" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb119-52"><a href="#cb119-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-53"><a href="#cb119-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb119-54"><a href="#cb119-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-55"><a href="#cb119-55" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb119-56"><a href="#cb119-56" aria-hidden="true" tabindex="-1"></a><span class="st">0 113 128 186 241 299 314 427</span></span>
<span id="cb119-57"><a href="#cb119-57" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb119-58"><a href="#cb119-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-59"><a href="#cb119-59" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb119-60"><a href="#cb119-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-61"><a href="#cb119-61" aria-hidden="true" tabindex="-1"></a>result: Set[<span class="bu">str</span>] <span class="op">=</span> cyclopeptide_sequencing(input_spectrum)</span>
<span id="cb119-62"><a href="#cb119-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-score-of-a-cyclic-peptide-against-a-spectrum" class="level1" data-number="40">
<h1 data-number="40"><span class="header-section-number">40</span> Compute the Score of a Cyclic Peptide Against a Spectrum</h1>
<p>Cyclic Peptide Scoring Problem, Compute the score of a cyclic peptide against a spectrum.</p>
<p>Given:&nbsp;An amino acid string&nbsp;<em>Peptide</em>&nbsp;and a collection of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;The score of&nbsp;<em>Peptide</em>&nbsp;against&nbsp;<em>Spectrum</em>,&nbsp;<em>Score</em>(<em>Peptide</em>,&nbsp;<em>Spectrum</em>).</p>
<section id="sample-dataset-40" class="level2" data-number="40.1">
<h2 data-number="40.1" class="anchored" data-anchor-id="sample-dataset-40"><span class="header-section-number">40.1</span> Sample Dataset</h2>
<pre><code>NQEL
0 99 113 114 128 227 257 299 355 356 370 371 484</code></pre>
</section>
<section id="sample-output-40" class="level2" data-number="40.2">
<h2 data-number="40.2" class="anchored" data-anchor-id="sample-output-40"><span class="header-section-number">40.2</span> Sample Output</h2>
<pre><code>11</code></pre>
</section>
<section id="solution-40" class="level2" data-number="40.3">
<h2 data-number="40.3" class="anchored" data-anchor-id="solution-40"><span class="header-section-number">40.3</span> Solution</h2>
<div class="sourceCode" id="cb122"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> peptide)</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    extended_peptide: <span class="bu">str</span> <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>            subpeptide: <span class="bu">str</span> <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb122-16"><a href="#cb122-16" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(AMINO_ACID_MASSES[aa] <span class="cf">for</span> aa <span class="kw">in</span> subpeptide)</span>
<span id="cb122-17"><a href="#cb122-17" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb122-18"><a href="#cb122-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-19"><a href="#cb122-19" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb122-20"><a href="#cb122-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb122-21"><a href="#cb122-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-22"><a href="#cb122-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb122-23"><a href="#cb122-23" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb122-24"><a href="#cb122-24" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb122-25"><a href="#cb122-25" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb122-26"><a href="#cb122-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-27"><a href="#cb122-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb122-28"><a href="#cb122-28" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb122-29"><a href="#cb122-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-30"><a href="#cb122-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb122-31"><a href="#cb122-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-32"><a href="#cb122-32" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb122-33"><a href="#cb122-33" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb122-34"><a href="#cb122-34" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb122-35"><a href="#cb122-35" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb122-36"><a href="#cb122-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-37"><a href="#cb122-37" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb122-38"><a href="#cb122-38" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb122-39"><a href="#cb122-39" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb122-40"><a href="#cb122-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb122-41"><a href="#cb122-41" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_score(input_peptide, input_spectrum)</span>
<span id="cb122-42"><a href="#cb122-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-leaderboardcyclopeptidesequencing" class="level1" data-number="41">
<h1 data-number="41"><span class="header-section-number">41</span> Implement LeaderboardCyclopeptideSequencing</h1>
<p>Implement&nbsp;<em>LeaderboardCyclopeptideSequencing</em></p>
<p>Given:&nbsp;An integer&nbsp;<em>N</em>&nbsp;and a collection of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;<em>LeaderPeptide</em>&nbsp;after running&nbsp;<em>LeaderboardCyclopeptideSequencing</em>(<em>Spectrum</em>,&nbsp;<em>N</em>).</p>
<section id="sample-dataset-41" class="level2" data-number="41.1">
<h2 data-number="41.1" class="anchored" data-anchor-id="sample-dataset-41"><span class="header-section-number">41.1</span> Sample Dataset</h2>
<pre><code>10
0 71 113 129 147 200 218 260 313 331 347 389 460</code></pre>
</section>
<section id="sample-output-41" class="level2" data-number="41.2">
<h2 data-number="41.2" class="anchored" data-anchor-id="sample-output-41"><span class="header-section-number">41.2</span> Sample Output</h2>
<pre><code>113-147-71-129</code></pre>
</section>
<section id="solution-41" class="level2" data-number="41.3">
<h2 data-number="41.3" class="anchored" data-anchor-id="solution-41"><span class="header-section-number">41.3</span> Solution</h2>
<div class="sourceCode" id="cb125"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Dict</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">57</span>, <span class="dv">71</span>, <span class="dv">87</span>, <span class="dv">97</span>, <span class="dv">99</span>, <span class="dv">101</span>, <span class="dv">103</span>, <span class="dv">113</span>, <span class="dv">114</span>, <span class="dv">115</span>, <span class="dv">128</span>, <span class="dv">129</span>, <span class="dv">131</span>, <span class="dv">137</span>, <span class="dv">147</span>, <span class="dv">156</span>, <span class="dv">163</span>, <span class="dv">186</span>]</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> AMINO_ACID_MASSES:</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>    total_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(peptide)</span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, total_mass]</span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> length <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> start <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[start:start <span class="op">+</span> length]</span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(subpeptide)</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a>            spectrum.append(subpeptide_mass)</span>
<span id="cb125-22"><a href="#cb125-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-23"><a href="#cb125-23" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb125-24"><a href="#cb125-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb125-25"><a href="#cb125-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-26"><a href="#cb125-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_consistent(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb125-27"><a href="#cb125-27" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb125-28"><a href="#cb125-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(peptide_spectrum.count(mass) <span class="op">&lt;=</span> spectrum.count(mass) <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(peptide_spectrum))</span>
<span id="cb125-29"><a href="#cb125-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-30"><a href="#cb125-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb125-31"><a href="#cb125-31" aria-hidden="true" tabindex="-1"></a>    result: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb125-32"><a href="#cb125-32" aria-hidden="true" tabindex="-1"></a>    candidate_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb125-33"><a href="#cb125-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> candidate_peptides:</span>
<span id="cb125-34"><a href="#cb125-34" aria-hidden="true" tabindex="-1"></a>        candidate_peptides <span class="op">=</span> expand_peptides(candidate_peptides)</span>
<span id="cb125-35"><a href="#cb125-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> candidate_peptides[:]:</span>
<span id="cb125-36"><a href="#cb125-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb125-37"><a href="#cb125-37" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_cyclospectrum(peptide) <span class="op">==</span> spectrum:</span>
<span id="cb125-38"><a href="#cb125-38" aria-hidden="true" tabindex="-1"></a>                    result.add(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, peptide)))</span>
<span id="cb125-39"><a href="#cb125-39" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb125-40"><a href="#cb125-40" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="kw">not</span> is_consistent(peptide, spectrum):</span>
<span id="cb125-41"><a href="#cb125-41" aria-hidden="true" tabindex="-1"></a>                candidate_peptides.remove(peptide)</span>
<span id="cb125-42"><a href="#cb125-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb125-43"><a href="#cb125-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-44"><a href="#cb125-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb125-45"><a href="#cb125-45" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb125-46"><a href="#cb125-46" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb125-47"><a href="#cb125-47" aria-hidden="true" tabindex="-1"></a>    unique_masses: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb125-48"><a href="#cb125-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb125-49"><a href="#cb125-49" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb125-50"><a href="#cb125-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb125-51"><a href="#cb125-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-52"><a href="#cb125-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb125-53"><a href="#cb125-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb125-54"><a href="#cb125-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb125-55"><a href="#cb125-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-56"><a href="#cb125-56" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb125-57"><a href="#cb125-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb125-58"><a href="#cb125-58" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb125-59"><a href="#cb125-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-60"><a href="#cb125-60" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb125-61"><a href="#cb125-61" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> n <span class="op">&lt;=</span> <span class="bu">len</span>(sorted_scores) <span class="cf">else</span> sorted_scores[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb125-62"><a href="#cb125-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-63"><a href="#cb125-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb125-64"><a href="#cb125-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-65"><a href="#cb125-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaderboard_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb125-66"><a href="#cb125-66" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb125-67"><a href="#cb125-67" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb125-68"><a href="#cb125-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-69"><a href="#cb125-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb125-70"><a href="#cb125-70" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard)</span>
<span id="cb125-71"><a href="#cb125-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb125-72"><a href="#cb125-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb125-73"><a href="#cb125-73" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb125-74"><a href="#cb125-74" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb125-75"><a href="#cb125-75" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb125-76"><a href="#cb125-76" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb125-77"><a href="#cb125-77" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb125-78"><a href="#cb125-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb125-79"><a href="#cb125-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-80"><a href="#cb125-80" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb125-81"><a href="#cb125-81" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb125-82"><a href="#cb125-82" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 113 129 147 200 218 260 313 331 347 389 460</span></span>
<span id="cb125-83"><a href="#cb125-83" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb125-84"><a href="#cb125-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-85"><a href="#cb125-85" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb125-86"><a href="#cb125-86" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb125-87"><a href="#cb125-87" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb125-88"><a href="#cb125-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-89"><a href="#cb125-89" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> leaderboard_cyclopeptide_sequencing(spectrum, n)</span>
<span id="cb125-90"><a href="#cb125-90" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-convolution-of-a-spectrum" class="level1" data-number="42">
<h1 data-number="42"><span class="header-section-number">42</span> Generate the Convolution of a Spectrum</h1>
<p>Spectral Convolution Problem, Compute the convolution of a spectrum.</p>
<p>Given:&nbsp;A collection of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;The list of elements in the convolution of&nbsp;<em>Spectrum</em>&nbsp;in decreasing order of their multiplicities. If an element has multiplicity&nbsp;<em>k</em>, it should appear exactly&nbsp;<em>k</em>&nbsp;times.</p>
<section id="sample-dataset-42" class="level2" data-number="42.1">
<h2 data-number="42.1" class="anchored" data-anchor-id="sample-dataset-42"><span class="header-section-number">42.1</span> Sample Dataset</h2>
<pre><code>0 137 186 323</code></pre>
</section>
<section id="sample-output-42" class="level2" data-number="42.2">
<h2 data-number="42.2" class="anchored" data-anchor-id="sample-output-42"><span class="header-section-number">42.2</span> Sample Output</h2>
<pre><code>137 137 186 186 323 49</code></pre>
</section>
<section id="solution-42" class="level2" data-number="42.3">
<h2 data-number="42.3" class="anchored" data-anchor-id="solution-42"><span class="header-section-number">42.3</span> Solution</h2>
<div class="sourceCode" id="cb128"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(spectrum)):</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a>            mass_difference: <span class="bu">int</span> <span class="op">=</span> spectrum[j] <span class="op">-</span> spectrum[i]</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> mass_difference <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(mass_difference)</span>
<span id="cb128-12"><a href="#cb128-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-13"><a href="#cb128-13" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb128-14"><a href="#cb128-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb128-15"><a href="#cb128-15" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb128-16"><a href="#cb128-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-17"><a href="#cb128-17" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict, key<span class="op">=</span>frequency_dict.get, reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb128-18"><a href="#cb128-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-19"><a href="#cb128-19" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb128-20"><a href="#cb128-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb128-21"><a href="#cb128-21" aria-hidden="true" tabindex="-1"></a>        result.extend([mass] <span class="op">*</span> frequency_dict[mass])</span>
<span id="cb128-22"><a href="#cb128-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-23"><a href="#cb128-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb128-24"><a href="#cb128-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-25"><a href="#cb128-25" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb128-26"><a href="#cb128-26" aria-hidden="true" tabindex="-1"></a><span class="st">0 137 186 323</span></span>
<span id="cb128-27"><a href="#cb128-27" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb128-28"><a href="#cb128-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-29"><a href="#cb128-29" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb128-30"><a href="#cb128-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-31"><a href="#cb128-31" aria-hidden="true" tabindex="-1"></a>convolution_result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(input_spectrum)</span>
<span id="cb128-32"><a href="#cb128-32" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, convolution_result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-convolutioncyclopeptidesequencing" class="level1" data-number="43">
<h1 data-number="43"><span class="header-section-number">43</span> Implement ConvolutionCyclopeptideSequencing</h1>
<p>Implement&nbsp;<em>ConvolutionCyclopeptideSequencing</em>.</p>
<p>Given:&nbsp;An integer&nbsp;<em>M</em>, an integer&nbsp;<em>N</em>, and a collection of (possibly repeated) integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;A cyclic peptide LeaderPeptide with amino acids taken only from the top&nbsp;<em>M</em>&nbsp;elements (and ties) of the convolution of&nbsp;<em>Spectrum</em>&nbsp;that fall between 57 and 200, and where the size of&nbsp;<em>Leaderboard</em>&nbsp;is restricted to the top&nbsp;<em>N</em>&nbsp;(and ties).</p>
<section id="sample-dataset-43" class="level2" data-number="43.1">
<h2 data-number="43.1" class="anchored" data-anchor-id="sample-dataset-43"><span class="header-section-number">43.1</span> Sample Dataset</h2>
<pre><code>20
60
57 57 71 99 129 137 170 186 194 208 228 265 285 299 307 323 356 364 394 422 493</code></pre>
</section>
<section id="sample-output-43" class="level2" data-number="43.2">
<h2 data-number="43.2" class="anchored" data-anchor-id="sample-output-43"><span class="header-section-number">43.2</span> Sample Output</h2>
<pre><code>99-71-137-57-72-57</code></pre>
</section>
<section id="solution-43" class="level2" data-number="43.3">
<h2 data-number="43.3" class="anchored" data-anchor-id="solution-43"><span class="header-section-number">43.3</span> Solution</h2>
<div class="sourceCode" id="cb131"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectrum_convolution(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a>    convolution_list: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectrum)):</span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spectrum[j] <span class="op">-</span> spectrum[i] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>                convolution_list.append(spectrum[j] <span class="op">-</span> spectrum[i])</span>
<span id="cb131-10"><a href="#cb131-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-11"><a href="#cb131-11" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb131-12"><a href="#cb131-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(convolution_list):</span>
<span id="cb131-13"><a href="#cb131-13" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> convolution_list.count(mass)</span>
<span id="cb131-14"><a href="#cb131-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-15"><a href="#cb131-15" aria-hidden="true" tabindex="-1"></a>    sorted_masses: List[<span class="bu">int</span>] <span class="op">=</span> [k <span class="cf">for</span> k, _ <span class="kw">in</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> item: item[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)]</span>
<span id="cb131-16"><a href="#cb131-16" aria-hidden="true" tabindex="-1"></a>    result: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb131-17"><a href="#cb131-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> sorted_masses:</span>
<span id="cb131-18"><a href="#cb131-18" aria-hidden="true" tabindex="-1"></a>        result <span class="op">+=</span> [mass] <span class="op">*</span> frequency_dict[mass]</span>
<span id="cb131-19"><a href="#cb131-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb131-20"><a href="#cb131-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-21"><a href="#cb131-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[List[<span class="bu">int</span>]], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb131-22"><a href="#cb131-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb131-23"><a href="#cb131-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb131-24"><a href="#cb131-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-25"><a href="#cb131-25" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb131-26"><a href="#cb131-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb131-27"><a href="#cb131-27" aria-hidden="true" tabindex="-1"></a>        scores[i] <span class="op">=</span> calculate_score(peptide, spectrum)</span>
<span id="cb131-28"><a href="#cb131-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-29"><a href="#cb131-29" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb131-30"><a href="#cb131-30" aria-hidden="true" tabindex="-1"></a>    threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb131-31"><a href="#cb131-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-32"><a href="#cb131-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> threshold]</span>
<span id="cb131-33"><a href="#cb131-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-34"><a href="#cb131-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_cyclospectrum(peptide: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb131-35"><a href="#cb131-35" aria-hidden="true" tabindex="-1"></a>    spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>, <span class="bu">sum</span>(peptide)]</span>
<span id="cb131-36"><a href="#cb131-36" aria-hidden="true" tabindex="-1"></a>    extended_peptide: List[<span class="bu">int</span>] <span class="op">=</span> peptide <span class="op">+</span> peptide</span>
<span id="cb131-37"><a href="#cb131-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(peptide)):</span>
<span id="cb131-38"><a href="#cb131-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb131-39"><a href="#cb131-39" aria-hidden="true" tabindex="-1"></a>            subpeptide: List[<span class="bu">int</span>] <span class="op">=</span> extended_peptide[i:i <span class="op">+</span> k]</span>
<span id="cb131-40"><a href="#cb131-40" aria-hidden="true" tabindex="-1"></a>            spectrum.append(<span class="bu">sum</span>(subpeptide))</span>
<span id="cb131-41"><a href="#cb131-41" aria-hidden="true" tabindex="-1"></a>    spectrum.sort()</span>
<span id="cb131-42"><a href="#cb131-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> spectrum</span>
<span id="cb131-43"><a href="#cb131-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-44"><a href="#cb131-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(peptide: List[<span class="bu">int</span>], spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb131-45"><a href="#cb131-45" aria-hidden="true" tabindex="-1"></a>    peptide_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_cyclospectrum(peptide)</span>
<span id="cb131-46"><a href="#cb131-46" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb131-47"><a href="#cb131-47" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(peptide_spectrum <span class="op">+</span> spectrum)</span>
<span id="cb131-48"><a href="#cb131-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb131-49"><a href="#cb131-49" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(peptide_spectrum.count(mass), spectrum.count(mass))</span>
<span id="cb131-50"><a href="#cb131-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb131-51"><a href="#cb131-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-52"><a href="#cb131-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_top_masses(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb131-53"><a href="#cb131-53" aria-hidden="true" tabindex="-1"></a>    convolution: List[<span class="bu">int</span>] <span class="op">=</span> calculate_spectrum_convolution(spectrum)</span>
<span id="cb131-54"><a href="#cb131-54" aria-hidden="true" tabindex="-1"></a>    filtered_convolution: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> convolution <span class="cf">if</span> <span class="dv">57</span> <span class="op">&lt;=</span> x <span class="op">&lt;=</span> <span class="dv">200</span>]</span>
<span id="cb131-55"><a href="#cb131-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-56"><a href="#cb131-56" aria-hidden="true" tabindex="-1"></a>    frequency_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb131-57"><a href="#cb131-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> <span class="bu">set</span>(filtered_convolution):</span>
<span id="cb131-58"><a href="#cb131-58" aria-hidden="true" tabindex="-1"></a>        frequency_dict[mass] <span class="op">=</span> filtered_convolution.count(mass)</span>
<span id="cb131-59"><a href="#cb131-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-60"><a href="#cb131-60" aria-hidden="true" tabindex="-1"></a>    sorted_elements: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> <span class="bu">sorted</span>(frequency_dict.items(), key<span class="op">=</span><span class="kw">lambda</span> kv: kv[<span class="dv">1</span>], reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb131-61"><a href="#cb131-61" aria-hidden="true" tabindex="-1"></a>    top_masses: List[<span class="bu">int</span>] <span class="op">=</span> [mass <span class="cf">for</span> mass, freq <span class="kw">in</span> sorted_elements <span class="cf">if</span> freq <span class="op">&gt;=</span> sorted_elements[m <span class="op">-</span> <span class="dv">1</span>][<span class="dv">1</span>]]</span>
<span id="cb131-62"><a href="#cb131-62" aria-hidden="true" tabindex="-1"></a>    top_masses.sort()</span>
<span id="cb131-63"><a href="#cb131-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> top_masses</span>
<span id="cb131-64"><a href="#cb131-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-65"><a href="#cb131-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> expand_peptides(peptides: List[List[<span class="bu">int</span>]], masses: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb131-66"><a href="#cb131-66" aria-hidden="true" tabindex="-1"></a>    expanded_peptides: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb131-67"><a href="#cb131-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> peptides:</span>
<span id="cb131-68"><a href="#cb131-68" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> mass <span class="kw">in</span> masses:</span>
<span id="cb131-69"><a href="#cb131-69" aria-hidden="true" tabindex="-1"></a>            expanded_peptides.append(peptide <span class="op">+</span> [mass])</span>
<span id="cb131-70"><a href="#cb131-70" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> expanded_peptides</span>
<span id="cb131-71"><a href="#cb131-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-72"><a href="#cb131-72" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convolution_cyclopeptide_sequencing(spectrum: List[<span class="bu">int</span>], m: <span class="bu">int</span>, n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb131-73"><a href="#cb131-73" aria-hidden="true" tabindex="-1"></a>    masses: List[<span class="bu">int</span>] <span class="op">=</span> find_top_masses(spectrum, m)</span>
<span id="cb131-74"><a href="#cb131-74" aria-hidden="true" tabindex="-1"></a>    leaderboard: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[]]</span>
<span id="cb131-75"><a href="#cb131-75" aria-hidden="true" tabindex="-1"></a>    leader_peptide: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb131-76"><a href="#cb131-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-77"><a href="#cb131-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> leaderboard:</span>
<span id="cb131-78"><a href="#cb131-78" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> expand_peptides(leaderboard, masses)</span>
<span id="cb131-79"><a href="#cb131-79" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> peptide <span class="kw">in</span> leaderboard[:]:</span>
<span id="cb131-80"><a href="#cb131-80" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">sum</span>(peptide) <span class="op">==</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb131-81"><a href="#cb131-81" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> calculate_score(peptide, spectrum) <span class="op">&gt;</span> calculate_score(leader_peptide, spectrum):</span>
<span id="cb131-82"><a href="#cb131-82" aria-hidden="true" tabindex="-1"></a>                    leader_peptide <span class="op">=</span> peptide</span>
<span id="cb131-83"><a href="#cb131-83" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> <span class="bu">sum</span>(peptide) <span class="op">&gt;</span> spectrum[<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb131-84"><a href="#cb131-84" aria-hidden="true" tabindex="-1"></a>                leaderboard.remove(peptide)</span>
<span id="cb131-85"><a href="#cb131-85" aria-hidden="true" tabindex="-1"></a>        leaderboard <span class="op">=</span> trim_leaderboard(leaderboard, spectrum, n)</span>
<span id="cb131-86"><a href="#cb131-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> leader_peptide</span>
<span id="cb131-87"><a href="#cb131-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-88"><a href="#cb131-88" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb131-89"><a href="#cb131-89" aria-hidden="true" tabindex="-1"></a><span class="st">20</span></span>
<span id="cb131-90"><a href="#cb131-90" aria-hidden="true" tabindex="-1"></a><span class="st">60</span></span>
<span id="cb131-91"><a href="#cb131-91" aria-hidden="true" tabindex="-1"></a><span class="st">57 57 71 99 129 137 170 186 194 208 228 265 285 299 307 323 356 364 394 422 493</span></span>
<span id="cb131-92"><a href="#cb131-92" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb131-93"><a href="#cb131-93" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb131-94"><a href="#cb131-94" aria-hidden="true" tabindex="-1"></a>m: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb131-95"><a href="#cb131-95" aria-hidden="true" tabindex="-1"></a>n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb131-96"><a href="#cb131-96" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">2</span>].split()]</span>
<span id="cb131-97"><a href="#cb131-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-98"><a href="#cb131-98" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> convolution_cyclopeptide_sequencing(spectrum, m, n)</span>
<span id="cb131-99"><a href="#cb131-99" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-"</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-theoretical-spectrum-of-a-linear-peptide" class="level1" data-number="44">
<h1 data-number="44"><span class="header-section-number">44</span> Generate the Theoretical Spectrum of a Linear Peptide</h1>
<p>Linear Spectrum Problem, Generate the ideal linear spectrum of a peptide.</p>
<p>Given:&nbsp;An&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid string</a>&nbsp;<em>Peptide</em>.</p>
<p>Return:&nbsp;The linear spectrum of&nbsp;<em>Peptide</em>.</p>
<section id="sample-dataset-44" class="level2" data-number="44.1">
<h2 data-number="44.1" class="anchored" data-anchor-id="sample-dataset-44"><span class="header-section-number">44.1</span> Sample Dataset</h2>
<pre><code>NQEL</code></pre>
</section>
<section id="sample-output-44" class="level2" data-number="44.2">
<h2 data-number="44.2" class="anchored" data-anchor-id="sample-output-44"><span class="header-section-number">44.2</span> Sample Output</h2>
<pre><code>0 113 114 128 129 242 242 257 370 371 484</code></pre>
</section>
<section id="solution-44" class="level2" data-number="44.3">
<h2 data-number="44.3" class="anchored" data-anchor-id="solution-44"><span class="header-section-number">44.3</span> Solution</h2>
<div class="sourceCode" id="cb134"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb134-5"><a href="#cb134-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb134-6"><a href="#cb134-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb134-7"><a href="#cb134-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb134-8"><a href="#cb134-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-9"><a href="#cb134-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb134-10"><a href="#cb134-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb134-11"><a href="#cb134-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-12"><a href="#cb134-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb134-13"><a href="#cb134-13" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb134-14"><a href="#cb134-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb134-15"><a href="#cb134-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-16"><a href="#cb134-16" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb134-17"><a href="#cb134-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-18"><a href="#cb134-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb134-19"><a href="#cb134-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb134-20"><a href="#cb134-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb134-21"><a href="#cb134-21" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb134-22"><a href="#cb134-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-23"><a href="#cb134-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb134-24"><a href="#cb134-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-25"><a href="#cb134-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb134-26"><a href="#cb134-26" aria-hidden="true" tabindex="-1"></a>sample_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">"NQEL"</span></span>
<span id="cb134-27"><a href="#cb134-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-28"><a href="#cb134-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear spectrum</span></span>
<span id="cb134-29"><a href="#cb134-29" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(sample_peptide)</span>
<span id="cb134-30"><a href="#cb134-30" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-score-of-a-linear-peptide" class="level1" data-number="45">
<h1 data-number="45"><span class="header-section-number">45</span> Compute the Score of a Linear Peptide</h1>
<p>Linear Peptide Scoring Problem, Compute the score of a linear peptide with respect to a spectrum.</p>
<p>Given:&nbsp;An amino acid string&nbsp;<em>Peptide</em>&nbsp;and a collection of integers&nbsp;<em>LinearSpectrum</em>.</p>
<p>Return:&nbsp;The linear score of&nbsp;<em>Peptide</em>&nbsp;against&nbsp;<em>Spectrum</em>,&nbsp;<em>LinearScore</em>(<em>Peptide</em>,&nbsp;<em>Spectrum</em>).</p>
<section id="sample-dataset-45" class="level2" data-number="45.1">
<h2 data-number="45.1" class="anchored" data-anchor-id="sample-dataset-45"><span class="header-section-number">45.1</span> Sample Dataset</h2>
<pre><code>NQEL
0 99 113 114 128 227 257 299 355 356 370 371 484</code></pre>
</section>
<section id="sample-output-45" class="level2" data-number="45.2">
<h2 data-number="45.2" class="anchored" data-anchor-id="sample-output-45"><span class="header-section-number">45.2</span> Sample Output</h2>
<pre><code>8</code></pre>
</section>
<section id="solution-45" class="level2" data-number="45.3">
<h2 data-number="45.3" class="anchored" data-anchor-id="solution-45"><span class="header-section-number">45.3</span> Solution</h2>
<div class="sourceCode" id="cb137"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-18"><a href="#cb137-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb137-19"><a href="#cb137-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb137-20"><a href="#cb137-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb137-21"><a href="#cb137-21" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb137-22"><a href="#cb137-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-23"><a href="#cb137-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb137-24"><a href="#cb137-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-25"><a href="#cb137-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb137-26"><a href="#cb137-26" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb137-27"><a href="#cb137-27" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb137-28"><a href="#cb137-28" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb137-29"><a href="#cb137-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-30"><a href="#cb137-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb137-31"><a href="#cb137-31" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb137-32"><a href="#cb137-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-33"><a href="#cb137-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb137-34"><a href="#cb137-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-35"><a href="#cb137-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb137-36"><a href="#cb137-36" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb137-37"><a href="#cb137-37" aria-hidden="true" tabindex="-1"></a><span class="st">NQEL</span></span>
<span id="cb137-38"><a href="#cb137-38" aria-hidden="true" tabindex="-1"></a><span class="st">0 99 113 114 128 227 257 299 355 356 370 371 484</span></span>
<span id="cb137-39"><a href="#cb137-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb137-40"><a href="#cb137-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-41"><a href="#cb137-41" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb137-42"><a href="#cb137-42" aria-hidden="true" tabindex="-1"></a>input_peptide: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb137-43"><a href="#cb137-43" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb137-44"><a href="#cb137-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-45"><a href="#cb137-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate and print the linear score</span></span>
<span id="cb137-46"><a href="#cb137-46" aria-hidden="true" tabindex="-1"></a>result: <span class="bu">int</span> <span class="op">=</span> calculate_linear_score(input_peptide, input_spectrum)</span>
<span id="cb137-47"><a href="#cb137-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="trim-a-peptide-leaderboard" class="level1" data-number="46">
<h1 data-number="46"><span class="header-section-number">46</span> Trim a Peptide Leaderboard</h1>
<p>Trim Problem, Trim a leaderboard of peptides.</p>
<p>Given:&nbsp;A leaderboard of linear peptides&nbsp;<em>Leaderboard</em>, a linear spectrum&nbsp;<em>Spectrum</em>, and an integer&nbsp;<em>N</em>.</p>
<p>Return:&nbsp;The top&nbsp;<em>N</em>&nbsp;peptides from&nbsp;<em>Leaderboard</em>&nbsp;scored against&nbsp;<em>Spectrum</em>. Remember to use&nbsp;<em>LinearScore</em>.</p>
<section id="sample-dataset-46" class="level2" data-number="46.1">
<h2 data-number="46.1" class="anchored" data-anchor-id="sample-dataset-46"><span class="header-section-number">46.1</span> Sample Dataset</h2>
<pre><code>LAST ALST TLLT TQAS
0 71 87 101 113 158 184 188 259 271 372
2</code></pre>
</section>
<section id="sample-output-46" class="level2" data-number="46.2">
<h2 data-number="46.2" class="anchored" data-anchor-id="sample-output-46"><span class="header-section-number">46.2</span> Sample Output</h2>
<pre><code>LAST ALST</code></pre>
</section>
<section id="solution-46" class="level2" data-number="46.3">
<h2 data-number="46.3" class="anchored" data-anchor-id="solution-46"><span class="header-section-number">46.3</span> Solution</h2>
<div class="sourceCode" id="cb140"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict</span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>AMINO_ACID_MASSES: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>,</span>
<span id="cb140-5"><a href="#cb140-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>,</span>
<span id="cb140-6"><a href="#cb140-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb140-7"><a href="#cb140-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb140-8"><a href="#cb140-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-9"><a href="#cb140-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb140-10"><a href="#cb140-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb140-11"><a href="#cb140-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-12"><a href="#cb140-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb140-13"><a href="#cb140-13" aria-hidden="true" tabindex="-1"></a>        current_mass <span class="op">=</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> AMINO_ACID_MASSES[amino_acid]</span>
<span id="cb140-14"><a href="#cb140-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(current_mass)</span>
<span id="cb140-15"><a href="#cb140-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-16"><a href="#cb140-16" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb140-17"><a href="#cb140-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-18"><a href="#cb140-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb140-19"><a href="#cb140-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb140-20"><a href="#cb140-20" aria-hidden="true" tabindex="-1"></a>            subpeptide_mass <span class="op">=</span> prefix_masses[j] <span class="op">-</span> prefix_masses[i]</span>
<span id="cb140-21"><a href="#cb140-21" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(subpeptide_mass)</span>
<span id="cb140-22"><a href="#cb140-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-23"><a href="#cb140-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(linear_spectrum)</span>
<span id="cb140-24"><a href="#cb140-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-25"><a href="#cb140-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_linear_score(peptide: <span class="bu">str</span>, experimental_spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb140-26"><a href="#cb140-26" aria-hidden="true" tabindex="-1"></a>    theoretical_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> calculate_linear_spectrum(peptide)</span>
<span id="cb140-27"><a href="#cb140-27" aria-hidden="true" tabindex="-1"></a>    score: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb140-28"><a href="#cb140-28" aria-hidden="true" tabindex="-1"></a>    unique_masses: <span class="bu">set</span> <span class="op">=</span> <span class="bu">set</span>(theoretical_spectrum <span class="op">+</span> experimental_spectrum)</span>
<span id="cb140-29"><a href="#cb140-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-30"><a href="#cb140-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> unique_masses:</span>
<span id="cb140-31"><a href="#cb140-31" aria-hidden="true" tabindex="-1"></a>        score <span class="op">+=</span> <span class="bu">min</span>(theoretical_spectrum.count(mass), experimental_spectrum.count(mass))</span>
<span id="cb140-32"><a href="#cb140-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-33"><a href="#cb140-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score</span>
<span id="cb140-34"><a href="#cb140-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-35"><a href="#cb140-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> trim_leaderboard(leaderboard: List[<span class="bu">str</span>], spectrum: List[<span class="bu">int</span>], n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb140-36"><a href="#cb140-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(leaderboard) <span class="op">&lt;=</span> n:</span>
<span id="cb140-37"><a href="#cb140-37" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> leaderboard</span>
<span id="cb140-38"><a href="#cb140-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-39"><a href="#cb140-39" aria-hidden="true" tabindex="-1"></a>    peptide_scores: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb140-40"><a href="#cb140-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, peptide <span class="kw">in</span> <span class="bu">enumerate</span>(leaderboard):</span>
<span id="cb140-41"><a href="#cb140-41" aria-hidden="true" tabindex="-1"></a>        peptide_scores[i] <span class="op">=</span> calculate_linear_score(peptide, spectrum)</span>
<span id="cb140-42"><a href="#cb140-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-43"><a href="#cb140-43" aria-hidden="true" tabindex="-1"></a>    sorted_scores: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(peptide_scores.values(), reverse<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb140-44"><a href="#cb140-44" aria-hidden="true" tabindex="-1"></a>    score_threshold: <span class="bu">int</span> <span class="op">=</span> sorted_scores[n <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb140-45"><a href="#cb140-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-46"><a href="#cb140-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [leaderboard[idx] <span class="cf">for</span> idx, score <span class="kw">in</span> peptide_scores.items() <span class="cf">if</span> score <span class="op">&gt;=</span> score_threshold]</span>
<span id="cb140-47"><a href="#cb140-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-48"><a href="#cb140-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb140-49"><a href="#cb140-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb140-50"><a href="#cb140-50" aria-hidden="true" tabindex="-1"></a><span class="st">LAST ALST TLLT TQAS</span></span>
<span id="cb140-51"><a href="#cb140-51" aria-hidden="true" tabindex="-1"></a><span class="st">0 71 87 101 113 158 184 188 259 271 372</span></span>
<span id="cb140-52"><a href="#cb140-52" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb140-53"><a href="#cb140-53" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb140-54"><a href="#cb140-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-55"><a href="#cb140-55" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb140-56"><a href="#cb140-56" aria-hidden="true" tabindex="-1"></a>input_leaderboard: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">0</span>].split()</span>
<span id="cb140-57"><a href="#cb140-57" aria-hidden="true" tabindex="-1"></a>input_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split()]</span>
<span id="cb140-58"><a href="#cb140-58" aria-hidden="true" tabindex="-1"></a>input_n: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb140-59"><a href="#cb140-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-60"><a href="#cb140-60" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">str</span>] <span class="op">=</span> trim_leaderboard(input_leaderboard, input_spectrum, input_n)</span>
<span id="cb140-61"><a href="#cb140-61" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="solve-the-turnpike-problem" class="level1" data-number="47">
<h1 data-number="47"><span class="header-section-number">47</span> Solve the Turnpike Problem</h1>
<p>Turnpike Problem. Given all pairwise distances between points on a line segment, reconstruct the positions of those points.</p>
<p>Given:&nbsp;A collection of integers&nbsp;<em>L</em>.</p>
<p>Return:&nbsp;A set&nbsp;<em>A</em>&nbsp;such that <span class="math inline">\(∆A\)</span>&nbsp;=&nbsp;<em>L</em>.</p>
<section id="sample-dataset-47" class="level2" data-number="47.1">
<h2 data-number="47.1" class="anchored" data-anchor-id="sample-dataset-47"><span class="header-section-number">47.1</span> Sample Dataset</h2>
<pre><code>-10 -8 -7 -6 -5 -4 -3 -3 -2 -2 0 0 0 0 0 2 2 3 3 4 5 6 7 8 10</code></pre>
</section>
<section id="sample-output-47" class="level2" data-number="47.2">
<h2 data-number="47.2" class="anchored" data-anchor-id="sample-output-47"><span class="header-section-number">47.2</span> Sample Output</h2>
<pre><code>0 2 4 7 10</code></pre>
</section>
<section id="solution-47" class="level2" data-number="47.3">
<h2 data-number="47.3" class="anchored" data-anchor-id="solution-47"><span class="header-section-number">47.3</span> Solution</h2>
<div class="sourceCode" id="cb143"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Set, Optional</span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_absolute_differences(set_a: Set[<span class="bu">int</span>], set_b: Set[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">abs</span>(a <span class="op">-</span> b) <span class="cf">for</span> a <span class="kw">in</span> set_a <span class="cf">for</span> b <span class="kw">in</span> set_b]</span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_multiset_subset(subset: List[<span class="bu">int</span>], superset: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>(subset.count(elem) <span class="op">&lt;=</span> superset.count(elem) <span class="cf">for</span> elem <span class="kw">in</span> <span class="bu">set</span>(subset))</span>
<span id="cb143-8"><a href="#cb143-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-9"><a href="#cb143-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiset_difference(set_a: List[<span class="bu">int</span>], set_b: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb143-10"><a href="#cb143-10" aria-hidden="true" tabindex="-1"></a>    difference: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb143-11"><a href="#cb143-11" aria-hidden="true" tabindex="-1"></a>    unique_elements: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(set_a)</span>
<span id="cb143-12"><a href="#cb143-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> elem <span class="kw">in</span> unique_elements:</span>
<span id="cb143-13"><a href="#cb143-13" aria-hidden="true" tabindex="-1"></a>        count_difference <span class="op">=</span> set_a.count(elem) <span class="op">-</span> set_b.count(elem)</span>
<span id="cb143-14"><a href="#cb143-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> count_difference <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb143-15"><a href="#cb143-15" aria-hidden="true" tabindex="-1"></a>            difference.extend([elem] <span class="op">*</span> count_difference)</span>
<span id="cb143-16"><a href="#cb143-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(difference)</span>
<span id="cb143-17"><a href="#cb143-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-18"><a href="#cb143-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> place_elements(distances: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Optional[Set[<span class="bu">int</span>]]:</span>
<span id="cb143-19"><a href="#cb143-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> distances:</span>
<span id="cb143-20"><a href="#cb143-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> placed_elements</span>
<span id="cb143-21"><a href="#cb143-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-22"><a href="#cb143-22" aria-hidden="true" tabindex="-1"></a>    current_distance: <span class="bu">int</span> <span class="op">=</span> distances[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb143-23"><a href="#cb143-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-24"><a href="#cb143-24" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the left</span></span>
<span id="cb143-25"><a href="#cb143-25" aria-hidden="true" tabindex="-1"></a>    left_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({current_distance}, placed_elements)</span>
<span id="cb143-26"><a href="#cb143-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(left_differences, distances):</span>
<span id="cb143-27"><a href="#cb143-27" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(current_distance)</span>
<span id="cb143-28"><a href="#cb143-28" aria-hidden="true" tabindex="-1"></a>        remaining_distances_left: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, left_differences)</span>
<span id="cb143-29"><a href="#cb143-29" aria-hidden="true" tabindex="-1"></a>        left_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_left)</span>
<span id="cb143-30"><a href="#cb143-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left_result:</span>
<span id="cb143-31"><a href="#cb143-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> left_result</span>
<span id="cb143-32"><a href="#cb143-32" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(current_distance)</span>
<span id="cb143-33"><a href="#cb143-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-34"><a href="#cb143-34" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Try placing on the right</span></span>
<span id="cb143-35"><a href="#cb143-35" aria-hidden="true" tabindex="-1"></a>    right_differences: List[<span class="bu">int</span>] <span class="op">=</span> calculate_absolute_differences({total_width <span class="op">-</span> current_distance}, placed_elements)</span>
<span id="cb143-36"><a href="#cb143-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> is_multiset_subset(right_differences, distances):</span>
<span id="cb143-37"><a href="#cb143-37" aria-hidden="true" tabindex="-1"></a>        placed_elements.add(total_width <span class="op">-</span> current_distance)</span>
<span id="cb143-38"><a href="#cb143-38" aria-hidden="true" tabindex="-1"></a>        remaining_distances_right: List[<span class="bu">int</span>] <span class="op">=</span> multiset_difference(distances, right_differences)</span>
<span id="cb143-39"><a href="#cb143-39" aria-hidden="true" tabindex="-1"></a>        right_result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(remaining_distances_right)</span>
<span id="cb143-40"><a href="#cb143-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> right_result:</span>
<span id="cb143-41"><a href="#cb143-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> right_result</span>
<span id="cb143-42"><a href="#cb143-42" aria-hidden="true" tabindex="-1"></a>        placed_elements.remove(total_width <span class="op">-</span> current_distance)</span>
<span id="cb143-43"><a href="#cb143-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-44"><a href="#cb143-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb143-45"><a href="#cb143-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-46"><a href="#cb143-46" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb143-47"><a href="#cb143-47" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb143-48"><a href="#cb143-48" aria-hidden="true" tabindex="-1"></a><span class="st">-10 -8 -7 -6 -5 -4 -3 -3 -2 -2 0 0 0 0 0 2 2 3 3 4 5 6 7 8 10</span></span>
<span id="cb143-49"><a href="#cb143-49" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb143-50"><a href="#cb143-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-51"><a href="#cb143-51" aria-hidden="true" tabindex="-1"></a>input_distances: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb143-52"><a href="#cb143-52" aria-hidden="true" tabindex="-1"></a>positive_distances: List[<span class="bu">int</span>] <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> input_distances <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span>]</span>
<span id="cb143-53"><a href="#cb143-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-54"><a href="#cb143-54" aria-hidden="true" tabindex="-1"></a>total_width: <span class="bu">int</span> <span class="op">=</span> positive_distances.pop(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb143-55"><a href="#cb143-55" aria-hidden="true" tabindex="-1"></a>placed_elements: Set[<span class="bu">int</span>] <span class="op">=</span> {<span class="dv">0</span>, total_width}</span>
<span id="cb143-56"><a href="#cb143-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb143-57"><a href="#cb143-57" aria-hidden="true" tabindex="-1"></a>result: Optional[Set[<span class="bu">int</span>]] <span class="op">=</span> place_elements(positive_distances)</span>
<span id="cb143-58"><a href="#cb143-58" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, <span class="bu">sorted</span>(result))))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-minimum-number-of-coins-needed-to-make-change" class="level1" data-number="48">
<h1 data-number="48"><span class="header-section-number">48</span> Find the Minimum Number of Coins Needed to Make Change</h1>
<p>The Change Problem, Find the minimum number of coins needed to make change</p>
<p>Given:&nbsp;An integer&nbsp;<em>money</em>&nbsp;and an array&nbsp;<em>Coins</em>&nbsp;of positive integers.</p>
<p>Return:&nbsp;The minimum number of coins with denominations&nbsp;<em>Coins</em>&nbsp;that changes&nbsp;<em>money</em>.</p>
<section id="sample-dataset-48" class="level2" data-number="48.1">
<h2 data-number="48.1" class="anchored" data-anchor-id="sample-dataset-48"><span class="header-section-number">48.1</span> Sample Dataset</h2>
<pre><code>40
1,5,10,20,25,50</code></pre>
</section>
<section id="sample-output-48" class="level2" data-number="48.2">
<h2 data-number="48.2" class="anchored" data-anchor-id="sample-output-48"><span class="header-section-number">48.2</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution-48" class="level2" data-number="48.3">
<h2 data-number="48.3" class="anchored" data-anchor-id="solution-48"><span class="header-section-number">48.3</span> Solution</h2>
<div class="sourceCode" id="cb146"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> min_coins_for_change(target_amount: <span class="bu">int</span>, available_coins: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>    min_coins_needed <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_amount <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, target_amount <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>        min_coins_needed.append(target_amount <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> coin <span class="kw">in</span> available_coins:</span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> current_amount <span class="op">&gt;=</span> coin:</span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>                coins_for_current <span class="op">=</span> min_coins_needed[current_amount <span class="op">-</span> coin] <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> coins_for_current <span class="op">&lt;</span> min_coins_needed[current_amount]:</span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>                    min_coins_needed[current_amount] <span class="op">=</span> coins_for_current</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> min_coins_needed[target_amount]</span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a><span class="st">40</span></span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a><span class="st">1,5,10,20,25,50</span></span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a>target_amount <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">0</span>])</span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a>available_coins <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].split(<span class="st">","</span>)]</span>
<span id="cb146-22"><a href="#cb146-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-23"><a href="#cb146-23" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(min_coins_for_change(target_amount, available_coins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-length-of-a-longest-path-in-a-manhattan-like-grid" class="level1" data-number="49">
<h1 data-number="49"><span class="header-section-number">49</span> Find the Length of a Longest Path in a Manhattan-like Grid</h1>
<p>Length of a Longest Path in the Manhattan Tourist Problem. Find the length of a longest path in a rectangular city.</p>
<p>Given:&nbsp;Integers&nbsp;<em>n</em>&nbsp;and&nbsp;<em>m</em>, followed by an&nbsp;<em>n</em>&nbsp;× (<em>m</em>+1) matrix&nbsp;<em>Down</em>&nbsp;and an (<em>n</em>+1) ×&nbsp;<em>m</em>&nbsp;matrix&nbsp;<em>Right</em>. The two matrices are separated by the”-“symbol.</p>
<p>Return:&nbsp;The length of a longest path from source (0, 0) to sink (<em>n</em>,&nbsp;<em>m</em>) in the&nbsp;<em>n</em>&nbsp;×&nbsp;<em>m</em>&nbsp;rectangular grid whose edges are defined by the matrices&nbsp;<em>Down</em>&nbsp;and&nbsp;<em>Right</em>.</p>
<section id="sample-dataset-49" class="level2" data-number="49.1">
<h2 data-number="49.1" class="anchored" data-anchor-id="sample-dataset-49"><span class="header-section-number">49.1</span> Sample Dataset</h2>
<pre><code>4 4
1 0 2 4 3
4 6 5 2 1
4 4 5 2 1
5 6 8 5 3
-
3 2 4 0
3 2 4 2
0 7 3 3
3 3 0 2
1 3 2 2</code></pre>
</section>
<section id="sample-output-49" class="level2" data-number="49.2">
<h2 data-number="49.2" class="anchored" data-anchor-id="sample-output-49"><span class="header-section-number">49.2</span> Sample Output</h2>
<pre><code>34</code></pre>
</section>
<section id="solution-49" class="level2" data-number="49.3">
<h2 data-number="49.3" class="anchored" data-anchor-id="solution-49"><span class="header-section-number">49.3</span> Solution</h2>
<div class="sourceCode" id="cb149"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_manhattan_tourist_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, List[List[<span class="bu">int</span>]], List[List[<span class="bu">int</span>]]]:</span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_text.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>    rows, cols <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, lines[<span class="dv">0</span>].split())</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>    down_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows)]</span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows):</span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a>            down_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a>    separator_index <span class="op">=</span> rows <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a>    right_weights <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> cols <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, lines[i <span class="op">+</span> separator_index <span class="op">+</span> <span class="dv">1</span>].split()))</span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(cols):</span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a>            right_weights[i][j] <span class="op">=</span> line[j]</span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rows, cols, down_weights, right_weights</span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_longest_manhattan_path(rows: <span class="bu">int</span>, cols: <span class="bu">int</span>, down_weights: List[List[<span class="bu">int</span>]], right_weights: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb149-23"><a href="#cb149-23" aria-hidden="true" tabindex="-1"></a>    path_scores <span class="op">=</span> [[<span class="dv">0</span>] <span class="op">*</span> (cols <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(rows <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb149-24"><a href="#cb149-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-25"><a href="#cb149-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-26"><a href="#cb149-26" aria-hidden="true" tabindex="-1"></a>        path_scores[i][<span class="dv">0</span>] <span class="op">=</span> path_scores[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb149-27"><a href="#cb149-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-28"><a href="#cb149-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-29"><a href="#cb149-29" aria-hidden="true" tabindex="-1"></a>        path_scores[<span class="dv">0</span>][j] <span class="op">=</span> path_scores[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[<span class="dv">0</span>][j <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb149-30"><a href="#cb149-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-31"><a href="#cb149-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, rows <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-32"><a href="#cb149-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, cols <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb149-33"><a href="#cb149-33" aria-hidden="true" tabindex="-1"></a>            path_scores[i][j] <span class="op">=</span> <span class="bu">max</span>(path_scores[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">+</span> down_weights[i <span class="op">-</span> <span class="dv">1</span>][j],</span>
<span id="cb149-34"><a href="#cb149-34" aria-hidden="true" tabindex="-1"></a>                                    path_scores[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> right_weights[i][j <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb149-35"><a href="#cb149-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-36"><a href="#cb149-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_scores[rows][cols]</span>
<span id="cb149-37"><a href="#cb149-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-38"><a href="#cb149-38" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb149-39"><a href="#cb149-39" aria-hidden="true" tabindex="-1"></a><span class="st">4 4</span></span>
<span id="cb149-40"><a href="#cb149-40" aria-hidden="true" tabindex="-1"></a><span class="st">1 0 2 4 3</span></span>
<span id="cb149-41"><a href="#cb149-41" aria-hidden="true" tabindex="-1"></a><span class="st">4 6 5 2 1</span></span>
<span id="cb149-42"><a href="#cb149-42" aria-hidden="true" tabindex="-1"></a><span class="st">4 4 5 2 1</span></span>
<span id="cb149-43"><a href="#cb149-43" aria-hidden="true" tabindex="-1"></a><span class="st">5 6 8 5 3</span></span>
<span id="cb149-44"><a href="#cb149-44" aria-hidden="true" tabindex="-1"></a><span class="st">-</span></span>
<span id="cb149-45"><a href="#cb149-45" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 0</span></span>
<span id="cb149-46"><a href="#cb149-46" aria-hidden="true" tabindex="-1"></a><span class="st">3 2 4 2</span></span>
<span id="cb149-47"><a href="#cb149-47" aria-hidden="true" tabindex="-1"></a><span class="st">0 7 3 3</span></span>
<span id="cb149-48"><a href="#cb149-48" aria-hidden="true" tabindex="-1"></a><span class="st">3 3 0 2</span></span>
<span id="cb149-49"><a href="#cb149-49" aria-hidden="true" tabindex="-1"></a><span class="st">1 3 2 2</span></span>
<span id="cb149-50"><a href="#cb149-50" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb149-51"><a href="#cb149-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-52"><a href="#cb149-52" aria-hidden="true" tabindex="-1"></a>rows, cols, down_weights, right_weights <span class="op">=</span> parse_manhattan_tourist_input(sample_input)</span>
<span id="cb149-53"><a href="#cb149-53" aria-hidden="true" tabindex="-1"></a>longest_path_score <span class="op">=</span> calculate_longest_manhattan_path(rows, cols, down_weights, right_weights)</span>
<span id="cb149-54"><a href="#cb149-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>longest_path_score<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-longest-common-subsequence-of-two-strings" class="level1" data-number="50">
<h1 data-number="50"><span class="header-section-number">50</span> Find a Longest Common Subsequence of Two Strings</h1>
<p>Longest Common Subsequence Problem.</p>
<p>Given:&nbsp;Two strings.</p>
<p>Return:&nbsp;A longest common subsequence of these strings.</p>
<section id="sample-dataset-50" class="level2" data-number="50.1">
<h2 data-number="50.1" class="anchored" data-anchor-id="sample-dataset-50"><span class="header-section-number">50.1</span> Sample Dataset</h2>
<pre><code>AACCTTGG
ACACTGTGA</code></pre>
</section>
<section id="sample-output-50" class="level2" data-number="50.2">
<h2 data-number="50.2" class="anchored" data-anchor-id="sample-output-50"><span class="header-section-number">50.2</span> Sample Output</h2>
<pre><code>AACTGG</code></pre>
</section>
<section id="solution-50" class="level2" data-number="50.3">
<h2 data-number="50.3" class="anchored" data-anchor-id="solution-50"><span class="header-section-number">50.3</span> Solution</h2>
<div class="sourceCode" id="cb152"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_common_subsequence(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>    padded_seq1 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence1</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>    padded_seq2 <span class="op">=</span> <span class="st">'-'</span> <span class="op">+</span> sequence2</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-7"><a href="#cb152-7" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb152-8"><a href="#cb152-8" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb152-9"><a href="#cb152-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-10"><a href="#cb152-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb152-11"><a href="#cb152-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb152-12"><a href="#cb152-12" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> (<span class="dv">1</span> <span class="cf">if</span> padded_seq1[i] <span class="op">==</span> padded_seq2[j] <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb152-13"><a href="#cb152-13" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j], score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>], match_score)</span>
<span id="cb152-14"><a href="#cb152-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-15"><a href="#cb152-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j]:</span>
<span id="cb152-16"><a href="#cb152-16" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb152-17"><a href="#cb152-17" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>]:</span>
<span id="cb152-18"><a href="#cb152-18" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb152-19"><a href="#cb152-19" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb152-20"><a href="#cb152-20" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diag"</span></span>
<span id="cb152-21"><a href="#cb152-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-22"><a href="#cb152-22" aria-hidden="true" tabindex="-1"></a>    lcs <span class="op">=</span> <span class="st">""</span></span>
<span id="cb152-23"><a href="#cb152-23" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb152-24"><a href="#cb152-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb152-25"><a href="#cb152-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"diag"</span>:</span>
<span id="cb152-26"><a href="#cb152-26" aria-hidden="true" tabindex="-1"></a>            lcs <span class="op">=</span> padded_seq1[i] <span class="op">+</span> lcs</span>
<span id="cb152-27"><a href="#cb152-27" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb152-28"><a href="#cb152-28" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb152-29"><a href="#cb152-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> backtrack_matrix[i][j] <span class="op">==</span> <span class="st">"left"</span>:</span>
<span id="cb152-30"><a href="#cb152-30" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb152-31"><a href="#cb152-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb152-32"><a href="#cb152-32" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb152-33"><a href="#cb152-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-34"><a href="#cb152-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> lcs</span>
<span id="cb152-35"><a href="#cb152-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-36"><a href="#cb152-36" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb152-37"><a href="#cb152-37" aria-hidden="true" tabindex="-1"></a><span class="st">AACCTTGG</span></span>
<span id="cb152-38"><a href="#cb152-38" aria-hidden="true" tabindex="-1"></a><span class="st">ACACTGTGA</span></span>
<span id="cb152-39"><a href="#cb152-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb152-40"><a href="#cb152-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-41"><a href="#cb152-41" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb152-42"><a href="#cb152-42" aria-hidden="true" tabindex="-1"></a>sequence1 <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb152-43"><a href="#cb152-43" aria-hidden="true" tabindex="-1"></a>sequence2 <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb152-44"><a href="#cb152-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb152-45"><a href="#cb152-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_common_subsequence(sequence1, sequence2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-longest-path-in-a-dag" class="level1" data-number="51">
<h1 data-number="51"><span class="header-section-number">51</span> Find the Longest Path in a DAG</h1>
<p>Longest Path in a DAG Problem. Find a longest path between two nodes in an edge-weighted DAG.</p>
<p>Given:&nbsp;An integer representing the source node of a graph, followed by an integer representing the sink node of the graph, followed by an edge-weighted graph. The graph is represented by a modified&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>&nbsp;in which the notation”0-&gt;1:7”indicates that an edge connects node 0 to node 1 with weight 7.</p>
<p>Return:&nbsp;The length of a longest path in the graph, followed by a longest path. (If multiple longest paths exist, you may return any one.)</p>
<section id="sample-dataset-51" class="level2" data-number="51.1">
<h2 data-number="51.1" class="anchored" data-anchor-id="sample-dataset-51"><span class="header-section-number">51.1</span> Sample Dataset</h2>
<pre><code>0
4
0-&gt;1:7
0-&gt;2:4
2-&gt;3:2
1-&gt;4:1
3-&gt;4:3</code></pre>
</section>
<section id="sample-output-51" class="level2" data-number="51.2">
<h2 data-number="51.2" class="anchored" data-anchor-id="sample-output-51"><span class="header-section-number">51.2</span> Sample Output</h2>
<pre><code>9
0-&gt;2-&gt;3-&gt;4</code></pre>
</section>
<section id="solution-51" class="level2" data-number="51.3">
<h2 data-number="51.3" class="anchored" data-anchor-id="solution-51"><span class="header-section-number">51.3</span> Solution</h2>
<div class="sourceCode" id="cb155"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Optional</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Node:</span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, label: <span class="bu">str</span>):</span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label: <span class="bu">str</span> <span class="op">=</span> label</span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.parent_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.target_nodes: List[Tuple[<span class="st">'Node'</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.visited: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> DAG:</span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>):</span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict: Dict[<span class="bu">str</span>, Node] <span class="op">=</span> {}</span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances: Dict[<span class="bu">str</span>, <span class="bu">float</span>] <span class="op">=</span> {}</span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack: Dict[<span class="bu">str</span>, Optional[<span class="bu">str</span>]] <span class="op">=</span> {}</span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>, label: <span class="bu">str</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Node(label)</span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.nodes_dict[label] <span class="op">=</span> new_node</span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_dag(<span class="va">self</span>, adjacency_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> line <span class="kw">in</span> adjacency_list:</span>
<span id="cb155-26"><a href="#cb155-26" aria-hidden="true" tabindex="-1"></a>            source_label, temp <span class="op">=</span> line.split(<span class="st">"-&gt;"</span>)</span>
<span id="cb155-27"><a href="#cb155-27" aria-hidden="true" tabindex="-1"></a>            target_label, weight_str <span class="op">=</span> temp.split(<span class="st">":"</span>)</span>
<span id="cb155-28"><a href="#cb155-28" aria-hidden="true" tabindex="-1"></a>            weight <span class="op">=</span> <span class="bu">int</span>(weight_str)</span>
<span id="cb155-29"><a href="#cb155-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-30"><a href="#cb155-30" aria-hidden="true" tabindex="-1"></a>            source_node <span class="op">=</span> <span class="va">self</span>.add_node(source_label)</span>
<span id="cb155-31"><a href="#cb155-31" aria-hidden="true" tabindex="-1"></a>            target_node <span class="op">=</span> <span class="va">self</span>.add_node(target_label)</span>
<span id="cb155-32"><a href="#cb155-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-33"><a href="#cb155-33" aria-hidden="true" tabindex="-1"></a>            source_node.target_nodes.append((target_node, weight))</span>
<span id="cb155-34"><a href="#cb155-34" aria-hidden="true" tabindex="-1"></a>            target_node.parent_nodes.append((source_node, weight))</span>
<span id="cb155-35"><a href="#cb155-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-36"><a href="#cb155-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort_util(<span class="va">self</span>, current_node: Node, sorted_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb155-37"><a href="#cb155-37" aria-hidden="true" tabindex="-1"></a>        current_node.visited <span class="op">=</span> <span class="va">True</span></span>
<span id="cb155-38"><a href="#cb155-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor, _ <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb155-39"><a href="#cb155-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> neighbor.visited:</span>
<span id="cb155-40"><a href="#cb155-40" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(neighbor, sorted_labels)</span>
<span id="cb155-41"><a href="#cb155-41" aria-hidden="true" tabindex="-1"></a>        sorted_labels.insert(<span class="dv">0</span>, current_node.label)</span>
<span id="cb155-42"><a href="#cb155-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-43"><a href="#cb155-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> topological_sort(<span class="va">self</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb155-44"><a href="#cb155-44" aria-hidden="true" tabindex="-1"></a>        sorted_labels: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb155-45"><a href="#cb155-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.nodes_dict.values():</span>
<span id="cb155-46"><a href="#cb155-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> node.visited:</span>
<span id="cb155-47"><a href="#cb155-47" aria-hidden="true" tabindex="-1"></a>                <span class="va">self</span>.topological_sort_util(node, sorted_labels)</span>
<span id="cb155-48"><a href="#cb155-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sorted_labels</span>
<span id="cb155-49"><a href="#cb155-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-50"><a href="#cb155-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> longest_path(<span class="va">self</span>, source: <span class="bu">str</span>, sink: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb155-51"><a href="#cb155-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> <span class="va">self</span>.nodes_dict:</span>
<span id="cb155-52"><a href="#cb155-52" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.distances[label] <span class="op">=</span> <span class="bu">float</span>(<span class="st">"-inf"</span>)</span>
<span id="cb155-53"><a href="#cb155-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-54"><a href="#cb155-54" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.distances[source] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb155-55"><a href="#cb155-55" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.backtrack[source] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb155-56"><a href="#cb155-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-57"><a href="#cb155-57" aria-hidden="true" tabindex="-1"></a>        topological_order <span class="op">=</span> <span class="va">self</span>.topological_sort()</span>
<span id="cb155-58"><a href="#cb155-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> label <span class="kw">in</span> topological_order:</span>
<span id="cb155-59"><a href="#cb155-59" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> <span class="va">self</span>.nodes_dict[label]</span>
<span id="cb155-60"><a href="#cb155-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target_node, weight <span class="kw">in</span> current_node.target_nodes:</span>
<span id="cb155-61"><a href="#cb155-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="va">self</span>.distances[target_node.label] <span class="op">&lt;</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight:</span>
<span id="cb155-62"><a href="#cb155-62" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.distances[target_node.label] <span class="op">=</span> <span class="va">self</span>.distances[label] <span class="op">+</span> weight</span>
<span id="cb155-63"><a href="#cb155-63" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.backtrack[target_node.label] <span class="op">=</span> label</span>
<span id="cb155-64"><a href="#cb155-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-65"><a href="#cb155-65" aria-hidden="true" tabindex="-1"></a>        path: List[<span class="bu">str</span>] <span class="op">=</span> [sink]</span>
<span id="cb155-66"><a href="#cb155-66" aria-hidden="true" tabindex="-1"></a>        current_label <span class="op">=</span> <span class="va">self</span>.backtrack[sink]</span>
<span id="cb155-67"><a href="#cb155-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> current_label <span class="op">!=</span> source:</span>
<span id="cb155-68"><a href="#cb155-68" aria-hidden="true" tabindex="-1"></a>            path <span class="op">=</span> [current_label] <span class="op">+</span> path</span>
<span id="cb155-69"><a href="#cb155-69" aria-hidden="true" tabindex="-1"></a>            current_label <span class="op">=</span> <span class="va">self</span>.backtrack[current_label]</span>
<span id="cb155-70"><a href="#cb155-70" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> [source] <span class="op">+</span> path</span>
<span id="cb155-71"><a href="#cb155-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">self</span>.distances[sink], path</span>
<span id="cb155-72"><a href="#cb155-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-73"><a href="#cb155-73" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb155-74"><a href="#cb155-74" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb155-75"><a href="#cb155-75" aria-hidden="true" tabindex="-1"></a><span class="st">0</span></span>
<span id="cb155-76"><a href="#cb155-76" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb155-77"><a href="#cb155-77" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;1:7</span></span>
<span id="cb155-78"><a href="#cb155-78" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;2:4</span></span>
<span id="cb155-79"><a href="#cb155-79" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;3:2</span></span>
<span id="cb155-80"><a href="#cb155-80" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:1</span></span>
<span id="cb155-81"><a href="#cb155-81" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;4:3</span></span>
<span id="cb155-82"><a href="#cb155-82" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb155-83"><a href="#cb155-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-84"><a href="#cb155-84" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb155-85"><a href="#cb155-85" aria-hidden="true" tabindex="-1"></a>source_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb155-86"><a href="#cb155-86" aria-hidden="true" tabindex="-1"></a>sink_label: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb155-87"><a href="#cb155-87" aria-hidden="true" tabindex="-1"></a>adjacency_list: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">2</span>:]</span>
<span id="cb155-88"><a href="#cb155-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-89"><a href="#cb155-89" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> DAG()</span>
<span id="cb155-90"><a href="#cb155-90" aria-hidden="true" tabindex="-1"></a>graph.construct_dag(adjacency_list)</span>
<span id="cb155-91"><a href="#cb155-91" aria-hidden="true" tabindex="-1"></a>longest_distance, longest_path <span class="op">=</span> graph.longest_path(source_label, sink_label)</span>
<span id="cb155-92"><a href="#cb155-92" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_distance)</span>
<span id="cb155-93"><a href="#cb155-93" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"-&gt;"</span>.join(longest_path))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-alignment-of-two-strings" class="level1" data-number="52">
<h1 data-number="52"><span class="header-section-number">52</span> Find a Highest-Scoring Alignment of Two Strings</h1>
<p>Global Alignment Problem. Find the highest-scoring alignment between two strings using a scoring matrix.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;The maximum alignment score of these strings followed by an alignment achieving this maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix and indel penalty σ = 5. (If multiple alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-52" class="level2" data-number="52.1">
<h2 data-number="52.1" class="anchored" data-anchor-id="sample-dataset-52"><span class="header-section-number">52.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEANLY</code></pre>
</section>
<section id="sample-output-52" class="level2" data-number="52.2">
<h2 data-number="52.2" class="anchored" data-anchor-id="sample-output-52"><span class="header-section-number">52.2</span> Sample Output</h2>
<pre><code>8
PLEASANTLY
-MEA--N-LY</code></pre>
</section>
<section id="solution-52" class="level2" data-number="52.3">
<h2 data-number="52.3" class="anchored" data-anchor-id="solution-52"><span class="header-section-number">52.3</span> Solution</h2>
<div class="sourceCode" id="cb158"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-7"><a href="#cb158-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-8"><a href="#cb158-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-9"><a href="#cb158-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb158-10"><a href="#cb158-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb158-11"><a href="#cb158-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-12"><a href="#cb158-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-13"><a href="#cb158-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-14"><a href="#cb158-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-15"><a href="#cb158-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-16"><a href="#cb158-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-17"><a href="#cb158-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-18"><a href="#cb158-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-19"><a href="#cb158-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb158-20"><a href="#cb158-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb158-21"><a href="#cb158-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-22"><a href="#cb158-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb158-23"><a href="#cb158-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-24"><a href="#cb158-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-25"><a href="#cb158-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb158-26"><a href="#cb158-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-27"><a href="#cb158-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-28"><a href="#cb158-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-29"><a href="#cb158-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-30"><a href="#cb158-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-31"><a href="#cb158-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-32"><a href="#cb158-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-33"><a href="#cb158-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb158-34"><a href="#cb158-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-35"><a href="#cb158-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb158-36"><a href="#cb158-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb158-37"><a href="#cb158-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-38"><a href="#cb158-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb158-39"><a href="#cb158-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-40"><a href="#cb158-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb158-41"><a href="#cb158-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb158-42"><a href="#cb158-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb158-43"><a href="#cb158-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb158-44"><a href="#cb158-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-45"><a href="#cb158-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb158-46"><a href="#cb158-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-47"><a href="#cb158-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-48"><a href="#cb158-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-49"><a href="#cb158-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-50"><a href="#cb158-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-51"><a href="#cb158-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb158-52"><a href="#cb158-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-53"><a href="#cb158-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-54"><a href="#cb158-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-55"><a href="#cb158-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-56"><a href="#cb158-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-57"><a href="#cb158-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb158-58"><a href="#cb158-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb158-59"><a href="#cb158-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb158-60"><a href="#cb158-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb158-61"><a href="#cb158-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb158-62"><a href="#cb158-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-63"><a href="#cb158-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-64"><a href="#cb158-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-65"><a href="#cb158-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-66"><a href="#cb158-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb158-67"><a href="#cb158-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-68"><a href="#cb158-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-69"><a href="#cb158-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-70"><a href="#cb158-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb158-71"><a href="#cb158-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb158-72"><a href="#cb158-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb158-73"><a href="#cb158-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb158-74"><a href="#cb158-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-75"><a href="#cb158-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb158-76"><a href="#cb158-76" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb158-77"><a href="#cb158-77" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb158-78"><a href="#cb158-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-79"><a href="#cb158-79" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb158-80"><a href="#cb158-80" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[<span class="bu">str</span>]] <span class="op">=</span> [[<span class="st">''</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb158-81"><a href="#cb158-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-82"><a href="#cb158-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb158-83"><a href="#cb158-83" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> j</span>
<span id="cb158-84"><a href="#cb158-84" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[<span class="dv">0</span>][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb158-85"><a href="#cb158-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-86"><a href="#cb158-86" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb158-87"><a href="#cb158-87" aria-hidden="true" tabindex="-1"></a>        score_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>indel_penalty <span class="op">*</span> i</span>
<span id="cb158-88"><a href="#cb158-88" aria-hidden="true" tabindex="-1"></a>        backtrack_matrix[i][<span class="dv">0</span>] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb158-89"><a href="#cb158-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-90"><a href="#cb158-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb158-91"><a href="#cb158-91" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb158-92"><a href="#cb158-92" aria-hidden="true" tabindex="-1"></a>            key: Tuple[<span class="bu">str</span>, <span class="bu">str</span>] <span class="op">=</span> (padded_seq1[i], padded_seq2[j]) <span class="cf">if</span> (padded_seq1[i], padded_seq2[j]) <span class="kw">in</span> BLOSUM62 <span class="cf">else</span> (padded_seq2[j], padded_seq1[i])</span>
<span id="cb158-93"><a href="#cb158-93" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> BLOSUM62[key]</span>
<span id="cb158-94"><a href="#cb158-94" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb158-95"><a href="#cb158-95" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb158-96"><a href="#cb158-96" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score)</span>
<span id="cb158-97"><a href="#cb158-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-98"><a href="#cb158-98" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb158-99"><a href="#cb158-99" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb158-100"><a href="#cb158-100" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb158-101"><a href="#cb158-101" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb158-102"><a href="#cb158-102" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb158-103"><a href="#cb158-103" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb158-104"><a href="#cb158-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-105"><a href="#cb158-105" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb158-106"><a href="#cb158-106" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb158-107"><a href="#cb158-107" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb158-108"><a href="#cb158-108" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb158-109"><a href="#cb158-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-110"><a href="#cb158-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">!=</span> <span class="dv">0</span> <span class="kw">or</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb158-111"><a href="#cb158-111" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb158-112"><a href="#cb158-112" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb158-113"><a href="#cb158-113" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb158-114"><a href="#cb158-114" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb158-115"><a href="#cb158-115" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb158-116"><a href="#cb158-116" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb158-117"><a href="#cb158-117" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb158-118"><a href="#cb158-118" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb158-119"><a href="#cb158-119" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb158-120"><a href="#cb158-120" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb158-121"><a href="#cb158-121" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb158-122"><a href="#cb158-122" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb158-123"><a href="#cb158-123" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb158-124"><a href="#cb158-124" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb158-125"><a href="#cb158-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-126"><a href="#cb158-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score_matrix[<span class="bu">len</span>(padded_seq1) <span class="op">-</span> <span class="dv">1</span>][<span class="bu">len</span>(padded_seq2) <span class="op">-</span> <span class="dv">1</span>], aligned_seq1, aligned_seq2</span>
<span id="cb158-127"><a href="#cb158-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-128"><a href="#cb158-128" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb158-129"><a href="#cb158-129" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb158-130"><a href="#cb158-130" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb158-131"><a href="#cb158-131" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb158-132"><a href="#cb158-132" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb158-133"><a href="#cb158-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb158-134"><a href="#cb158-134" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb158-135"><a href="#cb158-135" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb158-136"><a href="#cb158-136" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb158-137"><a href="#cb158-137" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb158-138"><a href="#cb158-138" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb158-139"><a href="#cb158-139" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb158-140"><a href="#cb158-140" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> global_alignment(sequence1, sequence2)</span>
<span id="cb158-141"><a href="#cb158-141" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb158-142"><a href="#cb158-142" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb158-143"><a href="#cb158-143" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-local-alignment-of-two-strings" class="level1" data-number="53">
<h1 data-number="53"><span class="header-section-number">53</span> Find a Highest-Scoring Local Alignment of Two Strings</h1>
<p>Local Alignment Problem, Find the highest-scoring local alignment between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;The maximum score of a local alignment of the strings, followed by a local alignment of these strings achieving the maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/pam250/">PAM250</a>&nbsp;scoring matrix and indel penalty σ = 5. (If multiple local alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-53" class="level2" data-number="53.1">
<h2 data-number="53.1" class="anchored" data-anchor-id="sample-dataset-53"><span class="header-section-number">53.1</span> Sample Dataset</h2>
<pre><code>MEANLY
PENALTY</code></pre>
</section>
<section id="sample-output-53" class="level2" data-number="53.2">
<h2 data-number="53.2" class="anchored" data-anchor-id="sample-output-53"><span class="header-section-number">53.2</span> Sample Output</h2>
<pre><code>15
EANL-Y
ENALTY</code></pre>
</section>
<section id="solution-53" class="level2" data-number="53.3">
<h2 data-number="53.3" class="anchored" data-anchor-id="solution-53"><span class="header-section-number">53.3</span> Solution</h2>
<div class="sourceCode" id="cb161"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Optional</span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-3"><a href="#cb161-3" aria-hidden="true" tabindex="-1"></a>PAM250: Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {</span>
<span id="cb161-4"><a href="#cb161-4" aria-hidden="true" tabindex="-1"></a>        <span class="st">'A'</span>: {<span class="st">'A'</span>: <span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-5"><a href="#cb161-5" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb161-6"><a href="#cb161-6" aria-hidden="true" tabindex="-1"></a>          <span class="st">'C'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="dv">12</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">5</span>,</span>
<span id="cb161-7"><a href="#cb161-7" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb161-8"><a href="#cb161-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">'D'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">4</span>, <span class="st">'E'</span>: <span class="dv">3</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb161-9"><a href="#cb161-9" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-10"><a href="#cb161-10" aria-hidden="true" tabindex="-1"></a>          <span class="st">'E'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">3</span>, <span class="st">'E'</span>: <span class="dv">4</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb161-11"><a href="#cb161-11" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-12"><a href="#cb161-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">'F'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'F'</span>: <span class="dv">9</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb161-13"><a href="#cb161-13" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">7</span>},</span>
<span id="cb161-14"><a href="#cb161-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">'G'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">5</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-15"><a href="#cb161-15" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb161-16"><a href="#cb161-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">'H'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="dv">1</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">6</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb161-17"><a href="#cb161-17" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">3</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb161-18"><a href="#cb161-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">'I'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb161-19"><a href="#cb161-19" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb161-20"><a href="#cb161-20" aria-hidden="true" tabindex="-1"></a>          <span class="st">'K'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">5</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb161-21"><a href="#cb161-21" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">3</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-22"><a href="#cb161-22" aria-hidden="true" tabindex="-1"></a>          <span class="st">'L'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'F'</span>: <span class="dv">2</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="dv">6</span>, <span class="st">'M'</span>: <span class="dv">4</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb161-23"><a href="#cb161-23" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">1</span>},</span>
<span id="cb161-24"><a href="#cb161-24" aria-hidden="true" tabindex="-1"></a>          <span class="st">'M'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="dv">4</span>, <span class="st">'M'</span>: <span class="dv">6</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb161-25"><a href="#cb161-25" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb161-26"><a href="#cb161-26" aria-hidden="true" tabindex="-1"></a>          <span class="st">'N'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">2</span>,</span>
<span id="cb161-27"><a href="#cb161-27" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb161-28"><a href="#cb161-28" aria-hidden="true" tabindex="-1"></a>          <span class="st">'P'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-29"><a href="#cb161-29" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">6</span>, <span class="st">'Q'</span>: <span class="dv">0</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">5</span>},</span>
<span id="cb161-30"><a href="#cb161-30" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Q'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'D'</span>: <span class="dv">2</span>, <span class="st">'E'</span>: <span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">1</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb161-31"><a href="#cb161-31" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">4</span>, <span class="st">'R'</span>: <span class="dv">1</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-32"><a href="#cb161-32" aria-hidden="true" tabindex="-1"></a>          <span class="st">'R'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'H'</span>: <span class="dv">2</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'K'</span>: <span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="dv">0</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-33"><a href="#cb161-33" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">6</span>, <span class="st">'S'</span>: <span class="dv">0</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">4</span>},</span>
<span id="cb161-34"><a href="#cb161-34" aria-hidden="true" tabindex="-1"></a>          <span class="st">'S'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="dv">1</span>,</span>
<span id="cb161-35"><a href="#cb161-35" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="dv">0</span>, <span class="st">'S'</span>: <span class="dv">2</span>, <span class="st">'T'</span>: <span class="dv">1</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb161-36"><a href="#cb161-36" aria-hidden="true" tabindex="-1"></a>          <span class="st">'T'</span>: {<span class="st">'A'</span>: <span class="dv">1</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="dv">0</span>, <span class="st">'E'</span>: <span class="dv">0</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'G'</span>: <span class="dv">0</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'I'</span>: <span class="dv">0</span>, <span class="st">'K'</span>: <span class="dv">0</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'N'</span>: <span class="dv">0</span>,</span>
<span id="cb161-37"><a href="#cb161-37" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="dv">0</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'S'</span>: <span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">3</span>, <span class="st">'V'</span>: <span class="dv">0</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">3</span>},</span>
<span id="cb161-38"><a href="#cb161-38" aria-hidden="true" tabindex="-1"></a>          <span class="st">'V'</span>: {<span class="st">'A'</span>: <span class="dv">0</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'F'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'I'</span>: <span class="dv">4</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'L'</span>: <span class="dv">2</span>, <span class="st">'M'</span>: <span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb161-39"><a href="#cb161-39" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'T'</span>: <span class="dv">0</span>, <span class="st">'V'</span>: <span class="dv">4</span>, <span class="st">'W'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Y'</span>: <span class="op">-</span><span class="dv">2</span>},</span>
<span id="cb161-40"><a href="#cb161-40" aria-hidden="true" tabindex="-1"></a>          <span class="st">'W'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'C'</span>: <span class="op">-</span><span class="dv">8</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'F'</span>: <span class="dv">0</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">7</span>, <span class="st">'H'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb161-41"><a href="#cb161-41" aria-hidden="true" tabindex="-1"></a>                <span class="st">'N'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'P'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'R'</span>: <span class="dv">2</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">6</span>, <span class="st">'W'</span>: <span class="dv">17</span>, <span class="st">'Y'</span>: <span class="dv">0</span>},</span>
<span id="cb161-42"><a href="#cb161-42" aria-hidden="true" tabindex="-1"></a>          <span class="st">'Y'</span>: {<span class="st">'A'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'C'</span>: <span class="dv">0</span>, <span class="st">'D'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'E'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'F'</span>: <span class="dv">7</span>, <span class="st">'G'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'H'</span>: <span class="dv">0</span>, <span class="st">'I'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'K'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'L'</span>: <span class="op">-</span><span class="dv">1</span>, <span class="st">'M'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'N'</span>: <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb161-43"><a href="#cb161-43" aria-hidden="true" tabindex="-1"></a>                <span class="st">'P'</span>: <span class="op">-</span><span class="dv">5</span>, <span class="st">'Q'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'R'</span>: <span class="op">-</span><span class="dv">4</span>, <span class="st">'S'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'T'</span>: <span class="op">-</span><span class="dv">3</span>, <span class="st">'V'</span>: <span class="op">-</span><span class="dv">2</span>, <span class="st">'W'</span>: <span class="dv">0</span>, <span class="st">'Y'</span>: <span class="dv">10</span>}}</span>
<span id="cb161-44"><a href="#cb161-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-45"><a href="#cb161-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> local_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, indel_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="dv">5</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb161-46"><a href="#cb161-46" aria-hidden="true" tabindex="-1"></a>    padded_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence1</span>
<span id="cb161-47"><a href="#cb161-47" aria-hidden="true" tabindex="-1"></a>    padded_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> sequence2</span>
<span id="cb161-48"><a href="#cb161-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-49"><a href="#cb161-49" aria-hidden="true" tabindex="-1"></a>    score_matrix: List[List[<span class="bu">int</span>]] <span class="op">=</span> [[<span class="dv">0</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb161-50"><a href="#cb161-50" aria-hidden="true" tabindex="-1"></a>    backtrack_matrix: List[List[Optional[<span class="bu">str</span>]]] <span class="op">=</span> [[<span class="va">None</span> <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2))] <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1))]</span>
<span id="cb161-51"><a href="#cb161-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-52"><a href="#cb161-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq1)):</span>
<span id="cb161-53"><a href="#cb161-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(padded_seq2)):</span>
<span id="cb161-54"><a href="#cb161-54" aria-hidden="true" tabindex="-1"></a>            key1: <span class="bu">str</span> <span class="op">=</span> padded_seq1[i] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq2[j]</span>
<span id="cb161-55"><a href="#cb161-55" aria-hidden="true" tabindex="-1"></a>            key2: <span class="bu">str</span> <span class="op">=</span> padded_seq2[j] <span class="cf">if</span> padded_seq1[i] <span class="kw">in</span> PAM250 <span class="cf">else</span> padded_seq1[i]</span>
<span id="cb161-56"><a href="#cb161-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-57"><a href="#cb161-57" aria-hidden="true" tabindex="-1"></a>            diagonal_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> PAM250[key1][key2]</span>
<span id="cb161-58"><a href="#cb161-58" aria-hidden="true" tabindex="-1"></a>            up_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i <span class="op">-</span> <span class="dv">1</span>][j] <span class="op">-</span> indel_penalty</span>
<span id="cb161-59"><a href="#cb161-59" aria-hidden="true" tabindex="-1"></a>            left_score: <span class="bu">int</span> <span class="op">=</span> score_matrix[i][j <span class="op">-</span> <span class="dv">1</span>] <span class="op">-</span> indel_penalty</span>
<span id="cb161-60"><a href="#cb161-60" aria-hidden="true" tabindex="-1"></a>            score_matrix[i][j] <span class="op">=</span> <span class="bu">max</span>(diagonal_score, up_score, left_score, <span class="dv">0</span>)</span>
<span id="cb161-61"><a href="#cb161-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-62"><a href="#cb161-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">==</span> diagonal_score:</span>
<span id="cb161-63"><a href="#cb161-63" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"diagonal"</span></span>
<span id="cb161-64"><a href="#cb161-64" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> up_score:</span>
<span id="cb161-65"><a href="#cb161-65" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"up"</span></span>
<span id="cb161-66"><a href="#cb161-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">elif</span> score_matrix[i][j] <span class="op">==</span> left_score:</span>
<span id="cb161-67"><a href="#cb161-67" aria-hidden="true" tabindex="-1"></a>                backtrack_matrix[i][j] <span class="op">=</span> <span class="st">"left"</span></span>
<span id="cb161-68"><a href="#cb161-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-69"><a href="#cb161-69" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb161-70"><a href="#cb161-70" aria-hidden="true" tabindex="-1"></a>    max_i: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb161-71"><a href="#cb161-71" aria-hidden="true" tabindex="-1"></a>    max_j: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb161-72"><a href="#cb161-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq1)):</span>
<span id="cb161-73"><a href="#cb161-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(padded_seq2)):</span>
<span id="cb161-74"><a href="#cb161-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score_matrix[i][j] <span class="op">&gt;</span> max_score:</span>
<span id="cb161-75"><a href="#cb161-75" aria-hidden="true" tabindex="-1"></a>                max_score <span class="op">=</span> score_matrix[i][j]</span>
<span id="cb161-76"><a href="#cb161-76" aria-hidden="true" tabindex="-1"></a>                max_i, max_j <span class="op">=</span> i, j</span>
<span id="cb161-77"><a href="#cb161-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-78"><a href="#cb161-78" aria-hidden="true" tabindex="-1"></a>    i: <span class="bu">int</span> <span class="op">=</span> max_i</span>
<span id="cb161-79"><a href="#cb161-79" aria-hidden="true" tabindex="-1"></a>    j: <span class="bu">int</span> <span class="op">=</span> max_j</span>
<span id="cb161-80"><a href="#cb161-80" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb161-81"><a href="#cb161-81" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb161-82"><a href="#cb161-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> backtrack_matrix[i][j] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb161-83"><a href="#cb161-83" aria-hidden="true" tabindex="-1"></a>        direction: <span class="bu">str</span> <span class="op">=</span> backtrack_matrix[i][j]</span>
<span id="cb161-84"><a href="#cb161-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"diagonal"</span>:</span>
<span id="cb161-85"><a href="#cb161-85" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb161-86"><a href="#cb161-86" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb161-87"><a href="#cb161-87" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb161-88"><a href="#cb161-88" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb161-89"><a href="#cb161-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"up"</span>:</span>
<span id="cb161-90"><a href="#cb161-90" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> padded_seq1[i] <span class="op">+</span> aligned_seq1</span>
<span id="cb161-91"><a href="#cb161-91" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq2</span>
<span id="cb161-92"><a href="#cb161-92" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb161-93"><a href="#cb161-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb161-94"><a href="#cb161-94" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> <span class="st">"-"</span> <span class="op">+</span> aligned_seq1</span>
<span id="cb161-95"><a href="#cb161-95" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> padded_seq2[j] <span class="op">+</span> aligned_seq2</span>
<span id="cb161-96"><a href="#cb161-96" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb161-97"><a href="#cb161-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-98"><a href="#cb161-98" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb161-99"><a href="#cb161-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-100"><a href="#cb161-100" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb161-101"><a href="#cb161-101" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb161-102"><a href="#cb161-102" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb161-103"><a href="#cb161-103" aria-hidden="true" tabindex="-1"></a><span class="st">PENALTY</span></span>
<span id="cb161-104"><a href="#cb161-104" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb161-105"><a href="#cb161-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-106"><a href="#cb161-106" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb161-107"><a href="#cb161-107" aria-hidden="true" tabindex="-1"></a>sequence1: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb161-108"><a href="#cb161-108" aria-hidden="true" tabindex="-1"></a>sequence2: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>]</span>
<span id="cb161-109"><a href="#cb161-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-110"><a href="#cb161-110" aria-hidden="true" tabindex="-1"></a>alignment_score: <span class="bu">int</span></span>
<span id="cb161-111"><a href="#cb161-111" aria-hidden="true" tabindex="-1"></a>aligned_sequence1: <span class="bu">str</span></span>
<span id="cb161-112"><a href="#cb161-112" aria-hidden="true" tabindex="-1"></a>aligned_sequence2: <span class="bu">str</span></span>
<span id="cb161-113"><a href="#cb161-113" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_sequence1, aligned_sequence2 <span class="op">=</span> local_alignment(sequence1, sequence2)</span>
<span id="cb161-114"><a href="#cb161-114" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb161-115"><a href="#cb161-115" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence1)</span>
<span id="cb161-116"><a href="#cb161-116" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_sequence2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-edit-distance-between-two-strings" class="level1" data-number="54">
<h1 data-number="54"><span class="header-section-number">54</span> Compute the Edit Distance Between Two Strings</h1>
<p>Edit Distance Problem. Find the edit distance between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;The&nbsp;<a href="https://rosalind.info/glossary/edit-distance/">edit distance</a>&nbsp;between these strings.</p>
<section id="sample-dataset-54" class="level2" data-number="54.1">
<h2 data-number="54.1" class="anchored" data-anchor-id="sample-dataset-54"><span class="header-section-number">54.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEANLY</code></pre>
</section>
<section id="sample-output-54" class="level2" data-number="54.2">
<h2 data-number="54.2" class="anchored" data-anchor-id="sample-output-54"><span class="header-section-number">54.2</span> Sample Output</h2>
<pre><code>5</code></pre>
</section>
<section id="solution-54" class="level2" data-number="54.3">
<h2 data-number="54.3" class="anchored" data-anchor-id="solution-54"><span class="header-section-number">54.3</span> Solution</h2>
<div class="sourceCode" id="cb164"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb164-1"><a href="#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_edit_distance(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb164-2"><a href="#cb164-2" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> {}</span>
<span id="cb164-3"><a href="#cb164-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-4"><a href="#cb164-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb164-5"><a href="#cb164-5" aria-hidden="true" tabindex="-1"></a>        distance_matrix[target_index, <span class="dv">0</span>] <span class="op">=</span> target_index</span>
<span id="cb164-6"><a href="#cb164-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-7"><a href="#cb164-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb164-8"><a href="#cb164-8" aria-hidden="true" tabindex="-1"></a>        distance_matrix[<span class="dv">0</span>, source_index] <span class="op">=</span> source_index</span>
<span id="cb164-9"><a href="#cb164-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-10"><a href="#cb164-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(target)):</span>
<span id="cb164-11"><a href="#cb164-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(source)):</span>
<span id="cb164-12"><a href="#cb164-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> source[source_index] <span class="op">==</span> target[target_index]:</span>
<span id="cb164-13"><a href="#cb164-13" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> distance_matrix[target_index, source_index]</span>
<span id="cb164-14"><a href="#cb164-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb164-15"><a href="#cb164-15" aria-hidden="true" tabindex="-1"></a>                distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> <span class="bu">min</span>([</span>
<span id="cb164-16"><a href="#cb164-16" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index <span class="op">+</span> <span class="dv">1</span>, source_index],</span>
<span id="cb164-17"><a href="#cb164-17" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index],</span>
<span id="cb164-18"><a href="#cb164-18" aria-hidden="true" tabindex="-1"></a>                    distance_matrix[target_index, source_index <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb164-19"><a href="#cb164-19" aria-hidden="true" tabindex="-1"></a>                ]) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb164-20"><a href="#cb164-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-21"><a href="#cb164-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_matrix[<span class="bu">len</span>(target), <span class="bu">len</span>(source)]</span>
<span id="cb164-22"><a href="#cb164-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-23"><a href="#cb164-23" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb164-24"><a href="#cb164-24" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb164-25"><a href="#cb164-25" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb164-26"><a href="#cb164-26" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb164-27"><a href="#cb164-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-28"><a href="#cb164-28" aria-hidden="true" tabindex="-1"></a>source, target <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb164-29"><a href="#cb164-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_edit_distance(source, target))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-fitting-alignment-of-two-strings" class="level1" data-number="55">
<h1 data-number="55"><span class="header-section-number">55</span> Find a Highest-Scoring Fitting Alignment of Two Strings</h1>
<p>Fitting Alignment Problem. Construct a highest-scoring fitting alignment between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA strings</a>&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, where&nbsp;<em>v</em>&nbsp;has length at most 10000 and&nbsp;<em>w</em>&nbsp;has length at most 1000.</p>
<p>Return:&nbsp;The maximum score of a fitting alignment of&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, followed by a fitting alignment achieving this maximum score. Use the simple scoring method in which matches count +1 and both the mismatch and indel penalties are equal to 1. (If multiple fitting alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-55" class="level2" data-number="55.1">
<h2 data-number="55.1" class="anchored" data-anchor-id="sample-dataset-55"><span class="header-section-number">55.1</span> Sample Dataset</h2>
<pre><code>GTAGGCTTAAGGTTA
TAGATA</code></pre>
</section>
<section id="sample-output-55" class="level2" data-number="55.2">
<h2 data-number="55.2" class="anchored" data-anchor-id="sample-output-55"><span class="header-section-number">55.2</span> Sample Output</h2>
<pre><code>2
TAGGCTTA
TAGA--TA</code></pre>
</section>
<section id="solution-55" class="level2" data-number="55.3">
<h2 data-number="55.3" class="anchored" data-anchor-id="solution-55"><span class="header-section-number">55.3</span> Solution</h2>
<div class="sourceCode" id="cb167"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_fitting_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb167-6"><a href="#cb167-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-7"><a href="#cb167-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb167-8"><a href="#cb167-8" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="op">-</span>seq2_index</span>
<span id="cb167-9"><a href="#cb167-9" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb167-10"><a href="#cb167-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb167-11"><a href="#cb167-11" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb167-12"><a href="#cb167-12" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb167-13"><a href="#cb167-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-14"><a href="#cb167-14" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb167-15"><a href="#cb167-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb167-16"><a href="#cb167-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb167-17"><a href="#cb167-17" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb167-18"><a href="#cb167-18" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb167-19"><a href="#cb167-19" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb167-20"><a href="#cb167-20" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb167-21"><a href="#cb167-21" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb167-22"><a href="#cb167-22" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">-</span> <span class="dv">1</span>,</span>
<span id="cb167-23"><a href="#cb167-23" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb167-24"><a href="#cb167-24" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb167-25"><a href="#cb167-25" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb167-26"><a href="#cb167-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-27"><a href="#cb167-27" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[<span class="bu">len</span>(sequence2), i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb167-28"><a href="#cb167-28" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb167-29"><a href="#cb167-29" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb167-30"><a href="#cb167-30" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> <span class="bu">len</span>(sequence2)</span>
<span id="cb167-31"><a href="#cb167-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-32"><a href="#cb167-32" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb167-33"><a href="#cb167-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb167-34"><a href="#cb167-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb167-35"><a href="#cb167-35" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb167-36"><a href="#cb167-36" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb167-37"><a href="#cb167-37" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb167-38"><a href="#cb167-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb167-39"><a href="#cb167-39" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb167-40"><a href="#cb167-40" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb167-41"><a href="#cb167-41" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb167-42"><a href="#cb167-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb167-43"><a href="#cb167-43" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb167-44"><a href="#cb167-44" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb167-45"><a href="#cb167-45" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb167-46"><a href="#cb167-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-47"><a href="#cb167-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb167-48"><a href="#cb167-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-49"><a href="#cb167-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb167-50"><a href="#cb167-50" aria-hidden="true" tabindex="-1"></a><span class="st">GTAGGCTTAAGGTTA</span></span>
<span id="cb167-51"><a href="#cb167-51" aria-hidden="true" tabindex="-1"></a><span class="st">TAGATA</span></span>
<span id="cb167-52"><a href="#cb167-52" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb167-53"><a href="#cb167-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb167-54"><a href="#cb167-54" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb167-55"><a href="#cb167-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_fitting_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-overlap-alignment-of-two-strings" class="level1" data-number="56">
<h1 data-number="56"><span class="header-section-number">56</span> Find a Highest-Scoring Overlap Alignment of Two Strings</h1>
<p>Overlap Alignment Problem. Construct a highest-scoring overlap alignment between two strings.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">protein strings</a>&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, each of length at most 1000.</p>
<p>Return:&nbsp;The score of an optimal overlap alignment of&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, followed by an alignment of a suffix&nbsp;<em>v’</em>&nbsp;of&nbsp;<em>v</em>&nbsp;and a prefix&nbsp;<em>w’</em>&nbsp;of&nbsp;<em>w</em>&nbsp;achieving this maximum score. Use an alignment score in which matches count +1 and both the mismatch and indel penalties are 2. (If multiple overlap alignments achieving the maximum score exist, you may return any one.)</p>
<section id="sample-dataset-56" class="level2" data-number="56.1">
<h2 data-number="56.1" class="anchored" data-anchor-id="sample-dataset-56"><span class="header-section-number">56.1</span> Sample Dataset</h2>
<pre><code>PAWHEAE
HEAGAWGHEE</code></pre>
</section>
<section id="sample-output-56" class="level2" data-number="56.2">
<h2 data-number="56.2" class="anchored" data-anchor-id="sample-output-56"><span class="header-section-number">56.2</span> Sample Output</h2>
<pre><code>1
HEAE
HEAG</code></pre>
</section>
<section id="solution-56" class="level2" data-number="56.3">
<h2 data-number="56.3" class="anchored" data-anchor-id="solution-56"><span class="header-section-number">56.3</span> Solution</h2>
<div class="sourceCode" id="cb170"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Tuple, Dict</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_overlap_alignment(sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>, mismatch_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">2</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>    path_matrix: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb170-6"><a href="#cb170-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-7"><a href="#cb170-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb170-8"><a href="#cb170-8" aria-hidden="true" tabindex="-1"></a>        score_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> seq2_index <span class="op">*</span> mismatch_penalty</span>
<span id="cb170-9"><a href="#cb170-9" aria-hidden="true" tabindex="-1"></a>        path_matrix[seq2_index, <span class="dv">0</span>] <span class="op">=</span> <span class="st">"↑"</span></span>
<span id="cb170-10"><a href="#cb170-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb170-11"><a href="#cb170-11" aria-hidden="true" tabindex="-1"></a>        score_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb170-12"><a href="#cb170-12" aria-hidden="true" tabindex="-1"></a>        path_matrix[<span class="dv">0</span>, seq1_index] <span class="op">=</span> <span class="st">"←"</span></span>
<span id="cb170-13"><a href="#cb170-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-14"><a href="#cb170-14" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb170-15"><a href="#cb170-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2)):</span>
<span id="cb170-16"><a href="#cb170-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> seq1_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1)):</span>
<span id="cb170-17"><a href="#cb170-17" aria-hidden="true" tabindex="-1"></a>            current_position <span class="op">=</span> (seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb170-18"><a href="#cb170-18" aria-hidden="true" tabindex="-1"></a>            match_score <span class="op">=</span> <span class="dv">1</span> <span class="cf">if</span> sequence1[seq1_index] <span class="op">==</span> sequence2[seq2_index] <span class="cf">else</span> mismatch_penalty</span>
<span id="cb170-19"><a href="#cb170-19" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb170-20"><a href="#cb170-20" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index] <span class="op">+</span> match_score,</span>
<span id="cb170-21"><a href="#cb170-21" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index, seq1_index <span class="op">+</span> <span class="dv">1</span>] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb170-22"><a href="#cb170-22" aria-hidden="true" tabindex="-1"></a>                score_matrix[seq2_index <span class="op">+</span> <span class="dv">1</span>, seq1_index] <span class="op">+</span> mismatch_penalty,</span>
<span id="cb170-23"><a href="#cb170-23" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb170-24"><a href="#cb170-24" aria-hidden="true" tabindex="-1"></a>            score_matrix[current_position] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb170-25"><a href="#cb170-25" aria-hidden="true" tabindex="-1"></a>            path_matrix[current_position] <span class="op">=</span> [<span class="st">"↖"</span>, <span class="st">"↑"</span>, <span class="st">"←"</span>][options.index(<span class="bu">max</span>(options))]</span>
<span id="cb170-26"><a href="#cb170-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-27"><a href="#cb170-27" aria-hidden="true" tabindex="-1"></a>    final_scores <span class="op">=</span> [score_matrix[seq2_index, <span class="bu">len</span>(sequence1)] <span class="cf">for</span> seq2_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb170-28"><a href="#cb170-28" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="bu">max</span>(final_scores)</span>
<span id="cb170-29"><a href="#cb170-29" aria-hidden="true" tabindex="-1"></a>    seq2_end_index <span class="op">=</span> final_scores.index(max_score)</span>
<span id="cb170-30"><a href="#cb170-30" aria-hidden="true" tabindex="-1"></a>    seq1_end_index <span class="op">=</span> <span class="bu">len</span>(sequence1)</span>
<span id="cb170-31"><a href="#cb170-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-32"><a href="#cb170-32" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb170-33"><a href="#cb170-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> seq1_end_index <span class="op">&gt;</span> <span class="dv">0</span> <span class="kw">and</span> seq2_end_index <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb170-34"><a href="#cb170-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↖"</span>:</span>
<span id="cb170-35"><a href="#cb170-35" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb170-36"><a href="#cb170-36" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb170-37"><a href="#cb170-37" aria-hidden="true" tabindex="-1"></a>            seq2_end_index, seq1_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span>, seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb170-38"><a href="#cb170-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"←"</span>:</span>
<span id="cb170-39"><a href="#cb170-39" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[seq1_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb170-40"><a href="#cb170-40" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb170-41"><a href="#cb170-41" aria-hidden="true" tabindex="-1"></a>            seq1_end_index <span class="op">=</span> seq1_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb170-42"><a href="#cb170-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> path_matrix[seq2_end_index, seq1_end_index] <span class="op">==</span> <span class="st">"↑"</span>:</span>
<span id="cb170-43"><a href="#cb170-43" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb170-44"><a href="#cb170-44" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[seq2_end_index <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb170-45"><a href="#cb170-45" aria-hidden="true" tabindex="-1"></a>            seq2_end_index <span class="op">=</span> seq2_end_index <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb170-46"><a href="#cb170-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-47"><a href="#cb170-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1[::<span class="op">-</span><span class="dv">1</span>], aligned_seq2[::<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb170-48"><a href="#cb170-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-49"><a href="#cb170-49" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb170-50"><a href="#cb170-50" aria-hidden="true" tabindex="-1"></a><span class="st">PAWHEAE</span></span>
<span id="cb170-51"><a href="#cb170-51" aria-hidden="true" tabindex="-1"></a><span class="st">HEAGAWGHEE</span></span>
<span id="cb170-52"><a href="#cb170-52" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb170-53"><a href="#cb170-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-54"><a href="#cb170-54" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb170-55"><a href="#cb170-55" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>calculate_overlap_alignment(sequence1, sequence2), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="align-two-strings-using-affine-gap-penalties" class="level1" data-number="57">
<h1 data-number="57"><span class="header-section-number">57</span> Align Two Strings Using Affine Gap Penalties</h1>
<p>Alignment with Affine Gap Penalties Problem. Construct a highest-scoring global alignment of two strings (with affine gap penalties).</p>
<p>Given:&nbsp;Two amino acid strings&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>&nbsp;(each of length at most 100).</p>
<p>Return:&nbsp;The maximum alignment score between&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>, followed by an alignment of&nbsp;<em>v</em>&nbsp;and&nbsp;<em>w</em>&nbsp;achieving this maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix, a gap opening penalty of 11, and a gap extension penalty of 1.</p>
<section id="sample-dataset-57" class="level2" data-number="57.1">
<h2 data-number="57.1" class="anchored" data-anchor-id="sample-dataset-57"><span class="header-section-number">57.1</span> Sample Dataset</h2>
<pre><code>PRTEINS
PRTWPSEIN</code></pre>
</section>
<section id="sample-output-57" class="level2" data-number="57.2">
<h2 data-number="57.2" class="anchored" data-anchor-id="sample-output-57"><span class="header-section-number">57.2</span> Sample Output</h2>
<pre><code>8
PRT---EINS
PRTWPSEIN-</code></pre>
</section>
<section id="solution-57" class="level2" data-number="57.3">
<h2 data-number="57.3" class="anchored" data-anchor-id="solution-57"><span class="header-section-number">57.3</span> Solution</h2>
<div class="sourceCode" id="cb173"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List, Optional</span>
<span id="cb173-2"><a href="#cb173-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-3"><a href="#cb173-3" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb173-4"><a href="#cb173-4" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb173-5"><a href="#cb173-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-6"><a href="#cb173-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-7"><a href="#cb173-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-8"><a href="#cb173-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-9"><a href="#cb173-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb173-10"><a href="#cb173-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb173-11"><a href="#cb173-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-12"><a href="#cb173-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-13"><a href="#cb173-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-14"><a href="#cb173-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-15"><a href="#cb173-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-16"><a href="#cb173-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-17"><a href="#cb173-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-18"><a href="#cb173-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-19"><a href="#cb173-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb173-20"><a href="#cb173-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb173-21"><a href="#cb173-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-22"><a href="#cb173-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb173-23"><a href="#cb173-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-24"><a href="#cb173-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-25"><a href="#cb173-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb173-26"><a href="#cb173-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-27"><a href="#cb173-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-28"><a href="#cb173-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-29"><a href="#cb173-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-30"><a href="#cb173-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-31"><a href="#cb173-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-32"><a href="#cb173-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-33"><a href="#cb173-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb173-34"><a href="#cb173-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-35"><a href="#cb173-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb173-36"><a href="#cb173-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb173-37"><a href="#cb173-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-38"><a href="#cb173-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb173-39"><a href="#cb173-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-40"><a href="#cb173-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb173-41"><a href="#cb173-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb173-42"><a href="#cb173-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb173-43"><a href="#cb173-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb173-44"><a href="#cb173-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-45"><a href="#cb173-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb173-46"><a href="#cb173-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-47"><a href="#cb173-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-48"><a href="#cb173-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-49"><a href="#cb173-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-50"><a href="#cb173-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-51"><a href="#cb173-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb173-52"><a href="#cb173-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-53"><a href="#cb173-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-54"><a href="#cb173-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-55"><a href="#cb173-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-56"><a href="#cb173-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-57"><a href="#cb173-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb173-58"><a href="#cb173-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb173-59"><a href="#cb173-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb173-60"><a href="#cb173-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb173-61"><a href="#cb173-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb173-62"><a href="#cb173-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-63"><a href="#cb173-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-64"><a href="#cb173-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-65"><a href="#cb173-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-66"><a href="#cb173-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb173-67"><a href="#cb173-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-68"><a href="#cb173-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-69"><a href="#cb173-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-70"><a href="#cb173-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb173-71"><a href="#cb173-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb173-72"><a href="#cb173-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb173-73"><a href="#cb173-73" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb173-74"><a href="#cb173-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-75"><a href="#cb173-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> insert_gap(sequence: <span class="bu">str</span>, position: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb173-76"><a href="#cb173-76" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Insert a gap ('-') into the sequence at the specified position."""</span></span>
<span id="cb173-77"><a href="#cb173-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[:position] <span class="op">+</span> <span class="st">"-"</span> <span class="op">+</span> sequence[position:]</span>
<span id="cb173-78"><a href="#cb173-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-79"><a href="#cb173-79" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> global_alignment_affine(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>, gap_open_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">11</span>, gap_extend_penalty: <span class="bu">int</span> <span class="op">=</span> <span class="op">-</span><span class="dv">1</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb173-80"><a href="#cb173-80" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb173-81"><a href="#cb173-81" aria-hidden="true" tabindex="-1"></a><span class="co">    Perform global sequence alignment with affine gap penalty.</span></span>
<span id="cb173-82"><a href="#cb173-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-83"><a href="#cb173-83" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb173-84"><a href="#cb173-84" aria-hidden="true" tabindex="-1"></a><span class="co">    seq1 (str): First sequence to align</span></span>
<span id="cb173-85"><a href="#cb173-85" aria-hidden="true" tabindex="-1"></a><span class="co">    seq2 (str): Second sequence to align</span></span>
<span id="cb173-86"><a href="#cb173-86" aria-hidden="true" tabindex="-1"></a><span class="co">    gap_open_penalty (int): Penalty for opening a gap</span></span>
<span id="cb173-87"><a href="#cb173-87" aria-hidden="true" tabindex="-1"></a><span class="co">    gap_extend_penalty (int): Penalty for extending a gap</span></span>
<span id="cb173-88"><a href="#cb173-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-89"><a href="#cb173-89" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb173-90"><a href="#cb173-90" aria-hidden="true" tabindex="-1"></a><span class="co">    Tuple[int, str, str]: Alignment score and aligned sequences</span></span>
<span id="cb173-91"><a href="#cb173-91" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb173-92"><a href="#cb173-92" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> BLOSUM62</span>
<span id="cb173-93"><a href="#cb173-93" aria-hidden="true" tabindex="-1"></a>    match_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-94"><a href="#cb173-94" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-95"><a href="#cb173-95" aria-hidden="true" tabindex="-1"></a>    gap_seq2_score: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-96"><a href="#cb173-96" aria-hidden="true" tabindex="-1"></a>    prev_match: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-97"><a href="#cb173-97" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq1: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-98"><a href="#cb173-98" aria-hidden="true" tabindex="-1"></a>    prev_gap_seq2: Dict[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb173-99"><a href="#cb173-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-100"><a href="#cb173-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize matrices</span></span>
<span id="cb173-101"><a href="#cb173-101" aria-hidden="true" tabindex="-1"></a>    gap_seq1_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> match_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> gap_seq2_score[<span class="dv">0</span>, <span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb173-102"><a href="#cb173-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb173-103"><a href="#cb173-103" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb173-104"><a href="#cb173-104" aria-hidden="true" tabindex="-1"></a>        match_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (i <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb173-105"><a href="#cb173-105" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[i, <span class="dv">0</span>] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb173-106"><a href="#cb173-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb173-107"><a href="#cb173-107" aria-hidden="true" tabindex="-1"></a>        gap_seq2_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb173-108"><a href="#cb173-108" aria-hidden="true" tabindex="-1"></a>        match_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">+</span> (j <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> gap_extend_penalty</span>
<span id="cb173-109"><a href="#cb173-109" aria-hidden="true" tabindex="-1"></a>        gap_seq1_score[<span class="dv">0</span>, j] <span class="op">=</span> gap_open_penalty <span class="op">*</span> <span class="dv">10</span>  <span class="co"># Large penalty to avoid this case</span></span>
<span id="cb173-110"><a href="#cb173-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-111"><a href="#cb173-111" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill matrices</span></span>
<span id="cb173-112"><a href="#cb173-112" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb173-113"><a href="#cb173-113" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(seq2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb173-114"><a href="#cb173-114" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq1</span></span>
<span id="cb173-115"><a href="#cb173-115" aria-hidden="true" tabindex="-1"></a>            gap_seq1_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb173-116"><a href="#cb173-116" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb173-117"><a href="#cb173-117" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">+</span> gap_open_penalty</span>
<span id="cb173-118"><a href="#cb173-118" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb173-119"><a href="#cb173-119" aria-hidden="true" tabindex="-1"></a>            gap_seq1_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq1_options)</span>
<span id="cb173-120"><a href="#cb173-120" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq1[i, j] <span class="op">=</span> gap_seq1_options.index(gap_seq1_score[i, j])</span>
<span id="cb173-121"><a href="#cb173-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-122"><a href="#cb173-122" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate scores for gap in seq2</span></span>
<span id="cb173-123"><a href="#cb173-123" aria-hidden="true" tabindex="-1"></a>            gap_seq2_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb173-124"><a href="#cb173-124" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_extend_penalty,</span>
<span id="cb173-125"><a href="#cb173-125" aria-hidden="true" tabindex="-1"></a>                match_score[i, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_open_penalty</span>
<span id="cb173-126"><a href="#cb173-126" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb173-127"><a href="#cb173-127" aria-hidden="true" tabindex="-1"></a>            gap_seq2_score[i, j] <span class="op">=</span> <span class="bu">max</span>(gap_seq2_options)</span>
<span id="cb173-128"><a href="#cb173-128" aria-hidden="true" tabindex="-1"></a>            prev_gap_seq2[i, j] <span class="op">=</span> gap_seq2_options.index(gap_seq2_score[i, j])</span>
<span id="cb173-129"><a href="#cb173-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-130"><a href="#cb173-130" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Calculate match/mismatch score</span></span>
<span id="cb173-131"><a href="#cb173-131" aria-hidden="true" tabindex="-1"></a>            blosum_score: <span class="bu">int</span> <span class="op">=</span> scoring_matrix.get((seq1[i<span class="op">-</span><span class="dv">1</span>], seq2[j<span class="op">-</span><span class="dv">1</span>]), scoring_matrix.get((seq2[j<span class="op">-</span><span class="dv">1</span>], seq1[i<span class="op">-</span><span class="dv">1</span>]), <span class="dv">0</span>))</span>
<span id="cb173-132"><a href="#cb173-132" aria-hidden="true" tabindex="-1"></a>            match_options: List[<span class="bu">int</span>] <span class="op">=</span> [</span>
<span id="cb173-133"><a href="#cb173-133" aria-hidden="true" tabindex="-1"></a>                gap_seq1_score[i, j],</span>
<span id="cb173-134"><a href="#cb173-134" aria-hidden="true" tabindex="-1"></a>                match_score[i <span class="op">-</span> <span class="dv">1</span>, j <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> blosum_score,</span>
<span id="cb173-135"><a href="#cb173-135" aria-hidden="true" tabindex="-1"></a>                gap_seq2_score[i, j]</span>
<span id="cb173-136"><a href="#cb173-136" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb173-137"><a href="#cb173-137" aria-hidden="true" tabindex="-1"></a>            match_score[i, j] <span class="op">=</span> <span class="bu">max</span>(match_options)</span>
<span id="cb173-138"><a href="#cb173-138" aria-hidden="true" tabindex="-1"></a>            prev_match[i, j] <span class="op">=</span> match_options.index(match_score[i, j])</span>
<span id="cb173-139"><a href="#cb173-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-140"><a href="#cb173-140" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback</span></span>
<span id="cb173-141"><a href="#cb173-141" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="bu">len</span>(seq1), <span class="bu">len</span>(seq2)</span>
<span id="cb173-142"><a href="#cb173-142" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> seq1, seq2</span>
<span id="cb173-143"><a href="#cb173-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-144"><a href="#cb173-144" aria-hidden="true" tabindex="-1"></a>    scores: List[<span class="bu">int</span>] <span class="op">=</span> [gap_seq1_score[i, j], match_score[i, j], gap_seq2_score[i, j]]</span>
<span id="cb173-145"><a href="#cb173-145" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">max</span>(scores)</span>
<span id="cb173-146"><a href="#cb173-146" aria-hidden="true" tabindex="-1"></a>    current_matrix: <span class="bu">int</span> <span class="op">=</span> scores.index(max_score)</span>
<span id="cb173-147"><a href="#cb173-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-148"><a href="#cb173-148" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">*</span> j <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb173-149"><a href="#cb173-149" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_matrix <span class="op">==</span> <span class="dv">0</span>:  <span class="co"># In gap_seq1_score matrix</span></span>
<span id="cb173-150"><a href="#cb173-150" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq1[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb173-151"><a href="#cb173-151" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb173-152"><a href="#cb173-152" aria-hidden="true" tabindex="-1"></a>            i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-153"><a href="#cb173-153" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, j)</span>
<span id="cb173-154"><a href="#cb173-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> current_matrix <span class="op">==</span> <span class="dv">1</span>:  <span class="co"># In match_score matrix</span></span>
<span id="cb173-155"><a href="#cb173-155" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_match[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb173-156"><a href="#cb173-156" aria-hidden="true" tabindex="-1"></a>                i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-157"><a href="#cb173-157" aria-hidden="true" tabindex="-1"></a>                j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-158"><a href="#cb173-158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb173-159"><a href="#cb173-159" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> prev_match[i, j]</span>
<span id="cb173-160"><a href="#cb173-160" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:  <span class="co"># In gap_seq2_score matrix</span></span>
<span id="cb173-161"><a href="#cb173-161" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_gap_seq2[i, j] <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb173-162"><a href="#cb173-162" aria-hidden="true" tabindex="-1"></a>                current_matrix <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb173-163"><a href="#cb173-163" aria-hidden="true" tabindex="-1"></a>            j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-164"><a href="#cb173-164" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, i)</span>
<span id="cb173-165"><a href="#cb173-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-166"><a href="#cb173-166" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Handle remaining overhangs</span></span>
<span id="cb173-167"><a href="#cb173-167" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb173-168"><a href="#cb173-168" aria-hidden="true" tabindex="-1"></a>        aligned_seq2 <span class="op">=</span> insert_gap(aligned_seq2, <span class="dv">0</span>)</span>
<span id="cb173-169"><a href="#cb173-169" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-170"><a href="#cb173-170" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> j <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb173-171"><a href="#cb173-171" aria-hidden="true" tabindex="-1"></a>        aligned_seq1 <span class="op">=</span> insert_gap(aligned_seq1, <span class="dv">0</span>)</span>
<span id="cb173-172"><a href="#cb173-172" aria-hidden="true" tabindex="-1"></a>        j <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb173-173"><a href="#cb173-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-174"><a href="#cb173-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> max_score, aligned_seq1, aligned_seq2</span>
<span id="cb173-175"><a href="#cb173-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-176"><a href="#cb173-176" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb173-177"><a href="#cb173-177" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb173-178"><a href="#cb173-178" aria-hidden="true" tabindex="-1"></a><span class="st">PRTEINS</span></span>
<span id="cb173-179"><a href="#cb173-179" aria-hidden="true" tabindex="-1"></a><span class="st">PRTWPSEIN</span></span>
<span id="cb173-180"><a href="#cb173-180" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb173-181"><a href="#cb173-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-182"><a href="#cb173-182" aria-hidden="true" tabindex="-1"></a>seq1, seq2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb173-183"><a href="#cb173-183" aria-hidden="true" tabindex="-1"></a>alignment_score, aligned_seq1, aligned_seq2 <span class="op">=</span> global_alignment_affine(seq1, seq2)</span>
<span id="cb173-184"><a href="#cb173-184" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score, aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-middle-edge-in-an-alignment-graph-in-linear-space" class="level1" data-number="58">
<h1 data-number="58"><span class="header-section-number">58</span> Find a Middle Edge in an Alignment Graph in Linear Space</h1>
<p>Middle Edge in Linear Space Problem. Find a middle edge in the alignment graph in linear space.</p>
<p>Given:&nbsp;Two&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>.</p>
<p>Return:&nbsp;A middle edge in the alignment graph of these strings, where the optimal path is defined by the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix and a linear indel penalty equal to 5. Return the middle edge in the form”(<em>i</em>,&nbsp;<em>j</em>) (<em>k</em>,&nbsp;<em>l</em>)“, where (<em>i</em>,&nbsp;<em>j</em>) connects to (<em>k</em>,&nbsp;<em>l</em>).</p>
<section id="sample-dataset-58" class="level2" data-number="58.1">
<h2 data-number="58.1" class="anchored" data-anchor-id="sample-dataset-58"><span class="header-section-number">58.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEASNLY</code></pre>
</section>
<section id="sample-output-58" class="level2" data-number="58.2">
<h2 data-number="58.2" class="anchored" data-anchor-id="sample-output-58"><span class="header-section-number">58.2</span> Sample Output</h2>
<pre><code>(4, 3) (5, 4)</code></pre>
</section>
<section id="solution-58" class="level2" data-number="58.3">
<h2 data-number="58.3" class="anchored" data-anchor-id="solution-58"><span class="header-section-number">58.3</span> Solution</h2>
<div class="sourceCode" id="cb176"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-7"><a href="#cb176-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-8"><a href="#cb176-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-9"><a href="#cb176-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-10"><a href="#cb176-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb176-11"><a href="#cb176-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb176-12"><a href="#cb176-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-13"><a href="#cb176-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-14"><a href="#cb176-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-15"><a href="#cb176-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-16"><a href="#cb176-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-17"><a href="#cb176-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-18"><a href="#cb176-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-19"><a href="#cb176-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-20"><a href="#cb176-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb176-21"><a href="#cb176-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb176-22"><a href="#cb176-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-23"><a href="#cb176-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb176-24"><a href="#cb176-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-25"><a href="#cb176-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-26"><a href="#cb176-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb176-27"><a href="#cb176-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-28"><a href="#cb176-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-29"><a href="#cb176-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-30"><a href="#cb176-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-31"><a href="#cb176-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-32"><a href="#cb176-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-33"><a href="#cb176-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-34"><a href="#cb176-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb176-35"><a href="#cb176-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-36"><a href="#cb176-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb176-37"><a href="#cb176-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb176-38"><a href="#cb176-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-39"><a href="#cb176-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb176-40"><a href="#cb176-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-41"><a href="#cb176-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb176-42"><a href="#cb176-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb176-43"><a href="#cb176-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb176-44"><a href="#cb176-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb176-45"><a href="#cb176-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-46"><a href="#cb176-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb176-47"><a href="#cb176-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-48"><a href="#cb176-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-49"><a href="#cb176-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-50"><a href="#cb176-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-51"><a href="#cb176-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-52"><a href="#cb176-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb176-53"><a href="#cb176-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-54"><a href="#cb176-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-55"><a href="#cb176-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-56"><a href="#cb176-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-57"><a href="#cb176-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-58"><a href="#cb176-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb176-59"><a href="#cb176-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb176-60"><a href="#cb176-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb176-61"><a href="#cb176-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb176-62"><a href="#cb176-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb176-63"><a href="#cb176-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-64"><a href="#cb176-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-65"><a href="#cb176-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-66"><a href="#cb176-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-67"><a href="#cb176-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb176-68"><a href="#cb176-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-69"><a href="#cb176-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-70"><a href="#cb176-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-71"><a href="#cb176-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb176-72"><a href="#cb176-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb176-73"><a href="#cb176-73" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb176-74"><a href="#cb176-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb176-75"><a href="#cb176-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-76"><a href="#cb176-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb176-77"><a href="#cb176-77" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb176-78"><a href="#cb176-78" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb176-79"><a href="#cb176-79" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb176-80"><a href="#cb176-80" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb176-81"><a href="#cb176-81" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb176-82"><a href="#cb176-82" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb176-83"><a href="#cb176-83" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb176-84"><a href="#cb176-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-85"><a href="#cb176-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb176-86"><a href="#cb176-86" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb176-87"><a href="#cb176-87" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb176-88"><a href="#cb176-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb176-89"><a href="#cb176-89" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb176-90"><a href="#cb176-90" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb176-91"><a href="#cb176-91" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb176-92"><a href="#cb176-92" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb176-93"><a href="#cb176-93" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb176-94"><a href="#cb176-94" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb176-95"><a href="#cb176-95" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb176-96"><a href="#cb176-96" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb176-97"><a href="#cb176-97" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb176-98"><a href="#cb176-98" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb176-99"><a href="#cb176-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-100"><a href="#cb176-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb176-101"><a href="#cb176-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-102"><a href="#cb176-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb176-103"><a href="#cb176-103" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb176-104"><a href="#cb176-104" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb176-105"><a href="#cb176-105" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb176-106"><a href="#cb176-106" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb176-107"><a href="#cb176-107" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb176-108"><a href="#cb176-108" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb176-109"><a href="#cb176-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-110"><a href="#cb176-110" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb176-111"><a href="#cb176-111" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb176-112"><a href="#cb176-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb176-113"><a href="#cb176-113" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb176-114"><a href="#cb176-114" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb176-115"><a href="#cb176-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb176-116"><a href="#cb176-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-117"><a href="#cb176-117" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb176-118"><a href="#cb176-118" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb176-119"><a href="#cb176-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-120"><a href="#cb176-120" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb176-121"><a href="#cb176-121" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb176-122"><a href="#cb176-122" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb176-123"><a href="#cb176-123" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb176-124"><a href="#cb176-124" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb176-125"><a href="#cb176-125" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb176-126"><a href="#cb176-126" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb176-127"><a href="#cb176-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-128"><a href="#cb176-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb176-129"><a href="#cb176-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-130"><a href="#cb176-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb176-131"><a href="#cb176-131" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb176-132"><a href="#cb176-132" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb176-133"><a href="#cb176-133" aria-hidden="true" tabindex="-1"></a><span class="st">MEASNLY</span></span>
<span id="cb176-134"><a href="#cb176-134" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb176-135"><a href="#cb176-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb176-136"><a href="#cb176-136" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb176-137"><a href="#cb176-137" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_middle_edge(sequence1, sequence2, BLOSUM62, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb176-138"><a href="#cb176-138" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="align-two-strings-using-linear-space" class="level1" data-number="59">
<h1 data-number="59"><span class="header-section-number">59</span> Align Two Strings Using Linear Space</h1>
<p>Global Alignment in Linear Space Problem. Find the highest-scoring alignment between two strings using a scoring matrix in linear space.</p>
<p>Given:&nbsp;Two&nbsp;<strong>long</strong>&nbsp;<a href="https://rosalind.info/glossary/protein-string/">amino acid strings</a>&nbsp;(of length approximately 10,000).</p>
<p>Return:&nbsp;The maximum alignment score of these strings, followed by an alignment achieving this maximum score. Use the&nbsp;<a href="https://rosalind.info/glossary/blosum62/">BLOSUM62</a>&nbsp;scoring matrix and indel penalty σ = 5.</p>
<section id="sample-dataset-59" class="level2" data-number="59.1">
<h2 data-number="59.1" class="anchored" data-anchor-id="sample-dataset-59"><span class="header-section-number">59.1</span> Sample Dataset</h2>
<pre><code>PLEASANTLY
MEANLY</code></pre>
</section>
<section id="sample-output-59" class="level2" data-number="59.2">
<h2 data-number="59.2" class="anchored" data-anchor-id="sample-output-59"><span class="header-section-number">59.2</span> Sample Output</h2>
<pre><code>8
PLEASANTLY
-MEA--N-LY</code></pre>
</section>
<section id="solution-59" class="level2" data-number="59.3">
<h2 data-number="59.3" class="anchored" data-anchor-id="solution-59"><span class="header-section-number">59.3</span> Solution</h2>
<div class="sourceCode" id="cb179"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> floor</span>
<span id="cb179-2"><a href="#cb179-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, Tuple, List</span>
<span id="cb179-3"><a href="#cb179-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-4"><a href="#cb179-4" aria-hidden="true" tabindex="-1"></a>BLOSUM62: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb179-5"><a href="#cb179-5" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'F'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb179-6"><a href="#cb179-6" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'Q'</span>): <span class="dv">5</span>, (<span class="st">'N'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-7"><a href="#cb179-7" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Q'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'D'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'H'</span>): <span class="dv">8</span>, (<span class="st">'S'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-8"><a href="#cb179-8" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-9"><a href="#cb179-9" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'B'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-10"><a href="#cb179-10" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'Y'</span>): <span class="dv">7</span>,</span>
<span id="cb179-11"><a href="#cb179-11" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'E'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'Z'</span>): <span class="dv">4</span>,</span>
<span id="cb179-12"><a href="#cb179-12" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'C'</span>, <span class="st">'C'</span>): <span class="dv">9</span>, (<span class="st">'M'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-13"><a href="#cb179-13" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'P'</span>, <span class="st">'P'</span>): <span class="dv">7</span>, (<span class="st">'V'</span>, <span class="st">'I'</span>): <span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-14"><a href="#cb179-14" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'M'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-15"><a href="#cb179-15" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'K'</span>): <span class="dv">5</span>, (<span class="st">'P'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'I'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-16"><a href="#cb179-16" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-17"><a href="#cb179-17" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'F'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-18"><a href="#cb179-18" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-19"><a href="#cb179-19" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'X'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'K'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-20"><a href="#cb179-20" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'D'</span>, <span class="st">'N'</span>): <span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'K'</span>): <span class="dv">0</span>,</span>
<span id="cb179-21"><a href="#cb179-21" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'X'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'I'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'T'</span>): <span class="dv">0</span>,</span>
<span id="cb179-22"><a href="#cb179-22" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'M'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-23"><a href="#cb179-23" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'S'</span>): <span class="dv">4</span>, (<span class="st">'L'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Q'</span>, <span class="st">'R'</span>): <span class="dv">1</span>,</span>
<span id="cb179-24"><a href="#cb179-24" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'N'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-25"><a href="#cb179-25" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'S'</span>, <span class="st">'G'</span>): <span class="dv">0</span>, (<span class="st">'L'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-26"><a href="#cb179-26" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'K'</span>): <span class="dv">0</span>, (<span class="st">'Q'</span>, <span class="st">'N'</span>): <span class="dv">0</span>,</span>
<span id="cb179-27"><a href="#cb179-27" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'N'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Y'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-28"><a href="#cb179-28" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'F'</span>): <span class="dv">3</span>, (<span class="st">'C'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'V'</span>, <span class="st">'L'</span>): <span class="dv">1</span>, (<span class="st">'G'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-29"><a href="#cb179-29" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'K'</span>, <span class="st">'R'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'D'</span>): <span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-30"><a href="#cb179-30" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'M'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'C'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-31"><a href="#cb179-31" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'T'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-32"><a href="#cb179-32" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'K'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-33"><a href="#cb179-33" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-34"><a href="#cb179-34" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'V'</span>): <span class="dv">4</span>, (<span class="st">'M'</span>, <span class="st">'I'</span>): <span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb179-35"><a href="#cb179-35" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'M'</span>): <span class="dv">5</span>, (<span class="st">'K'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-36"><a href="#cb179-36" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'D'</span>): <span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Q'</span>, <span class="st">'D'</span>): <span class="dv">0</span>,</span>
<span id="cb179-37"><a href="#cb179-37" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'H'</span>): <span class="dv">0</span>,</span>
<span id="cb179-38"><a href="#cb179-38" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'H'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'F'</span>): <span class="dv">6</span>, (<span class="st">'X'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-39"><a href="#cb179-39" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'D'</span>): <span class="dv">4</span>, (<span class="st">'D'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'S'</span>): <span class="dv">0</span>,</span>
<span id="cb179-40"><a href="#cb179-40" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'V'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-41"><a href="#cb179-41" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'H'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb179-42"><a href="#cb179-42" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'T'</span>, <span class="st">'T'</span>): <span class="dv">5</span>, (<span class="st">'S'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb179-43"><a href="#cb179-43" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'B'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'L'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'N'</span>): <span class="dv">1</span>,</span>
<span id="cb179-44"><a href="#cb179-44" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'L'</span>): <span class="dv">4</span>, (<span class="st">'Y'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'Q'</span>): <span class="dv">2</span>,</span>
<span id="cb179-45"><a href="#cb179-45" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'S'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-46"><a href="#cb179-46" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'W'</span>): <span class="dv">2</span>, (<span class="st">'E'</span>, <span class="st">'E'</span>): <span class="dv">5</span>,</span>
<span id="cb179-47"><a href="#cb179-47" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'C'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-48"><a href="#cb179-48" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'V'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'V'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-49"><a href="#cb179-49" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'Q'</span>): <span class="dv">1</span>, (<span class="st">'R'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-50"><a href="#cb179-50" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'P'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'I'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'K'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'M'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-51"><a href="#cb179-51" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'W'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'W'</span>, <span class="st">'W'</span>): <span class="dv">11</span>, (<span class="st">'M'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-52"><a href="#cb179-52" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'L'</span>): <span class="dv">2</span>, (<span class="st">'K'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'E'</span>): <span class="dv">4</span>,</span>
<span id="cb179-53"><a href="#cb179-53" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-54"><a href="#cb179-54" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'B'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-55"><a href="#cb179-55" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'Q'</span>): <span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Z'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-56"><a href="#cb179-56" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'E'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'V'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'F'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'B'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-57"><a href="#cb179-57" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'X'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'D'</span>, <span class="st">'D'</span>): <span class="dv">6</span>, (<span class="st">'W'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Z'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-58"><a href="#cb179-58" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'S'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>, (<span class="st">'W'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'W'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'H'</span>, <span class="st">'Q'</span>): <span class="dv">0</span>,</span>
<span id="cb179-59"><a href="#cb179-59" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'W'</span>, <span class="st">'N'</span>): <span class="op">-</span><span class="dv">4</span>, (<span class="st">'S'</span>, <span class="st">'A'</span>): <span class="dv">1</span>, (<span class="st">'L'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">4</span>,</span>
<span id="cb179-60"><a href="#cb179-60" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'W'</span>, <span class="st">'S'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'S'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'H'</span>, <span class="st">'E'</span>): <span class="dv">0</span>, (<span class="st">'S'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">2</span>,</span>
<span id="cb179-61"><a href="#cb179-61" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'H'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'S'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'L'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Y'</span>, <span class="st">'H'</span>): <span class="dv">2</span>,</span>
<span id="cb179-62"><a href="#cb179-62" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Y'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'G'</span>, <span class="st">'G'</span>): <span class="dv">6</span>,</span>
<span id="cb179-63"><a href="#cb179-63" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'G'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'E'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'Y'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'Y'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-64"><a href="#cb179-64" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'A'</span>, <span class="st">'A'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'T'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-65"><a href="#cb179-65" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'V'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'T'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'I'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'Z'</span>, <span class="st">'T'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-66"><a href="#cb179-66" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'C'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'V'</span>, <span class="st">'P'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'P'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'C'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-67"><a href="#cb179-67" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'K'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'I'</span>, <span class="st">'I'</span>): <span class="dv">4</span>, (<span class="st">'P'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'M'</span>, <span class="st">'G'</span>): <span class="op">-</span><span class="dv">3</span>,</span>
<span id="cb179-68"><a href="#cb179-68" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'T'</span>, <span class="st">'S'</span>): <span class="dv">1</span>, (<span class="st">'I'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'P'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">2</span>, (<span class="st">'M'</span>, <span class="st">'K'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-69"><a href="#cb179-69" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'I'</span>, <span class="st">'A'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'P'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'R'</span>, <span class="st">'R'</span>): <span class="dv">5</span>, (<span class="st">'X'</span>, <span class="st">'M'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-70"><a href="#cb179-70" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'L'</span>, <span class="st">'I'</span>): <span class="dv">2</span>, (<span class="st">'X'</span>, <span class="st">'I'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'B'</span>): <span class="dv">1</span>, (<span class="st">'X'</span>, <span class="st">'E'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-71"><a href="#cb179-71" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'Z'</span>, <span class="st">'N'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'A'</span>): <span class="dv">0</span>, (<span class="st">'B'</span>, <span class="st">'R'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'N'</span>): <span class="dv">3</span>,</span>
<span id="cb179-72"><a href="#cb179-72" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'F'</span>, <span class="st">'D'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'X'</span>, <span class="st">'Y'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'Z'</span>, <span class="st">'R'</span>): <span class="dv">0</span>, (<span class="st">'F'</span>, <span class="st">'H'</span>): <span class="op">-</span><span class="dv">1</span>,</span>
<span id="cb179-73"><a href="#cb179-73" aria-hidden="true" tabindex="-1"></a>    (<span class="st">'B'</span>, <span class="st">'F'</span>): <span class="op">-</span><span class="dv">3</span>, (<span class="st">'F'</span>, <span class="st">'L'</span>): <span class="dv">0</span>, (<span class="st">'X'</span>, <span class="st">'Q'</span>): <span class="op">-</span><span class="dv">1</span>, (<span class="st">'B'</span>, <span class="st">'B'</span>): <span class="dv">4</span></span>
<span id="cb179-74"><a href="#cb179-74" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb179-75"><a href="#cb179-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-76"><a href="#cb179-76" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_scores(</span>
<span id="cb179-77"><a href="#cb179-77" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb179-78"><a href="#cb179-78" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb179-79"><a href="#cb179-79" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb179-80"><a href="#cb179-80" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb179-81"><a href="#cb179-81" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">int</span>], List[<span class="bu">int</span>]]:</span>
<span id="cb179-82"><a href="#cb179-82" aria-hidden="true" tabindex="-1"></a>    current_scores <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> gap_penalty, gap_penalty))</span>
<span id="cb179-83"><a href="#cb179-83" aria-hidden="true" tabindex="-1"></a>    backtrack <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb179-84"><a href="#cb179-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-85"><a href="#cb179-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence2) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb179-86"><a href="#cb179-86" aria-hidden="true" tabindex="-1"></a>        previous_scores <span class="op">=</span> current_scores[:]</span>
<span id="cb179-87"><a href="#cb179-87" aria-hidden="true" tabindex="-1"></a>        current_scores[<span class="dv">0</span>] <span class="op">=</span> previous_scores[<span class="dv">0</span>] <span class="op">+</span> gap_penalty</span>
<span id="cb179-88"><a href="#cb179-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(sequence1) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb179-89"><a href="#cb179-89" aria-hidden="true" tabindex="-1"></a>            options <span class="op">=</span> [</span>
<span id="cb179-90"><a href="#cb179-90" aria-hidden="true" tabindex="-1"></a>                previous_scores[i] <span class="op">+</span> gap_penalty,</span>
<span id="cb179-91"><a href="#cb179-91" aria-hidden="true" tabindex="-1"></a>                current_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> gap_penalty,</span>
<span id="cb179-92"><a href="#cb179-92" aria-hidden="true" tabindex="-1"></a>                previous_scores[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> scoring_matrix.get(</span>
<span id="cb179-93"><a href="#cb179-93" aria-hidden="true" tabindex="-1"></a>                    (sequence1[i <span class="op">-</span> <span class="dv">1</span>], sequence2[j <span class="op">-</span> <span class="dv">1</span>]),</span>
<span id="cb179-94"><a href="#cb179-94" aria-hidden="true" tabindex="-1"></a>                    scoring_matrix.get((sequence2[j <span class="op">-</span> <span class="dv">1</span>], sequence1[i <span class="op">-</span> <span class="dv">1</span>]), <span class="dv">0</span>)</span>
<span id="cb179-95"><a href="#cb179-95" aria-hidden="true" tabindex="-1"></a>                ),</span>
<span id="cb179-96"><a href="#cb179-96" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb179-97"><a href="#cb179-97" aria-hidden="true" tabindex="-1"></a>            current_scores[i] <span class="op">=</span> <span class="bu">max</span>(options)</span>
<span id="cb179-98"><a href="#cb179-98" aria-hidden="true" tabindex="-1"></a>            backtrack[i] <span class="op">=</span> options.index(current_scores[i])</span>
<span id="cb179-99"><a href="#cb179-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-100"><a href="#cb179-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> current_scores, backtrack</span>
<span id="cb179-101"><a href="#cb179-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-102"><a href="#cb179-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_middle_edge(</span>
<span id="cb179-103"><a href="#cb179-103" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb179-104"><a href="#cb179-104" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb179-105"><a href="#cb179-105" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb179-106"><a href="#cb179-106" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb179-107"><a href="#cb179-107" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[Tuple[<span class="bu">int</span>, <span class="bu">int</span>], Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb179-108"><a href="#cb179-108" aria-hidden="true" tabindex="-1"></a>    midpoint <span class="op">=</span> floor(<span class="bu">len</span>(sequence2) <span class="op">/</span> <span class="dv">2</span>)</span>
<span id="cb179-109"><a href="#cb179-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-110"><a href="#cb179-110" aria-hidden="true" tabindex="-1"></a>    forward_scores, _ <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb179-111"><a href="#cb179-111" aria-hidden="true" tabindex="-1"></a>        sequence1, sequence2[:midpoint], scoring_matrix, gap_penalty</span>
<span id="cb179-112"><a href="#cb179-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb179-113"><a href="#cb179-113" aria-hidden="true" tabindex="-1"></a>    reverse_scores, reverse_backtrack <span class="op">=</span> calculate_alignment_scores(</span>
<span id="cb179-114"><a href="#cb179-114" aria-hidden="true" tabindex="-1"></a>        sequence1[::<span class="op">-</span><span class="dv">1</span>], sequence2[midpoint:][::<span class="op">-</span><span class="dv">1</span>], scoring_matrix, gap_penalty</span>
<span id="cb179-115"><a href="#cb179-115" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb179-116"><a href="#cb179-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-117"><a href="#cb179-117" aria-hidden="true" tabindex="-1"></a>    total_scores <span class="op">=</span> [f <span class="op">+</span> r <span class="cf">for</span> f, r <span class="kw">in</span> <span class="bu">zip</span>(forward_scores, reverse_scores[::<span class="op">-</span><span class="dv">1</span>])]</span>
<span id="cb179-118"><a href="#cb179-118" aria-hidden="true" tabindex="-1"></a>    best_score_index <span class="op">=</span> total_scores.index(<span class="bu">max</span>(total_scores))</span>
<span id="cb179-119"><a href="#cb179-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-120"><a href="#cb179-120" aria-hidden="true" tabindex="-1"></a>    start_node <span class="op">=</span> (best_score_index, midpoint)</span>
<span id="cb179-121"><a href="#cb179-121" aria-hidden="true" tabindex="-1"></a>    possible_moves <span class="op">=</span> [</span>
<span id="cb179-122"><a href="#cb179-122" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>], start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>),</span>
<span id="cb179-123"><a href="#cb179-123" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>]),</span>
<span id="cb179-124"><a href="#cb179-124" aria-hidden="true" tabindex="-1"></a>        (start_node[<span class="dv">0</span>] <span class="op">+</span> <span class="dv">1</span>, start_node[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb179-125"><a href="#cb179-125" aria-hidden="true" tabindex="-1"></a>    ]</span>
<span id="cb179-126"><a href="#cb179-126" aria-hidden="true" tabindex="-1"></a>    end_node <span class="op">=</span> possible_moves[reverse_backtrack[::<span class="op">-</span><span class="dv">1</span>][best_score_index]]</span>
<span id="cb179-127"><a href="#cb179-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-128"><a href="#cb179-128" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (start_node, end_node)</span>
<span id="cb179-129"><a href="#cb179-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-130"><a href="#cb179-130" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_alignment_score(</span>
<span id="cb179-131"><a href="#cb179-131" aria-hidden="true" tabindex="-1"></a>    aligned_seq1: <span class="bu">str</span>,</span>
<span id="cb179-132"><a href="#cb179-132" aria-hidden="true" tabindex="-1"></a>    aligned_seq2: <span class="bu">str</span>,</span>
<span id="cb179-133"><a href="#cb179-133" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb179-134"><a href="#cb179-134" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb179-135"><a href="#cb179-135" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb179-136"><a href="#cb179-136" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(</span>
<span id="cb179-137"><a href="#cb179-137" aria-hidden="true" tabindex="-1"></a>        gap_penalty <span class="cf">if</span> aligned_seq1[i] <span class="op">==</span> <span class="st">"-"</span> <span class="kw">or</span> aligned_seq2[i] <span class="op">==</span> <span class="st">"-"</span> <span class="cf">else</span></span>
<span id="cb179-138"><a href="#cb179-138" aria-hidden="true" tabindex="-1"></a>        scoring_matrix.get((aligned_seq1[i], aligned_seq2[i]),</span>
<span id="cb179-139"><a href="#cb179-139" aria-hidden="true" tabindex="-1"></a>                           scoring_matrix.get((aligned_seq2[i], aligned_seq1[i]), <span class="dv">0</span>))</span>
<span id="cb179-140"><a href="#cb179-140" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(aligned_seq1))</span>
<span id="cb179-141"><a href="#cb179-141" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb179-142"><a href="#cb179-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-143"><a href="#cb179-143" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_alignment_path(</span>
<span id="cb179-144"><a href="#cb179-144" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb179-145"><a href="#cb179-145" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span>,</span>
<span id="cb179-146"><a href="#cb179-146" aria-hidden="true" tabindex="-1"></a>    scoring_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">int</span>],</span>
<span id="cb179-147"><a href="#cb179-147" aria-hidden="true" tabindex="-1"></a>    gap_penalty: <span class="bu">int</span></span>
<span id="cb179-148"><a href="#cb179-148" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb179-149"><a href="#cb179-149" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> linear_space_alignment(top: <span class="bu">int</span>, bottom: <span class="bu">int</span>, left: <span class="bu">int</span>, right: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb179-150"><a href="#cb179-150" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> left <span class="op">==</span> right:</span>
<span id="cb179-151"><a href="#cb179-151" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"↓"</span> <span class="op">*</span> (bottom <span class="op">-</span> top)</span>
<span id="cb179-152"><a href="#cb179-152" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> top <span class="op">==</span> bottom:</span>
<span id="cb179-153"><a href="#cb179-153" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="st">"→"</span> <span class="op">*</span> (right <span class="op">-</span> left)</span>
<span id="cb179-154"><a href="#cb179-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb179-155"><a href="#cb179-155" aria-hidden="true" tabindex="-1"></a>            ((i, j), (i2, j2)) <span class="op">=</span> find_middle_edge(</span>
<span id="cb179-156"><a href="#cb179-156" aria-hidden="true" tabindex="-1"></a>                sequence1[top:bottom], sequence2[left:right], scoring_matrix, gap_penalty</span>
<span id="cb179-157"><a href="#cb179-157" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb179-158"><a href="#cb179-158" aria-hidden="true" tabindex="-1"></a>            edge <span class="op">=</span> <span class="st">"↓"</span> <span class="cf">if</span> j <span class="op">==</span> j2 <span class="cf">else</span> <span class="st">"→"</span> <span class="cf">if</span> i <span class="op">==</span> i2 <span class="cf">else</span> <span class="st">"↘"</span></span>
<span id="cb179-159"><a href="#cb179-159" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> (</span>
<span id="cb179-160"><a href="#cb179-160" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(top, i <span class="op">+</span> top, left, j <span class="op">+</span> left) <span class="op">+</span></span>
<span id="cb179-161"><a href="#cb179-161" aria-hidden="true" tabindex="-1"></a>                edge <span class="op">+</span></span>
<span id="cb179-162"><a href="#cb179-162" aria-hidden="true" tabindex="-1"></a>                linear_space_alignment(i2 <span class="op">+</span> top, bottom, j2 <span class="op">+</span> left, right)</span>
<span id="cb179-163"><a href="#cb179-163" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb179-164"><a href="#cb179-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-165"><a href="#cb179-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_space_alignment(<span class="dv">0</span>, <span class="bu">len</span>(sequence1), <span class="dv">0</span>, <span class="bu">len</span>(sequence2))</span>
<span id="cb179-166"><a href="#cb179-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-167"><a href="#cb179-167" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_alignment(</span>
<span id="cb179-168"><a href="#cb179-168" aria-hidden="true" tabindex="-1"></a>    alignment_path: <span class="bu">str</span>,</span>
<span id="cb179-169"><a href="#cb179-169" aria-hidden="true" tabindex="-1"></a>    sequence1: <span class="bu">str</span>,</span>
<span id="cb179-170"><a href="#cb179-170" aria-hidden="true" tabindex="-1"></a>    sequence2: <span class="bu">str</span></span>
<span id="cb179-171"><a href="#cb179-171" aria-hidden="true" tabindex="-1"></a>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb179-172"><a href="#cb179-172" aria-hidden="true" tabindex="-1"></a>    aligned_seq1, aligned_seq2 <span class="op">=</span> <span class="st">""</span>, <span class="st">""</span></span>
<span id="cb179-173"><a href="#cb179-173" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> <span class="dv">0</span>, <span class="dv">0</span></span>
<span id="cb179-174"><a href="#cb179-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> direction <span class="kw">in</span> alignment_path:</span>
<span id="cb179-175"><a href="#cb179-175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> direction <span class="op">==</span> <span class="st">"↘"</span>:</span>
<span id="cb179-176"><a href="#cb179-176" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb179-177"><a href="#cb179-177" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb179-178"><a href="#cb179-178" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb179-179"><a href="#cb179-179" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb179-180"><a href="#cb179-180" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> direction <span class="op">==</span> <span class="st">"↓"</span>:</span>
<span id="cb179-181"><a href="#cb179-181" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> sequence1[i]</span>
<span id="cb179-182"><a href="#cb179-182" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb179-183"><a href="#cb179-183" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb179-184"><a href="#cb179-184" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb179-185"><a href="#cb179-185" aria-hidden="true" tabindex="-1"></a>            aligned_seq1 <span class="op">+=</span> <span class="st">"-"</span></span>
<span id="cb179-186"><a href="#cb179-186" aria-hidden="true" tabindex="-1"></a>            aligned_seq2 <span class="op">+=</span> sequence2[j]</span>
<span id="cb179-187"><a href="#cb179-187" aria-hidden="true" tabindex="-1"></a>            j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb179-188"><a href="#cb179-188" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> aligned_seq1, aligned_seq2</span>
<span id="cb179-189"><a href="#cb179-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-190"><a href="#cb179-190" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb179-191"><a href="#cb179-191" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb179-192"><a href="#cb179-192" aria-hidden="true" tabindex="-1"></a><span class="st">PLEASANTLY</span></span>
<span id="cb179-193"><a href="#cb179-193" aria-hidden="true" tabindex="-1"></a><span class="st">MEANLY</span></span>
<span id="cb179-194"><a href="#cb179-194" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb179-195"><a href="#cb179-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb179-196"><a href="#cb179-196" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb179-197"><a href="#cb179-197" aria-hidden="true" tabindex="-1"></a>scoring_matrix <span class="op">=</span> BLOSUM62</span>
<span id="cb179-198"><a href="#cb179-198" aria-hidden="true" tabindex="-1"></a>alignment_path <span class="op">=</span> find_alignment_path(sequence1, sequence2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>)</span>
<span id="cb179-199"><a href="#cb179-199" aria-hidden="true" tabindex="-1"></a>aligned_seq1, aligned_seq2 <span class="op">=</span> construct_alignment(alignment_path, sequence1, sequence2)</span>
<span id="cb179-200"><a href="#cb179-200" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_alignment_score(aligned_seq1, aligned_seq2, scoring_matrix, <span class="op">-</span><span class="dv">5</span>))</span>
<span id="cb179-201"><a href="#cb179-201" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(aligned_seq1, aligned_seq2, sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-multiple-sequence-alignment" class="level1" data-number="60">
<h1 data-number="60"><span class="header-section-number">60</span> Find a Highest-Scoring Multiple Sequence Alignment</h1>
<p>Multiple Longest Common Subsequence Problem. Find a longest common subsequence of multiple strings.</p>
<p>Given:&nbsp;Three&nbsp;<a href="https://rosalind.info/glossary/dna-string/">DNA strings</a>.</p>
<p>Return:&nbsp;The maximum score of a multiple alignment of these three strings, followed by a multiple alignment of the three strings achieving this maximum. Use a scoring function in which the score of an alignment column is 1 if all three symbols are identical and 0 otherwise. (If more than one multiple alignment achieve the maximum, you may return any one.)</p>
<section id="sample-dataset-60" class="level2" data-number="60.1">
<h2 data-number="60.1" class="anchored" data-anchor-id="sample-dataset-60"><span class="header-section-number">60.1</span> Sample Dataset</h2>
<pre><code>ATATCCG
TCCGA
ATGTACTG</code></pre>
</section>
<section id="sample-output-60" class="level2" data-number="60.2">
<h2 data-number="60.2" class="anchored" data-anchor-id="sample-output-60"><span class="header-section-number">60.2</span> Sample Output</h2>
<pre><code>3
ATATCC-G-
---TCC-GA
ATGTACTG-</code></pre>
</section>
<section id="solution-60" class="level2" data-number="60.3">
<h2 data-number="60.3" class="anchored" data-anchor-id="solution-60"><span class="header-section-number">60.3</span> Solution</h2>
<div class="sourceCode" id="cb182"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> product</span>
<span id="cb182-2"><a href="#cb182-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict</span>
<span id="cb182-3"><a href="#cb182-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-4"><a href="#cb182-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Check if the coordinates are non-negative in the alignment matrix</span></span>
<span id="cb182-5"><a href="#cb182-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_valid_coordinate(pointer: Tuple[<span class="bu">int</span>, ...], position: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb182-6"><a href="#cb182-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">all</span>([i <span class="op">&gt;=</span> <span class="dv">0</span> <span class="cf">for</span> i <span class="kw">in</span> get_previous_position(position, pointer)])</span>
<span id="cb182-7"><a href="#cb182-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-8"><a href="#cb182-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Get the previous position given a current position and a pointer</span></span>
<span id="cb182-9"><a href="#cb182-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_position(position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, ...]:</span>
<span id="cb182-10"><a href="#cb182-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">tuple</span>([p <span class="op">+</span> d <span class="cf">for</span> p, d <span class="kw">in</span> <span class="bu">zip</span>(position, pointer)])</span>
<span id="cb182-11"><a href="#cb182-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-12"><a href="#cb182-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the score for a given position and pointer</span></span>
<span id="cb182-13"><a href="#cb182-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_score(sequences: List[<span class="bu">str</span>], position: Tuple[<span class="bu">int</span>, ...], pointer: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb182-14"><a href="#cb182-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> pointer <span class="op">==</span> (<span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb182-15"><a href="#cb182-15" aria-hidden="true" tabindex="-1"></a>        bases <span class="op">=</span> [sequences[i][j] <span class="cf">for</span> i, j <span class="kw">in</span> <span class="bu">enumerate</span>(get_previous_position(position, pointer))]</span>
<span id="cb182-16"><a href="#cb182-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">int</span>(<span class="bu">all</span>(base <span class="op">==</span> bases[<span class="dv">0</span>] <span class="cf">for</span> base <span class="kw">in</span> bases))</span>
<span id="cb182-17"><a href="#cb182-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb182-18"><a href="#cb182-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb182-19"><a href="#cb182-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-20"><a href="#cb182-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate possible previous cell pointers</span></span>
<span id="cb182-21"><a href="#cb182-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_moves(dimension: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, ...]]:</span>
<span id="cb182-22"><a href="#cb182-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(product([<span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>], repeat<span class="op">=</span>dimension))[<span class="dv">1</span>:]</span>
<span id="cb182-23"><a href="#cb182-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-24"><a href="#cb182-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiple_sequence_alignment(sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, <span class="bu">str</span>, <span class="bu">str</span>]:</span>
<span id="cb182-25"><a href="#cb182-25" aria-hidden="true" tabindex="-1"></a>    scores: Dict[Tuple[<span class="bu">int</span>, ...], <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb182-26"><a href="#cb182-26" aria-hidden="true" tabindex="-1"></a>    pointers: Dict[Tuple[<span class="bu">int</span>, ...], Tuple[<span class="bu">int</span>, ...]] <span class="op">=</span> {}</span>
<span id="cb182-27"><a href="#cb182-27" aria-hidden="true" tabindex="-1"></a>    scores[(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb182-28"><a href="#cb182-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-29"><a href="#cb182-29" aria-hidden="true" tabindex="-1"></a>    ranges <span class="op">=</span> [<span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(seq) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> seq <span class="kw">in</span> sequences]</span>
<span id="cb182-30"><a href="#cb182-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-31"><a href="#cb182-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> position <span class="kw">in</span> product(<span class="op">*</span>ranges):</span>
<span id="cb182-32"><a href="#cb182-32" aria-hidden="true" tabindex="-1"></a>        valid_pointers <span class="op">=</span> <span class="bu">list</span>(<span class="bu">filter</span>(<span class="kw">lambda</span> x: is_valid_coordinate(x, position), generate_moves(<span class="dv">3</span>)))</span>
<span id="cb182-33"><a href="#cb182-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> valid_pointers:</span>
<span id="cb182-34"><a href="#cb182-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb182-35"><a href="#cb182-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-36"><a href="#cb182-36" aria-hidden="true" tabindex="-1"></a>        possible_scores <span class="op">=</span> [scores[get_previous_position(position, ptr)] <span class="op">+</span> calculate_score(sequences, position, ptr) <span class="cf">for</span> ptr <span class="kw">in</span> valid_pointers]</span>
<span id="cb182-37"><a href="#cb182-37" aria-hidden="true" tabindex="-1"></a>        scores[position] <span class="op">=</span> <span class="bu">max</span>(possible_scores)</span>
<span id="cb182-38"><a href="#cb182-38" aria-hidden="true" tabindex="-1"></a>        pointers[position] <span class="op">=</span> valid_pointers[possible_scores.index(<span class="bu">max</span>(possible_scores))]</span>
<span id="cb182-39"><a href="#cb182-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-40"><a href="#cb182-40" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to recover alignment</span></span>
<span id="cb182-41"><a href="#cb182-41" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> scores[position]</span>
<span id="cb182-42"><a href="#cb182-42" aria-hidden="true" tabindex="-1"></a>    aligned_sequences <span class="op">=</span> [<span class="st">""</span>, <span class="st">""</span>, <span class="st">""</span>]</span>
<span id="cb182-43"><a href="#cb182-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-44"><a href="#cb182-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">any</span>([x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> position]):</span>
<span id="cb182-45"><a href="#cb182-45" aria-hidden="true" tabindex="-1"></a>        pointer <span class="op">=</span> pointers[position]</span>
<span id="cb182-46"><a href="#cb182-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, seq <span class="kw">in</span> <span class="bu">enumerate</span>(sequences):</span>
<span id="cb182-47"><a href="#cb182-47" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[i] <span class="op">+=</span> seq[position[i] <span class="op">-</span> <span class="dv">1</span>] <span class="cf">if</span> pointer[i] <span class="op">==</span> <span class="op">-</span><span class="dv">1</span> <span class="cf">else</span> <span class="st">"-"</span></span>
<span id="cb182-48"><a href="#cb182-48" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> get_previous_position(position, pointer)</span>
<span id="cb182-49"><a href="#cb182-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-50"><a href="#cb182-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (total_score,</span>
<span id="cb182-51"><a href="#cb182-51" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">0</span>][::<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb182-52"><a href="#cb182-52" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">1</span>][::<span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb182-53"><a href="#cb182-53" aria-hidden="true" tabindex="-1"></a>            aligned_sequences[<span class="dv">2</span>][::<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb182-54"><a href="#cb182-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-55"><a href="#cb182-55" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb182-56"><a href="#cb182-56" aria-hidden="true" tabindex="-1"></a><span class="st">ATATCCG</span></span>
<span id="cb182-57"><a href="#cb182-57" aria-hidden="true" tabindex="-1"></a><span class="st">TCCGA</span></span>
<span id="cb182-58"><a href="#cb182-58" aria-hidden="true" tabindex="-1"></a><span class="st">ATGTACTG</span></span>
<span id="cb182-59"><a href="#cb182-59" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb182-60"><a href="#cb182-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb182-61"><a href="#cb182-61" aria-hidden="true" tabindex="-1"></a>sequences <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb182-62"><a href="#cb182-62" aria-hidden="true" tabindex="-1"></a>alignment_score, seq1, seq2, seq3 <span class="op">=</span> multiple_sequence_alignment(sequences)</span>
<span id="cb182-63"><a href="#cb182-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(alignment_score)</span>
<span id="cb182-64"><a href="#cb182-64" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq1)</span>
<span id="cb182-65"><a href="#cb182-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq2)</span>
<span id="cb182-66"><a href="#cb182-66" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(seq3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-topological-ordering-of-a-dag" class="level1" data-number="61">
<h1 data-number="61"><span class="header-section-number">61</span> Find a Topological Ordering of a DAG</h1>
<p>Topological Ordering Problem. Find a topological ordering of a directed acyclic graph.</p>
<p>Given:&nbsp;The&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>&nbsp;of a graph (with nodes represented by integers).</p>
<p>Return:&nbsp;A topological ordering of this graph.</p>
<section id="sample-dataset-61" class="level2" data-number="61.1">
<h2 data-number="61.1" class="anchored" data-anchor-id="sample-dataset-61"><span class="header-section-number">61.1</span> Sample Dataset</h2>
<pre><code>1 -&gt; 2
2 -&gt; 3
4 -&gt; 2
5 -&gt; 3</code></pre>
</section>
<section id="sample-output-61" class="level2" data-number="61.2">
<h2 data-number="61.2" class="anchored" data-anchor-id="sample-output-61"><span class="header-section-number">61.2</span> Sample Output</h2>
<pre><code>1, 4, 5, 2, 3</code></pre>
</section>
<section id="solution-61" class="level2" data-number="61.3">
<h2 data-number="61.3" class="anchored" data-anchor-id="solution-61"><span class="header-section-number">61.3</span> Solution</h2>
<div class="sourceCode" id="cb185"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Set</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>NodeLabel <span class="op">=</span> <span class="bu">str</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[NodeLabel, List[NodeLabel]]</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_graph(edge_list: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Graph:</span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>    graph: Graph <span class="op">=</span> {}</span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edge_list:</span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>        source, targets <span class="op">=</span> edge.split(<span class="st">" -&gt; "</span>)</span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>        target_list <span class="op">=</span> targets.split(<span class="st">","</span>)</span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> source <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>            graph[source] <span class="op">=</span> []</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a>        graph[source].extend(target_list)</span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> target_list:</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> target <span class="kw">not</span> <span class="kw">in</span> graph:</span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>                graph[target] <span class="op">=</span> []</span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> depth_first_search(graph: Graph, node: NodeLabel, visited: Set[NodeLabel], stack: List[NodeLabel]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a>    visited.add(node)</span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> neighbor <span class="kw">in</span> graph.get(node, []):</span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, neighbor, visited, stack)</span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a>    stack.insert(<span class="dv">0</span>, node)</span>
<span id="cb185-25"><a href="#cb185-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-26"><a href="#cb185-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> topological_sort(graph: Graph) <span class="op">-&gt;</span> List[NodeLabel]:</span>
<span id="cb185-27"><a href="#cb185-27" aria-hidden="true" tabindex="-1"></a>    visited: Set[NodeLabel] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb185-28"><a href="#cb185-28" aria-hidden="true" tabindex="-1"></a>    stack: List[NodeLabel] <span class="op">=</span> []</span>
<span id="cb185-29"><a href="#cb185-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb185-30"><a href="#cb185-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb185-31"><a href="#cb185-31" aria-hidden="true" tabindex="-1"></a>            depth_first_search(graph, node, visited, stack)</span>
<span id="cb185-32"><a href="#cb185-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> stack</span>
<span id="cb185-33"><a href="#cb185-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-34"><a href="#cb185-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb185-35"><a href="#cb185-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> input_text.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb185-36"><a href="#cb185-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-37"><a href="#cb185-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb185-38"><a href="#cb185-38" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb185-39"><a href="#cb185-39" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; 2</span></span>
<span id="cb185-40"><a href="#cb185-40" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 3</span></span>
<span id="cb185-41"><a href="#cb185-41" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; 2</span></span>
<span id="cb185-42"><a href="#cb185-42" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 3</span></span>
<span id="cb185-43"><a href="#cb185-43" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb185-44"><a href="#cb185-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-45"><a href="#cb185-45" aria-hidden="true" tabindex="-1"></a>edge_list <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb185-46"><a href="#cb185-46" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> create_graph(edge_list)</span>
<span id="cb185-47"><a href="#cb185-47" aria-hidden="true" tabindex="-1"></a>sorted_nodes <span class="op">=</span> topological_sort(graph)</span>
<span id="cb185-48"><a href="#cb185-48" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">", "</span>.join(sorted_nodes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-greedysorting-to-sort-a-permutation-by-reversals" class="level1" data-number="62">
<h1 data-number="62"><span class="header-section-number">62</span> Implement GreedySorting to Sort a Permutation by Reversals</h1>
<p>Implement&nbsp;<em>GreedySorting</em>.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/signed-permutation/">signed permutation</a>&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The sequence of permutations corresponding to applying&nbsp;<em>GreedySorting</em>&nbsp;to&nbsp;<em>P</em>, ending with the identity permutation.</p>
<section id="sample-dataset-62" class="level2" data-number="62.1">
<h2 data-number="62.1" class="anchored" data-anchor-id="sample-dataset-62"><span class="header-section-number">62.1</span> Sample Dataset</h2>
<pre><code>(-3 +4 +1 +5 -2)</code></pre>
</section>
<section id="sample-output-62" class="level2" data-number="62.2">
<h2 data-number="62.2" class="anchored" data-anchor-id="sample-output-62"><span class="header-section-number">62.2</span> Sample Output</h2>
<pre><code>(-1 -4 +3 +5 -2)
(+1 -4 +3 +5 -2)
(+1 +2 -5 -3 +4)
(+1 +2 +3 +5 +4)
(+1 +2 +3 -4 -5)
(+1 +2 +3 +4 -5)
(+1 +2 +3 +4 +5)</code></pre>
</section>
<section id="solution-62" class="level2" data-number="62.3">
<h2 data-number="62.3" class="anchored" data-anchor-id="solution-62"><span class="header-section-number">62.3</span> Solution</h2>
<div class="sourceCode" id="cb188"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb188-1"><a href="#cb188-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb188-2"><a href="#cb188-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-3"><a href="#cb188-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> perform_k_sorting_reversal(permutation: List[<span class="bu">int</span>], k: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb188-4"><a href="#cb188-4" aria-hidden="true" tabindex="-1"></a>    j <span class="op">=</span> k</span>
<span id="cb188-5"><a href="#cb188-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">abs</span>(permutation[j]) <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb188-6"><a href="#cb188-6" aria-hidden="true" tabindex="-1"></a>        j <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb188-7"><a href="#cb188-7" aria-hidden="true" tabindex="-1"></a>    permutation[k:j<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> [<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">reversed</span>(permutation[k:j<span class="op">+</span><span class="dv">1</span>])]</span>
<span id="cb188-8"><a href="#cb188-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> permutation</span>
<span id="cb188-9"><a href="#cb188-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-10"><a href="#cb188-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> greedy_sorting(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb188-11"><a href="#cb188-11" aria-hidden="true" tabindex="-1"></a>    reversal_sequence: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb188-12"><a href="#cb188-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(permutation)):</span>
<span id="cb188-13"><a href="#cb188-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> permutation[k] <span class="op">!=</span> k <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb188-14"><a href="#cb188-14" aria-hidden="true" tabindex="-1"></a>            permutation <span class="op">=</span> perform_k_sorting_reversal(permutation, k)</span>
<span id="cb188-15"><a href="#cb188-15" aria-hidden="true" tabindex="-1"></a>            reversal_sequence.append(<span class="bu">list</span>(permutation))</span>
<span id="cb188-16"><a href="#cb188-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversal_sequence</span>
<span id="cb188-17"><a href="#cb188-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-18"><a href="#cb188-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(input_text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb188-19"><a href="#cb188-19" aria-hidden="true" tabindex="-1"></a>    cleaned_input <span class="op">=</span> input_text.strip().replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb188-20"><a href="#cb188-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> cleaned_input.split()]</span>
<span id="cb188-21"><a href="#cb188-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-22"><a href="#cb188-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_permutation(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb188-23"><a href="#cb188-23" aria-hidden="true" tabindex="-1"></a>    formatted_elements <span class="op">=</span> [(<span class="st">"+"</span> <span class="cf">if</span> x <span class="op">&gt;</span> <span class="dv">0</span> <span class="cf">else</span> <span class="st">""</span>) <span class="op">+</span> <span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation]</span>
<span id="cb188-24"><a href="#cb188-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join(formatted_elements) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb188-25"><a href="#cb188-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-26"><a href="#cb188-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb188-27"><a href="#cb188-27" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb188-28"><a href="#cb188-28" aria-hidden="true" tabindex="-1"></a><span class="st">(-3 +4 +1 +5 -2)</span></span>
<span id="cb188-29"><a href="#cb188-29" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb188-30"><a href="#cb188-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-31"><a href="#cb188-31" aria-hidden="true" tabindex="-1"></a>initial_permutation <span class="op">=</span> parse_permutation(sample_input)</span>
<span id="cb188-32"><a href="#cb188-32" aria-hidden="true" tabindex="-1"></a>sorting_sequence <span class="op">=</span> greedy_sorting(initial_permutation)</span>
<span id="cb188-33"><a href="#cb188-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb188-34"><a href="#cb188-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> permutation <span class="kw">in</span> sorting_sequence:</span>
<span id="cb188-35"><a href="#cb188-35" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(format_permutation(permutation))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-number-of-breakpoints-in-a-permutation" class="level1" data-number="63">
<h1 data-number="63"><span class="header-section-number">63</span> Compute the Number of Breakpoints in a Permutation</h1>
<p>Number of Breakpoints Problem. Find the number of breakpoints in a permutation.</p>
<p>Given:&nbsp;A&nbsp;<a href="https://rosalind.info/glossary/signed-permutation/">signed permutation</a>&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The number of breakpoints in&nbsp;<em>P</em>.</p>
<section id="sample-dataset-63" class="level2" data-number="63.1">
<h2 data-number="63.1" class="anchored" data-anchor-id="sample-dataset-63"><span class="header-section-number">63.1</span> Sample Dataset</h2>
<pre><code>(+3 +4 +5 -12 -8 -7 -6 +1 +2 +10 +9 -11 +13 +14)</code></pre>
</section>
<section id="sample-output-63" class="level2" data-number="63.2">
<h2 data-number="63.2" class="anchored" data-anchor-id="sample-output-63"><span class="header-section-number">63.2</span> Sample Output</h2>
<pre><code>8</code></pre>
</section>
<section id="solution-63" class="level2" data-number="63.3">
<h2 data-number="63.3" class="anchored" data-anchor-id="solution-63"><span class="header-section-number">63.3</span> Solution</h2>
<div class="sourceCode" id="cb191"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_breakpoints(permutation: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a>    augmented_permutation <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> permutation <span class="op">+</span> [<span class="bu">max</span>(permutation) <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a>    breakpoint_count <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(augmented_permutation) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> augmented_permutation[i] <span class="op">!=</span> augmented_permutation[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>:</span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>            breakpoint_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> breakpoint_count</span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="st">(+3 +4 +5 -12 -8 -7 -6 +1 +2 +10 +9 -11 +13 +14)</span></span>
<span id="cb191-15"><a href="#cb191-15" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb191-16"><a href="#cb191-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-17"><a href="#cb191-17" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> sample_input.strip()</span>
<span id="cb191-18"><a href="#cb191-18" aria-hidden="true" tabindex="-1"></a>permutation_string <span class="op">=</span> permutation_string.replace(<span class="st">"("</span>, <span class="st">""</span>).replace(<span class="st">")"</span>, <span class="st">""</span>)</span>
<span id="cb191-19"><a href="#cb191-19" aria-hidden="true" tabindex="-1"></a>permutation <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> permutation_string.split()]</span>
<span id="cb191-20"><a href="#cb191-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-21"><a href="#cb191-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(count_breakpoints(permutation))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-2-break-distance-between-a-pair-of-genomes" class="level1" data-number="64">
<h1 data-number="64"><span class="header-section-number">64</span> Compute the 2-Break Distance Between a Pair of Genomes</h1>
<p>2-Break Distance Problem. Find the 2-break distance between two genomes.</p>
<p>Given:&nbsp;Two genomes with circular chromosomes on the same set of synteny blocks.</p>
<p>Return:&nbsp;The 2-break distance between these two genomes.</p>
<section id="sample-dataset-64" class="level2" data-number="64.1">
<h2 data-number="64.1" class="anchored" data-anchor-id="sample-dataset-64"><span class="header-section-number">64.1</span> Sample Dataset</h2>
<pre><code>(+1 +2 +3 +4 +5 +6)
(+1 -3 -6 -5)(+2 -4)</code></pre>
</section>
<section id="sample-output-64" class="level2" data-number="64.2">
<h2 data-number="64.2" class="anchored" data-anchor-id="sample-output-64"><span class="header-section-number">64.2</span> Sample Output</h2>
<pre><code>3</code></pre>
</section>
<section id="solution-64" class="level2" data-number="64.3">
<h2 data-number="64.3" class="anchored" data-anchor-id="solution-64"><span class="header-section-number">64.3</span> Solution</h2>
<div class="sourceCode" id="cb194"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb194-2"><a href="#cb194-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb194-3"><a href="#cb194-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, DefaultDict</span>
<span id="cb194-4"><a href="#cb194-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-5"><a href="#cb194-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb194-6"><a href="#cb194-6" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb194-7"><a href="#cb194-7" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb194-8"><a href="#cb194-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb194-9"><a href="#cb194-9" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb194-10"><a href="#cb194-10" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb194-11"><a href="#cb194-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb194-12"><a href="#cb194-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb194-13"><a href="#cb194-13" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb194-14"><a href="#cb194-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb194-15"><a href="#cb194-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-16"><a href="#cb194-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb194-17"><a href="#cb194-17" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb194-18"><a href="#cb194-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"</span><span class="ch">\(</span><span class="kw">(</span><span class="dv">.</span><span class="op">+?</span><span class="kw">)</span><span class="ch">\)</span><span class="vs">"</span>, genome_string):</span>
<span id="cb194-19"><a href="#cb194-19" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb194-20"><a href="#cb194-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb194-21"><a href="#cb194-21" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb194-22"><a href="#cb194-22" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb194-23"><a href="#cb194-23" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb194-24"><a href="#cb194-24" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb194-25"><a href="#cb194-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb194-26"><a href="#cb194-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-27"><a href="#cb194-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb194-28"><a href="#cb194-28" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb194-29"><a href="#cb194-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb194-30"><a href="#cb194-30" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb194-31"><a href="#cb194-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb194-32"><a href="#cb194-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-33"><a href="#cb194-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_two_break_distance(genomes: List[DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb194-34"><a href="#cb194-34" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(<span class="op">*</span>genomes)</span>
<span id="cb194-35"><a href="#cb194-35" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(combined_graph.keys())</span>
<span id="cb194-36"><a href="#cb194-36" aria-hidden="true" tabindex="-1"></a>    num_blocks <span class="op">=</span> <span class="bu">len</span>(nodes) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb194-37"><a href="#cb194-37" aria-hidden="true" tabindex="-1"></a>    num_components <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb194-38"><a href="#cb194-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb194-39"><a href="#cb194-39" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), combined_graph)</span>
<span id="cb194-40"><a href="#cb194-40" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">-=</span> component</span>
<span id="cb194-41"><a href="#cb194-41" aria-hidden="true" tabindex="-1"></a>        num_components <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb194-42"><a href="#cb194-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> num_blocks <span class="op">-</span> num_components</span>
<span id="cb194-43"><a href="#cb194-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-44"><a href="#cb194-44" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb194-45"><a href="#cb194-45" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 +3 +4 +5 +6)</span></span>
<span id="cb194-46"><a href="#cb194-46" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -3 -6 -5)(+2 -4)</span></span>
<span id="cb194-47"><a href="#cb194-47" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb194-48"><a href="#cb194-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb194-49"><a href="#cb194-49" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb194-50"><a href="#cb194-50" aria-hidden="true" tabindex="-1"></a>genomes <span class="op">=</span> [parse_genome_graph(genome_string) <span class="cf">for</span> genome_string <span class="kw">in</span> input_lines]</span>
<span id="cb194-51"><a href="#cb194-51" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_two_break_distance(genomes))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-shortest-transformation-of-one-genome-into-another-by-2-breaks" class="level1" data-number="65">
<h1 data-number="65"><span class="header-section-number">65</span> Find a Shortest Transformation of One Genome into Another by 2-Breaks</h1>
<p>2-Break Sorting Problem. Find a shortest transformation of one genome into another by 2-breaks.</p>
<p>Given:&nbsp;Two genomes with circular chromosomes on the same set of synteny blocks.</p>
<p>Return:&nbsp;The sequence of genomes resulting from applying a shortest sequence of 2-breaks transforming one genome into the other.</p>
<section id="sample-dataset-65" class="level2" data-number="65.1">
<h2 data-number="65.1" class="anchored" data-anchor-id="sample-dataset-65"><span class="header-section-number">65.1</span> Sample Dataset</h2>
<pre><code>(+1 -2 -3 +4)
(+1 +2 -4 -3)</code></pre>
</section>
<section id="sample-output-65" class="level2" data-number="65.2">
<h2 data-number="65.2" class="anchored" data-anchor-id="sample-output-65"><span class="header-section-number">65.2</span> Sample Output</h2>
<pre><code>(+1 -2 -3 +4)
(+1 +2 -3 +4)
(+1 +2 -4 +3)
(+1 +2 -4 -3)</code></pre>
</section>
<section id="solution-65" class="level2" data-number="65.3">
<h2 data-number="65.3" class="anchored" data-anchor-id="solution-65"><span class="header-section-number">65.3</span> Solution</h2>
<div class="sourceCode" id="cb197"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb197-2"><a href="#cb197-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb197-3"><a href="#cb197-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Generator, DefaultDict</span>
<span id="cb197-4"><a href="#cb197-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-5"><a href="#cb197-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb197-6"><a href="#cb197-6" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb197-7"><a href="#cb197-7" aria-hidden="true" tabindex="-1"></a>    visited: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb197-8"><a href="#cb197-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb197-9"><a href="#cb197-9" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb197-10"><a href="#cb197-10" aria-hidden="true" tabindex="-1"></a>        visited.add(current_node)</span>
<span id="cb197-11"><a href="#cb197-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb197-12"><a href="#cb197-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb197-13"><a href="#cb197-13" aria-hidden="true" tabindex="-1"></a>                queue.append(neighbor)</span>
<span id="cb197-14"><a href="#cb197-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb197-15"><a href="#cb197-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-16"><a href="#cb197-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_genome_graph(genome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb197-17"><a href="#cb197-17" aria-hidden="true" tabindex="-1"></a>    genome_graph: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb197-18"><a href="#cb197-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> re.findall(<span class="vs">r"</span><span class="ch">\(</span><span class="kw">(</span><span class="dv">.</span><span class="op">+?</span><span class="kw">)</span><span class="ch">\)</span><span class="vs">"</span>, genome_string):</span>
<span id="cb197-19"><a href="#cb197-19" aria-hidden="true" tabindex="-1"></a>        chromosome <span class="op">=</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, component.split()))</span>
<span id="cb197-20"><a href="#cb197-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome) <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb197-21"><a href="#cb197-21" aria-hidden="true" tabindex="-1"></a>            genome_graph[chromosome[i]].append(<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb197-22"><a href="#cb197-22" aria-hidden="true" tabindex="-1"></a>            genome_graph[<span class="op">-</span>chromosome[i <span class="op">+</span> <span class="dv">1</span>]].append(chromosome[i])</span>
<span id="cb197-23"><a href="#cb197-23" aria-hidden="true" tabindex="-1"></a>        genome_graph[chromosome[<span class="op">-</span><span class="dv">1</span>]].append(<span class="op">-</span>chromosome[<span class="dv">0</span>])</span>
<span id="cb197-24"><a href="#cb197-24" aria-hidden="true" tabindex="-1"></a>        genome_graph[<span class="op">-</span>chromosome[<span class="dv">0</span>]].append(chromosome[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb197-25"><a href="#cb197-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome_graph</span>
<span id="cb197-26"><a href="#cb197-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-27"><a href="#cb197-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> breakpoint_graph(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]:</span>
<span id="cb197-28"><a href="#cb197-28" aria-hidden="true" tabindex="-1"></a>    combined_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb197-29"><a href="#cb197-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> genome1.keys():</span>
<span id="cb197-30"><a href="#cb197-30" aria-hidden="true" tabindex="-1"></a>        combined_graph[node] <span class="op">=</span> genome1[node] <span class="op">+</span> genome2[node]</span>
<span id="cb197-31"><a href="#cb197-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> combined_graph</span>
<span id="cb197-32"><a href="#cb197-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-33"><a href="#cb197-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_perm(perm: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb197-34"><a href="#cb197-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>x<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> x <span class="kw">in</span> perm]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb197-35"><a href="#cb197-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-36"><a href="#cb197-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_components(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[Set[<span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb197-37"><a href="#cb197-37" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb197-38"><a href="#cb197-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb197-39"><a href="#cb197-39" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), graph)</span>
<span id="cb197-40"><a href="#cb197-40" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> component</span>
<span id="cb197-41"><a href="#cb197-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> component</span>
<span id="cb197-42"><a href="#cb197-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-43"><a href="#cb197-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> non_trivial_cycle_nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>] <span class="op">|</span> <span class="va">None</span>:</span>
<span id="cb197-44"><a href="#cb197-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> component <span class="kw">in</span> find_components(graph):</span>
<span id="cb197-45"><a href="#cb197-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(component) <span class="op">&gt;</span> <span class="dv">2</span>:</span>
<span id="cb197-46"><a href="#cb197-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">list</span>(component)</span>
<span id="cb197-47"><a href="#cb197-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb197-48"><a href="#cb197-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-49"><a href="#cb197-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_genome_component(start_node: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb197-50"><a href="#cb197-50" aria-hidden="true" tabindex="-1"></a>    queue: List[<span class="bu">int</span>] <span class="op">=</span> [start_node]</span>
<span id="cb197-51"><a href="#cb197-51" aria-hidden="true" tabindex="-1"></a>    visited: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb197-52"><a href="#cb197-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb197-53"><a href="#cb197-53" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb197-54"><a href="#cb197-54" aria-hidden="true" tabindex="-1"></a>        visited.append(current_node)</span>
<span id="cb197-55"><a href="#cb197-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb197-56"><a href="#cb197-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="op">-</span>neighbor <span class="kw">not</span> <span class="kw">in</span> visited:</span>
<span id="cb197-57"><a href="#cb197-57" aria-hidden="true" tabindex="-1"></a>                queue.append(<span class="op">-</span>neighbor)</span>
<span id="cb197-58"><a href="#cb197-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> visited</span>
<span id="cb197-59"><a href="#cb197-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-60"><a href="#cb197-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_genome_graph(genome_graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb197-61"><a href="#cb197-61" aria-hidden="true" tabindex="-1"></a>    nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(genome_graph.keys())</span>
<span id="cb197-62"><a href="#cb197-62" aria-hidden="true" tabindex="-1"></a>    components: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb197-63"><a href="#cb197-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb197-64"><a href="#cb197-64" aria-hidden="true" tabindex="-1"></a>        component <span class="op">=</span> find_genome_component(<span class="bu">next</span>(<span class="bu">iter</span>(nodes)), genome_graph)</span>
<span id="cb197-65"><a href="#cb197-65" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(component)</span>
<span id="cb197-66"><a href="#cb197-66" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> nodes <span class="op">-</span> <span class="bu">set</span>(<span class="op">-</span>x <span class="cf">for</span> x <span class="kw">in</span> component)</span>
<span id="cb197-67"><a href="#cb197-67" aria-hidden="true" tabindex="-1"></a>        components.append(component)</span>
<span id="cb197-68"><a href="#cb197-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join([format_perm(c) <span class="cf">for</span> c <span class="kw">in</span> components])</span>
<span id="cb197-69"><a href="#cb197-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-70"><a href="#cb197-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb197-71"><a href="#cb197-71" aria-hidden="true" tabindex="-1"></a>    graph[node1].append(node2)</span>
<span id="cb197-72"><a href="#cb197-72" aria-hidden="true" tabindex="-1"></a>    graph[node2].append(node1)</span>
<span id="cb197-73"><a href="#cb197-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-74"><a href="#cb197-74" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> del_edge(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node1: <span class="bu">int</span>, node2: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb197-75"><a href="#cb197-75" aria-hidden="true" tabindex="-1"></a>    graph[node1].remove(node2)</span>
<span id="cb197-76"><a href="#cb197-76" aria-hidden="true" tabindex="-1"></a>    graph[node2].remove(node1)</span>
<span id="cb197-77"><a href="#cb197-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-78"><a href="#cb197-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6d(genome1: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]], genome2: DefaultDict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb197-79"><a href="#cb197-79" aria-hidden="true" tabindex="-1"></a>    combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb197-80"><a href="#cb197-80" aria-hidden="true" tabindex="-1"></a>    nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb197-81"><a href="#cb197-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb197-82"><a href="#cb197-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes:</span>
<span id="cb197-83"><a href="#cb197-83" aria-hidden="true" tabindex="-1"></a>        j <span class="op">=</span> nodes[<span class="dv">0</span>]</span>
<span id="cb197-84"><a href="#cb197-84" aria-hidden="true" tabindex="-1"></a>        i2 <span class="op">=</span> genome2[nodes[<span class="dv">0</span>]][<span class="dv">0</span>]</span>
<span id="cb197-85"><a href="#cb197-85" aria-hidden="true" tabindex="-1"></a>        i <span class="op">=</span> genome1[j][<span class="dv">0</span>]</span>
<span id="cb197-86"><a href="#cb197-86" aria-hidden="true" tabindex="-1"></a>        j2 <span class="op">=</span> genome1[i2][<span class="dv">0</span>]</span>
<span id="cb197-87"><a href="#cb197-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-88"><a href="#cb197-88" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i, j)</span>
<span id="cb197-89"><a href="#cb197-89" aria-hidden="true" tabindex="-1"></a>        del_edge(genome1, i2, j2)</span>
<span id="cb197-90"><a href="#cb197-90" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j, i2)</span>
<span id="cb197-91"><a href="#cb197-91" aria-hidden="true" tabindex="-1"></a>        add_edge(genome1, j2, i)</span>
<span id="cb197-92"><a href="#cb197-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-93"><a href="#cb197-93" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> format_genome_graph(genome1)</span>
<span id="cb197-94"><a href="#cb197-94" aria-hidden="true" tabindex="-1"></a>        combined_graph <span class="op">=</span> breakpoint_graph(genome1, genome2)</span>
<span id="cb197-95"><a href="#cb197-95" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> non_trivial_cycle_nodes(combined_graph)</span>
<span id="cb197-96"><a href="#cb197-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-97"><a href="#cb197-97" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb197-98"><a href="#cb197-98" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -2 -3 +4)</span></span>
<span id="cb197-99"><a href="#cb197-99" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 +2 -4 -3)</span></span>
<span id="cb197-100"><a href="#cb197-100" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb197-101"><a href="#cb197-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb197-102"><a href="#cb197-102" aria-hidden="true" tabindex="-1"></a>genome1, genome2 <span class="op">=</span> [parse_genome_graph(s) <span class="cf">for</span> s <span class="kw">in</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)]</span>
<span id="cb197-103"><a href="#cb197-103" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> genome <span class="kw">in</span> ba6d(genome1, genome2):</span>
<span id="cb197-104"><a href="#cb197-104" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(genome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-shared-k-mers-of-a-pair-of-strings" class="level1" data-number="66">
<h1 data-number="66"><span class="header-section-number">66</span> Find All Shared k-mers of a Pair of Strings</h1>
<p>Shared&nbsp;<em>k</em>-mers Problem. Given two strings, find all their shared k-mers.</p>
<p>Given:&nbsp;An integer&nbsp;<em>k</em>&nbsp;and two strings.</p>
<p>Return:&nbsp;All&nbsp;<em>k</em>-mers shared by these strings, in the form of ordered pairs (<em>x</em>,&nbsp;<em>y</em>) corresponding to starting positions of these k-mers in the respective strings.</p>
<section id="sample-dataset-66" class="level2" data-number="66.1">
<h2 data-number="66.1" class="anchored" data-anchor-id="sample-dataset-66"><span class="header-section-number">66.1</span> Sample Dataset</h2>
<pre><code>3
AAACTCATC
TTTCAAATC</code></pre>
</section>
<section id="sample-output-66" class="level2" data-number="66.2">
<h2 data-number="66.2" class="anchored" data-anchor-id="sample-output-66"><span class="header-section-number">66.2</span> Sample Output</h2>
<pre><code>(0, 4)
(0, 0)
(4, 2)
(6, 6)</code></pre>
</section>
<section id="solution-66" class="level2" data-number="66.3">
<h2 data-number="66.3" class="anchored" data-anchor-id="solution-66"><span class="header-section-number">66.3</span> Solution</h2>
<div class="sourceCode" id="cb200"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb200-3"><a href="#cb200-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-4"><a href="#cb200-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_complement(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb200-5"><a href="#cb200-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence[::<span class="op">-</span><span class="dv">1</span>].translate(<span class="bu">str</span>.maketrans(<span class="st">"ACGT"</span>, <span class="st">"TGCA"</span>))</span>
<span id="cb200-6"><a href="#cb200-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-7"><a href="#cb200-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_overlapping_matches(pattern: <span class="bu">str</span>, sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[re.Match]:</span>
<span id="cb200-8"><a href="#cb200-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> re.finditer(<span class="vs">rf"</span><span class="ex">(</span><span class="fu">?=</span><span class="kw">(</span><span class="sc">{</span>pattern<span class="sc">}</span><span class="kw">)</span><span class="ex">)</span><span class="vs">"</span>, sequence)</span>
<span id="cb200-9"><a href="#cb200-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-10"><a href="#cb200-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_shared_kmers(kmer_length: <span class="bu">int</span>, sequence1: <span class="bu">str</span>, sequence2: <span class="bu">str</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb200-11"><a href="#cb200-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(sequence1) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb200-12"><a href="#cb200-12" aria-hidden="true" tabindex="-1"></a>        kmer <span class="op">=</span> sequence1[i : (i <span class="op">+</span> kmer_length)]</span>
<span id="cb200-13"><a href="#cb200-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> current_sequence <span class="kw">in</span> [kmer, reverse_complement(kmer)]:</span>
<span id="cb200-14"><a href="#cb200-14" aria-hidden="true" tabindex="-1"></a>            matches <span class="op">=</span> <span class="bu">list</span>(find_overlapping_matches(current_sequence, sequence2))</span>
<span id="cb200-15"><a href="#cb200-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> match <span class="kw">in</span> matches:</span>
<span id="cb200-16"><a href="#cb200-16" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (i, match.start())</span>
<span id="cb200-17"><a href="#cb200-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-18"><a href="#cb200-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb200-19"><a href="#cb200-19" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb200-20"><a href="#cb200-20" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb200-21"><a href="#cb200-21" aria-hidden="true" tabindex="-1"></a><span class="st">AAACTCATC</span></span>
<span id="cb200-22"><a href="#cb200-22" aria-hidden="true" tabindex="-1"></a><span class="st">TTTCAAATC</span></span>
<span id="cb200-23"><a href="#cb200-23" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb200-24"><a href="#cb200-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb200-25"><a href="#cb200-25" aria-hidden="true" tabindex="-1"></a>kmer_length, sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb200-26"><a href="#cb200-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> match <span class="kw">in</span> find_shared_kmers(<span class="bu">int</span>(kmer_length), sequence1, sequence2):</span>
<span id="cb200-27"><a href="#cb200-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(match)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-chromosometocycle" class="level1" data-number="67">
<h1 data-number="67"><span class="header-section-number">67</span> Implement ChromosomeToCycle</h1>
<p>Chromosome To Cycle Problem. Solve the Chromosome To Cycle Problem.</p>
<p>Given:&nbsp;A chromosome&nbsp;<em>Chromosome</em>&nbsp;containing&nbsp;<em>n</em>&nbsp;synteny blocks.</p>
<p>Return:&nbsp;The sequence&nbsp;<em>Nodes</em>&nbsp;of integers between 1 and 2_n_&nbsp;resulting from applying ChromosomeToCycle to&nbsp;<em>Chromosome</em>.</p>
<section id="sample-dataset-67" class="level2" data-number="67.1">
<h2 data-number="67.1" class="anchored" data-anchor-id="sample-dataset-67"><span class="header-section-number">67.1</span> Sample Dataset</h2>
<pre><code>(+1 -2 -3 +4)</code></pre>
</section>
<section id="sample-output-67" class="level2" data-number="67.2">
<h2 data-number="67.2" class="anchored" data-anchor-id="sample-output-67"><span class="header-section-number">67.2</span> Sample Output</h2>
<pre><code>(1 2 4 3 6 5 7 8)</code></pre>
</section>
<section id="solution-67" class="level2" data-number="67.3">
<h2 data-number="67.3" class="anchored" data-anchor-id="solution-67"><span class="header-section-number">67.3</span> Solution</h2>
<div class="sourceCode" id="cb203"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(permutation_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb203-4"><a href="#cb203-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, permutation_string[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split()))</span>
<span id="cb203-5"><a href="#cb203-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-6"><a href="#cb203-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chromosome_to_cycle(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb203-7"><a href="#cb203-7" aria-hidden="true" tabindex="-1"></a>    nodes: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb203-8"><a href="#cb203-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gene <span class="kw">in</span> chromosome:</span>
<span id="cb203-9"><a href="#cb203-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gene <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb203-10"><a href="#cb203-10" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span> gene])</span>
<span id="cb203-11"><a href="#cb203-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb203-12"><a href="#cb203-12" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene, <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb203-13"><a href="#cb203-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb203-14"><a href="#cb203-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-15"><a href="#cb203-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_chromosome_to_cycle(chromosome_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb203-16"><a href="#cb203-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome_to_cycle(parse_permutation(chromosome_string))</span>
<span id="cb203-17"><a href="#cb203-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-18"><a href="#cb203-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_cycle(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb203-19"><a href="#cb203-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, cycle)) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb203-20"><a href="#cb203-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-21"><a href="#cb203-21" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(+1 -2 -3 +4)"</span></span>
<span id="cb203-22"><a href="#cb203-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb203-23"><a href="#cb203-23" aria-hidden="true" tabindex="-1"></a>chromosome_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb203-24"><a href="#cb203-24" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(format_cycle(convert_chromosome_to_cycle(chromosome_string)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-cycletochromosome" class="level1" data-number="68">
<h1 data-number="68"><span class="header-section-number">68</span> Implement CycleToChromosome</h1>
<p>Cycle To Chromosome Problem. Solve the Cycle to Chromosome Problem.</p>
<p>Given:&nbsp;A sequence Nodes of integers between 1 and 2_n_.</p>
<p>Return:&nbsp;The chromosome&nbsp;<em>Chromosome</em>&nbsp;containing&nbsp;<em>n</em>&nbsp;synteny blocks resulting from applying CycleToChromosome to&nbsp;<em>Nodes</em>.</p>
<section id="sample-dataset-68" class="level2" data-number="68.1">
<h2 data-number="68.1" class="anchored" data-anchor-id="sample-dataset-68"><span class="header-section-number">68.1</span> Sample Dataset</h2>
<pre><code>(1 2 4 3 6 5 7 8)</code></pre>
</section>
<section id="sample-output-68" class="level2" data-number="68.2">
<h2 data-number="68.2" class="anchored" data-anchor-id="sample-output-68"><span class="header-section-number">68.2</span> Sample Output</h2>
<pre><code>(+1 -2 -3 +4)</code></pre>
</section>
<section id="solution-68" class="level2" data-number="68.3">
<h2 data-number="68.3" class="anchored" data-anchor-id="solution-68"><span class="header-section-number">68.3</span> Solution</h2>
<div class="sourceCode" id="cb206"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-3"><a href="#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_cycle(cycle_string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb206-4"><a href="#cb206-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, cycle_string[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split()))</span>
<span id="cb206-5"><a href="#cb206-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-6"><a href="#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_chromosome(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb206-7"><a href="#cb206-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>gene<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb206-8"><a href="#cb206-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-9"><a href="#cb206-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cycle_to_chromosome(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb206-10"><a href="#cb206-10" aria-hidden="true" tabindex="-1"></a>    chromosome: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb206-11"><a href="#cb206-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j1, j2 <span class="kw">in</span> <span class="bu">zip</span>(cycle[::<span class="dv">2</span>], cycle[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb206-12"><a href="#cb206-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j1 <span class="op">&lt;</span> j2:</span>
<span id="cb206-13"><a href="#cb206-13" aria-hidden="true" tabindex="-1"></a>            chromosome.append(j2 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb206-14"><a href="#cb206-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb206-15"><a href="#cb206-15" aria-hidden="true" tabindex="-1"></a>            chromosome.append(<span class="op">-</span>j1 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb206-16"><a href="#cb206-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome</span>
<span id="cb206-17"><a href="#cb206-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-18"><a href="#cb206-18" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(1 2 4 3 6 5 7 8)"</span></span>
<span id="cb206-19"><a href="#cb206-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb206-20"><a href="#cb206-20" aria-hidden="true" tabindex="-1"></a>cycle_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb206-21"><a href="#cb206-21" aria-hidden="true" tabindex="-1"></a>chromosome: List[<span class="bu">int</span>] <span class="op">=</span> cycle_to_chromosome(parse_cycle(cycle_string))</span>
<span id="cb206-22"><a href="#cb206-22" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(format_chromosome(chromosome))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-colorededges" class="level1" data-number="69">
<h1 data-number="69"><span class="header-section-number">69</span> Implement ColoredEdges</h1>
<p>Colored Edges Problem. Find the Colored Edges in a genome.</p>
<p>Given:&nbsp;A genome&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The collection of colored edges in the genome graph of&nbsp;<em>P</em>&nbsp;in the form (<em>x</em>,&nbsp;<em>y</em>).</p>
<section id="sample-dataset-69" class="level2" data-number="69.1">
<h2 data-number="69.1" class="anchored" data-anchor-id="sample-dataset-69"><span class="header-section-number">69.1</span> Sample Dataset</h2>
<pre><code>(+1 -2 -3)(+4 +5 -6)</code></pre>
</section>
<section id="sample-output-69" class="level2" data-number="69.2">
<h2 data-number="69.2" class="anchored" data-anchor-id="sample-output-69"><span class="header-section-number">69.2</span> Sample Output</h2>
<pre><code>(2, 4), (3, 6), (5, 1), (8, 9), (10, 12), (11, 7)</code></pre>
</section>
<section id="solution-69" class="level2" data-number="69.3">
<h2 data-number="69.3" class="anchored" data-anchor-id="solution-69"><span class="header-section-number">69.3</span> Solution</h2>
<div class="sourceCode" id="cb209"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb209-3"><a href="#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chromosome_to_cycle(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb209-5"><a href="#cb209-5" aria-hidden="true" tabindex="-1"></a>    nodes: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb209-6"><a href="#cb209-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gene <span class="kw">in</span> chromosome:</span>
<span id="cb209-7"><a href="#cb209-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gene <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb209-8"><a href="#cb209-8" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span> gene])</span>
<span id="cb209-9"><a href="#cb209-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb209-10"><a href="#cb209-10" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene, <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb209-11"><a href="#cb209-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb209-12"><a href="#cb209-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-13"><a href="#cb209-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb209-14"><a href="#cb209-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split()))</span>
<span id="cb209-15"><a href="#cb209-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-16"><a href="#cb209-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_colored_edges(genome: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb209-17"><a href="#cb209-17" aria-hidden="true" tabindex="-1"></a>    edge_dict: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb209-18"><a href="#cb209-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chromosome <span class="kw">in</span> genome:</span>
<span id="cb209-19"><a href="#cb209-19" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> chromosome_to_cycle(chromosome)</span>
<span id="cb209-20"><a href="#cb209-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome)):</span>
<span id="cb209-21"><a href="#cb209-21" aria-hidden="true" tabindex="-1"></a>            start_index <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb209-22"><a href="#cb209-22" aria-hidden="true" tabindex="-1"></a>            end_index <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">2</span>) <span class="op">%</span> <span class="bu">len</span>(nodes)</span>
<span id="cb209-23"><a href="#cb209-23" aria-hidden="true" tabindex="-1"></a>            edge_dict[nodes[start_index]] <span class="op">=</span> nodes[end_index]</span>
<span id="cb209-24"><a href="#cb209-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> edge_dict</span>
<span id="cb209-25"><a href="#cb209-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-26"><a href="#cb209-26" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(+1 -2 -3)(+4 +5 -6)"</span></span>
<span id="cb209-27"><a href="#cb209-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-28"><a href="#cb209-28" aria-hidden="true" tabindex="-1"></a>genome_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb209-29"><a href="#cb209-29" aria-hidden="true" tabindex="-1"></a>genome: List[List[<span class="bu">int</span>]] <span class="op">=</span> [parse_integers(x) <span class="cf">for</span> x <span class="kw">in</span> re.findall(<span class="vs">r"</span><span class="ch">\(</span><span class="kw">(</span><span class="dv">.</span><span class="op">+?</span><span class="kw">)</span><span class="ch">\)</span><span class="vs">"</span>, genome_string)]</span>
<span id="cb209-30"><a href="#cb209-30" aria-hidden="true" tabindex="-1"></a>edges: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> [(k, v) <span class="cf">for</span> k, v <span class="kw">in</span> get_colored_edges(genome).items()]</span>
<span id="cb209-31"><a href="#cb209-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>edges, sep<span class="op">=</span><span class="st">", "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-graphtogenome" class="level1" data-number="70">
<h1 data-number="70"><span class="header-section-number">70</span> Implement GraphToGenome</h1>
<p>Graph To Genome Problem. Solve the Graph To Genome Problem.</p>
<p>Given:&nbsp;The colored edges of a genome graph.</p>
<p>Return:&nbsp;A genome corresponding to the genome graph.</p>
<section id="sample-dataset-70" class="level2" data-number="70.1">
<h2 data-number="70.1" class="anchored" data-anchor-id="sample-dataset-70"><span class="header-section-number">70.1</span> Sample Dataset</h2>
<pre><code>(2, 4), (3, 6), (5, 1), (7, 9), (10, 12), (11, 8)</code></pre>
</section>
<section id="sample-output-70" class="level2" data-number="70.2">
<h2 data-number="70.2" class="anchored" data-anchor-id="sample-output-70"><span class="header-section-number">70.2</span> Sample Output</h2>
<pre><code>(+1 -2 -3)(-4 +5 -6)</code></pre>
</section>
<section id="solution-70" class="level2" data-number="70.3">
<h2 data-number="70.3" class="anchored" data-anchor-id="solution-70"><span class="header-section-number">70.3</span> Solution</h2>
<div class="sourceCode" id="cb212"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb212-3"><a href="#cb212-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb212-4"><a href="#cb212-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-5"><a href="#cb212-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_chromosome(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb212-6"><a href="#cb212-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>gene<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb212-7"><a href="#cb212-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-8"><a href="#cb212-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cycle_to_chromosome(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb212-9"><a href="#cb212-9" aria-hidden="true" tabindex="-1"></a>    chromosome: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb212-10"><a href="#cb212-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j1, j2 <span class="kw">in</span> <span class="bu">zip</span>(cycle[::<span class="dv">2</span>], cycle[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb212-11"><a href="#cb212-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j1 <span class="op">&lt;</span> j2:</span>
<span id="cb212-12"><a href="#cb212-12" aria-hidden="true" tabindex="-1"></a>            chromosome.append(j2 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb212-13"><a href="#cb212-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb212-14"><a href="#cb212-14" aria-hidden="true" tabindex="-1"></a>            chromosome.append(<span class="op">-</span>j1 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb212-15"><a href="#cb212-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome</span>
<span id="cb212-16"><a href="#cb212-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-17"><a href="#cb212-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb212-18"><a href="#cb212-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split(<span class="st">", "</span>)))</span>
<span id="cb212-19"><a href="#cb212-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-20"><a href="#cb212-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_first_key(dictionary: Dict) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb212-21"><a href="#cb212-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">next</span>(<span class="bu">iter</span>(dictionary.keys()))</span>
<span id="cb212-22"><a href="#cb212-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-23"><a href="#cb212-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Find a single cycle from colored edges</span></span>
<span id="cb212-24"><a href="#cb212-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycle(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb212-25"><a href="#cb212-25" aria-hidden="true" tabindex="-1"></a>    start: <span class="bu">int</span> <span class="op">=</span> get_first_key(graph)</span>
<span id="cb212-26"><a href="#cb212-26" aria-hidden="true" tabindex="-1"></a>    current: <span class="bu">int</span> <span class="op">=</span> start</span>
<span id="cb212-27"><a href="#cb212-27" aria-hidden="true" tabindex="-1"></a>    component: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb212-28"><a href="#cb212-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb212-29"><a href="#cb212-29" aria-hidden="true" tabindex="-1"></a>        next_node: <span class="bu">int</span> <span class="op">=</span> graph.pop(current)</span>
<span id="cb212-30"><a href="#cb212-30" aria-hidden="true" tabindex="-1"></a>        graph.pop(next_node)</span>
<span id="cb212-31"><a href="#cb212-31" aria-hidden="true" tabindex="-1"></a>        neighbor: <span class="bu">int</span> <span class="op">=</span> next_node <span class="op">+</span> <span class="dv">1</span> <span class="cf">if</span> next_node <span class="op">%</span> <span class="dv">2</span> <span class="cf">else</span> next_node <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb212-32"><a href="#cb212-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="op">==</span> start:</span>
<span id="cb212-33"><a href="#cb212-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [next_node] <span class="op">+</span> component <span class="op">+</span> [current]</span>
<span id="cb212-34"><a href="#cb212-34" aria-hidden="true" tabindex="-1"></a>        component.extend([current, next_node])</span>
<span id="cb212-35"><a href="#cb212-35" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> neighbor</span>
<span id="cb212-36"><a href="#cb212-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-37"><a href="#cb212-37" aria-hidden="true" tabindex="-1"></a><span class="co"># find cycles in colored edges</span></span>
<span id="cb212-38"><a href="#cb212-38" aria-hidden="true" tabindex="-1"></a><span class="co"># to do this, we first make each edge "undirected"</span></span>
<span id="cb212-39"><a href="#cb212-39" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycles(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> Iterator[List[<span class="bu">int</span>]]:</span>
<span id="cb212-40"><a href="#cb212-40" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> copy(graph)</span>
<span id="cb212-41"><a href="#cb212-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> <span class="bu">list</span>(graph.items()):</span>
<span id="cb212-42"><a href="#cb212-42" aria-hidden="true" tabindex="-1"></a>        graph[v] <span class="op">=</span> k</span>
<span id="cb212-43"><a href="#cb212-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb212-44"><a href="#cb212-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> find_node_cycle(graph)</span>
<span id="cb212-45"><a href="#cb212-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-46"><a href="#cb212-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graph_to_genome(genome_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb212-47"><a href="#cb212-47" aria-hidden="true" tabindex="-1"></a>    genome: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb212-48"><a href="#cb212-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nodes <span class="kw">in</span> find_node_cycles(genome_graph):</span>
<span id="cb212-49"><a href="#cb212-49" aria-hidden="true" tabindex="-1"></a>        genome.append(cycle_to_chromosome(nodes))</span>
<span id="cb212-50"><a href="#cb212-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome</span>
<span id="cb212-51"><a href="#cb212-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-52"><a href="#cb212-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_edge_string(edge_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb212-53"><a href="#cb212-53" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb212-54"><a href="#cb212-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> re.findall(<span class="vs">r"</span><span class="ch">\(</span><span class="kw">(</span><span class="dv">.</span><span class="op">+?</span><span class="kw">)</span><span class="ch">\)</span><span class="vs">"</span>, edge_string):</span>
<span id="cb212-55"><a href="#cb212-55" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> parse_integers(x)</span>
<span id="cb212-56"><a href="#cb212-56" aria-hidden="true" tabindex="-1"></a>        graph[a] <span class="op">=</span> b</span>
<span id="cb212-57"><a href="#cb212-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb212-58"><a href="#cb212-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-59"><a href="#cb212-59" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"(2, 4), (3, 6), (5, 1), (7, 9), (10, 12), (11, 8)"</span></span>
<span id="cb212-60"><a href="#cb212-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb212-61"><a href="#cb212-61" aria-hidden="true" tabindex="-1"></a>edge_string: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb212-62"><a href="#cb212-62" aria-hidden="true" tabindex="-1"></a>genome_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> parse_edge_string(edge_string)</span>
<span id="cb212-63"><a href="#cb212-63" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[format_chromosome(x) <span class="cf">for</span> x <span class="kw">in</span> graph_to_genome(genome_graph)], sep<span class="op">=</span><span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-2-breakongenomegraph" class="level1" data-number="71">
<h1 data-number="71"><span class="header-section-number">71</span> Implement 2-BreakOnGenomeGraph</h1>
<p>2-Break On Genome Graph Problem. Solve the 2-Break On Genome Graph Problem.</p>
<p>Given:&nbsp;The colored edges of a genome graph&nbsp;<em>GenomeGraph</em>, followed by indices&nbsp;<em>i</em>,&nbsp;<em>i’</em>,&nbsp;<em>j</em>, and&nbsp;<em>j’</em>.</p>
<p>Return:&nbsp;The colored edges of the genome graph resulting from applying the 2-break operation.</p>
<section id="sample-dataset-71" class="level2" data-number="71.1">
<h2 data-number="71.1" class="anchored" data-anchor-id="sample-dataset-71"><span class="header-section-number">71.1</span> Sample Dataset</h2>
<pre><code>(2, 4), (3, 8), (7, 5), (6, 1)
1, 6, 3, 8</code></pre>
</section>
<section id="sample-output-71" class="level2" data-number="71.2">
<h2 data-number="71.2" class="anchored" data-anchor-id="sample-output-71"><span class="header-section-number">71.2</span> Sample Output</h2>
<pre><code>(2, 4), (3, 1), (7, 5), (6, 8)</code></pre>
</section>
<section id="solution-71" class="level2" data-number="71.3">
<h2 data-number="71.3" class="anchored" data-anchor-id="solution-71"><span class="header-section-number">71.3</span> Solution</h2>
<div class="sourceCode" id="cb215"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb215-2"><a href="#cb215-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb215-3"><a href="#cb215-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb215-4"><a href="#cb215-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-5"><a href="#cb215-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_edge_string(edge_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb215-6"><a href="#cb215-6" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb215-7"><a href="#cb215-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> match <span class="kw">in</span> re.findall(<span class="vs">r"</span><span class="ch">\(</span><span class="kw">(</span><span class="dv">.</span><span class="op">+?</span><span class="kw">)</span><span class="ch">\)</span><span class="vs">"</span>, edge_string):</span>
<span id="cb215-8"><a href="#cb215-8" aria-hidden="true" tabindex="-1"></a>        node1, node2 <span class="op">=</span> parse_integers(match)</span>
<span id="cb215-9"><a href="#cb215-9" aria-hidden="true" tabindex="-1"></a>        graph[node1] <span class="op">=</span> node2</span>
<span id="cb215-10"><a href="#cb215-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb215-11"><a href="#cb215-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-12"><a href="#cb215-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(string: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb215-13"><a href="#cb215-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, string.split(<span class="st">", "</span>)))</span>
<span id="cb215-14"><a href="#cb215-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-15"><a href="#cb215-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], edge: Tuple[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb215-16"><a href="#cb215-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> edge[<span class="dv">0</span>] <span class="kw">in</span> graph:</span>
<span id="cb215-17"><a href="#cb215-17" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">0</span>])</span>
<span id="cb215-18"><a href="#cb215-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb215-19"><a href="#cb215-19" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">1</span>])</span>
<span id="cb215-20"><a href="#cb215-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-21"><a href="#cb215-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_break_on_genome_graph(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], i: <span class="bu">int</span>, ip: <span class="bu">int</span>, j: <span class="bu">int</span>, jp: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb215-22"><a href="#cb215-22" aria-hidden="true" tabindex="-1"></a>    new_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> copy(graph)</span>
<span id="cb215-23"><a href="#cb215-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> [(i, ip), (j, jp)]:</span>
<span id="cb215-24"><a href="#cb215-24" aria-hidden="true" tabindex="-1"></a>        remove_edge(new_graph, edge)</span>
<span id="cb215-25"><a href="#cb215-25" aria-hidden="true" tabindex="-1"></a>    new_graph[i] <span class="op">=</span> j</span>
<span id="cb215-26"><a href="#cb215-26" aria-hidden="true" tabindex="-1"></a>    new_graph[ip] <span class="op">=</span> jp</span>
<span id="cb215-27"><a href="#cb215-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_graph</span>
<span id="cb215-28"><a href="#cb215-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-29"><a href="#cb215-29" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb215-30"><a href="#cb215-30" aria-hidden="true" tabindex="-1"></a><span class="st">(2, 4), (3, 8), (7, 5), (6, 1)</span></span>
<span id="cb215-31"><a href="#cb215-31" aria-hidden="true" tabindex="-1"></a><span class="st">1, 6, 3, 8</span></span>
<span id="cb215-32"><a href="#cb215-32" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb215-33"><a href="#cb215-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-34"><a href="#cb215-34" aria-hidden="true" tabindex="-1"></a>edge_string, break_points <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb215-35"><a href="#cb215-35" aria-hidden="true" tabindex="-1"></a>graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> parse_edge_string(edge_string)</span>
<span id="cb215-36"><a href="#cb215-36" aria-hidden="true" tabindex="-1"></a>break_points_list: List[<span class="bu">int</span>] <span class="op">=</span> parse_integers(break_points)</span>
<span id="cb215-37"><a href="#cb215-37" aria-hidden="true" tabindex="-1"></a>new_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> two_break_on_genome_graph(graph, <span class="op">*</span>break_points_list)</span>
<span id="cb215-38"><a href="#cb215-38" aria-hidden="true" tabindex="-1"></a>edges: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> [(k, v) <span class="cf">for</span> k, v <span class="kw">in</span> new_graph.items()]</span>
<span id="cb215-39"><a href="#cb215-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>edges, sep<span class="op">=</span><span class="st">", "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-2-breakongenome" class="level1" data-number="72">
<h1 data-number="72"><span class="header-section-number">72</span> Implement 2-BreakOnGenome</h1>
<p>Implement 2-BreakOnGenome. Solve the 2-Break On Genome Graph Problem.</p>
<p>Given:&nbsp;A genome&nbsp;<em>P</em>, followed by indices&nbsp;<em>i</em>,&nbsp;<em>i’</em>,&nbsp;<em>j</em>, and&nbsp;<em>j’</em>.</p>
<p>Return:&nbsp;The genome&nbsp;<em>P’</em>&nbsp;resulting from applying the 2-break operation.</p>
<section id="sample-dataset-72" class="level2" data-number="72.1">
<h2 data-number="72.1" class="anchored" data-anchor-id="sample-dataset-72"><span class="header-section-number">72.1</span> Sample Dataset</h2>
<pre><code>(+1 -2 -4 +3)
1, 6, 3, 8</code></pre>
</section>
<section id="sample-output-72" class="level2" data-number="72.2">
<h2 data-number="72.2" class="anchored" data-anchor-id="sample-output-72"><span class="header-section-number">72.2</span> Sample Output</h2>
<pre><code>(+1 -2) (-4 +3)</code></pre>
</section>
<section id="solution-72" class="level2" data-number="72.3">
<h2 data-number="72.3" class="anchored" data-anchor-id="solution-72"><span class="header-section-number">72.3</span> Solution</h2>
<div class="sourceCode" id="cb218"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb218-2"><a href="#cb218-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb218-3"><a href="#cb218-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-4"><a href="#cb218-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_permutation(s: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-5"><a href="#cb218-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, s[<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>].split()))</span>
<span id="cb218-6"><a href="#cb218-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-7"><a href="#cb218-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_permutation(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb218-8"><a href="#cb218-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">"("</span> <span class="op">+</span> <span class="st">" "</span>.join([<span class="ss">f"</span><span class="sc">{</span>gene<span class="sc">:+}</span><span class="ss">"</span> <span class="cf">for</span> gene <span class="kw">in</span> chromosome]) <span class="op">+</span> <span class="st">")"</span></span>
<span id="cb218-9"><a href="#cb218-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-10"><a href="#cb218-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> chromosome_to_cycle(chromosome: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-11"><a href="#cb218-11" aria-hidden="true" tabindex="-1"></a>    nodes: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb218-12"><a href="#cb218-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> gene <span class="kw">in</span> chromosome:</span>
<span id="cb218-13"><a href="#cb218-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> gene <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb218-14"><a href="#cb218-14" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>, <span class="dv">2</span> <span class="op">*</span> gene])</span>
<span id="cb218-15"><a href="#cb218-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb218-16"><a href="#cb218-16" aria-hidden="true" tabindex="-1"></a>            nodes.extend([<span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene, <span class="op">-</span><span class="dv">2</span> <span class="op">*</span> gene <span class="op">-</span> <span class="dv">1</span>])</span>
<span id="cb218-17"><a href="#cb218-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nodes</span>
<span id="cb218-18"><a href="#cb218-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-19"><a href="#cb218-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> colored_edges(genome: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb218-20"><a href="#cb218-20" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb218-21"><a href="#cb218-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> chromosome <span class="kw">in</span> genome:</span>
<span id="cb218-22"><a href="#cb218-22" aria-hidden="true" tabindex="-1"></a>        nodes <span class="op">=</span> chromosome_to_cycle(chromosome)</span>
<span id="cb218-23"><a href="#cb218-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(chromosome)):</span>
<span id="cb218-24"><a href="#cb218-24" aria-hidden="true" tabindex="-1"></a>            start_index <span class="op">=</span> <span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb218-25"><a href="#cb218-25" aria-hidden="true" tabindex="-1"></a>            end_index <span class="op">=</span> (<span class="dv">2</span> <span class="op">*</span> j <span class="op">+</span> <span class="dv">2</span>) <span class="op">%</span> <span class="bu">len</span>(nodes)</span>
<span id="cb218-26"><a href="#cb218-26" aria-hidden="true" tabindex="-1"></a>            graph[nodes[start_index]] <span class="op">=</span> nodes[end_index]</span>
<span id="cb218-27"><a href="#cb218-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb218-28"><a href="#cb218-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-29"><a href="#cb218-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> remove_edge(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], edge: Tuple[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb218-30"><a href="#cb218-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> edge[<span class="dv">0</span>] <span class="kw">in</span> graph:</span>
<span id="cb218-31"><a href="#cb218-31" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">0</span>])</span>
<span id="cb218-32"><a href="#cb218-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb218-33"><a href="#cb218-33" aria-hidden="true" tabindex="-1"></a>        graph.pop(edge[<span class="dv">1</span>])</span>
<span id="cb218-34"><a href="#cb218-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-35"><a href="#cb218-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_break_on_genome_graph(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>], i: <span class="bu">int</span>, ip: <span class="bu">int</span>, j: <span class="bu">int</span>, jp: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb218-36"><a href="#cb218-36" aria-hidden="true" tabindex="-1"></a>    new_graph <span class="op">=</span> copy(graph)</span>
<span id="cb218-37"><a href="#cb218-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> [(i, ip), (j, jp)]:</span>
<span id="cb218-38"><a href="#cb218-38" aria-hidden="true" tabindex="-1"></a>        remove_edge(new_graph, edge)</span>
<span id="cb218-39"><a href="#cb218-39" aria-hidden="true" tabindex="-1"></a>    new_graph[i] <span class="op">=</span> j</span>
<span id="cb218-40"><a href="#cb218-40" aria-hidden="true" tabindex="-1"></a>    new_graph[ip] <span class="op">=</span> jp</span>
<span id="cb218-41"><a href="#cb218-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> new_graph</span>
<span id="cb218-42"><a href="#cb218-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-43"><a href="#cb218-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_first_key(dictionary: Dict) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb218-44"><a href="#cb218-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">next</span>(<span class="bu">iter</span>(dictionary.keys()))</span>
<span id="cb218-45"><a href="#cb218-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-46"><a href="#cb218-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycle(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-47"><a href="#cb218-47" aria-hidden="true" tabindex="-1"></a>    start <span class="op">=</span> get_first_key(graph)</span>
<span id="cb218-48"><a href="#cb218-48" aria-hidden="true" tabindex="-1"></a>    current <span class="op">=</span> start</span>
<span id="cb218-49"><a href="#cb218-49" aria-hidden="true" tabindex="-1"></a>    component: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb218-50"><a href="#cb218-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb218-51"><a href="#cb218-51" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">=</span> graph.pop(current)</span>
<span id="cb218-52"><a href="#cb218-52" aria-hidden="true" tabindex="-1"></a>        graph.pop(next_node)</span>
<span id="cb218-53"><a href="#cb218-53" aria-hidden="true" tabindex="-1"></a>        neighbor <span class="op">=</span> next_node <span class="op">+</span> <span class="dv">1</span> <span class="cf">if</span> next_node <span class="op">%</span> <span class="dv">2</span> <span class="cf">else</span> next_node <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb218-54"><a href="#cb218-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> neighbor <span class="op">==</span> start:</span>
<span id="cb218-55"><a href="#cb218-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> [next_node] <span class="op">+</span> component <span class="op">+</span> [current]</span>
<span id="cb218-56"><a href="#cb218-56" aria-hidden="true" tabindex="-1"></a>        component.extend([current, next_node])</span>
<span id="cb218-57"><a href="#cb218-57" aria-hidden="true" tabindex="-1"></a>        current <span class="op">=</span> neighbor</span>
<span id="cb218-58"><a href="#cb218-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-59"><a href="#cb218-59" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_node_cycles(graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> Iterator[List[<span class="bu">int</span>]]:</span>
<span id="cb218-60"><a href="#cb218-60" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> copy(graph)</span>
<span id="cb218-61"><a href="#cb218-61" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> <span class="bu">list</span>(graph.items()):</span>
<span id="cb218-62"><a href="#cb218-62" aria-hidden="true" tabindex="-1"></a>        graph[v] <span class="op">=</span> k</span>
<span id="cb218-63"><a href="#cb218-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> graph:</span>
<span id="cb218-64"><a href="#cb218-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> find_node_cycle(graph)</span>
<span id="cb218-65"><a href="#cb218-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-66"><a href="#cb218-66" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> cycle_to_chromosome(cycle: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-67"><a href="#cb218-67" aria-hidden="true" tabindex="-1"></a>    chromosome: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb218-68"><a href="#cb218-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j1, j2 <span class="kw">in</span> <span class="bu">zip</span>(cycle[::<span class="dv">2</span>], cycle[<span class="dv">1</span>::<span class="dv">2</span>]):</span>
<span id="cb218-69"><a href="#cb218-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j1 <span class="op">&lt;</span> j2:</span>
<span id="cb218-70"><a href="#cb218-70" aria-hidden="true" tabindex="-1"></a>            chromosome.append(j2 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb218-71"><a href="#cb218-71" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb218-72"><a href="#cb218-72" aria-hidden="true" tabindex="-1"></a>            chromosome.append(<span class="op">-</span>j1 <span class="op">//</span> <span class="dv">2</span>)</span>
<span id="cb218-73"><a href="#cb218-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chromosome</span>
<span id="cb218-74"><a href="#cb218-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-75"><a href="#cb218-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> graph_to_genome(genome_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb218-76"><a href="#cb218-76" aria-hidden="true" tabindex="-1"></a>    genome: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb218-77"><a href="#cb218-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> nodes <span class="kw">in</span> find_node_cycles(genome_graph):</span>
<span id="cb218-78"><a href="#cb218-78" aria-hidden="true" tabindex="-1"></a>        genome.append(cycle_to_chromosome(nodes))</span>
<span id="cb218-79"><a href="#cb218-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> genome</span>
<span id="cb218-80"><a href="#cb218-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-81"><a href="#cb218-81" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_integers(x: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb218-82"><a href="#cb218-82" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, x.split(<span class="st">", "</span>)))</span>
<span id="cb218-83"><a href="#cb218-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-84"><a href="#cb218-84" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> two_break_on_genome(chromosome: List[<span class="bu">int</span>], i: <span class="bu">int</span>, ip: <span class="bu">int</span>, j: <span class="bu">int</span>, jp: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb218-85"><a href="#cb218-85" aria-hidden="true" tabindex="-1"></a>    genome_graph <span class="op">=</span> colored_edges([chromosome])</span>
<span id="cb218-86"><a href="#cb218-86" aria-hidden="true" tabindex="-1"></a>    genome_graph <span class="op">=</span> two_break_on_genome_graph(genome_graph, i, ip, j, jp)</span>
<span id="cb218-87"><a href="#cb218-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph_to_genome(genome_graph)</span>
<span id="cb218-88"><a href="#cb218-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-89"><a href="#cb218-89" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb218-90"><a href="#cb218-90" aria-hidden="true" tabindex="-1"></a><span class="st">(+1 -2 -4 +3)</span></span>
<span id="cb218-91"><a href="#cb218-91" aria-hidden="true" tabindex="-1"></a><span class="st">1, 6, 3, 8</span></span>
<span id="cb218-92"><a href="#cb218-92" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb218-93"><a href="#cb218-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-94"><a href="#cb218-94" aria-hidden="true" tabindex="-1"></a>genome_str, indices_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb218-95"><a href="#cb218-95" aria-hidden="true" tabindex="-1"></a>genome <span class="op">=</span> parse_permutation(genome_str)</span>
<span id="cb218-96"><a href="#cb218-96" aria-hidden="true" tabindex="-1"></a>new_genome <span class="op">=</span> two_break_on_genome(genome, <span class="op">*</span>parse_integers(indices_str))</span>
<span id="cb218-97"><a href="#cb218-97" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>[format_permutation(x) <span class="cf">for</span> x <span class="kw">in</span> new_genome])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-distances-between-leaves" class="level1" data-number="73">
<h1 data-number="73"><span class="header-section-number">73</span> Compute Distances Between Leaves</h1>
<p>Distance Between Leaves Problem. Compute the distances between leaves in a weighted tree.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>&nbsp;followed by the adjacency list of a weighted tree with&nbsp;<em>n</em>&nbsp;leaves.</p>
<p>Return:&nbsp;A space-separated&nbsp;<em>n</em>&nbsp;x&nbsp;<em>n</em>&nbsp;(*d__i<em>,&nbsp;</em>j<em>), where&nbsp;</em>d__i<em>,&nbsp;</em>j<em>&nbsp;is the length of the path between leaves&nbsp;</em>i<em>&nbsp;and&nbsp;</em>j*.</p>
<section id="sample-dataset-73" class="level2" data-number="73.1">
<h2 data-number="73.1" class="anchored" data-anchor-id="sample-dataset-73"><span class="header-section-number">73.1</span> Sample Dataset</h2>
<pre><code>4
0-&gt;4:11
1-&gt;4:2
2-&gt;5:6
3-&gt;5:7
4-&gt;0:11
4-&gt;1:2
4-&gt;5:4
5-&gt;4:4
5-&gt;3:7
5-&gt;2:6</code></pre>
</section>
<section id="sample-output-73" class="level2" data-number="73.2">
<h2 data-number="73.2" class="anchored" data-anchor-id="sample-output-73"><span class="header-section-number">73.2</span> Sample Output</h2>
<pre><code>0   13  21  22
13  0   12  13
21  12  0   13
22  13  13  0</code></pre>
</section>
<section id="solution-73" class="level2" data-number="73.3">
<h2 data-number="73.3" class="anchored" data-anchor-id="solution-73"><span class="header-section-number">73.3</span> Solution</h2>
<div class="sourceCode" id="cb221"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> heapq <span class="im">import</span> heappush, heappop</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb221-9"><a href="#cb221-9" aria-hidden="true" tabindex="-1"></a>    destination_nodes <span class="op">=</span> {edge[<span class="st">"n"</span>] <span class="cf">for</span> edges <span class="kw">in</span> graph.values() <span class="cf">for</span> edge <span class="kw">in</span> edges}</span>
<span id="cb221-10"><a href="#cb221-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> destination_nodes</span>
<span id="cb221-11"><a href="#cb221-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-12"><a href="#cb221-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Dijkstra's algorithm to find distance from start to all other nodes</span></span>
<span id="cb221-13"><a href="#cb221-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes nodes are integers starting at 0!</span></span>
<span id="cb221-14"><a href="#cb221-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dijkstra(start: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb221-15"><a href="#cb221-15" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [inf <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(get_all_nodes(graph)))]</span>
<span id="cb221-16"><a href="#cb221-16" aria-hidden="true" tabindex="-1"></a>    distances[start] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb221-17"><a href="#cb221-17" aria-hidden="true" tabindex="-1"></a>    priority_queue: List[Tuple[<span class="bu">float</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb221-18"><a href="#cb221-18" aria-hidden="true" tabindex="-1"></a>    heappush(priority_queue, (<span class="dv">0</span>, start))</span>
<span id="cb221-19"><a href="#cb221-19" aria-hidden="true" tabindex="-1"></a>    processed_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb221-20"><a href="#cb221-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-21"><a href="#cb221-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> priority_queue:</span>
<span id="cb221-22"><a href="#cb221-22" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> heappop(priority_queue)[<span class="dv">1</span>]</span>
<span id="cb221-23"><a href="#cb221-23" aria-hidden="true" tabindex="-1"></a>        processed_nodes.add(current_node)</span>
<span id="cb221-24"><a href="#cb221-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb221-25"><a href="#cb221-25" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor[<span class="st">"n"</span>] <span class="kw">not</span> <span class="kw">in</span> processed_nodes:</span>
<span id="cb221-26"><a href="#cb221-26" aria-hidden="true" tabindex="-1"></a>                distances[neighbor[<span class="st">"n"</span>]] <span class="op">=</span> <span class="bu">min</span>(distances[current_node] <span class="op">+</span> neighbor[<span class="st">"w"</span>], distances[neighbor[<span class="st">"n"</span>]])</span>
<span id="cb221-27"><a href="#cb221-27" aria-hidden="true" tabindex="-1"></a>                heappush(priority_queue, (distances[neighbor[<span class="st">"n"</span>]], neighbor[<span class="st">"n"</span>]))</span>
<span id="cb221-28"><a href="#cb221-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-29"><a href="#cb221-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances</span>
<span id="cb221-30"><a href="#cb221-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-31"><a href="#cb221-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_weighted_graph(edges: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb221-32"><a href="#cb221-32" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb221-33"><a href="#cb221-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-34"><a href="#cb221-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb221-35"><a href="#cb221-35" aria-hidden="true" tabindex="-1"></a>        from_node, to_node, weight <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, split(<span class="vs">r"</span><span class="dv">\D</span><span class="op">+</span><span class="vs">"</span>, edge))</span>
<span id="cb221-36"><a href="#cb221-36" aria-hidden="true" tabindex="-1"></a>        graph[from_node].append({<span class="st">"n"</span>: to_node, <span class="st">"w"</span>: weight})</span>
<span id="cb221-37"><a href="#cb221-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-38"><a href="#cb221-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb221-39"><a href="#cb221-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-40"><a href="#cb221-40" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb221-41"><a href="#cb221-41" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb221-42"><a href="#cb221-42" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;4:11</span></span>
<span id="cb221-43"><a href="#cb221-43" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:2</span></span>
<span id="cb221-44"><a href="#cb221-44" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;5:6</span></span>
<span id="cb221-45"><a href="#cb221-45" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;5:7</span></span>
<span id="cb221-46"><a href="#cb221-46" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;0:11</span></span>
<span id="cb221-47"><a href="#cb221-47" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;1:2</span></span>
<span id="cb221-48"><a href="#cb221-48" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;5:4</span></span>
<span id="cb221-49"><a href="#cb221-49" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;4:4</span></span>
<span id="cb221-50"><a href="#cb221-50" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;3:7</span></span>
<span id="cb221-51"><a href="#cb221-51" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;2:6</span></span>
<span id="cb221-52"><a href="#cb221-52" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb221-53"><a href="#cb221-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-54"><a href="#cb221-54" aria-hidden="true" tabindex="-1"></a>num_leaves, <span class="op">*</span>edges <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb221-55"><a href="#cb221-55" aria-hidden="true" tabindex="-1"></a>num_leaves <span class="op">=</span> <span class="bu">int</span>(num_leaves)</span>
<span id="cb221-56"><a href="#cb221-56" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> parse_weighted_graph(edges)</span>
<span id="cb221-57"><a href="#cb221-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_leaves):</span>
<span id="cb221-58"><a href="#cb221-58" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>dijkstra(i, graph)[:num_leaves])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-limb-lengths-in-a-tree" class="level1" data-number="74">
<h1 data-number="74"><span class="header-section-number">74</span> Compute Limb Lengths in a Tree</h1>
<p>Limb Length Problem. Find the limb length for a leaf in a tree.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>, followed by an integer&nbsp;<em>j</em>&nbsp;between 0 and&nbsp;<em>n</em>&nbsp;- 1, followed by a space-separated additive distance matrix&nbsp;<em>D</em>&nbsp;(whose elements are integers).</p>
<p>Return:&nbsp;The limb length of the leaf in&nbsp;<em>Tree</em>(<em>D</em>) corresponding to row&nbsp;<em>j</em>&nbsp;of this distance matrix (use&nbsp;<a href="https://rosalind.info/glossary/0-based-numbering/">0-based indexing</a>).</p>
<section id="sample-dataset-74" class="level2" data-number="74.1">
<h2 data-number="74.1" class="anchored" data-anchor-id="sample-dataset-74"><span class="header-section-number">74.1</span> Sample Dataset</h2>
<pre><code>4
1
0   13  21  22
13  0   12  13
21  12  0   13
22  13  13  0</code></pre>
</section>
<section id="sample-output-74" class="level2" data-number="74.2">
<h2 data-number="74.2" class="anchored" data-anchor-id="sample-output-74"><span class="header-section-number">74.2</span> Sample Output</h2>
<pre><code>2</code></pre>
</section>
<section id="solution-74" class="level2" data-number="74.3">
<h2 data-number="74.3" class="anchored" data-anchor-id="solution-74"><span class="header-section-number">74.3</span> Solution</h2>
<div class="sourceCode" id="cb224"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb224-1"><a href="#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> re <span class="im">import</span> split</span>
<span id="cb224-2"><a href="#cb224-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb224-3"><a href="#cb224-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb224-4"><a href="#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> heapq <span class="im">import</span> heappush, heappop</span>
<span id="cb224-5"><a href="#cb224-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb224-6"><a href="#cb224-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-7"><a href="#cb224-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb224-8"><a href="#cb224-8" aria-hidden="true" tabindex="-1"></a>    source_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb224-9"><a href="#cb224-9" aria-hidden="true" tabindex="-1"></a>    destination_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> {edge[<span class="st">"to"</span>] <span class="cf">for</span> edges <span class="kw">in</span> graph.values() <span class="cf">for</span> edge <span class="kw">in</span> edges}</span>
<span id="cb224-10"><a href="#cb224-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> destination_nodes</span>
<span id="cb224-11"><a href="#cb224-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-12"><a href="#cb224-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Dijkstra's algorithm to find distance from start to all other nodes</span></span>
<span id="cb224-13"><a href="#cb224-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Assumes nodes are integers starting at 0!</span></span>
<span id="cb224-14"><a href="#cb224-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> dijkstra(start: <span class="bu">int</span>, graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> List[<span class="bu">float</span>]:</span>
<span id="cb224-15"><a href="#cb224-15" aria-hidden="true" tabindex="-1"></a>    distances: List[<span class="bu">float</span>] <span class="op">=</span> [inf <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(get_all_nodes(graph)))]</span>
<span id="cb224-16"><a href="#cb224-16" aria-hidden="true" tabindex="-1"></a>    distances[start] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb224-17"><a href="#cb224-17" aria-hidden="true" tabindex="-1"></a>    priority_queue: List[Tuple[<span class="bu">float</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb224-18"><a href="#cb224-18" aria-hidden="true" tabindex="-1"></a>    heappush(priority_queue, (<span class="dv">0</span>, start))</span>
<span id="cb224-19"><a href="#cb224-19" aria-hidden="true" tabindex="-1"></a>    processed_nodes: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb224-20"><a href="#cb224-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-21"><a href="#cb224-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> priority_queue:</span>
<span id="cb224-22"><a href="#cb224-22" aria-hidden="true" tabindex="-1"></a>        current_distance, current_node <span class="op">=</span> heappop(priority_queue)</span>
<span id="cb224-23"><a href="#cb224-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_node <span class="kw">in</span> processed_nodes:</span>
<span id="cb224-24"><a href="#cb224-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb224-25"><a href="#cb224-25" aria-hidden="true" tabindex="-1"></a>        processed_nodes.add(current_node)</span>
<span id="cb224-26"><a href="#cb224-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> graph[current_node]:</span>
<span id="cb224-27"><a href="#cb224-27" aria-hidden="true" tabindex="-1"></a>            neighbor_node: <span class="bu">int</span> <span class="op">=</span> neighbor[<span class="st">"to"</span>]</span>
<span id="cb224-28"><a href="#cb224-28" aria-hidden="true" tabindex="-1"></a>            edge_weight: <span class="bu">int</span> <span class="op">=</span> neighbor[<span class="st">"weight"</span>]</span>
<span id="cb224-29"><a href="#cb224-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> neighbor_node <span class="kw">not</span> <span class="kw">in</span> processed_nodes:</span>
<span id="cb224-30"><a href="#cb224-30" aria-hidden="true" tabindex="-1"></a>                new_distance: <span class="bu">float</span> <span class="op">=</span> current_distance <span class="op">+</span> edge_weight</span>
<span id="cb224-31"><a href="#cb224-31" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> new_distance <span class="op">&lt;</span> distances[neighbor_node]:</span>
<span id="cb224-32"><a href="#cb224-32" aria-hidden="true" tabindex="-1"></a>                    distances[neighbor_node] <span class="op">=</span> new_distance</span>
<span id="cb224-33"><a href="#cb224-33" aria-hidden="true" tabindex="-1"></a>                    heappush(priority_queue, (new_distance, neighbor_node))</span>
<span id="cb224-34"><a href="#cb224-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-35"><a href="#cb224-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances</span>
<span id="cb224-36"><a href="#cb224-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-37"><a href="#cb224-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_weighted_graph(edges: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb224-38"><a href="#cb224-38" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb224-39"><a href="#cb224-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-40"><a href="#cb224-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb224-41"><a href="#cb224-41" aria-hidden="true" tabindex="-1"></a>        from_node, to_node, weight <span class="op">=</span> <span class="bu">map</span>(<span class="bu">int</span>, split(<span class="vs">r"</span><span class="dv">\D</span><span class="op">+</span><span class="vs">"</span>, edge))</span>
<span id="cb224-42"><a href="#cb224-42" aria-hidden="true" tabindex="-1"></a>        graph[from_node].append({<span class="st">"to"</span>: to_node, <span class="st">"weight"</span>: weight})</span>
<span id="cb224-43"><a href="#cb224-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-44"><a href="#cb224-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb224-45"><a href="#cb224-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-46"><a href="#cb224-46" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb224-47"><a href="#cb224-47" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb224-48"><a href="#cb224-48" aria-hidden="true" tabindex="-1"></a><span class="st">0-&gt;4:11</span></span>
<span id="cb224-49"><a href="#cb224-49" aria-hidden="true" tabindex="-1"></a><span class="st">1-&gt;4:2</span></span>
<span id="cb224-50"><a href="#cb224-50" aria-hidden="true" tabindex="-1"></a><span class="st">2-&gt;5:6</span></span>
<span id="cb224-51"><a href="#cb224-51" aria-hidden="true" tabindex="-1"></a><span class="st">3-&gt;5:7</span></span>
<span id="cb224-52"><a href="#cb224-52" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;0:11</span></span>
<span id="cb224-53"><a href="#cb224-53" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;1:2</span></span>
<span id="cb224-54"><a href="#cb224-54" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;5:4</span></span>
<span id="cb224-55"><a href="#cb224-55" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;4:4</span></span>
<span id="cb224-56"><a href="#cb224-56" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;3:7</span></span>
<span id="cb224-57"><a href="#cb224-57" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;2:6</span></span>
<span id="cb224-58"><a href="#cb224-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb224-59"><a href="#cb224-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb224-60"><a href="#cb224-60" aria-hidden="true" tabindex="-1"></a>num_leaves, <span class="op">*</span>edges <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb224-61"><a href="#cb224-61" aria-hidden="true" tabindex="-1"></a>num_leaves: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(num_leaves)</span>
<span id="cb224-62"><a href="#cb224-62" aria-hidden="true" tabindex="-1"></a>graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> parse_weighted_graph(edges)</span>
<span id="cb224-63"><a href="#cb224-63" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_leaves):</span>
<span id="cb224-64"><a href="#cb224-64" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>dijkstra(i, graph)[:num_leaves])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-additivephylogeny" class="level1" data-number="75">
<h1 data-number="75"><span class="header-section-number">75</span> Implement AdditivePhylogeny</h1>
<p>Additive Phylogeny Problem. Construct the simple tree fitting an additive matrix.</p>
<p>Given:&nbsp;<em>n</em>&nbsp;and a tab-delimited&nbsp;<em>n</em>&nbsp;x&nbsp;<em>n</em>&nbsp;additive matrix.</p>
<p>Return:&nbsp;A weighted adjacency list for the simple tree fitting this matrix.</p>
<p><strong>Note on formatting</strong>: The adjacency list must have consecutive integer node labels starting from 0. The&nbsp;<em>n</em>&nbsp;leaves must be labeled&nbsp;<em>0, 1, …, n-1</em>&nbsp;in order of their appearance in the distance matrix. Labels for internal nodes may be labeled in any order but must start from&nbsp;<em>n</em>&nbsp;and increase consecutively.</p>
<section id="sample-dataset-75" class="level2" data-number="75.1">
<h2 data-number="75.1" class="anchored" data-anchor-id="sample-dataset-75"><span class="header-section-number">75.1</span> Sample Dataset</h2>
<pre><code>4
0   13  21  22
13  0   12  13
21  12  0   13
22  13  13  0</code></pre>
</section>
<section id="sample-output-75" class="level2" data-number="75.2">
<h2 data-number="75.2" class="anchored" data-anchor-id="sample-output-75"><span class="header-section-number">75.2</span> Sample Output</h2>
<pre><code>0-&gt;4:11
1-&gt;4:2
2-&gt;5:6
3-&gt;5:7
4-&gt;0:11
4-&gt;1:2
4-&gt;5:4
5-&gt;2:6
5-&gt;3:7
5-&gt;4:4</code></pre>
</section>
<section id="solution-75" class="level2" data-number="75.3">
<h2 data-number="75.3" class="anchored" data-anchor-id="solution-75"><span class="header-section-number">75.3</span> Solution</h2>
<div class="sourceCode" id="cb227"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Set, Tuple, Generator</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-4"><a href="#cb227-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Type aliases for clarity</span></span>
<span id="cb227-5"><a href="#cb227-5" aria-hidden="true" tabindex="-1"></a>DistanceMatrix <span class="op">=</span> List[List[<span class="bu">int</span>]]</span>
<span id="cb227-6"><a href="#cb227-6" aria-hidden="true" tabindex="-1"></a>Graph <span class="op">=</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]</span>
<span id="cb227-7"><a href="#cb227-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-8"><a href="#cb227-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_distance_matrix(lines: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> DistanceMatrix:</span>
<span id="cb227-9"><a href="#cb227-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Parse integer matrix from set of lines"""</span></span>
<span id="cb227-10"><a href="#cb227-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split()] <span class="cf">for</span> line <span class="kw">in</span> lines]</span>
<span id="cb227-11"><a href="#cb227-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-12"><a href="#cb227-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_limb_length(distance_matrix: DistanceMatrix, j: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb227-13"><a href="#cb227-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Calculate limb length j for distance matrix"""</span></span>
<span id="cb227-14"><a href="#cb227-14" aria-hidden="true" tabindex="-1"></a>    min_limb_length <span class="op">=</span> <span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb227-15"><a href="#cb227-15" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(distance_matrix)</span>
<span id="cb227-16"><a href="#cb227-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb227-17"><a href="#cb227-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb227-18"><a href="#cb227-18" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> j <span class="op">!=</span> k <span class="kw">and</span> i <span class="op">!=</span> j:</span>
<span id="cb227-19"><a href="#cb227-19" aria-hidden="true" tabindex="-1"></a>                limb_length <span class="op">=</span> (distance_matrix[i][j] <span class="op">+</span> distance_matrix[j][k] <span class="op">-</span> distance_matrix[i][k]) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb227-20"><a href="#cb227-20" aria-hidden="true" tabindex="-1"></a>                min_limb_length <span class="op">=</span> <span class="bu">min</span>(limb_length, min_limb_length)</span>
<span id="cb227-21"><a href="#cb227-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> min_limb_length</span>
<span id="cb227-22"><a href="#cb227-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-23"><a href="#cb227-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Graph) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb227-24"><a href="#cb227-24" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Get all nodes in the graph"""</span></span>
<span id="cb227-25"><a href="#cb227-25" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb227-26"><a href="#cb227-26" aria-hidden="true" tabindex="-1"></a>    target_nodes <span class="op">=</span> {edge[<span class="st">"n"</span>] <span class="cf">for</span> edges <span class="kw">in</span> graph.values() <span class="cf">for</span> edge <span class="kw">in</span> edges}</span>
<span id="cb227-27"><a href="#cb227-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> target_nodes</span>
<span id="cb227-28"><a href="#cb227-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-29"><a href="#cb227-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_path(graph: Graph, path: List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]], target: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb227-30"><a href="#cb227-30" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Search tree, returning route to target and cumulative distance"""</span></span>
<span id="cb227-31"><a href="#cb227-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> target <span class="kw">in</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> path]:</span>
<span id="cb227-32"><a href="#cb227-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> path</span>
<span id="cb227-33"><a href="#cb227-33" aria-hidden="true" tabindex="-1"></a>    current_node, current_distance <span class="op">=</span> path[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb227-34"><a href="#cb227-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node <span class="kw">in</span> graph:</span>
<span id="cb227-35"><a href="#cb227-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> graph[current_node]:</span>
<span id="cb227-36"><a href="#cb227-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> edge[<span class="st">"n"</span>] <span class="kw">not</span> <span class="kw">in</span> [x[<span class="dv">0</span>] <span class="cf">for</span> x <span class="kw">in</span> path]:</span>
<span id="cb227-37"><a href="#cb227-37" aria-hidden="true" tabindex="-1"></a>                new_path <span class="op">=</span> path <span class="op">+</span> [(edge[<span class="st">"n"</span>], current_distance <span class="op">+</span> edge[<span class="st">"w"</span>])]</span>
<span id="cb227-38"><a href="#cb227-38" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> <span class="cf">from</span> find_path(graph, new_path, target)</span>
<span id="cb227-39"><a href="#cb227-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-40"><a href="#cb227-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_leaves(distance_matrix: DistanceMatrix, n: <span class="bu">int</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb227-41"><a href="#cb227-41" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find three leaves i, n, k such that D[i][k] = D[i][n] + D[n][k]"""</span></span>
<span id="cb227-42"><a href="#cb227-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb227-43"><a href="#cb227-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(distance_matrix)):</span>
<span id="cb227-44"><a href="#cb227-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> distance_matrix[i][k] <span class="op">==</span> distance_matrix[i][n] <span class="op">+</span> distance_matrix[n][k]:</span>
<span id="cb227-45"><a href="#cb227-45" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> i, n, k</span>
<span id="cb227-46"><a href="#cb227-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"No suitable leaves found"</span>)</span>
<span id="cb227-47"><a href="#cb227-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-48"><a href="#cb227-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_node(tree: Graph, i: <span class="bu">int</span>, k: <span class="bu">int</span>, x: <span class="bu">int</span>, n: <span class="bu">int</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb227-49"><a href="#cb227-49" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Add node in graph between i and k, distance x from i, labelled n"""</span></span>
<span id="cb227-50"><a href="#cb227-50" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">list</span>(find_path(tree, [(i, <span class="dv">0</span>)], k))[<span class="dv">0</span>]</span>
<span id="cb227-51"><a href="#cb227-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> p, node <span class="kw">in</span> <span class="bu">enumerate</span>(path):</span>
<span id="cb227-52"><a href="#cb227-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node[<span class="dv">1</span>] <span class="op">&gt;</span> x:</span>
<span id="cb227-53"><a href="#cb227-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">break</span></span>
<span id="cb227-54"><a href="#cb227-54" aria-hidden="true" tabindex="-1"></a>    p <span class="op">=</span> p <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb227-55"><a href="#cb227-55" aria-hidden="true" tabindex="-1"></a>    i, d1 <span class="op">=</span> path[p]</span>
<span id="cb227-56"><a href="#cb227-56" aria-hidden="true" tabindex="-1"></a>    k, d2 <span class="op">=</span> path[p <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb227-57"><a href="#cb227-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-58"><a href="#cb227-58" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Delete old edge and add new edges</span></span>
<span id="cb227-59"><a href="#cb227-59" aria-hidden="true" tabindex="-1"></a>    tree[i] <span class="op">=</span> [edge <span class="cf">for</span> edge <span class="kw">in</span> tree[i] <span class="cf">if</span> edge[<span class="st">"n"</span>] <span class="op">!=</span> k]</span>
<span id="cb227-60"><a href="#cb227-60" aria-hidden="true" tabindex="-1"></a>    tree[i].append({<span class="st">"n"</span>: n, <span class="st">"w"</span>: x <span class="op">-</span> d1})</span>
<span id="cb227-61"><a href="#cb227-61" aria-hidden="true" tabindex="-1"></a>    tree.setdefault(n, []).append({<span class="st">"n"</span>: k, <span class="st">"w"</span>: d2 <span class="op">-</span> x})</span>
<span id="cb227-62"><a href="#cb227-62" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb227-63"><a href="#cb227-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-64"><a href="#cb227-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> additive_phylogeny(distance_matrix: DistanceMatrix, m: <span class="bu">int</span>) <span class="op">-&gt;</span> Graph:</span>
<span id="cb227-65"><a href="#cb227-65" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(distance_matrix) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb227-66"><a href="#cb227-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">len</span>(distance_matrix) <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb227-67"><a href="#cb227-67" aria-hidden="true" tabindex="-1"></a>        graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb227-68"><a href="#cb227-68" aria-hidden="true" tabindex="-1"></a>        graph[<span class="dv">0</span>].append({<span class="st">"n"</span>: <span class="dv">1</span>, <span class="st">"w"</span>: distance_matrix[<span class="dv">0</span>][<span class="dv">1</span>]})</span>
<span id="cb227-69"><a href="#cb227-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> graph</span>
<span id="cb227-70"><a href="#cb227-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-71"><a href="#cb227-71" aria-hidden="true" tabindex="-1"></a>    limb_length <span class="op">=</span> calculate_limb_length(distance_matrix, n)</span>
<span id="cb227-72"><a href="#cb227-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb227-73"><a href="#cb227-73" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> j <span class="op">!=</span> n:</span>
<span id="cb227-74"><a href="#cb227-74" aria-hidden="true" tabindex="-1"></a>            distance_matrix[j][n] <span class="op">-=</span> limb_length</span>
<span id="cb227-75"><a href="#cb227-75" aria-hidden="true" tabindex="-1"></a>            distance_matrix[n][j] <span class="op">=</span> distance_matrix[j][n]</span>
<span id="cb227-76"><a href="#cb227-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-77"><a href="#cb227-77" aria-hidden="true" tabindex="-1"></a>    i, n, k <span class="op">=</span> find_leaves(distance_matrix, n)</span>
<span id="cb227-78"><a href="#cb227-78" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> distance_matrix[i][n]</span>
<span id="cb227-79"><a href="#cb227-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-80"><a href="#cb227-80" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Remove row n and column n from distance_matrix</span></span>
<span id="cb227-81"><a href="#cb227-81" aria-hidden="true" tabindex="-1"></a>    reduced_matrix <span class="op">=</span> [row[:n] <span class="op">+</span> row[n<span class="op">+</span><span class="dv">1</span>:] <span class="cf">for</span> row <span class="kw">in</span> distance_matrix[:n] <span class="op">+</span> distance_matrix[n<span class="op">+</span><span class="dv">1</span>:]]</span>
<span id="cb227-82"><a href="#cb227-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-83"><a href="#cb227-83" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> additive_phylogeny(reduced_matrix, m)</span>
<span id="cb227-84"><a href="#cb227-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-85"><a href="#cb227-85" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Label for new internal node</span></span>
<span id="cb227-86"><a href="#cb227-86" aria-hidden="true" tabindex="-1"></a>    v <span class="op">=</span> <span class="bu">max</span>(<span class="bu">max</span>(get_all_nodes(tree)), m <span class="op">-</span> <span class="dv">1</span>) <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb227-87"><a href="#cb227-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-88"><a href="#cb227-88" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Break an internal edge adding a new node (possibly) and add the new leaf node</span></span>
<span id="cb227-89"><a href="#cb227-89" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> add_node(tree, i, k, x, v)</span>
<span id="cb227-90"><a href="#cb227-90" aria-hidden="true" tabindex="-1"></a>    tree.setdefault(v, []).append({<span class="st">"n"</span>: n, <span class="st">"w"</span>: limb_length})</span>
<span id="cb227-91"><a href="#cb227-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb227-92"><a href="#cb227-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-93"><a href="#cb227-93" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_edges(graph: Graph) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb227-94"><a href="#cb227-94" aria-hidden="true" tabindex="-1"></a>    edges <span class="op">=</span> []</span>
<span id="cb227-95"><a href="#cb227-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">sorted</span>(graph):</span>
<span id="cb227-96"><a href="#cb227-96" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> v <span class="kw">in</span> graph[k]:</span>
<span id="cb227-97"><a href="#cb227-97" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>v[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>v[<span class="st">'w'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb227-98"><a href="#cb227-98" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>v[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>k<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>v[<span class="st">'w'</span>]<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb227-99"><a href="#cb227-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(edges)</span>
<span id="cb227-100"><a href="#cb227-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-101"><a href="#cb227-101" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample usage</span></span>
<span id="cb227-102"><a href="#cb227-102" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb227-103"><a href="#cb227-103" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb227-104"><a href="#cb227-104" aria-hidden="true" tabindex="-1"></a><span class="st">0   13  21  22</span></span>
<span id="cb227-105"><a href="#cb227-105" aria-hidden="true" tabindex="-1"></a><span class="st">13  0   12  13</span></span>
<span id="cb227-106"><a href="#cb227-106" aria-hidden="true" tabindex="-1"></a><span class="st">21  12  0   13</span></span>
<span id="cb227-107"><a href="#cb227-107" aria-hidden="true" tabindex="-1"></a><span class="st">22  13  13  0</span></span>
<span id="cb227-108"><a href="#cb227-108" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb227-109"><a href="#cb227-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb227-110"><a href="#cb227-110" aria-hidden="true" tabindex="-1"></a>n, <span class="op">*</span>distance_matrix_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb227-111"><a href="#cb227-111" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> parse_distance_matrix(distance_matrix_str)</span>
<span id="cb227-112"><a href="#cb227-112" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> additive_phylogeny(distance_matrix, <span class="bu">int</span>(n))</span>
<span id="cb227-113"><a href="#cb227-113" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> get_edges(graph):</span>
<span id="cb227-114"><a href="#cb227-114" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-upgma" class="level1" data-number="76">
<h1 data-number="76"><span class="header-section-number">76</span> Implement UPGMA</h1>
<p>UPGMA Problem. Construct the ultrametric tree resulting from UPGMA.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>&nbsp;followed by a space-delimited&nbsp;<em>n</em>&nbsp;x&nbsp;<em>n</em>&nbsp;distance matrix.</p>
<p>Return:&nbsp;An adjacency list for the ultrametric tree output by&nbsp;<strong>UPGMA</strong>. Weights should be accurate to three decimal places.</p>
<p><strong>Note on formatting</strong>: The adjacency list must have consecutive integer node labels starting from 0. The&nbsp;<em>n</em>&nbsp;leaves must be labeled 0, 1, …,&nbsp;<em>n</em>-1 in order of their appearance in the distance matrix. Labels for internal nodes may be labeled in any order but must start from&nbsp;<em>n</em>&nbsp;and increase consecutively.</p>
<section id="sample-dataset-76" class="level2" data-number="76.1">
<h2 data-number="76.1" class="anchored" data-anchor-id="sample-dataset-76"><span class="header-section-number">76.1</span> Sample Dataset</h2>
<pre><code>4
0   20  17  11
20  0   20  13
17  20  0   10
11  13  10  0</code></pre>
</section>
<section id="sample-output-76" class="level2" data-number="76.2">
<h2 data-number="76.2" class="anchored" data-anchor-id="sample-output-76"><span class="header-section-number">76.2</span> Sample Output</h2>
<pre><code>0-&gt;5:7.000
1-&gt;6:8.833
2-&gt;4:5.000
3-&gt;4:5.000
4-&gt;2:5.000
4-&gt;3:5.000
4-&gt;5:2.000
5-&gt;0:7.000
5-&gt;4:2.000
5-&gt;6:1.833
6-&gt;5:1.833
6-&gt;1:8.833</code></pre>
</section>
<section id="solution-76" class="level2" data-number="76.3">
<h2 data-number="76.3" class="anchored" data-anchor-id="solution-76"><span class="header-section-number">76.3</span> Solution</h2>
<div class="sourceCode" id="cb230"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb230-2"><a href="#cb230-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-3"><a href="#cb230-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_matrix(lines: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb230-4"><a href="#cb230-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Parse integer matrix from set of lines"""</span></span>
<span id="cb230-5"><a href="#cb230-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split()] <span class="cf">for</span> line <span class="kw">in</span> lines]</span>
<span id="cb230-6"><a href="#cb230-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-7"><a href="#cb230-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb230-8"><a href="#cb230-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb230-9"><a href="#cb230-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb230-10"><a href="#cb230-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-11"><a href="#cb230-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_edges(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb230-12"><a href="#cb230-12" aria-hidden="true" tabindex="-1"></a>    edges <span class="op">=</span> []</span>
<span id="cb230-13"><a href="#cb230-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> <span class="bu">sorted</span>(graph):</span>
<span id="cb230-14"><a href="#cb230-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> graph[source]:</span>
<span id="cb230-15"><a href="#cb230-15" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>source<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>target[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>target[<span class="st">'w'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb230-16"><a href="#cb230-16" aria-hidden="true" tabindex="-1"></a>            edges.append(<span class="ss">f"</span><span class="sc">{</span>target[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>source<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>target[<span class="st">'w'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb230-17"><a href="#cb230-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(edges)</span>
<span id="cb230-18"><a href="#cb230-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-19"><a href="#cb230-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> closest(distance_matrix: np.ndarray) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb230-20"><a href="#cb230-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find (first) minimum off diagonal index in an array"""</span></span>
<span id="cb230-21"><a href="#cb230-21" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb230-22"><a href="#cb230-22" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(distance_matrix, distance_matrix.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb230-23"><a href="#cb230-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">divmod</span>(distance_matrix.argmin(), distance_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb230-24"><a href="#cb230-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-25"><a href="#cb230-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> average_ind(distance_matrix: np.ndarray, i: <span class="bu">int</span>, j: <span class="bu">int</span>, size_i: <span class="bu">int</span>, size_j: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb230-26"><a href="#cb230-26" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Replace the ith row/col with the average of the ith and jth and remove the jth"""</span></span>
<span id="cb230-27"><a href="#cb230-27" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb230-28"><a href="#cb230-28" aria-hidden="true" tabindex="-1"></a>    average <span class="op">=</span> (distance_matrix[i, :] <span class="op">*</span> size_i <span class="op">+</span> distance_matrix[j, :] <span class="op">*</span> size_j) <span class="op">/</span> (size_i <span class="op">+</span> size_j)</span>
<span id="cb230-29"><a href="#cb230-29" aria-hidden="true" tabindex="-1"></a>    distance_matrix[i, :] <span class="op">=</span> average</span>
<span id="cb230-30"><a href="#cb230-30" aria-hidden="true" tabindex="-1"></a>    distance_matrix[:, i] <span class="op">=</span> average</span>
<span id="cb230-31"><a href="#cb230-31" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.delete(distance_matrix, j, <span class="dv">0</span>)</span>
<span id="cb230-32"><a href="#cb230-32" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.delete(distance_matrix, j, <span class="dv">1</span>)</span>
<span id="cb230-33"><a href="#cb230-33" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(distance_matrix, <span class="dv">0</span>)</span>
<span id="cb230-34"><a href="#cb230-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distance_matrix</span>
<span id="cb230-35"><a href="#cb230-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-36"><a href="#cb230-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> upgma(distance_matrix: np.ndarray, num_clusters: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb230-37"><a href="#cb230-37" aria-hidden="true" tabindex="-1"></a>    clusters <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">0</span>, num_clusters))</span>
<span id="cb230-38"><a href="#cb230-38" aria-hidden="true" tabindex="-1"></a>    ages: Dict[<span class="bu">int</span>, <span class="bu">float</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="dv">0</span>)  <span class="co"># the "age" of a node</span></span>
<span id="cb230-39"><a href="#cb230-39" aria-hidden="true" tabindex="-1"></a>    size: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="dv">1</span>)  <span class="co"># the number of descendants of a node</span></span>
<span id="cb230-40"><a href="#cb230-40" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]] <span class="op">=</span> {}  <span class="co"># the graph / tree we're building</span></span>
<span id="cb230-41"><a href="#cb230-41" aria-hidden="true" tabindex="-1"></a>    node_label <span class="op">=</span> num_clusters  <span class="co"># a label for internal nodes as we add them</span></span>
<span id="cb230-42"><a href="#cb230-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-43"><a href="#cb230-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(clusters) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb230-44"><a href="#cb230-44" aria-hidden="true" tabindex="-1"></a>        i, j <span class="op">=</span> closest(distance_matrix)</span>
<span id="cb230-45"><a href="#cb230-45" aria-hidden="true" tabindex="-1"></a>        a, b <span class="op">=</span> clusters[i], clusters[j]</span>
<span id="cb230-46"><a href="#cb230-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-47"><a href="#cb230-47" aria-hidden="true" tabindex="-1"></a>        tree[node_label] <span class="op">=</span> [</span>
<span id="cb230-48"><a href="#cb230-48" aria-hidden="true" tabindex="-1"></a>            {<span class="st">"n"</span>: a, <span class="st">"w"</span>: distance_matrix[i, j] <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> ages[a]},</span>
<span id="cb230-49"><a href="#cb230-49" aria-hidden="true" tabindex="-1"></a>            {<span class="st">"n"</span>: b, <span class="st">"w"</span>: distance_matrix[i, j] <span class="op">/</span> <span class="dv">2</span> <span class="op">-</span> ages[b]},</span>
<span id="cb230-50"><a href="#cb230-50" aria-hidden="true" tabindex="-1"></a>        ]</span>
<span id="cb230-51"><a href="#cb230-51" aria-hidden="true" tabindex="-1"></a>        size[node_label] <span class="op">=</span> size[a] <span class="op">+</span> size[b]</span>
<span id="cb230-52"><a href="#cb230-52" aria-hidden="true" tabindex="-1"></a>        ages[node_label] <span class="op">=</span> distance_matrix[i, j] <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb230-53"><a href="#cb230-53" aria-hidden="true" tabindex="-1"></a>        clusters[i] <span class="op">=</span> node_label</span>
<span id="cb230-54"><a href="#cb230-54" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> clusters[j]</span>
<span id="cb230-55"><a href="#cb230-55" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> average_ind(distance_matrix, <span class="op">*</span>closest(distance_matrix), size[a], size[b])</span>
<span id="cb230-56"><a href="#cb230-56" aria-hidden="true" tabindex="-1"></a>        node_label <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb230-57"><a href="#cb230-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-58"><a href="#cb230-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb230-59"><a href="#cb230-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-60"><a href="#cb230-60" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb230-61"><a href="#cb230-61" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb230-62"><a href="#cb230-62" aria-hidden="true" tabindex="-1"></a><span class="st">0   20  17  11</span></span>
<span id="cb230-63"><a href="#cb230-63" aria-hidden="true" tabindex="-1"></a><span class="st">20  0   20  13</span></span>
<span id="cb230-64"><a href="#cb230-64" aria-hidden="true" tabindex="-1"></a><span class="st">17  20  0   10</span></span>
<span id="cb230-65"><a href="#cb230-65" aria-hidden="true" tabindex="-1"></a><span class="st">11  13  10  0</span></span>
<span id="cb230-66"><a href="#cb230-66" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb230-67"><a href="#cb230-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-68"><a href="#cb230-68" aria-hidden="true" tabindex="-1"></a>num_clusters, <span class="op">*</span>distance_data <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb230-69"><a href="#cb230-69" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> np.array(parse_matrix(distance_data), <span class="bu">float</span>)</span>
<span id="cb230-70"><a href="#cb230-70" aria-hidden="true" tabindex="-1"></a>graph <span class="op">=</span> upgma(distance_matrix, <span class="bu">int</span>(num_clusters))</span>
<span id="cb230-71"><a href="#cb230-71" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> as_edges(graph):</span>
<span id="cb230-72"><a href="#cb230-72" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-neighbor-joining-algorithm" class="level1" data-number="77">
<h1 data-number="77"><span class="header-section-number">77</span> Implement the Neighbor Joining Algorithm</h1>
<p>Neighbor Joining Problem. Construct the tree resulting from applying the neighbor-joining algorithm to a distance matrix.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>, followed by a space-separated&nbsp;<em>n</em>&nbsp;x&nbsp;<em>n</em>&nbsp;distance matrix.</p>
<p>Return:&nbsp;An adjacency list for the tree resulting from applying the neighbor-joining algorithm. Edge-weights should be accurate to two decimal places (they are provided to three decimal places in the sample output below).</p>
<p><strong>Note on formatting</strong>: The adjacency list must have consecutive integer node labels starting from 0. The&nbsp;<em>n</em>&nbsp;leaves must be labeled&nbsp;<em>0, 1, …, n-1</em>&nbsp;in order of their appearance in the distance matrix. Labels for internal nodes may be labeled in any order but must start from&nbsp;<em>n</em>&nbsp;and increase consecutively.</p>
<section id="sample-dataset-77" class="level2" data-number="77.1">
<h2 data-number="77.1" class="anchored" data-anchor-id="sample-dataset-77"><span class="header-section-number">77.1</span> Sample Dataset</h2>
<pre><code>4
0   23  27  20
23  0   30  28
27  30  0   30
20  28  30  0</code></pre>
</section>
<section id="sample-output-77" class="level2" data-number="77.2">
<h2 data-number="77.2" class="anchored" data-anchor-id="sample-output-77"><span class="header-section-number">77.2</span> Sample Output</h2>
<pre><code>0-&gt;4:8.000
1-&gt;5:13.500
2-&gt;5:16.500
3-&gt;4:12.000
4-&gt;5:2.000
4-&gt;0:8.000
4-&gt;3:12.000
5-&gt;1:13.500
5-&gt;2:16.500
5-&gt;4:2.000</code></pre>
</section>
<section id="solution-77" class="level2" data-number="77.3">
<h2 data-number="77.3" class="anchored" data-anchor-id="solution-77"><span class="header-section-number">77.3</span> Solution</h2>
<div class="sourceCode" id="cb233"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb233-1"><a href="#cb233-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb233-2"><a href="#cb233-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Union</span>
<span id="cb233-3"><a href="#cb233-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb233-4"><a href="#cb233-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-5"><a href="#cb233-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_matrix(lines: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb233-6"><a href="#cb233-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Parse integer matrix from set of lines"""</span></span>
<span id="cb233-7"><a href="#cb233-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [[<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> line.split()] <span class="cf">for</span> line <span class="kw">in</span> lines]</span>
<span id="cb233-8"><a href="#cb233-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-9"><a href="#cb233-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_edges(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, Union[<span class="bu">int</span>, <span class="bu">float</span>]]]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb233-10"><a href="#cb233-10" aria-hidden="true" tabindex="-1"></a>    formatted_edges <span class="op">=</span> []</span>
<span id="cb233-11"><a href="#cb233-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">sorted</span>(tree):</span>
<span id="cb233-12"><a href="#cb233-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> neighbor <span class="kw">in</span> tree[node]:</span>
<span id="cb233-13"><a href="#cb233-13" aria-hidden="true" tabindex="-1"></a>            formatted_edges.append(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>neighbor[<span class="st">'node'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>neighbor[<span class="st">'weight'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb233-14"><a href="#cb233-14" aria-hidden="true" tabindex="-1"></a>            formatted_edges.append(<span class="ss">f"</span><span class="sc">{</span>neighbor[<span class="st">'node'</span>]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>neighbor[<span class="st">'weight'</span>]<span class="sc">:f}</span><span class="ss">"</span>)</span>
<span id="cb233-15"><a href="#cb233-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(formatted_edges)</span>
<span id="cb233-16"><a href="#cb233-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-17"><a href="#cb233-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_closest_pair(distance_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="bu">tuple</span>[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb233-18"><a href="#cb233-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Find (first) minimum off-diagonal index in an array"""</span></span>
<span id="cb233-19"><a href="#cb233-19" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb233-20"><a href="#cb233-20" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(temp_matrix, temp_matrix.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb233-21"><a href="#cb233-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">divmod</span>(temp_matrix.argmin(), temp_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb233-22"><a href="#cb233-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-23"><a href="#cb233-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_neighbor_joining_matrix(distance_matrix: np.ndarray, num_nodes: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb233-24"><a href="#cb233-24" aria-hidden="true" tabindex="-1"></a>    nj_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb233-25"><a href="#cb233-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb233-26"><a href="#cb233-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(distance_matrix)):</span>
<span id="cb233-27"><a href="#cb233-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> i <span class="op">!=</span> j:</span>
<span id="cb233-28"><a href="#cb233-28" aria-hidden="true" tabindex="-1"></a>                nj_matrix[i, j] <span class="op">=</span> (num_nodes <span class="op">-</span> <span class="dv">2</span>) <span class="op">*</span> distance_matrix[i, j] <span class="op">-</span> <span class="bu">sum</span>(distance_matrix[i, :]) <span class="op">-</span> <span class="bu">sum</span>(distance_matrix[j, :])</span>
<span id="cb233-29"><a href="#cb233-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> nj_matrix</span>
<span id="cb233-30"><a href="#cb233-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-31"><a href="#cb233-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> neighbor_joining(distance_matrix: np.ndarray, num_nodes: <span class="bu">int</span>, labels: List[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, Union[<span class="bu">int</span>, <span class="bu">float</span>]]]]:</span>
<span id="cb233-32"><a href="#cb233-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">not</span> labels:</span>
<span id="cb233-33"><a href="#cb233-33" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(num_nodes))</span>
<span id="cb233-34"><a href="#cb233-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-35"><a href="#cb233-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> num_nodes <span class="op">==</span> <span class="dv">2</span>:</span>
<span id="cb233-36"><a href="#cb233-36" aria-hidden="true" tabindex="-1"></a>        tree <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb233-37"><a href="#cb233-37" aria-hidden="true" tabindex="-1"></a>        tree[labels[<span class="dv">0</span>]].append({<span class="st">"node"</span>: labels[<span class="dv">1</span>], <span class="st">"weight"</span>: distance_matrix[<span class="dv">0</span>][<span class="dv">1</span>]})</span>
<span id="cb233-38"><a href="#cb233-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> tree</span>
<span id="cb233-39"><a href="#cb233-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-40"><a href="#cb233-40" aria-hidden="true" tabindex="-1"></a>    nj_matrix <span class="op">=</span> calculate_neighbor_joining_matrix(distance_matrix, num_nodes)</span>
<span id="cb233-41"><a href="#cb233-41" aria-hidden="true" tabindex="-1"></a>    i, j <span class="op">=</span> find_closest_pair(nj_matrix)</span>
<span id="cb233-42"><a href="#cb233-42" aria-hidden="true" tabindex="-1"></a>    delta <span class="op">=</span> (<span class="bu">sum</span>(distance_matrix[i, :]) <span class="op">-</span> <span class="bu">sum</span>(distance_matrix[j, :])) <span class="op">/</span> (num_nodes <span class="op">-</span> <span class="dv">2</span>)</span>
<span id="cb233-43"><a href="#cb233-43" aria-hidden="true" tabindex="-1"></a>    limb_i <span class="op">=</span> (distance_matrix[i, j] <span class="op">+</span> delta) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb233-44"><a href="#cb233-44" aria-hidden="true" tabindex="-1"></a>    limb_j <span class="op">=</span> (distance_matrix[i, j] <span class="op">-</span> delta) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb233-45"><a href="#cb233-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-46"><a href="#cb233-46" aria-hidden="true" tabindex="-1"></a>    label_i <span class="op">=</span> labels[i]</span>
<span id="cb233-47"><a href="#cb233-47" aria-hidden="true" tabindex="-1"></a>    label_j <span class="op">=</span> labels[j]</span>
<span id="cb233-48"><a href="#cb233-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-49"><a href="#cb233-49" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.append(distance_matrix, np.zeros((<span class="dv">1</span>, <span class="bu">len</span>(distance_matrix))), axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb233-50"><a href="#cb233-50" aria-hidden="true" tabindex="-1"></a>    distance_matrix <span class="op">=</span> np.append(distance_matrix, np.zeros((<span class="bu">len</span>(distance_matrix), <span class="dv">1</span>)), axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb233-51"><a href="#cb233-51" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> labels <span class="op">+</span> [<span class="bu">max</span>(labels) <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb233-52"><a href="#cb233-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-53"><a href="#cb233-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(num_nodes):</span>
<span id="cb233-54"><a href="#cb233-54" aria-hidden="true" tabindex="-1"></a>        distance_matrix[k, num_nodes] <span class="op">=</span> (distance_matrix[k, i] <span class="op">+</span> distance_matrix[k, j] <span class="op">-</span> distance_matrix[i, j]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb233-55"><a href="#cb233-55" aria-hidden="true" tabindex="-1"></a>        distance_matrix[num_nodes, k] <span class="op">=</span> (distance_matrix[k, i] <span class="op">+</span> distance_matrix[k, j] <span class="op">-</span> distance_matrix[i, j]) <span class="op">/</span> <span class="dv">2</span></span>
<span id="cb233-56"><a href="#cb233-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> x <span class="kw">in</span> [j, i]:</span>
<span id="cb233-57"><a href="#cb233-57" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> np.delete(distance_matrix, x, <span class="dv">0</span>)</span>
<span id="cb233-58"><a href="#cb233-58" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> np.delete(distance_matrix, x, <span class="dv">1</span>)</span>
<span id="cb233-59"><a href="#cb233-59" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> labels[x]</span>
<span id="cb233-60"><a href="#cb233-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-61"><a href="#cb233-61" aria-hidden="true" tabindex="-1"></a>    tree <span class="op">=</span> neighbor_joining(distance_matrix, num_nodes <span class="op">-</span> <span class="dv">1</span>, labels)</span>
<span id="cb233-62"><a href="#cb233-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-63"><a href="#cb233-63" aria-hidden="true" tabindex="-1"></a>    tree[labels[<span class="op">-</span><span class="dv">1</span>]].append({<span class="st">"node"</span>: label_i, <span class="st">"weight"</span>: limb_i})</span>
<span id="cb233-64"><a href="#cb233-64" aria-hidden="true" tabindex="-1"></a>    tree[labels[<span class="op">-</span><span class="dv">1</span>]].append({<span class="st">"node"</span>: label_j, <span class="st">"weight"</span>: limb_j})</span>
<span id="cb233-65"><a href="#cb233-65" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb233-66"><a href="#cb233-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-67"><a href="#cb233-67" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb233-68"><a href="#cb233-68" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb233-69"><a href="#cb233-69" aria-hidden="true" tabindex="-1"></a><span class="st">0   23  27  20</span></span>
<span id="cb233-70"><a href="#cb233-70" aria-hidden="true" tabindex="-1"></a><span class="st">23  0   30  28</span></span>
<span id="cb233-71"><a href="#cb233-71" aria-hidden="true" tabindex="-1"></a><span class="st">27  30  0   30</span></span>
<span id="cb233-72"><a href="#cb233-72" aria-hidden="true" tabindex="-1"></a><span class="st">20  28  30  0</span></span>
<span id="cb233-73"><a href="#cb233-73" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb233-74"><a href="#cb233-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb233-75"><a href="#cb233-75" aria-hidden="true" tabindex="-1"></a>num_nodes, <span class="op">*</span>distance_matrix <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb233-76"><a href="#cb233-76" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> np.array(parse_matrix(distance_matrix), <span class="bu">float</span>)</span>
<span id="cb233-77"><a href="#cb233-77" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> neighbor_joining(distance_matrix, <span class="bu">int</span>(num_nodes))</span>
<span id="cb233-78"><a href="#cb233-78" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> format_edges(tree):</span>
<span id="cb233-79"><a href="#cb233-79" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-smallparsimony" class="level1" data-number="78">
<h1 data-number="78"><span class="header-section-number">78</span> Implement SmallParsimony</h1>
<p>Small Parsimony Problem. Find the most parsimonious labeling of the internal nodes of a rooted tree.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>&nbsp;followed by an adjacency list for a rooted binary tree with&nbsp;<em>n</em>&nbsp;leaves labeled by DNA strings.</p>
<p>Return:&nbsp;The minimum parsimony score of this tree, followed by the adjacency list of the tree corresponding to labeling internal nodes by DNA strings in order to minimize the parsimony score of the tree.</p>
<p><strong>Note:</strong>&nbsp;Remember to run&nbsp;<strong>SmallParsimony</strong>&nbsp;on each individual index of the strings at the leaves of the tree.</p>
<section id="sample-dataset-78" class="level2" data-number="78.1">
<h2 data-number="78.1" class="anchored" data-anchor-id="sample-dataset-78"><span class="header-section-number">78.1</span> Sample Dataset</h2>
<pre><code>4
4-&gt;CAAATCCC
4-&gt;ATTGCGAC
5-&gt;CTGCGCTG
5-&gt;ATGGACGA
6-&gt;4
6-&gt;5</code></pre>
</section>
<section id="sample-output-78" class="level2" data-number="78.2">
<h2 data-number="78.2" class="anchored" data-anchor-id="sample-output-78"><span class="header-section-number">78.2</span> Sample Output</h2>
<pre><code>16
ATAGACAA-&gt;ATAGACAC:1
ATAGACAC-&gt;ATAGACAA:1
ATAGACAC-&gt;CAAATCCC:5
CAAATCCC-&gt;ATAGACAC:5
ATAGACAC-&gt;ATTGCGAC:3
ATTGCGAC-&gt;ATAGACAC:3
ATAGACAA-&gt;ATGGACAA:1
ATGGACAA-&gt;ATAGACAA:1
ATGGACAA-&gt;CTGCGCTG:5
CTGCGCTG-&gt;ATGGACAA:5
ATGGACAA-&gt;ATGGACGA:1
ATGGACGA-&gt;ATGGACAA:1</code></pre>
</section>
<section id="solution-78" class="level2" data-number="78.3">
<h2 data-number="78.3" class="anchored" data-anchor-id="solution-78"><span class="header-section-number">78.3</span> Solution</h2>
<div class="sourceCode" id="cb236"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="adapt-smallparsimony-to-unrooted-trees" class="level1" data-number="79">
<h1 data-number="79"><span class="header-section-number">79</span> Adapt SmallParsimony to Unrooted Trees</h1>
<p>Small Parsimony in an Unrooted Tree Problem. Find the most parsimonious labeling of the internal nodes in an unrooted tree.</p>
<p>Given:&nbsp;An unrooted binary tree with each leaf labeled by a string of length&nbsp;<em>m</em>.</p>
<p>Return:&nbsp;A labeling of all other nodes of the tree by strings of length&nbsp;<em>m</em>&nbsp;that minimizes the parsimony score of the tree.</p>
<p><strong>Note on formatting</strong>: Your internal node labelings may differ from the sample provided.</p>
<section id="sample-dataset-79" class="level2" data-number="79.1">
<h2 data-number="79.1" class="anchored" data-anchor-id="sample-dataset-79"><span class="header-section-number">79.1</span> Sample Dataset</h2>
<pre><code>4
TCGGCCAA-&gt;4
4-&gt;TCGGCCAA
CCTGGCTG-&gt;4
4-&gt;CCTGGCTG
CACAGGAT-&gt;5
5-&gt;CACAGGAT
TGAGTACC-&gt;5
5-&gt;TGAGTACC
4-&gt;5
5-&gt;4</code></pre>
</section>
<section id="sample-output-79" class="level2" data-number="79.2">
<h2 data-number="79.2" class="anchored" data-anchor-id="sample-output-79"><span class="header-section-number">79.2</span> Sample Output</h2>
<pre><code>17
TCGGCCAA-&gt;CCAGGCAC:4
CCTGGCTG-&gt;CCAGGCAC:3
TGAGTACC-&gt;CAAGGAAC:4
CCAGGCAC-&gt;CCTGGCTG:3
CCAGGCAC-&gt;CAAGGAAC:2
CCAGGCAC-&gt;TCGGCCAA:4
CACAGGAT-&gt;CAAGGAAC:4
CAAGGAAC-&gt;CACAGGAT:4
CAAGGAAC-&gt;TGAGTACC:4
CAAGGAAC-&gt;CCAGGCAC:2</code></pre>
</section>
<section id="solution-79" class="level2" data-number="79.3">
<h2 data-number="79.3" class="anchored" data-anchor-id="solution-79"><span class="header-section-number">79.3</span> Solution</h2>
<div class="sourceCode" id="cb239"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb239-2"><a href="#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb239-3"><a href="#cb239-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb239-4"><a href="#cb239-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-5"><a href="#cb239-5" aria-hidden="true" tabindex="-1"></a><span class="co"># return all nodes of a simple graph</span></span>
<span id="cb239-6"><a href="#cb239-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb239-7"><a href="#cb239-7" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="bu">list</span>(graph.keys())</span>
<span id="cb239-8"><a href="#cb239-8" aria-hidden="true" tabindex="-1"></a>    e <span class="op">=</span> [y <span class="cf">for</span> v <span class="kw">in</span> graph.values() <span class="cf">for</span> y <span class="kw">in</span> v]</span>
<span id="cb239-9"><a href="#cb239-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(s) <span class="op">|</span> <span class="bu">set</span>(e)</span>
<span id="cb239-10"><a href="#cb239-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-11"><a href="#cb239-11" aria-hidden="true" tabindex="-1"></a><span class="co"># return all leaves of a simple graph</span></span>
<span id="cb239-12"><a href="#cb239-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaves(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb239-13"><a href="#cb239-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(y <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">list</span>(graph.values()) <span class="cf">for</span> y <span class="kw">in</span> v <span class="cf">if</span> <span class="kw">not</span> graph[y])</span>
<span id="cb239-14"><a href="#cb239-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-15"><a href="#cb239-15" aria-hidden="true" tabindex="-1"></a><span class="co"># return all root node of a simple graph</span></span>
<span id="cb239-16"><a href="#cb239-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> root(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb239-17"><a href="#cb239-17" aria-hidden="true" tabindex="-1"></a>    rev <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb239-18"><a href="#cb239-18" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> <span class="bu">list</span>(nodes(graph))[<span class="dv">0</span>]</span>
<span id="cb239-19"><a href="#cb239-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="kw">in</span> rev:</span>
<span id="cb239-20"><a href="#cb239-20" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> rev[node]</span>
<span id="cb239-21"><a href="#cb239-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node</span>
<span id="cb239-22"><a href="#cb239-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-23"><a href="#cb239-23" aria-hidden="true" tabindex="-1"></a><span class="co"># reverse a simple graph (child points to parent)</span></span>
<span id="cb239-24"><a href="#cb239-24" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb239-25"><a href="#cb239-25" aria-hidden="true" tabindex="-1"></a>    rev: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb239-26"><a href="#cb239-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> graph:</span>
<span id="cb239-27"><a href="#cb239-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb239-28"><a href="#cb239-28" aria-hidden="true" tabindex="-1"></a>            rev[child] <span class="op">=</span> node</span>
<span id="cb239-29"><a href="#cb239-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rev</span>
<span id="cb239-30"><a href="#cb239-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-31"><a href="#cb239-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_string: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">int</span>, <span class="bu">str</span>], Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]:</span>
<span id="cb239-32"><a href="#cb239-32" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> input_string.strip().split(<span class="st">'</span><span class="ch">\n</span><span class="st">'</span>)</span>
<span id="cb239-33"><a href="#cb239-33" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">0</span>])</span>
<span id="cb239-34"><a href="#cb239-34" aria-hidden="true" tabindex="-1"></a>    seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb239-35"><a href="#cb239-35" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb239-36"><a href="#cb239-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, edge <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:n<span class="op">+</span><span class="dv">1</span>]):</span>
<span id="cb239-37"><a href="#cb239-37" aria-hidden="true" tabindex="-1"></a>        f, t <span class="op">=</span> edge.rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb239-38"><a href="#cb239-38" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(f)].append(i)</span>
<span id="cb239-39"><a href="#cb239-39" aria-hidden="true" tabindex="-1"></a>        seqs[i] <span class="op">=</span> t</span>
<span id="cb239-40"><a href="#cb239-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> lines[n<span class="op">+</span><span class="dv">1</span>:]:</span>
<span id="cb239-41"><a href="#cb239-41" aria-hidden="true" tabindex="-1"></a>        f, t <span class="op">=</span> edge.rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb239-42"><a href="#cb239-42" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(f)].append(<span class="bu">int</span>(t))</span>
<span id="cb239-43"><a href="#cb239-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seqs, graph</span>
<span id="cb239-44"><a href="#cb239-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-45"><a href="#cb239-45" aria-hidden="true" tabindex="-1"></a><span class="co"># print (bidirectional) edges</span></span>
<span id="cb239-46"><a href="#cb239-46" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_edges(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>], node: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb239-47"><a href="#cb239-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb239-48"><a href="#cb239-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">in</span> seqs <span class="kw">and</span> child <span class="kw">in</span> seqs:</span>
<span id="cb239-49"><a href="#cb239-49" aria-hidden="true" tabindex="-1"></a>            dist <span class="op">=</span> <span class="bu">sum</span>(a <span class="op">!=</span> b <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(seqs[node], seqs[child]))</span>
<span id="cb239-50"><a href="#cb239-50" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>seqs[node]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>seqs[child]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>dist<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb239-51"><a href="#cb239-51" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>seqs[child]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>seqs[node]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>dist<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb239-52"><a href="#cb239-52" aria-hidden="true" tabindex="-1"></a>        print_edges(graph, seqs, child)</span>
<span id="cb239-53"><a href="#cb239-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-54"><a href="#cb239-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_position(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>], pos: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb239-55"><a href="#cb239-55" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb239-56"><a href="#cb239-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> nodes(graph) <span class="op">-</span> leaves(graph):</span>
<span id="cb239-57"><a href="#cb239-57" aria-hidden="true" tabindex="-1"></a>        chars[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb239-58"><a href="#cb239-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves(graph):</span>
<span id="cb239-59"><a href="#cb239-59" aria-hidden="true" tabindex="-1"></a>        chars[leaf] <span class="op">=</span> seqs[leaf][pos]</span>
<span id="cb239-60"><a href="#cb239-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb239-61"><a href="#cb239-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-62"><a href="#cb239-62" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> traceback(skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]], node: <span class="bu">int</span>, ind: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb239-63"><a href="#cb239-63" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb239-64"><a href="#cb239-64" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb239-65"><a href="#cb239-65" aria-hidden="true" tabindex="-1"></a>    chars[node] <span class="op">=</span> bases[ind]</span>
<span id="cb239-66"><a href="#cb239-66" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> skp[node][ind].items():</span>
<span id="cb239-67"><a href="#cb239-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> k <span class="kw">in</span> skp:</span>
<span id="cb239-68"><a href="#cb239-68" aria-hidden="true" tabindex="-1"></a>            chars <span class="op">=</span> chars <span class="op">|</span> traceback(skp, k, v)</span>
<span id="cb239-69"><a href="#cb239-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb239-70"><a href="#cb239-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-71"><a href="#cb239-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> small_parsimony(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb239-72"><a href="#cb239-72" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb239-73"><a href="#cb239-73" aria-hidden="true" tabindex="-1"></a>    sk: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}  <span class="co"># minimum parsimony score of the subtree over possible labels</span></span>
<span id="cb239-74"><a href="#cb239-74" aria-hidden="true" tabindex="-1"></a>    skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]] <span class="op">=</span> {}  <span class="co"># pointer to selected base for each child over possible labels</span></span>
<span id="cb239-75"><a href="#cb239-75" aria-hidden="true" tabindex="-1"></a>    to_process <span class="op">=</span> nodes(graph)</span>
<span id="cb239-76"><a href="#cb239-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-77"><a href="#cb239-77" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialise leaves</span></span>
<span id="cb239-78"><a href="#cb239-78" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves(graph):</span>
<span id="cb239-79"><a href="#cb239-79" aria-hidden="true" tabindex="-1"></a>        sk[leaf] <span class="op">=</span> [<span class="dv">0</span> <span class="cf">if</span> chars[leaf] <span class="op">==</span> c <span class="cf">else</span> inf <span class="cf">for</span> c <span class="kw">in</span> bases]</span>
<span id="cb239-80"><a href="#cb239-80" aria-hidden="true" tabindex="-1"></a>        to_process.remove(leaf)</span>
<span id="cb239-81"><a href="#cb239-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-82"><a href="#cb239-82" aria-hidden="true" tabindex="-1"></a>    <span class="co"># iterate over available nodes till all are processed</span></span>
<span id="cb239-83"><a href="#cb239-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> to_process:</span>
<span id="cb239-84"><a href="#cb239-84" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">list</span>(to_process):</span>
<span id="cb239-85"><a href="#cb239-85" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(v <span class="kw">in</span> sk <span class="cf">for</span> v <span class="kw">in</span> graph[n]):</span>
<span id="cb239-86"><a href="#cb239-86" aria-hidden="true" tabindex="-1"></a>                sk[n], skp[n] <span class="op">=</span> [], []</span>
<span id="cb239-87"><a href="#cb239-87" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> bases:</span>
<span id="cb239-88"><a href="#cb239-88" aria-hidden="true" tabindex="-1"></a>                    tot <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb239-89"><a href="#cb239-89" aria-hidden="true" tabindex="-1"></a>                    ptr: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb239-90"><a href="#cb239-90" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> d, sk_child <span class="kw">in</span> [(d, sk[d]) <span class="cf">for</span> d <span class="kw">in</span> graph[n]]:</span>
<span id="cb239-91"><a href="#cb239-91" aria-hidden="true" tabindex="-1"></a>                        score <span class="op">=</span> []</span>
<span id="cb239-92"><a href="#cb239-92" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(bases):</span>
<span id="cb239-93"><a href="#cb239-93" aria-hidden="true" tabindex="-1"></a>                            score <span class="op">+=</span> [sk_child[i] <span class="op">+</span> (<span class="dv">0</span> <span class="cf">if</span> c <span class="op">==</span> k <span class="cf">else</span> <span class="dv">1</span>)]</span>
<span id="cb239-94"><a href="#cb239-94" aria-hidden="true" tabindex="-1"></a>                        tot <span class="op">+=</span> <span class="bu">min</span>(score)</span>
<span id="cb239-95"><a href="#cb239-95" aria-hidden="true" tabindex="-1"></a>                        ptr[d] <span class="op">=</span> score.index(<span class="bu">min</span>(score))</span>
<span id="cb239-96"><a href="#cb239-96" aria-hidden="true" tabindex="-1"></a>                    skp[n] <span class="op">+=</span> [ptr]</span>
<span id="cb239-97"><a href="#cb239-97" aria-hidden="true" tabindex="-1"></a>                    sk[n] <span class="op">+=</span> [tot]</span>
<span id="cb239-98"><a href="#cb239-98" aria-hidden="true" tabindex="-1"></a>                to_process.remove(n)</span>
<span id="cb239-99"><a href="#cb239-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-100"><a href="#cb239-100" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Recover sequence</span></span>
<span id="cb239-101"><a href="#cb239-101" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> root(graph)</span>
<span id="cb239-102"><a href="#cb239-102" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> <span class="bu">min</span>(sk[node])</span>
<span id="cb239-103"><a href="#cb239-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score, traceback(skp, node, sk[node].index(score))</span>
<span id="cb239-104"><a href="#cb239-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-105"><a href="#cb239-105" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6f(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], seqs: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb239-106"><a href="#cb239-106" aria-hidden="true" tabindex="-1"></a>    <span class="co"># initialise sequences</span></span>
<span id="cb239-107"><a href="#cb239-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> nodes(graph) <span class="op">-</span> leaves(graph):</span>
<span id="cb239-108"><a href="#cb239-108" aria-hidden="true" tabindex="-1"></a>        seqs[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb239-109"><a href="#cb239-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-110"><a href="#cb239-110" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb239-111"><a href="#cb239-111" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pos <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="bu">next</span>(<span class="bu">iter</span>(seqs.values())))):</span>
<span id="cb239-112"><a href="#cb239-112" aria-hidden="true" tabindex="-1"></a>        chars <span class="op">=</span> extract_position(graph, seqs, pos)</span>
<span id="cb239-113"><a href="#cb239-113" aria-hidden="true" tabindex="-1"></a>        score, tbchars <span class="op">=</span> small_parsimony(graph, chars)</span>
<span id="cb239-114"><a href="#cb239-114" aria-hidden="true" tabindex="-1"></a>        total_score <span class="op">+=</span> score</span>
<span id="cb239-115"><a href="#cb239-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k, v <span class="kw">in</span> tbchars.items():</span>
<span id="cb239-116"><a href="#cb239-116" aria-hidden="true" tabindex="-1"></a>            seqs[k] <span class="op">+=</span> v</span>
<span id="cb239-117"><a href="#cb239-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-118"><a href="#cb239-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_score, seqs</span>
<span id="cb239-119"><a href="#cb239-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-120"><a href="#cb239-120" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb239-121"><a href="#cb239-121" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb239-122"><a href="#cb239-122" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;CAAATCCC</span></span>
<span id="cb239-123"><a href="#cb239-123" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;ATTGCGAC</span></span>
<span id="cb239-124"><a href="#cb239-124" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;CTGCGCTG</span></span>
<span id="cb239-125"><a href="#cb239-125" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;ATGGACGA</span></span>
<span id="cb239-126"><a href="#cb239-126" aria-hidden="true" tabindex="-1"></a><span class="st">6-&gt;4</span></span>
<span id="cb239-127"><a href="#cb239-127" aria-hidden="true" tabindex="-1"></a><span class="st">6-&gt;5</span></span>
<span id="cb239-128"><a href="#cb239-128" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb239-129"><a href="#cb239-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-130"><a href="#cb239-130" aria-hidden="true" tabindex="-1"></a>seqs, graph <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb239-131"><a href="#cb239-131" aria-hidden="true" tabindex="-1"></a>total_score, seqs <span class="op">=</span> ba6f(graph, seqs)</span>
<span id="cb239-132"><a href="#cb239-132" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(total_score)</span>
<span id="cb239-133"><a href="#cb239-133" aria-hidden="true" tabindex="-1"></a>print_edges(graph, seqs, root(graph))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="adapt-smallparsimony-to-unrooted-trees-1" class="level1" data-number="80">
<h1 data-number="80"><span class="header-section-number">80</span> Adapt SmallParsimony to Unrooted Trees</h1>
<p>Small Parsimony in an Unrooted Tree Problem. Find the most parsimonious labeling of the internal nodes in an unrooted tree.</p>
<p>Given:&nbsp;An unrooted binary tree with each leaf labeled by a string of length&nbsp;<em>m</em>.</p>
<p>Return:&nbsp;A labeling of all other nodes of the tree by strings of length&nbsp;<em>m</em>&nbsp;that minimizes the parsimony score of the tree.</p>
<p><strong>Note on formatting</strong>: Your internal node labelings may differ from the sample provided.</p>
<section id="sample-dataset-80" class="level2" data-number="80.1">
<h2 data-number="80.1" class="anchored" data-anchor-id="sample-dataset-80"><span class="header-section-number">80.1</span> Sample Dataset</h2>
<pre><code>4
TCGGCCAA-&gt;4
4-&gt;TCGGCCAA
CCTGGCTG-&gt;4
4-&gt;CCTGGCTG
CACAGGAT-&gt;5
5-&gt;CACAGGAT
TGAGTACC-&gt;5
5-&gt;TGAGTACC
4-&gt;5
5-&gt;4</code></pre>
</section>
<section id="sample-output-80" class="level2" data-number="80.2">
<h2 data-number="80.2" class="anchored" data-anchor-id="sample-output-80"><span class="header-section-number">80.2</span> Sample Output</h2>
<pre><code>17
TCGGCCAA-&gt;CCAGGCAC:4
CCTGGCTG-&gt;CCAGGCAC:3
TGAGTACC-&gt;CAAGGAAC:4
CCAGGCAC-&gt;CCTGGCTG:3
CCAGGCAC-&gt;CAAGGAAC:2
CCAGGCAC-&gt;TCGGCCAA:4
CACAGGAT-&gt;CAAGGAAC:4
CAAGGAAC-&gt;CACAGGAT:4
CAAGGAAC-&gt;TGAGTACC:4
CAAGGAAC-&gt;CCAGGCAC:2</code></pre>
</section>
<section id="solution-80" class="level2" data-number="80.3">
<h2 data-number="80.3" class="anchored" data-anchor-id="solution-80"><span class="header-section-number">80.3</span> Solution</h2>
<div class="sourceCode" id="cb242"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb242-1"><a href="#cb242-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb242-2"><a href="#cb242-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple, TextIO</span>
<span id="cb242-3"><a href="#cb242-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb242-4"><a href="#cb242-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf</span>
<span id="cb242-5"><a href="#cb242-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-6"><a href="#cb242-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb242-7"><a href="#cb242-7" aria-hidden="true" tabindex="-1"></a>    s <span class="op">=</span> <span class="bu">list</span>(graph.keys())</span>
<span id="cb242-8"><a href="#cb242-8" aria-hidden="true" tabindex="-1"></a>    e <span class="op">=</span> [y <span class="cf">for</span> v <span class="kw">in</span> graph.values() <span class="cf">for</span> y <span class="kw">in</span> v]</span>
<span id="cb242-9"><a href="#cb242-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(s) <span class="op">|</span> <span class="bu">set</span>(e)</span>
<span id="cb242-10"><a href="#cb242-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-11"><a href="#cb242-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> leaves(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb242-12"><a href="#cb242-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">set</span>(y <span class="cf">for</span> v <span class="kw">in</span> <span class="bu">list</span>(graph.values()) <span class="cf">for</span> y <span class="kw">in</span> v <span class="cf">if</span> <span class="kw">not</span> graph[y])</span>
<span id="cb242-13"><a href="#cb242-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-14"><a href="#cb242-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> root(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb242-15"><a href="#cb242-15" aria-hidden="true" tabindex="-1"></a>    rev <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb242-16"><a href="#cb242-16" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> <span class="bu">list</span>(nodes(graph))[<span class="dv">0</span>]</span>
<span id="cb242-17"><a href="#cb242-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="kw">in</span> rev:</span>
<span id="cb242-18"><a href="#cb242-18" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> rev[node]</span>
<span id="cb242-19"><a href="#cb242-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node</span>
<span id="cb242-20"><a href="#cb242-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-21"><a href="#cb242-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_all_nodes(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb242-22"><a href="#cb242-22" aria-hidden="true" tabindex="-1"></a>    source_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb242-23"><a href="#cb242-23" aria-hidden="true" tabindex="-1"></a>    target_nodes <span class="op">=</span> {target <span class="cf">for</span> targets <span class="kw">in</span> graph.values() <span class="cf">for</span> target <span class="kw">in</span> targets}</span>
<span id="cb242-24"><a href="#cb242-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> source_nodes <span class="op">|</span> target_nodes</span>
<span id="cb242-25"><a href="#cb242-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-26"><a href="#cb242-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb242-27"><a href="#cb242-27" aria-hidden="true" tabindex="-1"></a>    reversed_graph: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb242-28"><a href="#cb242-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parent, children <span class="kw">in</span> graph.items():</span>
<span id="cb242-29"><a href="#cb242-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> children:</span>
<span id="cb242-30"><a href="#cb242-30" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child] <span class="op">=</span> parent</span>
<span id="cb242-31"><a href="#cb242-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb242-32"><a href="#cb242-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-33"><a href="#cb242-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_leaves(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb242-34"><a href="#cb242-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {child <span class="cf">for</span> children <span class="kw">in</span> graph.values() <span class="cf">for</span> child <span class="kw">in</span> children <span class="cf">if</span> <span class="kw">not</span> graph[child]}</span>
<span id="cb242-35"><a href="#cb242-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-36"><a href="#cb242-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_root(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb242-37"><a href="#cb242-37" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph(graph)</span>
<span id="cb242-38"><a href="#cb242-38" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> <span class="bu">next</span>(<span class="bu">iter</span>(get_all_nodes(graph)))</span>
<span id="cb242-39"><a href="#cb242-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="kw">in</span> reversed_graph:</span>
<span id="cb242-40"><a href="#cb242-40" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> reversed_graph[node]</span>
<span id="cb242-41"><a href="#cb242-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node</span>
<span id="cb242-42"><a href="#cb242-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-43"><a href="#cb242-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_edges(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>], node: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb242-44"><a href="#cb242-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb242-45"><a href="#cb242-45" aria-hidden="true" tabindex="-1"></a>        distance <span class="op">=</span> <span class="bu">sum</span>(a <span class="op">!=</span> b <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(sequences[node], sequences[child]))</span>
<span id="cb242-46"><a href="#cb242-46" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>sequences[node]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>sequences[child]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>distance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb242-47"><a href="#cb242-47" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>sequences[child]<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>sequences[node]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>distance<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb242-48"><a href="#cb242-48" aria-hidden="true" tabindex="-1"></a>        print_edges(graph, sequences, child)</span>
<span id="cb242-49"><a href="#cb242-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-50"><a href="#cb242-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> root_tree(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb242-51"><a href="#cb242-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> child <span class="kw">in</span> graph[node]:</span>
<span id="cb242-52"><a href="#cb242-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> node <span class="kw">in</span> graph[child]:</span>
<span id="cb242-53"><a href="#cb242-53" aria-hidden="true" tabindex="-1"></a>            graph[child].remove(node)</span>
<span id="cb242-54"><a href="#cb242-54" aria-hidden="true" tabindex="-1"></a>        root_tree(graph, child)</span>
<span id="cb242-55"><a href="#cb242-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-56"><a href="#cb242-56" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: TextIO) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">int</span>, <span class="bu">str</span>], Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]]]:</span>
<span id="cb242-57"><a href="#cb242-57" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle))</span>
<span id="cb242-58"><a href="#cb242-58" aria-hidden="true" tabindex="-1"></a>    sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb242-59"><a href="#cb242-59" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb242-60"><a href="#cb242-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb242-61"><a href="#cb242-61" aria-hidden="true" tabindex="-1"></a>        <span class="bu">next</span>(handle)</span>
<span id="cb242-62"><a href="#cb242-62" aria-hidden="true" tabindex="-1"></a>        from_node, to_seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb242-63"><a href="#cb242-63" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(from_node)].append(i)</span>
<span id="cb242-64"><a href="#cb242-64" aria-hidden="true" tabindex="-1"></a>        sequences[i] <span class="op">=</span> to_seq</span>
<span id="cb242-65"><a href="#cb242-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-66"><a href="#cb242-66" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> handle.readlines()</span>
<span id="cb242-67"><a href="#cb242-67" aria-hidden="true" tabindex="-1"></a>    root <span class="op">=</span> <span class="bu">int</span>(lines[<span class="dv">0</span>].rstrip().split(<span class="st">"-&gt;"</span>)[<span class="dv">0</span>])</span>
<span id="cb242-68"><a href="#cb242-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> lines:</span>
<span id="cb242-69"><a href="#cb242-69" aria-hidden="true" tabindex="-1"></a>        from_node, to_node <span class="op">=</span> edge.rstrip().split(<span class="st">"-&gt;"</span>)</span>
<span id="cb242-70"><a href="#cb242-70" aria-hidden="true" tabindex="-1"></a>        graph[<span class="bu">int</span>(from_node)].append(<span class="bu">int</span>(to_node))</span>
<span id="cb242-71"><a href="#cb242-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-72"><a href="#cb242-72" aria-hidden="true" tabindex="-1"></a>    root_tree(graph, root)</span>
<span id="cb242-73"><a href="#cb242-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequences, graph</span>
<span id="cb242-74"><a href="#cb242-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-75"><a href="#cb242-75" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> extract_position(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>], pos: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb242-76"><a href="#cb242-76" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb242-77"><a href="#cb242-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> get_all_nodes(graph) <span class="op">-</span> get_leaves(graph):</span>
<span id="cb242-78"><a href="#cb242-78" aria-hidden="true" tabindex="-1"></a>        chars[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb242-79"><a href="#cb242-79" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> get_leaves(graph):</span>
<span id="cb242-80"><a href="#cb242-80" aria-hidden="true" tabindex="-1"></a>        chars[leaf] <span class="op">=</span> sequences[leaf][pos]</span>
<span id="cb242-81"><a href="#cb242-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb242-82"><a href="#cb242-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-83"><a href="#cb242-83" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> ba6f(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], sequences: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb242-84"><a href="#cb242-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> n <span class="kw">in</span> get_all_nodes(graph) <span class="op">-</span> get_leaves(graph):</span>
<span id="cb242-85"><a href="#cb242-85" aria-hidden="true" tabindex="-1"></a>        sequences[n] <span class="op">=</span> <span class="st">""</span></span>
<span id="cb242-86"><a href="#cb242-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-87"><a href="#cb242-87" aria-hidden="true" tabindex="-1"></a>    total_score <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb242-88"><a href="#cb242-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pos <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(<span class="bu">next</span>(<span class="bu">iter</span>(sequences.values())))):</span>
<span id="cb242-89"><a href="#cb242-89" aria-hidden="true" tabindex="-1"></a>        chars <span class="op">=</span> extract_position(graph, sequences, pos)</span>
<span id="cb242-90"><a href="#cb242-90" aria-hidden="true" tabindex="-1"></a>        score, tbchars <span class="op">=</span> small_parsimony(graph, chars)</span>
<span id="cb242-91"><a href="#cb242-91" aria-hidden="true" tabindex="-1"></a>        total_score <span class="op">+=</span> score</span>
<span id="cb242-92"><a href="#cb242-92" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> k, v <span class="kw">in</span> tbchars.items():</span>
<span id="cb242-93"><a href="#cb242-93" aria-hidden="true" tabindex="-1"></a>            sequences[k] <span class="op">+=</span> v</span>
<span id="cb242-94"><a href="#cb242-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-95"><a href="#cb242-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> total_score, sequences</span>
<span id="cb242-96"><a href="#cb242-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-97"><a href="#cb242-97" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> small_parsimony(graph: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">str</span>]]:</span>
<span id="cb242-98"><a href="#cb242-98" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb242-99"><a href="#cb242-99" aria-hidden="true" tabindex="-1"></a>    sk: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb242-100"><a href="#cb242-100" aria-hidden="true" tabindex="-1"></a>    skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]] <span class="op">=</span> {}</span>
<span id="cb242-101"><a href="#cb242-101" aria-hidden="true" tabindex="-1"></a>    to_process <span class="op">=</span> nodes(graph)</span>
<span id="cb242-102"><a href="#cb242-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-103"><a href="#cb242-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> leaves(graph):</span>
<span id="cb242-104"><a href="#cb242-104" aria-hidden="true" tabindex="-1"></a>        sk[leaf] <span class="op">=</span> [<span class="dv">0</span> <span class="cf">if</span> chars[leaf] <span class="op">==</span> c <span class="cf">else</span> inf <span class="cf">for</span> c <span class="kw">in</span> bases]</span>
<span id="cb242-105"><a href="#cb242-105" aria-hidden="true" tabindex="-1"></a>        to_process.remove(leaf)</span>
<span id="cb242-106"><a href="#cb242-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-107"><a href="#cb242-107" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> to_process:</span>
<span id="cb242-108"><a href="#cb242-108" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">list</span>(to_process):</span>
<span id="cb242-109"><a href="#cb242-109" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(v <span class="kw">in</span> sk <span class="cf">for</span> v <span class="kw">in</span> graph[n]):</span>
<span id="cb242-110"><a href="#cb242-110" aria-hidden="true" tabindex="-1"></a>                sk[n], skp[n] <span class="op">=</span> [], []</span>
<span id="cb242-111"><a href="#cb242-111" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k <span class="kw">in</span> bases:</span>
<span id="cb242-112"><a href="#cb242-112" aria-hidden="true" tabindex="-1"></a>                    tot <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb242-113"><a href="#cb242-113" aria-hidden="true" tabindex="-1"></a>                    ptr: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb242-114"><a href="#cb242-114" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> d, sk_child <span class="kw">in</span> [(d, sk[d]) <span class="cf">for</span> d <span class="kw">in</span> graph[n]]:</span>
<span id="cb242-115"><a href="#cb242-115" aria-hidden="true" tabindex="-1"></a>                        score <span class="op">=</span> []</span>
<span id="cb242-116"><a href="#cb242-116" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> i, c <span class="kw">in</span> <span class="bu">enumerate</span>(bases):</span>
<span id="cb242-117"><a href="#cb242-117" aria-hidden="true" tabindex="-1"></a>                            score <span class="op">+=</span> [sk_child[i] <span class="op">+</span> (<span class="dv">0</span> <span class="cf">if</span> c <span class="op">==</span> k <span class="cf">else</span> <span class="dv">1</span>)]</span>
<span id="cb242-118"><a href="#cb242-118" aria-hidden="true" tabindex="-1"></a>                        tot <span class="op">+=</span> <span class="bu">min</span>(score)</span>
<span id="cb242-119"><a href="#cb242-119" aria-hidden="true" tabindex="-1"></a>                        ptr[d] <span class="op">=</span> score.index(<span class="bu">min</span>(score))</span>
<span id="cb242-120"><a href="#cb242-120" aria-hidden="true" tabindex="-1"></a>                    skp[n] <span class="op">+=</span> [ptr]</span>
<span id="cb242-121"><a href="#cb242-121" aria-hidden="true" tabindex="-1"></a>                    sk[n] <span class="op">+=</span> [tot]</span>
<span id="cb242-122"><a href="#cb242-122" aria-hidden="true" tabindex="-1"></a>                to_process.remove(n)</span>
<span id="cb242-123"><a href="#cb242-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-124"><a href="#cb242-124" aria-hidden="true" tabindex="-1"></a>    node <span class="op">=</span> root(graph)</span>
<span id="cb242-125"><a href="#cb242-125" aria-hidden="true" tabindex="-1"></a>    score <span class="op">=</span> <span class="bu">min</span>(sk[node])</span>
<span id="cb242-126"><a href="#cb242-126" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> score, traceback(skp, node, sk[node].index(score))</span>
<span id="cb242-127"><a href="#cb242-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-128"><a href="#cb242-128" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> traceback(skp: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">int</span>, <span class="bu">int</span>]]], node: <span class="bu">int</span>, ind: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb242-129"><a href="#cb242-129" aria-hidden="true" tabindex="-1"></a>    bases <span class="op">=</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"T"</span>, <span class="st">"G"</span>]</span>
<span id="cb242-130"><a href="#cb242-130" aria-hidden="true" tabindex="-1"></a>    chars: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {}</span>
<span id="cb242-131"><a href="#cb242-131" aria-hidden="true" tabindex="-1"></a>    chars[node] <span class="op">=</span> bases[ind]</span>
<span id="cb242-132"><a href="#cb242-132" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> k, v <span class="kw">in</span> skp[node][ind].items():</span>
<span id="cb242-133"><a href="#cb242-133" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> k <span class="kw">in</span> skp:</span>
<span id="cb242-134"><a href="#cb242-134" aria-hidden="true" tabindex="-1"></a>            chars <span class="op">=</span> chars <span class="op">|</span> traceback(skp, k, v)</span>
<span id="cb242-135"><a href="#cb242-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> chars</span>
<span id="cb242-136"><a href="#cb242-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-137"><a href="#cb242-137" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb242-138"><a href="#cb242-138" aria-hidden="true" tabindex="-1"></a><span class="st">4</span></span>
<span id="cb242-139"><a href="#cb242-139" aria-hidden="true" tabindex="-1"></a><span class="st">TCGGCCAA-&gt;4</span></span>
<span id="cb242-140"><a href="#cb242-140" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;TCGGCCAA</span></span>
<span id="cb242-141"><a href="#cb242-141" aria-hidden="true" tabindex="-1"></a><span class="st">CCTGGCTG-&gt;4</span></span>
<span id="cb242-142"><a href="#cb242-142" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;CCTGGCTG</span></span>
<span id="cb242-143"><a href="#cb242-143" aria-hidden="true" tabindex="-1"></a><span class="st">CACAGGAT-&gt;5</span></span>
<span id="cb242-144"><a href="#cb242-144" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;CACAGGAT</span></span>
<span id="cb242-145"><a href="#cb242-145" aria-hidden="true" tabindex="-1"></a><span class="st">TGAGTACC-&gt;5</span></span>
<span id="cb242-146"><a href="#cb242-146" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;TGAGTACC</span></span>
<span id="cb242-147"><a href="#cb242-147" aria-hidden="true" tabindex="-1"></a><span class="st">4-&gt;5</span></span>
<span id="cb242-148"><a href="#cb242-148" aria-hidden="true" tabindex="-1"></a><span class="st">5-&gt;4</span></span>
<span id="cb242-149"><a href="#cb242-149" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb242-150"><a href="#cb242-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-151"><a href="#cb242-151" aria-hidden="true" tabindex="-1"></a>sequences, graph <span class="op">=</span> parse_input(io.StringIO(sample_input.strip()))</span>
<span id="cb242-152"><a href="#cb242-152" aria-hidden="true" tabindex="-1"></a>total_score, sequences <span class="op">=</span> ba6f(graph, sequences)</span>
<span id="cb242-153"><a href="#cb242-153" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(total_score)</span>
<span id="cb242-154"><a href="#cb242-154" aria-hidden="true" tabindex="-1"></a>print_edges(graph, sequences, find_root(graph))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-farthestfirsttraversal" class="level1" data-number="81">
<h1 data-number="81"><span class="header-section-number">81</span> Implement FarthestFirstTraversal</h1>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>m</em>&nbsp;followed by a set of points&nbsp;<em>Data</em>&nbsp;in&nbsp;<em>m</em>-dimensional space.</p>
<p>Return:&nbsp;A set&nbsp;<em>Centers</em>&nbsp;consisting of&nbsp;<em>k</em>&nbsp;points (centers) resulting from applying&nbsp;<strong>FarthestFirstTraversal</strong>(<em>Data</em>,&nbsp;<em>k</em>), where the first point from&nbsp;<em>Data</em>&nbsp;is chosen as the first center to initialize the algorithm.</p>
<section id="sample-dataset-81" class="level2" data-number="81.1">
<h2 data-number="81.1" class="anchored" data-anchor-id="sample-dataset-81"><span class="header-section-number">81.1</span> Sample Dataset</h2>
<pre><code>3 2
0.0 0.0
5.0 5.0
0.0 5.0
1.0 1.0
2.0 2.0
3.0 3.0
1.0 2.0</code></pre>
</section>
<section id="sample-output-81" class="level2" data-number="81.2">
<h2 data-number="81.2" class="anchored" data-anchor-id="sample-output-81"><span class="header-section-number">81.2</span> Sample Output</h2>
<pre><code>0.0 0.0
5.0 5.0
0.0 5.0</code></pre>
</section>
<section id="solution-81" class="level2" data-number="81.3">
<h2 data-number="81.3" class="anchored" data-anchor-id="solution-81"><span class="header-section-number">81.3</span> Solution</h2>
<div class="sourceCode" id="cb245"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb245-2"><a href="#cb245-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator, TextIO, TypeVar</span>
<span id="cb245-3"><a href="#cb245-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb245-4"><a href="#cb245-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-5"><a href="#cb245-5" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb245-6"><a href="#cb245-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-7"><a href="#cb245-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: TextIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb245-8"><a href="#cb245-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb245-9"><a href="#cb245-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb245-10"><a href="#cb245-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-11"><a href="#cb245-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: List[<span class="bu">float</span>], point_b: List[<span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb245-12"><a href="#cb245-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb245-13"><a href="#cb245-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((coord_a <span class="op">-</span> coord_b) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> coord_a, coord_b <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb245-14"><a href="#cb245-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-15"><a href="#cb245-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_center_distance(data_point: List[<span class="bu">float</span>], center_points: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb245-16"><a href="#cb245-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance from DataPoint to its closest center"""</span></span>
<span id="cb245-17"><a href="#cb245-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(euclidean_distance(data_point, center) <span class="cf">for</span> center <span class="kw">in</span> center_points)</span>
<span id="cb245-18"><a href="#cb245-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-19"><a href="#cb245-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> farthest_first_traversal(data_points: List[List[<span class="bu">float</span>]], num_centers: <span class="bu">int</span>) <span class="op">-&gt;</span> List[List[<span class="bu">float</span>]]:</span>
<span id="cb245-20"><a href="#cb245-20" aria-hidden="true" tabindex="-1"></a>    center_points <span class="op">=</span> [data_points[<span class="dv">0</span>]]</span>
<span id="cb245-21"><a href="#cb245-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(center_points) <span class="op">&lt;</span> num_centers:</span>
<span id="cb245-22"><a href="#cb245-22" aria-hidden="true" tabindex="-1"></a>        distances <span class="op">=</span> [(i, nearest_center_distance(point, center_points)) <span class="cf">for</span> i, point <span class="kw">in</span> <span class="bu">enumerate</span>(data_points)]</span>
<span id="cb245-23"><a href="#cb245-23" aria-hidden="true" tabindex="-1"></a>        center_points.append(data_points[<span class="bu">max</span>(distances, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])[<span class="dv">0</span>]])</span>
<span id="cb245-24"><a href="#cb245-24" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> center_points</span>
<span id="cb245-25"><a href="#cb245-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-26"><a href="#cb245-26" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb245-27"><a href="#cb245-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-28"><a href="#cb245-28" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb245-29"><a href="#cb245-29" aria-hidden="true" tabindex="-1"></a><span class="st">3 2</span></span>
<span id="cb245-30"><a href="#cb245-30" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 0.0</span></span>
<span id="cb245-31"><a href="#cb245-31" aria-hidden="true" tabindex="-1"></a><span class="st">5.0 5.0</span></span>
<span id="cb245-32"><a href="#cb245-32" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 5.0</span></span>
<span id="cb245-33"><a href="#cb245-33" aria-hidden="true" tabindex="-1"></a><span class="st">1.0 1.0</span></span>
<span id="cb245-34"><a href="#cb245-34" aria-hidden="true" tabindex="-1"></a><span class="st">2.0 2.0</span></span>
<span id="cb245-35"><a href="#cb245-35" aria-hidden="true" tabindex="-1"></a><span class="st">3.0 3.0</span></span>
<span id="cb245-36"><a href="#cb245-36" aria-hidden="true" tabindex="-1"></a><span class="st">1.0 2.0</span></span>
<span id="cb245-37"><a href="#cb245-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb245-38"><a href="#cb245-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb245-39"><a href="#cb245-39" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb245-40"><a href="#cb245-40" aria-hidden="true" tabindex="-1"></a>num_centers, dimensions <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb245-41"><a href="#cb245-41" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [point <span class="cf">for</span> point <span class="kw">in</span> read_types(file_handle, <span class="bu">float</span>)]</span>
<span id="cb245-42"><a href="#cb245-42" aria-hidden="true" tabindex="-1"></a>center_points <span class="op">=</span> farthest_first_traversal(data_points, num_centers)</span>
<span id="cb245-43"><a href="#cb245-43" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center <span class="kw">in</span> center_points:</span>
<span id="cb245-44"><a href="#cb245-44" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>center)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-squared-error-distortion" class="level1" data-number="82">
<h1 data-number="82"><span class="header-section-number">82</span> Compute the Squared Error Distortion</h1>
<p>Squared Error Distortion Problem.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>m</em>, followed by a set of centers&nbsp;<em>Centers</em>&nbsp;and a set of points&nbsp;<em>Data</em>.</p>
<p>Return:&nbsp;The squared error distortion&nbsp;<em>Distortion</em>(<em>Data</em>,&nbsp;<em>Centers</em>).</p>
<section id="sample-dataset-82" class="level2" data-number="82.1">
<h2 data-number="82.1" class="anchored" data-anchor-id="sample-dataset-82"><span class="header-section-number">82.1</span> Sample Dataset</h2>
<pre><code>2 2
2.31 4.55
5.96 9.08
--------
3.42 6.03
6.23 8.25
4.76 1.64
4.47 4.33
3.95 7.61
8.93 2.97
9.74 4.03
1.73 1.28
9.72 5.01
7.27 3.77</code></pre>
</section>
<section id="sample-output-82" class="level2" data-number="82.2">
<h2 data-number="82.2" class="anchored" data-anchor-id="sample-output-82"><span class="header-section-number">82.2</span> Sample Output</h2>
<pre><code>18.246</code></pre>
</section>
<section id="solution-82" class="level2" data-number="82.3">
<h2 data-number="82.3" class="anchored" data-anchor-id="solution-82"><span class="header-section-number">82.3</span> Solution</h2>
<div class="sourceCode" id="cb248"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb248-1"><a href="#cb248-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb248-2"><a href="#cb248-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb248-3"><a href="#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator, TextIO, TypeVar</span>
<span id="cb248-4"><a href="#cb248-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-5"><a href="#cb248-5" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb248-6"><a href="#cb248-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-7"><a href="#cb248-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: TextIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb248-8"><a href="#cb248-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb248-9"><a href="#cb248-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb248-10"><a href="#cb248-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-11"><a href="#cb248-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: List[<span class="bu">float</span>], point_b: List[<span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb248-12"><a href="#cb248-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb248-13"><a href="#cb248-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((coord_a <span class="op">-</span> coord_b) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> coord_a, coord_b <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb248-14"><a href="#cb248-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-15"><a href="#cb248-15" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_center_distance(data_point: List[<span class="bu">float</span>], center_points: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb248-16"><a href="#cb248-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance from DataPoint to its closest center"""</span></span>
<span id="cb248-17"><a href="#cb248-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(euclidean_distance(data_point, center) <span class="cf">for</span> center <span class="kw">in</span> center_points)</span>
<span id="cb248-18"><a href="#cb248-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-19"><a href="#cb248-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_distortion(data_points: List[List[<span class="bu">float</span>]], center_points: List[List[<span class="bu">float</span>]]) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb248-20"><a href="#cb248-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (<span class="dv">1</span> <span class="op">/</span> <span class="bu">len</span>(data_points)) <span class="op">*</span> <span class="bu">sum</span>(nearest_center_distance(point, center_points) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> point <span class="kw">in</span> data_points)</span>
<span id="cb248-21"><a href="#cb248-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-22"><a href="#cb248-22" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb248-23"><a href="#cb248-23" aria-hidden="true" tabindex="-1"></a><span class="st">2 2</span></span>
<span id="cb248-24"><a href="#cb248-24" aria-hidden="true" tabindex="-1"></a><span class="st">2.31 4.55</span></span>
<span id="cb248-25"><a href="#cb248-25" aria-hidden="true" tabindex="-1"></a><span class="st">5.96 9.08</span></span>
<span id="cb248-26"><a href="#cb248-26" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb248-27"><a href="#cb248-27" aria-hidden="true" tabindex="-1"></a><span class="st">3.42 6.03</span></span>
<span id="cb248-28"><a href="#cb248-28" aria-hidden="true" tabindex="-1"></a><span class="st">6.23 8.25</span></span>
<span id="cb248-29"><a href="#cb248-29" aria-hidden="true" tabindex="-1"></a><span class="st">4.76 1.64</span></span>
<span id="cb248-30"><a href="#cb248-30" aria-hidden="true" tabindex="-1"></a><span class="st">4.47 4.33</span></span>
<span id="cb248-31"><a href="#cb248-31" aria-hidden="true" tabindex="-1"></a><span class="st">3.95 7.61</span></span>
<span id="cb248-32"><a href="#cb248-32" aria-hidden="true" tabindex="-1"></a><span class="st">8.93 2.97</span></span>
<span id="cb248-33"><a href="#cb248-33" aria-hidden="true" tabindex="-1"></a><span class="st">9.74 4.03</span></span>
<span id="cb248-34"><a href="#cb248-34" aria-hidden="true" tabindex="-1"></a><span class="st">1.73 1.28</span></span>
<span id="cb248-35"><a href="#cb248-35" aria-hidden="true" tabindex="-1"></a><span class="st">9.72 5.01</span></span>
<span id="cb248-36"><a href="#cb248-36" aria-hidden="true" tabindex="-1"></a><span class="st">7.27 3.77</span></span>
<span id="cb248-37"><a href="#cb248-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb248-38"><a href="#cb248-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-39"><a href="#cb248-39" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb248-40"><a href="#cb248-40" aria-hidden="true" tabindex="-1"></a>num_centers, _ <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb248-41"><a href="#cb248-41" aria-hidden="true" tabindex="-1"></a>data_generator <span class="op">=</span> read_types(file_handle, <span class="bu">float</span>)</span>
<span id="cb248-42"><a href="#cb248-42" aria-hidden="true" tabindex="-1"></a>center_points <span class="op">=</span> [<span class="bu">next</span>(data_generator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(num_centers)]</span>
<span id="cb248-43"><a href="#cb248-43" aria-hidden="true" tabindex="-1"></a>_ <span class="op">=</span> <span class="bu">next</span>(file_handle)</span>
<span id="cb248-44"><a href="#cb248-44" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [point <span class="cf">for</span> point <span class="kw">in</span> data_generator]</span>
<span id="cb248-45"><a href="#cb248-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">round</span>(calculate_distortion(data_points, center_points), <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-lloyd-algorithm-for-k-means-clustering" class="level1" data-number="83">
<h1 data-number="83"><span class="header-section-number">83</span> Implement the Lloyd Algorithm for k-Means Clustering</h1>
<p>Implement the Lloyd algorithm.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>m</em>&nbsp;followed by a set of points&nbsp;<em>Data</em>&nbsp;in&nbsp;<em>m</em>-dimensional space.</p>
<p>Return:&nbsp;A set&nbsp;<em>Centers</em>&nbsp;consisting of&nbsp;<em>k</em>&nbsp;points (centers) resulting from applying the Lloyd algorithm to&nbsp;<em>Data</em>&nbsp;and&nbsp;<em>Centers</em>, where the first&nbsp;<em>k</em>&nbsp;points from&nbsp;<em>Data</em>&nbsp;are selected as the first&nbsp;<em>k</em>&nbsp;centers.</p>
<section id="sample-dataset-83" class="level2" data-number="83.1">
<h2 data-number="83.1" class="anchored" data-anchor-id="sample-dataset-83"><span class="header-section-number">83.1</span> Sample Dataset</h2>
<pre><code>2 2
1.3 1.1
1.3 0.2
0.6 2.8
3.0 3.2
1.2 0.7
1.4 1.6
1.2 1.0
1.2 1.1
0.6 1.5
1.8 2.6
1.2 1.3
1.2 1.0
0.0 1.9</code></pre>
</section>
<section id="sample-output-83" class="level2" data-number="83.2">
<h2 data-number="83.2" class="anchored" data-anchor-id="sample-output-83"><span class="header-section-number">83.2</span> Sample Output</h2>
<pre><code>1.800 2.867
1.060 1.140</code></pre>
</section>
<section id="solution-83" class="level2" data-number="83.3">
<h2 data-number="83.3" class="anchored" data-anchor-id="solution-83"><span class="header-section-number">83.3</span> Solution</h2>
<div class="sourceCode" id="cb251"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb251-1"><a href="#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb251-2"><a href="#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb251-3"><a href="#cb251-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb251-4"><a href="#cb251-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, TypeVar, Any</span>
<span id="cb251-5"><a href="#cb251-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-6"><a href="#cb251-6" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb251-7"><a href="#cb251-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-8"><a href="#cb251-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: io.StringIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb251-9"><a href="#cb251-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb251-10"><a href="#cb251-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb251-11"><a href="#cb251-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-12"><a href="#cb251-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: np.ndarray, point_b: np.ndarray) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb251-13"><a href="#cb251-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb251-14"><a href="#cb251-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((x <span class="op">-</span> y) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb251-15"><a href="#cb251-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-16"><a href="#cb251-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> nearest_center_assignment(data_point: np.ndarray, center_points: List[np.ndarray]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb251-17"><a href="#cb251-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Center index that minimises Euclidean distance to point"""</span></span>
<span id="cb251-18"><a href="#cb251-18" aria-hidden="true" tabindex="-1"></a>    distances <span class="op">=</span> [euclidean_distance(data_point, center) <span class="cf">for</span> center <span class="kw">in</span> center_points]</span>
<span id="cb251-19"><a href="#cb251-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> distances.index(<span class="bu">min</span>(distances))</span>
<span id="cb251-20"><a href="#cb251-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-21"><a href="#cb251-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_center(data_points: List[np.ndarray], assignments: List[<span class="bu">int</span>], center_index: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb251-22"><a href="#cb251-22" aria-hidden="true" tabindex="-1"></a>    cluster_points <span class="op">=</span> [p <span class="cf">for</span> p, a <span class="kw">in</span> <span class="bu">zip</span>(data_points, assignments) <span class="cf">if</span> a <span class="op">==</span> center_index]</span>
<span id="cb251-23"><a href="#cb251-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.mean(np.array(cluster_points), axis<span class="op">=</span><span class="dv">0</span>) <span class="cf">if</span> cluster_points <span class="cf">else</span> np.zeros_like(data_points[<span class="dv">0</span>])</span>
<span id="cb251-24"><a href="#cb251-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-25"><a href="#cb251-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> k_means(data_points: List[np.ndarray], num_clusters: <span class="bu">int</span>, max_iterations: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>) <span class="op">-&gt;</span> List[np.ndarray]:</span>
<span id="cb251-26"><a href="#cb251-26" aria-hidden="true" tabindex="-1"></a>    center_points <span class="op">=</span> data_points[:num_clusters]</span>
<span id="cb251-27"><a href="#cb251-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iterations):</span>
<span id="cb251-28"><a href="#cb251-28" aria-hidden="true" tabindex="-1"></a>        assignments <span class="op">=</span> [nearest_center_assignment(point, center_points) <span class="cf">for</span> point <span class="kw">in</span> data_points]</span>
<span id="cb251-29"><a href="#cb251-29" aria-hidden="true" tabindex="-1"></a>        center_points <span class="op">=</span> [compute_center(data_points, assignments, i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_clusters)]</span>
<span id="cb251-30"><a href="#cb251-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> center_points</span>
<span id="cb251-31"><a href="#cb251-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-32"><a href="#cb251-32" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb251-33"><a href="#cb251-33" aria-hidden="true" tabindex="-1"></a><span class="st">2 2</span></span>
<span id="cb251-34"><a href="#cb251-34" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 1.1</span></span>
<span id="cb251-35"><a href="#cb251-35" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 0.2</span></span>
<span id="cb251-36"><a href="#cb251-36" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 2.8</span></span>
<span id="cb251-37"><a href="#cb251-37" aria-hidden="true" tabindex="-1"></a><span class="st">3.0 3.2</span></span>
<span id="cb251-38"><a href="#cb251-38" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 0.7</span></span>
<span id="cb251-39"><a href="#cb251-39" aria-hidden="true" tabindex="-1"></a><span class="st">1.4 1.6</span></span>
<span id="cb251-40"><a href="#cb251-40" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb251-41"><a href="#cb251-41" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.1</span></span>
<span id="cb251-42"><a href="#cb251-42" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 1.5</span></span>
<span id="cb251-43"><a href="#cb251-43" aria-hidden="true" tabindex="-1"></a><span class="st">1.8 2.6</span></span>
<span id="cb251-44"><a href="#cb251-44" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.3</span></span>
<span id="cb251-45"><a href="#cb251-45" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb251-46"><a href="#cb251-46" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 1.9</span></span>
<span id="cb251-47"><a href="#cb251-47" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb251-48"><a href="#cb251-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-49"><a href="#cb251-49" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb251-50"><a href="#cb251-50" aria-hidden="true" tabindex="-1"></a>num_clusters, dimensions <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb251-51"><a href="#cb251-51" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [np.array(point) <span class="cf">for</span> point <span class="kw">in</span> read_types(file_handle, <span class="bu">float</span>)]</span>
<span id="cb251-52"><a href="#cb251-52" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center <span class="kw">in</span> k_means(data_points, num_clusters):</span>
<span id="cb251-53"><a href="#cb251-53" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>[<span class="ss">f"</span><span class="sc">{</span>coord<span class="sc">:f}</span><span class="ss">"</span> <span class="cf">for</span> coord <span class="kw">in</span> center])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-soft-k-means-clustering-algorithm" class="level1" data-number="84">
<h1 data-number="84"><span class="header-section-number">84</span> Implement the Soft k-Means Clustering Algorithm</h1>
<p>Implement the Soft k-Means Clustering Algorithm.</p>
<p>Given:&nbsp;Integers&nbsp;<em>k</em>&nbsp;and&nbsp;<em>m</em>, followed by a stiffness parameter β, followed by a set of points&nbsp;<em>Data</em>&nbsp;in&nbsp;<em>m</em>-dimensional space.</p>
<p>Return:&nbsp;A set&nbsp;<em>Centers</em>&nbsp;consisting of&nbsp;<em>k</em>&nbsp;points (centers) resulting from applying the soft&nbsp;<em>k</em>-means clustering algorithm. Select the first&nbsp;<em>k</em>&nbsp;points from&nbsp;<em>Data</em>&nbsp;as the first centers for the algorithm and run the algorithm for 100 steps. Results should be accurate up to three decimal places.</p>
<section id="sample-dataset-84" class="level2" data-number="84.1">
<h2 data-number="84.1" class="anchored" data-anchor-id="sample-dataset-84"><span class="header-section-number">84.1</span> Sample Dataset</h2>
<pre><code>2 2
2.7
1.3 1.1
1.3 0.2
0.6 2.8
3.0 3.2
1.2 0.7
1.4 1.6
1.2 1.0
1.2 1.1
0.6 1.5
1.8 2.6
1.2 1.3
1.2 1.0
0.0 1.9</code></pre>
</section>
<section id="sample-output-84" class="level2" data-number="84.2">
<h2 data-number="84.2" class="anchored" data-anchor-id="sample-output-84"><span class="header-section-number">84.2</span> Sample Output</h2>
<pre><code>1.662 2.623
1.075 1.148</code></pre>
</section>
<section id="solution-84" class="level2" data-number="84.3">
<h2 data-number="84.3" class="anchored" data-anchor-id="solution-84"><span class="header-section-number">84.3</span> Solution</h2>
<div class="sourceCode" id="cb254"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb254-2"><a href="#cb254-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb254-3"><a href="#cb254-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb254-4"><a href="#cb254-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Iterator, TypeVar, Any</span>
<span id="cb254-5"><a href="#cb254-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-6"><a href="#cb254-6" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> TypeVar(<span class="st">'T'</span>)</span>
<span id="cb254-7"><a href="#cb254-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-8"><a href="#cb254-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> read_types(file_handle: io.StringIO, data_type: <span class="bu">type</span>) <span class="op">-&gt;</span> Iterator[List[T]]:</span>
<span id="cb254-9"><a href="#cb254-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_handle:</span>
<span id="cb254-10"><a href="#cb254-10" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="bu">list</span>(<span class="bu">map</span>(data_type, line.split()))</span>
<span id="cb254-11"><a href="#cb254-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-12"><a href="#cb254-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> euclidean_distance(point_a: np.ndarray, point_b: np.ndarray) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb254-13"><a href="#cb254-13" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""Euclidean distance between a pair of n-dimensional points"""</span></span>
<span id="cb254-14"><a href="#cb254-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sqrt(<span class="bu">sum</span>((x <span class="op">-</span> y) <span class="op">**</span> <span class="dv">2</span> <span class="cf">for</span> x, y <span class="kw">in</span> <span class="bu">zip</span>(point_a, point_b)))</span>
<span id="cb254-15"><a href="#cb254-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-16"><a href="#cb254-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partition_function(data_point: np.ndarray, center_points: np.ndarray, beta: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb254-17"><a href="#cb254-17" aria-hidden="true" tabindex="-1"></a>    numerator <span class="op">=</span> [np.exp(<span class="op">-</span>beta <span class="op">*</span> euclidean_distance(data_point, center)) <span class="cf">for</span> center <span class="kw">in</span> center_points]</span>
<span id="cb254-18"><a href="#cb254-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array(numerator) <span class="op">/</span> <span class="bu">sum</span>(numerator)</span>
<span id="cb254-19"><a href="#cb254-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-20"><a href="#cb254-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hidden_matrix(data_points: np.ndarray, center_points: np.ndarray, beta: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb254-21"><a href="#cb254-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([partition_function(x, center_points, beta) <span class="cf">for</span> x <span class="kw">in</span> data_points])</span>
<span id="cb254-22"><a href="#cb254-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-23"><a href="#cb254-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_k_means(data_points: List[np.ndarray], num_clusters: <span class="bu">int</span>, beta: <span class="bu">float</span>, max_iterations: <span class="bu">int</span> <span class="op">=</span> <span class="dv">20</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb254-24"><a href="#cb254-24" aria-hidden="true" tabindex="-1"></a>    center_points <span class="op">=</span> np.array(data_points[:num_clusters])</span>
<span id="cb254-25"><a href="#cb254-25" aria-hidden="true" tabindex="-1"></a>    data_points <span class="op">=</span> np.array(data_points)</span>
<span id="cb254-26"><a href="#cb254-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(max_iterations):</span>
<span id="cb254-27"><a href="#cb254-27" aria-hidden="true" tabindex="-1"></a>        h_matrix <span class="op">=</span> hidden_matrix(data_points, center_points, beta)</span>
<span id="cb254-28"><a href="#cb254-28" aria-hidden="true" tabindex="-1"></a>        center_points <span class="op">=</span> [np.dot(h_matrix[:, i], data_points) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_clusters)]</span>
<span id="cb254-29"><a href="#cb254-29" aria-hidden="true" tabindex="-1"></a>        sums <span class="op">=</span> np.<span class="bu">sum</span>(h_matrix, <span class="dv">0</span>)</span>
<span id="cb254-30"><a href="#cb254-30" aria-hidden="true" tabindex="-1"></a>        center_points <span class="op">=</span> np.transpose(np.transpose(center_points) <span class="op">/</span> sums)</span>
<span id="cb254-31"><a href="#cb254-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> center_points</span>
<span id="cb254-32"><a href="#cb254-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-33"><a href="#cb254-33" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb254-34"><a href="#cb254-34" aria-hidden="true" tabindex="-1"></a><span class="st">2 2</span></span>
<span id="cb254-35"><a href="#cb254-35" aria-hidden="true" tabindex="-1"></a><span class="st">2.7</span></span>
<span id="cb254-36"><a href="#cb254-36" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 1.1</span></span>
<span id="cb254-37"><a href="#cb254-37" aria-hidden="true" tabindex="-1"></a><span class="st">1.3 0.2</span></span>
<span id="cb254-38"><a href="#cb254-38" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 2.8</span></span>
<span id="cb254-39"><a href="#cb254-39" aria-hidden="true" tabindex="-1"></a><span class="st">3.0 3.2</span></span>
<span id="cb254-40"><a href="#cb254-40" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 0.7</span></span>
<span id="cb254-41"><a href="#cb254-41" aria-hidden="true" tabindex="-1"></a><span class="st">1.4 1.6</span></span>
<span id="cb254-42"><a href="#cb254-42" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb254-43"><a href="#cb254-43" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.1</span></span>
<span id="cb254-44"><a href="#cb254-44" aria-hidden="true" tabindex="-1"></a><span class="st">0.6 1.5</span></span>
<span id="cb254-45"><a href="#cb254-45" aria-hidden="true" tabindex="-1"></a><span class="st">1.8 2.6</span></span>
<span id="cb254-46"><a href="#cb254-46" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.3</span></span>
<span id="cb254-47"><a href="#cb254-47" aria-hidden="true" tabindex="-1"></a><span class="st">1.2 1.0</span></span>
<span id="cb254-48"><a href="#cb254-48" aria-hidden="true" tabindex="-1"></a><span class="st">0.0 1.9</span></span>
<span id="cb254-49"><a href="#cb254-49" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb254-50"><a href="#cb254-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb254-51"><a href="#cb254-51" aria-hidden="true" tabindex="-1"></a>file_handle <span class="op">=</span> io.StringIO(sample_input.strip())</span>
<span id="cb254-52"><a href="#cb254-52" aria-hidden="true" tabindex="-1"></a>num_clusters, dimensions <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">int</span>))</span>
<span id="cb254-53"><a href="#cb254-53" aria-hidden="true" tabindex="-1"></a>beta <span class="op">=</span> <span class="bu">next</span>(read_types(file_handle, <span class="bu">float</span>))[<span class="dv">0</span>]</span>
<span id="cb254-54"><a href="#cb254-54" aria-hidden="true" tabindex="-1"></a>data_points <span class="op">=</span> [np.array(point) <span class="cf">for</span> point <span class="kw">in</span> read_types(file_handle, <span class="bu">float</span>)]</span>
<span id="cb254-55"><a href="#cb254-55" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> center <span class="kw">in</span> soft_k_means(data_points, num_clusters, beta):</span>
<span id="cb254-56"><a href="#cb254-56" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>[<span class="ss">f"</span><span class="sc">{</span>coord<span class="sc">:f}</span><span class="ss">"</span> <span class="cf">for</span> coord <span class="kw">in</span> center])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-hierarchical-clustering" class="level1" data-number="85">
<h1 data-number="85"><span class="header-section-number">85</span> Implement Hierarchical Clustering</h1>
<p>Implement Hierarchical Clustering.</p>
<p>Given:&nbsp;An integer&nbsp;<em>n</em>, followed by an&nbsp;<em>n_x_n</em>&nbsp;distance matrix.</p>
<p>Return:&nbsp;The result of applying&nbsp;<strong>HierarchicalClustering</strong>&nbsp;to this distance matrix (using&nbsp;<em>D</em>avg), with each newly created cluster listed on each line.</p>
<section id="sample-dataset-85" class="level2" data-number="85.1">
<h2 data-number="85.1" class="anchored" data-anchor-id="sample-dataset-85"><span class="header-section-number">85.1</span> Sample Dataset</h2>
<pre><code>7
0.00 0.74 0.85 0.54 0.83 0.92 0.89
0.74 0.00 1.59 1.35 1.20 1.48 1.55
0.85 1.59 0.00 0.63 1.13 0.69 0.73
0.54 1.35 0.63 0.00 0.66 0.43 0.88
0.83 1.20 1.13 0.66 0.00 0.72 0.55
0.92 1.48 0.69 0.43 0.72 0.00 0.80
0.89 1.55 0.73 0.88 0.55 0.80 0.00</code></pre>
</section>
<section id="sample-output-85" class="level2" data-number="85.2">
<h2 data-number="85.2" class="anchored" data-anchor-id="sample-output-85"><span class="header-section-number">85.2</span> Sample Output</h2>
<pre><code>4 6
5 7
3 4 6
1 2
5 7 3 4 6
1 2 5 7 3 4 6</code></pre>
</section>
<section id="solution-85" class="level2" data-number="85.3">
<h2 data-number="85.3" class="anchored" data-anchor-id="solution-85"><span class="header-section-number">85.3</span> Solution</h2>
<div class="sourceCode" id="cb257"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb257-2"><a href="#cb257-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb257-3"><a href="#cb257-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb257-4"><a href="#cb257-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Generator</span>
<span id="cb257-5"><a href="#cb257-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-6"><a href="#cb257-6" aria-hidden="true" tabindex="-1"></a><span class="co"># find (first) minimum off diagonal index in an array</span></span>
<span id="cb257-7"><a href="#cb257-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_closest_pair(distance_matrix: np.ndarray) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb257-8"><a href="#cb257-8" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb257-9"><a href="#cb257-9" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(temp_matrix, temp_matrix.<span class="bu">max</span>() <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb257-10"><a href="#cb257-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">divmod</span>(temp_matrix.argmin(), temp_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb257-11"><a href="#cb257-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-12"><a href="#cb257-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> average_distances(distance_matrix: np.ndarray, i: <span class="bu">int</span>, j: <span class="bu">int</span>, size_i: <span class="bu">int</span>, size_j: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb257-13"><a href="#cb257-13" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.copy(distance_matrix)</span>
<span id="cb257-14"><a href="#cb257-14" aria-hidden="true" tabindex="-1"></a>    average <span class="op">=</span> (temp_matrix[i, :] <span class="op">*</span> size_i <span class="op">+</span> temp_matrix[j, :] <span class="op">*</span> size_j) <span class="op">/</span> (size_i <span class="op">+</span> size_j)</span>
<span id="cb257-15"><a href="#cb257-15" aria-hidden="true" tabindex="-1"></a>    temp_matrix[i, :] <span class="op">=</span> average</span>
<span id="cb257-16"><a href="#cb257-16" aria-hidden="true" tabindex="-1"></a>    temp_matrix[:, i] <span class="op">=</span> average</span>
<span id="cb257-17"><a href="#cb257-17" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.delete(temp_matrix, j, <span class="dv">0</span>)</span>
<span id="cb257-18"><a href="#cb257-18" aria-hidden="true" tabindex="-1"></a>    temp_matrix <span class="op">=</span> np.delete(temp_matrix, j, <span class="dv">1</span>)</span>
<span id="cb257-19"><a href="#cb257-19" aria-hidden="true" tabindex="-1"></a>    np.fill_diagonal(temp_matrix, <span class="dv">0</span>)</span>
<span id="cb257-20"><a href="#cb257-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> temp_matrix</span>
<span id="cb257-21"><a href="#cb257-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-22"><a href="#cb257-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_descendants(tree: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]], node: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb257-23"><a href="#cb257-23" aria-hidden="true" tabindex="-1"></a>    queue <span class="op">=</span> [node]</span>
<span id="cb257-24"><a href="#cb257-24" aria-hidden="true" tabindex="-1"></a>    descendants <span class="op">=</span> []</span>
<span id="cb257-25"><a href="#cb257-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> queue:</span>
<span id="cb257-26"><a href="#cb257-26" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> queue.pop(<span class="dv">0</span>)</span>
<span id="cb257-27"><a href="#cb257-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_node <span class="kw">in</span> tree:</span>
<span id="cb257-28"><a href="#cb257-28" aria-hidden="true" tabindex="-1"></a>            queue.extend(tree[current_node])</span>
<span id="cb257-29"><a href="#cb257-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb257-30"><a href="#cb257-30" aria-hidden="true" tabindex="-1"></a>            descendants.append(current_node)</span>
<span id="cb257-31"><a href="#cb257-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> descendants</span>
<span id="cb257-32"><a href="#cb257-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-33"><a href="#cb257-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> hierarchical_clustering(distance_matrix: np.ndarray, num_elements: <span class="bu">int</span>) <span class="op">-&gt;</span> Generator[List[<span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb257-34"><a href="#cb257-34" aria-hidden="true" tabindex="-1"></a>    clusters <span class="op">=</span> <span class="bu">list</span>(<span class="bu">range</span>(<span class="dv">1</span>, num_elements <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb257-35"><a href="#cb257-35" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">int</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb257-36"><a href="#cb257-36" aria-hidden="true" tabindex="-1"></a>    cluster_size <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="dv">1</span>)  <span class="co"># the number of descendants of a node</span></span>
<span id="cb257-37"><a href="#cb257-37" aria-hidden="true" tabindex="-1"></a>    next_node <span class="op">=</span> num_elements</span>
<span id="cb257-38"><a href="#cb257-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">len</span>(clusters) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb257-39"><a href="#cb257-39" aria-hidden="true" tabindex="-1"></a>        next_node <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb257-40"><a href="#cb257-40" aria-hidden="true" tabindex="-1"></a>        i, j <span class="op">=</span> find_closest_pair(distance_matrix)</span>
<span id="cb257-41"><a href="#cb257-41" aria-hidden="true" tabindex="-1"></a>        cluster_a, cluster_b <span class="op">=</span> clusters[i], clusters[j]</span>
<span id="cb257-42"><a href="#cb257-42" aria-hidden="true" tabindex="-1"></a>        tree[next_node] <span class="op">=</span> [cluster_a, cluster_b]</span>
<span id="cb257-43"><a href="#cb257-43" aria-hidden="true" tabindex="-1"></a>        cluster_size[next_node] <span class="op">=</span> cluster_size[cluster_a] <span class="op">+</span> cluster_size[cluster_b]</span>
<span id="cb257-44"><a href="#cb257-44" aria-hidden="true" tabindex="-1"></a>        distance_matrix <span class="op">=</span> average_distances(distance_matrix, <span class="op">*</span>find_closest_pair(distance_matrix), cluster_size[cluster_a], cluster_size[cluster_b])</span>
<span id="cb257-45"><a href="#cb257-45" aria-hidden="true" tabindex="-1"></a>        clusters[i] <span class="op">=</span> next_node</span>
<span id="cb257-46"><a href="#cb257-46" aria-hidden="true" tabindex="-1"></a>        <span class="kw">del</span> clusters[j]</span>
<span id="cb257-47"><a href="#cb257-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> get_descendants(tree, cluster_a) <span class="op">+</span> get_descendants(tree, cluster_b)</span>
<span id="cb257-48"><a href="#cb257-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-49"><a href="#cb257-49" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb257-50"><a href="#cb257-50" aria-hidden="true" tabindex="-1"></a><span class="st">7</span></span>
<span id="cb257-51"><a href="#cb257-51" aria-hidden="true" tabindex="-1"></a><span class="st">0.00 0.74 0.85 0.54 0.83 0.92 0.89</span></span>
<span id="cb257-52"><a href="#cb257-52" aria-hidden="true" tabindex="-1"></a><span class="st">0.74 0.00 1.59 1.35 1.20 1.48 1.55</span></span>
<span id="cb257-53"><a href="#cb257-53" aria-hidden="true" tabindex="-1"></a><span class="st">0.85 1.59 0.00 0.63 1.13 0.69 0.73</span></span>
<span id="cb257-54"><a href="#cb257-54" aria-hidden="true" tabindex="-1"></a><span class="st">0.54 1.35 0.63 0.00 0.66 0.43 0.88</span></span>
<span id="cb257-55"><a href="#cb257-55" aria-hidden="true" tabindex="-1"></a><span class="st">0.83 1.20 1.13 0.66 0.00 0.72 0.55</span></span>
<span id="cb257-56"><a href="#cb257-56" aria-hidden="true" tabindex="-1"></a><span class="st">0.92 1.48 0.69 0.43 0.72 0.00 0.80</span></span>
<span id="cb257-57"><a href="#cb257-57" aria-hidden="true" tabindex="-1"></a><span class="st">0.89 1.55 0.73 0.88 0.55 0.80 0.00</span></span>
<span id="cb257-58"><a href="#cb257-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb257-59"><a href="#cb257-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb257-60"><a href="#cb257-60" aria-hidden="true" tabindex="-1"></a>num_elements, <span class="op">*</span>distance_data <span class="op">=</span> io.StringIO(sample_input.strip()).read().splitlines()</span>
<span id="cb257-61"><a href="#cb257-61" aria-hidden="true" tabindex="-1"></a>distance_matrix <span class="op">=</span> np.array([<span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">float</span>, row.split())) <span class="cf">for</span> row <span class="kw">in</span> distance_data])</span>
<span id="cb257-62"><a href="#cb257-62" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> step <span class="kw">in</span> hierarchical_clustering(distance_matrix, <span class="bu">int</span>(num_elements)):</span>
<span id="cb257-63"><a href="#cb257-63" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>step)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-trie-from-a-collection-of-patterns" class="level1" data-number="86">
<h1 data-number="86"><span class="header-section-number">86</span> Construct a Trie from a Collection of Patterns</h1>
<p>Trie Construction Problem. Construct a trie on a collection of patterns.</p>
<p>Given:&nbsp;A collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;The&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>&nbsp;corresponding to&nbsp;<em>Trie</em>(<em>Patterns</em>), in the following format. If&nbsp;<em>Trie</em>(<em>Patterns</em>) has&nbsp;<em>n</em>&nbsp;nodes, first label the root with 1 and then label the remaining nodes with the integers 2 through&nbsp;<em>n</em>&nbsp;in any order you like. Each edge of the adjacency list of&nbsp;<em>Trie</em>(<em>Patterns</em>) will be encoded by a triple: the first two members of the triple must be the integers labeling the initial and terminal nodes of the edge, respectively; the third member of the triple must be the symbol labeling the edge.</p>
<section id="sample-dataset-86" class="level2" data-number="86.1">
<h2 data-number="86.1" class="anchored" data-anchor-id="sample-dataset-86"><span class="header-section-number">86.1</span> Sample Dataset</h2>
<pre><code>ATAGA
ATC
GAT</code></pre>
</section>
<section id="sample-output-86" class="level2" data-number="86.2">
<h2 data-number="86.2" class="anchored" data-anchor-id="sample-output-86"><span class="header-section-number">86.2</span> Sample Output</h2>
<pre><code>0-&gt;1:A
1-&gt;2:T
2-&gt;3:A
3-&gt;4:G
4-&gt;5:A
2-&gt;6:C
0-&gt;7:G
7-&gt;8:A
8-&gt;9:T</code></pre>
</section>
<section id="solution-86" class="level2" data-number="86.3">
<h2 data-number="86.3" class="anchored" data-anchor-id="solution-86"><span class="header-section-number">86.3</span> Solution</h2>
<div class="sourceCode" id="cb260"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb260-1"><a href="#cb260-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> count</span>
<span id="cb260-2"><a href="#cb260-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Any</span>
<span id="cb260-3"><a href="#cb260-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-4"><a href="#cb260-4" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Trie:</span>
<span id="cb260-5"><a href="#cb260-5" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb260-6"><a href="#cb260-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.id_generator <span class="op">=</span> count(start<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb260-7"><a href="#cb260-7" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.root: Tuple[<span class="bu">int</span>, Dict[<span class="bu">str</span>, Any]] <span class="op">=</span> (<span class="bu">next</span>(<span class="va">self</span>.id_generator), {})</span>
<span id="cb260-8"><a href="#cb260-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-9"><a href="#cb260-9" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> insert(<span class="va">self</span>, sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb260-10"><a href="#cb260-10" aria-hidden="true" tabindex="-1"></a>        current_node <span class="op">=</span> <span class="va">self</span>.root</span>
<span id="cb260-11"><a href="#cb260-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> character <span class="kw">in</span> sequence:</span>
<span id="cb260-12"><a href="#cb260-12" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> character <span class="kw">not</span> <span class="kw">in</span> current_node[<span class="dv">1</span>]:</span>
<span id="cb260-13"><a href="#cb260-13" aria-hidden="true" tabindex="-1"></a>                current_node[<span class="dv">1</span>][character] <span class="op">=</span> (<span class="bu">next</span>(<span class="va">self</span>.id_generator), {})</span>
<span id="cb260-14"><a href="#cb260-14" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> current_node[<span class="dv">1</span>][character]</span>
<span id="cb260-15"><a href="#cb260-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-16"><a href="#cb260-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_trie(sequences: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, Dict[<span class="bu">str</span>, Any]]:</span>
<span id="cb260-17"><a href="#cb260-17" aria-hidden="true" tabindex="-1"></a>    trie <span class="op">=</span> Trie()</span>
<span id="cb260-18"><a href="#cb260-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> sequences:</span>
<span id="cb260-19"><a href="#cb260-19" aria-hidden="true" tabindex="-1"></a>        trie.insert(sequence)</span>
<span id="cb260-20"><a href="#cb260-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> trie.root</span>
<span id="cb260-21"><a href="#cb260-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-22"><a href="#cb260-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> format_trie(node: Tuple[<span class="bu">int</span>, Dict[<span class="bu">str</span>, Any]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb260-23"><a href="#cb260-23" aria-hidden="true" tabindex="-1"></a>    formatted_output: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb260-24"><a href="#cb260-24" aria-hidden="true" tabindex="-1"></a>    node_id, children <span class="op">=</span> node</span>
<span id="cb260-25"><a href="#cb260-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char, child_node <span class="kw">in</span> children.items():</span>
<span id="cb260-26"><a href="#cb260-26" aria-hidden="true" tabindex="-1"></a>        child_id, _ <span class="op">=</span> child_node</span>
<span id="cb260-27"><a href="#cb260-27" aria-hidden="true" tabindex="-1"></a>        formatted_output.append(<span class="ss">f"</span><span class="sc">{</span>node_id<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>child_id<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>char<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb260-28"><a href="#cb260-28" aria-hidden="true" tabindex="-1"></a>        formatted_output.extend(format_trie(child_node))</span>
<span id="cb260-29"><a href="#cb260-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> formatted_output</span>
<span id="cb260-30"><a href="#cb260-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-31"><a href="#cb260-31" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb260-32"><a href="#cb260-32" aria-hidden="true" tabindex="-1"></a><span class="st">ATAGA</span></span>
<span id="cb260-33"><a href="#cb260-33" aria-hidden="true" tabindex="-1"></a><span class="st">ATC</span></span>
<span id="cb260-34"><a href="#cb260-34" aria-hidden="true" tabindex="-1"></a><span class="st">GAT</span></span>
<span id="cb260-35"><a href="#cb260-35" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb260-36"><a href="#cb260-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-37"><a href="#cb260-37" aria-hidden="true" tabindex="-1"></a>sequences: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb260-38"><a href="#cb260-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb260-39"><a href="#cb260-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> edge <span class="kw">in</span> format_trie(build_trie(sequences)):</span>
<span id="cb260-40"><a href="#cb260-40" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(edge)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-triematching" class="level1" data-number="87">
<h1 data-number="87"><span class="header-section-number">87</span> Implement TrieMatching</h1>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;and a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Text</em>&nbsp;where a string from&nbsp;<em>Patterns</em>&nbsp;appears as a substring.</p>
<section id="sample-dataset-87" class="level2" data-number="87.1">
<h2 data-number="87.1" class="anchored" data-anchor-id="sample-dataset-87"><span class="header-section-number">87.1</span> Sample Dataset</h2>
<pre><code>AATCGGGTTCAATCGGGGT
ATCG
GGGT</code></pre>
</section>
<section id="sample-output-87" class="level2" data-number="87.2">
<h2 data-number="87.2" class="anchored" data-anchor-id="sample-output-87"><span class="header-section-number">87.2</span> Sample Output</h2>
<pre><code>1 4 11 15</code></pre>
</section>
<section id="solution-87" class="level2" data-number="87.3">
<h2 data-number="87.3" class="anchored" data-anchor-id="solution-87"><span class="header-section-number">87.3</span> Solution</h2>
<div class="sourceCode" id="cb263"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb263-2"><a href="#cb263-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, DefaultDict, Set</span>
<span id="cb263-3"><a href="#cb263-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-4"><a href="#cb263-4" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb263-5"><a href="#cb263-5" aria-hidden="true" tabindex="-1"></a><span class="st">AATCGGGTTCAATCGGGGT</span></span>
<span id="cb263-6"><a href="#cb263-6" aria-hidden="true" tabindex="-1"></a><span class="st">ATCG</span></span>
<span id="cb263-7"><a href="#cb263-7" aria-hidden="true" tabindex="-1"></a><span class="st">GGGT</span></span>
<span id="cb263-8"><a href="#cb263-8" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb263-9"><a href="#cb263-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-10"><a href="#cb263-10" aria-hidden="true" tabindex="-1"></a>sequences: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb263-11"><a href="#cb263-11" aria-hidden="true" tabindex="-1"></a>main_sequence: <span class="bu">str</span> <span class="op">=</span> sequences[<span class="dv">0</span>]</span>
<span id="cb263-12"><a href="#cb263-12" aria-hidden="true" tabindex="-1"></a>kmers: List[<span class="bu">str</span>] <span class="op">=</span> sequences[<span class="dv">1</span>:]</span>
<span id="cb263-13"><a href="#cb263-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-14"><a href="#cb263-14" aria-hidden="true" tabindex="-1"></a>kmer_positions: DefaultDict[<span class="bu">str</span>, Set[<span class="bu">int</span>]] <span class="op">=</span> defaultdict(<span class="bu">set</span>)</span>
<span id="cb263-15"><a href="#cb263-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-16"><a href="#cb263-16" aria-hidden="true" tabindex="-1"></a>kmer_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(kmers[<span class="dv">0</span>])</span>
<span id="cb263-17"><a href="#cb263-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-18"><a href="#cb263-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_index <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(main_sequence) <span class="op">-</span> kmer_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb263-19"><a href="#cb263-19" aria-hidden="true" tabindex="-1"></a>    current_kmer: <span class="bu">str</span> <span class="op">=</span> main_sequence[start_index:start_index <span class="op">+</span> kmer_length]</span>
<span id="cb263-20"><a href="#cb263-20" aria-hidden="true" tabindex="-1"></a>    kmer_positions[current_kmer].add(start_index)</span>
<span id="cb263-21"><a href="#cb263-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-22"><a href="#cb263-22" aria-hidden="true" tabindex="-1"></a>all_positions: Set[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb263-23"><a href="#cb263-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> kmer <span class="kw">in</span> kmers:</span>
<span id="cb263-24"><a href="#cb263-24" aria-hidden="true" tabindex="-1"></a>    all_positions.update(kmer_positions[kmer])</span>
<span id="cb263-25"><a href="#cb263-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-26"><a href="#cb263-26" aria-hidden="true" tabindex="-1"></a>sorted_positions: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">sorted</span>(all_positions)</span>
<span id="cb263-27"><a href="#cb263-27" aria-hidden="true" tabindex="-1"></a>output: <span class="bu">str</span> <span class="op">=</span> <span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, sorted_positions))</span>
<span id="cb263-28"><a href="#cb263-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb263-29"><a href="#cb263-29" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(output)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-suffix-tree-of-a-string" class="level1" data-number="88">
<h1 data-number="88"><span class="header-section-number">88</span> Construct the Suffix Tree of a String</h1>
<p>Suffix Tree Construction Problem. Construct the suffix tree of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;The strings labeling the edges of&nbsp;<em>SuffixTree</em>(<em>Text</em>). (You may return these strings in any order.)</p>
<section id="sample-dataset-88" class="level2" data-number="88.1">
<h2 data-number="88.1" class="anchored" data-anchor-id="sample-dataset-88"><span class="header-section-number">88.1</span> Sample Dataset</h2>
<pre><code>ATAAATG$</code></pre>
</section>
<section id="sample-output-88" class="level2" data-number="88.2">
<h2 data-number="88.2" class="anchored" data-anchor-id="sample-output-88"><span class="header-section-number">88.2</span> Sample Output</h2>
<pre><code>AAATG$
G$
T
ATG$
TG$
A
A
AAATG$
G$
T
G$
$</code></pre>
</section>
<section id="solution-88" class="level2" data-number="88.3">
<h2 data-number="88.3" class="anchored" data-anchor-id="solution-88"><span class="header-section-number">88.3</span> Solution</h2>
<div class="sourceCode" id="cb266"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb266-1"><a href="#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Optional</span>
<span id="cb266-2"><a href="#cb266-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-3"><a href="#cb266-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Tree:</span>
<span id="cb266-4"><a href="#cb266-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Node:</span>
<span id="cb266-5"><a href="#cb266-5" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-6"><a href="#cb266-6" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.label: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-7"><a href="#cb266-7" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.edges: List[<span class="st">'Tree.Edge'</span>] <span class="op">=</span> []</span>
<span id="cb266-8"><a href="#cb266-8" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.indicator: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-9"><a href="#cb266-9" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.depth: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb266-10"><a href="#cb266-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-11"><a href="#cb266-11" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Edge:</span>
<span id="cb266-12"><a href="#cb266-12" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-13"><a href="#cb266-13" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.from_node: Optional[<span class="st">'Tree.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-14"><a href="#cb266-14" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.target_node: Optional[<span class="st">'Tree.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-15"><a href="#cb266-15" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.position: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-16"><a href="#cb266-16" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.length: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-17"><a href="#cb266-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-18"><a href="#cb266-18" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-19"><a href="#cb266-19" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes: List[Tree.Node] <span class="op">=</span> []</span>
<span id="cb266-20"><a href="#cb266-20" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges: List[Tree.Edge] <span class="op">=</span> []</span>
<span id="cb266-21"><a href="#cb266-21" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.root: Tree.Node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb266-22"><a href="#cb266-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-23"><a href="#cb266-23" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb266-24"><a href="#cb266-24" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Tree.Node()</span>
<span id="cb266-25"><a href="#cb266-25" aria-hidden="true" tabindex="-1"></a>        new_node.label <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.all_nodes)</span>
<span id="cb266-26"><a href="#cb266-26" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes.append(new_node)</span>
<span id="cb266-27"><a href="#cb266-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb266-28"><a href="#cb266-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-29"><a href="#cb266-29" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(<span class="va">self</span>, from_node: Node, target_node: Node, pos: <span class="bu">int</span>, length: <span class="bu">int</span>) <span class="op">-&gt;</span> Edge:</span>
<span id="cb266-30"><a href="#cb266-30" aria-hidden="true" tabindex="-1"></a>        new_edge <span class="op">=</span> Tree.Edge()</span>
<span id="cb266-31"><a href="#cb266-31" aria-hidden="true" tabindex="-1"></a>        new_edge.from_node <span class="op">=</span> from_node</span>
<span id="cb266-32"><a href="#cb266-32" aria-hidden="true" tabindex="-1"></a>        new_edge.target_node <span class="op">=</span> target_node</span>
<span id="cb266-33"><a href="#cb266-33" aria-hidden="true" tabindex="-1"></a>        new_edge.position <span class="op">=</span> pos</span>
<span id="cb266-34"><a href="#cb266-34" aria-hidden="true" tabindex="-1"></a>        new_edge.length <span class="op">=</span> length</span>
<span id="cb266-35"><a href="#cb266-35" aria-hidden="true" tabindex="-1"></a>        target_node.depth <span class="op">=</span> from_node.depth <span class="op">+</span> length</span>
<span id="cb266-36"><a href="#cb266-36" aria-hidden="true" tabindex="-1"></a>        from_node.edges.append(new_edge)</span>
<span id="cb266-37"><a href="#cb266-37" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges.append(new_edge)</span>
<span id="cb266-38"><a href="#cb266-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_edge</span>
<span id="cb266-39"><a href="#cb266-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-40"><a href="#cb266-40" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> edge_labels(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb266-41"><a href="#cb266-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [text[edge.position : edge.position <span class="op">+</span> edge.length] <span class="cf">for</span> edge <span class="kw">in</span> <span class="va">self</span>.all_edges]</span>
<span id="cb266-42"><a href="#cb266-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-43"><a href="#cb266-43" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> return_ripe_nodes(<span class="va">self</span>) <span class="op">-&gt;</span> List[Node]:</span>
<span id="cb266-44"><a href="#cb266-44" aria-hidden="true" tabindex="-1"></a>        ripe_nodes <span class="op">=</span> []</span>
<span id="cb266-45"><a href="#cb266-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="va">self</span>.all_nodes:</span>
<span id="cb266-46"><a href="#cb266-46" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> node.indicator <span class="kw">is</span> <span class="va">None</span> <span class="kw">and</span> <span class="bu">all</span>(edge.target_node.indicator <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="cf">for</span> edge <span class="kw">in</span> node.edges):</span>
<span id="cb266-47"><a href="#cb266-47" aria-hidden="true" tabindex="-1"></a>                ripe_nodes.append(node)</span>
<span id="cb266-48"><a href="#cb266-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> ripe_nodes</span>
<span id="cb266-49"><a href="#cb266-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-50"><a href="#cb266-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_indicators(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-51"><a href="#cb266-51" aria-hidden="true" tabindex="-1"></a>        ripe_nodes <span class="op">=</span> <span class="va">self</span>.return_ripe_nodes()</span>
<span id="cb266-52"><a href="#cb266-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> ripe_nodes:</span>
<span id="cb266-53"><a href="#cb266-53" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> node <span class="kw">in</span> ripe_nodes:</span>
<span id="cb266-54"><a href="#cb266-54" aria-hidden="true" tabindex="-1"></a>                children_indicators <span class="op">=</span> <span class="bu">set</span>(edge.target_node.indicator <span class="cf">for</span> edge <span class="kw">in</span> node.edges)</span>
<span id="cb266-55"><a href="#cb266-55" aria-hidden="true" tabindex="-1"></a>                node.indicator <span class="op">=</span> <span class="st">'*'</span> <span class="cf">if</span> <span class="bu">len</span>(children_indicators) <span class="op">!=</span> <span class="dv">1</span> <span class="cf">else</span> <span class="bu">next</span>(<span class="bu">iter</span>(children_indicators))</span>
<span id="cb266-56"><a href="#cb266-56" aria-hidden="true" tabindex="-1"></a>            ripe_nodes <span class="op">=</span> <span class="va">self</span>.return_ripe_nodes()</span>
<span id="cb266-57"><a href="#cb266-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-58"><a href="#cb266-58" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_suffix_tree(<span class="va">self</span>, trie_node: <span class="st">'Trie.Node'</span>, tree_node: Node, path: List[<span class="st">'Trie.Edge'</span>] <span class="op">=</span> []) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-59"><a href="#cb266-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> <span class="bu">len</span>(trie_node.edges) <span class="op">==</span> <span class="dv">1</span>:</span>
<span id="cb266-60"><a href="#cb266-60" aria-hidden="true" tabindex="-1"></a>            trie_edge <span class="op">=</span> trie_node.edges[<span class="dv">0</span>]</span>
<span id="cb266-61"><a href="#cb266-61" aria-hidden="true" tabindex="-1"></a>            path.append(trie_edge)</span>
<span id="cb266-62"><a href="#cb266-62" aria-hidden="true" tabindex="-1"></a>            trie_node <span class="op">=</span> trie_edge.target_node</span>
<span id="cb266-63"><a href="#cb266-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-64"><a href="#cb266-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> path:</span>
<span id="cb266-65"><a href="#cb266-65" aria-hidden="true" tabindex="-1"></a>            new_tree_node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb266-66"><a href="#cb266-66" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.add_edge(tree_node, new_tree_node, path[<span class="dv">0</span>].position, <span class="bu">len</span>(path))</span>
<span id="cb266-67"><a href="#cb266-67" aria-hidden="true" tabindex="-1"></a>            tree_node <span class="op">=</span> new_tree_node</span>
<span id="cb266-68"><a href="#cb266-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-69"><a href="#cb266-69" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> trie_node.edges:</span>
<span id="cb266-70"><a href="#cb266-70" aria-hidden="true" tabindex="-1"></a>            tree_node.indicator <span class="op">=</span> trie_node.indicator</span>
<span id="cb266-71"><a href="#cb266-71" aria-hidden="true" tabindex="-1"></a>            tree_node.label <span class="op">=</span> trie_node.label</span>
<span id="cb266-72"><a href="#cb266-72" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span></span>
<span id="cb266-73"><a href="#cb266-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-74"><a href="#cb266-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> trie_edge <span class="kw">in</span> trie_node.edges:</span>
<span id="cb266-75"><a href="#cb266-75" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.construct_suffix_tree(trie_edge.target_node, tree_node, [trie_edge])</span>
<span id="cb266-76"><a href="#cb266-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-77"><a href="#cb266-77" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> populate_suffix_tree(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-78"><a href="#cb266-78" aria-hidden="true" tabindex="-1"></a>        suffix_trie <span class="op">=</span> Trie()</span>
<span id="cb266-79"><a href="#cb266-79" aria-hidden="true" tabindex="-1"></a>        suffix_trie.construct_suffix_trie(text)</span>
<span id="cb266-80"><a href="#cb266-80" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.construct_suffix_tree(suffix_trie.root, <span class="va">self</span>.root)</span>
<span id="cb266-81"><a href="#cb266-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-82"><a href="#cb266-82" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Trie:</span>
<span id="cb266-83"><a href="#cb266-83" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Node:</span>
<span id="cb266-84"><a href="#cb266-84" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-85"><a href="#cb266-85" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.label: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-86"><a href="#cb266-86" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.edges: List[<span class="st">'Trie.Edge'</span>] <span class="op">=</span> []</span>
<span id="cb266-87"><a href="#cb266-87" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.indicator: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-88"><a href="#cb266-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-89"><a href="#cb266-89" aria-hidden="true" tabindex="-1"></a>    <span class="kw">class</span> Edge:</span>
<span id="cb266-90"><a href="#cb266-90" aria-hidden="true" tabindex="-1"></a>        <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-91"><a href="#cb266-91" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.from_node: Optional[<span class="st">'Trie.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-92"><a href="#cb266-92" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.target_node: Optional[<span class="st">'Trie.Node'</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-93"><a href="#cb266-93" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.label: Optional[<span class="bu">str</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-94"><a href="#cb266-94" aria-hidden="true" tabindex="-1"></a>            <span class="va">self</span>.position: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span></span>
<span id="cb266-95"><a href="#cb266-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-96"><a href="#cb266-96" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-97"><a href="#cb266-97" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes: List[Trie.Node] <span class="op">=</span> []</span>
<span id="cb266-98"><a href="#cb266-98" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges: List[Trie.Edge] <span class="op">=</span> []</span>
<span id="cb266-99"><a href="#cb266-99" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.root: Trie.Node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb266-100"><a href="#cb266-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-101"><a href="#cb266-101" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_node(<span class="va">self</span>) <span class="op">-&gt;</span> Node:</span>
<span id="cb266-102"><a href="#cb266-102" aria-hidden="true" tabindex="-1"></a>        new_node <span class="op">=</span> Trie.Node()</span>
<span id="cb266-103"><a href="#cb266-103" aria-hidden="true" tabindex="-1"></a>        new_node.label <span class="op">=</span> <span class="bu">len</span>(<span class="va">self</span>.all_nodes)</span>
<span id="cb266-104"><a href="#cb266-104" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_nodes.append(new_node)</span>
<span id="cb266-105"><a href="#cb266-105" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_node</span>
<span id="cb266-106"><a href="#cb266-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-107"><a href="#cb266-107" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(<span class="va">self</span>, from_node: Node, target_node: Node, label: <span class="bu">str</span>, pos: Optional[<span class="bu">int</span>] <span class="op">=</span> <span class="va">None</span>) <span class="op">-&gt;</span> Edge:</span>
<span id="cb266-108"><a href="#cb266-108" aria-hidden="true" tabindex="-1"></a>        new_edge <span class="op">=</span> Trie.Edge()</span>
<span id="cb266-109"><a href="#cb266-109" aria-hidden="true" tabindex="-1"></a>        new_edge.from_node <span class="op">=</span> from_node</span>
<span id="cb266-110"><a href="#cb266-110" aria-hidden="true" tabindex="-1"></a>        new_edge.target_node <span class="op">=</span> target_node</span>
<span id="cb266-111"><a href="#cb266-111" aria-hidden="true" tabindex="-1"></a>        new_edge.label <span class="op">=</span> label</span>
<span id="cb266-112"><a href="#cb266-112" aria-hidden="true" tabindex="-1"></a>        new_edge.position <span class="op">=</span> pos</span>
<span id="cb266-113"><a href="#cb266-113" aria-hidden="true" tabindex="-1"></a>        from_node.edges.append(new_edge)</span>
<span id="cb266-114"><a href="#cb266-114" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.all_edges.append(new_edge)</span>
<span id="cb266-115"><a href="#cb266-115" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> new_edge</span>
<span id="cb266-116"><a href="#cb266-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-117"><a href="#cb266-117" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> construct_suffix_trie(<span class="va">self</span>, text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb266-118"><a href="#cb266-118" aria-hidden="true" tabindex="-1"></a>        indicator <span class="op">=</span> <span class="st">'#'</span></span>
<span id="cb266-119"><a href="#cb266-119" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text)):</span>
<span id="cb266-120"><a href="#cb266-120" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> <span class="va">self</span>.root</span>
<span id="cb266-121"><a href="#cb266-121" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(text)):</span>
<span id="cb266-122"><a href="#cb266-122" aria-hidden="true" tabindex="-1"></a>                current_symbol <span class="op">=</span> text[j]</span>
<span id="cb266-123"><a href="#cb266-123" aria-hidden="true" tabindex="-1"></a>                next_node <span class="op">=</span> <span class="bu">next</span>((edge.target_node <span class="cf">for</span> edge <span class="kw">in</span> current_node.edges <span class="cf">if</span> edge.label <span class="op">==</span> current_symbol), <span class="va">None</span>)</span>
<span id="cb266-124"><a href="#cb266-124" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> next_node <span class="kw">is</span> <span class="va">None</span>:</span>
<span id="cb266-125"><a href="#cb266-125" aria-hidden="true" tabindex="-1"></a>                    new_node <span class="op">=</span> <span class="va">self</span>.add_node()</span>
<span id="cb266-126"><a href="#cb266-126" aria-hidden="true" tabindex="-1"></a>                    <span class="va">self</span>.add_edge(current_node, new_node, current_symbol, j)</span>
<span id="cb266-127"><a href="#cb266-127" aria-hidden="true" tabindex="-1"></a>                    current_node <span class="op">=</span> new_node</span>
<span id="cb266-128"><a href="#cb266-128" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb266-129"><a href="#cb266-129" aria-hidden="true" tabindex="-1"></a>                    current_node <span class="op">=</span> next_node</span>
<span id="cb266-130"><a href="#cb266-130" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="kw">not</span> current_node.edges:</span>
<span id="cb266-131"><a href="#cb266-131" aria-hidden="true" tabindex="-1"></a>                current_node.label <span class="op">=</span> <span class="ss">f'L</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">'</span></span>
<span id="cb266-132"><a href="#cb266-132" aria-hidden="true" tabindex="-1"></a>                current_node.indicator <span class="op">=</span> indicator</span>
<span id="cb266-133"><a href="#cb266-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> text[i] <span class="op">==</span> <span class="st">'#'</span>:</span>
<span id="cb266-134"><a href="#cb266-134" aria-hidden="true" tabindex="-1"></a>                indicator <span class="op">=</span> <span class="st">'$'</span></span>
<span id="cb266-135"><a href="#cb266-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-136"><a href="#cb266-136" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"ATAAATG$"</span></span>
<span id="cb266-137"><a href="#cb266-137" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split()</span>
<span id="cb266-138"><a href="#cb266-138" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb266-139"><a href="#cb266-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-140"><a href="#cb266-140" aria-hidden="true" tabindex="-1"></a>tree <span class="op">=</span> Tree()</span>
<span id="cb266-141"><a href="#cb266-141" aria-hidden="true" tabindex="-1"></a>tree.populate_suffix_tree(text)</span>
<span id="cb266-142"><a href="#cb266-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-143"><a href="#cb266-143" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> tree.edge_labels(text)</span>
<span id="cb266-144"><a href="#cb266-144" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>.join(result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-longest-repeat-in-a-string" class="level1" data-number="89">
<h1 data-number="89"><span class="header-section-number">89</span> Find the Longest Repeat in a String</h1>
<p>Longest Repeat Problem, Find the longest repeat in a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;A longest substring of&nbsp;<em>Text</em>&nbsp;that appears in&nbsp;<em>Text</em>&nbsp;more than once. (Multiple solutions may exist, in which case you may return any one.)</p>
<section id="sample-dataset-89" class="level2" data-number="89.1">
<h2 data-number="89.1" class="anchored" data-anchor-id="sample-dataset-89"><span class="header-section-number">89.1</span> Sample Dataset</h2>
<pre><code>ATATCGTTTTATCGTT</code></pre>
</section>
<section id="sample-output-89" class="level2" data-number="89.2">
<h2 data-number="89.2" class="anchored" data-anchor-id="sample-output-89"><span class="header-section-number">89.2</span> Sample Output</h2>
<pre><code>TATCGTT</code></pre>
</section>
<section id="solution-89" class="level2" data-number="89.3">
<h2 data-number="89.3" class="anchored" data-anchor-id="solution-89"><span class="header-section-number">89.3</span> Solution</h2>
<div class="sourceCode" id="cb269"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cache</span>
<span id="cb269-2"><a href="#cb269-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> commonprefix</span>
<span id="cb269-3"><a href="#cb269-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Generator, Iterator</span>
<span id="cb269-4"><a href="#cb269-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-5"><a href="#cb269-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_edges(graph: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb269-6"><a href="#cb269-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> key <span class="kw">in</span> graph.keys():</span>
<span id="cb269-7"><a href="#cb269-7" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> key</span>
<span id="cb269-8"><a href="#cb269-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> <span class="cf">from</span> get_edges(graph[key])</span>
<span id="cb269-9"><a href="#cb269-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-10"><a href="#cb269-10" aria-hidden="true" tabindex="-1"></a><span class="at">@cache</span></span>
<span id="cb269-11"><a href="#cb269-11" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suffix_tree(sequence: <span class="bu">str</span>, start_positions: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb269-12"><a href="#cb269-12" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">str</span>, Dict] <span class="op">=</span> {}</span>
<span id="cb269-13"><a href="#cb269-13" aria-hidden="true" tabindex="-1"></a>    unique_bases <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([sequence[start] <span class="cf">for</span> start <span class="kw">in</span> start_positions]))</span>
<span id="cb269-14"><a href="#cb269-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-15"><a href="#cb269-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> unique_bases:</span>
<span id="cb269-16"><a href="#cb269-16" aria-hidden="true" tabindex="-1"></a>        matching_positions <span class="op">=</span> [start <span class="cf">for</span> start <span class="kw">in</span> start_positions <span class="cf">if</span> sequence[start] <span class="op">==</span> base]</span>
<span id="cb269-17"><a href="#cb269-17" aria-hidden="true" tabindex="-1"></a>        subsequences <span class="op">=</span> [sequence[s:] <span class="cf">for</span> s <span class="kw">in</span> matching_positions]</span>
<span id="cb269-18"><a href="#cb269-18" aria-hidden="true" tabindex="-1"></a>        common_prefix <span class="op">=</span> commonprefix(subsequences)</span>
<span id="cb269-19"><a href="#cb269-19" aria-hidden="true" tabindex="-1"></a>        prefix_length <span class="op">=</span> <span class="bu">len</span>(common_prefix)</span>
<span id="cb269-20"><a href="#cb269-20" aria-hidden="true" tabindex="-1"></a>        new_start_positions <span class="op">=</span> [start <span class="op">+</span> prefix_length <span class="cf">for</span> start <span class="kw">in</span> matching_positions <span class="cf">if</span> start <span class="op">+</span> prefix_length <span class="op">&lt;</span> <span class="bu">len</span>(sequence)]</span>
<span id="cb269-21"><a href="#cb269-21" aria-hidden="true" tabindex="-1"></a>        tree[common_prefix] <span class="op">=</span> suffix_tree(sequence, <span class="bu">tuple</span>(new_start_positions))</span>
<span id="cb269-22"><a href="#cb269-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-23"><a href="#cb269-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb269-24"><a href="#cb269-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-25"><a href="#cb269-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_tree(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb269-26"><a href="#cb269-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> suffix_tree(sequence, <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="bu">len</span>(sequence))))</span>
<span id="cb269-27"><a href="#cb269-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-28"><a href="#cb269-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> internal_edges(tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Iterator[<span class="bu">str</span>]:</span>
<span id="cb269-29"><a href="#cb269-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> tree.keys():</span>
<span id="cb269-30"><a href="#cb269-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> <span class="bu">len</span>(tree[node]):</span>
<span id="cb269-31"><a href="#cb269-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> <span class="st">""</span></span>
<span id="cb269-32"><a href="#cb269-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child_edge <span class="kw">in</span> internal_edges(tree[node]):</span>
<span id="cb269-33"><a href="#cb269-33" aria-hidden="true" tabindex="-1"></a>            <span class="cf">yield</span> node <span class="op">+</span> child_edge</span>
<span id="cb269-34"><a href="#cb269-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-35"><a href="#cb269-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> longest_shared_substring(tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb269-36"><a href="#cb269-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(internal_edges(tree), key<span class="op">=</span><span class="kw">lambda</span> x: <span class="bu">len</span>(x))</span>
<span id="cb269-37"><a href="#cb269-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-38"><a href="#cb269-38" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb269-39"><a href="#cb269-39" aria-hidden="true" tabindex="-1"></a><span class="st">ATATCGTTTTATCGTT</span></span>
<span id="cb269-40"><a href="#cb269-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb269-41"><a href="#cb269-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb269-42"><a href="#cb269-42" aria-hidden="true" tabindex="-1"></a>sequence <span class="op">=</span> sample_input.strip()</span>
<span id="cb269-43"><a href="#cb269-43" aria-hidden="true" tabindex="-1"></a>suffix_tree <span class="op">=</span> create_suffix_tree(sequence)</span>
<span id="cb269-44"><a href="#cb269-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(longest_shared_substring(suffix_tree))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-longest-substring-shared-by-two-strings" class="level1" data-number="90">
<h1 data-number="90"><span class="header-section-number">90</span> Find the Longest Substring Shared by Two Strings</h1>
<p>Longest Shared Substring Problem. Find the longest substring shared by two strings.</p>
<p>Given:&nbsp;Strings&nbsp;_Text_1&nbsp;and&nbsp;_Text_2.</p>
<p>Return:&nbsp;The longest substring that occurs in both&nbsp;_Text_1&nbsp;and&nbsp;_Text_2. (Multiple solutions may exist, in which case you may return any one.)</p>
<section id="sample-dataset-90" class="level2" data-number="90.1">
<h2 data-number="90.1" class="anchored" data-anchor-id="sample-dataset-90"><span class="header-section-number">90.1</span> Sample Dataset</h2>
<pre><code>TCGGTAGATTGCGCCCACTC
AGGGGCTCGCAGTGTAAGAA</code></pre>
</section>
<section id="sample-output-90" class="level2" data-number="90.2">
<h2 data-number="90.2" class="anchored" data-anchor-id="sample-output-90"><span class="header-section-number">90.2</span> Sample Output</h2>
<pre><code>AGA</code></pre>
</section>
<section id="solution-90" class="level2" data-number="90.3">
<h2 data-number="90.3" class="anchored" data-anchor-id="solution-90"><span class="header-section-number">90.3</span> Solution</h2>
<div class="sourceCode" id="cb272"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb272-2"><a href="#cb272-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb272-3"><a href="#cb272-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cache</span>
<span id="cb272-4"><a href="#cb272-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> commonprefix</span>
<span id="cb272-5"><a href="#cb272-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple, Generator</span>
<span id="cb272-6"><a href="#cb272-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-7"><a href="#cb272-7" aria-hidden="true" tabindex="-1"></a><span class="at">@cache</span></span>
<span id="cb272-8"><a href="#cb272-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_suffix_tree(sequence: <span class="bu">str</span>, start_positions: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb272-9"><a href="#cb272-9" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">str</span>, Dict] <span class="op">=</span> {}</span>
<span id="cb272-10"><a href="#cb272-10" aria-hidden="true" tabindex="-1"></a>    unique_bases <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([sequence[start] <span class="cf">for</span> start <span class="kw">in</span> start_positions]))</span>
<span id="cb272-11"><a href="#cb272-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> unique_bases:</span>
<span id="cb272-12"><a href="#cb272-12" aria-hidden="true" tabindex="-1"></a>        matching_positions <span class="op">=</span> [start <span class="cf">for</span> start <span class="kw">in</span> start_positions <span class="cf">if</span> sequence[start] <span class="op">==</span> base]</span>
<span id="cb272-13"><a href="#cb272-13" aria-hidden="true" tabindex="-1"></a>        subsequences <span class="op">=</span> [sequence[s:] <span class="cf">for</span> s <span class="kw">in</span> matching_positions]</span>
<span id="cb272-14"><a href="#cb272-14" aria-hidden="true" tabindex="-1"></a>        common_prefix <span class="op">=</span> commonprefix(subsequences)</span>
<span id="cb272-15"><a href="#cb272-15" aria-hidden="true" tabindex="-1"></a>        prefix_length <span class="op">=</span> <span class="bu">len</span>(common_prefix)</span>
<span id="cb272-16"><a href="#cb272-16" aria-hidden="true" tabindex="-1"></a>        new_start_positions <span class="op">=</span> [start <span class="op">+</span> prefix_length <span class="cf">for</span> start <span class="kw">in</span> matching_positions <span class="cf">if</span> start <span class="op">+</span> prefix_length <span class="op">&lt;</span> <span class="bu">len</span>(sequence)]</span>
<span id="cb272-17"><a href="#cb272-17" aria-hidden="true" tabindex="-1"></a>        tree[common_prefix] <span class="op">=</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(new_start_positions))</span>
<span id="cb272-18"><a href="#cb272-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb272-19"><a href="#cb272-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-20"><a href="#cb272-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_tree(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb272-21"><a href="#cb272-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="bu">len</span>(sequence))))</span>
<span id="cb272-22"><a href="#cb272-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-23"><a href="#cb272-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_graph(suffix_tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb272-24"><a href="#cb272-24" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> build_graph_structure(subtree: Dict[<span class="bu">str</span>, Dict], graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], node_id: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb272-25"><a href="#cb272-25" aria-hidden="true" tabindex="-1"></a>        next_node_id <span class="op">=</span> node_id</span>
<span id="cb272-26"><a href="#cb272-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> <span class="bu">sorted</span>(subtree):</span>
<span id="cb272-27"><a href="#cb272-27" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb272-28"><a href="#cb272-28" aria-hidden="true" tabindex="-1"></a>            graph[node_id].append({<span class="st">"n"</span>: next_node_id, <span class="st">"l"</span>: edge})</span>
<span id="cb272-29"><a href="#cb272-29" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">=</span> build_graph_structure(subtree[edge], graph, next_node_id)</span>
<span id="cb272-30"><a href="#cb272-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> next_node_id</span>
<span id="cb272-31"><a href="#cb272-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-32"><a href="#cb272-32" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb272-33"><a href="#cb272-33" aria-hidden="true" tabindex="-1"></a>    build_graph_structure(suffix_tree, graph, <span class="dv">0</span>)</span>
<span id="cb272-34"><a href="#cb272-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb272-35"><a href="#cb272-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-36"><a href="#cb272-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_leaf_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb272-37"><a href="#cb272-37" aria-hidden="true" tabindex="-1"></a>    all_child_nodes <span class="op">=</span> <span class="bu">set</span>(node[<span class="st">"n"</span>] <span class="cf">for</span> nodes <span class="kw">in</span> graph.values() <span class="cf">for</span> node <span class="kw">in</span> nodes)</span>
<span id="cb272-38"><a href="#cb272-38" aria-hidden="true" tabindex="-1"></a>    parent_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb272-39"><a href="#cb272-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_child_nodes <span class="op">-</span> parent_nodes</span>
<span id="cb272-40"><a href="#cb272-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-41"><a href="#cb272-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph_structure(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb272-42"><a href="#cb272-42" aria-hidden="true" tabindex="-1"></a>    reversed_graph: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb272-43"><a href="#cb272-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parent_node, children <span class="kw">in</span> graph.items():</span>
<span id="cb272-44"><a href="#cb272-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> children:</span>
<span id="cb272-45"><a href="#cb272-45" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child[<span class="st">"n"</span>]] <span class="op">=</span> {<span class="st">"n"</span>: parent_node, <span class="st">"l"</span>: child[<span class="st">"l"</span>]}</span>
<span id="cb272-46"><a href="#cb272-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb272-47"><a href="#cb272-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-48"><a href="#cb272-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_purple_edges(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb272-49"><a href="#cb272-49" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _get_purple_edges(node: <span class="bu">int</span>, sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[<span class="bu">str</span>, <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb272-50"><a href="#cb272-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> colors[node] <span class="op">==</span> <span class="st">"purple"</span>:</span>
<span id="cb272-51"><a href="#cb272-51" aria-hidden="true" tabindex="-1"></a>            has_purple_child <span class="op">=</span> <span class="bu">any</span>(colors[child[<span class="st">"n"</span>]] <span class="op">==</span> <span class="st">"purple"</span> <span class="cf">for</span> child <span class="kw">in</span> tree[node])</span>
<span id="cb272-52"><a href="#cb272-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> has_purple_child:</span>
<span id="cb272-53"><a href="#cb272-53" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> child <span class="kw">in</span> tree[node]:</span>
<span id="cb272-54"><a href="#cb272-54" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">yield</span> <span class="cf">from</span> _get_purple_edges(child[<span class="st">"n"</span>], sequence <span class="op">+</span> child[<span class="st">"l"</span>])</span>
<span id="cb272-55"><a href="#cb272-55" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb272-56"><a href="#cb272-56" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> sequence</span>
<span id="cb272-57"><a href="#cb272-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-58"><a href="#cb272-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="cf">from</span> _get_purple_edges(<span class="dv">0</span>, <span class="st">""</span>)</span>
<span id="cb272-59"><a href="#cb272-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-60"><a href="#cb272-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_leaf_colors(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb272-61"><a href="#cb272-61" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph_structure(tree)</span>
<span id="cb272-62"><a href="#cb272-62" aria-hidden="true" tabindex="-1"></a>    colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="va">None</span>)</span>
<span id="cb272-63"><a href="#cb272-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> find_leaf_nodes(tree):</span>
<span id="cb272-64"><a href="#cb272-64" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> reversed_graph[leaf][<span class="st">"l"</span>]</span>
<span id="cb272-65"><a href="#cb272-65" aria-hidden="true" tabindex="-1"></a>        match <span class="op">=</span> re.search(<span class="vs">r"</span><span class="kw">(</span><span class="pp">[$#]</span><span class="kw">)</span><span class="vs">"</span>, edge)</span>
<span id="cb272-66"><a href="#cb272-66" aria-hidden="true" tabindex="-1"></a>        colors[leaf] <span class="op">=</span> <span class="st">"red"</span> <span class="cf">if</span> match.group() <span class="op">==</span> <span class="st">"$"</span> <span class="cf">else</span> <span class="st">"blue"</span></span>
<span id="cb272-67"><a href="#cb272-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb272-68"><a href="#cb272-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-69"><a href="#cb272-69" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_tree_nodes(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb272-70"><a href="#cb272-70" aria-hidden="true" tabindex="-1"></a>    nodes_to_process <span class="op">=</span> <span class="bu">list</span>(tree.keys())</span>
<span id="cb272-71"><a href="#cb272-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes_to_process:</span>
<span id="cb272-72"><a href="#cb272-72" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> nodes_to_process:</span>
<span id="cb272-73"><a href="#cb272-73" aria-hidden="true" tabindex="-1"></a>            child_colors <span class="op">=</span> [colors[child[<span class="st">"n"</span>]] <span class="cf">for</span> child <span class="kw">in</span> tree[node]]</span>
<span id="cb272-74"><a href="#cb272-74" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(child_colors):</span>
<span id="cb272-75"><a href="#cb272-75" aria-hidden="true" tabindex="-1"></a>                unique_colors <span class="op">=</span> <span class="bu">set</span>(child_colors)</span>
<span id="cb272-76"><a href="#cb272-76" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> unique_colors <span class="op">==</span> {<span class="st">"red"</span>}:</span>
<span id="cb272-77"><a href="#cb272-77" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb272-78"><a href="#cb272-78" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> unique_colors <span class="op">==</span> {<span class="st">"blue"</span>}:</span>
<span id="cb272-79"><a href="#cb272-79" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb272-80"><a href="#cb272-80" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb272-81"><a href="#cb272-81" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"purple"</span></span>
<span id="cb272-82"><a href="#cb272-82" aria-hidden="true" tabindex="-1"></a>                nodes_to_process.remove(node)</span>
<span id="cb272-83"><a href="#cb272-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb272-84"><a href="#cb272-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-85"><a href="#cb272-85" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_longest_shared_substring(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb272-86"><a href="#cb272-86" aria-hidden="true" tabindex="-1"></a>    combined_sequence <span class="op">=</span> seq1 <span class="op">+</span> <span class="st">"$"</span> <span class="op">+</span> seq2 <span class="op">+</span> <span class="st">"#"</span></span>
<span id="cb272-87"><a href="#cb272-87" aria-hidden="true" tabindex="-1"></a>    suffix_tree <span class="op">=</span> create_suffix_tree(combined_sequence)</span>
<span id="cb272-88"><a href="#cb272-88" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> convert_to_graph(suffix_tree)</span>
<span id="cb272-89"><a href="#cb272-89" aria-hidden="true" tabindex="-1"></a>    initial_colors <span class="op">=</span> initialize_leaf_colors(graph)</span>
<span id="cb272-90"><a href="#cb272-90" aria-hidden="true" tabindex="-1"></a>    final_colors <span class="op">=</span> color_tree_nodes(graph, initial_colors)</span>
<span id="cb272-91"><a href="#cb272-91" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">max</span>(get_purple_edges(graph, final_colors), key<span class="op">=</span><span class="bu">len</span>)</span>
<span id="cb272-92"><a href="#cb272-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb272-93"><a href="#cb272-93" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb272-94"><a href="#cb272-94" aria-hidden="true" tabindex="-1"></a><span class="st">TCGGTAGATTGCGCCCACTC</span></span>
<span id="cb272-95"><a href="#cb272-95" aria-hidden="true" tabindex="-1"></a><span class="st">AGGGGCTCGCAGTGTAAGAA</span></span>
<span id="cb272-96"><a href="#cb272-96" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb272-97"><a href="#cb272-97" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb272-98"><a href="#cb272-98" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(find_longest_shared_substring(sequence1, sequence2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-the-shortest-non-shared-substring-of-two-strings" class="level1" data-number="91">
<h1 data-number="91"><span class="header-section-number">91</span> Find the Shortest Non-Shared Substring of Two Strings</h1>
<p>Shortest Non-Shared Substring Problem. Find the shortest substring of one string that does not appear in another string.</p>
<p>Given:&nbsp;Strings&nbsp;_Text_1&nbsp;and&nbsp;_Text_2.</p>
<p>Return:&nbsp;The shortest substring of&nbsp;_Text_1&nbsp;that does not appear in&nbsp;_Text_2. (Multiple solutions may exist, in which case you may return any one.)</p>
<section id="sample-dataset-91" class="level2" data-number="91.1">
<h2 data-number="91.1" class="anchored" data-anchor-id="sample-dataset-91"><span class="header-section-number">91.1</span> Sample Dataset</h2>
<pre><code>CCAAGCTGCTAGAGG
CATGCTGGGCTGGCT</code></pre>
</section>
<section id="sample-output-91" class="level2" data-number="91.2">
<h2 data-number="91.2" class="anchored" data-anchor-id="sample-output-91"><span class="header-section-number">91.2</span> Sample Output</h2>
<pre><code>AA</code></pre>
</section>
<section id="solution-91" class="level2" data-number="91.3">
<h2 data-number="91.3" class="anchored" data-anchor-id="solution-91"><span class="header-section-number">91.3</span> Solution</h2>
<div class="sourceCode" id="cb275"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb275-1"><a href="#cb275-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> functools <span class="im">import</span> cache</span>
<span id="cb275-2"><a href="#cb275-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> os.path <span class="im">import</span> commonprefix</span>
<span id="cb275-3"><a href="#cb275-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Set</span>
<span id="cb275-4"><a href="#cb275-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb275-5"><a href="#cb275-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> re</span>
<span id="cb275-6"><a href="#cb275-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-7"><a href="#cb275-7" aria-hidden="true" tabindex="-1"></a><span class="at">@cache</span></span>
<span id="cb275-8"><a href="#cb275-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_suffix_tree(sequence: <span class="bu">str</span>, start_positions: Tuple[<span class="bu">int</span>, ...]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb275-9"><a href="#cb275-9" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">str</span>, Dict] <span class="op">=</span> {}</span>
<span id="cb275-10"><a href="#cb275-10" aria-hidden="true" tabindex="-1"></a>    unique_bases <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>([sequence[start] <span class="cf">for</span> start <span class="kw">in</span> start_positions]))</span>
<span id="cb275-11"><a href="#cb275-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> base <span class="kw">in</span> unique_bases:</span>
<span id="cb275-12"><a href="#cb275-12" aria-hidden="true" tabindex="-1"></a>        matching_positions <span class="op">=</span> [start <span class="cf">for</span> start <span class="kw">in</span> start_positions <span class="cf">if</span> sequence[start] <span class="op">==</span> base]</span>
<span id="cb275-13"><a href="#cb275-13" aria-hidden="true" tabindex="-1"></a>        subsequences <span class="op">=</span> [sequence[s:] <span class="cf">for</span> s <span class="kw">in</span> matching_positions]</span>
<span id="cb275-14"><a href="#cb275-14" aria-hidden="true" tabindex="-1"></a>        common_prefix <span class="op">=</span> commonprefix(subsequences)</span>
<span id="cb275-15"><a href="#cb275-15" aria-hidden="true" tabindex="-1"></a>        prefix_length <span class="op">=</span> <span class="bu">len</span>(common_prefix)</span>
<span id="cb275-16"><a href="#cb275-16" aria-hidden="true" tabindex="-1"></a>        new_start_positions <span class="op">=</span> [start <span class="op">+</span> prefix_length <span class="cf">for</span> start <span class="kw">in</span> matching_positions <span class="cf">if</span> start <span class="op">+</span> prefix_length <span class="op">&lt;</span> <span class="bu">len</span>(sequence)]</span>
<span id="cb275-17"><a href="#cb275-17" aria-hidden="true" tabindex="-1"></a>        tree[common_prefix] <span class="op">=</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(new_start_positions))</span>
<span id="cb275-18"><a href="#cb275-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb275-19"><a href="#cb275-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-20"><a href="#cb275-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_tree(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict]:</span>
<span id="cb275-21"><a href="#cb275-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> build_suffix_tree(sequence, <span class="bu">tuple</span>(<span class="bu">range</span>(<span class="bu">len</span>(sequence))))</span>
<span id="cb275-22"><a href="#cb275-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-23"><a href="#cb275-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_leaf_nodes(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Set[<span class="bu">int</span>]:</span>
<span id="cb275-24"><a href="#cb275-24" aria-hidden="true" tabindex="-1"></a>    all_child_nodes <span class="op">=</span> <span class="bu">set</span>(node[<span class="st">"n"</span>] <span class="cf">for</span> nodes <span class="kw">in</span> graph.values() <span class="cf">for</span> node <span class="kw">in</span> nodes)</span>
<span id="cb275-25"><a href="#cb275-25" aria-hidden="true" tabindex="-1"></a>    parent_nodes <span class="op">=</span> <span class="bu">set</span>(graph.keys())</span>
<span id="cb275-26"><a href="#cb275-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> all_child_nodes <span class="op">-</span> parent_nodes</span>
<span id="cb275-27"><a href="#cb275-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-28"><a href="#cb275-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> reverse_graph_structure(graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb275-29"><a href="#cb275-29" aria-hidden="true" tabindex="-1"></a>    reversed_graph: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> {}</span>
<span id="cb275-30"><a href="#cb275-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> parent, children <span class="kw">in</span> graph.items():</span>
<span id="cb275-31"><a href="#cb275-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> child <span class="kw">in</span> children:</span>
<span id="cb275-32"><a href="#cb275-32" aria-hidden="true" tabindex="-1"></a>            reversed_graph[child[<span class="st">"n"</span>]] <span class="op">=</span> {<span class="st">"n"</span>: parent, <span class="st">"l"</span>: child[<span class="st">"l"</span>]}</span>
<span id="cb275-33"><a href="#cb275-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> reversed_graph</span>
<span id="cb275-34"><a href="#cb275-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-35"><a href="#cb275-35" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_graph(suffix_tree: Dict[<span class="bu">str</span>, Dict]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb275-36"><a href="#cb275-36" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> build_graph_structure(subtree: Dict[<span class="bu">str</span>, Dict], graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], node_id: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb275-37"><a href="#cb275-37" aria-hidden="true" tabindex="-1"></a>        next_node_id <span class="op">=</span> node_id</span>
<span id="cb275-38"><a href="#cb275-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> <span class="bu">sorted</span>(subtree):</span>
<span id="cb275-39"><a href="#cb275-39" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb275-40"><a href="#cb275-40" aria-hidden="true" tabindex="-1"></a>            graph[node_id].append({<span class="st">"n"</span>: next_node_id, <span class="st">"l"</span>: edge})</span>
<span id="cb275-41"><a href="#cb275-41" aria-hidden="true" tabindex="-1"></a>            next_node_id <span class="op">=</span> build_graph_structure(subtree[edge], graph, next_node_id)</span>
<span id="cb275-42"><a href="#cb275-42" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> next_node_id</span>
<span id="cb275-43"><a href="#cb275-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-44"><a href="#cb275-44" aria-hidden="true" tabindex="-1"></a>    graph: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb275-45"><a href="#cb275-45" aria-hidden="true" tabindex="-1"></a>    build_graph_structure(suffix_tree, graph, <span class="dv">0</span>)</span>
<span id="cb275-46"><a href="#cb275-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb275-47"><a href="#cb275-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-48"><a href="#cb275-48" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> initialize_leaf_colors(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb275-49"><a href="#cb275-49" aria-hidden="true" tabindex="-1"></a>    reversed_graph <span class="op">=</span> reverse_graph_structure(tree)</span>
<span id="cb275-50"><a href="#cb275-50" aria-hidden="true" tabindex="-1"></a>    colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="va">None</span>)</span>
<span id="cb275-51"><a href="#cb275-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> leaf <span class="kw">in</span> find_leaf_nodes(tree):</span>
<span id="cb275-52"><a href="#cb275-52" aria-hidden="true" tabindex="-1"></a>        edge <span class="op">=</span> reversed_graph[leaf][<span class="st">"l"</span>]</span>
<span id="cb275-53"><a href="#cb275-53" aria-hidden="true" tabindex="-1"></a>        match <span class="op">=</span> re.search(<span class="vs">r"</span><span class="kw">(</span><span class="pp">[$#]</span><span class="kw">)</span><span class="vs">"</span>, edge)</span>
<span id="cb275-54"><a href="#cb275-54" aria-hidden="true" tabindex="-1"></a>        colors[leaf] <span class="op">=</span> <span class="st">"red"</span> <span class="cf">if</span> match <span class="kw">and</span> match.group() <span class="op">==</span> <span class="st">"$"</span> <span class="cf">else</span> <span class="st">"blue"</span></span>
<span id="cb275-55"><a href="#cb275-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb275-56"><a href="#cb275-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-57"><a href="#cb275-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_tree_nodes(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">str</span>]:</span>
<span id="cb275-58"><a href="#cb275-58" aria-hidden="true" tabindex="-1"></a>    nodes_to_process <span class="op">=</span> <span class="bu">list</span>(tree.keys())</span>
<span id="cb275-59"><a href="#cb275-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> nodes_to_process:</span>
<span id="cb275-60"><a href="#cb275-60" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> nodes_to_process[:]:</span>
<span id="cb275-61"><a href="#cb275-61" aria-hidden="true" tabindex="-1"></a>            child_colors <span class="op">=</span> [colors[n[<span class="st">"n"</span>]] <span class="cf">for</span> n <span class="kw">in</span> tree[node]]</span>
<span id="cb275-62"><a href="#cb275-62" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">all</span>(child_colors):</span>
<span id="cb275-63"><a href="#cb275-63" aria-hidden="true" tabindex="-1"></a>                unique_colors <span class="op">=</span> <span class="bu">set</span>(child_colors)</span>
<span id="cb275-64"><a href="#cb275-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> unique_colors <span class="op">==</span> {<span class="st">"red"</span>}:</span>
<span id="cb275-65"><a href="#cb275-65" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb275-66"><a href="#cb275-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> unique_colors <span class="op">==</span> {<span class="st">"blue"</span>}:</span>
<span id="cb275-67"><a href="#cb275-67" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb275-68"><a href="#cb275-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb275-69"><a href="#cb275-69" aria-hidden="true" tabindex="-1"></a>                    colors[node] <span class="op">=</span> <span class="st">"purple"</span></span>
<span id="cb275-70"><a href="#cb275-70" aria-hidden="true" tabindex="-1"></a>                nodes_to_process.remove(node)</span>
<span id="cb275-71"><a href="#cb275-71" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> colors</span>
<span id="cb275-72"><a href="#cb275-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-73"><a href="#cb275-73" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_non_purple_edges(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], colors: Dict[<span class="bu">int</span>, <span class="bu">str</span>]):</span>
<span id="cb275-74"><a href="#cb275-74" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> _find_non_purple_edges(node: <span class="bu">int</span>, sequence: List[<span class="bu">str</span>], path: List[<span class="bu">int</span>]):</span>
<span id="cb275-75"><a href="#cb275-75" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> colors[node] <span class="op">==</span> <span class="st">"purple"</span>:</span>
<span id="cb275-76"><a href="#cb275-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> child <span class="kw">in</span> tree[node]:</span>
<span id="cb275-77"><a href="#cb275-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> <span class="cf">from</span> _find_non_purple_edges(child[<span class="st">"n"</span>], sequence <span class="op">+</span> [child[<span class="st">"l"</span>]], path <span class="op">+</span> [node])</span>
<span id="cb275-78"><a href="#cb275-78" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb275-79"><a href="#cb275-79" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> colors[node] <span class="op">==</span> <span class="st">"red"</span>:</span>
<span id="cb275-80"><a href="#cb275-80" aria-hidden="true" tabindex="-1"></a>                sequence[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> sequence[<span class="op">-</span><span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb275-81"><a href="#cb275-81" aria-hidden="true" tabindex="-1"></a>                joined_sequence <span class="op">=</span> <span class="st">""</span>.join(sequence)</span>
<span id="cb275-82"><a href="#cb275-82" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="st">"#"</span> <span class="kw">not</span> <span class="kw">in</span> joined_sequence <span class="kw">and</span> <span class="st">"$"</span> <span class="kw">not</span> <span class="kw">in</span> joined_sequence:</span>
<span id="cb275-83"><a href="#cb275-83" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">yield</span> joined_sequence</span>
<span id="cb275-84"><a href="#cb275-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-85"><a href="#cb275-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> <span class="cf">from</span> _find_non_purple_edges(<span class="dv">0</span>, [], [])</span>
<span id="cb275-86"><a href="#cb275-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-87"><a href="#cb275-87" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_shortest_nonshared_substring(seq1: <span class="bu">str</span>, seq2: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb275-88"><a href="#cb275-88" aria-hidden="true" tabindex="-1"></a>    combined_sequence <span class="op">=</span> seq1 <span class="op">+</span> <span class="st">"$"</span> <span class="op">+</span> seq2 <span class="op">+</span> <span class="st">"#"</span></span>
<span id="cb275-89"><a href="#cb275-89" aria-hidden="true" tabindex="-1"></a>    suffix_tree <span class="op">=</span> create_suffix_tree(combined_sequence)</span>
<span id="cb275-90"><a href="#cb275-90" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> convert_to_graph(suffix_tree)</span>
<span id="cb275-91"><a href="#cb275-91" aria-hidden="true" tabindex="-1"></a>    initial_colors <span class="op">=</span> initialize_leaf_colors(graph)</span>
<span id="cb275-92"><a href="#cb275-92" aria-hidden="true" tabindex="-1"></a>    final_colors <span class="op">=</span> color_tree_nodes(graph, initial_colors)</span>
<span id="cb275-93"><a href="#cb275-93" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">min</span>(find_non_purple_edges(graph, final_colors), key<span class="op">=</span><span class="bu">len</span>)</span>
<span id="cb275-94"><a href="#cb275-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-95"><a href="#cb275-95" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb275-96"><a href="#cb275-96" aria-hidden="true" tabindex="-1"></a><span class="st">CCAAGCTGCTAGAGG</span></span>
<span id="cb275-97"><a href="#cb275-97" aria-hidden="true" tabindex="-1"></a><span class="st">CATGCTGGGCTGGCT</span></span>
<span id="cb275-98"><a href="#cb275-98" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb275-99"><a href="#cb275-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb275-100"><a href="#cb275-100" aria-hidden="true" tabindex="-1"></a>sequence1, sequence2 <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb275-101"><a href="#cb275-101" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(find_shortest_nonshared_substring(sequence1, sequence2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-suffix-array-of-a-string" class="level1" data-number="92">
<h1 data-number="92"><span class="header-section-number">92</span> Construct the Suffix Array of a String</h1>
<p>Suffix Array Construction Problem. Construct the suffix array of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;<em>SuffixArray</em>(<em>Text</em>).</p>
<section id="sample-dataset-92" class="level2" data-number="92.1">
<h2 data-number="92.1" class="anchored" data-anchor-id="sample-dataset-92"><span class="header-section-number">92.1</span> Sample Dataset</h2>
<pre><code>AACGATAGCGGTAGA$</code></pre>
</section>
<section id="sample-output-92" class="level2" data-number="92.2">
<h2 data-number="92.2" class="anchored" data-anchor-id="sample-output-92"><span class="header-section-number">92.2</span> Sample Output</h2>
<pre><code>15, 14, 0, 1, 12, 6, 4, 2, 8, 13, 3, 7, 9, 10, 11, 5</code></pre>
</section>
<section id="solution-92" class="level2" data-number="92.3">
<h2 data-number="92.3" class="anchored" data-anchor-id="solution-92"><span class="header-section-number">92.3</span> Solution</h2>
<div class="sourceCode" id="cb278"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb278-2"><a href="#cb278-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-3"><a href="#cb278-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb278-4"><a href="#cb278-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb278-5"><a href="#cb278-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a suffix array for the given text.</span></span>
<span id="cb278-6"><a href="#cb278-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-7"><a href="#cb278-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb278-8"><a href="#cb278-8" aria-hidden="true" tabindex="-1"></a><span class="co">    text (str): The input string to create a suffix array for.</span></span>
<span id="cb278-9"><a href="#cb278-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-10"><a href="#cb278-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb278-11"><a href="#cb278-11" aria-hidden="true" tabindex="-1"></a><span class="co">    List[int]: A list of indices representing the suffix array.</span></span>
<span id="cb278-12"><a href="#cb278-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb278-13"><a href="#cb278-13" aria-hidden="true" tabindex="-1"></a>    suffixes <span class="op">=</span> [(i, text[i:]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))]</span>
<span id="cb278-14"><a href="#cb278-14" aria-hidden="true" tabindex="-1"></a>    sorted_suffixes <span class="op">=</span> <span class="bu">sorted</span>(suffixes, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb278-15"><a href="#cb278-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [index <span class="cf">for</span> index, _ <span class="kw">in</span> sorted_suffixes]</span>
<span id="cb278-16"><a href="#cb278-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb278-17"><a href="#cb278-17" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"AACGATAGCGGTAGA$"</span></span>
<span id="cb278-18"><a href="#cb278-18" aria-hidden="true" tabindex="-1"></a>suffix_array <span class="op">=</span> create_suffix_array(sample_input.strip())</span>
<span id="cb278-19"><a href="#cb278-19" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span>suffix_array, sep<span class="op">=</span><span class="st">", "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="pattern-matching-with-the-suffix-array" class="level1" data-number="93">
<h1 data-number="93"><span class="header-section-number">93</span> Pattern Matching with the Suffix Array</h1>
<p>Multiple Pattern Matching with the Suffix Array.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;and a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Text</em>&nbsp;where a string from&nbsp;<em>Patterns</em>&nbsp;appears as a substring.</p>
<section id="sample-dataset-93" class="level2" data-number="93.1">
<h2 data-number="93.1" class="anchored" data-anchor-id="sample-dataset-93"><span class="header-section-number">93.1</span> Sample Dataset</h2>
<pre><code>AATCGGGTTCAATCGGGGT
ATCG
GGGT</code></pre>
</section>
<section id="sample-output-93" class="level2" data-number="93.2">
<h2 data-number="93.2" class="anchored" data-anchor-id="sample-output-93"><span class="header-section-number">93.2</span> Sample Output</h2>
<pre><code>1 4 11 15</code></pre>
</section>
<section id="solution-93" class="level2" data-number="93.3">
<h2 data-number="93.3" class="anchored" data-anchor-id="solution-93"><span class="header-section-number">93.3</span> Solution</h2>
<div class="sourceCode" id="cb281"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb281-1"><a href="#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb281-2"><a href="#cb281-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-3"><a href="#cb281-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb281-4"><a href="#cb281-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb281-5"><a href="#cb281-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a suffix array for the given text.</span></span>
<span id="cb281-6"><a href="#cb281-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-7"><a href="#cb281-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb281-8"><a href="#cb281-8" aria-hidden="true" tabindex="-1"></a><span class="co">    text (str): The input string to create a suffix array for.</span></span>
<span id="cb281-9"><a href="#cb281-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-10"><a href="#cb281-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb281-11"><a href="#cb281-11" aria-hidden="true" tabindex="-1"></a><span class="co">    List[int]: A list of indices representing the suffix array.</span></span>
<span id="cb281-12"><a href="#cb281-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb281-13"><a href="#cb281-13" aria-hidden="true" tabindex="-1"></a>    suffixes: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> [(i, text[i:]) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))]</span>
<span id="cb281-14"><a href="#cb281-14" aria-hidden="true" tabindex="-1"></a>    sorted_suffixes: List[Tuple[<span class="bu">int</span>, <span class="bu">str</span>]] <span class="op">=</span> <span class="bu">sorted</span>(suffixes, key<span class="op">=</span><span class="kw">lambda</span> x: x[<span class="dv">1</span>])</span>
<span id="cb281-15"><a href="#cb281-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [index <span class="cf">for</span> index, _ <span class="kw">in</span> sorted_suffixes]</span>
<span id="cb281-16"><a href="#cb281-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-17"><a href="#cb281-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_occurrences(text: <span class="bu">str</span>, pattern: <span class="bu">str</span>, suffix_array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb281-18"><a href="#cb281-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb281-19"><a href="#cb281-19" aria-hidden="true" tabindex="-1"></a><span class="co">    Find all occurrences of a pattern in the text using the suffix array.</span></span>
<span id="cb281-20"><a href="#cb281-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-21"><a href="#cb281-21" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb281-22"><a href="#cb281-22" aria-hidden="true" tabindex="-1"></a><span class="co">    text (str): The input text to search in.</span></span>
<span id="cb281-23"><a href="#cb281-23" aria-hidden="true" tabindex="-1"></a><span class="co">    pattern (str): The pattern to search for.</span></span>
<span id="cb281-24"><a href="#cb281-24" aria-hidden="true" tabindex="-1"></a><span class="co">    suffix_array (List[int]): The suffix array of the text.</span></span>
<span id="cb281-25"><a href="#cb281-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-26"><a href="#cb281-26" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb281-27"><a href="#cb281-27" aria-hidden="true" tabindex="-1"></a><span class="co">    List[int]: A list of indices where the pattern occurs in the text.</span></span>
<span id="cb281-28"><a href="#cb281-28" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb281-29"><a href="#cb281-29" aria-hidden="true" tabindex="-1"></a>    lower_bound: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb281-30"><a href="#cb281-30" aria-hidden="true" tabindex="-1"></a>    upper_bound: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(text)</span>
<span id="cb281-31"><a href="#cb281-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-32"><a href="#cb281-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> lower_bound <span class="op">&lt;</span> upper_bound:</span>
<span id="cb281-33"><a href="#cb281-33" aria-hidden="true" tabindex="-1"></a>        mid_point: <span class="bu">int</span> <span class="op">=</span> (lower_bound <span class="op">+</span> upper_bound) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb281-34"><a href="#cb281-34" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pattern <span class="op">&gt;</span> text[suffix_array[mid_point]:][: <span class="bu">len</span>(pattern)]:</span>
<span id="cb281-35"><a href="#cb281-35" aria-hidden="true" tabindex="-1"></a>            lower_bound <span class="op">=</span> mid_point <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb281-36"><a href="#cb281-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb281-37"><a href="#cb281-37" aria-hidden="true" tabindex="-1"></a>            upper_bound <span class="op">=</span> mid_point</span>
<span id="cb281-38"><a href="#cb281-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-39"><a href="#cb281-39" aria-hidden="true" tabindex="-1"></a>    first_occurrence: <span class="bu">int</span> <span class="op">=</span> lower_bound</span>
<span id="cb281-40"><a href="#cb281-40" aria-hidden="true" tabindex="-1"></a>    upper_bound <span class="op">=</span> <span class="bu">len</span>(text)</span>
<span id="cb281-41"><a href="#cb281-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-42"><a href="#cb281-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> lower_bound <span class="op">&lt;</span> upper_bound:</span>
<span id="cb281-43"><a href="#cb281-43" aria-hidden="true" tabindex="-1"></a>        mid_point: <span class="bu">int</span> <span class="op">=</span> (lower_bound <span class="op">+</span> upper_bound) <span class="op">//</span> <span class="dv">2</span></span>
<span id="cb281-44"><a href="#cb281-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pattern <span class="op">&lt;</span> text[suffix_array[mid_point]:][: <span class="bu">len</span>(pattern)]:</span>
<span id="cb281-45"><a href="#cb281-45" aria-hidden="true" tabindex="-1"></a>            upper_bound <span class="op">=</span> mid_point</span>
<span id="cb281-46"><a href="#cb281-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb281-47"><a href="#cb281-47" aria-hidden="true" tabindex="-1"></a>            lower_bound <span class="op">=</span> mid_point <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb281-48"><a href="#cb281-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-49"><a href="#cb281-49" aria-hidden="true" tabindex="-1"></a>    last_occurrence: <span class="bu">int</span> <span class="op">=</span> upper_bound</span>
<span id="cb281-50"><a href="#cb281-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-51"><a href="#cb281-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> first_occurrence <span class="op">&gt;</span> last_occurrence:</span>
<span id="cb281-52"><a href="#cb281-52" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb281-53"><a href="#cb281-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb281-54"><a href="#cb281-54" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">range</span>(first_occurrence, last_occurrence))</span>
<span id="cb281-55"><a href="#cb281-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-56"><a href="#cb281-56" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb281-57"><a href="#cb281-57" aria-hidden="true" tabindex="-1"></a><span class="st">AATCGGGTTCAATCGGGGT</span></span>
<span id="cb281-58"><a href="#cb281-58" aria-hidden="true" tabindex="-1"></a><span class="st">ATCG</span></span>
<span id="cb281-59"><a href="#cb281-59" aria-hidden="true" tabindex="-1"></a><span class="st">GGGT</span></span>
<span id="cb281-60"><a href="#cb281-60" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb281-61"><a href="#cb281-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-62"><a href="#cb281-62" aria-hidden="true" tabindex="-1"></a>sequence, <span class="op">*</span>patterns <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb281-63"><a href="#cb281-63" aria-hidden="true" tabindex="-1"></a>suffix_array: List[<span class="bu">int</span>] <span class="op">=</span> create_suffix_array(sequence)</span>
<span id="cb281-64"><a href="#cb281-64" aria-hidden="true" tabindex="-1"></a>matching_indices: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb281-65"><a href="#cb281-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-66"><a href="#cb281-66" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb281-67"><a href="#cb281-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> index <span class="kw">in</span> find_pattern_occurrences(sequence, pattern, suffix_array):</span>
<span id="cb281-68"><a href="#cb281-68" aria-hidden="true" tabindex="-1"></a>        matching_indices.append(suffix_array[index])</span>
<span id="cb281-69"><a href="#cb281-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb281-70"><a href="#cb281-70" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(<span class="bu">set</span>(matching_indices)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-burrows-wheeler-transform-of-a-string" class="level1" data-number="94">
<h1 data-number="94"><span class="header-section-number">94</span> Construct the Burrows-Wheeler Transform of a String</h1>
<p>Burrows-Wheeler Transform Construction Problem.Construct the Burrows-Wheeler transform of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>.</p>
<p>Return:&nbsp;<em>BWT</em>(<em>Text</em>).</p>
<section id="sample-dataset-94" class="level2" data-number="94.1">
<h2 data-number="94.1" class="anchored" data-anchor-id="sample-dataset-94"><span class="header-section-number">94.1</span> Sample Dataset</h2>
<pre><code>GCGTGCCTGGTCA$</code></pre>
</section>
<section id="sample-output-94" class="level2" data-number="94.2">
<h2 data-number="94.2" class="anchored" data-anchor-id="sample-output-94"><span class="header-section-number">94.2</span> Sample Output</h2>
<pre><code>ACTGGCT$TGCGGC</code></pre>
</section>
<section id="solution-94" class="level2" data-number="94.3">
<h2 data-number="94.3" class="anchored" data-anchor-id="solution-94"><span class="header-section-number">94.3</span> Solution</h2>
<div class="sourceCode" id="cb284"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb284-1"><a href="#cb284-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List</span>
<span id="cb284-2"><a href="#cb284-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-3"><a href="#cb284-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb284-4"><a href="#cb284-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb284-5"><a href="#cb284-5" aria-hidden="true" tabindex="-1"></a><span class="co">    Create a suffix array for the given text.</span></span>
<span id="cb284-6"><a href="#cb284-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-7"><a href="#cb284-7" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb284-8"><a href="#cb284-8" aria-hidden="true" tabindex="-1"></a><span class="co">    text (str): The input string to create a suffix array for.</span></span>
<span id="cb284-9"><a href="#cb284-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-10"><a href="#cb284-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb284-11"><a href="#cb284-11" aria-hidden="true" tabindex="-1"></a><span class="co">    List[int]: A list of indices representing the suffix array.</span></span>
<span id="cb284-12"><a href="#cb284-12" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb284-13"><a href="#cb284-13" aria-hidden="true" tabindex="-1"></a>    suffixes <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">range</span>(<span class="bu">len</span>(text)), key<span class="op">=</span><span class="kw">lambda</span> i: text[i:])</span>
<span id="cb284-14"><a href="#cb284-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> suffixes</span>
<span id="cb284-15"><a href="#cb284-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-16"><a href="#cb284-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb284-17"><a href="#cb284-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb284-18"><a href="#cb284-18" aria-hidden="true" tabindex="-1"></a><span class="co">    Perform the Burrows-Wheeler Transform on the input sequence.</span></span>
<span id="cb284-19"><a href="#cb284-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-20"><a href="#cb284-20" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb284-21"><a href="#cb284-21" aria-hidden="true" tabindex="-1"></a><span class="co">    sequence (str): The input string to transform.</span></span>
<span id="cb284-22"><a href="#cb284-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-23"><a href="#cb284-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb284-24"><a href="#cb284-24" aria-hidden="true" tabindex="-1"></a><span class="co">    str: The Burrows-Wheeler Transform of the input sequence.</span></span>
<span id="cb284-25"><a href="#cb284-25" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb284-26"><a href="#cb284-26" aria-hidden="true" tabindex="-1"></a>    suffix_array <span class="op">=</span> create_suffix_array(sequence)</span>
<span id="cb284-27"><a href="#cb284-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(sequence[i <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> suffix_array)</span>
<span id="cb284-28"><a href="#cb284-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb284-29"><a href="#cb284-29" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"GCGTGCCTGGTCA$"</span></span>
<span id="cb284-30"><a href="#cb284-30" aria-hidden="true" tabindex="-1"></a>transformed_sequence <span class="op">=</span> burrows_wheeler_transform(sample_input.strip())</span>
<span id="cb284-31"><a href="#cb284-31" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(transformed_sequence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="reconstruct-a-string-from-its-burrows-wheeler-transform" class="level1" data-number="95">
<h1 data-number="95"><span class="header-section-number">95</span> Reconstruct a String from its Burrows-Wheeler Transform</h1>
<p>Inverse Burrows-Wheeler Transform Problem. Reconstruct a string from its Burrows-Wheeler transform.</p>
<p>Given:&nbsp;A string&nbsp;<em>Transform</em>&nbsp;(with a single “$” sign).</p>
<p>Return:&nbsp;The string&nbsp;<em>Text</em>&nbsp;such that&nbsp;<em>BWT</em>(<em>Text</em>) =&nbsp;<em>Transform</em>.</p>
<section id="sample-dataset-95" class="level2" data-number="95.1">
<h2 data-number="95.1" class="anchored" data-anchor-id="sample-dataset-95"><span class="header-section-number">95.1</span> Sample Dataset</h2>
<pre><code>TTCCTAACG$A</code></pre>
</section>
<section id="sample-output-95" class="level2" data-number="95.2">
<h2 data-number="95.2" class="anchored" data-anchor-id="sample-output-95"><span class="header-section-number">95.2</span> Sample Output</h2>
<pre><code>TACATCACGT$</code></pre>
</section>
<section id="solution-95" class="level2" data-number="95.3">
<h2 data-number="95.3" class="anchored" data-anchor-id="solution-95"><span class="header-section-number">95.3</span> Solution</h2>
<div class="sourceCode" id="cb287"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb287-2"><a href="#cb287-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Generator</span>
<span id="cb287-3"><a href="#cb287-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-4"><a href="#cb287-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> index_characters(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb287-5"><a href="#cb287-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb287-6"><a href="#cb287-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Generate each character with its occurrence number in the sequence.</span></span>
<span id="cb287-7"><a href="#cb287-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-8"><a href="#cb287-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb287-9"><a href="#cb287-9" aria-hidden="true" tabindex="-1"></a><span class="co">    sequence (str): The input string to index.</span></span>
<span id="cb287-10"><a href="#cb287-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-11"><a href="#cb287-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Yields:</span></span>
<span id="cb287-12"><a href="#cb287-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Tuple[str, int]: A tuple containing the character and its occurrence number.</span></span>
<span id="cb287-13"><a href="#cb287-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb287-14"><a href="#cb287-14" aria-hidden="true" tabindex="-1"></a>    char_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb287-15"><a href="#cb287-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> sequence:</span>
<span id="cb287-16"><a href="#cb287-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> char, char_counts[char]</span>
<span id="cb287-17"><a href="#cb287-17" aria-hidden="true" tabindex="-1"></a>        char_counts[char] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb287-18"><a href="#cb287-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-19"><a href="#cb287-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform_inverse(bwt_sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb287-20"><a href="#cb287-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb287-21"><a href="#cb287-21" aria-hidden="true" tabindex="-1"></a><span class="co">    Perform the inverse Burrows-Wheeler Transform on the input sequence.</span></span>
<span id="cb287-22"><a href="#cb287-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-23"><a href="#cb287-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb287-24"><a href="#cb287-24" aria-hidden="true" tabindex="-1"></a><span class="co">    bwt_sequence (str): The Burrows-Wheeler transformed string.</span></span>
<span id="cb287-25"><a href="#cb287-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-26"><a href="#cb287-26" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb287-27"><a href="#cb287-27" aria-hidden="true" tabindex="-1"></a><span class="co">    str: The original string before BWT.</span></span>
<span id="cb287-28"><a href="#cb287-28" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb287-29"><a href="#cb287-29" aria-hidden="true" tabindex="-1"></a>    first_column <span class="op">=</span> <span class="bu">list</span>(index_characters(<span class="bu">sorted</span>(bwt_sequence)))</span>
<span id="cb287-30"><a href="#cb287-30" aria-hidden="true" tabindex="-1"></a>    last_column <span class="op">=</span> <span class="bu">list</span>(index_characters(bwt_sequence))</span>
<span id="cb287-31"><a href="#cb287-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-32"><a href="#cb287-32" aria-hidden="true" tabindex="-1"></a>    current_char: Tuple[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> (<span class="st">"$"</span>, <span class="dv">0</span>)</span>
<span id="cb287-33"><a href="#cb287-33" aria-hidden="true" tabindex="-1"></a>    original_sequence: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb287-34"><a href="#cb287-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-35"><a href="#cb287-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(bwt_sequence)):</span>
<span id="cb287-36"><a href="#cb287-36" aria-hidden="true" tabindex="-1"></a>        current_char <span class="op">=</span> first_column[last_column.index(current_char)]</span>
<span id="cb287-37"><a href="#cb287-37" aria-hidden="true" tabindex="-1"></a>        original_sequence.append(current_char[<span class="dv">0</span>])</span>
<span id="cb287-38"><a href="#cb287-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-39"><a href="#cb287-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">''</span>.join(original_sequence)</span>
<span id="cb287-40"><a href="#cb287-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb287-41"><a href="#cb287-41" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"TTCCTAACG$A"</span></span>
<span id="cb287-42"><a href="#cb287-42" aria-hidden="true" tabindex="-1"></a>original_sequence <span class="op">=</span> burrows_wheeler_transform_inverse(sample_input.strip())</span>
<span id="cb287-43"><a href="#cb287-43" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(original_sequence)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="generate-the-last-to-first-mapping-of-a-string" class="level1" data-number="96">
<h1 data-number="96"><span class="header-section-number">96</span> Generate the Last-to-First Mapping of a String</h1>
<p>Last-to-First Mapping Problem.</p>
<p>Given:&nbsp;A string&nbsp;<em>Transform</em>&nbsp;and an integer&nbsp;<em>i</em>.</p>
<p>Return:&nbsp;The position&nbsp;<em>LastToFirst</em>(<em>i</em>) in&nbsp;<em>FirstColumn</em>&nbsp;in the Burrows-Wheeler matrix if&nbsp;<em>LastColumn</em>&nbsp;=&nbsp;<em>Transform</em>.</p>
<section id="sample-dataset-96" class="level2" data-number="96.1">
<h2 data-number="96.1" class="anchored" data-anchor-id="sample-dataset-96"><span class="header-section-number">96.1</span> Sample Dataset</h2>
<pre><code>T$GACCA
3</code></pre>
</section>
<section id="sample-output-96" class="level2" data-number="96.2">
<h2 data-number="96.2" class="anchored" data-anchor-id="sample-output-96"><span class="header-section-number">96.2</span> Sample Output</h2>
<pre><code>1</code></pre>
</section>
<section id="solution-96" class="level2" data-number="96.3">
<h2 data-number="96.3" class="anchored" data-anchor-id="solution-96"><span class="header-section-number">96.3</span> Solution</h2>
<div class="sourceCode" id="cb290"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb290-1"><a href="#cb290-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb290-2"><a href="#cb290-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Generator</span>
<span id="cb290-3"><a href="#cb290-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-4"><a href="#cb290-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> index_characters(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Generator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>], <span class="va">None</span>, <span class="va">None</span>]:</span>
<span id="cb290-5"><a href="#cb290-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb290-6"><a href="#cb290-6" aria-hidden="true" tabindex="-1"></a><span class="co">    Generate each character with its occurrence number in the sequence.</span></span>
<span id="cb290-7"><a href="#cb290-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-8"><a href="#cb290-8" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb290-9"><a href="#cb290-9" aria-hidden="true" tabindex="-1"></a><span class="co">    sequence (str): The input string to index.</span></span>
<span id="cb290-10"><a href="#cb290-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-11"><a href="#cb290-11" aria-hidden="true" tabindex="-1"></a><span class="co">    Yields:</span></span>
<span id="cb290-12"><a href="#cb290-12" aria-hidden="true" tabindex="-1"></a><span class="co">    Tuple[str, int]: A tuple containing the character and its occurrence number.</span></span>
<span id="cb290-13"><a href="#cb290-13" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb290-14"><a href="#cb290-14" aria-hidden="true" tabindex="-1"></a>    char_counts <span class="op">=</span> defaultdict(<span class="bu">int</span>)</span>
<span id="cb290-15"><a href="#cb290-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> char <span class="kw">in</span> sequence:</span>
<span id="cb290-16"><a href="#cb290-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> char, char_counts[char]</span>
<span id="cb290-17"><a href="#cb290-17" aria-hidden="true" tabindex="-1"></a>        char_counts[char] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb290-18"><a href="#cb290-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-19"><a href="#cb290-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> last_to_first_mapping(sequence: <span class="bu">str</span>, index: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb290-20"><a href="#cb290-20" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb290-21"><a href="#cb290-21" aria-hidden="true" tabindex="-1"></a><span class="co">    Find the mapping from Last column to First column in the Burrows-Wheeler Transform matrix.</span></span>
<span id="cb290-22"><a href="#cb290-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-23"><a href="#cb290-23" aria-hidden="true" tabindex="-1"></a><span class="co">    Args:</span></span>
<span id="cb290-24"><a href="#cb290-24" aria-hidden="true" tabindex="-1"></a><span class="co">    sequence (str): The input string (Last column of BWT matrix).</span></span>
<span id="cb290-25"><a href="#cb290-25" aria-hidden="true" tabindex="-1"></a><span class="co">    index (int): The index in the Last column.</span></span>
<span id="cb290-26"><a href="#cb290-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-27"><a href="#cb290-27" aria-hidden="true" tabindex="-1"></a><span class="co">    Returns:</span></span>
<span id="cb290-28"><a href="#cb290-28" aria-hidden="true" tabindex="-1"></a><span class="co">    int: The corresponding index in the First column.</span></span>
<span id="cb290-29"><a href="#cb290-29" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb290-30"><a href="#cb290-30" aria-hidden="true" tabindex="-1"></a>    first_column <span class="op">=</span> <span class="bu">list</span>(index_characters(<span class="bu">sorted</span>(sequence)))</span>
<span id="cb290-31"><a href="#cb290-31" aria-hidden="true" tabindex="-1"></a>    last_column <span class="op">=</span> <span class="bu">list</span>(index_characters(sequence))</span>
<span id="cb290-32"><a href="#cb290-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> first_column.index(last_column[index])</span>
<span id="cb290-33"><a href="#cb290-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-34"><a href="#cb290-34" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb290-35"><a href="#cb290-35" aria-hidden="true" tabindex="-1"></a><span class="st">T$GACCA</span></span>
<span id="cb290-36"><a href="#cb290-36" aria-hidden="true" tabindex="-1"></a><span class="st">3</span></span>
<span id="cb290-37"><a href="#cb290-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb290-38"><a href="#cb290-38" aria-hidden="true" tabindex="-1"></a>sequence, index_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb290-39"><a href="#cb290-39" aria-hidden="true" tabindex="-1"></a>index <span class="op">=</span> <span class="bu">int</span>(index_str)</span>
<span id="cb290-40"><a href="#cb290-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb290-41"><a href="#cb290-41" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> last_to_first_mapping(sequence.strip(), index)</span>
<span id="cb290-42"><a href="#cb290-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-bwmatching" class="level1" data-number="97">
<h1 data-number="97"><span class="header-section-number">97</span> Implement BWMatching</h1>
<p>Implement. BWMatching.</p>
<p>Given:&nbsp;A string&nbsp;<em>BWT</em>(<em>Text</em>), followed by a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;A list of integers, where the&nbsp;<em>i</em>-th integer corresponds to the number of substring matches of the&nbsp;<em>i</em>-th member of&nbsp;<em>Patterns</em>&nbsp;in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-97" class="level2" data-number="97.1">
<h2 data-number="97.1" class="anchored" data-anchor-id="sample-dataset-97"><span class="header-section-number">97.1</span> Sample Dataset</h2>
<pre><code>TCCTCTATGAGATCCTATTCTATGAAACCTTCA$GACCAAAATTCTCCGGC
CCT CAC GAG CAG ATC</code></pre>
</section>
<section id="sample-output-97" class="level2" data-number="97.2">
<h2 data-number="97.2" class="anchored" data-anchor-id="sample-output-97"><span class="header-section-number">97.2</span> Sample Output</h2>
<pre><code>2 1 1 0 1</code></pre>
</section>
<section id="solution-97" class="level2" data-number="97.3">
<h2 data-number="97.3" class="anchored" data-anchor-id="solution-97"><span class="header-section-number">97.3</span> Solution</h2>
<div class="sourceCode" id="cb293"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb293-2"><a href="#cb293-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-3"><a href="#cb293-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> BWMatching(bwt: <span class="bu">str</span>, patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb293-4"><a href="#cb293-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> create_count_and_first_occurrence(bwt: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]], Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb293-5"><a href="#cb293-5" aria-hidden="true" tabindex="-1"></a>        count: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {char: [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(bwt) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> char <span class="kw">in</span> <span class="bu">set</span>(bwt)}</span>
<span id="cb293-6"><a href="#cb293-6" aria-hidden="true" tabindex="-1"></a>        first_occurrence: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {}</span>
<span id="cb293-7"><a href="#cb293-7" aria-hidden="true" tabindex="-1"></a>        sorted_bwt: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">sorted</span>(bwt)</span>
<span id="cb293-8"><a href="#cb293-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-9"><a href="#cb293-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(bwt):</span>
<span id="cb293-10"><a href="#cb293-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> c <span class="kw">in</span> count:</span>
<span id="cb293-11"><a href="#cb293-11" aria-hidden="true" tabindex="-1"></a>                count[c][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> count[c][i]</span>
<span id="cb293-12"><a href="#cb293-12" aria-hidden="true" tabindex="-1"></a>            count[char][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb293-13"><a href="#cb293-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-14"><a href="#cb293-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sorted_bwt):</span>
<span id="cb293-15"><a href="#cb293-15" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="kw">not</span> <span class="kw">in</span> first_occurrence:</span>
<span id="cb293-16"><a href="#cb293-16" aria-hidden="true" tabindex="-1"></a>                first_occurrence[char] <span class="op">=</span> i</span>
<span id="cb293-17"><a href="#cb293-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-18"><a href="#cb293-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> count, first_occurrence</span>
<span id="cb293-19"><a href="#cb293-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-20"><a href="#cb293-20" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> count_matches(pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb293-21"><a href="#cb293-21" aria-hidden="true" tabindex="-1"></a>        top: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb293-22"><a href="#cb293-22" aria-hidden="true" tabindex="-1"></a>        bottom: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(bwt) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb293-23"><a href="#cb293-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> top <span class="op">&lt;=</span> bottom:</span>
<span id="cb293-24"><a href="#cb293-24" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pattern:</span>
<span id="cb293-25"><a href="#cb293-25" aria-hidden="true" tabindex="-1"></a>                symbol: <span class="bu">str</span> <span class="op">=</span> pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb293-26"><a href="#cb293-26" aria-hidden="true" tabindex="-1"></a>                pattern <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb293-27"><a href="#cb293-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> symbol <span class="kw">in</span> bwt[top:bottom<span class="op">+</span><span class="dv">1</span>]:</span>
<span id="cb293-28"><a href="#cb293-28" aria-hidden="true" tabindex="-1"></a>                    top <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count[symbol][top]</span>
<span id="cb293-29"><a href="#cb293-29" aria-hidden="true" tabindex="-1"></a>                    bottom <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count[symbol][bottom<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb293-30"><a href="#cb293-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb293-31"><a href="#cb293-31" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb293-32"><a href="#cb293-32" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb293-33"><a href="#cb293-33" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> bottom <span class="op">-</span> top <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb293-34"><a href="#cb293-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-35"><a href="#cb293-35" aria-hidden="true" tabindex="-1"></a>    count, first_occurrence <span class="op">=</span> create_count_and_first_occurrence(bwt)</span>
<span id="cb293-36"><a href="#cb293-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_matches(pattern) <span class="cf">for</span> pattern <span class="kw">in</span> patterns]</span>
<span id="cb293-37"><a href="#cb293-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-38"><a href="#cb293-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb293-39"><a href="#cb293-39" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb293-40"><a href="#cb293-40" aria-hidden="true" tabindex="-1"></a><span class="st">TCCTCTATGAGATCCTATTCTATGAAACCTTCA$GACCAAAATTCTCCGGC</span></span>
<span id="cb293-41"><a href="#cb293-41" aria-hidden="true" tabindex="-1"></a><span class="st">CCT CAC GAG CAG ATC</span></span>
<span id="cb293-42"><a href="#cb293-42" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb293-43"><a href="#cb293-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-44"><a href="#cb293-44" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb293-45"><a href="#cb293-45" aria-hidden="true" tabindex="-1"></a>bwt: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb293-46"><a href="#cb293-46" aria-hidden="true" tabindex="-1"></a>patterns: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>].split()</span>
<span id="cb293-47"><a href="#cb293-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb293-48"><a href="#cb293-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the BWMatching algorithm</span></span>
<span id="cb293-49"><a href="#cb293-49" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> BWMatching(bwt, patterns)</span>
<span id="cb293-50"><a href="#cb293-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-betterbwmatching" class="level1" data-number="98">
<h1 data-number="98"><span class="header-section-number">98</span> Implement BetterBWMatching</h1>
<p>Given:&nbsp;A string&nbsp;<em>BWT</em>(<em>Text</em>), followed by a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;A list of integers, where the&nbsp;<em>i</em>-th integer corresponds to the number of substring matches of the&nbsp;<em>i</em>-th member of&nbsp;<em>Patterns</em>&nbsp;in&nbsp;<em>Text</em>.</p>
<section id="sample-dataset-98" class="level2" data-number="98.1">
<h2 data-number="98.1" class="anchored" data-anchor-id="sample-dataset-98"><span class="header-section-number">98.1</span> Sample Dataset</h2>
<pre><code>GGCGCCGC$TAGTCACACACGCCGTA
ACC CCG CAG</code></pre>
</section>
<section id="sample-output-98" class="level2" data-number="98.2">
<h2 data-number="98.2" class="anchored" data-anchor-id="sample-output-98"><span class="header-section-number">98.2</span> Sample Output</h2>
<pre><code>1 2 1</code></pre>
</section>
<section id="solution-98" class="level2" data-number="98.3">
<h2 data-number="98.3" class="anchored" data-anchor-id="solution-98"><span class="header-section-number">98.3</span> Solution</h2>
<div class="sourceCode" id="cb296"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb296-1"><a href="#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb296-2"><a href="#cb296-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-3"><a href="#cb296-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> BetterBWMatching(bwt: <span class="bu">str</span>, patterns: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb296-4"><a href="#cb296-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> preprocess_bwt(bwt: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[List[<span class="bu">str</span>], Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]], Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb296-5"><a href="#cb296-5" aria-hidden="true" tabindex="-1"></a>        first_column: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">sorted</span>(bwt)</span>
<span id="cb296-6"><a href="#cb296-6" aria-hidden="true" tabindex="-1"></a>        count: Dict[<span class="bu">str</span>, List[<span class="bu">int</span>]] <span class="op">=</span> {char: [<span class="dv">0</span>] <span class="op">*</span> (<span class="bu">len</span>(bwt) <span class="op">+</span> <span class="dv">1</span>) <span class="cf">for</span> char <span class="kw">in</span> <span class="bu">set</span>(bwt)}</span>
<span id="cb296-7"><a href="#cb296-7" aria-hidden="true" tabindex="-1"></a>        start_index: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {char: first_column.index(char) <span class="cf">for</span> char <span class="kw">in</span> <span class="bu">set</span>(bwt)}</span>
<span id="cb296-8"><a href="#cb296-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-9"><a href="#cb296-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(bwt):</span>
<span id="cb296-10"><a href="#cb296-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> c <span class="kw">in</span> count:</span>
<span id="cb296-11"><a href="#cb296-11" aria-hidden="true" tabindex="-1"></a>                count[c][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">=</span> count[c][i]</span>
<span id="cb296-12"><a href="#cb296-12" aria-hidden="true" tabindex="-1"></a>            count[char][i <span class="op">+</span> <span class="dv">1</span>] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb296-13"><a href="#cb296-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-14"><a href="#cb296-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> first_column, count, start_index</span>
<span id="cb296-15"><a href="#cb296-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-16"><a href="#cb296-16" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> count_occurrences(pattern: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb296-17"><a href="#cb296-17" aria-hidden="true" tabindex="-1"></a>        top: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb296-18"><a href="#cb296-18" aria-hidden="true" tabindex="-1"></a>        bottom: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(bwt) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb296-19"><a href="#cb296-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-20"><a href="#cb296-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> top <span class="op">&lt;=</span> bottom:</span>
<span id="cb296-21"><a href="#cb296-21" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> pattern:</span>
<span id="cb296-22"><a href="#cb296-22" aria-hidden="true" tabindex="-1"></a>                symbol: <span class="bu">str</span> <span class="op">=</span> pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb296-23"><a href="#cb296-23" aria-hidden="true" tabindex="-1"></a>                pattern <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb296-24"><a href="#cb296-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> symbol <span class="kw">in</span> bwt[top:bottom<span class="op">+</span><span class="dv">1</span>]:</span>
<span id="cb296-25"><a href="#cb296-25" aria-hidden="true" tabindex="-1"></a>                    top <span class="op">=</span> start_index[symbol] <span class="op">+</span> count[symbol][top]</span>
<span id="cb296-26"><a href="#cb296-26" aria-hidden="true" tabindex="-1"></a>                    bottom <span class="op">=</span> start_index[symbol] <span class="op">+</span> count[symbol][bottom<span class="op">+</span><span class="dv">1</span>] <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb296-27"><a href="#cb296-27" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb296-28"><a href="#cb296-28" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="dv">0</span></span>
<span id="cb296-29"><a href="#cb296-29" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb296-30"><a href="#cb296-30" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> bottom <span class="op">-</span> top <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb296-31"><a href="#cb296-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-32"><a href="#cb296-32" aria-hidden="true" tabindex="-1"></a>    first_column, count, start_index <span class="op">=</span> preprocess_bwt(bwt)</span>
<span id="cb296-33"><a href="#cb296-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [count_occurrences(pattern) <span class="cf">for</span> pattern <span class="kw">in</span> patterns]</span>
<span id="cb296-34"><a href="#cb296-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-35"><a href="#cb296-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb296-36"><a href="#cb296-36" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb296-37"><a href="#cb296-37" aria-hidden="true" tabindex="-1"></a><span class="st">GGCGCCGC$TAGTCACACACGCCGTA</span></span>
<span id="cb296-38"><a href="#cb296-38" aria-hidden="true" tabindex="-1"></a><span class="st">ACC CCG CAG</span></span>
<span id="cb296-39"><a href="#cb296-39" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb296-40"><a href="#cb296-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-41"><a href="#cb296-41" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb296-42"><a href="#cb296-42" aria-hidden="true" tabindex="-1"></a>bwt: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb296-43"><a href="#cb296-43" aria-hidden="true" tabindex="-1"></a>patterns: List[<span class="bu">str</span>] <span class="op">=</span> input_lines[<span class="dv">1</span>].split()</span>
<span id="cb296-44"><a href="#cb296-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb296-45"><a href="#cb296-45" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the BetterBWMatching algorithm</span></span>
<span id="cb296-46"><a href="#cb296-46" aria-hidden="true" tabindex="-1"></a>result: List[<span class="bu">int</span>] <span class="op">=</span> BetterBWMatching(bwt, patterns)</span>
<span id="cb296-47"><a href="#cb296-47" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">" "</span>.join(<span class="bu">map</span>(<span class="bu">str</span>, result)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-occurrences-of-a-collection-of-patterns-in-a-string" class="level1" data-number="99">
<h1 data-number="99"><span class="header-section-number">99</span> Find All Occurrences of a Collection of Patterns in a String</h1>
<p>Multiple Pattern Matching Problem. Find all occurrences of a collection of patterns in a text.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;and a collection of strings&nbsp;<em>Patterns</em>.</p>
<p>Return:&nbsp;All starting positions in&nbsp;<em>Text</em>&nbsp;where a string from&nbsp;<em>Patterns</em>&nbsp;appears as a substring.</p>
<section id="sample-dataset-99" class="level2" data-number="99.1">
<h2 data-number="99.1" class="anchored" data-anchor-id="sample-dataset-99"><span class="header-section-number">99.1</span> Sample Dataset</h2>
<pre><code>AATCGGGTTCAATCGGGGT
ATCG
GGGT</code></pre>
</section>
<section id="sample-output-99" class="level2" data-number="99.2">
<h2 data-number="99.2" class="anchored" data-anchor-id="sample-output-99"><span class="header-section-number">99.2</span> Sample Output</h2>
<pre><code>1 4 11 15</code></pre>
</section>
<section id="solution-99" class="level2" data-number="99.3">
<h2 data-number="99.3" class="anchored" data-anchor-id="solution-99"><span class="header-section-number">99.3</span> Solution</h2>
<div class="sourceCode" id="cb299"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb299-2"><a href="#cb299-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-3"><a href="#cb299-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform(text: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb299-4"><a href="#cb299-4" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(text)</span>
<span id="cb299-5"><a href="#cb299-5" aria-hidden="true" tabindex="-1"></a>    rotations <span class="op">=</span> <span class="bu">sorted</span>([text[i:] <span class="op">+</span> text[:i] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n)])</span>
<span id="cb299-6"><a href="#cb299-6" aria-hidden="true" tabindex="-1"></a>    bwt <span class="op">=</span> <span class="st">''</span>.join([rot[<span class="op">-</span><span class="dv">1</span>] <span class="cf">for</span> rot <span class="kw">in</span> rotations])</span>
<span id="cb299-7"><a href="#cb299-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> bwt</span>
<span id="cb299-8"><a href="#cb299-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-9"><a href="#cb299-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_checkpoint_array(bwt: <span class="bu">str</span>, checkpoint_interval: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb299-10"><a href="#cb299-10" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">list</span>(<span class="bu">set</span>(bwt))</span>
<span id="cb299-11"><a href="#cb299-11" aria-hidden="true" tabindex="-1"></a>    checkpoint_array <span class="op">=</span> {}</span>
<span id="cb299-12"><a href="#cb299-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(bwt), checkpoint_interval):</span>
<span id="cb299-13"><a href="#cb299-13" aria-hidden="true" tabindex="-1"></a>        checkpoint_array[idx] <span class="op">=</span> {symbol: bwt[:idx].count(symbol) <span class="cf">for</span> symbol <span class="kw">in</span> symbols}</span>
<span id="cb299-14"><a href="#cb299-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> checkpoint_array</span>
<span id="cb299-15"><a href="#cb299-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-16"><a href="#cb299-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_symbol(checkpoint_array: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]], idx: <span class="bu">int</span>, last_column: <span class="bu">str</span>, symbol: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb299-17"><a href="#cb299-17" aria-hidden="true" tabindex="-1"></a>    checkpoints <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> checkpoint_array.keys() <span class="cf">if</span> x <span class="op">&lt;=</span> idx]</span>
<span id="cb299-18"><a href="#cb299-18" aria-hidden="true" tabindex="-1"></a>    nearest_checkpoint <span class="op">=</span> <span class="bu">max</span>(checkpoints)</span>
<span id="cb299-19"><a href="#cb299-19" aria-hidden="true" tabindex="-1"></a>    count <span class="op">=</span> checkpoint_array[nearest_checkpoint][symbol]</span>
<span id="cb299-20"><a href="#cb299-20" aria-hidden="true" tabindex="-1"></a>    count <span class="op">+=</span> last_column[nearest_checkpoint:idx].count(symbol)</span>
<span id="cb299-21"><a href="#cb299-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count</span>
<span id="cb299-22"><a href="#cb299-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-23"><a href="#cb299-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_partial_suffix_array(text: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb299-24"><a href="#cb299-24" aria-hidden="true" tabindex="-1"></a>    suffixes <span class="op">=</span> [(text[i:], i) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))]</span>
<span id="cb299-25"><a href="#cb299-25" aria-hidden="true" tabindex="-1"></a>    sorted_suffixes <span class="op">=</span> <span class="bu">sorted</span>(suffixes)</span>
<span id="cb299-26"><a href="#cb299-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {i: pos <span class="cf">for</span> i, (_, pos) <span class="kw">in</span> <span class="bu">enumerate</span>(sorted_suffixes) <span class="cf">if</span> pos <span class="op">%</span> k <span class="op">==</span> <span class="dv">0</span>}</span>
<span id="cb299-27"><a href="#cb299-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-28"><a href="#cb299-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> multiple_pattern_matching(first_occurrence: Dict[<span class="bu">str</span>, <span class="bu">int</span>], last_column: <span class="bu">str</span>, pattern: <span class="bu">str</span>, checkpoint_array: Dict[<span class="bu">int</span>, Dict[<span class="bu">str</span>, <span class="bu">int</span>]]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb299-29"><a href="#cb299-29" aria-hidden="true" tabindex="-1"></a>    top <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb299-30"><a href="#cb299-30" aria-hidden="true" tabindex="-1"></a>    bottom <span class="op">=</span> <span class="bu">len</span>(last_column) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb299-31"><a href="#cb299-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-32"><a href="#cb299-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> top <span class="op">&lt;=</span> bottom:</span>
<span id="cb299-33"><a href="#cb299-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> pattern:</span>
<span id="cb299-34"><a href="#cb299-34" aria-hidden="true" tabindex="-1"></a>            symbol <span class="op">=</span> pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb299-35"><a href="#cb299-35" aria-hidden="true" tabindex="-1"></a>            pattern <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb299-36"><a href="#cb299-36" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> symbol <span class="kw">in</span> last_column[top: bottom <span class="op">+</span> <span class="dv">1</span>]:</span>
<span id="cb299-37"><a href="#cb299-37" aria-hidden="true" tabindex="-1"></a>                top <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count_symbol(checkpoint_array, top, last_column, symbol)</span>
<span id="cb299-38"><a href="#cb299-38" aria-hidden="true" tabindex="-1"></a>                bottom <span class="op">=</span> first_occurrence[symbol] <span class="op">+</span> count_symbol(checkpoint_array, bottom <span class="op">+</span> <span class="dv">1</span>, last_column, symbol) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb299-39"><a href="#cb299-39" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb299-40"><a href="#cb299-40" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span></span>
<span id="cb299-41"><a href="#cb299-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb299-42"><a href="#cb299-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> top, bottom</span>
<span id="cb299-43"><a href="#cb299-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="op">-</span><span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span></span>
<span id="cb299-44"><a href="#cb299-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-45"><a href="#cb299-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_pattern_occurrences(text: <span class="bu">str</span>, patterns: List[<span class="bu">str</span>], checkpoint_interval: <span class="bu">int</span> <span class="op">=</span> <span class="dv">100</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb299-46"><a href="#cb299-46" aria-hidden="true" tabindex="-1"></a>    bwt <span class="op">=</span> burrows_wheeler_transform(text <span class="op">+</span> <span class="st">'$'</span>)</span>
<span id="cb299-47"><a href="#cb299-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-48"><a href="#cb299-48" aria-hidden="true" tabindex="-1"></a>    first_occurrence <span class="op">=</span> {}</span>
<span id="cb299-49"><a href="#cb299-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> idx, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(<span class="bu">sorted</span>(bwt)):</span>
<span id="cb299-50"><a href="#cb299-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> symbol <span class="kw">not</span> <span class="kw">in</span> first_occurrence:</span>
<span id="cb299-51"><a href="#cb299-51" aria-hidden="true" tabindex="-1"></a>            first_occurrence[symbol] <span class="op">=</span> idx</span>
<span id="cb299-52"><a href="#cb299-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-53"><a href="#cb299-53" aria-hidden="true" tabindex="-1"></a>    checkpoint_array <span class="op">=</span> create_checkpoint_array(bwt, checkpoint_interval)</span>
<span id="cb299-54"><a href="#cb299-54" aria-hidden="true" tabindex="-1"></a>    partial_suffix_array <span class="op">=</span> create_partial_suffix_array(text <span class="op">+</span> <span class="st">'$'</span>, checkpoint_interval)</span>
<span id="cb299-55"><a href="#cb299-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-56"><a href="#cb299-56" aria-hidden="true" tabindex="-1"></a>    positions <span class="op">=</span> []</span>
<span id="cb299-57"><a href="#cb299-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb299-58"><a href="#cb299-58" aria-hidden="true" tabindex="-1"></a>        top, bottom <span class="op">=</span> multiple_pattern_matching(first_occurrence, bwt, pattern, checkpoint_array)</span>
<span id="cb299-59"><a href="#cb299-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> top <span class="op">!=</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb299-60"><a href="#cb299-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> idx <span class="kw">in</span> <span class="bu">range</span>(top, bottom <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb299-61"><a href="#cb299-61" aria-hidden="true" tabindex="-1"></a>                offset <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb299-62"><a href="#cb299-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">while</span> idx <span class="kw">not</span> <span class="kw">in</span> partial_suffix_array:</span>
<span id="cb299-63"><a href="#cb299-63" aria-hidden="true" tabindex="-1"></a>                    idx <span class="op">=</span> first_occurrence[bwt[idx]] <span class="op">+</span> count_symbol(checkpoint_array, idx, bwt, bwt[idx])</span>
<span id="cb299-64"><a href="#cb299-64" aria-hidden="true" tabindex="-1"></a>                    offset <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb299-65"><a href="#cb299-65" aria-hidden="true" tabindex="-1"></a>                positions.append(partial_suffix_array[idx] <span class="op">+</span> offset)</span>
<span id="cb299-66"><a href="#cb299-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-67"><a href="#cb299-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(positions)</span>
<span id="cb299-68"><a href="#cb299-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-69"><a href="#cb299-69" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input processing</span></span>
<span id="cb299-70"><a href="#cb299-70" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb299-71"><a href="#cb299-71" aria-hidden="true" tabindex="-1"></a><span class="st">AATCGGGTTCAATCGGGGT</span></span>
<span id="cb299-72"><a href="#cb299-72" aria-hidden="true" tabindex="-1"></a><span class="st">ATCG</span></span>
<span id="cb299-73"><a href="#cb299-73" aria-hidden="true" tabindex="-1"></a><span class="st">GGGT</span></span>
<span id="cb299-74"><a href="#cb299-74" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb299-75"><a href="#cb299-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-76"><a href="#cb299-76" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb299-77"><a href="#cb299-77" aria-hidden="true" tabindex="-1"></a>text <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb299-78"><a href="#cb299-78" aria-hidden="true" tabindex="-1"></a>patterns <span class="op">=</span> input_lines[<span class="dv">1</span>:]</span>
<span id="cb299-79"><a href="#cb299-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb299-80"><a href="#cb299-80" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> find_pattern_occurrences(text, patterns)</span>
<span id="cb299-81"><a href="#cb299-81" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>.join(<span class="bu">str</span>(pos) <span class="cf">for</span> pos <span class="kw">in</span> result))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-all-approximate-occurrences-of-a-collection-of-patterns-in-a-string" class="level1" data-number="100">
<h1 data-number="100"><span class="header-section-number">100</span> Find All Approximate Occurrences of a Collection of Patterns in a String</h1>
<p>Multiple Approximate Pattern Matching Problem. Find all approximate occurrences of a collection of patterns in a text.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>, a collection of strings&nbsp;<em>Patterns</em>, and an integer&nbsp;<em>d</em>.</p>
<p>Return:&nbsp;All positions in&nbsp;<em>Text</em>&nbsp;where a string from&nbsp;<em>Patterns</em>&nbsp;appears as a substring with at most&nbsp;<em>d</em>&nbsp;mismatches.</p>
<section id="sample-dataset-100" class="level2" data-number="100.1">
<h2 data-number="100.1" class="anchored" data-anchor-id="sample-dataset-100"><span class="header-section-number">100.1</span> Sample Dataset</h2>
<pre><code>ACATGCTACTTT
ATT GCC GCTA TATT
1</code></pre>
</section>
<section id="sample-output-100" class="level2" data-number="100.2">
<h2 data-number="100.2" class="anchored" data-anchor-id="sample-output-100"><span class="header-section-number">100.2</span> Sample Output</h2>
<pre><code>2 4 4 6 7 8 9</code></pre>
</section>
<section id="solution-100" class="level2" data-number="100.3">
<h2 data-number="100.3" class="anchored" data-anchor-id="solution-100"><span class="header-section-number">100.3</span> Solution</h2>
<div class="sourceCode" id="cb302"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb302-1"><a href="#cb302-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb302-2"><a href="#cb302-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> copy <span class="im">import</span> copy</span>
<span id="cb302-3"><a href="#cb302-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple, Iterator</span>
<span id="cb302-4"><a href="#cb302-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-5"><a href="#cb302-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb302-6"><a href="#cb302-6" aria-hidden="true" tabindex="-1"></a>    suffixes: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {i: text[i:] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))}</span>
<span id="cb302-7"><a href="#cb302-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(suffixes.keys(), key<span class="op">=</span><span class="kw">lambda</span> x: suffixes[x])</span>
<span id="cb302-8"><a href="#cb302-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-9"><a href="#cb302-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partial_suffix_array(sequence: <span class="bu">str</span>, k: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb302-10"><a href="#cb302-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [(i, x) <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(suffix_array(sequence)) <span class="cf">if</span> x <span class="op">%</span> k <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb302-11"><a href="#cb302-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-12"><a href="#cb302-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> burrows_wheeler_transform(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb302-13"><a href="#cb302-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="st">""</span>.join(sequence[i <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> i <span class="kw">in</span> suffix_array(sequence))</span>
<span id="cb302-14"><a href="#cb302-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-15"><a href="#cb302-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> accumulate</span>
<span id="cb302-16"><a href="#cb302-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-17"><a href="#cb302-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> first_occurrence(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, <span class="bu">int</span>]:</span>
<span id="cb302-18"><a href="#cb302-18" aria-hidden="true" tabindex="-1"></a>    unique_letters: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">set</span>(sequence))</span>
<span id="cb302-19"><a href="#cb302-19" aria-hidden="true" tabindex="-1"></a>    counts: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(accumulate(sequence.count(x) <span class="cf">for</span> x <span class="kw">in</span> unique_letters))</span>
<span id="cb302-20"><a href="#cb302-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">dict</span>(<span class="bu">zip</span>(unique_letters, counts))</span>
<span id="cb302-21"><a href="#cb302-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-22"><a href="#cb302-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> count_symbols(sequence: <span class="bu">str</span>) <span class="op">-&gt;</span> List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb302-23"><a href="#cb302-23" aria-hidden="true" tabindex="-1"></a>    count: List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb302-24"><a href="#cb302-24" aria-hidden="true" tabindex="-1"></a>    count.append(defaultdict(<span class="bu">int</span>))</span>
<span id="cb302-25"><a href="#cb302-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb302-26"><a href="#cb302-26" aria-hidden="true" tabindex="-1"></a>        count.append(copy(count[i]))</span>
<span id="cb302-27"><a href="#cb302-27" aria-hidden="true" tabindex="-1"></a>        count[i <span class="op">+</span> <span class="dv">1</span>][symbol] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb302-28"><a href="#cb302-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> count</span>
<span id="cb302-29"><a href="#cb302-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-30"><a href="#cb302-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_location(row: <span class="bu">int</span>, psa: Dict[<span class="bu">int</span>, <span class="bu">int</span>], last_column: <span class="bu">str</span>, fo: Dict[<span class="bu">str</span>, <span class="bu">int</span>], cs: List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb302-31"><a href="#cb302-31" aria-hidden="true" tabindex="-1"></a>    steps: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb302-32"><a href="#cb302-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> row <span class="kw">not</span> <span class="kw">in</span> psa:</span>
<span id="cb302-33"><a href="#cb302-33" aria-hidden="true" tabindex="-1"></a>        predecessor: <span class="bu">str</span> <span class="op">=</span> last_column[row]</span>
<span id="cb302-34"><a href="#cb302-34" aria-hidden="true" tabindex="-1"></a>        row <span class="op">=</span> fo[predecessor] <span class="op">+</span> cs[row][predecessor]</span>
<span id="cb302-35"><a href="#cb302-35" aria-hidden="true" tabindex="-1"></a>        steps <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb302-36"><a href="#cb302-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> steps <span class="op">+</span> psa[row]</span>
<span id="cb302-37"><a href="#cb302-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-38"><a href="#cb302-38" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> BWMatch:</span>
<span id="cb302-39"><a href="#cb302-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, sequence: <span class="bu">str</span>, k: <span class="bu">int</span> <span class="op">=</span> <span class="dv">10</span>):</span>
<span id="cb302-40"><a href="#cb302-40" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.psa: Dict[<span class="bu">int</span>, <span class="bu">int</span>] <span class="op">=</span> <span class="bu">dict</span>(partial_suffix_array(sequence <span class="op">+</span> <span class="st">"$"</span>, k))</span>
<span id="cb302-41"><a href="#cb302-41" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.sequence: <span class="bu">str</span> <span class="op">=</span> burrows_wheeler_transform(sequence <span class="op">+</span> <span class="st">"$"</span>)</span>
<span id="cb302-42"><a href="#cb302-42" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.fo: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> first_occurrence(<span class="va">self</span>.sequence)</span>
<span id="cb302-43"><a href="#cb302-43" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.cs: List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]] <span class="op">=</span> count_symbols(<span class="va">self</span>.sequence)</span>
<span id="cb302-44"><a href="#cb302-44" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_mismatches: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb302-45"><a href="#cb302-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-46"><a href="#cb302-46" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> update(<span class="va">self</span>, pointers: Tuple[<span class="bu">int</span>, <span class="bu">int</span>], x: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">int</span>]:</span>
<span id="cb302-47"><a href="#cb302-47" aria-hidden="true" tabindex="-1"></a>        top, bottom <span class="op">=</span> pointers</span>
<span id="cb302-48"><a href="#cb302-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (<span class="va">self</span>.fo[x] <span class="op">+</span> <span class="va">self</span>.cs[top][x], <span class="va">self</span>.fo[x] <span class="op">+</span> <span class="va">self</span>.cs[bottom <span class="op">+</span> <span class="dv">1</span>][x] <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb302-49"><a href="#cb302-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-50"><a href="#cb302-50" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> bwm(<span class="va">self</span>, pattern: <span class="bu">str</span>, pointers: Tuple[<span class="bu">int</span>, <span class="bu">int</span>], mismatch_count: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb302-51"><a href="#cb302-51" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">not</span> pattern:</span>
<span id="cb302-52"><a href="#cb302-52" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="bu">list</span>(<span class="bu">range</span>(pointers[<span class="dv">0</span>], pointers[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb302-53"><a href="#cb302-53" aria-hidden="true" tabindex="-1"></a>        matches: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb302-54"><a href="#cb302-54" aria-hidden="true" tabindex="-1"></a>        pattern, symbol <span class="op">=</span> pattern[:<span class="op">-</span><span class="dv">1</span>], pattern[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb302-55"><a href="#cb302-55" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> symbol <span class="kw">in</span> <span class="va">self</span>.sequence[pointers[<span class="dv">0</span>] : pointers[<span class="dv">1</span>] <span class="op">+</span> <span class="dv">1</span>]:</span>
<span id="cb302-56"><a href="#cb302-56" aria-hidden="true" tabindex="-1"></a>            matches <span class="op">+=</span> <span class="va">self</span>.bwm(pattern, <span class="va">self</span>.update(pointers, symbol), mismatch_count)</span>
<span id="cb302-57"><a href="#cb302-57" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> mismatch_count <span class="op">&lt;</span> <span class="va">self</span>.max_mismatches:</span>
<span id="cb302-58"><a href="#cb302-58" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mismatch <span class="kw">in</span> [<span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"G"</span>, <span class="st">"T"</span>]:</span>
<span id="cb302-59"><a href="#cb302-59" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> mismatch <span class="op">!=</span> symbol:</span>
<span id="cb302-60"><a href="#cb302-60" aria-hidden="true" tabindex="-1"></a>                    matches <span class="op">+=</span> <span class="va">self</span>.bwm(pattern, <span class="va">self</span>.update(pointers, mismatch), mismatch_count <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb302-61"><a href="#cb302-61" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> matches</span>
<span id="cb302-62"><a href="#cb302-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-63"><a href="#cb302-63" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> match_patterns(<span class="va">self</span>, patterns: List[<span class="bu">str</span>], max_mismatches: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[<span class="bu">int</span>]:</span>
<span id="cb302-64"><a href="#cb302-64" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.max_mismatches <span class="op">=</span> max_mismatches</span>
<span id="cb302-65"><a href="#cb302-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> pattern <span class="kw">in</span> patterns:</span>
<span id="cb302-66"><a href="#cb302-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> match <span class="kw">in</span> <span class="va">self</span>.bwm(pattern, (<span class="dv">0</span>, <span class="bu">len</span>(<span class="va">self</span>.sequence) <span class="op">-</span> <span class="dv">1</span>), <span class="dv">0</span>):</span>
<span id="cb302-67"><a href="#cb302-67" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> find_location(match, <span class="va">self</span>.psa, <span class="va">self</span>.sequence, <span class="va">self</span>.fo, <span class="va">self</span>.cs)</span>
<span id="cb302-68"><a href="#cb302-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb302-69"><a href="#cb302-69" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb302-70"><a href="#cb302-70" aria-hidden="true" tabindex="-1"></a><span class="st">ACATGCTACTTT</span></span>
<span id="cb302-71"><a href="#cb302-71" aria-hidden="true" tabindex="-1"></a><span class="st">ATT GCC GCTA TATT</span></span>
<span id="cb302-72"><a href="#cb302-72" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb302-73"><a href="#cb302-73" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb302-74"><a href="#cb302-74" aria-hidden="true" tabindex="-1"></a>sequence, patterns, mismatches <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb302-75"><a href="#cb302-75" aria-hidden="true" tabindex="-1"></a>patterns: List[<span class="bu">str</span>] <span class="op">=</span> patterns.split()</span>
<span id="cb302-76"><a href="#cb302-76" aria-hidden="true" tabindex="-1"></a>mismatches: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(mismatches)</span>
<span id="cb302-77"><a href="#cb302-77" aria-hidden="true" tabindex="-1"></a>matcher: BWMatch <span class="op">=</span> BWMatch(sequence)</span>
<span id="cb302-78"><a href="#cb302-78" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(matcher.match_patterns(patterns, mismatches)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-treecoloring" class="level1" data-number="101">
<h1 data-number="101"><span class="header-section-number">101</span> Implement TreeColoring</h1>
<p>Tree Coloring Problem. Color the internal nodes of a suffix tree given colors of the leaves.</p>
<p>Given:&nbsp;An&nbsp;<a href="https://rosalind.info/glossary/adjacency-list/">adjacency list</a>, followed by color labels for leaf nodes.</p>
<p>Return:&nbsp;Color labels for all nodes, in any order.</p>
<section id="sample-dataset-101" class="level2" data-number="101.1">
<h2 data-number="101.1" class="anchored" data-anchor-id="sample-dataset-101"><span class="header-section-number">101.1</span> Sample Dataset</h2>
<pre><code>0 -&gt; {}
1 -&gt; {}
2 -&gt; 0,1
3 -&gt; {}
4 -&gt; {}
5 -&gt; 3,2
6 -&gt; {}
7 -&gt; 4,5,6
-
0: red
1: red
3: blue
4: blue
6: red</code></pre>
</section>
<section id="sample-output-101" class="level2" data-number="101.2">
<h2 data-number="101.2" class="anchored" data-anchor-id="sample-output-101"><span class="header-section-number">101.2</span> Sample Output</h2>
<pre><code>0: red
1: red
2: red
3: blue
4: blue
5: purple
6: red
7: purple</code></pre>
</section>
<section id="solution-101" class="level2" data-number="101.3">
<h2 data-number="101.3" class="anchored" data-anchor-id="solution-101"><span class="header-section-number">101.3</span> Solution</h2>
<div class="sourceCode" id="cb305"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb305-2"><a href="#cb305-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> io</span>
<span id="cb305-3"><a href="#cb305-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Union, TextIO</span>
<span id="cb305-4"><a href="#cb305-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-5"><a href="#cb305-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> color_tree(tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], node_colors: Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]]) <span class="op">-&gt;</span> Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]]:</span>
<span id="cb305-6"><a href="#cb305-6" aria-hidden="true" tabindex="-1"></a>    uncolored_nodes <span class="op">=</span> <span class="bu">list</span>(tree.keys())</span>
<span id="cb305-7"><a href="#cb305-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> uncolored_nodes:</span>
<span id="cb305-8"><a href="#cb305-8" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> node <span class="kw">in</span> <span class="bu">list</span>(uncolored_nodes):  <span class="co"># Create a copy of uncolored_nodes to iterate over</span></span>
<span id="cb305-9"><a href="#cb305-9" aria-hidden="true" tabindex="-1"></a>            child_colors <span class="op">=</span> [node_colors[child[<span class="st">"n"</span>]] <span class="cf">for</span> child <span class="kw">in</span> tree[node] <span class="cf">if</span> node_colors[child[<span class="st">"n"</span>]] <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>]</span>
<span id="cb305-10"><a href="#cb305-10" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(child_colors) <span class="op">==</span> <span class="bu">len</span>(tree[node]):  <span class="co"># Check if all children are colored</span></span>
<span id="cb305-11"><a href="#cb305-11" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="bu">all</span>(color <span class="op">==</span> <span class="st">"red"</span> <span class="cf">for</span> color <span class="kw">in</span> child_colors):</span>
<span id="cb305-12"><a href="#cb305-12" aria-hidden="true" tabindex="-1"></a>                    node_colors[node] <span class="op">=</span> <span class="st">"red"</span></span>
<span id="cb305-13"><a href="#cb305-13" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> <span class="bu">all</span>(color <span class="op">==</span> <span class="st">"blue"</span> <span class="cf">for</span> color <span class="kw">in</span> child_colors):</span>
<span id="cb305-14"><a href="#cb305-14" aria-hidden="true" tabindex="-1"></a>                    node_colors[node] <span class="op">=</span> <span class="st">"blue"</span></span>
<span id="cb305-15"><a href="#cb305-15" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb305-16"><a href="#cb305-16" aria-hidden="true" tabindex="-1"></a>                    node_colors[node] <span class="op">=</span> <span class="st">"purple"</span></span>
<span id="cb305-17"><a href="#cb305-17" aria-hidden="true" tabindex="-1"></a>                uncolored_nodes.remove(node)</span>
<span id="cb305-18"><a href="#cb305-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> node_colors</span>
<span id="cb305-19"><a href="#cb305-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-20"><a href="#cb305-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_data: Union[<span class="bu">str</span>, TextIO]) <span class="op">-&gt;</span> Tuple[Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]], Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]]]:</span>
<span id="cb305-21"><a href="#cb305-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(input_data, <span class="bu">str</span>):</span>
<span id="cb305-22"><a href="#cb305-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="kw">in</span> input_data:</span>
<span id="cb305-23"><a href="#cb305-23" aria-hidden="true" tabindex="-1"></a>            <span class="co"># If input_data contains newlines, treat it as a string input</span></span>
<span id="cb305-24"><a href="#cb305-24" aria-hidden="true" tabindex="-1"></a>            file_obj <span class="op">=</span> io.StringIO(input_data)</span>
<span id="cb305-25"><a href="#cb305-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb305-26"><a href="#cb305-26" aria-hidden="true" tabindex="-1"></a>            <span class="co"># Otherwise, treat it as a filename</span></span>
<span id="cb305-27"><a href="#cb305-27" aria-hidden="true" tabindex="-1"></a>            file_obj <span class="op">=</span> <span class="bu">open</span>(input_data)</span>
<span id="cb305-28"><a href="#cb305-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> <span class="bu">isinstance</span>(input_data, TextIO):</span>
<span id="cb305-29"><a href="#cb305-29" aria-hidden="true" tabindex="-1"></a>        file_obj <span class="op">=</span> input_data</span>
<span id="cb305-30"><a href="#cb305-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb305-31"><a href="#cb305-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">raise</span> <span class="pp">ValueError</span>(<span class="st">"Input must be a filename, a string, or a file-like object"</span>)</span>
<span id="cb305-32"><a href="#cb305-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-33"><a href="#cb305-33" aria-hidden="true" tabindex="-1"></a>    tree: Dict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb305-34"><a href="#cb305-34" aria-hidden="true" tabindex="-1"></a>    node_colors: Dict[<span class="bu">int</span>, Union[<span class="bu">str</span>, <span class="va">None</span>]] <span class="op">=</span> defaultdict(<span class="kw">lambda</span>: <span class="va">None</span>)</span>
<span id="cb305-35"><a href="#cb305-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-36"><a href="#cb305-36" aria-hidden="true" tabindex="-1"></a>    parsing_tree <span class="op">=</span> <span class="va">True</span></span>
<span id="cb305-37"><a href="#cb305-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> file_obj:</span>
<span id="cb305-38"><a href="#cb305-38" aria-hidden="true" tabindex="-1"></a>        line <span class="op">=</span> line.strip()</span>
<span id="cb305-39"><a href="#cb305-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb305-40"><a href="#cb305-40" aria-hidden="true" tabindex="-1"></a>            parsing_tree <span class="op">=</span> <span class="va">False</span></span>
<span id="cb305-41"><a href="#cb305-41" aria-hidden="true" tabindex="-1"></a>            <span class="cf">continue</span></span>
<span id="cb305-42"><a href="#cb305-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-43"><a href="#cb305-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> parsing_tree:</span>
<span id="cb305-44"><a href="#cb305-44" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="st">" -&gt; "</span> <span class="kw">in</span> line:</span>
<span id="cb305-45"><a href="#cb305-45" aria-hidden="true" tabindex="-1"></a>                parent, children <span class="op">=</span> line.split(<span class="st">" -&gt; "</span>)</span>
<span id="cb305-46"><a href="#cb305-46" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> children <span class="op">!=</span> <span class="st">"</span><span class="sc">{}</span><span class="st">"</span>:</span>
<span id="cb305-47"><a href="#cb305-47" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">for</span> child <span class="kw">in</span> children.split(<span class="st">","</span>):</span>
<span id="cb305-48"><a href="#cb305-48" aria-hidden="true" tabindex="-1"></a>                        tree[<span class="bu">int</span>(parent)].append({<span class="st">"n"</span>: <span class="bu">int</span>(child)})</span>
<span id="cb305-49"><a href="#cb305-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb305-50"><a href="#cb305-50" aria-hidden="true" tabindex="-1"></a>            node, color <span class="op">=</span> line.split(<span class="st">": "</span>)</span>
<span id="cb305-51"><a href="#cb305-51" aria-hidden="true" tabindex="-1"></a>            node_colors[<span class="bu">int</span>(node)] <span class="op">=</span> color</span>
<span id="cb305-52"><a href="#cb305-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-53"><a href="#cb305-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="bu">isinstance</span>(input_data, <span class="bu">str</span>) <span class="kw">and</span> <span class="st">'</span><span class="ch">\n</span><span class="st">'</span> <span class="kw">not</span> <span class="kw">in</span> input_data:</span>
<span id="cb305-54"><a href="#cb305-54" aria-hidden="true" tabindex="-1"></a>        file_obj.close()</span>
<span id="cb305-55"><a href="#cb305-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-56"><a href="#cb305-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree, node_colors</span>
<span id="cb305-57"><a href="#cb305-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-58"><a href="#cb305-58" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb305-59"><a href="#cb305-59" aria-hidden="true" tabindex="-1"></a><span class="st">0 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-60"><a href="#cb305-60" aria-hidden="true" tabindex="-1"></a><span class="st">1 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-61"><a href="#cb305-61" aria-hidden="true" tabindex="-1"></a><span class="st">2 -&gt; 0,1</span></span>
<span id="cb305-62"><a href="#cb305-62" aria-hidden="true" tabindex="-1"></a><span class="st">3 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-63"><a href="#cb305-63" aria-hidden="true" tabindex="-1"></a><span class="st">4 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-64"><a href="#cb305-64" aria-hidden="true" tabindex="-1"></a><span class="st">5 -&gt; 3,2</span></span>
<span id="cb305-65"><a href="#cb305-65" aria-hidden="true" tabindex="-1"></a><span class="st">6 -&gt; </span><span class="sc">{}</span></span>
<span id="cb305-66"><a href="#cb305-66" aria-hidden="true" tabindex="-1"></a><span class="st">7 -&gt; 4,5,6</span></span>
<span id="cb305-67"><a href="#cb305-67" aria-hidden="true" tabindex="-1"></a><span class="st">-</span></span>
<span id="cb305-68"><a href="#cb305-68" aria-hidden="true" tabindex="-1"></a><span class="st">0: red</span></span>
<span id="cb305-69"><a href="#cb305-69" aria-hidden="true" tabindex="-1"></a><span class="st">1: red</span></span>
<span id="cb305-70"><a href="#cb305-70" aria-hidden="true" tabindex="-1"></a><span class="st">3: blue</span></span>
<span id="cb305-71"><a href="#cb305-71" aria-hidden="true" tabindex="-1"></a><span class="st">4: blue</span></span>
<span id="cb305-72"><a href="#cb305-72" aria-hidden="true" tabindex="-1"></a><span class="st">6: red</span></span>
<span id="cb305-73"><a href="#cb305-73" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb305-74"><a href="#cb305-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb305-75"><a href="#cb305-75" aria-hidden="true" tabindex="-1"></a>tree, node_colors <span class="op">=</span> parse_input(sample_input)</span>
<span id="cb305-76"><a href="#cb305-76" aria-hidden="true" tabindex="-1"></a>colored_tree <span class="op">=</span> color_tree(tree, node_colors)</span>
<span id="cb305-77"><a href="#cb305-77" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> node <span class="kw">in</span> <span class="bu">sorted</span>(colored_tree.keys()):</span>
<span id="cb305-78"><a href="#cb305-78" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>node<span class="sc">}</span><span class="ss">: </span><span class="sc">{</span>colored_tree[node]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-partial-suffix-array-of-a-string" class="level1" data-number="102">
<h1 data-number="102"><span class="header-section-number">102</span> Construct the Partial Suffix Array of a String</h1>
<p>Partial Suffix Array Construction Problem. Construct the partial suffix array of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>&nbsp;and a positive integer&nbsp;<em>K</em>.</p>
<p>Return:&nbsp;*SuffixArray__K<em>(</em>Text<em>), in the form of a list of ordered pairs (</em>i<em>,&nbsp;</em>SuffixArray<em>(</em>i*)) for all nonempty entries in the partial suffix array.</p>
<section id="sample-dataset-102" class="level2" data-number="102.1">
<h2 data-number="102.1" class="anchored" data-anchor-id="sample-dataset-102"><span class="header-section-number">102.1</span> Sample Dataset</h2>
<pre><code>PANAMABANANAS$
5</code></pre>
</section>
<section id="sample-output-102" class="level2" data-number="102.2">
<h2 data-number="102.2" class="anchored" data-anchor-id="sample-output-102"><span class="header-section-number">102.2</span> Sample Output</h2>
<pre><code>1,5
11,10
12,0</code></pre>
</section>
<section id="solution-102" class="level2" data-number="102.3">
<h2 data-number="102.3" class="anchored" data-anchor-id="solution-102"><span class="header-section-number">102.3</span> Solution</h2>
<div class="sourceCode" id="cb308"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb308-1"><a href="#cb308-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb308-2"><a href="#cb308-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-3"><a href="#cb308-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> suffix_array(text: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb308-4"><a href="#cb308-4" aria-hidden="true" tabindex="-1"></a>    suffixes: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {i: text[i:] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text))}</span>
<span id="cb308-5"><a href="#cb308-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sorted</span>(suffixes.keys(), key<span class="op">=</span><span class="kw">lambda</span> x: suffixes[x])</span>
<span id="cb308-6"><a href="#cb308-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-7"><a href="#cb308-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> partial_suffix_array(sequence: <span class="bu">str</span>, step: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">int</span>, <span class="bu">int</span>]]:</span>
<span id="cb308-8"><a href="#cb308-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> [(index, position) <span class="cf">for</span> index, position <span class="kw">in</span> <span class="bu">enumerate</span>(suffix_array(sequence)) <span class="cf">if</span> position <span class="op">%</span> step <span class="op">==</span> <span class="dv">0</span>]</span>
<span id="cb308-9"><a href="#cb308-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-10"><a href="#cb308-10" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb308-11"><a href="#cb308-11" aria-hidden="true" tabindex="-1"></a><span class="st">PANAMABANANAS$</span></span>
<span id="cb308-12"><a href="#cb308-12" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb308-13"><a href="#cb308-13" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb308-14"><a href="#cb308-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-15"><a href="#cb308-15" aria-hidden="true" tabindex="-1"></a>sequence, step_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb308-16"><a href="#cb308-16" aria-hidden="true" tabindex="-1"></a>step: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(step_str)</span>
<span id="cb308-17"><a href="#cb308-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb308-18"><a href="#cb308-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> entry <span class="kw">in</span> partial_suffix_array(sequence, step):</span>
<span id="cb308-19"><a href="#cb308-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>entry, sep<span class="op">=</span><span class="st">","</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-suffix-tree-from-a-suffix-array" class="level1" data-number="103">
<h1 data-number="103"><span class="header-section-number">103</span> Construct a Suffix Tree from a Suffix Array</h1>
<p>Suffix Tree Construction from Suffix Array Problem. Construct a suffix tree from the suffix array and LCP array of a string.</p>
<p>Given:&nbsp;A string&nbsp;<em>Text</em>,&nbsp;<em>SuffixArray</em>(<em>Text</em>), and&nbsp;<em>LCP</em>(<em>Text</em>).</p>
<p>Return:&nbsp;The strings labeling the edges of&nbsp;<em>SuffixTree</em>(<em>Text</em>). (You may return these strings in any order.)</p>
<section id="sample-dataset-103" class="level2" data-number="103.1">
<h2 data-number="103.1" class="anchored" data-anchor-id="sample-dataset-103"><span class="header-section-number">103.1</span> Sample Dataset</h2>
<pre><code>GTAGT$
5, 2, 3, 0, 4, 1
0, 0, 0, 2, 0, 1</code></pre>
</section>
<section id="sample-output-103" class="level2" data-number="103.2">
<h2 data-number="103.2" class="anchored" data-anchor-id="sample-output-103"><span class="header-section-number">103.2</span> Sample Output</h2>
<pre><code>$
$
$
AGT$
AGT$
AGT$
GT
T</code></pre>
</section>
<section id="solution-103" class="level2" data-number="103.3">
<h2 data-number="103.3" class="anchored" data-anchor-id="solution-103"><span class="header-section-number">103.3</span> Solution</h2>
<div class="sourceCode" id="cb311"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb311-1"><a href="#cb311-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Union</span>
<span id="cb311-2"><a href="#cb311-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-3"><a href="#cb311-3" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Node:</span>
<span id="cb311-4"><a href="#cb311-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> <span class="fu">__init__</span>(<span class="va">self</span>, parent: Union[<span class="bu">int</span>, <span class="bu">str</span>, <span class="va">None</span>] <span class="op">=</span> <span class="va">None</span>, label: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span>):</span>
<span id="cb311-5"><a href="#cb311-5" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.parent: Union[<span class="bu">int</span>, <span class="bu">str</span>, <span class="va">None</span>] <span class="op">=</span> parent</span>
<span id="cb311-6"><a href="#cb311-6" aria-hidden="true" tabindex="-1"></a>        <span class="va">self</span>.label: <span class="bu">str</span> <span class="op">=</span> label</span>
<span id="cb311-7"><a href="#cb311-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-8"><a href="#cb311-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_depth(tree: Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node], node: Union[<span class="bu">int</span>, <span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb311-9"><a href="#cb311-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">"""</span></span>
<span id="cb311-10"><a href="#cb311-10" aria-hidden="true" tabindex="-1"></a><span class="co">    Calculate the length of the concatenation of all path labels from the root to node</span></span>
<span id="cb311-11"><a href="#cb311-11" aria-hidden="true" tabindex="-1"></a><span class="co">    """</span></span>
<span id="cb311-12"><a href="#cb311-12" aria-hidden="true" tabindex="-1"></a>    depth: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(tree[node].label)</span>
<span id="cb311-13"><a href="#cb311-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> tree[node].parent <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span>:</span>
<span id="cb311-14"><a href="#cb311-14" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> tree[node].parent</span>
<span id="cb311-15"><a href="#cb311-15" aria-hidden="true" tabindex="-1"></a>        depth <span class="op">+=</span> <span class="bu">len</span>(tree[node].label)</span>
<span id="cb311-16"><a href="#cb311-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> depth</span>
<span id="cb311-17"><a href="#cb311-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-18"><a href="#cb311-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> construct_suffix_tree(text: <span class="bu">str</span>, suffix_array: List[<span class="bu">int</span>], lcp_array: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node]:</span>
<span id="cb311-19"><a href="#cb311-19" aria-hidden="true" tabindex="-1"></a>    tree: Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node] <span class="op">=</span> {<span class="op">-</span><span class="dv">1</span>: Node()}</span>
<span id="cb311-20"><a href="#cb311-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-21"><a href="#cb311-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(text)):</span>
<span id="cb311-22"><a href="#cb311-22" aria-hidden="true" tabindex="-1"></a>        current_node: <span class="bu">int</span> <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb311-23"><a href="#cb311-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> tree[current_node].parent <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> calculate_depth(tree, current_node) <span class="op">&gt;</span> lcp_array[i]:</span>
<span id="cb311-24"><a href="#cb311-24" aria-hidden="true" tabindex="-1"></a>            current_node <span class="op">=</span> tree[current_node].parent</span>
<span id="cb311-25"><a href="#cb311-25" aria-hidden="true" tabindex="-1"></a>        current_depth: <span class="bu">int</span> <span class="op">=</span> calculate_depth(tree, current_node)</span>
<span id="cb311-26"><a href="#cb311-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-27"><a href="#cb311-27" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> lcp_array[i] <span class="op">==</span> current_depth:</span>
<span id="cb311-28"><a href="#cb311-28" aria-hidden="true" tabindex="-1"></a>            tree[i] <span class="op">=</span> Node(current_node, text[suffix_array[i] <span class="op">+</span> lcp_array[i]:])</span>
<span id="cb311-29"><a href="#cb311-29" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb311-30"><a href="#cb311-30" aria-hidden="true" tabindex="-1"></a>            temp_node: <span class="bu">int</span> <span class="op">=</span> i <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb311-31"><a href="#cb311-31" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span> tree[temp_node].parent <span class="kw">is</span> <span class="kw">not</span> <span class="va">None</span> <span class="kw">and</span> tree[temp_node].parent <span class="op">!=</span> current_node:</span>
<span id="cb311-32"><a href="#cb311-32" aria-hidden="true" tabindex="-1"></a>                temp_node <span class="op">=</span> tree[temp_node].parent</span>
<span id="cb311-33"><a href="#cb311-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-34"><a href="#cb311-34" aria-hidden="true" tabindex="-1"></a>            new_node_key: <span class="bu">str</span> <span class="op">=</span> <span class="ss">f"y</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb311-35"><a href="#cb311-35" aria-hidden="true" tabindex="-1"></a>            tree[new_node_key] <span class="op">=</span> Node(current_node, text[suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> current_depth : suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> lcp_array[i]])</span>
<span id="cb311-36"><a href="#cb311-36" aria-hidden="true" tabindex="-1"></a>            tree[temp_node] <span class="op">=</span> Node(new_node_key, text[suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> lcp_array[i] : suffix_array[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> calculate_depth(tree, temp_node)])</span>
<span id="cb311-37"><a href="#cb311-37" aria-hidden="true" tabindex="-1"></a>            tree[i] <span class="op">=</span> Node(new_node_key, text[suffix_array[i] <span class="op">+</span> lcp_array[i]:])</span>
<span id="cb311-38"><a href="#cb311-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-39"><a href="#cb311-39" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> tree[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb311-40"><a href="#cb311-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tree</span>
<span id="cb311-41"><a href="#cb311-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-42"><a href="#cb311-42" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb311-43"><a href="#cb311-43" aria-hidden="true" tabindex="-1"></a><span class="st">GTAGT$</span></span>
<span id="cb311-44"><a href="#cb311-44" aria-hidden="true" tabindex="-1"></a><span class="st">5, 2, 3, 0, 4, 1</span></span>
<span id="cb311-45"><a href="#cb311-45" aria-hidden="true" tabindex="-1"></a><span class="st">0, 0, 0, 2, 0, 1</span></span>
<span id="cb311-46"><a href="#cb311-46" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb311-47"><a href="#cb311-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-48"><a href="#cb311-48" aria-hidden="true" tabindex="-1"></a>text, suffix_array_str, lcp_array_str <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb311-49"><a href="#cb311-49" aria-hidden="true" tabindex="-1"></a>suffix_array: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> suffix_array_str.split(<span class="st">", "</span>)]</span>
<span id="cb311-50"><a href="#cb311-50" aria-hidden="true" tabindex="-1"></a>lcp_array: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> lcp_array_str.split(<span class="st">", "</span>)]</span>
<span id="cb311-51"><a href="#cb311-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb311-52"><a href="#cb311-52" aria-hidden="true" tabindex="-1"></a>suffix_tree: Dict[Union[<span class="bu">int</span>, <span class="bu">str</span>], Node] <span class="op">=</span> construct_suffix_tree(text, suffix_array, lcp_array)</span>
<span id="cb311-53"><a href="#cb311-53" aria-hidden="true" tabindex="-1"></a>labels: List[<span class="bu">str</span>] <span class="op">=</span> [suffix_tree[key].label <span class="cf">for</span> key <span class="kw">in</span> suffix_tree.keys()]</span>
<span id="cb311-54"><a href="#cb311-54" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="op">*</span><span class="bu">sorted</span>(labels), sep<span class="op">=</span><span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-a-hidden-path" class="level1" data-number="104">
<h1 data-number="104"><span class="header-section-number">104</span> Compute the Probability of a Hidden Path</h1>
<p>Given:&nbsp;A hidden path <span class="math inline">\(π\)</span> followed by the states&nbsp;<em>States</em>&nbsp;and transition matrix&nbsp;<em>Transition</em>&nbsp;of an HMM (<span class="math inline">\(Σ\)</span>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability of this path, <span class="math inline">\(Pr(π)\)</span>. You may assume that initial probabilities are equal.</p>
<section id="sample-dataset-104" class="level2" data-number="104.1">
<h2 data-number="104.1" class="anchored" data-anchor-id="sample-dataset-104"><span class="header-section-number">104.1</span> Sample Dataset</h2>
<pre><code>AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB
--------
A   B
--------
    A   B
A   0.194   0.806
B   0.273   0.727</code></pre>
</section>
<section id="sample-output-104" class="level2" data-number="104.2">
<h2 data-number="104.2" class="anchored" data-anchor-id="sample-output-104"><span class="header-section-number">104.2</span> Sample Output</h2>
<pre><code>5.01732865318e-19</code></pre>
</section>
<section id="solution-104" class="level2" data-number="104.3">
<h2 data-number="104.3" class="anchored" data-anchor-id="solution-104"><span class="header-section-number">104.3</span> Solution</h2>
<div class="sourceCode" id="cb314"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb314-1"><a href="#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb314-2"><a href="#cb314-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb314-3"><a href="#cb314-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-4"><a href="#cb314-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hidden_path_data(input_lines):</span>
<span id="cb314-5"><a href="#cb314-5" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb314-6"><a href="#cb314-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb314-7"><a href="#cb314-7" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb314-8"><a href="#cb314-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb314-9"><a href="#cb314-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb314-10"><a href="#cb314-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-11"><a href="#cb314-11" aria-hidden="true" tabindex="-1"></a>    transition_probabilities <span class="op">=</span> {}</span>
<span id="cb314-12"><a href="#cb314-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb314-13"><a href="#cb314-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb314-14"><a href="#cb314-14" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb314-15"><a href="#cb314-15" aria-hidden="true" tabindex="-1"></a>            current_state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb314-16"><a href="#cb314-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> next_state, probability <span class="kw">in</span> <span class="bu">zip</span>(states, row_data[<span class="dv">1</span>:]):</span>
<span id="cb314-17"><a href="#cb314-17" aria-hidden="true" tabindex="-1"></a>                transition_probabilities[(current_state, next_state)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb314-18"><a href="#cb314-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-19"><a href="#cb314-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> hidden_path, transition_probabilities</span>
<span id="cb314-20"><a href="#cb314-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-21"><a href="#cb314-21" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hidden_path_probability(hidden_path, transition_probabilities):</span>
<span id="cb314-22"><a href="#cb314-22" aria-hidden="true" tabindex="-1"></a>    initial_probability <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb314-23"><a href="#cb314-23" aria-hidden="true" tabindex="-1"></a>    path_probability <span class="op">=</span> initial_probability <span class="op">*</span> prod(</span>
<span id="cb314-24"><a href="#cb314-24" aria-hidden="true" tabindex="-1"></a>        transition_probabilities[state_pair]</span>
<span id="cb314-25"><a href="#cb314-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> state_pair <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, hidden_path[<span class="dv">1</span>:])</span>
<span id="cb314-26"><a href="#cb314-26" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb314-27"><a href="#cb314-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> path_probability</span>
<span id="cb314-28"><a href="#cb314-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-29"><a href="#cb314-29" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb314-30"><a href="#cb314-30" aria-hidden="true" tabindex="-1"></a><span class="st">AABBBAABABAAAABBBBAABBABABBBAABBAAAABABAABBABABBAB</span></span>
<span id="cb314-31"><a href="#cb314-31" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb314-32"><a href="#cb314-32" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb314-33"><a href="#cb314-33" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb314-34"><a href="#cb314-34" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb314-35"><a href="#cb314-35" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.194   0.806</span></span>
<span id="cb314-36"><a href="#cb314-36" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.273   0.727</span></span>
<span id="cb314-37"><a href="#cb314-37" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb314-38"><a href="#cb314-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb314-39"><a href="#cb314-39" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb314-40"><a href="#cb314-40" aria-hidden="true" tabindex="-1"></a>hidden_path, transition_probabilities <span class="op">=</span> parse_hidden_path_data(input_lines)</span>
<span id="cb314-41"><a href="#cb314-41" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_hidden_path_probability(hidden_path, transition_probabilities)</span>
<span id="cb314-42"><a href="#cb314-42" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-an-outcome-given-a-hidden-path" class="level1" data-number="105">
<h1 data-number="105"><span class="header-section-number">105</span> Compute the Probability of an Outcome Given a Hidden Path</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by a hidden path&nbsp;<em>π</em>, followed by the states&nbsp;<em>States</em>&nbsp;and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The conditional probability <span class="math inline">\(Pr(x|π)\)</span> that string&nbsp;<em>x</em>&nbsp;will be emitted by the HMM given the hidden path&nbsp;<em>π</em>.</p>
<section id="sample-dataset-105" class="level2" data-number="105.1">
<h2 data-number="105.1" class="anchored" data-anchor-id="sample-dataset-105"><span class="header-section-number">105.1</span> Sample Dataset</h2>
<pre><code>xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx
--------
x   y   z
--------
BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB
--------
A   B
--------
    x   y   z
A   0.612   0.314   0.074
B   0.346   0.317   0.336</code></pre>
</section>
<section id="sample-output-105" class="level2" data-number="105.2">
<h2 data-number="105.2" class="anchored" data-anchor-id="sample-output-105"><span class="header-section-number">105.2</span> Sample Output</h2>
<pre><code>1.93157070893e-28</code></pre>
</section>
<section id="solution-105" class="level2" data-number="105.3">
<h2 data-number="105.3" class="anchored" data-anchor-id="solution-105"><span class="header-section-number">105.3</span> Solution</h2>
<div class="sourceCode" id="cb317"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb317-1"><a href="#cb317-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> prod</span>
<span id="cb317-2"><a href="#cb317-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb317-3"><a href="#cb317-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-4"><a href="#cb317-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_emission_data(input_lines):</span>
<span id="cb317-5"><a href="#cb317-5" aria-hidden="true" tabindex="-1"></a>    emission_sequence <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb317-6"><a href="#cb317-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb317-7"><a href="#cb317-7" aria-hidden="true" tabindex="-1"></a>    symbols <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb317-8"><a href="#cb317-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb317-9"><a href="#cb317-9" aria-hidden="true" tabindex="-1"></a>    hidden_path <span class="op">=</span> <span class="bu">next</span>(input_lines).strip()</span>
<span id="cb317-10"><a href="#cb317-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb317-11"><a href="#cb317-11" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_lines).split()</span>
<span id="cb317-12"><a href="#cb317-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip separator</span></span>
<span id="cb317-13"><a href="#cb317-13" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_lines)  <span class="co"># Skip column headers</span></span>
<span id="cb317-14"><a href="#cb317-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-15"><a href="#cb317-15" aria-hidden="true" tabindex="-1"></a>    emission_probabilities <span class="op">=</span> {}</span>
<span id="cb317-16"><a href="#cb317-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> line <span class="kw">in</span> input_lines:</span>
<span id="cb317-17"><a href="#cb317-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> line.strip():</span>
<span id="cb317-18"><a href="#cb317-18" aria-hidden="true" tabindex="-1"></a>            row_data <span class="op">=</span> line.split()</span>
<span id="cb317-19"><a href="#cb317-19" aria-hidden="true" tabindex="-1"></a>            state <span class="op">=</span> row_data[<span class="dv">0</span>]</span>
<span id="cb317-20"><a href="#cb317-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> symbol, probability <span class="kw">in</span> <span class="bu">zip</span>(symbols, row_data[<span class="dv">1</span>:]):</span>
<span id="cb317-21"><a href="#cb317-21" aria-hidden="true" tabindex="-1"></a>                emission_probabilities[(state, symbol)] <span class="op">=</span> <span class="bu">float</span>(probability)</span>
<span id="cb317-22"><a href="#cb317-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-23"><a href="#cb317-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emission_sequence, hidden_path, emission_probabilities</span>
<span id="cb317-24"><a href="#cb317-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-25"><a href="#cb317-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities):</span>
<span id="cb317-26"><a href="#cb317-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prod(emission_probabilities[state_symbol] <span class="cf">for</span> state_symbol <span class="kw">in</span> <span class="bu">zip</span>(hidden_path, emission_sequence))</span>
<span id="cb317-27"><a href="#cb317-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-28"><a href="#cb317-28" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb317-29"><a href="#cb317-29" aria-hidden="true" tabindex="-1"></a><span class="st">xxyzyxzzxzxyxyyzxxzzxxyyxxyxyzzxxyzyzxzxxyxyyzxxzx</span></span>
<span id="cb317-30"><a href="#cb317-30" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb317-31"><a href="#cb317-31" aria-hidden="true" tabindex="-1"></a><span class="st">x y z</span></span>
<span id="cb317-32"><a href="#cb317-32" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb317-33"><a href="#cb317-33" aria-hidden="true" tabindex="-1"></a><span class="st">BBBAAABABABBBBBBAAAAAABAAAABABABBBBBABAABABABABBBB</span></span>
<span id="cb317-34"><a href="#cb317-34" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb317-35"><a href="#cb317-35" aria-hidden="true" tabindex="-1"></a><span class="st">A B</span></span>
<span id="cb317-36"><a href="#cb317-36" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb317-37"><a href="#cb317-37" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb317-38"><a href="#cb317-38" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.612   0.314   0.074</span></span>
<span id="cb317-39"><a href="#cb317-39" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.346   0.317   0.336</span></span>
<span id="cb317-40"><a href="#cb317-40" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb317-41"><a href="#cb317-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb317-42"><a href="#cb317-42" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb317-43"><a href="#cb317-43" aria-hidden="true" tabindex="-1"></a>emission_sequence, hidden_path, emission_probabilities <span class="op">=</span> parse_emission_data(input_lines)</span>
<span id="cb317-44"><a href="#cb317-44" aria-hidden="true" tabindex="-1"></a>result_probability <span class="op">=</span> calculate_emission_probability(emission_sequence, hidden_path, emission_probabilities)</span>
<span id="cb317-45"><a href="#cb317-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>result_probability<span class="sc">:e}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-the-viterbi-algorithm" class="level1" data-number="106">
<h1 data-number="106"><span class="header-section-number">106</span> Implement the Viterbi Algorithm</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;A path that maximizes the (unconditional) probability Pr(<em>x</em>,&nbsp;<em>π</em>) over all possible paths&nbsp;<em>π</em>.</p>
<section id="sample-dataset-106" class="level2" data-number="106.1">
<h2 data-number="106.1" class="anchored" data-anchor-id="sample-dataset-106"><span class="header-section-number">106.1</span> Sample Dataset</h2>
<pre><code>xyxzzxyxyy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.641   0.359
B   0.729   0.271
--------
    x   y   z
A   0.117   0.691   0.192
B   0.097   0.42    0.483</code></pre>
</section>
<section id="sample-output-106" class="level2" data-number="106.2">
<h2 data-number="106.2" class="anchored" data-anchor-id="sample-output-106"><span class="header-section-number">106.2</span> Sample Output</h2>
<pre><code>AAABBAAAAA</code></pre>
</section>
<section id="solution-106" class="level2" data-number="106.3">
<h2 data-number="106.3" class="anchored" data-anchor-id="solution-106"><span class="header-section-number">106.3</span> Solution</h2>
<div class="sourceCode" id="cb320"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb320-1"><a href="#cb320-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb320-2"><a href="#cb320-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb320-3"><a href="#cb320-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb320-4"><a href="#cb320-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb320-5"><a href="#cb320-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-6"><a href="#cb320-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb320-7"><a href="#cb320-7" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb320-8"><a href="#cb320-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb320-9"><a href="#cb320-9" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb320-10"><a href="#cb320-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb320-11"><a href="#cb320-11" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb320-12"><a href="#cb320-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb320-13"><a href="#cb320-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-14"><a href="#cb320-14" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb320-15"><a href="#cb320-15" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb320-16"><a href="#cb320-16" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb320-17"><a href="#cb320-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb320-18"><a href="#cb320-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb320-19"><a href="#cb320-19" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb320-20"><a href="#cb320-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-21"><a href="#cb320-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb320-22"><a href="#cb320-22" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb320-23"><a href="#cb320-23" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb320-24"><a href="#cb320-24" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb320-25"><a href="#cb320-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb320-26"><a href="#cb320-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb320-27"><a href="#cb320-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb320-28"><a href="#cb320-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-29"><a href="#cb320-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb320-30"><a href="#cb320-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-31"><a href="#cb320-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb320-32"><a href="#cb320-32" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> <span class="bu">len</span>(states)</span>
<span id="cb320-33"><a href="#cb320-33" aria-hidden="true" tabindex="-1"></a>    sequence_length <span class="op">=</span> <span class="bu">len</span>(sequence)</span>
<span id="cb320-34"><a href="#cb320-34" aria-hidden="true" tabindex="-1"></a>    viterbi_matrix <span class="op">=</span> np.zeros((sequence_length, num_states))</span>
<span id="cb320-35"><a href="#cb320-35" aria-hidden="true" tabindex="-1"></a>    backpointer <span class="op">=</span> np.zeros((sequence_length, num_states), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb320-36"><a href="#cb320-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-37"><a href="#cb320-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize the first column of the viterbi matrix</span></span>
<span id="cb320-38"><a href="#cb320-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb320-39"><a href="#cb320-39" aria-hidden="true" tabindex="-1"></a>        viterbi_matrix[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> num_states)</span>
<span id="cb320-40"><a href="#cb320-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-41"><a href="#cb320-41" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fill in the rest of the viterbi matrix</span></span>
<span id="cb320-42"><a href="#cb320-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, sequence_length):</span>
<span id="cb320-43"><a href="#cb320-43" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb320-44"><a href="#cb320-44" aria-hidden="true" tabindex="-1"></a>            probabilities <span class="op">=</span> [</span>
<span id="cb320-45"><a href="#cb320-45" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[previous_state, current_state]) <span class="op">+</span></span>
<span id="cb320-46"><a href="#cb320-46" aria-hidden="true" tabindex="-1"></a>                log(emission_matrix[current_state, sequence[t]]) <span class="op">+</span></span>
<span id="cb320-47"><a href="#cb320-47" aria-hidden="true" tabindex="-1"></a>                viterbi_matrix[t<span class="op">-</span><span class="dv">1</span>, k]</span>
<span id="cb320-48"><a href="#cb320-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb320-49"><a href="#cb320-49" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb320-50"><a href="#cb320-50" aria-hidden="true" tabindex="-1"></a>            max_prob_index <span class="op">=</span> probabilities.index(<span class="bu">max</span>(probabilities))</span>
<span id="cb320-51"><a href="#cb320-51" aria-hidden="true" tabindex="-1"></a>            backpointer[t, j] <span class="op">=</span> max_prob_index</span>
<span id="cb320-52"><a href="#cb320-52" aria-hidden="true" tabindex="-1"></a>            viterbi_matrix[t, j] <span class="op">=</span> <span class="bu">max</span>(probabilities)</span>
<span id="cb320-53"><a href="#cb320-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-54"><a href="#cb320-54" aria-hidden="true" tabindex="-1"></a>    best_path_index <span class="op">=</span> np.argmax(viterbi_matrix[<span class="op">-</span><span class="dv">1</span>, :])</span>
<span id="cb320-55"><a href="#cb320-55" aria-hidden="true" tabindex="-1"></a>    best_path <span class="op">=</span> states[best_path_index]</span>
<span id="cb320-56"><a href="#cb320-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(sequence_length <span class="op">-</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb320-57"><a href="#cb320-57" aria-hidden="true" tabindex="-1"></a>        best_path_index <span class="op">=</span> backpointer[t, best_path_index]</span>
<span id="cb320-58"><a href="#cb320-58" aria-hidden="true" tabindex="-1"></a>        best_path <span class="op">=</span> states[best_path_index] <span class="op">+</span> best_path</span>
<span id="cb320-59"><a href="#cb320-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-60"><a href="#cb320-60" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_path</span>
<span id="cb320-61"><a href="#cb320-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-62"><a href="#cb320-62" aria-hidden="true" tabindex="-1"></a><span class="co"># Example usage</span></span>
<span id="cb320-63"><a href="#cb320-63" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb320-64"><a href="#cb320-64" aria-hidden="true" tabindex="-1"></a><span class="st">xyxzzxyxyy</span></span>
<span id="cb320-65"><a href="#cb320-65" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb320-66"><a href="#cb320-66" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb320-67"><a href="#cb320-67" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb320-68"><a href="#cb320-68" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb320-69"><a href="#cb320-69" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb320-70"><a href="#cb320-70" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb320-71"><a href="#cb320-71" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.641   0.359</span></span>
<span id="cb320-72"><a href="#cb320-72" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.729   0.271</span></span>
<span id="cb320-73"><a href="#cb320-73" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb320-74"><a href="#cb320-74" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb320-75"><a href="#cb320-75" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.117   0.691   0.192</span></span>
<span id="cb320-76"><a href="#cb320-76" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.097   0.42    0.483</span></span>
<span id="cb320-77"><a href="#cb320-77" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb320-78"><a href="#cb320-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb320-79"><a href="#cb320-79" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb320-80"><a href="#cb320-80" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb320-81"><a href="#cb320-81" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb320-82"><a href="#cb320-82" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-a-string-emitted-by-an-hmm" class="level1" data-number="107">
<h1 data-number="107"><span class="header-section-number">107</span> Compute the Probability of a String Emitted by an HMM</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability Pr(<em>x</em>) that the HMM emits&nbsp;<em>x</em>.</p>
<section id="sample-dataset-107" class="level2" data-number="107.1">
<h2 data-number="107.1" class="anchored" data-anchor-id="sample-dataset-107"><span class="header-section-number">107.1</span> Sample Dataset</h2>
<pre><code>xzyyzzyzyy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.303   0.697
B   0.831   0.169
--------
    x   y   z
A   0.533   0.065   0.402
B   0.342   0.334   0.324</code></pre>
</section>
<section id="sample-output-107" class="level2" data-number="107.2">
<h2 data-number="107.2" class="anchored" data-anchor-id="sample-output-107"><span class="header-section-number">107.2</span> Sample Output</h2>
<pre><code>1.1005510319694847e-06</code></pre>
</section>
<section id="solution-107" class="level2" data-number="107.3">
<h2 data-number="107.3" class="anchored" data-anchor-id="solution-107"><span class="header-section-number">107.3</span> Solution</h2>
<div class="sourceCode" id="cb323"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb323-2"><a href="#cb323-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb323-3"><a href="#cb323-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-4"><a href="#cb323-4" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator):</span>
<span id="cb323-5"><a href="#cb323-5" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb323-6"><a href="#cb323-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb323-7"><a href="#cb323-7" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb323-8"><a href="#cb323-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb323-9"><a href="#cb323-9" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb323-10"><a href="#cb323-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb323-11"><a href="#cb323-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-12"><a href="#cb323-12" aria-hidden="true" tabindex="-1"></a>    transition_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb323-13"><a href="#cb323-13" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb323-14"><a href="#cb323-14" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(value)</span>
<span id="cb323-15"><a href="#cb323-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(transition_lines[<span class="dv">1</span>:])</span>
<span id="cb323-16"><a href="#cb323-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb323-17"><a href="#cb323-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb323-18"><a href="#cb323-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-19"><a href="#cb323-19" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb323-20"><a href="#cb323-20" aria-hidden="true" tabindex="-1"></a>    emission_lines <span class="op">=</span> [<span class="bu">next</span>(input_iterator) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb323-21"><a href="#cb323-21" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb323-22"><a href="#cb323-22" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(value)</span>
<span id="cb323-23"><a href="#cb323-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(emission_lines[<span class="dv">1</span>:])</span>
<span id="cb323-24"><a href="#cb323-24" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, value <span class="kw">in</span> <span class="bu">enumerate</span>(row.split()[<span class="dv">1</span>:])</span>
<span id="cb323-25"><a href="#cb323-25" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb323-26"><a href="#cb323-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-27"><a href="#cb323-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, states, transition_matrix, emission_matrix</span>
<span id="cb323-28"><a href="#cb323-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-29"><a href="#cb323-29" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix):</span>
<span id="cb323-30"><a href="#cb323-30" aria-hidden="true" tabindex="-1"></a>    probability_matrix <span class="op">=</span> np.ones((<span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(states)))</span>
<span id="cb323-31"><a href="#cb323-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-32"><a href="#cb323-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb323-33"><a href="#cb323-33" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>, i] <span class="op">=</span> emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states)</span>
<span id="cb323-34"><a href="#cb323-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-35"><a href="#cb323-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb323-36"><a href="#cb323-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, current_state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb323-37"><a href="#cb323-37" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb323-38"><a href="#cb323-38" aria-hidden="true" tabindex="-1"></a>                transition_matrix[previous_state, current_state] <span class="op">*</span></span>
<span id="cb323-39"><a href="#cb323-39" aria-hidden="true" tabindex="-1"></a>                emission_matrix[current_state, emission] <span class="op">*</span></span>
<span id="cb323-40"><a href="#cb323-40" aria-hidden="true" tabindex="-1"></a>                probability_matrix[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb323-41"><a href="#cb323-41" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, previous_state <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb323-42"><a href="#cb323-42" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb323-43"><a href="#cb323-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-44"><a href="#cb323-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">sum</span>(probability_matrix[i, :])</span>
<span id="cb323-45"><a href="#cb323-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-46"><a href="#cb323-46" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb323-47"><a href="#cb323-47" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzzyzyy</span></span>
<span id="cb323-48"><a href="#cb323-48" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb323-49"><a href="#cb323-49" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb323-50"><a href="#cb323-50" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb323-51"><a href="#cb323-51" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb323-52"><a href="#cb323-52" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb323-53"><a href="#cb323-53" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb323-54"><a href="#cb323-54" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.303   0.697</span></span>
<span id="cb323-55"><a href="#cb323-55" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.831   0.169</span></span>
<span id="cb323-56"><a href="#cb323-56" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb323-57"><a href="#cb323-57" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb323-58"><a href="#cb323-58" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.533   0.065   0.402</span></span>
<span id="cb323-59"><a href="#cb323-59" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.342   0.334   0.324</span></span>
<span id="cb323-60"><a href="#cb323-60" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb323-61"><a href="#cb323-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb323-62"><a href="#cb323-62" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb323-63"><a href="#cb323-63" aria-hidden="true" tabindex="-1"></a>sequence, states, transition_matrix, emission_matrix <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb323-64"><a href="#cb323-64" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> calculate_hmm_likelihood(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb323-65"><a href="#cb323-65" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-profile-hmm" class="level1" data-number="108">
<h1 data-number="108"><span class="header-section-number">108</span> Construct a Profile HMM</h1>
<p>Given:&nbsp;A threshold&nbsp;<em>θ</em>, followed by an alphabet&nbsp;<em>Σ</em>, followed by a multiple alignment&nbsp;<em>Alignment</em>&nbsp;whose strings are formed from&nbsp;<em>Σ</em>.</p>
<p>Return:&nbsp;The transition and emission probabilities of the profile HMM&nbsp;<em>HMM</em>(<em>Alignment</em>,&nbsp;<em>θ</em>).</p>
<section id="sample-dataset-108" class="level2" data-number="108.1">
<h2 data-number="108.1" class="anchored" data-anchor-id="sample-dataset-108"><span class="header-section-number">108.1</span> Sample Dataset</h2>
<pre><code>0.289
--------
A   B   C   D   E
--------
EBA
EBD
EB-
EED
EBD
EBE
E-D
EBD</code></pre>
</section>
<section id="sample-output-108" class="level2" data-number="108.2">
<h2 data-number="108.2" class="anchored" data-anchor-id="sample-output-108"><span class="header-section-number">108.2</span> Sample Output</h2>
<pre><code>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E
S   0   0   1.0 0   0   0   0   0   0   0   0   0
I0  0   0   0   0   0   0   0   0   0   0   0   0
M1  0   0   0   0   0   0.875   0.125   0   0   0   0   0
D1  0   0   0   0   0   0   0   0   0   0   0   0
I1  0   0   0   0   0   0   0   0   0   0   0   0
M2  0   0   0   0   0   0   0   0   0.857   0.143   0   0
D2  0   0   0   0   0   0   0   0   1.0 0   0   0
I2  0   0   0   0   0   0   0   0   0   0   0   0
M3  0   0   0   0   0   0   0   0   0   0   0   1.0
D3  0   0   0   0   0   0   0   0   0   0   0   1.0
I3  0   0   0   0   0   0   0   0   0   0   0   0
E   0   0   0   0   0   0   0   0   0   0   0   0
--------
    A   B   C   D   E
S   0   0   0   0   0
I0  0   0   0   0   0
M1  0   0   0   0   1.0
D1  0   0   0   0   0
I1  0   0   0   0   0
M2  0   0.857   0   0   0.143
D2  0   0   0   0   0
I2  0   0   0   0   0
M3  0.143   0   0   0.714   0.143
D3  0   0   0   0   0
I3  0   0   0   0   0
E   0   0   0   0   0</code></pre>
</section>
<section id="solution-108" class="level2" data-number="108.3">
<h2 data-number="108.3" class="anchored" data-anchor-id="solution-108"><span class="header-section-number">108.3</span> Solution</h2>
<div class="sourceCode" id="cb326"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb326-1"><a href="#cb326-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb326-2"><a href="#cb326-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb326-3"><a href="#cb326-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Iterator</span>
<span id="cb326-4"><a href="#cb326-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-5"><a href="#cb326-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_hmm_input(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb326-6"><a href="#cb326-6" aria-hidden="true" tabindex="-1"></a>    threshold <span class="op">=</span> <span class="bu">float</span>(<span class="bu">next</span>(input_iterator).rstrip())</span>
<span id="cb326-7"><a href="#cb326-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb326-8"><a href="#cb326-8" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb326-9"><a href="#cb326-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb326-10"><a href="#cb326-10" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_iterator])</span>
<span id="cb326-11"><a href="#cb326-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, alphabet, alignment</span>
<span id="cb326-12"><a href="#cb326-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-13"><a href="#cb326-13" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb326-14"><a href="#cb326-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb326-15"><a href="#cb326-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb326-16"><a href="#cb326-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb326-17"><a href="#cb326-17" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb326-18"><a href="#cb326-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-19"><a href="#cb326-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb326-20"><a href="#cb326-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb326-21"><a href="#cb326-21" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb326-22"><a href="#cb326-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb326-23"><a href="#cb326-23" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb326-24"><a href="#cb326-24" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb326-25"><a href="#cb326-25" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb326-26"><a href="#cb326-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-27"><a href="#cb326-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb326-28"><a href="#cb326-28" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb326-29"><a href="#cb326-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-30"><a href="#cb326-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb326-31"><a href="#cb326-31" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb326-32"><a href="#cb326-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb326-33"><a href="#cb326-33" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb326-34"><a href="#cb326-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb326-35"><a href="#cb326-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-36"><a href="#cb326-36" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probabilities(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb326-37"><a href="#cb326-37" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb326-38"><a href="#cb326-38" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb326-39"><a href="#cb326-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-40"><a href="#cb326-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probabilities(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb326-41"><a href="#cb326-41" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb326-42"><a href="#cb326-42" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb326-43"><a href="#cb326-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-44"><a href="#cb326-44" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb326-45"><a href="#cb326-45" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb326-46"><a href="#cb326-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb326-47"><a href="#cb326-47" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb326-48"><a href="#cb326-48" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb326-49"><a href="#cb326-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb326-50"><a href="#cb326-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-51"><a href="#cb326-51" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb326-52"><a href="#cb326-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb326-53"><a href="#cb326-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-54"><a href="#cb326-54" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb326-55"><a href="#cb326-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb326-56"><a href="#cb326-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-57"><a href="#cb326-57" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb326-58"><a href="#cb326-58" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb326-59"><a href="#cb326-59" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb326-60"><a href="#cb326-60" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb326-61"><a href="#cb326-61" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb326-62"><a href="#cb326-62" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb326-63"><a href="#cb326-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-64"><a href="#cb326-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb326-65"><a href="#cb326-65" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb326-66"><a href="#cb326-66" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb326-67"><a href="#cb326-67" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb326-68"><a href="#cb326-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb326-69"><a href="#cb326-69" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-70"><a href="#cb326-70" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb326-71"><a href="#cb326-71" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb326-72"><a href="#cb326-72" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb326-73"><a href="#cb326-73" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb326-74"><a href="#cb326-74" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-75"><a href="#cb326-75" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb326-76"><a href="#cb326-76" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb326-77"><a href="#cb326-77" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb326-78"><a href="#cb326-78" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb326-79"><a href="#cb326-79" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-80"><a href="#cb326-80" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb326-81"><a href="#cb326-81" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb326-82"><a href="#cb326-82" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-83"><a href="#cb326-83" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb326-84"><a href="#cb326-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-85"><a href="#cb326-85" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb326-86"><a href="#cb326-86" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb326-87"><a href="#cb326-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-88"><a href="#cb326-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb326-89"><a href="#cb326-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-90"><a href="#cb326-90" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb326-91"><a href="#cb326-91" aria-hidden="true" tabindex="-1"></a><span class="st">0.289</span></span>
<span id="cb326-92"><a href="#cb326-92" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb326-93"><a href="#cb326-93" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb326-94"><a href="#cb326-94" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb326-95"><a href="#cb326-95" aria-hidden="true" tabindex="-1"></a><span class="st">EBA</span></span>
<span id="cb326-96"><a href="#cb326-96" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb326-97"><a href="#cb326-97" aria-hidden="true" tabindex="-1"></a><span class="st">EB-</span></span>
<span id="cb326-98"><a href="#cb326-98" aria-hidden="true" tabindex="-1"></a><span class="st">EED</span></span>
<span id="cb326-99"><a href="#cb326-99" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb326-100"><a href="#cb326-100" aria-hidden="true" tabindex="-1"></a><span class="st">EBE</span></span>
<span id="cb326-101"><a href="#cb326-101" aria-hidden="true" tabindex="-1"></a><span class="st">E-D</span></span>
<span id="cb326-102"><a href="#cb326-102" aria-hidden="true" tabindex="-1"></a><span class="st">EBD</span></span>
<span id="cb326-103"><a href="#cb326-103" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb326-104"><a href="#cb326-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb326-105"><a href="#cb326-105" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb326-106"><a href="#cb326-106" aria-hidden="true" tabindex="-1"></a>threshold, alphabet, alignment <span class="op">=</span> parse_hmm_input(input_lines)</span>
<span id="cb326-107"><a href="#cb326-107" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb326-108"><a href="#cb326-108" aria-hidden="true" tabindex="-1"></a>print_transition_probabilities(transition_probs)</span>
<span id="cb326-109"><a href="#cb326-109" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb326-110"><a href="#cb326-110" aria-hidden="true" tabindex="-1"></a>print_emission_probabilities(emission_probs, alphabet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-a-profile-hmm-with-pseudocounts" class="level1" data-number="109">
<h1 data-number="109"><span class="header-section-number">109</span> Construct a Profile HMM with Pseudocounts</h1>
<p>Given:&nbsp;A threshold&nbsp;<em>θ</em>&nbsp;and a pseudocount&nbsp;<em>σ</em>, followed by an alphabet&nbsp;<em>Σ</em>, followed by a multiple alignment&nbsp;<em>Alignment</em>&nbsp;whose strings are formed from&nbsp;<em>Σ</em>.</p>
<p>Return:&nbsp;The transition and emission probabilities of the profile HMM&nbsp;<em>HMM</em>(<em>Alignment</em>,&nbsp;<em>θ</em>,&nbsp;<em>σ</em>).</p>
<section id="sample-dataset-109" class="level2" data-number="109.1">
<h2 data-number="109.1" class="anchored" data-anchor-id="sample-dataset-109"><span class="header-section-number">109.1</span> Sample Dataset</h2>
<pre><code>0.358   0.01
--------
A   B   C   D   E
--------
ADA
ADA
AAA
ADC
-DA
D-A</code></pre>
</section>
<section id="sample-output-109" class="level2" data-number="109.2">
<h2 data-number="109.2" class="anchored" data-anchor-id="sample-output-109"><span class="header-section-number">109.2</span> Sample Output</h2>
<pre><code>S   I0  M1  D1  I1  M2  D2  I2  M3  D3  I3  E
S   0   0.01    0.819   0.172   0   0   0   0   0   0   0   0
I0  0   0.333   0.333   0.333   0   0   0   0   0   0   0   0
M1  0   0   0   0   0.01    0.786   0.204   0   0   0   0   0
D1  0   0   0   0   0.01    0.981   0.01    0   0   0   0   0
I1  0   0   0   0   0.333   0.333   0.333   0   0   0   0   0
M2  0   0   0   0   0   0   0   0.01    0.981   0.01    0   0
D2  0   0   0   0   0   0   0   0.01    0.981   0.01    0   0
I2  0   0   0   0   0   0   0   0.333   0.333   0.333   0   0
M3  0   0   0   0   0   0   0   0   0   0   0.01    0.99
D3  0   0   0   0   0   0   0   0   0   0   0.5 0.5
I3  0   0   0   0   0   0   0   0   0   0   0.5 0.5
E   0   0   0   0   0   0   0   0   0   0   0   0
--------
    A   B   C   D   E
S   0   0   0   0   0
I0  0.2 0.2 0.2 0.2 0.2
M1  0.771   0.01    0.01    0.2 0.01
D1  0   0   0   0   0
I1  0.2 0.2 0.2 0.2 0.2
M2  0.2 0.01    0.01    0.771   0.01
D2  0   0   0   0   0
I2  0.2 0.2 0.2 0.2 0.2
M3  0.803   0.01    0.168   0.01    0.01
D3  0   0   0   0   0
I3  0.2 0.2 0.2 0.2 0.2
E   0   0   0   0   0</code></pre>
</section>
<section id="solution-109" class="level2" data-number="109.3">
<h2 data-number="109.3" class="anchored" data-anchor-id="solution-109"><span class="header-section-number">109.3</span> Solution</h2>
<div class="sourceCode" id="cb329"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb329-1"><a href="#cb329-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb329-2"><a href="#cb329-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb329-3"><a href="#cb329-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple</span>
<span id="cb329-4"><a href="#cb329-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-5"><a href="#cb329-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-6"><a href="#cb329-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(row, include_zeros<span class="op">=</span>include_zeros, min_value<span class="op">=</span>min_value) <span class="cf">for</span> row <span class="kw">in</span> matrix])</span>
<span id="cb329-7"><a href="#cb329-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-8"><a href="#cb329-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, min_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-9"><a href="#cb329-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb329-10"><a href="#cb329-10" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb329-11"><a href="#cb329-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb329-12"><a href="#cb329-12" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb329-13"><a href="#cb329-13" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> min_value</span>
<span id="cb329-14"><a href="#cb329-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb329-15"><a href="#cb329-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-16"><a href="#cb329-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb329-17"><a href="#cb329-17" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb329-18"><a href="#cb329-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb329-19"><a href="#cb329-19" aria-hidden="true" tabindex="-1"></a>        formatted_row <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb329-20"><a href="#cb329-20" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>formatted_row, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb329-21"><a href="#cb329-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-22"><a href="#cb329-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_transition_probs(transition_matrix: np.ndarray) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb329-23"><a href="#cb329-23" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb329-24"><a href="#cb329-24" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, generate_state_labels(n), generate_state_labels(n))</span>
<span id="cb329-25"><a href="#cb329-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-26"><a href="#cb329-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_emission_probs(emission_matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb329-27"><a href="#cb329-27" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb329-28"><a href="#cb329-28" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, generate_state_labels(n), alphabet)</span>
<span id="cb329-29"><a href="#cb329-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-30"><a href="#cb329-30" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(n: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb329-31"><a href="#cb329-31" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb329-32"><a href="#cb329-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, n <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb329-33"><a href="#cb329-33" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">+=</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]</span>
<span id="cb329-34"><a href="#cb329-34" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb329-35"><a href="#cb329-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb329-36"><a href="#cb329-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-37"><a href="#cb329-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(n: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-38"><a href="#cb329-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb329-39"><a href="#cb329-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-40"><a href="#cb329-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(n: <span class="bu">int</span>, m: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-41"><a href="#cb329-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((n <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, m), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb329-42"><a href="#cb329-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-43"><a href="#cb329-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_state_index(position: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb329-44"><a href="#cb329-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb329-45"><a href="#cb329-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (position <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb329-46"><a href="#cb329-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb329-47"><a href="#cb329-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> position <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb329-48"><a href="#cb329-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-49"><a href="#cb329-49" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb329-50"><a href="#cb329-50" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb329-51"><a href="#cb329-51" aria-hidden="true" tabindex="-1"></a>    valid_column_count <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb329-52"><a href="#cb329-52" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_column_count <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb329-53"><a href="#cb329-53" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_column_count)</span>
<span id="cb329-54"><a href="#cb329-54" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_column_count, <span class="bu">len</span>(alphabet))</span>
<span id="cb329-55"><a href="#cb329-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-56"><a href="#cb329-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb329-57"><a href="#cb329-57" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb329-58"><a href="#cb329-58" aria-hidden="true" tabindex="-1"></a>        column_index <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb329-59"><a href="#cb329-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb329-60"><a href="#cb329-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[i]:</span>
<span id="cb329-61"><a href="#cb329-61" aria-hidden="true" tabindex="-1"></a>                column_index <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-62"><a href="#cb329-62" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb329-63"><a href="#cb329-63" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"del"</span>)</span>
<span id="cb329-64"><a href="#cb329-64" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb329-65"><a href="#cb329-65" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"match"</span>)</span>
<span id="cb329-66"><a href="#cb329-66" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-67"><a href="#cb329-67" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb329-68"><a href="#cb329-68" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb329-69"><a href="#cb329-69" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb329-70"><a href="#cb329-70" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_state_index(column_index, <span class="st">"ins"</span>)</span>
<span id="cb329-71"><a href="#cb329-71" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-72"><a href="#cb329-72" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb329-73"><a href="#cb329-73" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb329-74"><a href="#cb329-74" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-75"><a href="#cb329-75" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb329-76"><a href="#cb329-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-77"><a href="#cb329-77" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb329-78"><a href="#cb329-78" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb329-79"><a href="#cb329-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-80"><a href="#cb329-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb329-81"><a href="#cb329-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-82"><a href="#cb329-82" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(input_handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb329-83"><a href="#cb329-83" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_handle).rstrip().split())</span>
<span id="cb329-84"><a href="#cb329-84" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb329-85"><a href="#cb329-85" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_handle).split()</span>
<span id="cb329-86"><a href="#cb329-86" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_handle)</span>
<span id="cb329-87"><a href="#cb329-87" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(sequence.strip()) <span class="cf">for</span> sequence <span class="kw">in</span> input_handle])</span>
<span id="cb329-88"><a href="#cb329-88" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> threshold, pseudocount, alphabet, alignment</span>
<span id="cb329-89"><a href="#cb329-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-90"><a href="#cb329-90" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_transition_pseudocounts(transition_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-91"><a href="#cb329-91" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (transition_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb329-92"><a href="#cb329-92" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb329-93"><a href="#cb329-93" aria-hidden="true" tabindex="-1"></a>    transition_matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb329-94"><a href="#cb329-94" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb329-95"><a href="#cb329-95" aria-hidden="true" tabindex="-1"></a>        transition_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span> : i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">5</span>, (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span> : (i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb329-96"><a href="#cb329-96" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(transition_matrix)</span>
<span id="cb329-97"><a href="#cb329-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-98"><a href="#cb329-98" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_emission_pseudocounts(emission_matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb329-99"><a href="#cb329-99" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> (emission_matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb329-100"><a href="#cb329-100" aria-hidden="true" tabindex="-1"></a>    emission_matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb329-101"><a href="#cb329-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(n):</span>
<span id="cb329-102"><a href="#cb329-102" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb329-103"><a href="#cb329-103" aria-hidden="true" tabindex="-1"></a>        emission_matrix[i <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb329-104"><a href="#cb329-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(emission_matrix)</span>
<span id="cb329-105"><a href="#cb329-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-106"><a href="#cb329-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_pseudocount_profile_hmm(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb329-107"><a href="#cb329-107" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb329-108"><a href="#cb329-108" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_transition_pseudocounts(transition_probs, pseudocount)</span>
<span id="cb329-109"><a href="#cb329-109" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_emission_pseudocounts(emission_probs, pseudocount)</span>
<span id="cb329-110"><a href="#cb329-110" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb329-111"><a href="#cb329-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-112"><a href="#cb329-112" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb329-113"><a href="#cb329-113" aria-hidden="true" tabindex="-1"></a><span class="st">0.358   0.01</span></span>
<span id="cb329-114"><a href="#cb329-114" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb329-115"><a href="#cb329-115" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E</span></span>
<span id="cb329-116"><a href="#cb329-116" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb329-117"><a href="#cb329-117" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb329-118"><a href="#cb329-118" aria-hidden="true" tabindex="-1"></a><span class="st">ADA</span></span>
<span id="cb329-119"><a href="#cb329-119" aria-hidden="true" tabindex="-1"></a><span class="st">AAA</span></span>
<span id="cb329-120"><a href="#cb329-120" aria-hidden="true" tabindex="-1"></a><span class="st">ADC</span></span>
<span id="cb329-121"><a href="#cb329-121" aria-hidden="true" tabindex="-1"></a><span class="st">-DA</span></span>
<span id="cb329-122"><a href="#cb329-122" aria-hidden="true" tabindex="-1"></a><span class="st">D-A</span></span>
<span id="cb329-123"><a href="#cb329-123" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb329-124"><a href="#cb329-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb329-125"><a href="#cb329-125" aria-hidden="true" tabindex="-1"></a>input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb329-126"><a href="#cb329-126" aria-hidden="true" tabindex="-1"></a>threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb329-127"><a href="#cb329-127" aria-hidden="true" tabindex="-1"></a>transition_probs, emission_probs <span class="op">=</span> build_pseudocount_profile_hmm(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb329-128"><a href="#cb329-128" aria-hidden="true" tabindex="-1"></a>print_transition_probs(transition_probs)</span>
<span id="cb329-129"><a href="#cb329-129" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb329-130"><a href="#cb329-130" aria-hidden="true" tabindex="-1"></a>print_emission_probs(emission_probs, alphabet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="perform-a-multiple-sequence-alignment-with-a-profile-hmm" class="level1" data-number="110">
<h1 data-number="110"><span class="header-section-number">110</span> Perform a Multiple Sequence Alignment with a Profile HMM</h1>
<p>Given:&nbsp;A string Text, a multiple alignment Alignment, a threshold θ, and a pseudocount σ.</p>
<p>Return:&nbsp;An optimal hidden path emitting Text in HMM(Alignment,θ,σ).</p>
<section id="sample-dataset-110" class="level2" data-number="110.1">
<h2 data-number="110.1" class="anchored" data-anchor-id="sample-dataset-110"><span class="header-section-number">110.1</span> Sample Dataset</h2>
<pre><code>AEFDFDC
--------
0.4 0.01
--------
A   B   C   D   E   F
--------
ACDEFACADF
AFDA---CCF
A--EFD-FDC
ACAEF--A-C
ADDEFAAADF</code></pre>
</section>
<section id="sample-output-110" class="level2" data-number="110.2">
<h2 data-number="110.2" class="anchored" data-anchor-id="sample-output-110"><span class="header-section-number">110.2</span> Sample Output</h2>
<pre><code>M1 D2 D3 M4 M5 I5 M6 M7 M8</code></pre>
</section>
<section id="solution-110" class="level2" data-number="110.3">
<h2 data-number="110.3" class="anchored" data-anchor-id="solution-110"><span class="header-section-number">110.3</span> Solution</h2>
<div class="sourceCode" id="cb332"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb332-1"><a href="#cb332-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb332-2"><a href="#cb332-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb332-3"><a href="#cb332-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator</span>
<span id="cb332-4"><a href="#cb332-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb332-5"><a href="#cb332-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> inf, log</span>
<span id="cb332-6"><a href="#cb332-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-7"><a href="#cb332-7" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_state_labels(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb332-8"><a href="#cb332-8" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="st">"S"</span>, <span class="st">"I0"</span>]</span>
<span id="cb332-9"><a href="#cb332-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb332-10"><a href="#cb332-10" aria-hidden="true" tabindex="-1"></a>        labels.extend([<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>])</span>
<span id="cb332-11"><a href="#cb332-11" aria-hidden="true" tabindex="-1"></a>    labels.append(<span class="st">"E"</span>)</span>
<span id="cb332-12"><a href="#cb332-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels</span>
<span id="cb332-13"><a href="#cb332-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-14"><a href="#cb332-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-15"><a href="#cb332-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb332-16"><a href="#cb332-16" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb332-17"><a href="#cb332-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb332-18"><a href="#cb332-18" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb332-19"><a href="#cb332-19" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb332-20"><a href="#cb332-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb332-21"><a href="#cb332-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-22"><a href="#cb332-22" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-23"><a href="#cb332-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb332-24"><a href="#cb332-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-25"><a href="#cb332-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_transition_matrix(num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-26"><a href="#cb332-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb332-27"><a href="#cb332-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-28"><a href="#cb332-28" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_emission_matrix(num_states: <span class="bu">int</span>, num_symbols: <span class="bu">int</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-29"><a href="#cb332-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.zeros((num_states <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span>, num_symbols), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb332-30"><a href="#cb332-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-31"><a href="#cb332-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_index(state_num: <span class="bu">int</span>, state_type: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb332-32"><a href="#cb332-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> state_type <span class="op">==</span> <span class="st">"ins"</span>:</span>
<span id="cb332-33"><a href="#cb332-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> (state_num <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb332-34"><a href="#cb332-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb332-35"><a href="#cb332-35" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {<span class="st">"match"</span>: <span class="dv">0</span>, <span class="st">"del"</span>: <span class="dv">1</span>}[state_type] <span class="op">+</span> <span class="dv">3</span> <span class="op">*</span> state_num <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb332-36"><a href="#cb332-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-37"><a href="#cb332-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm(threshold: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb332-38"><a href="#cb332-38" aria-hidden="true" tabindex="-1"></a>    valid_columns <span class="op">=</span> np.mean(alignment <span class="op">==</span> <span class="st">"-"</span>, axis<span class="op">=</span><span class="dv">0</span>) <span class="op">&lt;</span> threshold</span>
<span id="cb332-39"><a href="#cb332-39" aria-hidden="true" tabindex="-1"></a>    valid_length <span class="op">=</span> <span class="bu">sum</span>(valid_columns)</span>
<span id="cb332-40"><a href="#cb332-40" aria-hidden="true" tabindex="-1"></a>    end_state <span class="op">=</span> valid_length <span class="op">*</span> <span class="dv">3</span> <span class="op">+</span> <span class="dv">2</span></span>
<span id="cb332-41"><a href="#cb332-41" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> create_transition_matrix(valid_length)</span>
<span id="cb332-42"><a href="#cb332-42" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> create_emission_matrix(valid_length, <span class="bu">len</span>(alphabet))</span>
<span id="cb332-43"><a href="#cb332-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-44"><a href="#cb332-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> sequence <span class="kw">in</span> alignment:</span>
<span id="cb332-45"><a href="#cb332-45" aria-hidden="true" tabindex="-1"></a>        prev_index <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb332-46"><a href="#cb332-46" aria-hidden="true" tabindex="-1"></a>        valid_col_count <span class="op">=</span> <span class="op">-</span><span class="dv">1</span></span>
<span id="cb332-47"><a href="#cb332-47" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> col, char <span class="kw">in</span> <span class="bu">enumerate</span>(sequence):</span>
<span id="cb332-48"><a href="#cb332-48" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> valid_columns[col]:</span>
<span id="cb332-49"><a href="#cb332-49" aria-hidden="true" tabindex="-1"></a>                valid_col_count <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-50"><a href="#cb332-50" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">==</span> <span class="st">"-"</span>:</span>
<span id="cb332-51"><a href="#cb332-51" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"del"</span>)</span>
<span id="cb332-52"><a href="#cb332-52" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb332-53"><a href="#cb332-53" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"match"</span>)</span>
<span id="cb332-54"><a href="#cb332-54" aria-hidden="true" tabindex="-1"></a>                transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-55"><a href="#cb332-55" aria-hidden="true" tabindex="-1"></a>                prev_index <span class="op">=</span> current_index</span>
<span id="cb332-56"><a href="#cb332-56" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb332-57"><a href="#cb332-57" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb332-58"><a href="#cb332-58" aria-hidden="true" tabindex="-1"></a>                    current_index <span class="op">=</span> calculate_index(valid_col_count, <span class="st">"ins"</span>)</span>
<span id="cb332-59"><a href="#cb332-59" aria-hidden="true" tabindex="-1"></a>                    transition_probs[prev_index, current_index] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-60"><a href="#cb332-60" aria-hidden="true" tabindex="-1"></a>                    prev_index <span class="op">=</span> current_index</span>
<span id="cb332-61"><a href="#cb332-61" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> char <span class="op">!=</span> <span class="st">"-"</span>:</span>
<span id="cb332-62"><a href="#cb332-62" aria-hidden="true" tabindex="-1"></a>                emission_probs[current_index, alphabet.index(char)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-63"><a href="#cb332-63" aria-hidden="true" tabindex="-1"></a>        transition_probs[prev_index, end_state] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb332-64"><a href="#cb332-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-65"><a href="#cb332-65" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> normalize_matrix(transition_probs)</span>
<span id="cb332-66"><a href="#cb332-66" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> normalize_matrix(emission_probs)</span>
<span id="cb332-67"><a href="#cb332-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-68"><a href="#cb332-68" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb332-69"><a href="#cb332-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-70"><a href="#cb332-70" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_transitions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-71"><a href="#cb332-71" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-72"><a href="#cb332-72" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">0</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb332-73"><a href="#cb332-73" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, <span class="dv">1</span>:<span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb332-74"><a href="#cb332-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-75"><a href="#cb332-75" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>:i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">5</span>, (i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">1</span>:(i<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>] <span class="op">+=</span> pseudocount</span>
<span id="cb332-76"><a href="#cb332-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb332-77"><a href="#cb332-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-78"><a href="#cb332-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> add_pseudocounts_to_emissions(matrix: np.ndarray, pseudocount: <span class="bu">float</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb332-79"><a href="#cb332-79" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-80"><a href="#cb332-80" aria-hidden="true" tabindex="-1"></a>    matrix[<span class="dv">1</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb332-81"><a href="#cb332-81" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-82"><a href="#cb332-82" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">2</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb332-83"><a href="#cb332-83" aria-hidden="true" tabindex="-1"></a>        matrix[i<span class="op">*</span><span class="dv">3</span><span class="op">+</span><span class="dv">4</span>, :] <span class="op">+=</span> pseudocount</span>
<span id="cb332-84"><a href="#cb332-84" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalize_matrix(matrix)</span>
<span id="cb332-85"><a href="#cb332-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-86"><a href="#cb332-86" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_profile_hmm_with_pseudocounts(threshold: <span class="bu">float</span>, pseudocount: <span class="bu">float</span>, alphabet: List[<span class="bu">str</span>], alignment: np.ndarray) <span class="op">-&gt;</span> Tuple[np.ndarray, np.ndarray]:</span>
<span id="cb332-87"><a href="#cb332-87" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm(threshold, alphabet, alignment)</span>
<span id="cb332-88"><a href="#cb332-88" aria-hidden="true" tabindex="-1"></a>    transition_probs <span class="op">=</span> add_pseudocounts_to_transitions(transition_probs, pseudocount)</span>
<span id="cb332-89"><a href="#cb332-89" aria-hidden="true" tabindex="-1"></a>    emission_probs <span class="op">=</span> add_pseudocounts_to_emissions(emission_probs, pseudocount)</span>
<span id="cb332-90"><a href="#cb332-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> transition_probs, emission_probs</span>
<span id="cb332-91"><a href="#cb332-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-92"><a href="#cb332-92" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input_data(input_iterator: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>, <span class="bu">float</span>, List[<span class="bu">str</span>], np.ndarray]:</span>
<span id="cb332-93"><a href="#cb332-93" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(input_iterator).rstrip()</span>
<span id="cb332-94"><a href="#cb332-94" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb332-95"><a href="#cb332-95" aria-hidden="true" tabindex="-1"></a>    threshold, pseudocount <span class="op">=</span> <span class="bu">map</span>(<span class="bu">float</span>, <span class="bu">next</span>(input_iterator).rstrip().split())</span>
<span id="cb332-96"><a href="#cb332-96" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb332-97"><a href="#cb332-97" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(input_iterator).split()</span>
<span id="cb332-98"><a href="#cb332-98" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(input_iterator)</span>
<span id="cb332-99"><a href="#cb332-99" aria-hidden="true" tabindex="-1"></a>    alignment <span class="op">=</span> np.array([<span class="bu">list</span>(x.strip()) <span class="cf">for</span> x <span class="kw">in</span> input_iterator])</span>
<span id="cb332-100"><a href="#cb332-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, threshold, pseudocount, alphabet, alignment</span>
<span id="cb332-101"><a href="#cb332-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-102"><a href="#cb332-102" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_transition_probs_to_dict(matrix: np.ndarray) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb332-103"><a href="#cb332-103" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb332-104"><a href="#cb332-104" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-105"><a href="#cb332-105" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb332-106"><a href="#cb332-106" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb332-107"><a href="#cb332-107" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb332-108"><a href="#cb332-108" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb332-109"><a href="#cb332-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb332-110"><a href="#cb332-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-111"><a href="#cb332-111" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_emission_probs_to_dict(matrix: np.ndarray, alphabet: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb332-112"><a href="#cb332-112" aria-hidden="true" tabindex="-1"></a>    prob_dict <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb332-113"><a href="#cb332-113" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (matrix.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-114"><a href="#cb332-114" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> generate_state_labels(num_states)</span>
<span id="cb332-115"><a href="#cb332-115" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb332-116"><a href="#cb332-116" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, symbol <span class="kw">in</span> <span class="bu">enumerate</span>(alphabet):</span>
<span id="cb332-117"><a href="#cb332-117" aria-hidden="true" tabindex="-1"></a>            prob_dict[labels[i], symbol] <span class="op">=</span> matrix[i][j]</span>
<span id="cb332-118"><a href="#cb332-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> prob_dict</span>
<span id="cb332-119"><a href="#cb332-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-120"><a href="#cb332-120" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> build_hmm_graph(transition_probs: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], num_states: <span class="bu">int</span>) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]:</span>
<span id="cb332-121"><a href="#cb332-121" aria-hidden="true" tabindex="-1"></a>    <span class="kw">def</span> add_edge(source: <span class="bu">str</span>, target: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb332-122"><a href="#cb332-122" aria-hidden="true" tabindex="-1"></a>        graph[source].append({<span class="st">"node"</span>: target, <span class="st">"weight"</span>: transition_probs[source, target]})</span>
<span id="cb332-123"><a href="#cb332-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-124"><a href="#cb332-124" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb332-125"><a href="#cb332-125" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> target <span class="kw">in</span> [<span class="st">"I0"</span>, <span class="st">"M1"</span>, <span class="st">"D1"</span>]:</span>
<span id="cb332-126"><a href="#cb332-126" aria-hidden="true" tabindex="-1"></a>        add_edge(<span class="st">"S"</span>, target)</span>
<span id="cb332-127"><a href="#cb332-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-128"><a href="#cb332-128" aria-hidden="true" tabindex="-1"></a>        source <span class="op">=</span> <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span></span>
<span id="cb332-129"><a href="#cb332-129" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [source, <span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb332-130"><a href="#cb332-130" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb332-131"><a href="#cb332-131" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, num_states):</span>
<span id="cb332-132"><a href="#cb332-132" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb332-133"><a href="#cb332-133" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"M</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"I</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>i<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb332-134"><a href="#cb332-134" aria-hidden="true" tabindex="-1"></a>                add_edge(source, target)</span>
<span id="cb332-135"><a href="#cb332-135" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> source <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>]:</span>
<span id="cb332-136"><a href="#cb332-136" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> target <span class="kw">in</span> [<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, <span class="st">"E"</span>]:</span>
<span id="cb332-137"><a href="#cb332-137" aria-hidden="true" tabindex="-1"></a>            add_edge(source, target)</span>
<span id="cb332-138"><a href="#cb332-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-139"><a href="#cb332-139" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb332-140"><a href="#cb332-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-141"><a href="#cb332-141" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> generate_topological_order(num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> Iterator[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb332-142"><a href="#cb332-142" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"S"</span>, <span class="dv">0</span>)</span>
<span id="cb332-143"><a href="#cb332-143" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-144"><a href="#cb332-144" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="ss">f"D</span><span class="sc">{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)</span>
<span id="cb332-145"><a href="#cb332-145" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(seq_length):</span>
<span id="cb332-146"><a href="#cb332-146" aria-hidden="true" tabindex="-1"></a>        <span class="cf">yield</span> (<span class="st">"I0"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb332-147"><a href="#cb332-147" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(num_states):</span>
<span id="cb332-148"><a href="#cb332-148" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> state_type <span class="kw">in</span> [<span class="st">"M"</span>, <span class="st">"D"</span>, <span class="st">"I"</span>]:</span>
<span id="cb332-149"><a href="#cb332-149" aria-hidden="true" tabindex="-1"></a>                <span class="cf">yield</span> (<span class="ss">f"</span><span class="sc">{</span>state_type<span class="sc">}{</span>j<span class="op">+</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, i <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb332-150"><a href="#cb332-150" aria-hidden="true" tabindex="-1"></a>    <span class="cf">yield</span> (<span class="st">"E"</span>, seq_length <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb332-151"><a href="#cb332-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-152"><a href="#cb332-152" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_previous_nodes(current_node: <span class="bu">str</span>, current_col: <span class="bu">int</span>, num_states: <span class="bu">int</span>, seq_length: <span class="bu">int</span>) <span class="op">-&gt;</span> List[Tuple[<span class="bu">str</span>, <span class="bu">int</span>]]:</span>
<span id="cb332-153"><a href="#cb332-153" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"E"</span>:</span>
<span id="cb332-154"><a href="#cb332-154" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"M</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length), (<span class="ss">f"I</span><span class="sc">{</span>num_states<span class="sc">}</span><span class="ss">"</span>, seq_length)]</span>
<span id="cb332-155"><a href="#cb332-155" aria-hidden="true" tabindex="-1"></a>    state_num <span class="op">=</span> <span class="bu">int</span>(current_node[<span class="dv">1</span>:])</span>
<span id="cb332-156"><a href="#cb332-156" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb332-157"><a href="#cb332-157" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)]</span>
<span id="cb332-158"><a href="#cb332-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"I0"</span>:</span>
<span id="cb332-159"><a href="#cb332-159" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb332-160"><a href="#cb332-160" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node <span class="op">==</span> <span class="st">"M1"</span>:</span>
<span id="cb332-161"><a href="#cb332-161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"S"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="st">"I0"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb332-162"><a href="#cb332-162" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"I"</span>:</span>
<span id="cb332-163"><a href="#cb332-163" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb332-164"><a href="#cb332-164" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"M"</span>:</span>
<span id="cb332-165"><a href="#cb332-165" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, <span class="dv">0</span>)] <span class="cf">if</span> current_col <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col <span class="op">-</span> <span class="dv">1</span>)]</span>
<span id="cb332-166"><a href="#cb332-166" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> current_node[<span class="dv">0</span>] <span class="op">==</span> <span class="st">"D"</span>:</span>
<span id="cb332-167"><a href="#cb332-167" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> [(<span class="st">"I0"</span>, current_col)] <span class="cf">if</span> state_num <span class="op">==</span> <span class="dv">1</span> <span class="cf">else</span> [(<span class="ss">f"D</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"M</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col), (<span class="ss">f"I</span><span class="sc">{</span>state_num<span class="op">-</span><span class="dv">1</span><span class="sc">}</span><span class="ss">"</span>, current_col)]</span>
<span id="cb332-168"><a href="#cb332-168" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb332-169"><a href="#cb332-169" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"Unhandled node: </span><span class="sc">{</span>current_node<span class="sc">}</span><span class="ss">"</span>)</span>
<span id="cb332-170"><a href="#cb332-170" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> []</span>
<span id="cb332-171"><a href="#cb332-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-172"><a href="#cb332-172" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> simplify_graph(graph: Dict[<span class="bu">str</span>, List[Dict[<span class="bu">str</span>, <span class="bu">float</span>]]]) <span class="op">-&gt;</span> Dict[<span class="bu">str</span>, Dict[<span class="bu">str</span>, <span class="bu">float</span>]]:</span>
<span id="cb332-173"><a href="#cb332-173" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> {k: {x[<span class="st">"node"</span>]: x[<span class="st">"weight"</span>] <span class="cf">for</span> x <span class="kw">in</span> v} <span class="cf">for</span> k, v <span class="kw">in</span> graph.items()}</span>
<span id="cb332-174"><a href="#cb332-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-175"><a href="#cb332-175" aria-hidden="true" tabindex="-1"></a><span class="co"># Main execution</span></span>
<span id="cb332-176"><a href="#cb332-176" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input):</span>
<span id="cb332-177"><a href="#cb332-177" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb332-178"><a href="#cb332-178" aria-hidden="true" tabindex="-1"></a>    sequence, threshold, pseudocount, alphabet, alignment <span class="op">=</span> parse_input_data(input_lines)</span>
<span id="cb332-179"><a href="#cb332-179" aria-hidden="true" tabindex="-1"></a>    transition_probs, emission_probs <span class="op">=</span> build_profile_hmm_with_pseudocounts(threshold, pseudocount, alphabet, alignment)</span>
<span id="cb332-180"><a href="#cb332-180" aria-hidden="true" tabindex="-1"></a>    num_states <span class="op">=</span> (transition_probs.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">3</span>) <span class="op">//</span> <span class="dv">3</span></span>
<span id="cb332-181"><a href="#cb332-181" aria-hidden="true" tabindex="-1"></a>    transition_probs_dict <span class="op">=</span> convert_transition_probs_to_dict(transition_probs)</span>
<span id="cb332-182"><a href="#cb332-182" aria-hidden="true" tabindex="-1"></a>    emission_probs_dict <span class="op">=</span> convert_emission_probs_to_dict(emission_probs, alphabet)</span>
<span id="cb332-183"><a href="#cb332-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-184"><a href="#cb332-184" aria-hidden="true" tabindex="-1"></a>    graph <span class="op">=</span> build_hmm_graph(transition_probs_dict, num_states)</span>
<span id="cb332-185"><a href="#cb332-185" aria-hidden="true" tabindex="-1"></a>    topological_order <span class="op">=</span> generate_topological_order(num_states, <span class="bu">len</span>(sequence))</span>
<span id="cb332-186"><a href="#cb332-186" aria-hidden="true" tabindex="-1"></a>    simplified_graph <span class="op">=</span> simplify_graph(graph)</span>
<span id="cb332-187"><a href="#cb332-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-188"><a href="#cb332-188" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Dynamic programming to find the most probable path</span></span>
<span id="cb332-189"><a href="#cb332-189" aria-hidden="true" tabindex="-1"></a>    previous_node <span class="op">=</span> <span class="bu">next</span>(topological_order)</span>
<span id="cb332-190"><a href="#cb332-190" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {previous_node: <span class="dv">0</span>}</span>
<span id="cb332-191"><a href="#cb332-191" aria-hidden="true" tabindex="-1"></a>    backpointers <span class="op">=</span> {previous_node: (<span class="va">None</span>, <span class="va">None</span>)}</span>
<span id="cb332-192"><a href="#cb332-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-193"><a href="#cb332-193" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_node, current_col <span class="kw">in</span> topological_order:</span>
<span id="cb332-194"><a href="#cb332-194" aria-hidden="true" tabindex="-1"></a>        backpointers[(current_node, current_col)] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb332-195"><a href="#cb332-195" aria-hidden="true" tabindex="-1"></a>        scores[(current_node, current_col)] <span class="op">=</span> <span class="op">-</span>inf</span>
<span id="cb332-196"><a href="#cb332-196" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> prev_node, prev_col <span class="kw">in</span> get_previous_nodes(current_node, current_col, num_states, <span class="bu">len</span>(sequence)):</span>
<span id="cb332-197"><a href="#cb332-197" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> prev_col <span class="op">&lt;</span> current_col <span class="kw">and</span> current_node <span class="op">!=</span> <span class="st">"E"</span>:</span>
<span id="cb332-198"><a href="#cb332-198" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> emission_probs_dict[current_node, sequence[current_col <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb332-199"><a href="#cb332-199" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb332-200"><a href="#cb332-200" aria-hidden="true" tabindex="-1"></a>                emission_prob <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb332-201"><a href="#cb332-201" aria-hidden="true" tabindex="-1"></a>            log_prob <span class="op">=</span> log(simplified_graph[prev_node][current_node]) <span class="op">+</span> log(emission_prob) <span class="op">+</span> scores[(prev_node, prev_col)]</span>
<span id="cb332-202"><a href="#cb332-202" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> log_prob <span class="op">&gt;</span> scores[(current_node, current_col)]:</span>
<span id="cb332-203"><a href="#cb332-203" aria-hidden="true" tabindex="-1"></a>                scores[(current_node, current_col)] <span class="op">=</span> log_prob</span>
<span id="cb332-204"><a href="#cb332-204" aria-hidden="true" tabindex="-1"></a>                backpointers[(current_node, current_col)] <span class="op">=</span> (prev_node, prev_col)</span>
<span id="cb332-205"><a href="#cb332-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-206"><a href="#cb332-206" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Traceback to find the path</span></span>
<span id="cb332-207"><a href="#cb332-207" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> []</span>
<span id="cb332-208"><a href="#cb332-208" aria-hidden="true" tabindex="-1"></a>    position <span class="op">=</span> (<span class="st">"E"</span>, <span class="bu">len</span>(sequence) <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb332-209"><a href="#cb332-209" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> position[<span class="dv">0</span>]:</span>
<span id="cb332-210"><a href="#cb332-210" aria-hidden="true" tabindex="-1"></a>        path.append(backpointers[position][<span class="dv">0</span>])</span>
<span id="cb332-211"><a href="#cb332-211" aria-hidden="true" tabindex="-1"></a>        position <span class="op">=</span> backpointers[position]</span>
<span id="cb332-212"><a href="#cb332-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-213"><a href="#cb332-213" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>path[::<span class="op">-</span><span class="dv">1</span>][<span class="dv">2</span>:])</span>
<span id="cb332-214"><a href="#cb332-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-215"><a href="#cb332-215" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb332-216"><a href="#cb332-216" aria-hidden="true" tabindex="-1"></a><span class="st">AEFDFDC</span></span>
<span id="cb332-217"><a href="#cb332-217" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb332-218"><a href="#cb332-218" aria-hidden="true" tabindex="-1"></a><span class="st">0.4 0.01</span></span>
<span id="cb332-219"><a href="#cb332-219" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb332-220"><a href="#cb332-220" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C   D   E   F</span></span>
<span id="cb332-221"><a href="#cb332-221" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb332-222"><a href="#cb332-222" aria-hidden="true" tabindex="-1"></a><span class="st">ACDEFACADF</span></span>
<span id="cb332-223"><a href="#cb332-223" aria-hidden="true" tabindex="-1"></a><span class="st">AFDA---CCF</span></span>
<span id="cb332-224"><a href="#cb332-224" aria-hidden="true" tabindex="-1"></a><span class="st">A--EFD-FDC</span></span>
<span id="cb332-225"><a href="#cb332-225" aria-hidden="true" tabindex="-1"></a><span class="st">ACAEF--A-C</span></span>
<span id="cb332-226"><a href="#cb332-226" aria-hidden="true" tabindex="-1"></a><span class="st">ADDEFAAADF</span></span>
<span id="cb332-227"><a href="#cb332-227" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb332-228"><a href="#cb332-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb332-229"><a href="#cb332-229" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="estimate-the-parameters-of-an-hmm" class="level1" data-number="111">
<h1 data-number="111"><span class="header-section-number">111</span> Estimate the Parameters of an HMM</h1>
<p>Given:&nbsp;A sequence of emitted symbols x = x1… xn in an alphabet ∑ and a path <span class="math inline">\(π = π_1... π_n\)</span> generated by a k-state HMM with unknown transition and emission probabilities.</p>
<p>Return:&nbsp;A matrix of transition probabilities Transition and a matrix of emission probabilities Emission that maximize <span class="math inline">\(Pr(x,π)\)</span> over all possible matrices of transition and emission probabilities.</p>
<section id="sample-dataset-111" class="level2" data-number="111.1">
<h2 data-number="111.1" class="anchored" data-anchor-id="sample-dataset-111"><span class="header-section-number">111.1</span> Sample Dataset</h2>
<pre><code>yzzzyxzxxx
--------
x   y   z
--------
BBABABABAB
--------
A   B   C</code></pre>
</section>
<section id="sample-output-111" class="level2" data-number="111.2">
<h2 data-number="111.2" class="anchored" data-anchor-id="sample-output-111"><span class="header-section-number">111.2</span> Sample Output</h2>
<pre><code>A   B   C
A   0.0 1.0 0.0
B   0.8 0.2 0.0
C   0.333   0.333   0.333
--------
    x   y   z
A   0.25    0.25    0.5
B   0.5 0.167   0.333
C   0.333   0.333   0.333</code></pre>
</section>
<section id="solution-111" class="level2" data-number="111.3">
<h2 data-number="111.3" class="anchored" data-anchor-id="solution-111"><span class="header-section-number">111.3</span> Solution</h2>
<div class="sourceCode" id="cb335"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb335-1"><a href="#cb335-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb335-2"><a href="#cb335-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb335-3"><a href="#cb335-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Tuple, Dict, Iterator, Union</span>
<span id="cb335-4"><a href="#cb335-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb335-5"><a href="#cb335-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-6"><a href="#cb335-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_row(row: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb335-7"><a href="#cb335-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros <span class="kw">and</span> <span class="bu">sum</span>(row) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb335-8"><a href="#cb335-8" aria-hidden="true" tabindex="-1"></a>        row[:] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb335-9"><a href="#cb335-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">with</span> np.errstate(divide<span class="op">=</span><span class="st">"ignore"</span>, invalid<span class="op">=</span><span class="st">"ignore"</span>):</span>
<span id="cb335-10"><a href="#cb335-10" aria-hidden="true" tabindex="-1"></a>        normalized <span class="op">=</span> row <span class="op">/</span> <span class="bu">sum</span>(row)</span>
<span id="cb335-11"><a href="#cb335-11" aria-hidden="true" tabindex="-1"></a>        normalized[row <span class="op">==</span> <span class="fl">0.0</span>] <span class="op">=</span> minimum_value</span>
<span id="cb335-12"><a href="#cb335-12" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> normalized</span>
<span id="cb335-13"><a href="#cb335-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-14"><a href="#cb335-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>, minimum_value: <span class="bu">float</span> <span class="op">=</span> <span class="fl">0.0</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb335-15"><a href="#cb335-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> np.array([normalize_row(r, include_zeros<span class="op">=</span>include_zeros, minimum_value<span class="op">=</span>minimum_value) <span class="cf">for</span> r <span class="kw">in</span> matrix])</span>
<span id="cb335-16"><a href="#cb335-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-17"><a href="#cb335-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb335-18"><a href="#cb335-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb335-19"><a href="#cb335-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb335-20"><a href="#cb335-20" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb335-21"><a href="#cb335-21" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb335-22"><a href="#cb335-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-23"><a href="#cb335-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], <span class="bu">str</span>, List[<span class="bu">str</span>]]:</span>
<span id="cb335-24"><a href="#cb335-24" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb335-25"><a href="#cb335-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb335-26"><a href="#cb335-26" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb335-27"><a href="#cb335-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb335-28"><a href="#cb335-28" aria-hidden="true" tabindex="-1"></a>    path <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb335-29"><a href="#cb335-29" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb335-30"><a href="#cb335-30" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb335-31"><a href="#cb335-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> sequence, alphabet, path, states</span>
<span id="cb335-32"><a href="#cb335-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-33"><a href="#cb335-33" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_to_dict(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb335-34"><a href="#cb335-34" aria-hidden="true" tabindex="-1"></a>    result <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb335-35"><a href="#cb335-35" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">0</span>]):</span>
<span id="cb335-36"><a href="#cb335-36" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(matrix.shape[<span class="dv">1</span>]):</span>
<span id="cb335-37"><a href="#cb335-37" aria-hidden="true" tabindex="-1"></a>            result[row_labels[i], column_labels[j]] <span class="op">=</span> matrix[i][j]</span>
<span id="cb335-38"><a href="#cb335-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result</span>
<span id="cb335-39"><a href="#cb335-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-40"><a href="#cb335-40" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb335-41"><a href="#cb335-41" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb335-42"><a href="#cb335-42" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> current_state, next_state <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb335-43"><a href="#cb335-43" aria-hidden="true" tabindex="-1"></a>        transition_matrix[states.index(current_state)][states.index(next_state)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb335-44"><a href="#cb335-44" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> normalize_matrix(transition_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb335-45"><a href="#cb335-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb335-46"><a href="#cb335-46" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(transition_matrix, states, states)</span>
<span id="cb335-47"><a href="#cb335-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb335-48"><a href="#cb335-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> transition_matrix</span>
<span id="cb335-49"><a href="#cb335-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-50"><a href="#cb335-50" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Union[np.ndarray, Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb335-51"><a href="#cb335-51" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb335-52"><a href="#cb335-52" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> state, symbol <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb335-53"><a href="#cb335-53" aria-hidden="true" tabindex="-1"></a>        emission_matrix[states.index(state)][alphabet.index(symbol)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb335-54"><a href="#cb335-54" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> normalize_matrix(emission_matrix, include_zeros<span class="op">=</span><span class="va">True</span>, minimum_value<span class="op">=</span><span class="fl">1e-16</span>)</span>
<span id="cb335-55"><a href="#cb335-55" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb335-56"><a href="#cb335-56" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> convert_to_dict(emission_matrix, states, alphabet)</span>
<span id="cb335-57"><a href="#cb335-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb335-58"><a href="#cb335-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> emission_matrix</span>
<span id="cb335-59"><a href="#cb335-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-60"><a href="#cb335-60" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb335-61"><a href="#cb335-61" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> <span class="bu">iter</span>(StringIO(sample_input.strip()).readlines())</span>
<span id="cb335-62"><a href="#cb335-62" aria-hidden="true" tabindex="-1"></a>    sequence, alphabet, path, states <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb335-63"><a href="#cb335-63" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states)</span>
<span id="cb335-64"><a href="#cb335-64" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states)</span>
<span id="cb335-65"><a href="#cb335-65" aria-hidden="true" tabindex="-1"></a>    print_matrix(transition_matrix, states, states)</span>
<span id="cb335-66"><a href="#cb335-66" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb335-67"><a href="#cb335-67" aria-hidden="true" tabindex="-1"></a>    print_matrix(emission_matrix, states, alphabet)</span>
<span id="cb335-68"><a href="#cb335-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-69"><a href="#cb335-69" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb335-70"><a href="#cb335-70" aria-hidden="true" tabindex="-1"></a><span class="st">yzzzyxzxxx</span></span>
<span id="cb335-71"><a href="#cb335-71" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb335-72"><a href="#cb335-72" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb335-73"><a href="#cb335-73" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb335-74"><a href="#cb335-74" aria-hidden="true" tabindex="-1"></a><span class="st">BBABABABAB</span></span>
<span id="cb335-75"><a href="#cb335-75" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb335-76"><a href="#cb335-76" aria-hidden="true" tabindex="-1"></a><span class="st">A   B   C</span></span>
<span id="cb335-77"><a href="#cb335-77" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb335-78"><a href="#cb335-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb335-79"><a href="#cb335-79" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-viterbi-learning" class="level1" data-number="112">
<h1 data-number="112"><span class="header-section-number">112</span> Implement Viterbi Learning</h1>
<p>Given:&nbsp;A sequence of emitted symbols&nbsp;<span class="math inline">\(x=x_1... x_n\)</span>&nbsp;in an alphabet&nbsp;<em>A</em>, generated by a&nbsp;<em>k</em>-state HMM with unknown transition and emission probabilities, initial&nbsp;<em>Transition</em>&nbsp;and&nbsp;<em>Emission</em>&nbsp;matrices and a number of iterations&nbsp;<em>i</em>.</p>
<p>Return:&nbsp;A matrix of transition probabilities&nbsp;<em>Transition</em>&nbsp;and a matrix of emission probabilities&nbsp;<em>Emission</em>&nbsp;that maximizes <span class="math inline">\(Pr(x,π)\)</span> over all possible transition and emission matrices and over all hidden paths&nbsp;<em>π</em>.</p>
<section id="sample-dataset-112" class="level2" data-number="112.1">
<h2 data-number="112.1" class="anchored" data-anchor-id="sample-dataset-112"><span class="header-section-number">112.1</span> Sample Dataset</h2>
<pre><code>100
--------
xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz
--------
x   y   z
--------
A   B
--------
    A   B
A   0.582   0.418
B   0.272   0.728
--------
    x   y   z
A   0.129   0.35    0.52
B   0.422   0.151   0.426</code></pre>
</section>
<section id="sample-output-112" class="level2" data-number="112.2">
<h2 data-number="112.2" class="anchored" data-anchor-id="sample-output-112"><span class="header-section-number">112.2</span> Sample Output</h2>
<pre><code>A   B
A   0.875   0.125
B   0.011   0.989
--------
    x   y   z
A   0.0 0.75    0.25
B   0.402   0.174   0.424</code></pre>
</section>
<section id="solution-112" class="level2" data-number="112.3">
<h2 data-number="112.3" class="anchored" data-anchor-id="solution-112"><span class="header-section-number">112.3</span> Solution</h2>
<div class="sourceCode" id="cb338"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb338-1"><a href="#cb338-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb338-2"><a href="#cb338-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple</span>
<span id="cb338-3"><a href="#cb338-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb338-4"><a href="#cb338-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> log</span>
<span id="cb338-5"><a href="#cb338-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-6"><a href="#cb338-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> viterbi(sequence: <span class="bu">str</span>, states: List[<span class="bu">str</span>], transition_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emission_matrix: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb338-7"><a href="#cb338-7" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)))</span>
<span id="cb338-8"><a href="#cb338-8" aria-hidden="true" tabindex="-1"></a>    ptr <span class="op">=</span> np.zeros((<span class="bu">len</span>(sequence), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">int</span>)</span>
<span id="cb338-9"><a href="#cb338-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-10"><a href="#cb338-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb338-11"><a href="#cb338-11" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> log(emission_matrix[state, sequence[<span class="dv">0</span>]] <span class="op">/</span> <span class="bu">len</span>(states))</span>
<span id="cb338-12"><a href="#cb338-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-13"><a href="#cb338-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(sequence[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb338-14"><a href="#cb338-14" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb338-15"><a href="#cb338-15" aria-hidden="true" tabindex="-1"></a>            opt <span class="op">=</span> [</span>
<span id="cb338-16"><a href="#cb338-16" aria-hidden="true" tabindex="-1"></a>                log(transition_matrix[prev, state]) <span class="op">+</span> log(emission_matrix[state, emission]) <span class="op">+</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb338-17"><a href="#cb338-17" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb338-18"><a href="#cb338-18" aria-hidden="true" tabindex="-1"></a>            ]</span>
<span id="cb338-19"><a href="#cb338-19" aria-hidden="true" tabindex="-1"></a>            p <span class="op">=</span> opt.index(<span class="bu">max</span>(opt))</span>
<span id="cb338-20"><a href="#cb338-20" aria-hidden="true" tabindex="-1"></a>            ptr[i, j] <span class="op">=</span> p</span>
<span id="cb338-21"><a href="#cb338-21" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">max</span>(opt)</span>
<span id="cb338-22"><a href="#cb338-22" aria-hidden="true" tabindex="-1"></a>    ind <span class="op">=</span> np.argmax(mat[i, :])</span>
<span id="cb338-23"><a href="#cb338-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-24"><a href="#cb338-24" aria-hidden="true" tabindex="-1"></a>    state_sequence <span class="op">=</span> states[ind]</span>
<span id="cb338-25"><a href="#cb338-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> i <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb338-26"><a href="#cb338-26" aria-hidden="true" tabindex="-1"></a>        state_sequence <span class="op">=</span> states[ptr[i, ind]] <span class="op">+</span> state_sequence</span>
<span id="cb338-27"><a href="#cb338-27" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> ptr[i, ind]</span>
<span id="cb338-28"><a href="#cb338-28" aria-hidden="true" tabindex="-1"></a>        i <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb338-29"><a href="#cb338-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> state_sequence</span>
<span id="cb338-30"><a href="#cb338-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-31"><a href="#cb338-31" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb338-32"><a href="#cb338-32" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>column_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb338-33"><a href="#cb338-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb338-34"><a href="#cb338-34" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb338-35"><a href="#cb338-35" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb338-36"><a href="#cb338-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-37"><a href="#cb338-37" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> normalize_matrix(matrix: np.ndarray, include_zeros: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>, min_val: <span class="bu">float</span> <span class="op">=</span> <span class="fl">1e-16</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb338-38"><a href="#cb338-38" aria-hidden="true" tabindex="-1"></a>    normalized <span class="op">=</span> matrix <span class="op">/</span> matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb338-39"><a href="#cb338-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> include_zeros:</span>
<span id="cb338-40"><a href="#cb338-40" aria-hidden="true" tabindex="-1"></a>        normalized[normalized <span class="op">==</span> <span class="dv">0</span>] <span class="op">=</span> min_val</span>
<span id="cb338-41"><a href="#cb338-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> normalized</span>
<span id="cb338-42"><a href="#cb338-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-43"><a href="#cb338-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_transition_matrix(path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb338-44"><a href="#cb338-44" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb338-45"><a href="#cb338-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, path[<span class="dv">1</span>:]):</span>
<span id="cb338-46"><a href="#cb338-46" aria-hidden="true" tabindex="-1"></a>        tmat[states.index(a)][states.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb338-47"><a href="#cb338-47" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> normalize_matrix(tmat)</span>
<span id="cb338-48"><a href="#cb338-48" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb338-49"><a href="#cb338-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], states[j]): tmat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states))}</span>
<span id="cb338-50"><a href="#cb338-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tmat</span>
<span id="cb338-51"><a href="#cb338-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-52"><a href="#cb338-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emission_matrix(sequence: <span class="bu">str</span>, alphabet: List[<span class="bu">str</span>], path: <span class="bu">str</span>, states: List[<span class="bu">str</span>], to_dict: <span class="bu">bool</span> <span class="op">=</span> <span class="va">False</span>) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb338-53"><a href="#cb338-53" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> np.zeros((<span class="bu">len</span>(states), <span class="bu">len</span>(alphabet)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb338-54"><a href="#cb338-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> a, b <span class="kw">in</span> <span class="bu">zip</span>(path, sequence):</span>
<span id="cb338-55"><a href="#cb338-55" aria-hidden="true" tabindex="-1"></a>        emat[states.index(a)][alphabet.index(b)] <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb338-56"><a href="#cb338-56" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> normalize_matrix(emat)</span>
<span id="cb338-57"><a href="#cb338-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> to_dict:</span>
<span id="cb338-58"><a href="#cb338-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> {(states[i], alphabet[j]): emat[i, j] <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states)) <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(alphabet))}</span>
<span id="cb338-59"><a href="#cb338-59" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> emat</span>
<span id="cb338-60"><a href="#cb338-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-61"><a href="#cb338-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], column_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb338-62"><a href="#cb338-62" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(column_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb338-63"><a href="#cb338-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb338-64"><a href="#cb338-64" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(column_labels):</span>
<span id="cb338-65"><a href="#cb338-65" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb338-66"><a href="#cb338-66" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, column_labels)</span>
<span id="cb338-67"><a href="#cb338-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-68"><a href="#cb338-68" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: StringIO) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb338-69"><a href="#cb338-69" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb338-70"><a href="#cb338-70" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-71"><a href="#cb338-71" aria-hidden="true" tabindex="-1"></a>    sequence <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb338-72"><a href="#cb338-72" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-73"><a href="#cb338-73" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb338-74"><a href="#cb338-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-75"><a href="#cb338-75" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb338-76"><a href="#cb338-76" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-77"><a href="#cb338-77" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb338-78"><a href="#cb338-78" aria-hidden="true" tabindex="-1"></a>    transition_matrix <span class="op">=</span> {</span>
<span id="cb338-79"><a href="#cb338-79" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb338-80"><a href="#cb338-80" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb338-81"><a href="#cb338-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb338-82"><a href="#cb338-82" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb338-83"><a href="#cb338-83" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb338-84"><a href="#cb338-84" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb338-85"><a href="#cb338-85" aria-hidden="true" tabindex="-1"></a>    emission_matrix <span class="op">=</span> {</span>
<span id="cb338-86"><a href="#cb338-86" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb338-87"><a href="#cb338-87" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb338-88"><a href="#cb338-88" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb338-89"><a href="#cb338-89" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb338-90"><a href="#cb338-90" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, sequence, states, alphabet, transition_matrix, emission_matrix</span>
<span id="cb338-91"><a href="#cb338-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-92"><a href="#cb338-92" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb338-93"><a href="#cb338-93" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb338-94"><a href="#cb338-94" aria-hidden="true" tabindex="-1"></a>    niter, sequence, states, alphabet, transition_matrix, emission_matrix <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb338-95"><a href="#cb338-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb338-96"><a href="#cb338-96" aria-hidden="true" tabindex="-1"></a>        path <span class="op">=</span> viterbi(sequence, states, transition_matrix, emission_matrix)</span>
<span id="cb338-97"><a href="#cb338-97" aria-hidden="true" tabindex="-1"></a>        transition_matrix <span class="op">=</span> estimate_transition_matrix(path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb338-98"><a href="#cb338-98" aria-hidden="true" tabindex="-1"></a>        emission_matrix <span class="op">=</span> estimate_emission_matrix(sequence, alphabet, path, states, to_dict<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb338-99"><a href="#cb338-99" aria-hidden="true" tabindex="-1"></a>    print_dict(transition_matrix, states, states)</span>
<span id="cb338-100"><a href="#cb338-100" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb338-101"><a href="#cb338-101" aria-hidden="true" tabindex="-1"></a>    print_dict(emission_matrix, states, alphabet)</span>
<span id="cb338-102"><a href="#cb338-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-103"><a href="#cb338-103" aria-hidden="true" tabindex="-1"></a>sample_input <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb338-104"><a href="#cb338-104" aria-hidden="true" tabindex="-1"></a><span class="st">100</span></span>
<span id="cb338-105"><a href="#cb338-105" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-106"><a href="#cb338-106" aria-hidden="true" tabindex="-1"></a><span class="st">xxxzyzzxxzxyzxzxyxxzyzyzyyyyzzxxxzzxzyzzzxyxzzzxyzzxxxxzzzxyyxzzzzzyzzzxxzzxxxyxyzzyxzxxxyxzyxxyzyxz</span></span>
<span id="cb338-107"><a href="#cb338-107" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-108"><a href="#cb338-108" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb338-109"><a href="#cb338-109" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-110"><a href="#cb338-110" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb338-111"><a href="#cb338-111" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-112"><a href="#cb338-112" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb338-113"><a href="#cb338-113" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.582   0.418</span></span>
<span id="cb338-114"><a href="#cb338-114" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.272   0.728</span></span>
<span id="cb338-115"><a href="#cb338-115" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb338-116"><a href="#cb338-116" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb338-117"><a href="#cb338-117" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.129   0.35    0.52</span></span>
<span id="cb338-118"><a href="#cb338-118" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.422   0.151   0.426</span></span>
<span id="cb338-119"><a href="#cb338-119" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb338-120"><a href="#cb338-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb338-121"><a href="#cb338-121" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="solve-the-soft-decoding-problem" class="level1" data-number="113">
<h1 data-number="113"><span class="header-section-number">113</span> Solve the Soft Decoding Problem</h1>
<p>Given:&nbsp;A string&nbsp;<em>x</em>, followed by the alphabet&nbsp;<em>Σ</em>&nbsp;from which&nbsp;<em>x</em>&nbsp;was constructed, followed by the states&nbsp;<em>States</em>, transition matrix&nbsp;<em>Transition</em>, and emission matrix&nbsp;<em>Emission</em>&nbsp;of an HMM (<em>Σ</em>,&nbsp;<em>States</em>,&nbsp;<em>Transition</em>,&nbsp;<em>Emission</em>).</p>
<p>Return:&nbsp;The probability <span class="math inline">\(Pr(π_i=k|x)\)</span> that the HMM was in state k at step i (for each state k and each step i).</p>
<section id="sample-dataset-113" class="level2" data-number="113.1">
<h2 data-number="113.1" class="anchored" data-anchor-id="sample-dataset-113"><span class="header-section-number">113.1</span> Sample Dataset</h2>
<pre><code>zyxxxxyxzz
--------
x   y   z
--------
A   B
--------
    A   B
A   0.911   0.089
B   0.228   0.772
--------
    x   y   z
A   0.356   0.191   0.453
B   0.04    0.467   0.493</code></pre>
</section>
<section id="sample-output-113" class="level2" data-number="113.2">
<h2 data-number="113.2" class="anchored" data-anchor-id="sample-output-113"><span class="header-section-number">113.2</span> Sample Output</h2>
<pre><code>A   B
0.5438  0.4562
0.6492  0.3508
0.9647  0.0353
0.9936  0.0064
0.9957  0.0043
0.9891  0.0109
0.9154  0.0846
0.964   0.036
0.8737  0.1263
0.8167  0.1833</code></pre>
</section>
<section id="solution-113" class="level2" data-number="113.3">
<h2 data-number="113.3" class="anchored" data-anchor-id="solution-113"><span class="header-section-number">113.3</span> Solution</h2>
<div class="sourceCode" id="cb341"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb341-1"><a href="#cb341-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb341-2"><a href="#cb341-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb341-3"><a href="#cb341-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb341-4"><a href="#cb341-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-5"><a href="#cb341-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb341-6"><a href="#cb341-6" aria-hidden="true" tabindex="-1"></a>    seq: <span class="bu">str</span> <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb341-7"><a href="#cb341-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb341-8"><a href="#cb341-8" aria-hidden="true" tabindex="-1"></a>    alphabet: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb341-9"><a href="#cb341-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb341-10"><a href="#cb341-10" aria-hidden="true" tabindex="-1"></a>    states: List[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb341-11"><a href="#cb341-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb341-12"><a href="#cb341-12" aria-hidden="true" tabindex="-1"></a>    lines: List[<span class="bu">str</span>] <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb341-13"><a href="#cb341-13" aria-hidden="true" tabindex="-1"></a>    tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb341-14"><a href="#cb341-14" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb341-15"><a href="#cb341-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb341-16"><a href="#cb341-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb341-17"><a href="#cb341-17" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb341-18"><a href="#cb341-18" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb341-19"><a href="#cb341-19" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb341-20"><a href="#cb341-20" aria-hidden="true" tabindex="-1"></a>    emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>] <span class="op">=</span> {</span>
<span id="cb341-21"><a href="#cb341-21" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb341-22"><a href="#cb341-22" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb341-23"><a href="#cb341-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb341-24"><a href="#cb341-24" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb341-25"><a href="#cb341-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> seq, states, tmat, emat</span>
<span id="cb341-26"><a href="#cb341-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-27"><a href="#cb341-27" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb341-28"><a href="#cb341-28" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb341-29"><a href="#cb341-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-30"><a href="#cb341-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb341-31"><a href="#cb341-31" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb341-32"><a href="#cb341-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb341-33"><a href="#cb341-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb341-34"><a href="#cb341-34" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb341-35"><a href="#cb341-35" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb341-36"><a href="#cb341-36" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb341-37"><a href="#cb341-37" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb341-38"><a href="#cb341-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-39"><a href="#cb341-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb341-40"><a href="#cb341-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-41"><a href="#cb341-41" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb341-42"><a href="#cb341-42" aria-hidden="true" tabindex="-1"></a>    mat: np.ndarray <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb341-43"><a href="#cb341-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-44"><a href="#cb341-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb341-45"><a href="#cb341-45" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb341-46"><a href="#cb341-46" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb341-47"><a href="#cb341-47" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb341-48"><a href="#cb341-48" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb341-49"><a href="#cb341-49" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb341-50"><a href="#cb341-50" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb341-51"><a href="#cb341-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-52"><a href="#cb341-52" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb341-53"><a href="#cb341-53" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb341-54"><a href="#cb341-54" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb341-55"><a href="#cb341-55" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb341-56"><a href="#cb341-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb341-57"><a href="#cb341-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-58"><a href="#cb341-58" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb341-59"><a href="#cb341-59" aria-hidden="true" tabindex="-1"></a>    input_lines: Iterator[<span class="bu">str</span>] <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb341-60"><a href="#cb341-60" aria-hidden="true" tabindex="-1"></a>    seq, states, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb341-61"><a href="#cb341-61" aria-hidden="true" tabindex="-1"></a>    tot: np.ndarray <span class="op">=</span> soft_decode(seq, states, tmat, emat)</span>
<span id="cb341-62"><a href="#cb341-62" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>states, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb341-63"><a href="#cb341-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> r <span class="kw">in</span> np.<span class="bu">round</span>(tot, <span class="dv">4</span>):</span>
<span id="cb341-64"><a href="#cb341-64" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb341-65"><a href="#cb341-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-66"><a href="#cb341-66" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb341-67"><a href="#cb341-67" aria-hidden="true" tabindex="-1"></a><span class="st">zyxxxxyxzz</span></span>
<span id="cb341-68"><a href="#cb341-68" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb341-69"><a href="#cb341-69" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb341-70"><a href="#cb341-70" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb341-71"><a href="#cb341-71" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb341-72"><a href="#cb341-72" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb341-73"><a href="#cb341-73" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb341-74"><a href="#cb341-74" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.911   0.089</span></span>
<span id="cb341-75"><a href="#cb341-75" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.228   0.772</span></span>
<span id="cb341-76"><a href="#cb341-76" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb341-77"><a href="#cb341-77" aria-hidden="true" tabindex="-1"></a><span class="st">    x   y   z</span></span>
<span id="cb341-78"><a href="#cb341-78" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.356   0.191   0.453</span></span>
<span id="cb341-79"><a href="#cb341-79" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.04    0.467   0.493</span></span>
<span id="cb341-80"><a href="#cb341-80" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb341-81"><a href="#cb341-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb341-82"><a href="#cb341-82" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-baum-welch-learning" class="level1" data-number="114">
<h1 data-number="114"><span class="header-section-number">114</span> Implement Baum-Welch Learning</h1>
<p>Given:&nbsp;A sequence of emitted symbols <span class="math inline">\(x=x_1...x_n\)</span> in an alphabet A, generated by a k-state HMM with unknown transition and emission probabilities, initial Transition and Emission matrices and a number of iterations I.</p>
<p>Return:&nbsp;A matrix of transition probabilities Transition and a matrix of emission probabilities Emission that maximizes <span class="math inline">\(Pr(x,π)\)</span> over all possible transition and emission matrices and over all hidden paths π.</p>
<section id="sample-dataset-114" class="level2" data-number="114.1">
<h2 data-number="114.1" class="anchored" data-anchor-id="sample-dataset-114"><span class="header-section-number">114.1</span> Sample Dataset</h2>
<pre><code>10
--------
xzyyzyzyxy
--------
x   y   z
--------
A   B
--------
    A   B
A   0.019   0.981
B   0.668   0.332
--------
x   y   z
A   0.175   0.003   0.821
B   0.196   0.512   0.293</code></pre>
</section>
<section id="sample-output-114" class="level2" data-number="114.2">
<h2 data-number="114.2" class="anchored" data-anchor-id="sample-output-114"><span class="header-section-number">114.2</span> Sample Output</h2>
<pre><code>A   B
A   0.000   1.000
B   0.786   0.214
--------
    x   y   z
A   0.242   0.000   0.758
B   0.172   0.828   0.000</code></pre>
</section>
<section id="solution-114" class="level2" data-number="114.3">
<h2 data-number="114.3" class="anchored" data-anchor-id="solution-114"><span class="header-section-number">114.3</span> Solution</h2>
<div class="sourceCode" id="cb344"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb344-1"><a href="#cb344-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, Tuple, Iterator</span>
<span id="cb344-2"><a href="#cb344-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> io <span class="im">import</span> StringIO</span>
<span id="cb344-3"><a href="#cb344-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb344-4"><a href="#cb344-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb344-5"><a href="#cb344-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-6"><a href="#cb344-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_matrix(matrix: np.ndarray, row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb344-7"><a href="#cb344-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="op">*</span>col_labels, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb344-8"><a href="#cb344-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> <span class="bu">enumerate</span>(matrix):</span>
<span id="cb344-9"><a href="#cb344-9" aria-hidden="true" tabindex="-1"></a>        r <span class="op">=</span> [row_labels[i]] <span class="op">+</span> [<span class="bu">round</span>(x, <span class="dv">3</span>) <span class="cf">if</span> x <span class="op">&gt;</span> <span class="fl">0.0</span> <span class="cf">else</span> <span class="st">"0"</span> <span class="cf">for</span> x <span class="kw">in</span> row]</span>
<span id="cb344-10"><a href="#cb344-10" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="op">*</span>r, sep<span class="op">=</span><span class="st">"</span><span class="ch">\t</span><span class="st">"</span>)</span>
<span id="cb344-11"><a href="#cb344-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-12"><a href="#cb344-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_dict(d: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], row_labels: List[<span class="bu">str</span>], col_labels: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb344-13"><a href="#cb344-13" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.zeros((<span class="bu">len</span>(row_labels), <span class="bu">len</span>(col_labels)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb344-14"><a href="#cb344-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, r <span class="kw">in</span> <span class="bu">enumerate</span>(row_labels):</span>
<span id="cb344-15"><a href="#cb344-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, c <span class="kw">in</span> <span class="bu">enumerate</span>(col_labels):</span>
<span id="cb344-16"><a href="#cb344-16" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> d[r, c]</span>
<span id="cb344-17"><a href="#cb344-17" aria-hidden="true" tabindex="-1"></a>    print_matrix(mat, row_labels, col_labels)</span>
<span id="cb344-18"><a href="#cb344-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-19"><a href="#cb344-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> parse_input(handle: Iterator[<span class="bu">str</span>]) <span class="op">-&gt;</span> Tuple[<span class="bu">int</span>, <span class="bu">str</span>, List[<span class="bu">str</span>], List[<span class="bu">str</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]]:</span>
<span id="cb344-20"><a href="#cb344-20" aria-hidden="true" tabindex="-1"></a>    niter <span class="op">=</span> <span class="bu">int</span>(<span class="bu">next</span>(handle).rstrip())</span>
<span id="cb344-21"><a href="#cb344-21" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-22"><a href="#cb344-22" aria-hidden="true" tabindex="-1"></a>    seq <span class="op">=</span> <span class="bu">next</span>(handle).rstrip()</span>
<span id="cb344-23"><a href="#cb344-23" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-24"><a href="#cb344-24" aria-hidden="true" tabindex="-1"></a>    alphabet <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb344-25"><a href="#cb344-25" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-26"><a href="#cb344-26" aria-hidden="true" tabindex="-1"></a>    states <span class="op">=</span> <span class="bu">next</span>(handle).split()</span>
<span id="cb344-27"><a href="#cb344-27" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-28"><a href="#cb344-28" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb344-29"><a href="#cb344-29" aria-hidden="true" tabindex="-1"></a>    tmat <span class="op">=</span> {</span>
<span id="cb344-30"><a href="#cb344-30" aria-hidden="true" tabindex="-1"></a>        (states[i], states[j]): <span class="bu">float</span>(v)</span>
<span id="cb344-31"><a href="#cb344-31" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb344-32"><a href="#cb344-32" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb344-33"><a href="#cb344-33" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb344-34"><a href="#cb344-34" aria-hidden="true" tabindex="-1"></a>    <span class="bu">next</span>(handle)</span>
<span id="cb344-35"><a href="#cb344-35" aria-hidden="true" tabindex="-1"></a>    lines <span class="op">=</span> [<span class="bu">next</span>(handle) <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(states) <span class="op">+</span> <span class="dv">1</span>)]</span>
<span id="cb344-36"><a href="#cb344-36" aria-hidden="true" tabindex="-1"></a>    emat <span class="op">=</span> {</span>
<span id="cb344-37"><a href="#cb344-37" aria-hidden="true" tabindex="-1"></a>        (states[i], alphabet[j]): <span class="bu">float</span>(v)</span>
<span id="cb344-38"><a href="#cb344-38" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> i, x <span class="kw">in</span> <span class="bu">enumerate</span>(lines[<span class="dv">1</span>:])</span>
<span id="cb344-39"><a href="#cb344-39" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, v <span class="kw">in</span> <span class="bu">enumerate</span>(x.split()[<span class="dv">1</span>:])</span>
<span id="cb344-40"><a href="#cb344-40" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb344-41"><a href="#cb344-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> niter, seq, states, alphabet, tmat, emat</span>
<span id="cb344-42"><a href="#cb344-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-43"><a href="#cb344-43" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> forward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb344-44"><a href="#cb344-44" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb344-45"><a href="#cb344-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-46"><a href="#cb344-46" aria-hidden="true" tabindex="-1"></a>        mat[<span class="dv">0</span>, i] <span class="op">=</span> emat[state, seq[<span class="dv">0</span>]]</span>
<span id="cb344-47"><a href="#cb344-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[<span class="dv">1</span>:], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb344-48"><a href="#cb344-48" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-49"><a href="#cb344-49" aria-hidden="true" tabindex="-1"></a>            mat[i, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb344-50"><a href="#cb344-50" aria-hidden="true" tabindex="-1"></a>                tmat[prev, state] <span class="op">*</span> emat[state, emission] <span class="op">*</span> mat[i <span class="op">-</span> <span class="dv">1</span>, k]</span>
<span id="cb344-51"><a href="#cb344-51" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb344-52"><a href="#cb344-52" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb344-53"><a href="#cb344-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb344-54"><a href="#cb344-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-55"><a href="#cb344-55" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> backward(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb344-56"><a href="#cb344-56" aria-hidden="true" tabindex="-1"></a>    mat <span class="op">=</span> np.ones((<span class="bu">len</span>(seq), <span class="bu">len</span>(states)))</span>
<span id="cb344-57"><a href="#cb344-57" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(seq[::<span class="op">-</span><span class="dv">1</span>][:<span class="op">-</span><span class="dv">1</span>], start<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb344-58"><a href="#cb344-58" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, state <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-59"><a href="#cb344-59" aria-hidden="true" tabindex="-1"></a>            mat[<span class="bu">len</span>(seq) <span class="op">-</span> i <span class="op">-</span> <span class="dv">1</span>, j] <span class="op">=</span> <span class="bu">sum</span>(</span>
<span id="cb344-60"><a href="#cb344-60" aria-hidden="true" tabindex="-1"></a>                tmat[state, prev] <span class="op">*</span> emat[prev, emission] <span class="op">*</span> mat[<span class="bu">len</span>(seq) <span class="op">-</span> i, k]</span>
<span id="cb344-61"><a href="#cb344-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> k, prev <span class="kw">in</span> <span class="bu">enumerate</span>(states)</span>
<span id="cb344-62"><a href="#cb344-62" aria-hidden="true" tabindex="-1"></a>            )</span>
<span id="cb344-63"><a href="#cb344-63" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> mat</span>
<span id="cb344-64"><a href="#cb344-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-65"><a href="#cb344-65" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> soft_decode(seq: <span class="bu">str</span>, states: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], normalise: <span class="bu">bool</span> <span class="op">=</span> <span class="va">True</span>) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb344-66"><a href="#cb344-66" aria-hidden="true" tabindex="-1"></a>    tot <span class="op">=</span> forward(seq, states, tmat, emat) <span class="op">*</span> backward(seq, states, tmat, emat)</span>
<span id="cb344-67"><a href="#cb344-67" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> normalise:</span>
<span id="cb344-68"><a href="#cb344-68" aria-hidden="true" tabindex="-1"></a>        tot <span class="op">=</span> tot <span class="op">/</span> np.<span class="bu">sum</span>(tot, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb344-69"><a href="#cb344-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> tot</span>
<span id="cb344-70"><a href="#cb344-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-71"><a href="#cb344-71" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> as_dict(x: np.ndarray, r: List[<span class="bu">str</span>], c: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb344-72"><a href="#cb344-72" aria-hidden="true" tabindex="-1"></a>    g <span class="op">=</span> defaultdict(<span class="bu">float</span>)</span>
<span id="cb344-73"><a href="#cb344-73" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">0</span>]):</span>
<span id="cb344-74"><a href="#cb344-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(x.shape[<span class="dv">1</span>]):</span>
<span id="cb344-75"><a href="#cb344-75" aria-hidden="true" tabindex="-1"></a>            g[r[i], c[j]] <span class="op">=</span> x[i][j]</span>
<span id="cb344-76"><a href="#cb344-76" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> g</span>
<span id="cb344-77"><a href="#cb344-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-78"><a href="#cb344-78" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_pi2(seq: <span class="bu">str</span>, fwd: np.ndarray, bak: np.ndarray, tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], states: List[<span class="bu">str</span>]) <span class="op">-&gt;</span> np.ndarray:</span>
<span id="cb344-79"><a href="#cb344-79" aria-hidden="true" tabindex="-1"></a>    rep_mat <span class="op">=</span> np.zeros((fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>, <span class="bu">len</span>(states), <span class="bu">len</span>(states)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb344-80"><a href="#cb344-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, fwd.shape[<span class="dv">0</span>] <span class="op">-</span> <span class="dv">1</span>):</span>
<span id="cb344-81"><a href="#cb344-81" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j, s1 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-82"><a href="#cb344-82" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> k, s2 <span class="kw">in</span> <span class="bu">enumerate</span>(states):</span>
<span id="cb344-83"><a href="#cb344-83" aria-hidden="true" tabindex="-1"></a>                weight <span class="op">=</span> tmat[s1, s2] <span class="op">*</span> emat[s2, seq[i <span class="op">+</span> <span class="dv">1</span>]]</span>
<span id="cb344-84"><a href="#cb344-84" aria-hidden="true" tabindex="-1"></a>                rep_mat[i, j, k] <span class="op">=</span> (</span>
<span id="cb344-85"><a href="#cb344-85" aria-hidden="true" tabindex="-1"></a>                    fwd[i, j] <span class="op">*</span> bak[i <span class="op">+</span> <span class="dv">1</span>, k] <span class="op">*</span> weight <span class="op">/</span> <span class="bu">sum</span>(fwd[i, :] <span class="op">*</span> bak[i, :])</span>
<span id="cb344-86"><a href="#cb344-86" aria-hidden="true" tabindex="-1"></a>                )</span>
<span id="cb344-87"><a href="#cb344-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> rep_mat</span>
<span id="cb344-88"><a href="#cb344-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-89"><a href="#cb344-89" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_tmat(seq: <span class="bu">str</span>, st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb344-90"><a href="#cb344-90" aria-hidden="true" tabindex="-1"></a>    fwd <span class="op">=</span> forward(seq, st, tmat, emat)</span>
<span id="cb344-91"><a href="#cb344-91" aria-hidden="true" tabindex="-1"></a>    bak <span class="op">=</span> backward(seq, st, tmat, emat)</span>
<span id="cb344-92"><a href="#cb344-92" aria-hidden="true" tabindex="-1"></a>    pi2 <span class="op">=</span> estimate_pi2(seq, fwd, bak, tmat, emat, st)</span>
<span id="cb344-93"><a href="#cb344-93" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> np.<span class="bu">sum</span>(pi2, <span class="dv">0</span>)</span>
<span id="cb344-94"><a href="#cb344-94" aria-hidden="true" tabindex="-1"></a>    tmat_new <span class="op">=</span> tmat_new <span class="op">/</span> np.<span class="bu">sum</span>(tmat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb344-95"><a href="#cb344-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(tmat_new, st, st)</span>
<span id="cb344-96"><a href="#cb344-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-97"><a href="#cb344-97" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> estimate_emat(seq: <span class="bu">str</span>, al: List[<span class="bu">str</span>], st: List[<span class="bu">str</span>], tmat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>], emat: Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]) <span class="op">-&gt;</span> Dict[Tuple[<span class="bu">str</span>, <span class="bu">str</span>], <span class="bu">float</span>]:</span>
<span id="cb344-98"><a href="#cb344-98" aria-hidden="true" tabindex="-1"></a>    pi1 <span class="op">=</span> soft_decode(seq, st, tmat, emat)</span>
<span id="cb344-99"><a href="#cb344-99" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> np.zeros((<span class="bu">len</span>(st), <span class="bu">len</span>(al)), dtype<span class="op">=</span><span class="bu">float</span>)</span>
<span id="cb344-100"><a href="#cb344-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i, emission <span class="kw">in</span> <span class="bu">enumerate</span>(al):</span>
<span id="cb344-101"><a href="#cb344-101" aria-hidden="true" tabindex="-1"></a>        ind <span class="op">=</span> np.array(<span class="bu">list</span>(seq)) <span class="op">==</span> emission</span>
<span id="cb344-102"><a href="#cb344-102" aria-hidden="true" tabindex="-1"></a>        emat_new[:, i] <span class="op">=</span> np.<span class="bu">sum</span>(pi1[ind, :], <span class="dv">0</span>)</span>
<span id="cb344-103"><a href="#cb344-103" aria-hidden="true" tabindex="-1"></a>    emat_new <span class="op">=</span> emat_new <span class="op">/</span> np.<span class="bu">sum</span>(emat_new, axis<span class="op">=</span><span class="dv">1</span>, keepdims<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb344-104"><a href="#cb344-104" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> as_dict(emat_new, st, al)</span>
<span id="cb344-105"><a href="#cb344-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-106"><a href="#cb344-106" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> main(sample_input: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb344-107"><a href="#cb344-107" aria-hidden="true" tabindex="-1"></a>    input_lines <span class="op">=</span> StringIO(sample_input.strip())</span>
<span id="cb344-108"><a href="#cb344-108" aria-hidden="true" tabindex="-1"></a>    niter, seq, st, al, tmat, emat <span class="op">=</span> parse_input(input_lines)</span>
<span id="cb344-109"><a href="#cb344-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> _ <span class="kw">in</span> <span class="bu">range</span>(niter):</span>
<span id="cb344-110"><a href="#cb344-110" aria-hidden="true" tabindex="-1"></a>        tmat2 <span class="op">=</span> estimate_tmat(seq, st, tmat, emat)</span>
<span id="cb344-111"><a href="#cb344-111" aria-hidden="true" tabindex="-1"></a>        emat2 <span class="op">=</span> estimate_emat(seq, al, st, tmat, emat)</span>
<span id="cb344-112"><a href="#cb344-112" aria-hidden="true" tabindex="-1"></a>        emat, tmat <span class="op">=</span> emat2, tmat2</span>
<span id="cb344-113"><a href="#cb344-113" aria-hidden="true" tabindex="-1"></a>    print_dict(tmat, st, st)</span>
<span id="cb344-114"><a href="#cb344-114" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">"--------"</span>)</span>
<span id="cb344-115"><a href="#cb344-115" aria-hidden="true" tabindex="-1"></a>    print_dict(emat, st, al)</span>
<span id="cb344-116"><a href="#cb344-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-117"><a href="#cb344-117" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb344-118"><a href="#cb344-118" aria-hidden="true" tabindex="-1"></a><span class="st">10</span></span>
<span id="cb344-119"><a href="#cb344-119" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-120"><a href="#cb344-120" aria-hidden="true" tabindex="-1"></a><span class="st">xzyyzyzyxy</span></span>
<span id="cb344-121"><a href="#cb344-121" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-122"><a href="#cb344-122" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb344-123"><a href="#cb344-123" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-124"><a href="#cb344-124" aria-hidden="true" tabindex="-1"></a><span class="st">A   B</span></span>
<span id="cb344-125"><a href="#cb344-125" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-126"><a href="#cb344-126" aria-hidden="true" tabindex="-1"></a><span class="st">    A   B</span></span>
<span id="cb344-127"><a href="#cb344-127" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.019   0.981</span></span>
<span id="cb344-128"><a href="#cb344-128" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.668   0.332</span></span>
<span id="cb344-129"><a href="#cb344-129" aria-hidden="true" tabindex="-1"></a><span class="st">--------</span></span>
<span id="cb344-130"><a href="#cb344-130" aria-hidden="true" tabindex="-1"></a><span class="st">x   y   z</span></span>
<span id="cb344-131"><a href="#cb344-131" aria-hidden="true" tabindex="-1"></a><span class="st">A   0.175   0.003   0.821</span></span>
<span id="cb344-132"><a href="#cb344-132" aria-hidden="true" tabindex="-1"></a><span class="st">B   0.196   0.512   0.293</span></span>
<span id="cb344-133"><a href="#cb344-133" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb344-134"><a href="#cb344-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb344-135"><a href="#cb344-135" aria-hidden="true" tabindex="-1"></a>main(sample_input)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="construct-the-graph-of-a-spectrum" class="level1" data-number="115">
<h1 data-number="115"><span class="header-section-number">115</span> Construct the Graph of a Spectrum</h1>
<p>Spectrum Graph Construction. Construct the graph of a spectrum.</p>
<p>Given:&nbsp;A space-delimited list of integers&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;<em>Graph(Spectrum)</em>.</p>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
<section id="sample-dataset-115" class="level2" data-number="115.1">
<h2 data-number="115.1" class="anchored" data-anchor-id="sample-dataset-115"><span class="header-section-number">115.1</span> Sample Dataset</h2>
<pre><code>57 71 154 185 301 332 415 429 486</code></pre>
</section>
<section id="sample-output-115" class="level2" data-number="115.2">
<h2 data-number="115.2" class="anchored" data-anchor-id="sample-output-115"><span class="header-section-number">115.2</span> Sample Output</h2>
<pre><code>0-&gt;57:G
0-&gt;71:A
57-&gt;154:P
57-&gt;185:K
71-&gt;185:N
154-&gt;301:F
185-&gt;332:F
301-&gt;415:N
301-&gt;429:K
332-&gt;429:P
415-&gt;486:A
429-&gt;486:G</code></pre>
</section>
<section id="solution-115" class="level2" data-number="115.3">
<h2 data-number="115.3" class="anchored" data-anchor-id="solution-115"><span class="header-section-number">115.3</span> Solution</h2>
<div class="sourceCode" id="cb347"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> defaultdict</span>
<span id="cb347-2"><a href="#cb347-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> List, Dict, DefaultDict</span>
<span id="cb347-3"><a href="#cb347-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-4"><a href="#cb347-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Amino acid weights dictionary</span></span>
<span id="cb347-5"><a href="#cb347-5" aria-hidden="true" tabindex="-1"></a>amino_acid_weights: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb347-6"><a href="#cb347-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'V'</span>: <span class="dv">99</span>,</span>
<span id="cb347-7"><a href="#cb347-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>,</span>
<span id="cb347-8"><a href="#cb347-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb347-9"><a href="#cb347-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'W'</span>: <span class="dv">186</span></span>
<span id="cb347-10"><a href="#cb347-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb347-11"><a href="#cb347-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-12"><a href="#cb347-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectrum_graph(masses: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> DefaultDict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]]:</span>
<span id="cb347-13"><a href="#cb347-13" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Reverse mapping of weights to amino acids</span></span>
<span id="cb347-14"><a href="#cb347-14" aria-hidden="true" tabindex="-1"></a>    weight_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {weight: aa <span class="cf">for</span> aa, weight <span class="kw">in</span> amino_acid_weights.items()}</span>
<span id="cb347-15"><a href="#cb347-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-16"><a href="#cb347-16" aria-hidden="true" tabindex="-1"></a>    graph: DefaultDict[<span class="bu">int</span>, List[Dict[<span class="bu">str</span>, <span class="bu">int</span>]]] <span class="op">=</span> defaultdict(<span class="bu">list</span>)</span>
<span id="cb347-17"><a href="#cb347-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-18"><a href="#cb347-18" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create graph based on mass differences</span></span>
<span id="cb347-19"><a href="#cb347-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(masses)):</span>
<span id="cb347-20"><a href="#cb347-20" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(masses)):</span>
<span id="cb347-21"><a href="#cb347-21" aria-hidden="true" tabindex="-1"></a>            difference: <span class="bu">int</span> <span class="op">=</span> masses[j] <span class="op">-</span> masses[i]</span>
<span id="cb347-22"><a href="#cb347-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> difference <span class="kw">in</span> weight_to_amino_acid:</span>
<span id="cb347-23"><a href="#cb347-23" aria-hidden="true" tabindex="-1"></a>                graph[masses[i]].append({<span class="st">"n"</span>: masses[j], <span class="st">"l"</span>: weight_to_amino_acid[difference]})</span>
<span id="cb347-24"><a href="#cb347-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-25"><a href="#cb347-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> graph</span>
<span id="cb347-26"><a href="#cb347-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-27"><a href="#cb347-27" aria-hidden="true" tabindex="-1"></a><span class="co"># Sample input</span></span>
<span id="cb347-28"><a href="#cb347-28" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"57 71 154 185 301 332 415 429 486"</span></span>
<span id="cb347-29"><a href="#cb347-29" aria-hidden="true" tabindex="-1"></a>masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> <span class="bu">list</span>(<span class="bu">map</span>(<span class="bu">int</span>, sample_input.split()))</span>
<span id="cb347-30"><a href="#cb347-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb347-31"><a href="#cb347-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the spectrum graph</span></span>
<span id="cb347-32"><a href="#cb347-32" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> start_mass, edges <span class="kw">in</span> spectrum_graph(masses).items():</span>
<span id="cb347-33"><a href="#cb347-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb347-34"><a href="#cb347-34" aria-hidden="true" tabindex="-1"></a>        <span class="bu">print</span>(<span class="ss">f"</span><span class="sc">{</span>start_mass<span class="sc">}</span><span class="ss">-&gt;</span><span class="sc">{</span>edge[<span class="st">'n'</span>]<span class="sc">}</span><span class="ss">:</span><span class="sc">{</span>edge[<span class="st">'l'</span>]<span class="sc">}</span><span class="ss">"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-decodingidealspectrum" class="level1" data-number="116">
<h1 data-number="116"><span class="header-section-number">116</span> Implement DecodingIdealSpectrum</h1>
<p>Decoding an Ideal Spectrum Problem. Reconstruct a peptide from its ideal spectrum.</p>
<p>Given:&nbsp;A space-delimited list of integers,&nbsp;<em>Spectrum</em>.</p>
<p>Return:&nbsp;An amino acid string with an ideal spectrum that matches&nbsp;<em>Spectrum</em>.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-116" class="level2" data-number="116.1">
<h2 data-number="116.1" class="anchored" data-anchor-id="sample-dataset-116"><span class="header-section-number">116.1</span> Sample Dataset</h2>
<pre><code>57 71 154 185 301 332 415 429 486</code></pre>
</section>
<section id="sample-output-116" class="level2" data-number="116.2">
<h2 data-number="116.2" class="anchored" data-anchor-id="sample-output-116"><span class="header-section-number">116.2</span> Sample Output</h2>
<pre><code>GPFNA</code></pre>
</section>
<section id="solution-116" class="level2" data-number="116.3">
<h2 data-number="116.3" class="anchored" data-anchor-id="solution-116"><span class="header-section-number">116.3</span> Solution</h2>
<div class="sourceCode" id="cb350"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb350-1"><a href="#cb350-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb350-2"><a href="#cb350-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-3"><a href="#cb350-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb350-4"><a href="#cb350-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb350-5"><a href="#cb350-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb350-6"><a href="#cb350-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb350-7"><a href="#cb350-7" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> amino_acid_masses.items()}</span>
<span id="cb350-8"><a href="#cb350-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-9"><a href="#cb350-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-10"><a href="#cb350-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_spectrum_graph(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> List[List[<span class="bu">int</span>]]:</span>
<span id="cb350-11"><a href="#cb350-11" aria-hidden="true" tabindex="-1"></a>    adjacency_list: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb350-12"><a href="#cb350-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectrum)):</span>
<span id="cb350-13"><a href="#cb350-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectrum)):</span>
<span id="cb350-14"><a href="#cb350-14" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> spectrum[j] <span class="op">-</span> spectrum[i] <span class="kw">in</span> mass_to_amino_acid.keys():</span>
<span id="cb350-15"><a href="#cb350-15" aria-hidden="true" tabindex="-1"></a>                adjacency_list.append([spectrum[i], spectrum[j], mass_to_amino_acid[spectrum[j] <span class="op">-</span> spectrum[i]]])</span>
<span id="cb350-16"><a href="#cb350-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> adjacency_list</span>
<span id="cb350-17"><a href="#cb350-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-18"><a href="#cb350-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-19"><a href="#cb350-19" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_ideal_spectrum(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb350-20"><a href="#cb350-20" aria-hidden="true" tabindex="-1"></a>    prefix_mass: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb350-21"><a href="#cb350-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb350-22"><a href="#cb350-22" aria-hidden="true" tabindex="-1"></a>        temp <span class="op">=</span> prefix_mass[i] <span class="op">+</span> amino_acid_masses[peptide[i]]</span>
<span id="cb350-23"><a href="#cb350-23" aria-hidden="true" tabindex="-1"></a>        prefix_mass.append(temp)</span>
<span id="cb350-24"><a href="#cb350-24" aria-hidden="true" tabindex="-1"></a>    linear_spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb350-25"><a href="#cb350-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb350-26"><a href="#cb350-26" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(peptide) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb350-27"><a href="#cb350-27" aria-hidden="true" tabindex="-1"></a>            linear_spectrum.append(prefix_mass[j] <span class="op">-</span> prefix_mass[i])</span>
<span id="cb350-28"><a href="#cb350-28" aria-hidden="true" tabindex="-1"></a>    linear_spectrum.sort()</span>
<span id="cb350-29"><a href="#cb350-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> linear_spectrum</span>
<span id="cb350-30"><a href="#cb350-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-31"><a href="#cb350-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-32"><a href="#cb350-32" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> find_paths(adjacency_list: List[List[<span class="bu">int</span>]]) <span class="op">-&gt;</span> List[<span class="bu">str</span>]:</span>
<span id="cb350-33"><a href="#cb350-33" aria-hidden="true" tabindex="-1"></a>    node: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb350-34"><a href="#cb350-34" aria-hidden="true" tabindex="-1"></a>    peptide_list: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb350-35"><a href="#cb350-35" aria-hidden="true" tabindex="-1"></a>    tmp_edges: List[List[List[<span class="bu">int</span>]]] <span class="op">=</span> []</span>
<span id="cb350-36"><a href="#cb350-36" aria-hidden="true" tabindex="-1"></a>    peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span></span>
<span id="cb350-37"><a href="#cb350-37" aria-hidden="true" tabindex="-1"></a>    tmp_peps: List[<span class="bu">str</span>] <span class="op">=</span> []</span>
<span id="cb350-38"><a href="#cb350-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-39"><a href="#cb350-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> <span class="bu">any</span>([<span class="bu">len</span>(x) <span class="op">!=</span> <span class="dv">0</span> <span class="cf">for</span> x <span class="kw">in</span> tmp_edges]) <span class="kw">or</span> <span class="bu">len</span>(tmp_edges) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb350-40"><a href="#cb350-40" aria-hidden="true" tabindex="-1"></a>        next_edges: List[List[<span class="bu">int</span>]] <span class="op">=</span> [e <span class="cf">for</span> e <span class="kw">in</span> adjacency_list <span class="cf">if</span> e[<span class="dv">0</span>] <span class="op">==</span> node]</span>
<span id="cb350-41"><a href="#cb350-41" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(next_edges) <span class="op">&gt;</span> <span class="dv">1</span>:</span>
<span id="cb350-42"><a href="#cb350-42" aria-hidden="true" tabindex="-1"></a>            tmp <span class="op">=</span> next_edges[<span class="dv">1</span>:]</span>
<span id="cb350-43"><a href="#cb350-43" aria-hidden="true" tabindex="-1"></a>            tmp_edges.append(tmp)</span>
<span id="cb350-44"><a href="#cb350-44" aria-hidden="true" tabindex="-1"></a>            tmp_peps.append(peptide)</span>
<span id="cb350-45"><a href="#cb350-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-46"><a href="#cb350-46" aria-hidden="true" tabindex="-1"></a>        next_edge <span class="op">=</span> next_edges[<span class="dv">0</span>]</span>
<span id="cb350-47"><a href="#cb350-47" aria-hidden="true" tabindex="-1"></a>        peptide <span class="op">+=</span> next_edge[<span class="dv">2</span>]</span>
<span id="cb350-48"><a href="#cb350-48" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> next_edge[<span class="dv">1</span>]</span>
<span id="cb350-49"><a href="#cb350-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-50"><a href="#cb350-50" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>([e <span class="cf">for</span> e <span class="kw">in</span> adjacency_list <span class="cf">if</span> e[<span class="dv">0</span>] <span class="op">==</span> node]) <span class="op">==</span> <span class="dv">0</span>:</span>
<span id="cb350-51"><a href="#cb350-51" aria-hidden="true" tabindex="-1"></a>            tmp <span class="op">=</span> [x <span class="cf">for</span> x <span class="kw">in</span> tmp_edges <span class="cf">if</span> <span class="bu">len</span>(x) <span class="op">!=</span> <span class="dv">0</span>][<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb350-52"><a href="#cb350-52" aria-hidden="true" tabindex="-1"></a>            next_edge <span class="op">=</span> tmp.pop()</span>
<span id="cb350-53"><a href="#cb350-53" aria-hidden="true" tabindex="-1"></a>            node <span class="op">=</span> next_edge[<span class="dv">1</span>]</span>
<span id="cb350-54"><a href="#cb350-54" aria-hidden="true" tabindex="-1"></a>            peptide_list.append(peptide)</span>
<span id="cb350-55"><a href="#cb350-55" aria-hidden="true" tabindex="-1"></a>            tmp_pep <span class="op">=</span> tmp_peps.pop()</span>
<span id="cb350-56"><a href="#cb350-56" aria-hidden="true" tabindex="-1"></a>            peptide <span class="op">=</span> tmp_pep <span class="op">+</span> next_edge[<span class="dv">2</span>]</span>
<span id="cb350-57"><a href="#cb350-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-58"><a href="#cb350-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide_list</span>
<span id="cb350-59"><a href="#cb350-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-60"><a href="#cb350-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-61"><a href="#cb350-61" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> decode_ideal_spectrum(spectrum: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb350-62"><a href="#cb350-62" aria-hidden="true" tabindex="-1"></a>    adjacency_list <span class="op">=</span> create_spectrum_graph(spectrum)</span>
<span id="cb350-63"><a href="#cb350-63" aria-hidden="true" tabindex="-1"></a>    all_paths <span class="op">=</span> find_paths(adjacency_list)</span>
<span id="cb350-64"><a href="#cb350-64" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> peptide <span class="kw">in</span> all_paths:</span>
<span id="cb350-65"><a href="#cb350-65" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">set</span>(spectrum).issubset(calculate_ideal_spectrum(peptide)):</span>
<span id="cb350-66"><a href="#cb350-66" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> peptide</span>
<span id="cb350-67"><a href="#cb350-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-68"><a href="#cb350-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-69"><a href="#cb350-69" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb350-70"><a href="#cb350-70" aria-hidden="true" tabindex="-1"></a><span class="st">57 71 154 185 301 332 415 429 486</span></span>
<span id="cb350-71"><a href="#cb350-71" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb350-72"><a href="#cb350-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-73"><a href="#cb350-73" aria-hidden="true" tabindex="-1"></a>spectrum: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(s) <span class="cf">for</span> s <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb350-74"><a href="#cb350-74" aria-hidden="true" tabindex="-1"></a>spectrum <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> spectrum</span>
<span id="cb350-75"><a href="#cb350-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb350-76"><a href="#cb350-76" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(decode_ideal_spectrum(spectrum))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="convert-a-peptide-into-a-peptide-vector" class="level1" data-number="117">
<h1 data-number="117"><span class="header-section-number">117</span> Convert a Peptide into a Peptide Vector</h1>
<p>Given:&nbsp;A peptide&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;The peptide vector of&nbsp;<em>P</em>.</p>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
<section id="sample-dataset-117" class="level2" data-number="117.1">
<h2 data-number="117.1" class="anchored" data-anchor-id="sample-dataset-117"><span class="header-section-number">117.1</span> Sample Dataset</h2>
<pre><code>XZZXX</code></pre>
</section>
<section id="sample-output-117" class="level2" data-number="117.2">
<h2 data-number="117.2" class="anchored" data-anchor-id="sample-output-117"><span class="header-section-number">117.2</span> Sample Output</h2>
<pre><code>0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1</code></pre>
</section>
<section id="solution-117" class="level2" data-number="117.3">
<h2 data-number="117.3" class="anchored" data-anchor-id="solution-117"><span class="header-section-number">117.3</span> Solution</h2>
<div class="sourceCode" id="cb353"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb353-1"><a href="#cb353-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb353-2"><a href="#cb353-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-3"><a href="#cb353-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb353-4"><a href="#cb353-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>, <span class="st">'L'</span>: <span class="dv">113</span>,</span>
<span id="cb353-5"><a href="#cb353-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>, <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span></span>
<span id="cb353-6"><a href="#cb353-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb353-7"><a href="#cb353-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-8"><a href="#cb353-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-9"><a href="#cb353-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_peptide_vector(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb353-10"><a href="#cb353-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> []</span>
<span id="cb353-11"><a href="#cb353-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb353-12"><a href="#cb353-12" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> peptide[:i<span class="op">+</span><span class="dv">1</span>]</span>
<span id="cb353-13"><a href="#cb353-13" aria-hidden="true" tabindex="-1"></a>        mass <span class="op">=</span> <span class="bu">sum</span>(amino_acid_masses[aa] <span class="cf">for</span> aa <span class="kw">in</span> prefix)</span>
<span id="cb353-14"><a href="#cb353-14" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(mass)</span>
<span id="cb353-15"><a href="#cb353-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-16"><a href="#cb353-16" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb353-17"><a href="#cb353-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses:</span>
<span id="cb353-18"><a href="#cb353-18" aria-hidden="true" tabindex="-1"></a>        vector[mass <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb353-19"><a href="#cb353-19" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vector</span>
<span id="cb353-20"><a href="#cb353-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-21"><a href="#cb353-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb353-22"><a href="#cb353-22" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb353-23"><a href="#cb353-23" aria-hidden="true" tabindex="-1"></a><span class="st">XZZXX</span></span>
<span id="cb353-24"><a href="#cb353-24" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb353-25"><a href="#cb353-25" aria-hidden="true" tabindex="-1"></a>peptide: <span class="bu">str</span> <span class="op">=</span> sample_input.strip()</span>
<span id="cb353-26"><a href="#cb353-26" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">' '</span>.join(<span class="bu">str</span>(x) <span class="cf">for</span> x <span class="kw">in</span> create_peptide_vector(peptide)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="convert-a-peptide-vector-into-a-peptide" class="level1" data-number="118">
<h1 data-number="118"><span class="header-section-number">118</span> Convert a Peptide Vector into a Peptide</h1>
<p>Given:&nbsp;A space-delimited binary vector&nbsp;<em>P</em>.</p>
<p>Return:&nbsp;A peptide whose binary peptide vector matches&nbsp;<em>P</em>. For masses with more than one amino acid, any choice may be used.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-118" class="level2" data-number="118.1">
<h2 data-number="118.1" class="anchored" data-anchor-id="sample-dataset-118"><span class="header-section-number">118.1</span> Sample Dataset</h2>
<pre><code>0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1</code></pre>
</section>
<section id="sample-output-118" class="level2" data-number="118.2">
<h2 data-number="118.2" class="anchored" data-anchor-id="sample-output-118"><span class="header-section-number">118.2</span> Sample Output</h2>
<pre><code>XZZXX</code></pre>
</section>
<section id="solution-118" class="level2" data-number="118.3">
<h2 data-number="118.3" class="anchored" data-anchor-id="solution-118"><span class="header-section-number">118.3</span> Solution</h2>
<div class="sourceCode" id="cb356"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb356-1"><a href="#cb356-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb356-2"><a href="#cb356-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-3"><a href="#cb356-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb356-4"><a href="#cb356-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb356-5"><a href="#cb356-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb356-6"><a href="#cb356-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb356-7"><a href="#cb356-7" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> amino_acid_masses.items()}</span>
<span id="cb356-8"><a href="#cb356-8" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid[<span class="dv">4</span>] <span class="op">=</span> <span class="st">'X'</span></span>
<span id="cb356-9"><a href="#cb356-9" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid[<span class="dv">5</span>] <span class="op">=</span> <span class="st">'Z'</span></span>
<span id="cb356-10"><a href="#cb356-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-11"><a href="#cb356-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-12"><a href="#cb356-12" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> convert_peptide_vector_to_sequence(vector: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb356-13"><a href="#cb356-13" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [i <span class="op">+</span> <span class="dv">1</span> <span class="cf">for</span> i, v <span class="kw">in</span> <span class="bu">enumerate</span>(vector) <span class="cf">if</span> v <span class="op">==</span> <span class="dv">1</span>]</span>
<span id="cb356-14"><a href="#cb356-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-15"><a href="#cb356-15" aria-hidden="true" tabindex="-1"></a>    peptide: <span class="bu">str</span> <span class="op">=</span> mass_to_amino_acid[prefix_masses[<span class="dv">0</span>]]</span>
<span id="cb356-16"><a href="#cb356-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(prefix_masses)):</span>
<span id="cb356-17"><a href="#cb356-17" aria-hidden="true" tabindex="-1"></a>        mass <span class="op">=</span> prefix_masses[i] <span class="op">-</span> prefix_masses[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb356-18"><a href="#cb356-18" aria-hidden="true" tabindex="-1"></a>        peptide <span class="op">+=</span> mass_to_amino_acid[mass]</span>
<span id="cb356-19"><a href="#cb356-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-20"><a href="#cb356-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide</span>
<span id="cb356-21"><a href="#cb356-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-22"><a href="#cb356-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-23"><a href="#cb356-23" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb356-24"><a href="#cb356-24" aria-hidden="true" tabindex="-1"></a><span class="st">0 0 0 1 0 0 0 0 1 0 0 0 0 1 0 0 0 1 0 0 0 1</span></span>
<span id="cb356-25"><a href="#cb356-25" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb356-26"><a href="#cb356-26" aria-hidden="true" tabindex="-1"></a>vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.strip().split()]</span>
<span id="cb356-27"><a href="#cb356-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb356-28"><a href="#cb356-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(convert_peptide_vector_to_sequence(vector))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="sequence-a-peptide" class="level1" data-number="119">
<h1 data-number="119"><span class="header-section-number">119</span> Sequence a Peptide</h1>
<p>Peptide Sequencing Problem. Given a spectral vector S, find a peptide vector with maximum score against S.</p>
<p>Given:&nbsp;A space-delimited spectral vector&nbsp;<em>S</em>.</p>
<p>Return:&nbsp;A peptide with maximum score against&nbsp;<em>S</em>. For masses with more than one amino acid, any choice may be used.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-119" class="level2" data-number="119.1">
<h2 data-number="119.1" class="anchored" data-anchor-id="sample-dataset-119"><span class="header-section-number">119.1</span> Sample Dataset</h2>
<pre><code>0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 0</code></pre>
</section>
<section id="sample-output-119" class="level2" data-number="119.2">
<h2 data-number="119.2" class="anchored" data-anchor-id="sample-output-119"><span class="header-section-number">119.2</span> Sample Output</h2>
<pre><code>XZZXX</code></pre>
</section>
<section id="solution-119" class="level2" data-number="119.3">
<h2 data-number="119.3" class="anchored" data-anchor-id="solution-119"><span class="header-section-number">119.3</span> Solution</h2>
<div class="sourceCode" id="cb359"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb359-1"><a href="#cb359-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Tuple</span>
<span id="cb359-2"><a href="#cb359-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-3"><a href="#cb359-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb359-4"><a href="#cb359-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb359-5"><a href="#cb359-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb359-6"><a href="#cb359-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb359-7"><a href="#cb359-7" aria-hidden="true" tabindex="-1"></a>mass_to_amino_acid: Dict[<span class="bu">int</span>, <span class="bu">str</span>] <span class="op">=</span> {v: k <span class="cf">for</span> k, v <span class="kw">in</span> amino_acid_masses.items()}</span>
<span id="cb359-8"><a href="#cb359-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-9"><a href="#cb359-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-10"><a href="#cb359-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> sequence_peptide(spectral_vector: List[<span class="bu">int</span>]) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb359-11"><a href="#cb359-11" aria-hidden="true" tabindex="-1"></a>    spectral_vector <span class="op">=</span> [<span class="dv">0</span>] <span class="op">+</span> spectral_vector</span>
<span id="cb359-12"><a href="#cb359-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-13"><a href="#cb359-13" aria-hidden="true" tabindex="-1"></a>    adjacency_list: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb359-14"><a href="#cb359-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb359-15"><a href="#cb359-15" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectral_vector)):</span>
<span id="cb359-16"><a href="#cb359-16" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (j <span class="op">-</span> i) <span class="kw">in</span> mass_to_amino_acid.keys():</span>
<span id="cb359-17"><a href="#cb359-17" aria-hidden="true" tabindex="-1"></a>                adjacency_list.append([i, j])</span>
<span id="cb359-18"><a href="#cb359-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-19"><a href="#cb359-19" aria-hidden="true" tabindex="-1"></a>    adjacency_dict: Dict[<span class="bu">int</span>, List[List[Union[<span class="bu">int</span>, <span class="bu">str</span>]]]] <span class="op">=</span> {}</span>
<span id="cb359-20"><a href="#cb359-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb359-21"><a href="#cb359-21" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i, <span class="bu">len</span>(spectral_vector)):</span>
<span id="cb359-22"><a href="#cb359-22" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (j <span class="op">-</span> i) <span class="kw">in</span> mass_to_amino_acid.keys():</span>
<span id="cb359-23"><a href="#cb359-23" aria-hidden="true" tabindex="-1"></a>                edge <span class="op">=</span> [i, mass_to_amino_acid[j <span class="op">-</span> i]]</span>
<span id="cb359-24"><a href="#cb359-24" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> j <span class="kw">not</span> <span class="kw">in</span> adjacency_dict:</span>
<span id="cb359-25"><a href="#cb359-25" aria-hidden="true" tabindex="-1"></a>                    adjacency_dict[j] <span class="op">=</span> [edge]</span>
<span id="cb359-26"><a href="#cb359-26" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span>:</span>
<span id="cb359-27"><a href="#cb359-27" aria-hidden="true" tabindex="-1"></a>                    adjacency_dict[j].append(edge)</span>
<span id="cb359-28"><a href="#cb359-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-29"><a href="#cb359-29" aria-hidden="true" tabindex="-1"></a>    scores: Dict[<span class="bu">int</span>, List[Union[<span class="bu">float</span>, <span class="bu">str</span>]]] <span class="op">=</span> {<span class="dv">0</span>: [<span class="dv">0</span>, <span class="st">'-'</span>]}</span>
<span id="cb359-30"><a href="#cb359-30" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> adjacency_dict.keys():</span>
<span id="cb359-31"><a href="#cb359-31" aria-hidden="true" tabindex="-1"></a>        scores[node] <span class="op">=</span> [<span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'-'</span>]</span>
<span id="cb359-32"><a href="#cb359-32" aria-hidden="true" tabindex="-1"></a>        edges <span class="op">=</span> adjacency_dict[node]</span>
<span id="cb359-33"><a href="#cb359-33" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> edge <span class="kw">in</span> edges:</span>
<span id="cb359-34"><a href="#cb359-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> edge[<span class="dv">0</span>] <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb359-35"><a href="#cb359-35" aria-hidden="true" tabindex="-1"></a>                scores[edge[<span class="dv">0</span>]] <span class="op">=</span> [<span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>), <span class="st">'-'</span>]</span>
<span id="cb359-36"><a href="#cb359-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-37"><a href="#cb359-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> node <span class="kw">in</span> adjacency_dict.keys():</span>
<span id="cb359-38"><a href="#cb359-38" aria-hidden="true" tabindex="-1"></a>        max_score: <span class="bu">float</span> <span class="op">=</span> <span class="op">-</span><span class="bu">float</span>(<span class="st">'inf'</span>)</span>
<span id="cb359-39"><a href="#cb359-39" aria-hidden="true" tabindex="-1"></a>        best_edge: Union[<span class="bu">str</span>, List[Union[<span class="bu">int</span>, <span class="bu">str</span>]]] <span class="op">=</span> <span class="st">'-'</span></span>
<span id="cb359-40"><a href="#cb359-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> parent <span class="kw">in</span> adjacency_dict[node]:</span>
<span id="cb359-41"><a href="#cb359-41" aria-hidden="true" tabindex="-1"></a>            score <span class="op">=</span> scores[parent[<span class="dv">0</span>]][<span class="dv">0</span>]</span>
<span id="cb359-42"><a href="#cb359-42" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> score <span class="op">&gt;</span> max_score:</span>
<span id="cb359-43"><a href="#cb359-43" aria-hidden="true" tabindex="-1"></a>                max_score <span class="op">=</span> score</span>
<span id="cb359-44"><a href="#cb359-44" aria-hidden="true" tabindex="-1"></a>                best_edge <span class="op">=</span> parent</span>
<span id="cb359-45"><a href="#cb359-45" aria-hidden="true" tabindex="-1"></a>        scores[node] <span class="op">=</span> [max_score <span class="op">+</span> spectral_vector[node], best_edge]</span>
<span id="cb359-46"><a href="#cb359-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-47"><a href="#cb359-47" aria-hidden="true" tabindex="-1"></a>    node: <span class="bu">int</span> <span class="op">=</span> <span class="bu">list</span>(scores.keys())[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb359-48"><a href="#cb359-48" aria-hidden="true" tabindex="-1"></a>    peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span></span>
<span id="cb359-49"><a href="#cb359-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">while</span> node <span class="op">!=</span> <span class="dv">0</span>:</span>
<span id="cb359-50"><a href="#cb359-50" aria-hidden="true" tabindex="-1"></a>        peptide <span class="op">=</span> scores[node][<span class="dv">1</span>][<span class="dv">1</span>] <span class="op">+</span> peptide</span>
<span id="cb359-51"><a href="#cb359-51" aria-hidden="true" tabindex="-1"></a>        node <span class="op">=</span> scores[node][<span class="dv">1</span>][<span class="dv">0</span>]</span>
<span id="cb359-52"><a href="#cb359-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-53"><a href="#cb359-53" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> peptide</span>
<span id="cb359-54"><a href="#cb359-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-55"><a href="#cb359-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-56"><a href="#cb359-56" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb359-57"><a href="#cb359-57" aria-hidden="true" tabindex="-1"></a><span class="st">0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 0</span></span>
<span id="cb359-58"><a href="#cb359-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb359-59"><a href="#cb359-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-60"><a href="#cb359-60" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> sample_input.split()]</span>
<span id="cb359-61"><a href="#cb359-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb359-62"><a href="#cb359-62" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sequence_peptide(spectral_vector))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-peptide-in-a-proteome-against-a-spectrum" class="level1" data-number="120">
<h1 data-number="120"><span class="header-section-number">120</span> Find a Highest-Scoring Peptide in a Proteome against a Spectrum</h1>
<p>Peptide Identification Problem. Find a peptide from a proteome with maximum score against a spectrum.</p>
<p>Given:&nbsp;A space-delimited spectral vector&nbsp;<em>S</em>&nbsp;and an amino acid string&nbsp;<em>Proteome</em>.</p>
<p>Return:&nbsp;A peptide in&nbsp;<em>Proteome</em>&nbsp;with maximum score against&nbsp;<em>S</em>.</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-120" class="level2" data-number="120.1">
<h2 data-number="120.1" class="anchored" data-anchor-id="sample-dataset-120"><span class="header-section-number">120.1</span> Sample Dataset</h2>
<pre><code>0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 8
XZZXZXXXZXZZXZXXZ</code></pre>
</section>
<section id="sample-output-120" class="level2" data-number="120.2">
<h2 data-number="120.2" class="anchored" data-anchor-id="sample-output-120"><span class="header-section-number">120.2</span> Sample Output</h2>
<pre><code>ZXZXX</code></pre>
</section>
<section id="solution-120" class="level2" data-number="120.3">
<h2 data-number="120.3" class="anchored" data-anchor-id="solution-120"><span class="header-section-number">120.3</span> Solution</h2>
<div class="sourceCode" id="cb362"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb362-1"><a href="#cb362-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb362-2"><a href="#cb362-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-3"><a href="#cb362-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb362-4"><a href="#cb362-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb362-5"><a href="#cb362-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>,</span>
<span id="cb362-6"><a href="#cb362-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span>  <span class="co"># Added 'X' and 'Z' with arbitrary masses</span></span>
<span id="cb362-7"><a href="#cb362-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb362-8"><a href="#cb362-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-9"><a href="#cb362-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_peptide_vector(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb362-10"><a href="#cb362-10" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb362-11"><a href="#cb362-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb362-12"><a href="#cb362-12" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> amino_acid_masses[amino_acid])</span>
<span id="cb362-13"><a href="#cb362-13" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb362-14"><a href="#cb362-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses[<span class="dv">1</span>:]:</span>
<span id="cb362-15"><a href="#cb362-15" aria-hidden="true" tabindex="-1"></a>        vector[mass <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb362-16"><a href="#cb362-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vector</span>
<span id="cb362-17"><a href="#cb362-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-18"><a href="#cb362-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> identify_peptide(spectral_vector: List[<span class="bu">int</span>], proteome: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb362-19"><a href="#cb362-19" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">float</span>(<span class="st">'-inf'</span>)</span>
<span id="cb362-20"><a href="#cb362-20" aria-hidden="true" tabindex="-1"></a>    best_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">""</span></span>
<span id="cb362-21"><a href="#cb362-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-22"><a href="#cb362-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(proteome)):</span>
<span id="cb362-23"><a href="#cb362-23" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(proteome) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb362-24"><a href="#cb362-24" aria-hidden="true" tabindex="-1"></a>            peptide: <span class="bu">str</span> <span class="op">=</span> proteome[i:j]</span>
<span id="cb362-25"><a href="#cb362-25" aria-hidden="true" tabindex="-1"></a>            peptide_vector: List[<span class="bu">int</span>] <span class="op">=</span> create_peptide_vector(peptide)</span>
<span id="cb362-26"><a href="#cb362-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-27"><a href="#cb362-27" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">&gt;</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb362-28"><a href="#cb362-28" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb362-29"><a href="#cb362-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-30"><a href="#cb362-30" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">==</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb362-31"><a href="#cb362-31" aria-hidden="true" tabindex="-1"></a>                score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">sum</span>(s <span class="op">*</span> v <span class="cf">for</span> s, v <span class="kw">in</span> <span class="bu">zip</span>(spectral_vector, peptide_vector))</span>
<span id="cb362-32"><a href="#cb362-32" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> score <span class="op">&gt;</span> max_score:</span>
<span id="cb362-33"><a href="#cb362-33" aria-hidden="true" tabindex="-1"></a>                    max_score <span class="op">=</span> score</span>
<span id="cb362-34"><a href="#cb362-34" aria-hidden="true" tabindex="-1"></a>                    best_peptide <span class="op">=</span> peptide</span>
<span id="cb362-35"><a href="#cb362-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-36"><a href="#cb362-36" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_peptide</span>
<span id="cb362-37"><a href="#cb362-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb362-38"><a href="#cb362-38" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb362-39"><a href="#cb362-39" aria-hidden="true" tabindex="-1"></a><span class="st">0 0 0 4 -2 -3 -1 -7 6 5 3 2 1 9 3 -8 0 3 1 2 1 8</span></span>
<span id="cb362-40"><a href="#cb362-40" aria-hidden="true" tabindex="-1"></a><span class="st">XZZXZXXXZXZZXZXXZ</span></span>
<span id="cb362-41"><a href="#cb362-41" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb362-42"><a href="#cb362-42" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb362-43"><a href="#cb362-43" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">0</span>].strip().split()]</span>
<span id="cb362-44"><a href="#cb362-44" aria-hidden="true" tabindex="-1"></a>proteome: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">1</span>].strip()</span>
<span id="cb362-45"><a href="#cb362-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(identify_peptide(spectral_vector, proteome))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="implement-psmsearch" class="level1" data-number="121">
<h1 data-number="121"><span class="header-section-number">121</span> Implement PSMSearch</h1>
<p>PSM Search Problem. Identify Peptide-Spectrum Matches by matching spectra against a proteome.</p>
<p>Given:&nbsp;A set of space-delimited spectral vectors&nbsp;<em>SpectralVectors</em>, an amino acid string&nbsp;<em>Proteome</em>, and a score threshold&nbsp;<em>T</em>.</p>
<p>Return:&nbsp;All unique Peptide-Spectrum Matches scoring at least as high as&nbsp;<em>T</em>.</p>
<p>Note: For this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X: 4, Z: 5.</p>
<section id="sample-dataset-121" class="level2" data-number="121.1">
<h2 data-number="121.1" class="anchored" data-anchor-id="sample-dataset-121"><span class="header-section-number">121.1</span> Sample Dataset</h2>
<pre><code>-1 5 -4 5 3 -1 -4 5 -1 0 0 4 -1 0 1 4 4 4
-4 2 -2 -4 4 -5 -1 4 -1 2 5 -3 -1 3 2 -3
XXXZXZXXZXZXXXZXXZX
5</code></pre>
</section>
<section id="sample-output-121" class="level2" data-number="121.2">
<h2 data-number="121.2" class="anchored" data-anchor-id="sample-output-121"><span class="header-section-number">121.2</span> Sample Output</h2>
<pre><code>XZXZ</code></pre>
</section>
<section id="solution-121" class="level2" data-number="121.3">
<h2 data-number="121.3" class="anchored" data-anchor-id="solution-121"><span class="header-section-number">121.3</span> Solution</h2>
<div class="sourceCode" id="cb365"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb365-1"><a href="#cb365-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List, Set, Tuple</span>
<span id="cb365-2"><a href="#cb365-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-3"><a href="#cb365-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb365-4"><a href="#cb365-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb365-5"><a href="#cb365-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>,</span>
<span id="cb365-6"><a href="#cb365-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span>  <span class="co"># Added 'X' and 'Z' with arbitrary masses</span></span>
<span id="cb365-7"><a href="#cb365-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb365-8"><a href="#cb365-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-9"><a href="#cb365-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> is_number(n: <span class="bu">str</span>) <span class="op">-&gt;</span> <span class="bu">bool</span>:</span>
<span id="cb365-10"><a href="#cb365-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">try</span>:</span>
<span id="cb365-11"><a href="#cb365-11" aria-hidden="true" tabindex="-1"></a>        <span class="bu">float</span>(n)</span>
<span id="cb365-12"><a href="#cb365-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">except</span> <span class="pp">ValueError</span>:</span>
<span id="cb365-13"><a href="#cb365-13" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="va">False</span></span>
<span id="cb365-14"><a href="#cb365-14" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">True</span></span>
<span id="cb365-15"><a href="#cb365-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-16"><a href="#cb365-16" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> create_peptide_vector(peptide: <span class="bu">str</span>) <span class="op">-&gt;</span> List[<span class="bu">int</span>]:</span>
<span id="cb365-17"><a href="#cb365-17" aria-hidden="true" tabindex="-1"></a>    prefix_masses: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb365-18"><a href="#cb365-18" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> amino_acid <span class="kw">in</span> peptide:</span>
<span id="cb365-19"><a href="#cb365-19" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(prefix_masses[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> amino_acid_masses[amino_acid])</span>
<span id="cb365-20"><a href="#cb365-20" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> prefix_masses[<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb365-21"><a href="#cb365-21" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses[<span class="dv">1</span>:]:</span>
<span id="cb365-22"><a href="#cb365-22" aria-hidden="true" tabindex="-1"></a>        vector[mass <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb365-23"><a href="#cb365-23" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> vector</span>
<span id="cb365-24"><a href="#cb365-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-25"><a href="#cb365-25" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> identify_peptide(spectral_vector: List[<span class="bu">int</span>], proteome: <span class="bu">str</span>) <span class="op">-&gt;</span> Tuple[<span class="bu">str</span>, <span class="bu">float</span>]:</span>
<span id="cb365-26"><a href="#cb365-26" aria-hidden="true" tabindex="-1"></a>    max_score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">float</span>(<span class="st">'-inf'</span>)</span>
<span id="cb365-27"><a href="#cb365-27" aria-hidden="true" tabindex="-1"></a>    best_peptide: <span class="bu">str</span> <span class="op">=</span> <span class="st">''</span></span>
<span id="cb365-28"><a href="#cb365-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-29"><a href="#cb365-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(proteome)):</span>
<span id="cb365-30"><a href="#cb365-30" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(i <span class="op">+</span> <span class="dv">1</span>, <span class="bu">len</span>(proteome) <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb365-31"><a href="#cb365-31" aria-hidden="true" tabindex="-1"></a>            peptide: <span class="bu">str</span> <span class="op">=</span> proteome[i:j]</span>
<span id="cb365-32"><a href="#cb365-32" aria-hidden="true" tabindex="-1"></a>            peptide_vector: List[<span class="bu">int</span>] <span class="op">=</span> create_peptide_vector(peptide)</span>
<span id="cb365-33"><a href="#cb365-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-34"><a href="#cb365-34" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">&gt;</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb365-35"><a href="#cb365-35" aria-hidden="true" tabindex="-1"></a>                <span class="cf">break</span></span>
<span id="cb365-36"><a href="#cb365-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-37"><a href="#cb365-37" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> <span class="bu">len</span>(peptide_vector) <span class="op">==</span> <span class="bu">len</span>(spectral_vector):</span>
<span id="cb365-38"><a href="#cb365-38" aria-hidden="true" tabindex="-1"></a>                score: <span class="bu">float</span> <span class="op">=</span> <span class="bu">sum</span>(s <span class="op">*</span> v <span class="cf">for</span> s, v <span class="kw">in</span> <span class="bu">zip</span>(spectral_vector, peptide_vector))</span>
<span id="cb365-39"><a href="#cb365-39" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> score <span class="op">&gt;</span> max_score:</span>
<span id="cb365-40"><a href="#cb365-40" aria-hidden="true" tabindex="-1"></a>                    max_score <span class="op">=</span> score</span>
<span id="cb365-41"><a href="#cb365-41" aria-hidden="true" tabindex="-1"></a>                    best_peptide <span class="op">=</span> peptide</span>
<span id="cb365-42"><a href="#cb365-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-43"><a href="#cb365-43" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> best_peptide, max_score</span>
<span id="cb365-44"><a href="#cb365-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-45"><a href="#cb365-45" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> search_peptide_spectrum_matches(spectral_vectors: List[List[<span class="bu">int</span>]], proteome: <span class="bu">str</span>, threshold: <span class="bu">float</span>) <span class="op">-&gt;</span> Set[<span class="bu">str</span>]:</span>
<span id="cb365-46"><a href="#cb365-46" aria-hidden="true" tabindex="-1"></a>    psm_set: Set[<span class="bu">str</span>] <span class="op">=</span> <span class="bu">set</span>()</span>
<span id="cb365-47"><a href="#cb365-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> vector <span class="kw">in</span> spectral_vectors:</span>
<span id="cb365-48"><a href="#cb365-48" aria-hidden="true" tabindex="-1"></a>        peptide, score <span class="op">=</span> identify_peptide(vector, proteome)</span>
<span id="cb365-49"><a href="#cb365-49" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> score <span class="op">&gt;=</span> threshold:</span>
<span id="cb365-50"><a href="#cb365-50" aria-hidden="true" tabindex="-1"></a>            psm_set.add(peptide)</span>
<span id="cb365-51"><a href="#cb365-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> psm_set</span>
<span id="cb365-52"><a href="#cb365-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-53"><a href="#cb365-53" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb365-54"><a href="#cb365-54" aria-hidden="true" tabindex="-1"></a><span class="st">-1 5 -4 5 3 -1 -4 5 -1 0 0 4 -1 0 1 4 4 4</span></span>
<span id="cb365-55"><a href="#cb365-55" aria-hidden="true" tabindex="-1"></a><span class="st">-4 2 -2 -4 4 -5 -1 4 -1 2 5 -3 -1 3 2 -3</span></span>
<span id="cb365-56"><a href="#cb365-56" aria-hidden="true" tabindex="-1"></a><span class="st">XXXZXZXXZXZXXXZXXZX</span></span>
<span id="cb365-57"><a href="#cb365-57" aria-hidden="true" tabindex="-1"></a><span class="st">5</span></span>
<span id="cb365-58"><a href="#cb365-58" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb365-59"><a href="#cb365-59" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb365-60"><a href="#cb365-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-61"><a href="#cb365-61" aria-hidden="true" tabindex="-1"></a>spectral_vectors: List[List[<span class="bu">int</span>]] <span class="op">=</span> []</span>
<span id="cb365-62"><a href="#cb365-62" aria-hidden="true" tabindex="-1"></a>idx: <span class="bu">int</span> <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb365-63"><a href="#cb365-63" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> idx <span class="op">&lt;</span> <span class="bu">len</span>(input_lines) <span class="kw">and</span> (is_number(input_lines[idx][<span class="dv">0</span>]) <span class="kw">or</span> is_number(input_lines[idx][:<span class="dv">2</span>])):</span>
<span id="cb365-64"><a href="#cb365-64" aria-hidden="true" tabindex="-1"></a>    vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[idx].strip().split()]</span>
<span id="cb365-65"><a href="#cb365-65" aria-hidden="true" tabindex="-1"></a>    spectral_vectors.append(vector)</span>
<span id="cb365-66"><a href="#cb365-66" aria-hidden="true" tabindex="-1"></a>    idx <span class="op">+=</span> <span class="dv">1</span></span>
<span id="cb365-67"><a href="#cb365-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-68"><a href="#cb365-68" aria-hidden="true" tabindex="-1"></a>proteome: <span class="bu">str</span> <span class="op">=</span> input_lines[idx].strip()</span>
<span id="cb365-69"><a href="#cb365-69" aria-hidden="true" tabindex="-1"></a>threshold: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[idx <span class="op">+</span> <span class="dv">1</span>])</span>
<span id="cb365-70"><a href="#cb365-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-71"><a href="#cb365-71" aria-hidden="true" tabindex="-1"></a>result: Set[<span class="bu">str</span>] <span class="op">=</span> search_peptide_spectrum_matches(spectral_vectors, proteome, threshold)</span>
<span id="cb365-72"><a href="#cb365-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb365-73"><a href="#cb365-73" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> peptide <span class="kw">in</span> result:</span>
<span id="cb365-74"><a href="#cb365-74" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(peptide)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-size-of-a-spectral-dictionary" class="level1" data-number="122">
<h1 data-number="122"><span class="header-section-number">122</span> Compute the Size of a Spectral Dictionary</h1>
<p>Size of Spectral Dictionary Problem. Find the size of the spectral dictionary for a given spectrum and score threshold.</p>
<p>Given:&nbsp;A spectral vector&nbsp;<em>Spectrum’</em>, an integer&nbsp;<em>threshold</em>, and an integer&nbsp;<em>max_score</em>.</p>
<p>Return:&nbsp;The size of the dictionary&nbsp;*Dictionary__threshold<em>(</em>Spectrum’*).</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;Use the provided&nbsp;<em>max_score</em>&nbsp;for the height of your table. Your answer should be the number of peptides whose score is at least&nbsp;<em>threshold</em>&nbsp;and at most&nbsp;<em>max_score</em>.</p>
</blockquote>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
<section id="sample-dataset-122" class="level2" data-number="122.1">
<h2 data-number="122.1" class="anchored" data-anchor-id="sample-dataset-122"><span class="header-section-number">122.1</span> Sample Dataset</h2>
<pre><code>4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3
1
8</code></pre>
</section>
<section id="sample-output-122" class="level2" data-number="122.2">
<h2 data-number="122.2" class="anchored" data-anchor-id="sample-output-122"><span class="header-section-number">122.2</span> Sample Output</h2>
<pre><code>0</code></pre>
</section>
<section id="solution-122" class="level2" data-number="122.3">
<h2 data-number="122.3" class="anchored" data-anchor-id="solution-122"><span class="header-section-number">122.3</span> Solution</h2>
<div class="sourceCode" id="cb368"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb368-1"><a href="#cb368-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb368-2"><a href="#cb368-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-3"><a href="#cb368-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb368-4"><a href="#cb368-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb368-5"><a href="#cb368-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb368-6"><a href="#cb368-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb368-7"><a href="#cb368-7" aria-hidden="true" tabindex="-1"></a>mass_values: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">list</span>(amino_acid_masses.values())</span>
<span id="cb368-8"><a href="#cb368-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-9"><a href="#cb368-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectral_dictionary_size(spectral_vector: List[<span class="bu">int</span>], threshold: <span class="bu">int</span>, max_score: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">int</span>:</span>
<span id="cb368-10"><a href="#cb368-10" aria-hidden="true" tabindex="-1"></a>    vector_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(spectral_vector)</span>
<span id="cb368-11"><a href="#cb368-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-12"><a href="#cb368-12" aria-hidden="true" tabindex="-1"></a>    size_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">int</span>]] <span class="op">=</span> {<span class="dv">0</span>: {<span class="dv">0</span>: <span class="dv">1</span>}}</span>
<span id="cb368-13"><a href="#cb368-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb368-14"><a href="#cb368-14" aria-hidden="true" tabindex="-1"></a>        size_matrix[<span class="dv">0</span>][t] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb368-15"><a href="#cb368-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-16"><a href="#cb368-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vector_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb368-17"><a href="#cb368-17" aria-hidden="true" tabindex="-1"></a>        size_matrix[i] <span class="op">=</span> {}</span>
<span id="cb368-18"><a href="#cb368-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb368-19"><a href="#cb368-19" aria-hidden="true" tabindex="-1"></a>            size_matrix[i][t] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb368-20"><a href="#cb368-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mass <span class="kw">in</span> mass_values:</span>
<span id="cb368-21"><a href="#cb368-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (i <span class="op">-</span> mass) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&lt;=</span> max_score:</span>
<span id="cb368-22"><a href="#cb368-22" aria-hidden="true" tabindex="-1"></a>                    size_matrix[i][t] <span class="op">+=</span> size_matrix[i <span class="op">-</span> mass][t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb368-23"><a href="#cb368-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-24"><a href="#cb368-24" aria-hidden="true" tabindex="-1"></a>    final_size: <span class="bu">int</span> <span class="op">=</span> <span class="bu">sum</span>(size_matrix[vector_length][t] <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(threshold, max_score <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb368-25"><a href="#cb368-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-26"><a href="#cb368-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> final_size</span>
<span id="cb368-27"><a href="#cb368-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-28"><a href="#cb368-28" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb368-29"><a href="#cb368-29" aria-hidden="true" tabindex="-1"></a><span class="st">4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3</span></span>
<span id="cb368-30"><a href="#cb368-30" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb368-31"><a href="#cb368-31" aria-hidden="true" tabindex="-1"></a><span class="st">8</span></span>
<span id="cb368-32"><a href="#cb368-32" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb368-33"><a href="#cb368-33" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb368-34"><a href="#cb368-34" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">0</span>].strip().split()]</span>
<span id="cb368-35"><a href="#cb368-35" aria-hidden="true" tabindex="-1"></a>threshold: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb368-36"><a href="#cb368-36" aria-hidden="true" tabindex="-1"></a>max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb368-37"><a href="#cb368-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb368-38"><a href="#cb368-38" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_spectral_dictionary_size(spectral_vector, threshold, max_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="compute-the-probability-of-a-spectral-dictionary" class="level1" data-number="123">
<h1 data-number="123"><span class="header-section-number">123</span> Compute the Probability of a Spectral Dictionary</h1>
<p>Probability of Spectral Dictionary Problem. Find the probability of the spectral dictionary for a given spectrum and score threshold.</p>
<p>Given:&nbsp;A spectral vector&nbsp;<em>Spectrum’</em>, an integer&nbsp;<em>threshold</em>, and an integer&nbsp;<em>max_score</em>.</p>
<p>Return:&nbsp;The probability of the dictionary&nbsp;*Dictionary__threshold<em>(</em>Spectrum’*).</p>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;Use the provided&nbsp;<em>max_score</em>&nbsp;for the height of your table.</p>
</blockquote>
<blockquote class="blockquote">
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
</blockquote>
<section id="sample-dataset-123" class="level2" data-number="123.1">
<h2 data-number="123.1" class="anchored" data-anchor-id="sample-dataset-123"><span class="header-section-number">123.1</span> Sample Dataset</h2>
<pre><code>4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3
1
8</code></pre>
</section>
<section id="sample-output-123" class="level2" data-number="123.2">
<h2 data-number="123.2" class="anchored" data-anchor-id="sample-output-123"><span class="header-section-number">123.2</span> Sample Output</h2>
<pre><code>0</code></pre>
</section>
<section id="solution-123" class="level2" data-number="123.3">
<h2 data-number="123.3" class="anchored" data-anchor-id="solution-123"><span class="header-section-number">123.3</span> Solution</h2>
<div class="sourceCode" id="cb371"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb371-1"><a href="#cb371-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb371-2"><a href="#cb371-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-3"><a href="#cb371-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb371-4"><a href="#cb371-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb371-5"><a href="#cb371-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span></span>
<span id="cb371-6"><a href="#cb371-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb371-7"><a href="#cb371-7" aria-hidden="true" tabindex="-1"></a>mass_values: List[<span class="bu">int</span>] <span class="op">=</span> <span class="bu">list</span>(amino_acid_masses.values())</span>
<span id="cb371-8"><a href="#cb371-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-9"><a href="#cb371-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> calculate_spectral_dictionary_probability(spectral_vector: List[<span class="bu">int</span>], threshold: <span class="bu">int</span>, max_score: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">float</span>:</span>
<span id="cb371-10"><a href="#cb371-10" aria-hidden="true" tabindex="-1"></a>    vector_length: <span class="bu">int</span> <span class="op">=</span> <span class="bu">len</span>(spectral_vector)</span>
<span id="cb371-11"><a href="#cb371-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-12"><a href="#cb371-12" aria-hidden="true" tabindex="-1"></a>    probability_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">float</span>]] <span class="op">=</span> {<span class="dv">0</span>: {<span class="dv">0</span>: <span class="fl">1.0</span>}}</span>
<span id="cb371-13"><a href="#cb371-13" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb371-14"><a href="#cb371-14" aria-hidden="true" tabindex="-1"></a>        probability_matrix[<span class="dv">0</span>][t] <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb371-15"><a href="#cb371-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-16"><a href="#cb371-16" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, vector_length <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb371-17"><a href="#cb371-17" aria-hidden="true" tabindex="-1"></a>        probability_matrix[i] <span class="op">=</span> {}</span>
<span id="cb371-18"><a href="#cb371-18" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_score <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb371-19"><a href="#cb371-19" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i][t] <span class="op">=</span> <span class="fl">0.0</span></span>
<span id="cb371-20"><a href="#cb371-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mass <span class="kw">in</span> mass_values:</span>
<span id="cb371-21"><a href="#cb371-21" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (i <span class="op">-</span> mass) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&gt;=</span> <span class="dv">0</span> <span class="kw">and</span> (t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]) <span class="op">&lt;=</span> max_score:</span>
<span id="cb371-22"><a href="#cb371-22" aria-hidden="true" tabindex="-1"></a>                    probability_matrix[i][t] <span class="op">+=</span> probability_matrix[i <span class="op">-</span> mass][t <span class="op">-</span> spectral_vector[i <span class="op">-</span> <span class="dv">1</span>]]</span>
<span id="cb371-23"><a href="#cb371-23" aria-hidden="true" tabindex="-1"></a>            probability_matrix[i][t] <span class="op">/=</span> <span class="dv">20</span></span>
<span id="cb371-24"><a href="#cb371-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-25"><a href="#cb371-25" aria-hidden="true" tabindex="-1"></a>    final_probability: <span class="bu">float</span> <span class="op">=</span> <span class="bu">sum</span>(probability_matrix[vector_length][t] <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(threshold, max_score <span class="op">+</span> <span class="dv">1</span>))</span>
<span id="cb371-26"><a href="#cb371-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-27"><a href="#cb371-27" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> final_probability</span>
<span id="cb371-28"><a href="#cb371-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-29"><a href="#cb371-29" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb371-30"><a href="#cb371-30" aria-hidden="true" tabindex="-1"></a><span class="st">4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3</span></span>
<span id="cb371-31"><a href="#cb371-31" aria-hidden="true" tabindex="-1"></a><span class="st">1</span></span>
<span id="cb371-32"><a href="#cb371-32" aria-hidden="true" tabindex="-1"></a><span class="st">8</span></span>
<span id="cb371-33"><a href="#cb371-33" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb371-34"><a href="#cb371-34" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb371-35"><a href="#cb371-35" aria-hidden="true" tabindex="-1"></a>spectral_vector: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">0</span>].strip().split()]</span>
<span id="cb371-36"><a href="#cb371-36" aria-hidden="true" tabindex="-1"></a>threshold: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">1</span>])</span>
<span id="cb371-37"><a href="#cb371-37" aria-hidden="true" tabindex="-1"></a>max_score: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb371-38"><a href="#cb371-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb371-39"><a href="#cb371-39" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(calculate_spectral_dictionary_probability(spectral_vector, threshold, max_score))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
</section>
<section id="find-a-highest-scoring-modified-peptide-against-a-spectrum" class="level1" data-number="124">
<h1 data-number="124"><span class="header-section-number">124</span> Find a Highest-Scoring Modified Peptide against a Spectrum</h1>
<p>Spectral Alignment Problem. Given a peptide and a spectral vector, find a modified variant of this peptide that maximizes the peptide-spectrum score among all variants of the peptides with up to k modifications.</p>
<p>Given:&nbsp;A peptide&nbsp;<em>Peptide</em>, a spectral vector&nbsp;<em>Spectrum’</em>, and an integer&nbsp;<em>k</em>.</p>
<p>Return:&nbsp;A peptide&nbsp;<em>Peptide’</em>&nbsp;related to&nbsp;<em>Peptide</em>&nbsp;by up to&nbsp;<em>k</em>&nbsp;modifications with maximal score against&nbsp;<em>Spectrum’</em>&nbsp;out of all possibilities.</p>
<p><strong>Note:</strong>&nbsp;In this chapter, all dataset problems implicitly use the standard integer-valued mass table for the regular twenty amino acids. Examples sometimes use imaginary amino acids X and Z having respective integer masses 4 and 5.</p>
<section id="sample-dataset-124" class="level2" data-number="124.1">
<h2 data-number="124.1" class="anchored" data-anchor-id="sample-dataset-124"><span class="header-section-number">124.1</span> Sample Dataset</h2>
<pre><code>XXZ
4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3
2</code></pre>
</section>
<section id="sample-output-124" class="level2" data-number="124.2">
<h2 data-number="124.2" class="anchored" data-anchor-id="sample-output-124"><span class="header-section-number">124.2</span> Sample Output</h2>
<pre><code>XX(-1)Z(+2)</code></pre>
</section>
<section id="solution-124" class="level2" data-number="124.3">
<h2 data-number="124.3" class="anchored" data-anchor-id="solution-124"><span class="header-section-number">124.3</span> Solution</h2>
<div class="sourceCode" id="cb374"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb374-1"><a href="#cb374-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> typing <span class="im">import</span> Dict, List</span>
<span id="cb374-2"><a href="#cb374-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-3"><a href="#cb374-3" aria-hidden="true" tabindex="-1"></a>amino_acid_masses: Dict[<span class="bu">str</span>, <span class="bu">int</span>] <span class="op">=</span> {</span>
<span id="cb374-4"><a href="#cb374-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'A'</span>: <span class="dv">71</span>, <span class="st">'C'</span>: <span class="dv">103</span>, <span class="st">'E'</span>: <span class="dv">129</span>, <span class="st">'D'</span>: <span class="dv">115</span>, <span class="st">'G'</span>: <span class="dv">57</span>, <span class="st">'F'</span>: <span class="dv">147</span>, <span class="st">'I'</span>: <span class="dv">113</span>, <span class="st">'H'</span>: <span class="dv">137</span>, <span class="st">'K'</span>: <span class="dv">128</span>, <span class="st">'M'</span>: <span class="dv">131</span>,</span>
<span id="cb374-5"><a href="#cb374-5" aria-hidden="true" tabindex="-1"></a>    <span class="st">'L'</span>: <span class="dv">113</span>, <span class="st">'N'</span>: <span class="dv">114</span>, <span class="st">'Q'</span>: <span class="dv">128</span>, <span class="st">'P'</span>: <span class="dv">97</span>, <span class="st">'S'</span>: <span class="dv">87</span>, <span class="st">'R'</span>: <span class="dv">156</span>, <span class="st">'T'</span>: <span class="dv">101</span>, <span class="st">'W'</span>: <span class="dv">186</span>, <span class="st">'V'</span>: <span class="dv">99</span>, <span class="st">'Y'</span>: <span class="dv">163</span>,</span>
<span id="cb374-6"><a href="#cb374-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">'X'</span>: <span class="dv">4</span>, <span class="st">'Z'</span>: <span class="dv">5</span>  <span class="co"># Added 'X' and 'Z' with arbitrary masses</span></span>
<span id="cb374-7"><a href="#cb374-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb374-8"><a href="#cb374-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-9"><a href="#cb374-9" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_score_matrix(score_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">float</span>]]], prefix_masses: List[<span class="bu">int</span>], spectral_vector: List[<span class="bu">int</span>], max_k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="va">None</span>:</span>
<span id="cb374-10"><a href="#cb374-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">2</span>, max_k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb374-11"><a href="#cb374-11" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> t <span class="op">==</span> <span class="op">-</span><span class="dv">2</span>:</span>
<span id="cb374-12"><a href="#cb374-12" aria-hidden="true" tabindex="-1"></a>            formatted_vector <span class="op">=</span> [<span class="bu">str</span>(x).rjust(<span class="dv">3</span>) <span class="cf">for</span> x <span class="kw">in</span> spectral_vector]</span>
<span id="cb374-13"><a href="#cb374-13" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'   '</span>, <span class="op">*</span>formatted_vector)</span>
<span id="cb374-14"><a href="#cb374-14" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb374-15"><a href="#cb374-15" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb374-16"><a href="#cb374-16" aria-hidden="true" tabindex="-1"></a>        <span class="cf">elif</span> t <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb374-17"><a href="#cb374-17" aria-hidden="true" tabindex="-1"></a>            header <span class="op">=</span> [<span class="bu">str</span>(i).rjust(<span class="dv">3</span>) <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector))]</span>
<span id="cb374-18"><a href="#cb374-18" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">'   '</span>, <span class="op">*</span>header)</span>
<span id="cb374-19"><a href="#cb374-19" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb374-20"><a href="#cb374-20" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses:</span>
<span id="cb374-21"><a href="#cb374-21" aria-hidden="true" tabindex="-1"></a>                row <span class="op">=</span> []</span>
<span id="cb374-22"><a href="#cb374-22" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="op">-</span><span class="dv">1</span>, <span class="bu">len</span>(spectral_vector)):</span>
<span id="cb374-23"><a href="#cb374-23" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> j <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb374-24"><a href="#cb374-24" aria-hidden="true" tabindex="-1"></a>                        row.append(<span class="ss">f"</span><span class="sc">{</span>mass<span class="sc">:&gt;3}</span><span class="ss"> "</span>)</span>
<span id="cb374-25"><a href="#cb374-25" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span>:</span>
<span id="cb374-26"><a href="#cb374-26" aria-hidden="true" tabindex="-1"></a>                        score <span class="op">=</span> score_matrix[mass][j][t]</span>
<span id="cb374-27"><a href="#cb374-27" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> score <span class="op">&lt;</span> <span class="op">-</span><span class="fl">1e5</span>:</span>
<span id="cb374-28"><a href="#cb374-28" aria-hidden="true" tabindex="-1"></a>                            score <span class="op">=</span> <span class="st">'XX'</span></span>
<span id="cb374-29"><a href="#cb374-29" aria-hidden="true" tabindex="-1"></a>                        row.append(<span class="ss">f"</span><span class="sc">{</span>score<span class="sc">:&gt;3}</span><span class="ss">"</span>)</span>
<span id="cb374-30"><a href="#cb374-30" aria-hidden="true" tabindex="-1"></a>                <span class="bu">print</span>(<span class="st">' '</span>.join(row))</span>
<span id="cb374-31"><a href="#cb374-31" aria-hidden="true" tabindex="-1"></a>            <span class="bu">print</span>(<span class="st">' '</span>)</span>
<span id="cb374-32"><a href="#cb374-32" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="va">None</span></span>
<span id="cb374-33"><a href="#cb374-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-34"><a href="#cb374-34" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> spectral_alignment(peptide: <span class="bu">str</span>, spectral_vector: List[<span class="bu">int</span>], max_k: <span class="bu">int</span>) <span class="op">-&gt;</span> <span class="bu">str</span>:</span>
<span id="cb374-35"><a href="#cb374-35" aria-hidden="true" tabindex="-1"></a>    spectral_vector.insert(<span class="dv">0</span>, <span class="dv">0</span>)</span>
<span id="cb374-36"><a href="#cb374-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-37"><a href="#cb374-37" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate prefix masses</span></span>
<span id="cb374-38"><a href="#cb374-38" aria-hidden="true" tabindex="-1"></a>    prefix_masses <span class="op">=</span> [<span class="dv">0</span>]</span>
<span id="cb374-39"><a href="#cb374-39" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide)):</span>
<span id="cb374-40"><a href="#cb374-40" aria-hidden="true" tabindex="-1"></a>        prefix <span class="op">=</span> peptide[:i <span class="op">+</span> <span class="dv">1</span>]</span>
<span id="cb374-41"><a href="#cb374-41" aria-hidden="true" tabindex="-1"></a>        mass <span class="op">=</span> <span class="bu">sum</span>(amino_acid_masses[aa] <span class="cf">for</span> aa <span class="kw">in</span> prefix)</span>
<span id="cb374-42"><a href="#cb374-42" aria-hidden="true" tabindex="-1"></a>        prefix_masses.append(mass)</span>
<span id="cb374-43"><a href="#cb374-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-44"><a href="#cb374-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Create diff array</span></span>
<span id="cb374-45"><a href="#cb374-45" aria-hidden="true" tabindex="-1"></a>    mass_differences <span class="op">=</span> {}</span>
<span id="cb374-46"><a href="#cb374-46" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>, <span class="bu">len</span>(prefix_masses)):</span>
<span id="cb374-47"><a href="#cb374-47" aria-hidden="true" tabindex="-1"></a>        mass_differences[prefix_masses[i]] <span class="op">=</span> prefix_masses[i] <span class="op">-</span> prefix_masses[i <span class="op">-</span> <span class="dv">1</span>]</span>
<span id="cb374-48"><a href="#cb374-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-49"><a href="#cb374-49" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize scores</span></span>
<span id="cb374-50"><a href="#cb374-50" aria-hidden="true" tabindex="-1"></a>    score_matrix: Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, Dict[<span class="bu">int</span>, <span class="bu">float</span>]]] <span class="op">=</span> {}</span>
<span id="cb374-51"><a href="#cb374-51" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses:</span>
<span id="cb374-52"><a href="#cb374-52" aria-hidden="true" tabindex="-1"></a>        score_matrix[mass] <span class="op">=</span> {}</span>
<span id="cb374-53"><a href="#cb374-53" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb374-54"><a href="#cb374-54" aria-hidden="true" tabindex="-1"></a>            score_matrix[mass][j] <span class="op">=</span> {t: <span class="op">-</span><span class="bu">float</span>(<span class="st">"inf"</span>) <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_k <span class="op">+</span> <span class="dv">1</span>)}</span>
<span id="cb374-55"><a href="#cb374-55" aria-hidden="true" tabindex="-1"></a>    score_matrix[<span class="dv">0</span>][<span class="dv">0</span>][<span class="dv">0</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb374-56"><a href="#cb374-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-57"><a href="#cb374-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Calculate scores</span></span>
<span id="cb374-58"><a href="#cb374-58" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> mass <span class="kw">in</span> prefix_masses[<span class="dv">1</span>:]:</span>
<span id="cb374-59"><a href="#cb374-59" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(spectral_vector)):</span>
<span id="cb374-60"><a href="#cb374-60" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb374-61"><a href="#cb374-61" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (t <span class="op">==</span> <span class="dv">0</span>) <span class="kw">and</span> (mass <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (j <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>):</span>
<span id="cb374-62"><a href="#cb374-62" aria-hidden="true" tabindex="-1"></a>                    score_matrix[mass][j][t] <span class="op">=</span> spectral_vector[j] <span class="op">+</span> score_matrix[mass <span class="op">-</span> mass_differences[mass]][j <span class="op">-</span> mass_differences[mass]][t]</span>
<span id="cb374-63"><a href="#cb374-63" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> (t <span class="op">&gt;</span> <span class="dv">0</span>) <span class="kw">and</span> (mass <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (j <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>):</span>
<span id="cb374-64"><a href="#cb374-64" aria-hidden="true" tabindex="-1"></a>                    score_matrix[mass][j][t] <span class="op">=</span> spectral_vector[j] <span class="op">+</span> <span class="bu">max</span>(score_matrix[mass <span class="op">-</span> mass_differences[mass]][j <span class="op">-</span> mass_differences[mass]][t],</span>
<span id="cb374-65"><a href="#cb374-65" aria-hidden="true" tabindex="-1"></a>                                                                         <span class="bu">max</span>(score_matrix[mass <span class="op">-</span> mass_differences[mass]][j_star][t <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> j_star <span class="kw">in</span> <span class="bu">range</span>(j)))</span>
<span id="cb374-66"><a href="#cb374-66" aria-hidden="true" tabindex="-1"></a>                <span class="cf">elif</span> (t <span class="op">&gt;</span> <span class="dv">0</span>) <span class="kw">and</span> (mass <span class="op">-</span> mass_differences[mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (j <span class="op">&gt;</span> <span class="dv">0</span>):</span>
<span id="cb374-67"><a href="#cb374-67" aria-hidden="true" tabindex="-1"></a>                    score_matrix[mass][j][t] <span class="op">=</span> spectral_vector[j] <span class="op">+</span> <span class="bu">max</span>(score_matrix[mass <span class="op">-</span> mass_differences[mass]][j_star][t <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> j_star <span class="kw">in</span> <span class="bu">range</span>(j))</span>
<span id="cb374-68"><a href="#cb374-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-69"><a href="#cb374-69" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Find max score layer</span></span>
<span id="cb374-70"><a href="#cb374-70" aria-hidden="true" tabindex="-1"></a>    max_score <span class="op">=</span> <span class="op">-</span><span class="bu">float</span>(<span class="st">"inf"</span>)</span>
<span id="cb374-71"><a href="#cb374-71" aria-hidden="true" tabindex="-1"></a>    max_layer <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb374-72"><a href="#cb374-72" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(max_k <span class="op">+</span> <span class="dv">1</span>):</span>
<span id="cb374-73"><a href="#cb374-73" aria-hidden="true" tabindex="-1"></a>        current_score <span class="op">=</span> score_matrix[prefix_masses[<span class="op">-</span><span class="dv">1</span>]][<span class="bu">len</span>(spectral_vector) <span class="op">-</span> <span class="dv">1</span>][t]</span>
<span id="cb374-74"><a href="#cb374-74" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> current_score <span class="op">&gt;</span> max_score:</span>
<span id="cb374-75"><a href="#cb374-75" aria-hidden="true" tabindex="-1"></a>            max_score <span class="op">=</span> current_score</span>
<span id="cb374-76"><a href="#cb374-76" aria-hidden="true" tabindex="-1"></a>            max_layer <span class="op">=</span> t</span>
<span id="cb374-77"><a href="#cb374-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-78"><a href="#cb374-78" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Backtrace</span></span>
<span id="cb374-79"><a href="#cb374-79" aria-hidden="true" tabindex="-1"></a>    layer <span class="op">=</span> max_layer</span>
<span id="cb374-80"><a href="#cb374-80" aria-hidden="true" tabindex="-1"></a>    column_index <span class="op">=</span> <span class="bu">len</span>(spectral_vector) <span class="op">-</span> <span class="dv">1</span></span>
<span id="cb374-81"><a href="#cb374-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-82"><a href="#cb374-82" aria-hidden="true" tabindex="-1"></a>    result_peptide <span class="op">=</span> <span class="st">''</span></span>
<span id="cb374-83"><a href="#cb374-83" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(peptide), <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb374-84"><a href="#cb374-84" aria-hidden="true" tabindex="-1"></a>        pre_mass <span class="op">=</span> prefix_masses[i]</span>
<span id="cb374-85"><a href="#cb374-85" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (column_index <span class="op">-</span> mass_differences[pre_mass] <span class="op">&gt;=</span> <span class="dv">0</span>) <span class="kw">and</span> (</span>
<span id="cb374-86"><a href="#cb374-86" aria-hidden="true" tabindex="-1"></a>                score_matrix[pre_mass][column_index][layer] <span class="op">==</span> spectral_vector[column_index] <span class="op">+</span> score_matrix[pre_mass <span class="op">-</span> mass_differences[pre_mass]][column_index <span class="op">-</span> mass_differences[pre_mass]][layer]):</span>
<span id="cb374-87"><a href="#cb374-87" aria-hidden="true" tabindex="-1"></a>            column_index <span class="op">-=</span> mass_differences[pre_mass]</span>
<span id="cb374-88"><a href="#cb374-88" aria-hidden="true" tabindex="-1"></a>            result_peptide <span class="op">=</span> peptide[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> result_peptide</span>
<span id="cb374-89"><a href="#cb374-89" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb374-90"><a href="#cb374-90" aria-hidden="true" tabindex="-1"></a>            temp_scores <span class="op">=</span> [score_matrix[pre_mass <span class="op">-</span> mass_differences[pre_mass]][j_star][layer <span class="op">-</span> <span class="dv">1</span>] <span class="cf">for</span> j_star <span class="kw">in</span> <span class="bu">range</span>(column_index)]</span>
<span id="cb374-91"><a href="#cb374-91" aria-hidden="true" tabindex="-1"></a>            idx_max_score <span class="op">=</span> temp_scores.index(<span class="bu">max</span>(temp_scores))</span>
<span id="cb374-92"><a href="#cb374-92" aria-hidden="true" tabindex="-1"></a>            modification_amount <span class="op">=</span> column_index <span class="op">-</span> idx_max_score <span class="op">-</span> mass_differences[pre_mass]</span>
<span id="cb374-93"><a href="#cb374-93" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> modification_amount <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb374-94"><a href="#cb374-94" aria-hidden="true" tabindex="-1"></a>                result_peptide <span class="op">=</span> peptide[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="st">'(+'</span> <span class="op">+</span> <span class="bu">str</span>(modification_amount) <span class="op">+</span> <span class="st">')'</span> <span class="op">+</span> result_peptide</span>
<span id="cb374-95"><a href="#cb374-95" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span>:</span>
<span id="cb374-96"><a href="#cb374-96" aria-hidden="true" tabindex="-1"></a>                result_peptide <span class="op">=</span> peptide[i <span class="op">-</span> <span class="dv">1</span>] <span class="op">+</span> <span class="st">'('</span> <span class="op">+</span> <span class="bu">str</span>(modification_amount) <span class="op">+</span> <span class="st">')'</span> <span class="op">+</span> result_peptide</span>
<span id="cb374-97"><a href="#cb374-97" aria-hidden="true" tabindex="-1"></a>            column_index <span class="op">=</span> idx_max_score</span>
<span id="cb374-98"><a href="#cb374-98" aria-hidden="true" tabindex="-1"></a>            layer <span class="op">-=</span> <span class="dv">1</span></span>
<span id="cb374-99"><a href="#cb374-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-100"><a href="#cb374-100" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> result_peptide</span>
<span id="cb374-101"><a href="#cb374-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-102"><a href="#cb374-102" aria-hidden="true" tabindex="-1"></a>sample_input: <span class="bu">str</span> <span class="op">=</span> <span class="st">"""</span></span>
<span id="cb374-103"><a href="#cb374-103" aria-hidden="true" tabindex="-1"></a><span class="st">XXZ</span></span>
<span id="cb374-104"><a href="#cb374-104" aria-hidden="true" tabindex="-1"></a><span class="st">4 -3 -2 3 3 -4 5 -3 -1 -1 3 4 1 3</span></span>
<span id="cb374-105"><a href="#cb374-105" aria-hidden="true" tabindex="-1"></a><span class="st">2</span></span>
<span id="cb374-106"><a href="#cb374-106" aria-hidden="true" tabindex="-1"></a><span class="st">"""</span></span>
<span id="cb374-107"><a href="#cb374-107" aria-hidden="true" tabindex="-1"></a>input_lines: List[<span class="bu">str</span>] <span class="op">=</span> sample_input.strip().split(<span class="st">"</span><span class="ch">\n</span><span class="st">"</span>)</span>
<span id="cb374-108"><a href="#cb374-108" aria-hidden="true" tabindex="-1"></a>peptide_sequence: <span class="bu">str</span> <span class="op">=</span> input_lines[<span class="dv">0</span>]</span>
<span id="cb374-109"><a href="#cb374-109" aria-hidden="true" tabindex="-1"></a>spectral_vector_values: List[<span class="bu">int</span>] <span class="op">=</span> [<span class="bu">int</span>(x) <span class="cf">for</span> x <span class="kw">in</span> input_lines[<span class="dv">1</span>].strip().split()]</span>
<span id="cb374-110"><a href="#cb374-110" aria-hidden="true" tabindex="-1"></a>max_k_value: <span class="bu">int</span> <span class="op">=</span> <span class="bu">int</span>(input_lines[<span class="dv">2</span>])</span>
<span id="cb374-111"><a href="#cb374-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb374-112"><a href="#cb374-112" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(spectral_alignment(peptide_sequence, spectral_vector_values, max_k_value))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>


</section>
</section>

</main> <!-- /main -->
<script async="" src="https://subscribe-forms.beehiiv.com/embed.js"></script><iframe src="https://subscribe-forms.beehiiv.com/ed70a4de-a490-4092-aed7-af5face9bf37" class="beehiiv-embed" data-test-id="beehiiv-embed" frameborder="0" scrolling="no" style="width: 260px; height: 355px; margin: 0; border-radius: 0px 0px 0px 0px !important; background-color: transparent; box-shadow: 0 0 #0000; max-width: 100%;"></iframe>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/tomorrow-lab\.github\.io");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
<script>
  function loadGiscus() {
    // Function to get the theme based on body class
    const getTheme = () => {
      let baseTheme = document.getElementById('giscus-base-theme').value;
      let altTheme = document.getElementById('giscus-alt-theme').value;
      if (authorPrefersDark) {
          [baseTheme, altTheme] = [altTheme, baseTheme];
      }
      return document.body.classList.contains('quarto-dark') ? altTheme : baseTheme;
    };
    const script = document.createElement("script");
    script.src = "https://giscus.app/client.js";
    script.async = true;
    script.dataset.repo = "partrita/giscus";
    script.dataset.repoId = "R_kgDONvsa2g";
    script.dataset.category = "General";
    script.dataset.categoryId = "DIC_kwDONvsa2s4CmWd7";
    script.dataset.mapping = "title";
    script.dataset.reactionsEnabled = "1";
    script.dataset.emitMetadata = "0";
    script.dataset.inputPosition = "top";
    script.dataset.theme = getTheme();
    script.dataset.lang = "en";
    script.crossOrigin = "anonymous";
    // Append the script to the desired div instead of at the end of the body
    document.getElementById("quarto-content").appendChild(script);
  }
  loadGiscus();
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Proudly served by <a href="https://pages.github.com/">github pages</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This blog is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>